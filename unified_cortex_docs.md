# Unified Cortex Cloud Documentation


## Cortex Cloud Posture Management Documentation


---

## 1. Get started with Cortex Cloud

### 1.1. What is Cortex Cloud?

#### 1.1.1. Key features

### 1.2. What is Cortex Cloud Posture Management?

### 1.3. Agentic AI in Cortex Cloud

#### 1.3.1. Cortex Agentic Assistant

##### Note

* By default, you have access to the Cortex Assistant, which includes a natural language interface for entity investigation and provides a list of recommended responses such as running a playbook, performing a scan, or collecting support files. If you enable the Cortex Agentic Assistant, it replaces the Cortex Assistant interface entirely. For more...

##### Tip

* The system Help Center Agent provides fast access to documentation. You can ask natural language questions, such as "How do I create a dashboard?" or "Where can I review my data retention policies?" and the agent retrieves concise, relevant information from the official documentation site.

##### Navigation

  Settings → Configurations → General → Server Settings → Agentic Assistant

##### 1.3.1.1. Agentic Assistant use cases

##### 1.3.1.2. Agentic Assistant security

### 1.4. Use the interface

### 1.5. In-product support case creation

#### Note

* When opening a support case through the Customer Support Portal, you need to manually select Cortex Cloud as the product. While there may be discrepancies between the categories in this wizard and the Customer Support Portal process, that's because this wizard is designed specifically to focus on options relevant to Cortex Cloud.

* Console recordings cannot exceed 10 minutes. The current recording time is displayed at the top of the window.

### 1.6. Understand your user persona

### 1.7. Fair Usage policy for Cortex Cloud

### 1.8. Understand license plans

#### Note

* A Cloud Runtime license includes both Posture Scanning and Runtime Protection on the same asset. Usage, including any overflow, is tracked automatically to ensure accurate reporting across both licenses without duplicate counting.

#### 1.8.1. Data retention

##### Note

* Case data is retained according to the Last Updated date. Issue data is retained according to the Observation Time. Data collected within these dates is kept and displayed for 186 days. To ensure the accuracy of issues, Cortex Cloud provides a grace period of up to 31 days for issues displayed in the Issues View, Issues table, and Cases View.

* Requires the Forensics add-on.

## 2. Onboard and configure Cortex Cloud

### 2.1. Plan and prepare

### 2.2. Deployment steps and checklist

#### 2.2.1. Activate Cortex Cloud

##### Prerequisite

* The Cortex Cloud activation email. A Customer Support Portal (CSP) account. You need to set up your CSP account. For more information, see How to Create Your CSP User Account. When you create a CSP account, you can set up two-factor authentication (2FA) to log into the CSP by using an Email, Okta Verify, or Google Authenticator (non-FedRAMP accounts)....

##### Note

* Activation can take about an hour and does not require you to remain on the activation page. Cortex Cloud sends a notification to your email when the process is complete.

* You can only change the subdomain once, and it cannot be undone. After deleting the subdomain, you can reuse it after 7 days.

##### 2.2.1.1. Cortex Cloud supported regions

##### 2.2.1.2. Enable access to required PANW resources

###### Note

* <tenant-name> refers to the selected subdomain of your Cortex Cloud tenant, and <region> is the region in which your tenant is deployed. For more information, see Cortex Cloud supported regions.

###### Navigation

  SSL decryption: If you use SSL decryption and experience difficulty connecting the Cortex XDR agent to the server, we recommend that you add the FQDNs required for access to your SSL Decryption Exclusion list in Device → Certificate Management → SSL Decryption Exclusion

#### 2.2.2. Upgrade from Prisma Cloud to Cortex Cloud

##### 2.2.2.1. About the Upgrade Helper

###### Note

* Your Prisma Cloud tenant remains available and fully operational during the agreed upgrade period.

##### 2.2.2.2. Link Cortex Cloud to Prisma Cloud

###### Navigation

  Settings → Configurations → Upgrade Helper

##### 2.2.2.3. Copy content

###### Navigation

  Settings → Configurations → Upgrade Helper

###### 2.2.2.3.1. Copy Global configurations

####### Note

* Keep the following caveats in mind: Scope-Based Access Control (SBAC) configurations, such as resources or account lists are not copied. You can manually assign scope-based access to the relevant users or groups. When migrating permission groups and roles, the total count of items successfully copied may be lower than the initial number selected. This...

####### Navigation

  Settings → Configurations → Access Management

###### 2.2.2.3.2. Copy CSPM configurations

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

  Posture Management → Rules & Policies → Policies → Cloud Security

  Investigation & Response → Automation → Automation Rules

  Posture Management → Compliance → Standards

###### 2.2.2.3.3. Copy CWP configurations

####### Navigation

  Posture Management → Rules & Policies → Cloud Workload

###### 2.2.2.3.4. Copy Cortex Cloud Application Security configurations

####### Important

* If labels are imported into Cortex Cloud less than three hours after they were last added or modified in Prisma Cloud, they may not be included in the import.

##### 2.2.2.4. Migrate Cortex CLI

###### Prerequisite

* Before you begin, ensure you have the following: Cortex Cloud API key: An active API key for your Cortex Cloud tenant with associated CLI role permissions. Refer to Manage API keys for more information Install the Cortex CLI. You can find the installation instructions here

#### 2.2.3. Set up users and roles

##### Note

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* The user who activated the Cortex product is assigned the Account Admin role. You cannot create additional Account Admin roles in the Cortex Cloud tenant. If you do not want the user to have Account Admin permission, you must remove the Account Admin role in Cortex Gateway.

##### 2.2.3.1. User group management

###### Note

* You can create user groups in the tenant or Cortex Gateway. User groups created in Cortex Gateway cannot be mapped to SAML groups. Only user groups created in the tenant support SAML group mapping and scoring. We recommend creating user groups in the Cortex tenant because: User groups are available for all tenants, and you may want different user...

* If users have been created in the CSP, but you want them to access the tenant through SSO only, skip this field and add only SAML group mapping after SSO is set up, otherwise, users can access the tenant through both the CSP and SSO. If you have not yet created any users, skip this field and add them later. See Set up authentication .

* When using Azure AD for SSO, the SAML group mapping needs to be provided using the group object ID (GUID) and not the group name.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

##### 2.2.3.2. Assign user roles and groups

###### Note

* If an existing user in the Cortex Gateway no longer has a role or a user group assigned, the user is revoked. Any roles, user groups, or egress configurations created by that user are shown as created by Revoked user instead of the user's email address.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Setting Cortex Query Language (XQL) dataset access permissions for a user role can only be performed from Cortex Cloud Access Management. For more information, see Manage user roles.

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit Users Permissions.

#### 2.2.4. Manage API keys

##### Note

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

##### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

* You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

#### 2.2.5. Set up authentication

##### Tip

* You should have at least one user in the Customer Support Portal for backup, in case of any authentication issues with your IdP provider.

##### 2.2.5.1. Authenticate users through the Customer Support Portal

###### Note

* You must be assigned the Super User role in the Customer Support Portal to add users in the Customer Support Portal. The first Super User who logs into Cortex Gateway is automatically assigned the Account Admin role and has access to the tenant. The user who activates the Cortex Cloud tenant will also be assigned the Account Admin role (if there is no...

* After users are added to the Customer Support Portal and they accept the invitation, you can manage them in Cortex Gateway or the Cortex Cloud tenant.

##### 2.2.5.2. Authenticate users using SSO

###### Note

* To set up SSO authentication in the tenant, you must be assigned an Instance Administrator or Account Admin role. SAML 2.0 users must log in to Cortex Cloud using the FQDN (full URL) of the tenant. To allow login directly from the IdP to , you must set the relay state on the IdP to the FQDN of the tenant. If you have multiple tenants, you must set up...

* The first SSO cannot be deleted, it can only be deactivated by toggling SSO Enabled to off. The Domain parameter is predefined for the first SSO. If you add additional SSO providers, you must provide the email Domain in the SSO Integration settings for all providers except the first. Cortex Cloud uses this domain to determine to which identity provider...

* Cortex Cloud requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex Cloud. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a...

##### 2.2.5.3. Set up Okta as the Identity Provider Using SAML 2.0

###### Note

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

##### 2.2.5.4. Set up Azure AD as the Identity Provider Using SAML 2.0

###### Note

* The default attributes shown on the main single sign-on page in Azure AD are not the values you need. You must click Edit next to Attributes and Claims to view and copy the actual values.

* The attribute claim name must exactly match the value sent by your IdP. In some cases, this may be the full attribute name/namespace, depending on the configuration of our IdP

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Important

* When copying the Single Sign-On URL value, remove idp/saml and leave the trailing /. For example, if the Single Sign-On URL is https://clientname.panproduct.region.paloaltonetworks.com/idp/saml, just copy https://clientname.panproduct.region.paloaltonetworks.com/.

#### 2.2.6. Cloud service provider (CSP) onboarding

##### 2.2.6.1. Ingest cloud assets

###### Note

* The cloud accounts being onboarded must be owned by the customer performing the onboarding process.

##### 2.2.6.2. Onboard Amazon Web Services

###### Prerequisite

* Ensure you have access to AWS Management Console. Ensure you have the Required AWS permissions.

###### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* When onboarding an AWS organization or organizational unit (OU), Cortex Cloud creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

###### 2.2.6.2.1. Manually upload template to AWS

####### Prerequisite

* Before you begin, ensure you have: An AWS account Access to AWS Management Console Permission to create a stack and its resources in AWS CloudFormation

####### Note

* You must ensure that the KMS key region and the SNS topic region are the exact same as the AWS region where you are deploying the CloudFormation stack.

###### 2.2.6.2.2. Configure AWS integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

##### 2.2.6.3. Onboard Google Cloud Platform

###### Prerequisite

* Ensure you have cccess to Google Cloud Console. Ensure you have an admin user with the required admin GCP permissions. Ensure you have the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled)   If you plan on enabling Automation as...

###### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* If you want to connect to your GCP Workspace, you must first complete onboarding with the option disabled. Once the GCP cloud instance is created, perform the steps detailed in Connect Google Workspace with your GCP cloud instance.

###### 2.2.6.3.1. Manually upload template to GCP

####### Prerequisite

* Before you begin, ensure you have: A GCP account. Permission to create the required resources in Google Cloud Deployment Manager. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool. Reviewed the...

####### Note

* The directory you create must be a subdirectory of the home directory.

####### Important

* You must not delete or move the Terraform files from this folder. It will prevent you from being able to edit your cloud instance in the future.

###### 2.2.6.3.2. Connect Google Workspace with your GCP cloud instance

####### Prerequisite

* Ensure you have the Super Admin role in Google Workspace.

* Ensure you have the organization ID of the Google Workspace you want to connect:    Log in to your Google Admin Console. and navigate to Account → Account settings → Profile. Next to Customer ID is your organization ID. Ensure you have the organization ID of the Google Workspace you want to connect: Log in to your Google Admin Console. and navigate...

###### 2.2.6.3.3. Configure GCP integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

###### 2.2.6.3.4. Monitor GCP resources inside service perimeters

####### Note

* Each GCP cloud instance is assigned a scope within GCP. If the scope, whether it be organization, folder, or project, includes any projects with a service perimeter, this procedure must be performed for that cloud instance to authorize Cortex Cloud to scan the resources in the perimeter.

##### 2.2.6.4. Onboard Microsoft Azure

###### Prerequisite

* Ensure you have a Microsoft Azure subscription. Ensure you have the admin permissions required to onboard Microsoft Azure or the built-in Security Administrator role. Obtain the tenant ID and subscription ID. You can view these in the Microsoft Azure Portal in Management groups.

###### 2.2.6.4.1. Finalize Microsoft Azure onboarding by executing the authentication template

####### Prerequisite

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the relevant scope (subscription, management group, tenant). We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed Terraform on your local machine. You can...

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the relevant scope (subscription, management group, tenant). We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed the Azure CLI tool. Authorization to create...

####### Important

* Do not delete or move the Terraform files from this folder. It will prevent you from being able to edit your cloud instance in the future.

###### 2.2.6.4.2. Configure Azure integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

##### 2.2.6.5. Onboard Oracle Cloud Infrastructure

###### Prerequisite

* Ensure you have access to the Oracle Cloud Infrastructure console Permissions for all of the following are required:    Creation of identity groups (for more information, refer to Managing Groups)   Policies (for more information, refer to How Policies Work)   Tag namespaces in the root compartment (for more information, refer to Tags and Tag Namespace...

###### Note

* Excluded compartments are not visible in Cortex Cloud. Additional Security Capabilities: Enable additional Cortex Cloud security add-ons, if available. This may require additional cloud provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. The additional security capabilities you can enable include: Data security posture management: An agentless multi-cloud data security solution that discovers, classifies, protects, and governs sensitive data. Serverless functions scanning (Gen 1 only): Implement serverless scanning to detect and remediate vulnerabilities within serverless functions during the development lifecycle. Seamless integration into CI/CD pipelines enables automated security scans for a continuously secure pre-production environment. Registry scanning: Scan container registry images for vulnerabilities. malware, and secrets. You can configure your initial preference for scanning your registry. Any newly discovered registry, repository, or image in the account will be scanned by default. For more details, see Configure registry scanning for cloud accountsConfigure registry scanning for cloud accounts Agentless disk scanning: (Recommended) Implement agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Additional Security Capabilities: Enable additional Cortex Cloud security add-ons, if available. This may require additional cloud provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. The additional security capabilities you can enable include: Data security posture management: An agentless multi-cloud data security solution that discovers, classifies, protects, and governs sensitive data. Serverless functions scanning (Gen 1 only): Implement serverless scanning to detect and remediate vulnerabilities within serverless functions during the development lifecycle. Seamless integration into CI/CD pipelines enables automated security scans for a continuously secure pre-production environment. Registry scanning: Scan container registry images for vulnerabilities. malware, and secrets. You can configure your initial preference for scanning your registry. Any newly discovered registry, repository, or image in the account will be scanned by default. For more details, see Configure registry scanning for cloud accountsConfigure registry scanning for cloud accounts Agentless disk scanning: (Recommended) Implement agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Cloud Tags: Define tags and tag values to be added to any new resource created by Cortex Cloud in the cloud environment. Note: The managed_by = paloaltonetworks tag is automatically added to all resources. This tag is mandatory. You cannot edit or remove this tag. Log Collection Configuration: To maximize security coverage, enable the collection of audit logs. This may require additional cloud service provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Enter the following details for each preexisting OCI storage bucket that you intend to use for log collection: Region: The geographic OCI region where the bucket is located. For example, "us-phoenix-1". Bucket Name: The name of the OCI storage bucket. Compartment OCID: The Oracle Cloud Identifier (OCID) of the compartment that contains the bucket. Log Collection Configuration: To maximize security coverage, enable the collection of audit logs. This may require additional cloud service provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Enter the following details for each preexisting OCI storage bucket that you intend to use for log collection: Region: The geographic OCI region where the bucket is located. For example, "us-phoenix-1". Bucket Name: The name of the OCI storage bucket. Compartment OCID: The Oracle Cloud Identifier (OCID) of the compartment that contains the bucket. Download the OCI authentication template by clicking Download Terraform. The Terraform authentication template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The Terraform authentication template is valid for seven days from when it was created. Download the OCI authentication template by clicking Download Terraform. The Terraform authentication template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The Terraform authentication template is valid for seven days from when it was created. Cortex Cloud generates a Terraform authentication template based on the settings you configured in the OCI onboarding wizard. Next step: Apply the Terraform authentication template in OCI. 2.2.6.5.1 |Manually upload template to OCI PREREQUISITE: Before you begin, ensure you have: An Oracle Cloud Infrastructure account and the tenancy OCID. Permission to deploy a custom template and create its resources in OCI. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed...

###### 2.2.6.5.2. Configure the OCI connector for log collection

##### 2.2.6.6. Manually connect a cloud instance

##### 2.2.6.7. Edit your onboarded CSP configuration

###### Important

* When using Terraform authentication templates, you must execute the updated Terraform template from the same folder where the original Terraform template was executed.

##### 2.2.6.8. Outposts

###### Important

* Outpost scan is an alternative to the recommended standard cloud scan. Cloud scan is recommended because it is fully managed by Palo Alto Networks and incurs no compute costs for your organization. Outpost scan is an advanced deployment model reserved for specific data residency or architectural requirements.

###### 2.2.6.8.1. Outpost fundamentals and planning

####### Note

* Before you create your outpost, verify that your internet connection is active. An active internet connection is necessary for the notification to be sent to Cortex Cloud to create the new outpost.

####### Important

* While outposts provide maximum control over the scanning environment, cloud scan mode is the recommended default for most organizations.

####### Navigation

  Before onboarding your Cortex Cloud with the cloud service provider (CSP) onboarding wizard, create an outpost by navigating to Settings → Data Sources & Integrations → Outposts

  Settings → Data Sources & Integrations → Add New

  View and manage existing outposts by navigating to Settings → Data Sources & Integrations → Outposts

###### 2.2.6.8.2. Create an outpost

####### Prerequisite

* Before you begin, ensure you have: An AWS account Permission to create a stack and its resources in AWS Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the AWS CLI tool and configured your profile with the aws...

* Before you begin, ensure you have: A GCP account Permission to create the required resources in Google Cloud Deployment Manager Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool

* Before you begin, ensure you have: An active Azure subscription. Installed the Azure CLI tool. Permission to deploy a custom template and create its resources in Microsoft Azure ("Owner" or "Contributor" on the designated outpost subscription scope, and Active Directory "Cloud Application Administrator" or "Application Administrator" privileged...

####### Note

* Verify that your internet connection is active. An active internet connection is necessary for notifications to be sent to Cortex Cloud for creating the new outpost. If you are unable to establish an internet connection, contact customer support for a manual workaround.

* When creating an outpost for a specific Azure subscription, the outpost account must be in the same Azure organization as the monitored subscriptions.

####### Important

* While outposts provide maximum control over the scanning environment, cloud scan mode is the recommended default for most organizations. For details, see When to choose outpost scan.

####### Navigation

  Start the outpost creation wizard by navigating to Settings → Data Sources & Integrations → Outposts and clicking New Outpost

  A new outpost is created in pending status and can be viewed in the Outpost page at Settings → Data Sources & Integrations → Outposts

##### 2.2.6.9. Introduction to Terraform for Cloud service provider (CSP) onboarding

###### Important

* Always run these commands in the same folder where the original .tf files and .terraform folder live—this is where the state is stored.

* This .tfstate state file is critical because it is needed by the terraform destroy command to clean up created resources. It is critical that you never delete this file.

##### 2.2.6.10. Container Registry Scanning

###### 2.2.6.10.1. Overview of container registry scanning

####### 2.2.6.10.1.1. Registry Components

####### 2.2.6.10.1.2. How Container Registry Scanning Works

###### 2.2.6.10.2. Configure registry scanning for cloud accounts

####### Prerequisite

* Ensure that you have performed the all steps till Additional Security Capabilities as listed in the onboarding wizard for the required CSP: Onboard Amazon Web ServicesOnboard Amazon Web Services Onboard Google Cloud PlatformOnboard Google Cloud Platform Onboard Microsoft AzureOnboard Microsoft Azure Onboard Oracle Cloud InfrastructureOnboard Oracle...

###### 2.2.6.10.3. Modify the container registry scanning scope

###### 2.2.6.10.4. Scan re-evaluation process

###### 2.2.6.10.5. Connect Docker Hub registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.5.1. Manage a Docker Hub connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.6. Connect Docker V2 compliant container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.6.1. Manage a Docker V2 connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.7. Connect GitLab container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

####### Note

* When both the group ID and project ID are provided, the system retrieves container images from all projects within the specified group as well as from the specified project. If neither the group ID nor the project ID is provided, the system retrieves container images from all registries (across all groups and projects) accessible to the authenticated...

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.7.1. Manage a Gitlab Container Registry connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.8. Connect Harbor registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.8.1. Manage a Harbor connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.9. Connect JFrog container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.9.1. Manage a JFrog connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.10. Connect Sonatype Nexus registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

####### Note

* If you are using a CA certificate, enter the server IP address instead of the registry url.

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* If you are using a CA certificate, enter the server IP address instead of the registry URL.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.10.1. Manage a Sonatype connector

######## Note

* If you had selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

##### 2.2.6.11. Cloud service provider permissions

###### 2.2.6.11.1. Amazon Web Services provider permissions

###### 2.2.6.11.2. Google Cloud Platform provider permissions

###### 2.2.6.11.3. Microsoft Azure provider permissions

###### 2.2.6.11.4. Oracle Cloud Infrastructure provider permissions

#### 2.2.7. Onboard the Kubernetes Connector

##### Note

* This option is not supported for Fargate.

* For Fargate, you must provide the cluster resource identifier. The format of the identifier is arn:aws:eks:<region>:<account-id>:cluster/<cluster-name>.

* Basic authentication is only supported in Posture Management. If deploying Realtime Protection, select None .

##### 2.2.7.1. What's new in Kubernetes Connector?

##### 2.2.7.2. Supported Kubernetes distributions

###### Note

* In Google Container-Optimized OS release 100 and earlier, where the FANOTIFY EXEC flag is not supported, the Kernel configuration may be partial for the user mode agent to properly function. In such cases, the agent will fallback to asynchronous mode. In RHCOS version 4.12 and earlier, the Kernel configuration may be partial for the user mode agent to...

### 2.3. Post-deployment steps

#### 2.3.1. Set up your environment

##### 2.3.1.1. Configure server settings

###### Note

* Keyboard shortcuts, timezone, and timestamp format are not set universally and only apply to the user who sets them.

* The Cortex Agentic Assistant and AI case summarization are currently available for users in limited regions. For more information, see Cortex Agentic Assistant.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

###### Navigation

  Settings → Configurations → General → Server Settings

##### 2.3.1.2. Configure security settings

##### 2.3.1.3. Log forwarding

###### 2.3.1.3.1. Forward logs from Cortex Cloud to external services

####### 2.3.1.3.1.1. Integrate a syslog receiver

######## Note

* Up to TLS 1.3 is supported. Make sure the self-signed CA includes your public key.

####### 2.3.1.3.1.2. Integrate Slack for outbound notifications

######## Note

* You are directed to the Slack browser to install Cortex Cloud. You can only use this link to install Cortex Cloud on Slack. Attempting to install from Slack Marketplace will redirect you to Cortex Cloud documentation.

####### 2.3.1.3.1.3. Configure notification forwarding

######## Prerequisite

* Before you can select a syslog receiver or a Slack channel, you must integrate these external services with Cortex Cloud. For more information, see: Integrate a syslog receiver Integrate Slack for outbound notifications

######## Note

* Notification Forwarding by Domain: To configure notification forwarding for issues by domain, select Log Type = Issues and filter the Issues table by Issue Domain. Case IDs in Notifications: If case matching completes before the notification is sent, the Case ID is included. If matching takes longer than the notification trigger, the notification is...

####### 2.3.1.3.1.4. Monitor administrative activity

###### 2.3.1.3.2. Data and log notification formats

####### Note

* Issues can be forwarded to email, syslog servers, and Slack in the alert format, if you prefer. The alert format can be selected when you configure your forwarding notification.

####### 2.3.1.3.2.1. Management audit log messages

####### 2.3.1.3.2.2. Issue notification format

####### 2.3.1.3.2.3. Management Audit log notification format

####### 2.3.1.3.2.4. Log format for IOC and BIOC issues

####### 2.3.1.3.2.5. Analytics log format

#### 2.3.2. Cortex MCP server

##### 2.3.2.1. Cortex MCP server overview

###### Note

* This feature is in Beta.

* The Cortex MCP Server empowers you to integrate AI into your security workflows using natural language. When using LLM-based suggestions, always review and approve actions suggested by the AI before they're executed. We recommend deploying the Cortex MCP server in a secure environment where access is limited to authorized users.

###### 2.3.2.1.1. Install the Cortex MCP server

####### Prerequisite

* If you are running the Cortex MCP server in a Poetry virtual environment, you must have Python 3.13 or higher. If you plan to run the Cortex MCP server in a Docker container, you must have Docker installed.

####### Note

* The MCP Server uses public APIs to communicate and is limited by the license quotas available in your tenant. This is particularly relevant when running XQL queries. For more information on running XQL query APIs, see Run XQL query APIs.

* It is critical to avoid assigning excessive permissions when creating an API key for the Cortex MCP Server. Since the key has both read and write capabilities, overly broad permissions can lead to unintended actions and potentially compromise your environment. Ensure the key follows the principle of least privilege and is granted only the minimum...

* When using Docker, we recommend using an .env file to set the Cortex API credentials as environment variables. While the credentials can be provided in the MCP client configuration settings, the .env file provides safer handling of API credentials and makes your configuration easily reproducible.

* By default, stdio (standard input/output) is used. You can also configure Streamable HTTP, to send requests directly to the tenant instead of through the MCP client. Streamable HTTP can be useful for testing in the browser without a MCP client and to bypass limits that may be in place for your MCP client. For Docker, you can include the Streamable HTTP...

####### Important

* To configure the Cortex MCP Server, you need the Cortex API URL, Cortex API key, and Cortex API key ID. You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

###### 2.3.2.1.2. Configure the MCP client

####### Navigation

  Settings → Developer → Edit Config

###### 2.3.2.1.3. Use the Cortex MCP server

####### Note

* The built-in tools retrieve information, but do not write to the tenant. You can create your own tools that include write actions. The examples below include both.

###### 2.3.2.1.4. Create custom Cortex MCP server tools

####### Note

* Any new or updated components provided by Cortex are automatically downloaded into the remote_components folder.  During each update, the folder is fully replaced and all existing contents are recreated. Do not add custom tools to this directory, as it is managed entirely by Cortex and is overwritten at every update.

#### 2.3.3. Manage user roles and access management

##### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

##### Note

* For more information on assigning user roles when generating an API key, see Manage API keys.

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* For features where scoping is not applicable, Role-Based Access Control (RBAC) is used and can be configured when managing user roles. For more information, see Manage user roles.

##### 2.3.3.1. Manage user roles

###### Prerequisite

* Managing user roles in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Navigation

  Settings → Configurations → Access Management → Roles

##### 2.3.3.2. Manage user access

###### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Note

* You can only reduce the permissions of an Account Admin user via Cortex Gateway.

* User permissions for components and datasets are based on the access permissions set in the user role. For more information on editing these user role permissions, see Manage user roles.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit User Permissions.

###### Navigation

  Settings → Configurations → Access Management → Users

###### 2.3.3.2.1. User access reference information

##### 2.3.3.3. Manage user scope

###### Prerequisite

* Configuring user scopes in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles. By default, Enable Scope Based Access Control is...

###### Note

* This configuration can impact the visibility of the related Security domain in the Cases and Issues scope area, but with not affect asset visibility.

* XQL-based dashboard widgets may require a few hours to initially reflect changes to the list or definitions of asset groups used for scoping. To view the most current data immediately, refresh the dashboard or its XQL widgets.

* For Cases and Issues domains, a workaround is to create a Dataset View for each required combination of domains, and allow the relevant entity access only to this Dataset View, not to the underlying cases and issues datasets.

* Make sure to assign the required default granular scoping for users. This depends on the structure and divisions within your organization and the particular purpose of each organizational unit to which scoped users belong.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Some areas and features in Cortex Cloud do not respect SBAC. In these cases, use RBAC permissions to restrict access.

* Action Required: Recent security enhancements enforce stricter default permissions for cases and issues that lack specific asset or endpoint references. This notice explains how to include access to these items if your users' visibility has been impacted.

* Before configuring, ensure that you review the Understand scoping section.

##### 2.3.3.4. Manage access to objects

###### 2.3.3.4.1. Manage access to custom dashboards

####### Prerequisite

* Configure tenant-level settings: An administrator must first establish the sharing framework under Settings → Configurations → Access Management → Objects. The configuration of these settings defines the authorized sharing workflows for custom dashboards:    Enable "Owners can Share objects they created": Grants owners the ability to share...

####### Note

* If you're designated as an Editor, you can always duplicate the widget and make your changes on the copy.

* Only Account Administrators and Instance Administrators have the authority to change the owner of an object.

###### 2.3.3.4.2. Manage access to saved queries

####### Prerequisite

* Configure tenant-level settings: An administrator must first establish the sharing framework under Settings → Configurations → Access Management → Objects. The configuration of these settings defines the authorized sharing workflows for saved queries in the Query Library, including the options that appear to users when clicking the three dot,...

####### Note

* If the role of a user is set to Edit Public Queries but not Create Queries, they can update existing public queries, but the Save as drop-down menu will be hidden, preventing them from creating new Query Library entries.

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

#### 2.3.4. Configure the Cortex Agentic Assistant

##### 2.3.4.1. Agentic Assistant components and concepts

###### Note

* Agents are bound by the same rules and robust permissions as a human user. In addition, you can mark actions that make real-world changes in production systems as sensitive, requiring a quick manual review and confirmation, ensuring peace of mind before critical system changes are made.

##### 2.3.4.2. Agents Hub

###### Note

* To manage agents in the Agents Hub, you must have the proper permissions. For more information, see Agentic Assistant role-based access control.

###### 2.3.4.2.1. Manage actions

####### Note

* To manage actions in the Agents Hub, you must have the correct permissions. For more information, see Agentic Assistant role-based access control.

###### 2.3.4.2.2. Register actions

####### Note

* To register actions, ensure you have the correct permissions. For more information, see Agentic Assistant role-based access control.

* Mandatory arguments cannot be deselected.

####### Important

* A single content item can be registered as different actions, with each action using different inputs and outputs from the same script. Only register the same script, command, or AI prompt as a new action if it is required for your use case, as providing an agent with many actions with overlapping abilities can reduce the ability of the agent to choose...

###### 2.3.4.2.3. Manage agents

####### Note

* In some cases, an agent may include actions with content items that are not relevant for all licenses. If that occurs, the grey circle appears, but you are not able to install the related content.

###### 2.3.4.2.4. Build agents

####### Note

* To build agents in the Agents Hub, you must have view/edit permissions. For more information, see Agentic Assistant role-based access control.

* If you clear the checkbox for a role, all actions associated with that role are also cleared. The exception is if another role is also selected, which is associated with the same actions. If you clear the checkbox for an action, all roles associated with that action are cleared. For example, if you select the Investigator role, and Send Mail and Tavily...

###### 2.3.4.2.5. Expand agent capabilities with MCP integrations

####### Note

* If you are using OAuth-based authentication, the Test button returns an error containing the command to run in the playground in order to test the connection.

* If an MCP tool is removed from the MCP server, the action will be unavailable due to missing content. If the tool is restored on the MCP server, the action is automatically reenabled.

####### Navigation

  Settings → Configurations → Data Collection → Integration Permissions

##### 2.3.4.3. Agentic Assistant role-based access control

#### 2.3.5. XQL query management

##### Prerequisite

* Setting query limits requires View/Edit permissions for Configurations → Query Management.

##### Note

* A scheduled query or report is run on behalf of the user that originally created it, even if it is edited and run by another user.

* Queries run by correlation rules are not restricted by the query limit. Very short queries do not count towards concurrent queries.

* To ensure optimal system performance, all queries (user-generated and otherwise) adhere to a default timeout limit of 60 minutes that is defined by Palo Alto that takes priority over the administrator defined value. Therefore, regardless of the value specified in this field, queries will be stopped after 60 minutes. You can override the default timeout...

* Query visibility is subject to Role-Based Access Control (RBAC); users can't see queries for datasets they do not have permission to access.

##### Navigation

  You can find Query Management options under Settings → Configurations → General → Query Management

#### 2.3.6. Customize cases and issues

##### 2.3.6.1. Customize cases and issues

###### 2.3.6.1.1. Set up case scoring

####### Note

* For scoped users, a small lock icon indicates that you don't have permissions to edit a rule.

####### Tip

* Right-click an issue field to add it as match criteria.

###### 2.3.6.1.2. Create a starring configuration

####### Tip

* Right-click an issue field to add it as match criteria.

###### 2.3.6.1.3. Create custom case statuses and resolution reasons

####### Note

* Before you create a custom status, please review the built-in options. For more information, see Resolution reasons for cases and issues. We recommend using the built-in statuses and resolution reasons where possible. Custom statuses and resolution reasons might not be supported by all content, and status syncing can take time. In addition, custom...

* After creation, custom statuses and resolution reasons cannot be deleted or modified.

####### Navigation

  Configurations → Object Setup → Cases → Properties

###### 2.3.6.1.4. Create a sync profile

####### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

#### 2.3.7. Dashboards and reports

## 3. Review inventory and explore your cloud environment

### 3.1. Inventory management

#### 3.1.1. Asset management

##### 3.1.1.1. All Assets

###### Note

* When working with the Asset Inventory page, consider the following: To maintain an accurate and clutter-free asset inventory, an automated cleanup process periodically removes outdated assets in the background.

* The options available are dependent on your license.

###### 3.1.1.1.1. Container Images

####### Navigation

  All Assets → Compute → Container Images

###### 3.1.1.1.2. Kubernetes Cluster

####### Note

* The Vulnerabilities tab is only available if the cluster you wish to analyze has a K8s connector.

####### Navigation

  Inventory → All Assets → Compute → Kubernetes Cluster for a Kubernetes Clusters assets overview

###### 3.1.1.1.3. External Surface assets

####### Note

* Cloud ASM data must be enabled before the External Surface asset inventory will populate. See Enable Cloud ASM.

##### 3.1.1.2. Serverless function assets

###### 3.1.1.2.1. Overview

####### Navigation

  To access serverless function assets, under Inventory, select All Assets → Compute → Serverless Functions

###### 3.1.1.2.2. Explore the serverless functions inventory

###### 3.1.1.2.3. Expanded serverless function asset information

####### Note

* For details of all serverless function issues generated by Cortex Cloud from vulnerability findings, refer to Serverless function usage.

##### 3.1.1.3. Network configuration

###### 3.1.1.3.1. Configure your network parameters

####### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

####### Navigation

  In Cortex Cloud , select Assets → Network Configuration → Internal Domain Suffixes

##### 3.1.1.4. Asset Groups

###### Note

* When you create or edit an Asset Group, the changes are applied immediately to new assets and to existing assets that have been updated. However, it may take a few hours for the changes to appear on existing assets that have not been updated.

###### Navigation

  Inventory → Assets → Groups → Add Group

##### 3.1.1.5. Vulnerability Assessment

###### Prerequisite

* The following are prerequisites for Cortex Cloud to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex Cloud lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex Cloud...

* The following are prerequisites for Cortex Cloud to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex Cloud collects all the information about the operating system and the installed...

###### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex Cloud Application Inventory.

###### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

###### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

## 4. Review and prioritize posture issues

### 4.1. Cases and issues

#### 4.1.1. Overview of cases

##### 4.1.1.1. What are cases?

##### 4.1.1.2. Resolving cases with AI

##### 4.1.1.3. Case lifecycle

##### 4.1.1.4. Case thresholds

##### 4.1.1.5. Case scope and impact

##### 4.1.1.6. Case and issue domains

#### 4.1.2. Case concepts

##### 4.1.2.1. Issues, findings, and events

###### 4.1.2.1.1. Issues

###### 4.1.2.1.2. Findings and events

##### 4.1.2.2. Case grouping

##### 4.1.2.3. Case scoring

##### 4.1.2.4. Case starring

###### Navigation

  You can manage all starring configurations under Case & Issues → Case Configuration → Starred Issues

##### 4.1.2.5. What is Causality?

###### Note

* There are no CGOs in the Cloud Causality View, when investigating cloud Cortex Cloud alerts and Cloud Audit Logs, or SaaS Causality View, when investigating SaaS-related alerts for 501 audit events, such as Office 365 audit logs and normalized logs.

#### 4.1.3. Analyze and resolve cases

##### 4.1.3.1. Review all cases

###### Note

* The legacy view is also available for users who prefer this format. From the Actions menu select Switch to legacy view.

##### 4.1.3.2. Start case analysis

###### 4.1.3.2.1. Agentic Assistant- Case Investigation agent

##### 4.1.3.3. Establish case context

###### 4.1.3.3.1. AI-generated case summaries

####### Note

* The AI-generated title and description is a calculated value that is regenerated each time you open a case. This value is not a saved static description, therefore it is not reflected in the saved case names in the list of cases in the Split view , or in the Case Name and Case Description columns in the Table view.

####### Navigation

  Configurations → General → Server Settings → AI Configuration and enable the following settings

###### 4.1.3.3.2. Assess case severity and score

###### 4.1.3.3.3. Update case attributes

####### Note

* The defined values are shown in the Case Name and Case Description columns in the Table view, and saved to the cases dataset. The case title is also shown the list of cases in the Split view. These values do not replace the AI-generated case title and summary. If the Summarize with AI toggle is enabled, AI-generated case summaries are automatically...

##### 4.1.3.4. Analyze case details

###### Note

* If you prefer a tabular or legacy layout, switch the case card to the Detailed view. This view preserves the legacy tab based format and custom layouts, ensuring full backward compatibility. You can switch between the new case experience and the legacy view based on personal workflow preferences. For more information, see Detailed View.

###### 4.1.3.4.1. Grouping graph

####### Note

* Similar issues are displayed as individual entities rather than in a parent/child hierarchy.

###### 4.1.3.4.2. Evidence

###### 4.1.3.4.3. Issue feed

###### 4.1.3.4.4. Associated assets and artifacts

####### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

###### 4.1.3.4.5. MITRE ATT&CK tactics and techniques

####### Note

* This component is available for cases associated with the Security domain or custom domains.

###### 4.1.3.4.6. Detailed View

####### Note

* When an issue is resolved, it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

###### 4.1.3.4.7. Issue card

####### Note

* This section is context-specific and shows data according to the issue context.

##### 4.1.3.5. Resolve the case

###### 4.1.3.5.1. Resolution Center

####### Note

* Tasks that are already In Progress but still require your input will appear in both the Pending and In Progress tabs.

###### 4.1.3.5.2. Collaborative notes and comments

###### 4.1.3.5.3. Resolve a case

####### Note

* If a case is resolved with the status Resolved - Auto Resolved, Cortex Cloud can reopen the case for up-to six hours if a new issue is triggered that matches the case. The six-hour period is defined by the timestamp of the last issue that was grouped into the case. After the six-hour period, any new issues are linked to a new case for a new...

###### 4.1.3.5.4. Resolution reasons for cases and issues

####### Note

* Cases and issues resolved as True Positive and False Positive help Cortex Cloud to identify real threats in your environment by comparing future cases and associated issues to the resolved cases. Therefore, the handling and scoring of future cases is affected by these resolutions.

##### 4.1.3.6. Additional case actions

###### 4.1.3.6.1. Create a case

####### Note

* To create a case manually, you must have View/Edit permission for Cases and Issues selected under Settings → Configurations → Access Management → Roles → Components → Cases & Issues.

* This option is only relevant for certain domains.

* You can't attach files to manually created cases.

####### Tip

* The issues that you link to a case can be linked to multiple cases, and the issue domains do not need to match the case domain.

###### 4.1.3.6.2. Merge a case

### 4.2. Investigation and response

#### 4.2.1. Investigate issues

##### 4.2.1.1. Overview of the Issues page

###### Note

* Every 12 hours, the system enforces a cleanup policy to remove the oldest issues once the maximum limit is exceeded. The default issue retention period in Cortex Cloud is 186 days.

##### 4.2.1.2. Link or unlink issues from a case

##### 4.2.1.3. Run an automation on an issue

###### Note

* In addition to automation, some playbooks contain manual tasks that prompt the analyst for input. This enables you to enhance an automation workflow with analyst input.

* You can also manually select a playbook to run from the Issue Work Plan tab.

##### 4.2.1.4. Use the War Room in an investigation

###### Note

* The case War Room is usually used for communication capabilities, but unlike the issue War Room, it does not include playbook specific entries. The case War Room enables you to investigate an entire case, not just an issue.

* Cortex Cloud does not index notes and chats.

###### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

* You can use the up/down arrow buttons in the CLI to do a reverse history search for previous commands with the same prefix.

###### Navigation

  Investigation & Response → Automation → Playground

##### 4.2.1.5. Use the Work Plan in an investigation

###### Important

* A playbook will not continue its execution path if a prior task has failed; you must resolve the failed task before subsequent tasks can run.

##### 4.2.1.6. Issue syncing

###### Prerequisite

* You must set up an integration before you can sync issues. For more information, see Set up an integration for mirroring issues.

###### Note

* Multiple tickets can be linked to an issue with outbound syncing. Issues with inbound syncing can be linked to a single ticket only.

* Using issue fields as variables is not currently supported.

* You can only define a single inbound profile. If you change the inbound sync profile the current profile is overwritten. You can define multiple outbound profiles; one issue can update multiple tickets.

* The inbound syncing flow runs every two minutes, and the outbound syncing flow runs every five minutes. In a bi-directional set-up, if the same field is updated in both tickets, the most recently updated value is used. In the external ticket, the logged history shows updates to the ticket. The user name that is logged with the history reflects the user...

* After an issue is resolved, ticket syncing remains active for up-to seven days. Therefore, you still update, change, or reopen the issue or external ticket and the tickets will continue to sync.

* If you change the selected inbound sync profile, the original sync profile is immediately overwritten.

###### Warning

* If you leave this field blank, all configured instances will be used.

###### Tip

* You can find a sync profile ID under Settings → Configurations → Object Setup → Issues → Sync Profiles. By default the ID field is not displayed in the table. Click the three dot menu and add it to the table layout.

###### Navigation

  Settings → Configurations → Marketplace

##### 4.2.1.7. Issue investigation actions

###### 4.2.1.7.1. Copy issues

###### 4.2.1.7.2. Update issue fields

####### Note

* You must create a custom status before you can select it.

####### Tip

* You can create custom issue statuses and resolution reasons, and use the setIssueStatus command to set these custom statuses for issues. For example, when a user starts investigating an issue, the issue status is automatically changed from New to Under Investigation. In some cases, it is useful to create an interim status, such as Triage. After you...

###### 4.2.1.7.3. Export issue details to a file

###### 4.2.1.7.4. Exclude an issue

###### 4.2.1.7.5. Query case and issue data

####### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

#### 4.2.2. Review findings

##### 4.2.2.1. Findings card

###### Note

* The information in this card is context specific, therefore some sections are not available for all findings.

#### 4.2.3. Investigate artifacts and assets

##### 4.2.3.1. Investigate an IP address

###### Note

* Requires a license key. Select Settings → Configurations → Integrations  → Threat Intelligence.

##### 4.2.3.2. Investigate an asset

###### Note

* The Asset view is available for hosts with a Cortex XDR agent installed.

##### 4.2.3.3. Investigate a file and process hash

###### Note

* Requires a license key. Go to Settings → Configurations → Integrations  → Threat Intelligence.

##### 4.2.3.4. Investigate a user

###### Note

* Cortex Cloud normalizes and displays case and issue times in your time zone. If you're in a half-hour time zone, the activity in the Issues & Insights Heatmap is displayed in the whole-hour time slot preceding it. For example, if you're in a UTC +4.5 time zone, the time displayed for the activity will be UTC +4.5, however, the visualization in the...

###### Tip

* You can also see a list of all users under Inventory → Assets → Asset Scores.

#### 4.2.4. Cortex Assistant

##### Note

* If you are in an eligible region and have enabled the Cortex Agentic Assistant, the Cortex Agentic Assistant replaces the Cortex Assistant. The Cortex Assistant is available if you do not have access to the Cortex Agentic Assistant based on the tenant region or you have not enabled it. For more information, see Cortex Agentic Assistant.

##### Navigation

  To increase usability, you can create a personalized keyboard shortcut: Settings → Configurations → Server Settings → Keyboard Shortcuts and choose the shortcut you want to use

##### 4.2.4.1. Cortex Assistant layout

##### 4.2.4.2. Cortex Assistant capabilities

###### Note

* When you choose an option from the Respond column, Cortex Assistant will always prompt you to approve the action before executing.

#### 4.2.5. Automation

##### 4.2.5.1. Automation in Cortex Cloud

###### Note

* You can build end-to-end automation workflows from within the playbook editor, including creating automation rules, configuring integration instances, and creating and editing tasks. For more information, see Playbooks.

##### 4.2.5.2. Quick Actions

###### Note

* Quick Actions appear as War Room entries, but do not appear in the Work Plan.

##### 4.2.5.3. Automation Exclusion Center

###### Note

* By default, all users have read and edit permissions to lists. When creating a list of critical assets, we recommend limiting the read and edit permissions to specific roles.

###### 4.2.5.3.1. Manage automation exclusion policies

####### Note

* For the IAM User Hard Remediation and User Soft Remediation policies, we recommend including username, email, and ID for each user you want to exclude. Example: username1, user@example.com, userID112.

* You can also right click on a policy from the main Automation Exclusion Center page to disable or enable the policy. If you click on a list name in the Exclude column, that list opens in the Lists page.

##### 4.2.5.4. Playbooks

###### Prerequisite

* To provide playbook access, ensure the Playbooks RBAC permission is set to View or View/Edit. To completely restrict playbook access, first set the Cases & Issues RBAC permission to None and then set the Playbooks permission to None. Conversely, to provide access to cases and issues, first set the Playbooks permission to View or View/Edit (and then set...

###### 4.2.5.4.1. Playbooks overview

###### 4.2.5.4.2. Playbook development checklist

###### 4.2.5.4.3. Plan your playbook

###### 4.2.5.4.4. Manage playbooks

####### Note

* The library by default shows only playbooks that are not adopted. Click the Show Adopted checkbox to show the adopted playbooks, indicated by an Adopted mark. The library shows the most updated playbook version. Adopting an older version than shown should be done through Marketplace. Adopting a playbook does not make it run. Some content packs include...

###### 4.2.5.4.5. Build your playbook

####### 4.2.5.4.5.1. Task 1. Choose from existing playbooks or create your own

######## Note

* When a task inside of a sub-playbook is not configured, the alert is propagated to the main playbook. If multiple sub-playbooks are nested, and any of the sub-playbooks have non-configured components, the alert appears in the main playbook as well as in the sub-playbooks. Alerts also appear for the individual non-configured tasks within the...

######## Tip

* If there are additional relevant playbooks in Marketplace that are not in your Org repository, you can click Explore them now to see them in the Playbook Catalog and choose to adopt.

* To open multiple playbooks at the same time, edit the first playbook and then click New next to the playbook name to create a new tab. You can either create a new playbook, or add an existing one. You can view recently modified or deleted playbooks by clicking version history for all playbooks .

######## Navigation

  the Investigation & Response → Automation → Playbooks page to find an existing playbook, customize it, or create a playbook

####### 4.2.5.4.5.2. Task 2. Configure playbook settings

######## Note

* If the playbook has inputs and outputs, the Playbook Starts task will show back and forth arrows. Clicking them opens the Playbook Settings pane Inputs/Outputs tab.

* This rule will trigger the playbook to run if no other Automation Rule triggers the playbook first. You can view and edit the order the rules run in the Automation Rules page.

* If you do not add any fields, the group will be deleted when you click Save.

####### 4.2.5.4.5.3. Task 3. Add objects from the Task Library

####### 4.2.5.4.5.4. Task 4. Add custom playbook features

####### 4.2.5.4.5.5. Task 5. Test and debug the playbook

####### 4.2.5.4.5.6. Task 6. Manage playbook content

###### 4.2.5.4.6. Customize your playbook

####### 4.2.5.4.6.1. Configure a sub-playbook loop

######## Note

* Consider the following when adding a loop: The maximum number of loops (default is 100). A high number of loops or a high wait time combined with a large number of issues may affect performance. Periodically check looping conditions to ensure they are still valid for the data set. If you want a sub playbook task to loop over an array passed into its...

######## Tip

* Balance between the number of iterations and the interval so you do not overload the server.

####### 4.2.5.4.6.2. Filter and transform data

######## Caution

* You can change the context data root to filter, but it is not recommended to select a different root, as it affects the filter results. The drop-down list displays the filter root for backward compatibility.

######## Navigation

  Investigation & Response → Automation → Scripts → New Script

####### 4.2.5.4.6.3. Extend context

####### 4.2.5.4.6.4. Extract indicators

######## Note

* This configuration may delay playbook execution (issue creation). While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

####### 4.2.5.4.6.5. Update issue fields with playbook tasks

######## Note

* The setIssue script includes all available fields; use the scroll bar to see all the fields. The name field has a limit of 600 characters. If there are more than 600 characters, you can shorten the name field to under 600 characters and then include the full information in a long text field such as the description field.

###### 4.2.5.4.7. Test your playbook

####### Note

* The debugger does not support using parentIncidentFields.

* Using an existing issue in the debugger does not affect the original issue or change the original context data.

####### 4.2.5.4.7.1. Troubleshoot playbook performance

###### 4.2.5.4.8. Manage playbook content

####### Note

* Opening a playbook does not immediately lock it. A playbook is considered to be in edit mode only when a user makes a modification that causes the Save button to become available.

####### Important

* Manually unlocking a playbook may cause version conflicts. This turns off concurrent editing protection, and if the original user is still editing, their changes might be lost or overwritten.

####### Navigation

  Investigation & Response → Automations → Playbooks

###### 4.2.5.4.9. Best practices

####### Note

* If you reattach a detached playbook, any customizations you have made to the playbook will be overwritten when the playbook updates to the current version.

* Retries are not supported for data collection tasks that have errors sending emails (indicated by a server timeout). This is because retries only work on automation execution failures, not on email delivery issues.

##### 4.2.5.5. AI Prompts

###### Navigation

  On the AI Prompts page (Investigation → Response → Automation → AI Prompts), you can view, edit, and manually create prompts

###### 4.2.5.5.1. AI prompts role-based access control

###### 4.2.5.5.2. Use existing prompts

####### Navigation

  Investigation & Response → Automation → AI Prompts and in the Prompts Library search for the prompt you want to use

###### 4.2.5.5.3. Create a prompt

####### Navigation

  Investigation & Response → Automation → AI Prompts and click + New Prompt

##### 4.2.5.6. Create an automation rule

###### Note

* You can also define the conditions that trigger a specific playbook in the playbook editor. For more information, see Task 2. Configure playbook settings

* Quick Actions, by default, run using all available integration instances that contain the command. When selecting a Quick Action for an automation rule, you can instead choose one specific integration instance to use.

###### Important

* Automation rules apply to Medium and higher severity issues. They also apply to Low severity Analytic issues and Low severity ABIOC issues that are tagged with Identity or Cloud. Rules are evaluated in order, and only the first rule that matches the trigger conditions is executed.

##### 4.2.5.7. Scripts

###### 4.2.5.7.1. Use existing scripts

####### Navigation

  Investigation & Response → Automation → Scripts and in the Scripts Library search for the script you want to use

###### 4.2.5.7.2. Create a script

####### Note

* You can enable/disable a script in the Settings without having to duplicate the script. You can view recently modified or deleted scripts by clicking the version history for all scripts .

####### Important

* If you choose Python, from the Agentic Assistant you can use the Automation Engineer agent.

####### Tip

* If there is an error, you can copy the error message from the test result into the Agentic Assistant prompt and ask the Automation Engineer agent to correct the error.

###### 4.2.5.7.3. Use the Automation Engineer agent to accelerate script development and deployment

####### Note

* The Automation Engineer agent is available with the Cortex Agentic Assistant, for users with script editing permissions. For more information, see Cortex Agentic Assistant and Agentic Assistant role-based access control.

* If you make manual edits in the script and don't save the changes and you then modify the script with the Automation Engineer agent, you are prompted to confirm overwriting the manual edits.

####### Tip

* Use detailed prompts, for example, Get failed logins from last 24 hours and return as a table. Clearly define argument names, types, and default values. Mention if you expect the output in a specific format, such as a table, JSON, or plain text.

* If there is an error, you can copy the error message from the test result into the Agentic Assistant prompt and ask the Automation Engineer agent to correct the error.

###### 4.2.5.7.4. Change the Docker image in a script

####### 4.2.5.7.4.1. Connect an engine to an image registry

######## Note

* This procedure uses the --username and --password command line options to pass the username and password directly. For environments where command history or logs are visible to others, consider more secure methods like Docker configuration files for handling authentication in production or CI/CD environments. For more details, see docker login or...

##### 4.2.5.8. Context data

###### 4.2.5.8.1. Issue context data

###### 4.2.5.8.2. Case context data

###### 4.2.5.8.3. Search context data

###### 4.2.5.8.4. Add context data to an issue

###### 4.2.5.8.5. Add context data to a case

####### Note

* If you run the command in the issue War Room, the data is added to the following places: The case context data. The issue context data under the case tab. If you run the command in the Case War Room, the data is added to the case context data only.

###### 4.2.5.8.6. Delete context data from a case

###### 4.2.5.8.7. Use context data in a playbook

####### Caution

* Users with Trigger Playbook permissions on a given issue may still be able to modify the parent case via commands and scripts, even without full access to the case.

##### 4.2.5.9. Lists

###### Note

* The maximum size of a list is 209715 characters.

###### 4.2.5.9.1. Create a list

####### Note

* If you intend to use the list as part of an Automation Exclusion Policy, we recommend choosing specific roles for read and edit access. For more information on using lists in exclusion policies, see Manage automation exclusion policies.Manage automation exclusion policies

* If you want to edit a list from a content pack, you need to duplicate or detach a list. Detached lists do not receive updated content in subsequent Cortex Cloud content releases. To retain an updated list, reattach it.

###### 4.2.5.9.2. List commands

###### 4.2.5.9.3. Use cases: JSON lists

####### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

  Investigation & Response → Automation → Playbooks → New Playbook

###### 4.2.5.9.4. Transform a list into an array

####### Navigation

  Investigation & Response → Automation → Playbooks and create or edit a playbook

##### 4.2.5.10. Integrations

###### 4.2.5.10.1. Integrations in Cortex Cloud

###### 4.2.5.10.2. Add an integration instance

###### 4.2.5.10.3. Use integration commands in the CLI

####### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

###### 4.2.5.10.4. Troubleshoot Integrations

###### 4.2.5.10.5. Manage credentials

####### Navigation

  Settings → Configurations → Integrations → Credentials → New Credential

##### 4.2.5.11. Engines

###### 4.2.5.11.1. What is an engine?

####### Note

* You cannot share a multiple-engine installation with a single-engine installation.

* When you add an engine to a load-balancing group, you cannot use that engine separately. The engine does not appear in the engines menu when configuring an integration instance, but you can choose the load-balancing group.

###### 4.2.5.11.2. Engine requirements

####### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

* If you have configured a range of Approved IP Ranges under Allowed Sessions on the Security Settings page, the engine must communicate through one of the approved IPs.

###### 4.2.5.11.3. Install an engine

####### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex Cloud engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

####### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

####### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

####### 4.2.5.11.3.1. Docker

######## Note

* This section is relevant when installing an engine.

* Docker images can be downloaded together with their relevant content packs for offline installation.

####### 4.2.5.11.3.2. Podman

######## Note

* When upgrading an engine, the engine keeps the previously used container management type (regardless of distribution version).

###### 4.2.5.11.4. Manage engines

###### 4.2.5.11.5. Upgrade an engine

###### 4.2.5.11.6. Remove an engine

###### 4.2.5.11.7. Configure engines

####### Note

* A day is defined as 24 hours and may not exactly correspond to calendar days due to daylight savings, leap seconds, etc.

* In addition, to support engine upgrades from the UI, edit the /usr/local/demisto/upgrade.conf file on the engine to include the SERVER_URLS setting with the new tenant's address. Include only the host, without https:// or any additional path at the end of the host name. For example: SERVER_URLS="api-example.us.paloaltonetworks.com"

* If the engine loses communication for longer than this time, it will disconnect and you need to restart the service.

####### 4.2.5.11.7.1. Configure the engine to use a web proxy

######## Note

* You need to configure Docker to use a proxy. When using a BlueCoat proxy, ensure you encode the values correctly.

* In an environment with a single engine, go to /usr/local/demisto/upgrade.conf. In an environment with multiple engines, go to /usr/local/demisto/<engine-name>/upgrade.conf, replacing <engine-name> with the name of the engine. Note that the key is in the upgrade.conf file and must be https_proxy, even if your proxy address starts with http://.

####### 4.2.5.11.7.2. Configure the engine to call the server without using a proxy

####### 4.2.5.11.7.3. Configure an engine to use custom certificates

###### 4.2.5.11.8. Use an engine in an integration

####### Note

* Long-running integrations should not run on load-balancing groups.

###### 4.2.5.11.9. Run a script using an engine

####### Navigation

  Investigation & Response → Automation → Scripts

###### 4.2.5.11.10. Troubleshoot engines

####### Note

* Ensure that pop-ups are not blocked by your browser.

* If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom path. --keep - Extracts the installer files into the current working directory (without cleaning at the end). If using installer...

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl status d1_<Engine _name>

* Any changes made to variables in the upgrade_engine.sh file are reset after each upgrade. We recommend instead using the upgrade.conf file to set variables.

* You can ignore the following error: Cannot create folder '/var/lib/demisto'

###### 4.2.5.11.11. Troubleshoot integrations running on engines

####### Note

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

* Docker CE installations typically run Docker, while Docker EE installations typically run dockerroot.

#### 4.2.6. Build XQL queries

##### Note

* If you have the Cortex Agentic Assistant, you can use natural language prompts to create and run XQL queries within the chat interface. For more information, see Create and run XQL queries with Agentic Assistant chat.

##### 4.2.6.1. About the Query Builder

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

##### 4.2.6.2. How to build XQL queries

###### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex Cloud. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

###### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

###### 4.2.6.2.1. Get started with XQL queries

###### 4.2.6.2.2. Useful XQL user interface features

####### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

###### 4.2.6.2.3. XQL Query best practices

###### 4.2.6.2.4. Expected results when querying fields

###### 4.2.6.2.5. Create XQL query

####### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined for the entire query, including queries that are part of the join stage. Yet, this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker...

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

###### 4.2.6.2.6. Review XQL query results

####### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* Results are received incrementally for the first 100K records, or up to 100MB worth of records, whichever comes first. After that, the next update is when the query has finished running completely.

* Real time query results are available only in the Query Builder and in free text query. Real time results are displayed only for queries run on hot datasets. The Sort option is available only after all the data is retrieved. When you formulate complex queries, the results will be displayed when the query has finished running completely, and not in real...

* In order for Cortex Cloud to provide a histogram for a field, the field must not contain an array or a JSON object.

###### 4.2.6.2.7. Translate to XQL

####### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

###### 4.2.6.2.8. Graph query results

####### License Type

  Building Cortex Query Language (XQL) queries in the Query Builder requires a Data Collection add-on.

####### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### 4.2.6.3. XQL query entities

###### 4.2.6.3.1. Create authentication query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.2. Create event log query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.3. Create file query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.4. Create image load query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.5. Create network connections query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.6. Create network query

####### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

###### 4.2.6.3.7. Create process query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.8. Create registry query

####### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

###### 4.2.6.3.9. Query across all entities

####### Navigation

  Investigation & Response → Search → Query Builder

##### 4.2.6.4. Overview of the Query Center

###### Note

* Very short queries might not be listed. You cannot cancel correlation queries. The default retention period for historic queries is aligned with issue retention.

###### 4.2.6.4.1. Edit and run queries in Query Center

####### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

####### Navigation

  Investigation & Response → Search → Query Center → Query History

####### 4.2.6.4.1.1. Query Center reference information

######## Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 4.2.6.5. Manage scheduled queries

###### Navigation

  Investigation & Response → Search → Scheduled Queries

###### 4.2.6.5.1. Scheduled Queries reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 4.2.6.6. Manage your query library

###### Note

* The Query to Library option is only available if your role has the Create Queries capability. For more information, see Manage access to saved queries.

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

###### Important

* The ability to create, edit, or share queries is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to saved queries.

#### 4.2.7. Quick Launcher

##### Note

* For hosts, Cortex Cloud displays results for exact matches but supports the use of wildcard (*) which changes the search to return matches that contain the specified text. For example, a search of compy-7* will return any hosts beginning with compy-7 such as compy-7000, compy-7abc, and so forth.

### 4.3. Customize cases and issues

#### 4.3.1. Customize cases and issues

##### 4.3.1.1. Set up case scoring

###### Note

* For scoped users, a small lock icon indicates that you don't have permissions to edit a rule.

###### Tip

* Right-click an issue field to add it as match criteria.

##### 4.3.1.2. Create a starring configuration

###### Tip

* Right-click an issue field to add it as match criteria.

##### 4.3.1.3. Create custom case statuses and resolution reasons

###### Note

* Before you create a custom status, please review the built-in options. For more information, see Resolution reasons for cases and issues. We recommend using the built-in statuses and resolution reasons where possible. Custom statuses and resolution reasons might not be supported by all content, and status syncing can take time. In addition, custom...

* After creation, custom statuses and resolution reasons cannot be deleted or modified.

###### Navigation

  Configurations → Object Setup → Cases → Properties

##### 4.3.1.4. Create a sync profile

###### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

## 5. Agentic Assistant chat

### 5.1. Get started with Agentic Assistant chat

#### Note

* The Cortex Agentic Assistant is currently available in limited regions. For more information see Cortex Agentic Assistant If your tenant is not within one of those regions, you have access to the Cortex Assistant. To enable the Cortex Agentic Assistant, go to Settings → Configurations → General → Server Settings → AI Configuration.

### 5.2. Choose an Agentic Assistant agent

#### Note

* Requires the Exposure Management add-on.

### 5.3. Chat with an Agentic Assistant agent

#### Note

* Case data is only loaded when you send your first message. Opening the chat interface without sending a prompt does not provide the agent with the case context.

* An agent's proposed plans and results may contain inaccuracies or errors. Always review the results carefully to ensure you fully understand the proposed action before proceeding.

#### Tip

* You can quickly jump to different product pages within Cortex Cloud by typing / in the prompt area. This shortcut is a built-in navigation feature that is available even if the Cortex Agentic Assistant is disabled.

### 5.4. Create and run XQL queries with Agentic Assistant chat

#### Note

* The TextToXQL action is a hidden system action and does not appear in the Agents Hub.

* If you are in a non-supported region and ask an agent to create an XQL query, it may attempt to generate the query using general logic. We do not recommend this, as it may result in inaccurate syntax and unreliable results.

* Running XQL queries manually through agent does not consume compute units. This includes scenarios where you prompt the agent to create and execute a multi-step plan.

### 5.5. Manage chat history

## 6. Review and report your security posture and progress

### 6.1. Monitor dashboards and reports

#### 6.1.1. About dashboards

##### Note

* Dashboards that are based on custom infrastructure cannot be exported. When importing a dashboard that already exists in the system, the imported dashboard overwrites the existing dashboard. To avoid overwriting the existing dashboard, duplicate and rename the existing dashboard before importing the new dashboard.

##### Important

* The ability to create, edit, or share custom dashboards is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to custom dashboards.

##### 6.1.1.1. Command Center dashboards

###### Note

* Access to these dashboards requires RBAC permissions under Dashboards & Reports. The Dashboards component must be Enabled in your role and requires View permissions for Command Center Dashboards. If certain options are unavailable, contact your administrator. For more information, Manage access to custom dashboards. The dashboards are available in dark...

###### 6.1.1.1.1. Cortex Agentic Assistant dashboard

####### Prerequisite

* The Cortex Agentic Assistant is only available after it is enabled, and for tenants in certain regions. For more information, see Cortex Agentic Assistant.

####### Note

* Access to this dashboard requires RBAC permissions under Dashboards & Reports. The Dashboards component must be Enabled in your role and requires View permissions for Command Center Dashboards. If certain options are unavailable, contact your administrator. For more information, see Manage access to custom dashboards.

###### 6.1.1.1.2. Cloud Security Operations

####### 6.1.1.1.2.1. Cloud Security Operations

######## Note

* Command Center data may not match the counts on the Issues page, and you may observe inconsistencies. This is because dashboard data is a snapshot of issues identified, whereas the Issues page provides the most up-to-date view of risks across your cloud assets. In addition, the Issues pages do not support all the currently available filters on the...

###### 6.1.1.1.3. Cortex Cloud Command Center

##### 6.1.1.2. Predefined dashboards

###### Note

* Users can access all information on the dashboard when their user access is scoped to view All assets or assigned to the Instance Administrator role. Otherwise, users with granular scoping set to No assets or Select asset groups will have limited access to the dashboard. For more information on Scope-Based Access Control (SBAC), see Manage user...

##### 6.1.1.3. Reports

###### 6.1.1.3.1. Report templates

#### 6.1.2. Build custom dashboards and reports

##### 6.1.2.1. Build a custom dashboard

###### Note

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For case-related widgets, you can refine the displayed data to only show results from cases that match a...

##### 6.1.2.2. Manage your Widget Library

###### Note

* Unlike dashboards, individual widgets cannot be shared with other users directly from the Widget Library. Yet, if you add a Restricted widget to a dashboard and then share that dashboard, other users who have access to the dashboard will also be able to see that specific widget.

* Any dashboards or reports that include the widget are affected by the changes.

#### 6.1.3. Fine-tune dashboards and reports

##### 6.1.3.1. Create a custom widget using a script

###### Note

* If you have added arguments to the script, these appear when creating a widget.

* Available options are Pie, Column, Line, and Single Value. To display the result of the script as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### 6.1.3.1.1. Script-based widget examples

####### Note

* Add the widget tag in the script settings to make the script available for use in script-based widgets. For more information, see Create a script.

* If your script returns a time duration, configure the widget with the graph type Single Value and enable Show as Time..

##### 6.1.3.2. Create custom XQL widgets

###### Note

* Cortex Query Language (XQL) queries generated from the Widget Library do not appear in the Query Center. The results are used only for creating the custom widget.

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### Tip

* You can create a generic dashboard for multiple views of the same dataset by using an asterisk (*) when defining the dataset in the XQL widget as dataset = <dataset_name>*. The placement of the asterisk in the dataset name ensures that any view containing this prefix text is displayed in the results. The dataset in a query is defined as: If there are...

###### 6.1.3.2.1. Configure filters and inputs for custom XQL widgets

####### Prerequisite

* Fixed filters are based on parameters that are defined in custom XQL widgets. Before you can configure fixed filters, take the following steps: Create custom XQL widgets with parameters. For more information, see Create custom XQL widgets. Add the widgets to a custom dashboard. For more information, see Build a custom dashboard.

####### Note

* This option only appears if the dashboard contains custom XQL widgets with defined parameters.

* You can define up to four parameter filters on a single dashboard or report.

* If you specify more than one field, only the first field value is used.

####### Tip

* After the initial setup, when you access your dashboard the filters and inputs might need further refinement. You can make changes to the configured parameters in the XQL widgets, and update the Filters & Inputs on your dashboard until you are satisfied with the results.

###### 6.1.3.2.2. Configure dashboard drilldowns

####### Prerequisite

* To configure drilldowns your dashboard must contain custom XQL widgets. In addition, if you want to configure in-dashboard drilldowns your custom XQL widget must contain one or more parameters. For more information about configuring parameters in custom XQL widgets, see Create custom XQL widgets.

####### Note

* If the selected parameter is configured in other XQL widgets on the dashboard, these widgets are also affected by the drilldown.

####### 6.1.3.2.2.1. Variables in drilldowns

#### 6.1.4. Run or schedule reports

##### Note

* Report templates that are based on custom infrastructure cannot be exported. If you import a report template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template. You can also...

* The report name and description will be displayed in the report header and are not editable during customization.

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

* To send reports to Slack, Slack must be configured as an external application in Cortex Cloud. For more information, see Integrate Slack for outbound notifications

##### Navigation

  Under Settings → Configurations → General → Notifications, click + Add Forwarding Configuration

## 7. Monitor and track compliance adherence

### 7.1. Cortex compliance flow

### 7.2. Choose compliance standards from the compliance catalog

#### Navigation

  Cortex provides lists of available standards and controls in the Standards and Controls catalogs under Posture Management → Compliance → Catalogs

#### 7.2.1. Standards Catalog

##### 7.2.1.1. Use a built-in or custom standard

#### 7.2.2. Controls catalog

##### 7.2.2.1. Use a built-in or custom control

###### 7.2.2.1.1. Add a custom detection rule to a custom control

####### Note

* Only custom detection rules (not built-in) can be assigned to custom controls.

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

###### 7.2.2.1.2. Create a new Custom Detection Rule

####### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

####### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

### 7.3. Use an assessment profile to run compliance checks on your assets

#### Navigation

  Under Posture Management → Compliance → Assessment Profiles, click Create New Assessment

### 7.4. View and manage compliance assessments and reports

#### Note

* Compliance assessment results may take up to six hours to be generated.

#### 7.4.1. Assessments

##### Note

* If there are no rules associated with the control, the control will be assigned a severity of low.

#### 7.4.2. Reports

##### Navigation

  The Posture Management → Compliance → Results → Reports page shows a table listing compliance assessment report files

### 7.5. View the compliance assessment of an individual asset

## 8. Discovery Engine

### 8.1. What is the Discovery Engine?

## 9. Cortex Cloud AI Security

### 9.1. What is Cortex Cloud AI Security?

### 9.2. Supported services in Cortex Cloud AI Security

### 9.3. Cortex Cloud AI Security concepts

### 9.4. Cortex Cloud AI Security use cases

### 9.5. How to perform advanced AI Security investigations using XQL

#### Note

* For more information, see Build XQL queries.

10. Cortex Cloud Application Security

  10.1. Onboard Data Sources

  10.1.1. Onboard version control systems

#### Note

* Cortex Cloud Application Security (which includes IaC and Secrets scanning), is an add-on to a license (such as Posture Security) that must be purchased separately.

* Disclaimer: When onboarding with third-party data sources, we outline the required steps for setup, but we do not monitor these external resources, and they may change over time. Always refer to the relevant third-party documentation for the most current integration steps.

#### Tip

* Navigate to Settings → Data Sources & Integrations → + Add New →  and enter your VCS data source in the search bar.

  10.1.1.1. AWS CodeCommit

#### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) AWS User Permissions: To onboard CodeCommit, the user logged into the AWS Console must have permissions to create (deploy) the CloudFormation stack provided by the wizard.    Permission:...

#### Note

* The Resource Name Prefix and ExternalID fields are pre-populated. You can modify the Resource Name Prefix, but DO NOT change the ExternalID!

* To create an additional AWS CodeCommit instance: Hover over the AWS CodeCommit card in the catalog and click Connect Another.

#### Tip

* The instance ID is identical to the stack ID on the AWS platform.

  10.1.1.2. Azure DevOps

#### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) Azure DevOps permissions: Ensure the user performing the integration holds one of the following roles in Azure DevOps:    Project Administrator: This permission is required to subscribe to...

#### Note

* This forces Azure to bypass browser cookies and issue a token for the correct directory.

* PATs are static. To onboard a different tenant, you must log in to that specific environment to generate a new token.

#### Important

* When redirected to the Microsoft login screen, do not immediately enter your email.

#### Navigation

  Settings → Data Sources & Integrations → + Add New

  User Settings → Personal access tokens → + New Token

  10.1.1.2.1. Azure DevOps onboarding system architecture

#### Note

* Microsoft has announced the deprecation of legacy OAuth methods by 2026, making Entra ID the required standard for long-term support.

  10.1.1.3. Bitbucket Cloud

#### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Bitbucket, grant the user performing the Cortex application authorization the following permissions. The level of access required depends on the modules you intend to use:    For code...

#### Note

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Cloud instance: Hover over the Bitbucket Cloud card in the catalog and click Connect Another.

  10.1.1.4. Bitbucket Data Center

#### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Bitbucket, grant the user performing the Cortex application authorization the following permissions:    Administrator permissions for projects   Administrator permissions for...

#### Note

* By default, the permissions of the access token are set according to your current access level. It is essential to define two levels of permissions, Project and Repository permissions. The Repository permissions inherit from Project permissions, requiring Repository permissions to match or exceed Project permissions Providing read and write permissions...

* For additional security, it is recommended to set an expiry automatically. The expiry date of a token cannot be changed after it is created. You can see the expiry dates for all your tokens on Profile picture → Manage account → Personal access tokens.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Data Center instance: Hover over the Bitbucket Data Center card in the catalog and click Connect Another.

#### Important

* Always refer to the Bitbucket documentation for information relating to creating a PAT.

  10.1.1.5. GitHub Cloud

#### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In GitHub, grant the user performing the Cortex application authorization the following permissions:    Organization Owner: Only an Organization Owner can directly authorize and install the...

#### Note

* To create an additional GitHub SaaS instance: Hover over the GitHub SaaS card in the catalog and click Connect Another.

#### Navigation

  Settings → Data Sources & Integrations → + Add New

  Verify integration: On Data Sources, select Code Providers → GitHub SaaS → View more and confirm that the status of your integrated GitHub instance is 'Connected

  10.1.1.6. GitHub Enterprise (On-Prem)

#### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In GitHub, you must have Organization Owner permissions to install the Cortex application. Users with only repository-level admin permissions cannot complete the installation unless the...

#### Note

* The domain is the hostname associated with your GitHub Enterprise (On-Prem) instance.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitHub Enterprise (On-Prem) instance: Hover over the GitHub Enterprise (On-Prem) card in the catalog and click Connect Another.

  10.1.1.7. GitLab SaaS

#### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Gitlab, the following permissions are required to integrate the application:    Maintainer (Project-level). Grants sufficient permissions to configure external integrations, manage...

#### Note

* A repository can only be integrated with a single instance. The first instance that connects with the repository will be the one that the repository is assigned to. This means that if multiple integrations attempt to connect to the same repository, only the first integration to establish the connection will be associated with that repository.

* To create an additional GitLab SaaS instance: Hover over the GitLab SaaS card and click in the catalog and Connect Another.

  10.1.1.8. GitLab Self Managed (On-Prem)

#### Prerequisite

* Authorize the user integrating Cortex Cloud Application Security with your GitLab Self Managed (On-Prem) instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including...

#### Note

* The domain is the hostname associated with your GitLab Self Managed (On-Prem) instance.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitLab Self Managed (On-Prem) instance: Hover over the GitLab Self Managed (On-Prem) card in the catalog and click Connect Another.

  10.1.2. Onboard CI/CD systems

  10.1.2.1. Onboard CircleCI for CI/CD pipeline scans

#### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) CircleCI user requirements:    Permissions: To enable Cortex Cloud visibility for all CircleCI projects, a version control system (VCS) user with integration permissions must be authorized...

#### Note

* This integration utilizes a Personal Access Token (PAT) for authentication CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate...

* Select Add Another Instance if the data source instance has already been configured.

* To add an additional CircleCI instance, navigate to Settings → Data Sources & Integrations → , select the connected CircleCI integration, click  → Add Instance, and repeat the onboarding steps above.

  10.1.2.2. Onboard Jenkins for CI/CD pipeline scans

#### Prerequisite

* Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Jenkins:    To install and configure the Cortex plugin in Jenkins, you must be a Jenkins Administrator with Overall/Administer permissions   Ensure the build server allows outbound HTTPS (Port 443 traffic...

#### Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for code scans, refer to Onboard...

* Select Add Another Instance if the data source instance has already been configured.

* The integration is added on the console but integration is pending, and will only be completed after completing step 5 below. You can view the pending integration on the Jenkins Instances page: Select Data Sources →  Jenkins → View Details. The type of integration is Pipeline Risks

* Always refer to the official Jenkins documentation when installing plugins on Jenkins servers.

* To add an additional Jenkins instance, navigate to Settings → Data Sources → select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps above.

  10.1.3. Integrate CI tools

#### Navigation

  Settings → Data Sources & Integrations → hover over a CI tool → View Details

  Delete an instance: Right-click on an instance of the CI tool → Delete instance → Delete

  10.1.3.1. AWS CodeBuild

#### Prerequisite

* Before you begin:

#### Note

* Select Add Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional AWS CodeBuild instance, navigate to the Settings → Data Sources & Integrations →  page, select the connected AWS CodeBuild integration, click → Add Instance, and repeat the onboarding steps above.

  10.1.3.2. Onboard CircleCI for code scans

#### Prerequisite

* Before you begin:

#### Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for CI/CD scans, refer to...

* Select Add Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* To add an additional CircleCI instance, navigate to Settings → Data Sources & Integrations → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

#### Important

* The cortex-secrets naming convention for the context is mandatory to ensure functionality and must not be changed.

  10.1.3.3. Connect Cortex CLI

#### Prerequisite

* System requirements (OS-specific): The following operating system dependencies are required to run the Cortex Cloud CLI binary on specific architectures.    macOS (Intel Core i7, such as Sequoia):    To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew. Use this command: brew install vectorscan      RHEL...

#### Note

* Select Add Another Instance if a CLI instance is already onboarded.

* In the command above, {version} refers to the CLI version you wish to install (such as latest or a specific number), and {platform} refers to your operating system (such as, linux, darwin, windows).

#### Warning

* Using With upload results permissions may incur additional costs as per your license agreement.

  10.1.3.4. GitHub Actions

#### Prerequisite

* Before you begin:

#### Note

* Select Add Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional GitHub Actions instance, navigate to Settings → Data Sources & Integrations → select the menu for your connected GitHub Actions instance → + New Instance, and repeat the onboarding steps above.

  10.1.3.5. Onboard Jenkins for code scans

#### Prerequisite

* Grant Administrator permissions to the user integrating Cortex Cloud Application Security with Jenkins Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

* For Cortex Cloud Application Security CI tools, you must store secrets in Jenkins Credentials for use in your Jenkins pipelines using either of these methods:    Plain text storage: Store secrets directly as plain text in Jenkins Credentials. Access them in your pipeline using the credentials function, which retrieves the secret directly as plain...

#### Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for CI/CD scans, refer to Onboard...

* Select Add Another Instance if the data source instance has already been configured.

* This step is only required for new pipelines For private repositories, ensure the necessary credentials are configured in Jenkins Credentials

* This ensures your build runs within a Docker environment. If a node without Docker is used, the build will fail.

* To add an additional Jenkins instance, navigate to Settings → Data Sources & Integrations →  select the Jenkins integration, click  → Add Instance, and repeat the onboarding steps.

  10.1.3.6. Onboard Terraform Cloud (Run Tasks)

#### Prerequisite

* Before you begin: Procure a Terraform cloud license that is either a trial license or a TF Cloud license at the TEAM & GOVERNANCE level Terraform permissions: Grant the user or team the following permissions, depending on integration:    Manage Workspaces permissions at the organization level. These permissions are required to attach and manage the run...

#### Note

* Skip this step if you plan on using an existing token.

* Select Add Another Instance if the data source instance has already been configured.

* Cortex Cloud Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Cloud (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected your Terraform Cloud (Run Tasks) instance → + New Instance, and repeat the onboarding steps.

  10.1.3.7. Onboard Terraform Enterprise (Run Tasks)

#### Prerequisite

* Before you begin: Ensure access to a Terraform Enterprise console to enable you to provide a user or team token that authorizes Cortex Cloud Application Security to access workspaces and helps regulate run configurations Terraform Enterprise version compatibility: Ensure Run Tasks for workspaces on is compatible with version 1.1.9 and above Terraform...

#### Note

* For container image vulnerabilities, Cortex Cloud Application Security performs 'Image Referencer' scans within Terraform Enterprise (Run Tasks), as full SCA scans are not currently supported.

* Skip this step if you plan on using an existing token.

* Select Add Another Instance if the data source instance has already been configured.

* Cortex Cloud Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Enterprise (Run Tasks) instance, navigate to Settings → Data Sources & Integrations →  page, select the Terraform Enterprise (Run Tasks) integration, click  → Add Instance, and repeat the onboarding steps above.

  10.1.4. CLI pipeline code snippets

#### Prerequisite

* User permissions: Ensure the user performing the integration has permissions to edit pipeline configurations (such as YAML files).

  10.1.5. Onboard private package registries

  10.1.5.1. JFrog Artifactory

  10.1.5.2. Onboard JFrog Artifactory

#### Prerequisite

* Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) JFrog permissions:    The permissions associated with the user configured during the onboarding process determine the scope of scan results. Only repositories and artifacts the user can access are...

#### Note

* To authorize the scanner to connect through your firewall, select Enable access by IPs, and copy the displayed source IPs to your organization's allowlist.

* For Maven:    Select Mirror Registry if this repository mirrors an external repository   Use the Mirror Of value to define the duplication scope:    * mirrors all requests   Type a request [value]: Mirrors only specific requests (such as central). For Maven: Select Mirror Registry if this repository mirrors an external repository Use the Mirror Of...

  10.1.6. Supported third-party data sources

#### Note

* Only onboarded and scanned repositories can be mapped.

  10.1.6.1. Ingest Semgrep data

#### Prerequisite

* Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) Ensure that you have a connected version control system (VCS) and repositories Create a Semgrep API token  Note    To create a Semgrep API token, in Semgrep, navigate to Settings → Tokens → API...

#### Note

* Select Add Another Instance if the data source instance has already been configured.

* Mapping establishes relationships between Semgrep projects and Cortex Cloud code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects are ingested

  10.1.6.2. Ingest Snyk data

#### Prerequisite

* Permissions: The following user permissions are required:     Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator)    Ensure that you have a connected version control system (VCS) and repositories   Snyk API token:    Recommended. Generate an API token from a...

#### Note

* Select Add Another Instance if the data source instance has already been configured.

* Mapping establishes relationships between Snyk applications and Cortex Cloud code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped applications are ingested

#### Navigation

  Modules → Application Security → Vulnerabilities (under Issues

  10.1.6.3. Ingest SonarQube SAST data

#### Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Generate and copy a SonarQube API token. Ensure to assign Web API scope to the API token. Refer...

#### Note

* Mapping establishes relationships between SonarQube Applications and Cortex Cloud Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

  10.1.6.4. Ingest Veracode SAST data

#### Prerequisite

* Permissions: The following user permissions are required:    Cortex Cloud: Instance Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions   Veracode: At minimum, Reviewer permissions are required Permissions: The following user permissions are required: Cortex...

#### Note

* Only mapped applications will be ingested.

* This is the recommended option to ensure complete coverage and successful operation of all features.

* Mapping establishes relationships between Veracode projects and Cortex Cloud Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

  10.1.6.5. Generic 3rd Party AppSec Collector

#### Important

* File uploads are limited to a maximum size of 10 MB.

  10.1.6.5.1. Onboard the 3rd Party AppSec Collector

#### Prerequisite

* Permissions: The following Cortex Cloud user roles or RBAC permissions are required:    User roles: CortexCortex Cloud Cloud Instance Admin, AppSec Admin   RBAC: View/Edit permissions for Data Sources configurations are required when not using a dedicated user role    For more information about user permissions and groups, refer to Assign user roles...

#### Note

* We recommend using the tool.driver.name from the SARIF file.

* This is the newly created generic collector API URL endpoint.

* Only the validity of the format is tested. No findings will be generated from the test file.

#### Warning

* The API key ID and API secret cannot be retrieved once the wizard is closed.

  10.1.7. Manage data source integrations

#### Tip

* To quickly find your data source integration, use the search bar.

  10.1.8. Transporter over Broker VM

#### Prerequisite

* Ensure you have the necessary permissions and have already set up your Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex Cloud resources. The IP addresses for the Transporter are in the Broker VM Resources section of the Enable access to required PANW resources document Open port 4052 (inbound), which...

#### Note

* The broker enables multiple connections, allowing a single Transporter applet to connect to various VCS instances Multiple Transporter applets cannot be created on a single Broker VM. Each Broker VM is limited to a single Transporter applet instance

#### Warning

* The Transporter applet is not supported for FedRAMP customers.

  10.1.8.1. Set up a Transporter applet on Broker VM

#### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator)

#### Note

* You cannot add a Transporter applet through Clusters.

#### Navigation

  your AppSec Transporter under the App column → Configure → Add Connection (on the redirected AppSec Transporter setup page

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

  10.1.8.2. Set up a Transporter on your VCS

#### Prerequisite

* Ensure you have user permissions to onboard data sources.  Note The dedicated AppSec Admin role includes the required permissions. Ensure you have user permissions to onboard data sources. Before you begin you must setup a Transporter applet on your Broker VM. Refer to Set up a Transporter applet on Broker VM for more information

#### Note

* GitLab Enterprise webhook internal IP restriction: GitLab Enterprise's security policies prevent webhook subscriptions to internal IP addresses (such as broker addresses). These subscriptions can only be enabled through specific instance configuration. For more information, refer to https://docs.gitlab.com/security/webhooks/.

#### Navigation

  Settings → Data Sources & Integrations → + Add New → , and search for your VCS on-premises data source

  10.2. Cortex Cloud Application Security dashboard

#### Navigation

  Modules → Application Security → AppSec Dashboard

  10.3. Application Security Posture Management (ASPM)

  10.3.1. ASPM use cases

  10.3.2. ASPM key features

  10.3.3. ASPM user roles and permissions

#### Navigation

  You can view AppSec Admin permissions in the tenant by navigating to Settings → Configurations → Roles → AppSec Admin

  10.3.4. Code to Cloud

#### Navigation

  Full Code to Cloud (C2C) coverage is achieved when Cortex Cloud can resolve the following chain: Repository → Pipeline → Image → (optional Registry) → Runtime resources (including VMs, VM images, and IaC-defined infrastructure

  10.3.4.1. Supported integrations

  10.3.4.2. Code to Cloud visibility

#### Navigation

  Topology graph: Located in the Business Applications side card, this tab visualizes the entire path to production (Code → Build → Deploy → Run), allowing you

  10.3.4.3. Code to Cloud troubleshooting

#### Note

* Empty state messages and troubleshooting guidance for missing lineage are only visible to users with an active license.

  10.3.5. ASPM Command Center

  10.3.5.1. ASPM Command Center workflow

#### Note

* Breakdown by type: Issues are further broken down by type (such as IAC or Secrets).

  10.3.6. Coverage

  10.3.6.1. Coverage in the user interface

#### Navigation

  Modules, → Application Security → AppSec Coverage

  10.3.7. Compliance for Cortex Cloud Application Security

  10.3.7.1. Infrastructure-as-Code (IaC) compliance

  10.3.7.2. Manage IaC compliance

#### Prerequisite

* Add these properties to the IaC Rules table through the Table Settings Menu, as they are not exposed by default.

#### Navigation

  Modules → Application Security → AppSec Polices → Add Policy

  10.3.7.3. CI/CD Compliance

#### Navigation

  To access Compliance, select Posture Management → Compliance → Reports or Assessment

  10.3.7.3.1. Create CI/CD compliance reports

#### Note

* The CI/CD module supports GitHub and GitLab provider types.

* For more information about about Asset Groups, refer to Asset Groups.

* CIS GitLab Benchmark, CIS GitHub Benchmark, and the OWASP Top 10 CI/CD Risks standards are supported.

* For more information about assessment profiles, refer to Use an assessment profile to run compliance checks on your assets.

#### Navigation

  Posture Management → Compliance → Reports

  10.3.8. Urgency

  10.3.8.1. Urgency metrics

  10.3.9. Backlog baseline

  10.3.9.1. Backlog use cases

  10.3.9.2. Issue/Finding classification by scanner

#### Note

* In some cases/vendors, this is not accurate as findings are deleted every time new findings are uploaded. In such cases, the feature may not be accurate or supported For SAST, the vendor does not support policy in pull requests

* Scanner updates and new detections: When a security scanner is updated to support new languages, detection rules, or capabilities, any issues discovered by these new features for existing code are classified as part of the backlog.

  10.3.9.3. Using Backlog

  10.3.10. Service Lead Agreements (SLA)

  10.3.10.1. Configure and monitor Cortex Cloud Application Security SLAs

#### Navigation

  Settings → Configurations → Application Configuration (under Application Security

  10.3.11. Applications

  10.3.11.1. Defining Business Applications

  10.3.11.1.1. Defining business applications by Criteria

  10.3.11.1.2. Define applications by VCS criteria

#### Prerequisite

* Data source: Your Version Control System (e.g., GitHub, GitLab) must already be onboarded as a Data Source Permissions: You must have View/Edit permissions for Access Management SBAC: You can only create applications from VCS entities (Organizations, Projects, or Repositories) that are already included in your SBAC Asset Groups

#### Note

* This workflow allows you to unify assets across disparate providers (such as grouping a GitHub repository and a Bitbucket repository into one application) if they share naming conventions

  10.3.11.1.3. Manage application criteria

  10.3.11.1.4. Define applications by cloud tag-based criteria

#### Prerequisite

* Permissions: You must have View/Edit permissions for Access Management, or a role that includes these permissions.

#### Note

* You can only create applications based on the entities from onboarded Cloud accounts listed in the Cloud card.

* Kubernetes (K8S) labels: K8S labels are supported as tags for asset grouping only when they originate from a supported cloud provider; AWS, GCP, Azure, or OCI.

  10.3.11.1.5. How to manually build an application

#### Prerequisite

* Before you begin, ensure you have connected the necessary data sources. Refer to How to onboard data sources for more information.How to onboard data sources

#### Note

* These filters are represented by icons displayed on the Code pane after selecting a VCS.

* To edit application assets, click the Clear All icon before clicking Finish. This clears all application data, allowing you to restart the application building process from the beginning.

  10.3.11.2. Application management and visibility

#### Navigation

  Inventory → All Assets → Business Applications (under Application

  10.3.11.3. Business application assets

  10.3.11.3.1. Business application expanded asset details

#### Note

* The topology graph is available only when all application components (code, pipeline, build and deploy), are configured.

  10.3.11.3.2. Export business application data

#### Navigation

  Inventory → All Assets → Business Applications

  10.3.11.4. Scope user access to applications (Application SBAC)

#### Navigation

  Configure user scopes in Cortex Cloud by navigating to Settings → Configurations → Access Management

  10.3.11.4.1. Enable SBAC in the Cortex Cloud tenant

#### Prerequisite

* RBAC permissions: To configure user scopes you must have Administrator or View/Edit RBAC permissions for Access Management (under Configurations).

#### Note

* Exclusions (roles not governed by SBAC): Certain roles cannot have SBAC applied. For these roles, access and permissions are managed through Role-Based Access Control (RBAC). You must manually ensure that these roles have all necessary base permissions (for example Edit/View permissions to assets), because SBAC is bypassed and does not impose its usual...

#### Navigation

  Settings → Configurations → General → Server Settings → Enable Scope Based Access Control

  10.3.11.4.2. Create an application-based Asset Group

#### Note

* You cannot create SBAC based on static groups.

  10.3.11.4.3. Scope user access to an application

#### Note

* For more information about User Groups, refer to User group management.

#### Navigation

  Settings → Configurations → User Groups (under Access Management

  Right-click on a group in the table → Edit Group → select the Scope tab

  Assets → Select asset groups → select an Asset Group associated with applications

  Settings → Configurations → Users (under Access Management

  the chevron icon (>) in the Assets field → Select Asset groups → select the user group scoped to the application (see above

  10.3.11.4.4. Create application-scoped policies

#### Note

* Application-scoped policies apply to both code and CI/CD configuration policies.

#### Navigation

  Modules → Application Security → AppSec Polices (under Policy Management) → Add Policy

  Add Filter → Business Application Names → enter the required application name

  10.3.12. Repositories as assets

  10.3.12.1. Explore repository assets

  10.3.12.2. In-depth repository asset information

  10.3.12.3. Manage Repository assets

  10.3.12.4. Export Software Bill of Materials (SBOM)

  10.3.12.5. Manage issues detected in repositories

#### Note

* You can also find the repository issues in the general issue inventory table, and in the dedicated inventory of issues for each scanner type (see step 4 above for details).

  10.3.13. Manage 3rd party findings and generated issues

  10.3.14. Manage code weaknesses

#### Note

* You can customize policies to define which findings are categorized as issues.

#### Tip

* In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Code Weaknesses tab under the Repositories asset inventory. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from the table → Code Weaknesses In code Asset inventories, navigate to Inventory →...

#### Navigation

  To access SAST code violation issues, under Modules, select Application Security → Issues → Code Weaknesses

  10.3.14.1. Code weaknesses issue inventory

  10.3.14.2. Detailed code weakness issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  10.3.14.3. Code weakness findings

#### Note

* Findings on the Cortex platform are not intended for direct action; but rather represent data collected by the platform. They must be promoted to issues to enable mitigation efforts to secure your codebase.

  10.4. CI/CD Security

  10.4.1. CI/CD Security user roles and permissions

  10.4.2. CI/CD Assets

  10.4.2.1. CI/CD Instances as assets

  10.4.2.1.1. Explore CI/CD Instance assets

#### Navigation

  To access CI/CD pipeline instances, under Inventory, select All Assets → Code → Category → CI/CD Instances

  10.4.2.1.2. In-depth CI/CD pipeline instance asset information

  10.4.2.1.3. Manage CI/CD pipeline instances

  10.4.2.2. CI/CD Pipelines as assets

  10.4.2.2.1. Explore CI/CD Pipeline assets

#### Navigation

  To access CI/CD pipelines assets, under Inventory, select All Assets → Code → CI/CD Pipelines

  10.4.2.2.2. In-depth CI/CD pipeline asset information

#### Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

  10.4.2.2.3. Manage CI/CD pipeline assets

  10.4.2.3. Version Control System (VCS) Organizations as assets

  10.4.2.3.1. Explore VCS Organization assets

#### Navigation

  To access VCS Organization assets, under Inventory, select All Assets → Code → VCS Organizations

  10.4.2.3.2. In-depth VCS Organization asset information

#### Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

  10.4.2.3.3. Manage VCS organization assets

  10.4.2.4. VCS Collaborators-as-assets

  10.4.2.4.1. In-depth Collaborator asset information

  10.4.2.4.2. Manage Collaborator assets

  10.4.3. Supply Chain Inventories

#### Note

* Although attributes are identical across inventories, their values for the same tool can differ, most commonly in Risk Factors and Type. This is because the inventory reflects your live environment, which may include different versions or configurations than the catalog—for example, a package may not have been upgraded or may be deployed differently.

#### Navigation

  In the inventory table, right-click on a tool → Change Status → select a status

  10.4.3.1. Supply Chain Tools

  10.4.3.1.1. Supply Chain Tools

#### Navigation

  To access Supply Chain Tools, select Modules → Application Security → Supply Chain Tools (under 3rd Party Tools

  10.4.3.1.2. Expanded Supply Chain tool information

#### Note

* AppSec Admin user permissions are required to perform these actions.

  10.4.3.2. Supply Chain Catalog

#### Navigation

  To access the Supply Chain Catalog, select Modules → Application Security → Supply Chain Catalog (under 3rd party tools

  10.4.4. CI/CD Risks

#### Note

* Cortex Cloud Application Security CI/CD pipeline scans create a comprehensive inventory of all CI/CD pipelines in your environment. For more information refer to CI/CD Pipelines as assets.

  10.4.4.1. CI/CD pipeline issues

#### Navigation

  To access CI/CD pipeline risks issues, under Modules, select Application Security → Issues → CI/CD Risks

  10.4.4.2. Expanded CI/CD risks issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  10.4.4.3. VCS and CI/CD pipeline risk findings

  10.4.5. CI/CD Rules

#### Note

* Out-of-the-box rules cannot be modified Custom CI/CD rules are not supported

  10.4.5.1. CI/CD rules roles and permissions

  10.4.5.2. CI/CD rules inventory

  10.4.6. CI/CD Policies

#### Tip

* For Cortex Cloud Code policies, refer to Application Security Policies.

  10.4.6.1. CI/CD policies user roles and permissions

  10.4.6.2. CI/CD policies inventory

#### Note

* To view all out-of-the-box (OOTB) policies, filter by Policy Owner = System.

  10.4.6.3. Create custom CI/CD policies

#### Note

* PR Scan and CI Scan triggers are automatically disabled and unchecked. They can only be enabled if other scan types (that is non-CI/CD risk scans such as Secrets) are also selected, and will only run on non-CI/CD risks types of scans

* You can combine multiple conditions to create complex rules for when the policy should apply. Create conditions that apply to a CI/CD policy which detects high severity CI/CD risks on GitHub: Select Add Filter → Finding Type → CI/CD Risks → AND → Provider → [VCS/CI/CD system] → AND → Severity: → High.

* SBAC scope limitations do not apply to Matching Criteria For CI/CD policies, you can filter Matching Criteria by VCS Organization Name, CI/CD Pipeline [Name/ID], CI/CD Instance [Name/ID] or Collaborator [Name/Email/MFA Enabled/Last Observed]

  10.4.6.4. Manage CI/CD policies

#### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

  10.5. Code Security

  10.5.1. Code Security user roles and permissions

  10.5.2. Code Security assets

  10.5.3. Software packages as assets

  10.5.3.1. Explore software package assets

  10.5.3.2. In-depth software package asset information

  10.5.4. Infrastructure-as-Code (IaC) resources as assets

  10.5.4.1. Explore IaC assets

#### Navigation

  To access IaC assets, under Inventory, select All Assets → Code → IaC Resources

  10.5.4.2. In-depth IaC resource asset information

  10.5.5. Code Security scanners

  10.5.6. Secrets scanners

  10.5.6.1. Secrets issues

#### Navigation

  Under Modules, select Application Security → Issues → Secrets

  Inventory → All Assets → Code: On the Secrets tab under Repositories

  Inventory → All Assets → Code

  Inventory → All Assets → Application → select an option from the Application menu → select an item from the inventory → Secrets

  10.5.6.2. Secrets issues inventory

  10.5.6.3. Detailed Secrets issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  10.5.6.4. Secrets findings

#### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

#### Navigation

  The Cortex Cloud Application Security Secrets Findings table is a pre-filtered view of the comprehensive Findings inventory (located at Cases & Issues → Issues → Findings Table tab

  To access Secrets findings, select Application Security → Issues → Secrets → click the Findings tab

  10.5.6.5. Manage Secrets issues

  10.5.7. Infrastructure as Code (IaC) misconfiguration scanner

  10.5.7.1. Supported frameworks and languages

  10.5.7.2. IaC misconfiguration issues

#### Tip

* You can also view IaC misconfiguration issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Configuration tab under Repository assets. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from...

#### Navigation

  To access IaC misconfiguration issues, under Modules, select Application Security → Issues → IaC misconfiguration

  10.5.7.3. IaC misconfiguration issues inventory

  10.5.7.4. Detailed IaC misconfiguration issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  10.5.7.5. IaC misconfiguration findings

#### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

#### Navigation

  To access IaC misconfiguration findings, under Modules, select Application Security → Issues → IaC Misconfigurations → click the Findings tab

  10.5.7.6. Manage IaC misconfiguration issues

  10.5.8. IaC Drift Detection scans

  10.5.8.1. IaC Drift Detection issues

#### Navigation

  Modules → Application Security → IaC Drifts

  10.5.8.2. IaC Drift Detection issue inventory

  10.5.8.3. Detailed IaC drift detection issue information

  10.5.8.4. IaC Drift Detection findings

#### Navigation

  Modules → Application Security → IaC Drifts (under Issues) → click the Findings tab

  10.5.9. Software Composition Analysis (SCA ) scanners

  10.5.9.1. Supported Software Composition Analysis (SCA) frameworks and languages

  10.5.9.2. Software Composition Analysis (SCA) vulnerability issues

#### Tip

* In Asset inventories, navigate to Inventory → All Assets → Code:    On the Vulnerabilities tab under Repositories. Refer to In-depth repository asset information for more information Under the All Code inventory: Select an asset from the table → Vulnerabilities In Asset inventories, navigate to Inventory → All Assets → Code: On the...

#### Navigation

  To access CVE vulnerability issues, under Modules, select Application Security → Issues → Vulnerabilities

  10.5.9.2.1. Vulnerability issues inventory

  10.5.9.2.2. Detailed vulnerability issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  10.5.9.2.3. CVE vulnerabilities findings

#### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

#### Navigation

  The Cortex Cloud Application Security Vulnerabilities Findings table is a pre-filtered view of the comprehensive Findings inventory (located at Cases & Issues → Issues → Findings Table tab

  To access CVE findings, under Modules, select Application Security → Issues → Vulnerabilities → click the Findings tab

  10.5.9.2.4. Manage SCA CVE vulnerability issues

  10.5.9.3. License miscompliance issues

#### Tip

* You can also view license miscompliance issues in dedicated tabs under other sections when available: In Application asset inventories: navigate to Inventory → All Assets →  Application → select an option from the Application menu → select an item from the inventory → Package Integrity In Asset inventories, navigate to Inventory → All...

#### Navigation

  To access license miscompliance issues, under Modules, select Application Security → Issues → Licenses

  10.5.9.3.1. License miscompliance issues inventory

  10.5.9.3.2. Expanded License miscompliance issues information

  10.5.9.3.3. License miscompliance findings

#### Navigation

  To access license miscompliance findings, under Modules, select Application Security → Issues → Licenses → click the Findings tab

  10.5.9.3.4. Open-source software license categories

  10.5.9.3.5. Manage license miscompliance issues

  10.5.9.4. Package Integrity

  10.5.9.4.1. Package Integrity inventory

#### Note

* You can modify the severity level from the severity field menu.

  10.5.9.4.2. Expanded Package Integrity issues inventory information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  10.5.9.4.3. Package Integrity findings

#### Note

* Findings cannot be mitigated. They must be promoted to issues to enable remediation efforts to secure your software packages.

  10.5.9.4.4. Manage Package Integrity issues

  10.5.10. Application Security scans management

  10.5.10.1. Overview

#### Note

* While scans provide a comprehensive inventory of all issues detected during a scan, dedicated inventories are also maintained for specific scan types for more granular management. For more information, refer to Infrastructure as Code (IaC) misconfiguration scanner, Secrets scanners and Software Composition Analysis (SCA ) scanners.

  10.5.10.2. Branch periodic scans

#### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

  10.5.10.3. Pull Request scans

#### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

  10.5.10.4. CI scans

#### Note

* The inventory table displays scan issues for visibility only; remediation is not available in scan management. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

  10.5.10.5. Manage repository scan configurations

  10.5.10.6. Monitor data source instances health

  10.5.11. Application Security Policies

  10.5.11.1. User roles and permissions

  10.5.11.2. Policies inventory

#### Note

* To view all out-of-the-box (OOTB) policies, filter by Policy Owner = System.

  10.5.11.3. AI-recommended guardrails

  10.5.11.3.1. Manage AI-recommended guardrails

#### Note

* Recommended guardrails are generated based exclusively on findings from the Cortex Cloud Application Security Software Composition Analysis (SCA) scanner. They do not support SCA data ingested from third-party scanners, nor do they currently support other finding categories, such as Secrets or Infrastructure as Code (IaC).

* The total amount of available recommended guardrails is displayed on the AI Recommendations button.

* The AI-Recommended tag is only assigned to recommendations applied as-is, that is, without modifications. Edited recommendations generate policies without this label.

  10.5.11.4. Create Cortex Cloud Application Security policies

#### Note

* When an issue is created, only the first policy ID that triggered the issue is associated with it.

  10.5.11.4.1. Create code security policies

#### Note

* For a detailed list of all available attributes and their values by scanner type, refer to Cortex Cloud Application Security code policy Condition attributes .

* SBAC scope-based limitations do not apply to Asset Types

* When selecting Asset Groups, the code policy is evaluated only on the application and repository assets included in the group.

* For each application that matches the criteria, the policy is evaluated only on the repositories associated with that application.

* If you select only Code Weaknesses as the Finding Type in the condition step (indicating a third-party scanner), the PR and CI triggers are disabled, leaving only Periodic Scan enabled.

  10.5.11.4.1.1. Cortex Cloud Application Security code policy Condition attributes

  10.5.11.4.2. Create IaC Drift Detection policies

#### Navigation

  Modules → Application Security → AppSec Policies → Add Policies

  10.5.11.4.3. Manage Cortex Cloud Application Security policies

#### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

  10.5.12. Application Security Rules

#### Note

* Out-of-the-box rules cannot be modified directly. However, you can create a custom rule by cloning the existing one. This allows you to make changes to the original rule according to your requirements. Refer to Manage Cortex Cloud Application Security custom rules for more information.

  10.5.12.1. Roles and permissions

  10.5.12.2. Rules inventory

#### Navigation

  To filter rules relating to Secrets, select filter icon → Scanner (from the Select field) → Secrets (from the Value field

  10.5.12.3. Create custom Cortex Cloud Application Security rules

#### Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

  10.5.12.4. Manage Cortex Cloud Application Security custom rules

  10.5.12.5. Configure YAML file properties

  10.5.13. Application Security CLI

#### Prerequisite

* These requirements apply specifically to the Application Security CLI. For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of...

#### Note

* For detailed information about the Cortex Cloud CLI, refer to Cortex CLI.

  10.5.13.1. Connect Cortex CLI

#### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

#### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources & Integrations →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Cortex Cloud Application Security, refer to Cortex CLI usage for Cortex Cloud Application Security

#### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source or Integrations page after selecting + Add New.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

  10.5.13.2. Cortex CLI usage for Cortex Cloud Application Security

  10.5.13.3. CLI pipeline code snippets

#### Prerequisite

* User permissions: Ensure the user performing the integration has permissions to edit pipeline configurations (such as YAML files).

  10.5.13.4. Cortex CLI Cortex Cloud Application Security command line reference

#### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

#### Important

* The Cortex CLI Cortex Cloud Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id...

  10.5.13.5. Cortex CLI common command line reference guide

#### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

  10.5.13.6. Git Hooks

  10.5.13.6.1. Cortex CLI pre-commit hooks

#### Prerequisite

* These common prerequisites are required for all types of installation (both local and global) of the Cortex CLI pre-commit hook. Ensure you have a license for Cortex Cloud Application Security Install the Cortex Cloud CLI binary locally. Refer to Connect Cortex CLI for information about onboarding the CLIConnect Cortex CLI Obtain Cortex Cloud API...

* For local installation: Install the pre-commit framework version 3.2.0 or greater. Refer to https://pre-commit.com/ for installation instructions.

#### Note

* It is recommended you configure credentials for the Cortex CLI using a configuration file.

* The pre-commit framework is not required for global mode.

  10.5.13.6.1.1. Pre-commit hook usage

  10.5.13.6.2. Cortex CLI pre-receive hooks

#### Prerequisite

* Before you begin, ensure you have: Administrator access to the VCS server and console A valid license for Cortex Cloud Application Security The Cortex Cloud CLI binary or Docker image installed on the server (requires GLIBC (GNU C library) version 2.35 or greater). Refer to Connect Cortex CLI for information about onboarding the CLIConnect Cortex...

#### Note

* Make sure to create the directory under the home directory of the Linux user that runs the Git hooks. This user is typically not the root user.

  10.5.13.6.2.1. Pre-receive hook usage

  10.5.14. IDE

#### Note

* Not all remediation options are available for all findings or all type of scan category.

  10.5.14.1. System requirements

  10.5.14.2. Visual Studio (VS) Code and VS Code compatible IDEs

#### Prerequisite

* Before you begin (These prerequisites apply to both VS Code and VS Code compatibles): Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

#### Note

* Enforcement rules and CA certificates are not applicable to the open-source project.

#### Tip

* You can access Extensions using the keyboard shortcuts Ctrl+Shift+X (Windows) or Cmd+Shift+X (macOS).

#### Navigation

  Install through VS Code IDE Access the Activity bar → Extensions → Cortex Cloud → Install

  Access the Activity bar → Extensions → Cortex Cloud → Install

  10.5.14.2.1. How to use the Cortex Cloud extension in VS Code

#### Note

* Not all remediation options are available for all issues.

* The suppression is scoped to the file.

  10.5.14.3. JetBrains

#### Prerequisite

* Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install Node.js version 22 and...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

#### Note

* The Cortex AppSec code security plugin supports all JetBrains products.

#### Navigation

  Settings → Plugins → select the Marketplace tab → search for Prisma Cloud → Install → OK

  Settings → Tools → Cortex Cloud

  10.5.14.3.1. How to use the JetBrains Cortex Cloud extension

#### Note

* After selecting Fix Available, the number of issues displayed in the issue categories (such as IaC) reflect the number of fixable issues for that type.

* The corresponding file simultaneously opens in the Code editor, highlighting the issue within its exact code context. See below for more information.

* Not all types of remediation are available for all issue categories. For example, fixes are not available for License issues.

* Secrets and Licenses category issues are typically mitigated by following the guidance in the Documentation.

  10.5.15. Developer Suppressions

#### Note

* The check IDs and rule names are placeholders for illustration purposes and do not correspond to actual checks.

  10.6. API documentation

11. Cortex Cloud Data Classification

  11.1. What is Cortex Cloud Data Classification?

#### Navigation

  To access Data Classification management, click Settings → Configurations → Data Classification

  11.2. How to create and validate a custom data pattern

#### Note

* Once a custom data pattern is saved, it runs on all data in the same way as any out-of-the-box (OOTB) pattern, becoming globally applicable for all modules using Cortex Cloud Data Classification.

* For more information, see How to disable and enable data patterns in Data Classification.How to disable and enable data patterns in Data Classification

  11.3. How to disable and enable data patterns in Data Classification

#### Note

* Disabling data patterns can cause changes in your data profile results and stop detection of these data patterns.

* For more information about data patterns in data classification, see What is Cortex Cloud Data Classification?.

#### Navigation

  In the lower left part of the screen, click Settings → Configurations → Data Classification → Data Patterns

  11.4. How to create and validate a custom data profile

#### Note

* If you choose two data locations, only the filters they have in common will be included in the possible filter options.

* For more information, see How to disable and enable data profiles in Cortex Cloud Data Classification.

#### Important

* Deleting a data profile deletes all past data associated with it in all modules using Cortex Cloud Data Classification after a warning notification is displayed.

* Enabling and disabling a data profile removes or re-adds the data profile results to the data objects; that is, files and tables.

  11.5. How to disable and enable data profiles in Cortex Cloud Data Classification

#### Note

* Existing results on past scans are updated in the Asset and Object inventories within two hours after being disabled or enabled.

* For more information about data profiles in Cortex Cloud Data Classification, see What is Cortex Cloud Data Classification?.What is Cortex Cloud Data Classification?

#### Navigation

  In the lower left part of the screen, click Settings → Configurations → Data Classification → Data Profiles

  11.6. How to report a false positive in Cortex Cloud Data Classification

#### Note

* Alternatively, in Cortex Command Center, click Help → Submit a Support Case.

12. Cortex Cloud Data Security

  12.1. What is Cortex Cloud Data Security?

  12.2. Supported assets in Cortex Cloud Data Security

#### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### Note

* CMK (customer-managed key) in SQL Server is only supported in outpost mode.

* The list above refers to only data classification; however, Cortex Cloud Data Security discovers and monitors all cloud assets and services for usage and misconfigurations.

* For information about configuring data classification asset types, see How to configure the scanning settings for supported services.

  12.3. Cortex Cloud Data Security concepts

  12.4. Cortex Cloud Data Security use cases

  12.5. Data Inventory

#### Note

* To clear the filter in the filter panel, click Delete.

#### Navigation

  When you select Inventory → All Assets → Data → All Data Assets, a list of all data assets appears

  12.6. How to review errors in Cortex Cloud Data Security

  12.7. How to configure the scanning settings for supported services

#### Note

* If you do not select a scanning cadence, the default setting is applied. For more information, contact your Customer Support team.

  12.8. How to perform advanced Data Security investigations using XQL

#### Note

* For more information, see Build XQL queries.

  12.9. How to onboard Databricks

#### Note

* If you turn on this feature, both the cloud and region will be used for scanning, possibly incurring cost and requiring adherence to certain compliance policies.

  12.10. How to onboard Microsoft 365

#### Prerequisite

* You have generated a Globally Unique Identifier (GUID), also known as a Universally Unique Identifier (UUID). You will need this ID for the tenant you want to use for the Microsoft 365 instance. In order to use Microsoft 365, you must be registered with Microsoft Azure.

  12.11. How to onboard on-premise file shares to Cortex Cloud Data Security

#### Note

* Your data is scanned on the Broker VM itself, and only the metadata and classification results are transmitted from the on-premise environment to Cortex Cloud.

* For information about activating the DSPM Fileshare applet, see Activate DSPM Fileshare.

  12.12. How to onboard Snowflake

#### Prerequisite

* In order to use Snowflake, you must be registered with one of these cloud providers: Amazon AWS, Microsoft Azure, or Google Cloud Platform (GCP). Ensure you have the necessary account permissions to onboard. It is recommended to use Account Admin as the role for the onboarding.

#### Note

* The account identifier can be found using the user information at the bottom left. Hover over the account you wish to onboard and select the copy option at the top right. The account identifier is usually of the format: (organization).[account]

  12.13. How to use information protection labels in Cortex Cloud Data Security

#### Note

* Only If you have connected a Microsoft 365 instance to Cortex Cloud, the information protection labels appear. See How to onboard Microsoft 365.

13. Cortex Cloud Identity Security

  13.1. What is Cortex Cloud Identity Security?

  13.2. Review and improve your Identity Security posture

#### Tip

* Reducing the number of nonhuman entities that are either dormant or have administrative privileges is the most effective way to improve your security score.

  13.3. How does Effective Permission Calculation work?

  13.4. Cortex Cloud Identity Security functionality

#### Note

* Access to the Weak/Compromised Password widget and column requires the ITDR add-on.

* For more information about Effective Permission Calculation, see How does Effective Permission Calculation work?.

* When a policy is analyzed and categorized as excessive, a relevant finding and highlight is attached to that policy and the various identities being granted excessive permissions.

* Each action must be defined as either being administrative or not. The administrative tag is an additional tag for administrative actions, along with one of the other access level types. For example, the AWS action iam:CreateGroup is categorized as config and has the administrative tag as well.

#### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

  13.5. Achieve the principle of least privilege access

#### Note

* In the case of Amazon AWS, Cortex Cloud Identity Security also uses AWS Identity and Access Management (IAM) Access Advisor insights to expand the coverage of supported actions.

#### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

  13.6. Explore permissions using the simple and advanced access tables

  13.7. Create a custom detection rule in Cortex Cloud Identity Security

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

  13.8. Perform advanced Identity Security investigations using XQL

#### Note

* For more information, see Build XQL queries.

  13.9. Enable inactive human identity logs on Azure in Cortex Cloud Identity Security

#### Note

* For more information, see Ingest logs from Microsoft Azure Event Hub.Ingest logs from Microsoft Azure Event Hub

  13.10. Manage RBAC and SBAC in Cortex Cloud Identity Security

#### Important

* You can use the Cortex Cloud Identity Security RBAC roles to define access to the various sections and functionalities of Cortex Cloud Identity Security, but these roles do not directly control the specific data a user sees within those sections. Data visibility is further refined and limited by scope-based access control (SBAC) capabilities.

14. Cloud ASM

  14.1. What is Cloud ASM?

  14.2. Cloud ASM concepts

  14.2.1. Scanning

  14.2.1.1. Scanning cadences

  14.2.1.2. Scanning ports and protocols

#### Note

* The following lists are not exhaustive. For current and complete lists, contact your customer success team.

  14.2.1.3. Scanning activity

  14.2.2. Network mapping

  14.3. Enable Cloud ASM

#### Note

* Discovered services will increase workload consumption. ASM data will begin to appear in your tenant and be included in your licensing workload meter within 72 hours.

#### Navigation

  Settings → Configurations → Attack Surface → Data Management

  14.4. Attack Surface Management detections

  14.4.1. Attack surface rules

#### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

  14.4.2. Externally inferred CVEs

#### Note

* An externally inferred CVE might impact your service or asset, but additional investigation is required to confirm that the CVE is actually present.

  14.5. Attack surface assets

#### Navigation

  The internet-facing assets that were discovered in an attack surface management (ASM) scan and attributed to your organization are available in the inventory on the Inventory → Assets → All Assets → External Surface pages

  14.6. Review your unmanaged cloud services

#### Navigation

  Inventory → Assets → All Assets → External Surface → Services

  14.7. Review unmanaged cloud issues

  14.8. Attack Surface Management FedRAMP support

15. Network exposure detection

  15.1. What is Cloud Network Analyzer?

  15.2. Internet exposure detection

#### Note

* Currently, CNA supports only an isolated architecture with an AWS Gateway Load Balancer (GWLB) within a single VPC. Other more centralized topologies including one security VPC that forwards traffic to other workload VPCs are currently not supported.

  15.3. Outbound exposure detection

  15.4. East-west exposure detection

  15.5. Investigate an internet exposure

#### Note

* The Network tab is currently only available for virtual machines.

* The Network tab is only displayed when you have access to the main asset and associated ones, such as security groups, VPCs and subnets. For more information on Scope-Based Access Control (SBAC) for configuring granular scoping, see Manage user scope.Manage user scope

16. Vulnerability management

  16.1. Vulnerability management in Cortex Cloud

#### License Type

  Requires the Cortex Cloud Posture Security, Cortex Cloud Runtime Security, Exposure Management, or ASM add-on.

#### Note

* Cortex Cloud vulnerability management provides the ability to identify and assess runtime vulnerabilities in every asset across traditional IT and cloud environments. For vulnerabilities detected in your software development lifecycle through application security scans, refer to the Cortex Cloud Application Security documentation.

  16.1.1. Cortex Cloud vulnerability concepts

#### Note

* CVE is an acronym for Common Vulnerabilities and Exposures, which is a list of publicly disclosed security threats. We often use the term "CVE" to refer to a vulnerability that has been a assigned a CVE ID. Cortex Cloud identifies CVEs and non-CVE vulnerabilities.

  16.1.2. Vulnerability Management dashboard

  16.2. Cortex Vulnerability Risk Score

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

  16.3. Vulnerability policies

  16.3.1. Create a vulnerability policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

  16.3.2. Update the Ignored CVEs, Asset Groups, and Assets policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

  16.3.3. Modify a vulnerability policy

#### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

  16.3.4. Configure a block grace period

#### Navigation

  Posture Management → Rules & Policies → Vulnerability Management → Vulnerability Policies - Prevention

  16.3.5. Enable or disable a vulnerability policy

#### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

  16.4. Investigate and remediate vulnerabilities

  16.4.1. View all Vulnerabilities

#### Navigation

  Posture Management → Vulnerability Management → Vulnerabilities

  16.4.2. View vulnerability issues

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

  16.4.3. View All Vulnerability Findings

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues and click the All Vulnerability Findings button

  16.4.4. View vulnerable assets

#### Navigation

  Posture Management → Vulnerability Management → Vulnerable Assets

  16.5. Vulnerability Intelligence

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

  16.6. Recast CVSS scores and CVSS severities

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

17. Cloud Security Rules and Policies

  17.1. Overview

  17.2. Cloud Security Rules

  17.3. Cloud Security Policies

#### Note

* If you have the following Scope Based Access Control (SBAC) settings in place, User Settings > Cases and Issues Scope > Select domains > Posture, you may encounter a Case mismatch in Issues/Cases/Findings counts. This is because the Case count on the Rules page captures Cases belonging to the Posture domain. Whereas Platform pages, capture Issues...

* 17.3.1 |Issues Issues are artifacts of the policy and represent actionable items that you need to address. They have several characteristics, such as: Lifecycle '–' Open, Dismiss, In-progress, Close Workflows '–' Assigned to different user personas for remediation Severity '–' Critical, High, Medium, Low, Info NOTE: A key distinction between Findings and Issues is that Findings are not actionable, while you can take an action on Issues. The Cloud Security Policies page allows you to manage policies that define security and compliance actions for cloud posture. You can create, edit, filter, and manage policies through a structured table and widget panel. The Policies page displays all the configured policies with the following fields. 17.4 |Create Rules You can create your own custom rules for Configuration (Config), Data, and Network Exposure. View all the Cloud Posture Security Rules on the Posture Management > Rules & Policies > Rules > Cloud Security page. 17.4.1 |Create a configuration rule Configuration (config) rules monitor your resource configurations for potential policy violations or misconfigurations. Perform this task to create a custom configuration rule that you can use in a cloud security policy. Navigate to Posture Management → Rules & Policies → Rules → Cloud Security. Select Create Rule > Config. Complete the Overview step: Enter a Rule Name and Description. Select a Severity. This will be the severity of any issues created with this rule. Add Labels (optional). These rules can be used find rules when creating custom policies. Enable Remediation using the toggle (optional). In a later step, you'll enter the remediation instructions. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. Click Next. Complete the Overview step: Enter a Rule Name and Description. Select a Severity. This will be the severity of any issues created with this rule. Add Labels (optional). These rules can be used find rules when creating custom policies. Enable Remediation using the toggle (optional). In a later step, you'll enter the remediation instructions. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. Complete the Rule Logic step to define what the rule is looking for. Select one of the following modes: Simple Mode: Presents a guided interface in which you can define basic conditions and address most common rule use cases. Advanced Mode: Presents a free-form XQL editor that allows you to build complex and flexible queries across unrestricted datasets. Supports advanced and custom use cases. Complete the Rule Logic step to define what the rule is looking for. Select one of the following modes: Simple Mode: Presents a guided interface in which you can define basic conditions and address most common rule use cases. Advanced Mode: Presents a free-form XQL editor that allows you to build complex and flexible queries across unrestricted datasets. Supports advanced and custom use cases. If you selected Simple Mode, complete the following steps: Select options from the dropdown menus to define the logic for your config rule, such as '''Find EC2 instances where accessKeys are allowed'', and then click Search to view all matching results. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Simple Mode, complete the following steps: Select options from the dropdown menus to define the logic for your config rule, such as '''Find EC2 instances where accessKeys are allowed'', and then click Search to view all matching results. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Advanced Mode, complete the following steps: Define an XQL query for the rule, following the guidelines in Guidelines for creating cloud security rules. For detailed information about how use XQL, see Get started with XQL. Click Test to determine if the query is valid. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Check the list of query results to verify that the query is working as intended. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Advanced Mode, complete the following steps: Define an XQL query for the rule, following the guidelines in Guidelines for creating cloud security rules. For detailed information about how use XQL, see Get started with XQL. Click Test to determine if the query is valid. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Check the list of query results to verify that the query is working as intended. (Optional) In the text field, define remediation actions or provide other information that will be included on issues created by this rule. Click Done to save your config rule. 17.4.1.1 |Guidelines for creating cloud security rules NOTE: XQL queries are supported for cloud security configuration rules only. XQL queries are not yet supported for other types of cloud security rules.

  17.4.1.2. Cloud security rule status for custom configuration rules

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

  17.4.2. Create a Data Rule

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

  17.4.3. Create a Network Exposure Rule

  17.4.4. Edit a Rule

  17.5. Create Policies

#### Note

* When creating Policies, note that Rules with the Informational severity level are excluded.

  17.5.1. Edit a Policy

  17.5.2. Use an Existing Policy to Create a New One

18. Cloud Workload Policies and Rules

#### Prerequisite

* Users need View/Edit RBAC permissions (under Policies → Compute Policies) or the Instance Administrator role to view, edit, and modify Cloud Workload Policies policies.

#### Important

* Users with SBAC granular scoping (in addition to the RBAC permissions required for Cloud Workload Policies) can only view Cloud Workload Policies, when their access is scoped to any of the available options: All assets, No assets, or Select asset groups. For more information on granular scoping, see Manage user scope. When no SBAC restriction is...

  18.1. How policies and rules work together

  18.2. Cloud Workload Policies

#### Note

* Issues are automatically resolved when the finding is no longer applicable to the asset or when the affected asset is removed from the inventory. For more details on Prevent and create issues, see Cloud Workload Preventive Action.

  18.2.1. Types of Cloud Workload Policies

  18.2.1.1. Trusted image cloud workload policies

#### Note

* Registry scanning is for finding problems that are objectively issues regardless of context, organization, or scope. Trust, however, is subjective. Depending on the scope and other factors, an issue may or may not be problematic, and can change over time depending on the context.

* Trusted image policies do not override other policies and their rules, such as malware policies, misconfiguration policies, and secrets policies.

#### Caution

* The default behavior for the prevent action when trust criteria are unavailable is Create an Issue. Be aware that changing this default will mean an incomplete deployment file can block a workload.

  18.2.2. Cloud Workload Policies page

#### Note

* Keep the following caveats in my mind when working with Policies: Instance Administrators are able to view all facets of policies without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be...

  18.2.2.1. Widgets panel

  18.2.2.1.1. Show or hide the widget panel

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.2.2. Change the layout of the policies table

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.2.3. Policy Details Panel

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.3. Enable or disable a Cloud Workload Policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.4. Create a Cloud Workload Policy

#### Note

* The Evaluation stage for Misconfiguration policies is supported only in the Runtime SDLC stage and is enforceable through the Kubernetes Admission Controller for clusters on-boarded using the Posture Management (KSPM) Connector.

* Use Create a new Custom Detection Rule to define and add new custom rules as required.

* Each rule may support different actions. While some include both Create an Issue and Prevent and Create an Issue, others provide only the Create an Issue option.

* All non-relevant (non-compute) assets are automatically excluded from the included asset list.

* See Cloud Workload Preventive Action, to learn more about the Prevent action behavior and prerequisites. If the Prevent and create an issue action is selected, the preventive actions in the CI pipeline will trigger a Fail Pipeline by returning an exit code of 2 in the CI tool.

* Choosing this option results in the automatic selection of all other asset scopes in the list.

* See Cloud Workload Preventive Action, to learn more about the Prevent action behavior and prerequisites.

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.5. Use an existing policy to create a new Cloud Workload policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.6. Edit a Cloud Workload Policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.7. Delete a Cloud Workload Policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.8. Cloud Workload Preventive Action

  18.3. Cloud Workload Rules

  18.3.1. Default (pre-defined) Rules

  18.3.2. Custom (user-defined) Rules

  18.3.3. Cloud Workload Rules page

#### Note

* Keep the following caveats in my mind when working with Rules: Instance Administrators are able to view all facets of Rules without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be able...

  18.3.3.1. Filter page results

  18.3.3.2. Change the layout of the rules table

  18.3.3.3. Rule details panel

  18.3.4. Create a new Custom Detection Rule

#### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

#### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

  18.3.5. Use an existing rule to create a new Custom Detection Rule

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

  18.3.6. Edit a Custom Detection Rule

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

  18.3.7. Delete a Custom Detection Rule

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

19. Serverless function posture security

  19.1. Onboard cloud providers for serverless functions

#### Note

* When scanning serverless functions with layers, those layers need to be from the same cloud account.

* Only functions containing zip files are supported.

#### Important

* Cortex supports Google Cloud Functions: 1st gen and 2nd gen Cloud Functions API.

  19.2. Serverless function posture policies

  19.2.1. Manage serverless function policies

#### Note

* You can select multiple types to view all your serverless function rules across your cloud providers.

* Refer to Create serverless function policies for more information on how to define the steps of a policy in the wizard.

  19.2.2. Create serverless function policies

#### Note

* You can select multiple options.

* For more information about rules, refer to Manage serverless function rules.

  19.3. Serverless function posture rules

  19.3.1. Manage serverless function rules

#### Note

* You can select multiple types to view all your serverless function policies across your cloud providers.

* Refer to Create serverless function rules for more information on how to define the steps of a rule in the wizard.

  19.3.2. Create serverless function rules

  19.3.3. Create an attack path rule for serverless functions

#### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  in as the operator → enter the CVE ID → Search

  > or >= as the operator → Severity level (such as High, Low) → Search

  > or >= as the operator → enter a score → Search

  19.3.4. Create a configuration rule for serverless functions

#### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  19.3.5. Create a network exposure rule for serverless functions

#### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  19.4. Serverless function usage

#### Navigation

  To access serverless function assets, under Inventory, select All Assets → Compute → Serverless Functions

  Posture Management → Vulnerability Management) → Vulnerability Issues

  Add Filters → Asset Category → Serverless Function

  Posture Management → Vulnerability Management) → Vulnerable Assets

  Add Filters → Asset Category → Serverless Functions

20. Data management

  20.1. Broker VM

  20.1.1. What is the Broker VM?

  20.1.2. Set up and configure Broker VM

#### Note

* The Broker VM comes with a 512 GB disk. Therefore, deploy the Broker VM with thin provisioning, meaning the hard disk can grow up to 512 GB but will do so only if needed.

* When DHCP is not enabled in your network and there isn't an IP address for your Broker VM, configure the Broker VM with a static IP using the serial console menu.

* When configuring a Local Agent Settings applet with installer and content caching, you need to configure an SSL certificate for the Broker VM as explained in the task below. For more information on specific requirements for the Local Agent Settings applet, see Activate Local Agent Settings.Activate Local Agent Settings Keep in mind that several Broker...

* When a Broker VM is disconnected for more than 30 days, it will have to go through a re-registration process.

* You can configure another Broker VM as a proxy server for this Broker VM by selecting the HTTP type. When selecting HTTP to route Broker VM communication, you need to add the IP Address and Port number (set when activating the Agent Proxy) for another Broker VM registered in your tenant. This designates the other Broker VM as a proxy for this Broker VM.

* The Palo Alto Networks Broker VM supports only strong cipher SHA256-based certificates. MD5/SHA1-based certificates are not supported.

* If adding a CA certificate to the Broker VM is not possible, ensure that you've added the Broker Service FQDNs to the SSL Decryption Exclusion list on your firewalls. See Enable Access to Cortex XDR.

#### Important

* There can be instances in which the Broker VM requires up to 50% of the incoming bandwidth as outgoing. Such instances can be, network instability between the Broker VM and Cortex Cloud, or data that is being collected, but not well compressed.

* The internal network for the Broker VM must be unique and reserved. Other devices should not use the same IP as the Broker VM internal network as it can lead to communication issues with the Broker VM.

* If you use SSL decryption in your firewalls and proxies, see the Understanding CA certificate functionality in Broker VM deployments section below. In addition, verify that the proxies used support HTTP/2, gRPC-specific headers, and HTTP/2 trailers, and the inspection policies support gRPC traffic. Any devices that you use with this configuration...

* When configuring more than one network interface, ensure that only one Default Gateway is defined. The rest must be set to 0.0.0.0, which configures them as undefined. In addition, we recommend assigning each network interface to a different subnet, as oppose to configuring two interfaces on the same subnet which can potentially cause unexpected...

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and earlier, Cortex Cloud will only accept 172.17.0.0/16.

* We strongly recommend disabling SSH connectivity when it's not being used. Therefore, activate SSH connectivity when it's needed and disable it right afterwards. When generating a new SSH key ensure to avoid embedding the domain-style username, by not using any backslashes (\) in the comment field, to ensure the SSH key passes validation.

  20.1.2.1. Broker VM image installations

  20.1.2.1.1. Set up Broker VM on Microsoft Azure

#### Prerequisite

* Download a Cortex Cloud Broker VM VHD (Azure) image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

#### Note

* Extraction can take up to a few hours.

* Upload can take up to a few hours.

* For more information, see the Azure Documentation.

* Creating the VM can take up to 15 minutes. The Broker VM Web UI is not accessible during this time.

* For more information on creating a rule in an Azure VM, see Create a Security Rule in the Azure Documentation.

  20.1.2.1.2. Set up Broker VM on Alibaba Cloud

#### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

#### Note

* For Linux and Windows uploads, you can use Alibaba Cloud's graphical management tool called ossbrowser.

* The Object Storage Service must be created in the same Region as the image of the virtual machine.

#### Navigation

  Hamburger menu → Elastic Compute Service → Instances & Images → Instances

  20.1.2.1.3. Set up Broker VM on Amazon Web Services

#### Prerequisite

* Download a Cortex Cloud Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. You need to set up an AWS VM Import role (vmimport) before you continue with the steps to convert the image as it is required for the import-image CLI command. You can use a different role, if the...

#### Note

* Creating an AMI image can take up to 60 minutes to complete.

* Assigning security groups can take up to 15 minutes.

#### Important

* A t2.medium (4GB RAM) is the lowest machine type that can be used as an instance type. Usually, the lowest machine type is sufficient with the Local Agent Settings applet. Yet, when enabling more applets, 8 GB is required.

#### Navigation

  Log in to the AWS IAM Console, and in the navigation pane, select Access Management → Users → Add Users

  Obtain a registration token from the Cortex Cloud Web Console by selecting Settings → Configurations → Data Broker → Broker VMs → Add Broker → Generate Token

  20.1.2.1.4. Set up Broker VM on Google Cloud Platform (GCP)

#### Prerequisite

* Download a Cortex Cloud Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. To complete the set up, you must have G Cloud installed and have an authenticated user account.

* Before importing a GCP image using the gcloud CLI, ensure that you update the Google Cloud components to version 371.0.0 and above using the following command:

#### Note

* The import tool uses Cloud Build API, which must be enabled in your project. For the import to work, Cloud Build service account must have compute.admin and iam.serviceAccountUser roles. When using the Google Cloud console to import the image, you will be prompted to add these permissions automatically.

  20.1.2.1.5. Set up Broker VM on KVM using Ubuntu

#### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  20.1.2.1.6. Set up Broker VM on Microsoft Azure

#### Prerequisite

* Download a Cortex Cloud Broker VM VHD (Azure) image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

#### Note

* Extraction can take up to a few hours.

* Upload can take up to a few hours.

* For more information, see the Azure Documentation.

* Creating the VM can take up to 15 minutes. The Broker VM Web UI is not accessible during this time.

* For more information on creating a rule in an Azure VM, see Create a Security Rule in the Azure Documentation.

  20.1.2.1.7. Set up Broker VM on Nutanix Hypervisor

#### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

#### Note

* Saving the image to Nutanix hypervisor can take time as it's a large file. We recommend verifying periodically that the connection is alive for the upload process to finish successfully.

* Creating the VM can take up to 15 minutes. The Broker VM Web user interface is not accessible during this time.

  20.1.2.1.8. Set up Broker VM on VMware ESXi using vSphere Client

#### Prerequisite

* Ensure you have a virtualization platform installed that is compatible with an OVA image, and have an authenticated user account. Download a Cortex Cloud Broker VM OVA image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  20.1.2.2. Broker VM data collector applets

  20.1.2.2.1. Activate DSPM Fileshare

#### Prerequisite

* Set up and configure Broker VM Know the complete path to the files and folders that you want Cortex Cloud to monitor. Necessary user permissions to access the network shares. For the SMB connection type, you need the user name and password.

#### Note

* The applet list displays only the applets for which you have permissions.

* By default, all configured connections are saved.

* For details regarding the connection fields, see the table above under File Share Connection.

* You can add multiple connections under a single instance of the DSPM Fileshare applet by returning to the File Share Connection screen and clicking Add Connection. Each new connection can be of either the NFS or SMB connection type.

  20.1.2.2.2. Activate Registry Scanner

#### Prerequisite

* To initialize registry scanning on your Broker VM, you must first add the necessary data connectors. For details, see:    Connect Docker Hub registry   Connect Docker V2 compliant container registry   Connect GitLab container registry   Connect Harbor registry   Connect JFrog container registry   Connect Sonatype Nexus registry To initialize registry...

#### Note

* You cannot activate the Registry Scanner directly on a new or existing Broker VM. You can only activate or deactivate existing Registry Scanner applets. To activate or deactivate existing applets, see Step 4 under Verify Registry Scanner connection section.

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  20.1.2.2.3. Activate Transporter

#### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator) Set up and configure Broker VMSet up and configure Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex Cloud resources. The IP addresses...

#### Warning

* The Transporter applet is not supported for FedRAMP customers.

#### Navigation

  Settings → Configurations → Broker VMs (under Data Broker

  the Brokers tab → locate your Broker VM → hover and click + Add under the Apps column → AppSec Transporter

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

  20.1.3. Manage Broker VM

#### Note

* For more information on troubleshooting errors and warnings for these broker applets, see Troubleshoot Broker VM applet errors.Troubleshoot Broker VM applet errors

* Certain fields are also exposed in the Clusters tab, when a Broker VM node is added to a High Availability (HA) cluster, and each cluster node is expanded to view the Broker VM nodes table. An asterisk (*) is beside every field that is also included in the Broker VM nodes table for each HA cluster.

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  20.1.3.1. Edit Broker VM Configuration

#### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and lower, Cortex Cloud accepts only 172.17.0.0/16.

* Make sure you save the password before closing the window. The only way to re-generate a password is to disable ssh and re-enable.

  20.1.3.2. Increase Broker VM storage allocated for data caching

#### Note

* Follow your hypervisor documentation to understand how to add a persistent disk storage to your VM.

* If your disk is not listed and you didn't shutdown your Broker VM in your hypervisor before manually adding a disk to the VM, you'll need to reboot the Broker VM before the disk details are detected by the Broker VM. This can be performed either in the hypervisor or directly in the Broker VMs page.

#### Warning

* This operation is irreversible, and will make the disk become an integral part of the broker, where disconnecting the disk will result in errors and data loss.

  20.1.3.3. Monitor Broker VM using Prometheus

#### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* For more information on Docker, see the Docker website.

  20.1.3.4. Collect Broker VM Logs

#### Note

* The Download Logs (<TIMESTAMP>) is only displayed when you've downloaded your logs previously using Generate New Logs.

  20.1.3.5. Upgrade Broker VM

#### Important

* After a Broker VM upgrade, your broker may require a reboot to finish installing important updates. A notification about this will be sent to your Cortex Cloud console Notification Center.

  20.1.3.6. Import Broker VM Configuration

#### Important

* This option can only be used on Broker VMs with version 20.0 and later, and is only suitable for importing a configuration of brokers in the same version, or from a broker in an older version to a broker in a newer version.

* If your source Broker VM configuration includes a WEC applet, you'll need to ensure that you update the DNS record of this Broker VM's FQDN to point to the target Broker VM IP address.

  20.1.3.7. Open Live Terminal

#### Note

* You can either restart_routes or reboot the Broker VM for the changes in the /etc/network/routes file to take affect.

  20.1.3.8. Add Broker VM to cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  20.1.3.9. Switchover Primary Node in Cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  20.1.3.10. Remove from Cluster

#### Note

* If you've enabled a Load Balancer Health-Check on the cluster, you need to exclude this Broker VM from your Load Balancer settings.

  20.1.4. Broker VM High Availability Cluster

#### Note

* For Load Balancing, you must install a Load Balancer in your network, which will distribute the incoming data between the nodes.

* The following applets aren't supported when configuring Broker VMs in HA clusters: Cortex Network Scanner and Transporter.

  20.1.4.1. Configure High Availability Cluster

#### Prerequisite

* Be sure you do the following task before creating a cluster from an existing Broker VM: If the Broker VM is explicitly specified in some Agent Settings profile, which means Cortex Cloud agents retrieve release upgrades and content updates from this Broker VM, you must change the Broker VM's current designated role. To do this, you need to modify the...

#### Important

* You can only create a new cluster from an existing Broker VM, when the Broker VM version is 19.0 and later, and the STATUS is Connected. The Create a Cluster from this Broker option is only listed if the Broker VM is not already added to a cluster.

* When the Protocol is set to HTTPS, you may need to perform a few follow-up steps to establish a validated secure SSL connection with the Broker VM. If you're using your own Certificate Authority (CA) to sign the certificates, you'll need to place the CA in the client, such as the Load Balancer, and upload the certificates to the Broker VM. If you're...

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  20.1.4.2. Manage Broker VM clusters

#### Navigation

  After you've configured a cluster, you can manage all your Broker VM clusters from the Clusters tab on the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs → Clusters

  20.1.4.2.1. View cluster details

#### Note

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.Troubleshoot Broker VM applet errors

#### Navigation

  The Clusters tab of the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs) enables you

  20.1.4.2.2. Edit cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs, and select the Clusters tab

  20.1.4.2.3. Add applet to cluster

#### Note

* With Cortex XDR Prevent, it's only relevant to configure a HA cluster with a Local Agent Settings applet as this is the only applet supported for this product license. The other applets are collector applets, which are only available in Cortex XDR Pro or Cortex XSIAM.

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.Troubleshoot Broker VM applet errors

  20.1.4.2.4. Add Broker VM to cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  20.1.4.2.5. Remove cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  20.1.5. Broker VM notifications

  20.1.6. Monitor Broker VM activity

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  20.2. Dataset management

#### License Type

  Managing Roles requires an Account Admin or Instance Administrator role. For more information, see Predefined user roles.

#### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

#### Note

* Cold storage, in addition to a cold storage license, requires compute units (CU) to run cold storage queries. For more information on CU, see Manage compute units.

* Only datasets that are already handled as part of the GB license are supported for this license. In addition, the retention configuration is only available in Cortex Cloud, as opposed to the public APIs.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default. Datasets include dataset permission enforcements in the Cortex Query Language(XQL), Query Center, and XQL Widgets. For example, to view or access any of the endpoints and host_inventory datasets, you need role-based access control (RBAC)...

* You'll only be able to save the dataset view if the query contains no errors; otherwise, the Save button is disabled.

* For more information on user roles, see Manage user roles.

#### Important

* Cortex Cloud enforces retention on all log-type datasets excluding Host Inventory, Vulnerability Assessment, Metrics, and Users.

* This column is updated once a day. Therefore, if the dataset was created or updated by the target or lookup flows, it's possible that the Last Updated value is a day behind when the queries or reports were run as it was before this column was updated.

  20.2.1. What are datasets?

#### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

#### Note

* For more information on tasks specific to lookup datasets, see Lookup datasets.

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

#### Important

* By default, forensic datasets are not included in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  20.2.2. Lookup datasets

#### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

#### Note

* A lookup dataset can only be deleted if there are no other dependencies. For example, if a Correlation Rule is based on a lookup dataset, you wouldn't be able to delete the lookup dataset until you removed the dataset from the XQL query of the Correlation Rule.

#### Important

* When you create or add data to a lookup dataset using the target stage, the _time field won't be included by default unless you explicitly add it with the fields stage.

  20.2.2.1. Import a lookup dataset

#### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

* When uploading a CSV, TSV, or JSON file, ensure that the file meets the following requirements: The maximum size for the total data to be imported into a lookup dataset is 30 MB from the Dataset Management page. Otherwise, the limit is 50 MB using Cortex Query Language (XQL) or APIs. Field names can contain characters from different languages, special...

#### Important

* The name of a dataset created from a TSV file must always include the extension. For example, if the original file name is mrkdptusrsnov23.tsv, you can save the dataset with the name marketing_dept_users_Nov_2023.tsv.

  20.2.2.2. Download JSON file of lookup dataset

#### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

#### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  20.2.2.3. Set time to live for lookup datasets

#### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

#### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  20.2.3. Monitor datasets and dataset views activity

#### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  20.3. Manage compute units

#### Note

* For more information, see Import historical data into cold storage.Import historical data into cold storage

* The CU consumption of cold storage queries is based on the number of days in the query time frame. For example, when querying 1 hour of a specific day, the CU of querying this entire day is consumed. When querying 1 hour that extends past 2 days, such as from 23:50 to 00:50 of the following day, the CU of querying these two days is consumed.

  20.3.1. Compute units usage

#### Note

* To enable the add-on, select Settings  → Configurations → Cortex Cloud License → Addons tile, and select the Compute Unit tile and Enable.

#### Navigation

  Settings → Configurations → Data Management → Compute Unit Usage

  20.4. Manage instances

  20.4.1. Add a new data source or instance

#### Note

* If a data source contains multiple integrations, the integration configured as the default integration will used by the Data Onboarder. The default integration of the content pack is indicated in each content pack's documentation. The other integrations are available for configuration in the Data Sources & Integrations page after installing the content...

* If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant page in the system, for example Correlations, Playbooks, or Scripts. If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant...

  20.4.2. Manage cloud instances

#### Note

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  20.4.3. Update cloud permissions after Cortex release updates

#### Prerequisite

* Ensure that the user account used to modify permissions has the necessary privileges within both the Cortex platform and your cloud environment, for example, AWS or Azure. You received a notification regarding a new version available that requires permission updates, or viewed a Needs Update status in the Data Sources & Integrations page.

#### Note

* Instances requiring updates will not change their connection status, for example, Connected, Warning, Error, Disabled, due to the pending permission update.

  20.4.4. Pending cloud instances

  20.4.5. Manage Kubernetes Connector instances

#### Note

* After uninstalling the Kubernetes connector, the connector status updates to Not connected 48 hours after the uninstall process is initiated.

#### Navigation

  You can also manage the Kubernetes Connector instances from Inventory → Assets → Kubernetes Clusters

  20.4.6. Troubleshoot errors on cloud instances

#### Note

* Errors related to collection of audit logs in the cloud instance are recorded in the collection_auditing dataset. For more information, see Audit logs fields and query examples.

  20.4.7. Monitor serverless function scan health and status

  20.5. About health issues

#### Prerequisite

* For Cortex Cloud to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics.Enable the Analytics Engine and Identity Analytics

#### Note

* The Health Issues page displays issues that were triggered after July 2024. To see health issues that were triggered before this date, click Legacy Health Issues.

* Cortex Cloud enforces the dedup logic to health issues. This logic reduces the likelihood of identical health issues from flooding the issues dataset.

  20.5.1. Investigate and resolve health issues

21. Marketplace

  21.1. Cortex Marketplace

#### Navigation

  Settings → Configurations → Marketplace) or at Cortex Developer Docs Marketplace

  21.2. Content Pack Support Types

#### Note

* Palo Alto Networks is not liable for and does not warrant or support any content pack produced by a third-party publisher. Palo Alto Networks does not support content packs that do not have official available documentation.

  21.3. Cortex Cloud content

  21.4. Manage content packs

#### Note

* Optional content packs that are already installed are treated like they are required content packs to preserve content integrity.

* Cortex Cloud includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

* In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as scripts or integrations.

* Third-party product integrations are developed and tested against a specific product version. For products that are on-prem or cloud-based with specific API versions, the version developed and tested against will be included in the integration's documentation. Newer versions of the product are not always immediately tested, and it is expected that...

#### Caution

* If you want to downgrade, any content that depends on the content pack including any customizations may be deleted if it does not exist in the target content pack version.

* If another content pack is dependent on the content pack you want to delete, it may break the other content pack. You can reinstall the content pack, but you cannot restore detached and customized content.

#### Tip

* You can also find content packs that require updates by going to Settings → Data Sources & Integrations and filtering by Pack Version = Update Available. If you click on an integration in the filtered list, there is a link to the content pack in Marketplace for updates.

  21.5. Marketplace FAQs

  21.6. Content changes when upgrading Cortex Cloud versions

22. Cortex CLI

#### Note

* The CLI Read Only Role is not supported for CWP as the system does not support offline mode.

  22.1. Connect Cortex CLI

#### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

#### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources & Integrations →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Cortex Cloud Application Security, refer to Cortex CLI usage for Cortex Cloud Application Security

#### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source or Integrations page after selecting + Add New.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

  22.2. Cortex CLI common command line reference guide

#### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

  22.3. Cortex CLI for API Security

#### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more informationConnect Cortex CLI Ensure your application exposes APIs and provides a corresponding OpenAPI Specification file Ensure that you have installed Java v 11 and above

  22.3.1. Cortex CLI API Security command line reference guide

  22.4. Cortex CLI for Cloud Workload Protection

#### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more informationConnect Cortex CLI Verify that Java version 11 and above is installed: Run java -version in your terminal. If not, refer to Java SE Development Kit 11.0.25 for information...

* Before you begin, ensure you have sudo privileges to execute the image scan.

* For direct scanning from your Docker daemon, the image must already exist in your local Docker repository. The CLI will not pull a new image if it does not exist locally. To scan an image that exists in your local Docker daemon, simply provide its name: The image scan accepts the following arguments: --api-base-url: Required - true. The public facing API URL. Refer to Connect Cortex CLI for more informationConnect Cortex CLI --api-key: Required - true. Your Cortex Cloud API key. Refer to Connect Cortex CLI for more informationConnect Cortex CLI --api-key-id: Required - true. Your Cortex Cloud API key ID image scan: Required - true. Refers to CWP as the type of scan By default, Cortex Cloud looks for the Docker socket at unix:///var/run/docker.sock. --docker-host <path> specifies the path to the Docker socket. Use this flag if your Docker socket is located elsewhere, for example unix:///var/snap/docker/common/run/docker.sock. To scan an image from a previously saved archive file (such as a .tar file), use the --archive flag: This example demonstrates how to create an image archive from your Docker or Podman environment, which can then be used for scanning or SBOM generation if you choose not to scan directly from the local daemon. With Docker: docker save -o ubuntu.tar ubuntu With Podman: podman save --format oci-archive -o /tmp/alpine-oci.tar alpine:latest You can generate a Software Bill of Materials (SBOM) for your container images using the Cortex CLI and and save the output to a specified file. This functionality enables you to store the SBOM for further analysis, auditing, and compliance. By default, this will retrieve the SBOM for an image from your local Docker daemon. To get an SBOM for an image from your local Docker daemon: Command: cortexcli image sbom: Exports a Software Bill of Materials (SBOM) document for a container image archive. Usage: cortexcli image sbom [command options] --archive-format value: Specifies the image archive format. Values: docker-archive (default), oci-archive --output-format value: Specifies the SBOM document output format. Values: json (default), xml --output-file value: Specifies the path to the file where the SBOM document will be saved --fields value [--fields value]: Specifies the fields to include in the SBOM document. Multiple fields can be specified including: author, binaries, license, name, purl, sourcePackage, type, version --help, -h: Displays help information for the command To export an SBOM from an image archive file, use the --archive flag: NAME: cortexcli image sbom - Exports an SBOM document for an image from the local Docker daemon or an image archive. USAGE: cortexcli image sbom [command options] [image name or archive file]. Docker socket not reachable: If you encounter errors indicating the Docker socket cannot be reached, ensure the Docker daemon is running and verify the path to your Docker socket. If it's not in the default location (unix:///var/run/docker.sock), use the --docker-host flag to specify the correct path Image not found: If you attempt to scan an image directly from the Docker daemon and receive an error that the image does not exist, confirm that the image is indeed present in your local Docker repository by running docker images. The CLI will not pull images 22.4.1 |Cloud Workload Protection command line reference This reference guide documents the Cloud Workload Protection commands and flags for the Cortex CLI, including the structure of base commands and subcommands. Refer to Cortex CLI common command line reference guide for Cortex CLI commands common to all supported modules. 22.5 |Cortex CLI for Code Security PREREQUISITE: For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

#### Note

* CWP does not support container image secret scanning for systems running on ARM architecture.

* For available CWP commands, refer to Cloud Workload Protection command line reference.

* --archive: When used with image scan, sets the scan source to an archive file. When used with image sbom, indicates the SBOM should be exported from an archive file The --archive flag can also be explicitly set as --archive=true --archive-format <value>: The image archive format (such as docker-archive or oci-archive). Default: docker-archive.

  22.5.1. Cortex CLI usage for Cortex Cloud Application Security

  22.5.2. Cortex CLI Cortex Cloud Application Security command line reference

#### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

#### Important

* The Cortex CLI Cortex Cloud Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id...

23. Cortex Cloud XQL

  23.1. Get started with XQL

  23.1.1. XQL language features

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

#### Navigation

  You submit XQL queries to Cortex Cloud using the Investigation & Response → Search → Query Builder user interface

  23.1.2. XQL Language Structure

#### Note

* Specifying a dataset is not required because Cortex Cloud uses xdr_data as the default dataset. If you have more than one dataset or lookup, you can change your default dataset by navigating to Settings → Configurations → Data Management → Dataset Management, right-click on the appropriate dataset, and select Set as default.

* You can also build a query that investigates data in both a cold dataset and hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide. For more information on hot and cold storage, see Dataset management.

  23.1.2.1. Adding comments in queries

  23.1.3. Supported operators

#### Note

* In some cases, using an IN or NOT IN operator combined with a dataset and filterfilter stage can be a better alternative to using a join stage.

  23.1.4. Datasets and presets

#### Note

* To set up this Cloud Identity Engine (previously called Directory Sync Service (DSS)) dataset, you need to set up a Cloud Identity Engine. Otherwise, you will not have a pan_dss_raw dataset. For more information, see Set up Cloud Identity Engine.Set up Cloud Identity Engine

* INFO issues are not included in this dataset. The issue fields included in this dataset are limited to certain fields available in the API. For the full list, see Get Alerts Multi-Events v2 API.

* The fields contained in this dataset are a subset of the fields in the xdr_data dataset.

* If the vendor and product are not specified in the Winlogbeat profile's configuration file, Cortex Cloud creates a default dataset called microsoft_windows_raw.

* To ensure GlobalProtect access authentication logs are sent to Cortex Cloud, verify that your PANW firewall's Log Settings for GlobalProtect has the Cortex Data Lake checkbox selected.

* Prisma Access firewalls do not send configuration logs to the Structured Log Storage (SLS).

* You can query in XQL for this data and build widgets based on the xdr_data dataset or using the preset device_control. To view in an XQL query these events, the Device Configuration of the endpoint profile must be set to Block. Otherwise, the USB events are not captured. The events are also captured when a group of device types are blocked on the...

  23.1.5. About examples

#### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

  23.1.6. JSON functions

#### Important

* JSON field names are case sensitive, so the key to field pairing must be identical in an XQL query for results to be found. For example, if a field value is "TIMESTAMP" and your query is defined to look for "timestamp", no results will be found.

  23.1.7. How to filter for empty values in the results table

  23.1.8. Understanding string manipulation in XQL

  23.2. Build XQL queries

#### Note

* If you have the Cortex Agentic Assistant, you can use natural language prompts to create and run XQL queries within the chat interface. For more information, see Create and run XQL queries with Agentic Assistant chat.

  23.2.1. About the Query Builder

#### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

  23.2.2. How to build XQL queries

#### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex Cloud. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

#### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  23.2.2.1. Get started with XQL queries

  23.2.2.2. Useful XQL user interface features

#### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

  23.2.2.3. XQL Query best practices

  23.2.2.4. Expected results when querying fields

  23.2.2.5. Create XQL query

#### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined for the entire query, including queries that are part of the join stage. Yet, this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker...

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

  23.2.2.6. Review XQL query results

#### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* Results are received incrementally for the first 100K records, or up to 100MB worth of records, whichever comes first. After that, the next update is when the query has finished running completely.

* Real time query results are available only in the Query Builder and in free text query. Real time results are displayed only for queries run on hot datasets. The Sort option is available only after all the data is retrieved. When you formulate complex queries, the results will be displayed when the query has finished running completely, and not in real...

* In order for Cortex Cloud to provide a histogram for a field, the field must not contain an array or a JSON object.

  23.2.2.7. Translate to XQL

#### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

  23.2.2.8. Graph query results

#### License Type

  Building Cortex Query Language (XQL) queries in the Query Builder requires a Data Collection add-on.

#### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

  23.2.3. XQL query entities

  23.2.3.1. Create authentication query

#### Navigation

  Investigation & Response → Search → Query Builder

  23.2.3.2. Create event log query

#### Navigation

  Investigation & Response → Search → Query Builder

  23.2.3.3. Create file query

#### Navigation

  Investigation & Response → Search → Query Builder

  23.2.3.4. Create image load query

#### Navigation

  Investigation & Response → Search → Query Builder

  23.2.3.5. Create network connections query

#### Navigation

  Investigation & Response → Search → Query Builder

  23.2.3.6. Create network query

#### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

  23.2.3.7. Create process query

#### Navigation

  Investigation & Response → Search → Query Builder

  23.2.3.8. Create registry query

#### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

  23.2.3.9. Query across all entities

#### Navigation

  Investigation & Response → Search → Query Builder

  23.2.4. Overview of the Query Center

#### Note

* Very short queries might not be listed. You cannot cancel correlation queries. The default retention period for historic queries is aligned with issue retention.

  23.2.4.1. Edit and run queries in Query Center

#### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

#### Navigation

  Investigation & Response → Search → Query Center → Query History

  23.2.4.1.1. Query Center reference information

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  23.2.5. Manage scheduled queries

#### Navigation

  Investigation & Response → Search → Scheduled Queries

  23.2.5.1. Scheduled Queries reference information

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  23.2.6. Manage your query library

#### Note

* The Query to Library option is only available if your role has the Create Queries capability. For more information, see Manage access to saved queries.

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

#### Important

* The ability to create, edit, or share queries is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to saved queries.

  23.3. Stages

  23.4. Functions

24. Graph Search

  24.1. What is Graph Search?

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  24.2. Get started with Graph Search queries

#### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

#### Navigation

  Understand your assets and findings data: Graph Search queries are based on the current data that has been collected for assets and findings from the data sources configured and then sent to the Unified Asset Inventory (UAI), which is displayed in the All Assets page (Inventory → Assets → All Assets

  24.3. How to build Graph Search queries?

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

#### Navigation

  You submit Graph Search queries using the Investigation & Response → Search → Query Builder → Graph Search built-in query interface

  24.4. Understand Graph Search query results

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  24.5. Create Graph Search query

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

#### Note

* For more information about the Query Library, see Manage the Graph Search Query Library.

#### Tip

* After running the query, you can view the complete query by hovering over the last THAT... in the Graph Search query interface, and the query is displayed in a tooltip. If your query doesn't find any results or you want to change your query for any reason, you can always click anywhere in the Graph Search query interface, where your existing query is...

  24.6. Graph Search examples

#### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  24.7. Manage the Graph Search Query Library

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

#### Navigation

  From Graph Search in the Query Builder Select Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Center

  24.8. Edit and run queries in Query Center

#### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

#### Navigation

  Investigation & Response → Search → Query Center → Query History

  24.8.1. Query Center reference information

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  24.9. Supported assets and findings

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  24.10. FAQ on Graph Search

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

25. API specification inventory

#### Note

* Even if you have already imported the specification, you can edit the API specification in Cortex Cloud and add or update the server list.

  25.1. Import API specification

#### Note

* Even if you already imported the file, you can edit the API asset and add or update the server list.


## Cortex Cloud Runtime Security Documentation


---

## 1. Get started with Cortex Cloud

### 1.1. What is Cortex Cloud?

#### 1.1.1. Key features

### 1.2. What is Cortex Cloud Runtime Security?

### 1.3. Agentic AI in Cortex Cloud

#### 1.3.1. Cortex Agentic Assistant

##### Note

* By default, you have access to the Cortex Assistant, which includes a natural language interface for entity investigation and provides a list of recommended responses such as running a playbook, performing a scan, or collecting support files. If you enable the Cortex Agentic Assistant, it replaces the Cortex Assistant interface entirely. For more...

##### Tip

* The system Help Center Agent provides fast access to documentation. You can ask natural language questions, such as "How do I create a dashboard?" or "Where can I review my data retention policies?" and the agent retrieves concise, relevant information from the official documentation site.

##### Navigation

  Settings → Configurations → General → Server Settings → Agentic Assistant

##### 1.3.1.1. Agentic Assistant use cases

##### 1.3.1.2. Agentic Assistant security

### 1.4. Use the interface

### 1.5. In-product support case creation

#### Note

* When opening a support case through the Customer Support Portal, you need to manually select Cortex Cloud as the product. While there may be discrepancies between the categories in this wizard and the Customer Support Portal process, that's because this wizard is designed specifically to focus on options relevant to Cortex Cloud.

* Selecting an endpoint from the endpoint table and retrieving TSF requires full Retrieve Endpoint Data permissions under Endpoint Administration.

* Console recordings cannot exceed 10 minutes. The current recording time is displayed at the top of the window.

### 1.6. Understand your user persona

### 1.7. Understand license plans

#### Note

* A Cloud Runtime license includes both Posture Scanning and Runtime Protection on the same asset. Usage, including any overflow, is tracked automatically to ensure accurate reporting across both licenses without duplicate counting.

#### 1.7.1. Data retention

##### Note

* Case data is retained according to the Last Updated date. Issue data is retained according to the Observation Time. Data collected within these dates is kept and displayed for 186 days. To ensure the accuracy of issues, Cortex Cloud provides a grace period of up to 31 days for issues displayed in the Issues View, Issues table, and Cases View.

* Requires the Forensics add-on.

### 1.8. Fair Usage policy for Cortex Cloud

## 2. Onboard and configure Cortex Cloud

### 2.1. Plan and prepare

### 2.2. Deployment steps and checklist

#### 2.2.1. Activate Cortex Cloud

##### Prerequisite

* The Cortex Cloud activation email. A Customer Support Portal (CSP) account. You need to set up your CSP account. For more information, see How to Create Your CSP User Account. When you create a CSP account, you can set up two-factor authentication (2FA) to log into the CSP by using an Email, Okta Verify, or Google Authenticator (non-FedRAMP accounts)....

##### Note

* Activation can take about an hour and does not require you to remain on the activation page. Cortex Cloud sends a notification to your email when the process is complete.

* You can only change the subdomain once, and it cannot be undone. After deleting the subdomain, you can reuse it after 7 days.

##### 2.2.1.1. Cortex Cloud supported regions

##### 2.2.1.2. Enable access to required PANW resources

###### Note

* <tenant-name> refers to the selected subdomain of your Cortex Cloud tenant, and <region> is the region in which your tenant is deployed. For more information, see Cortex Cloud supported regions.

###### Navigation

  SSL decryption: If you use SSL decryption and experience difficulty connecting the Cortex XDR agent to the server, we recommend that you add the FQDNs required for access to your SSL Decryption Exclusion list in Device → Certificate Management → SSL Decryption Exclusion

#### 2.2.2. Upgrade from Prisma Cloud to Cortex Cloud

##### 2.2.2.1. About the Upgrade Helper

###### Note

* Your Prisma Cloud tenant remains available and fully operational during the agreed upgrade period.

##### 2.2.2.2. Link Cortex Cloud to Prisma Cloud

###### Navigation

  Settings → Configurations → Upgrade Helper

##### 2.2.2.3. Copy content

###### Navigation

  Settings → Configurations → Upgrade Helper

###### 2.2.2.3.1. Copy Global configurations

####### Note

* Keep the following caveats in mind: Scope-Based Access Control (SBAC) configurations, such as resources or account lists are not copied. You can manually assign scope-based access to the relevant users or groups. When migrating permission groups and roles, the total count of items successfully copied may be lower than the initial number selected. This...

####### Navigation

  Settings → Configurations → Access Management

###### 2.2.2.3.2. Copy CSPM configurations

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

  Posture Management → Rules & Policies → Policies → Cloud Security

  Investigation & Response → Automation → Automation Rules

  Posture Management → Compliance → Standards

###### 2.2.2.3.3. Copy CWP configurations

####### Navigation

  Posture Management → Rules & Policies → Cloud Workload

###### 2.2.2.3.4. Copy Cortex Cloud Application Security configurations

####### Important

* If labels are imported into Cortex Cloud less than three hours after they were last added or modified in Prisma Cloud, they may not be included in the import.

##### 2.2.2.4. Migrate Cortex CLI

###### Prerequisite

* Before you begin, ensure you have the following: Cortex Cloud API key: An active API key for your Cortex Cloud tenant with associated CLI role permissions. Refer to Manage API keys for more information Install the Cortex CLI. You can find the installation instructions here

#### 2.2.3. Set up users and roles

##### Note

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* The user who activated the Cortex product is assigned the Account Admin role. You cannot create additional Account Admin roles in the Cortex Cloud tenant. If you do not want the user to have Account Admin permission, you must remove the Account Admin role in Cortex Gateway.

##### 2.2.3.1. User group management

###### Note

* You can create user groups in the tenant or Cortex Gateway. User groups created in Cortex Gateway cannot be mapped to SAML groups. Only user groups created in the tenant support SAML group mapping and scoring. We recommend creating user groups in the Cortex tenant because: User groups are available for all tenants, and you may want different user...

* If users have been created in the CSP, but you want them to access the tenant through SSO only, skip this field and add only SAML group mapping after SSO is set up, otherwise, users can access the tenant through both the CSP and SSO. If you have not yet created any users, skip this field and add them later. See Set up authentication .

* When using Azure AD for SSO, the SAML group mapping needs to be provided using the group object ID (GUID) and not the group name.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

##### 2.2.3.2. Assign user roles and groups

###### Note

* If an existing user in the Cortex Gateway no longer has a role or a user group assigned, the user is revoked. Any roles, user groups, or egress configurations created by that user are shown as created by Revoked user instead of the user's email address.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Setting Cortex Query Language (XQL) dataset access permissions for a user role can only be performed from Cortex Cloud Access Management. For more information, see Manage user roles.

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit Users Permissions.

#### 2.2.4. Manage API keys

##### Note

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

##### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

* You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

#### 2.2.5. Set up authentication

##### Tip

* You should have at least one user in the Customer Support Portal for backup, in case of any authentication issues with your IdP provider.

##### 2.2.5.1. Authenticate users through the Customer Support Portal

###### Note

* You must be assigned the Super User role in the Customer Support Portal to add users in the Customer Support Portal. The first Super User who logs into Cortex Gateway is automatically assigned the Account Admin role and has access to the tenant. The user who activates the Cortex Cloud tenant will also be assigned the Account Admin role (if there is no...

* After users are added to the Customer Support Portal and they accept the invitation, you can manage them in Cortex Gateway or the Cortex Cloud tenant.

##### 2.2.5.2. Authenticate users using SSO

###### Note

* To set up SSO authentication in the tenant, you must be assigned an Instance Administrator or Account Admin role. SAML 2.0 users must log in to Cortex Cloud using the FQDN (full URL) of the tenant. To allow login directly from the IdP to , you must set the relay state on the IdP to the FQDN of the tenant. If you have multiple tenants, you must set up...

* The first SSO cannot be deleted, it can only be deactivated by toggling SSO Enabled to off. The Domain parameter is predefined for the first SSO. If you add additional SSO providers, you must provide the email Domain in the SSO Integration settings for all providers except the first. Cortex Cloud uses this domain to determine to which identity provider...

* Cortex Cloud requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex Cloud. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a...

##### 2.2.5.3. Set up Okta as the Identity Provider Using SAML 2.0

###### Note

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

##### 2.2.5.4. Set up Azure AD as the Identity Provider Using SAML 2.0

###### Note

* The default attributes shown on the main single sign-on page in Azure AD are not the values you need. You must click Edit next to Attributes and Claims to view and copy the actual values.

* The attribute claim name must exactly match the value sent by your IdP. In some cases, this may be the full attribute name/namespace, depending on the configuration of our IdP

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Important

* When copying the Single Sign-On URL value, remove idp/saml and leave the trailing /. For example, if the Single Sign-On URL is https://clientname.panproduct.region.paloaltonetworks.com/idp/saml, just copy https://clientname.panproduct.region.paloaltonetworks.com/.

#### 2.2.6. Cloud service provider (CSP) onboarding

##### 2.2.6.1. Ingest cloud assets

###### Note

* The cloud accounts being onboarded must be owned by the customer performing the onboarding process.

##### 2.2.6.2. Onboard Amazon Web Services

###### Prerequisite

* Ensure you have access to AWS Management Console. Ensure you have the Required AWS permissions.

###### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* When onboarding an AWS organization or organizational unit (OU), Cortex Cloud creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

###### 2.2.6.2.1. Manually upload template to AWS

####### Prerequisite

* Before you begin, ensure you have: An AWS account Access to AWS Management Console Permission to create a stack and its resources in AWS CloudFormation

####### Note

* You must ensure that the KMS key region and the SNS topic region are the exact same as the AWS region where you are deploying the CloudFormation stack.

###### 2.2.6.2.2. Configure AWS integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

##### 2.2.6.3. Onboard Google Cloud Platform

###### Prerequisite

* Ensure you have cccess to Google Cloud Console. Ensure you have an admin user with the required admin GCP permissions. Ensure you have the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled)   If you plan on enabling Automation as...

###### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* If you want to connect to your GCP Workspace, you must first complete onboarding with the option disabled. Once the GCP cloud instance is created, perform the steps detailed in Connect Google Workspace with your GCP cloud instance.

###### 2.2.6.3.1. Manually upload template to GCP

####### Prerequisite

* Before you begin, ensure you have: A GCP account. Permission to create the required resources in Google Cloud Deployment Manager. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool. Reviewed the...

####### Note

* The directory you create must be a subdirectory of the home directory.

####### Important

* You must not delete or move the Terraform files from this folder. It will prevent you from being able to edit your cloud instance in the future.

###### 2.2.6.3.2. Connect Google Workspace with your GCP cloud instance

####### Prerequisite

* Ensure you have the Super Admin role in Google Workspace.

* Ensure you have the organization ID of the Google Workspace you want to connect:    Log in to your Google Admin Console. and navigate to Account → Account settings → Profile. Next to Customer ID is your organization ID. Ensure you have the organization ID of the Google Workspace you want to connect: Log in to your Google Admin Console. and navigate...

###### 2.2.6.3.3. Configure GCP integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

###### 2.2.6.3.4. Monitor GCP resources inside service perimeters

####### Note

* Each GCP cloud instance is assigned a scope within GCP. If the scope, whether it be organization, folder, or project, includes any projects with a service perimeter, this procedure must be performed for that cloud instance to authorize Cortex Cloud to scan the resources in the perimeter.

##### 2.2.6.4. Onboard Microsoft Azure

###### Prerequisite

* Ensure you have a Microsoft Azure subscription. Ensure you have the admin permissions required to onboard Microsoft Azure or the built-in Security Administrator role. Obtain the tenant ID and subscription ID. You can view these in the Microsoft Azure Portal in Management groups.

###### 2.2.6.4.1. Finalize Microsoft Azure onboarding by executing the authentication template

####### Prerequisite

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the relevant scope (subscription, management group, tenant). We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed Terraform on your local machine. You can...

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the relevant scope (subscription, management group, tenant). We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed the Azure CLI tool. Authorization to create...

####### Important

* Do not delete or move the Terraform files from this folder. It will prevent you from being able to edit your cloud instance in the future.

###### 2.2.6.4.2. Configure Azure integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

##### 2.2.6.5. Onboard Oracle Cloud Infrastructure

###### Prerequisite

* Ensure you have access to the Oracle Cloud Infrastructure console Permissions for all of the following are required:    Creation of identity groups (for more information, refer to Managing Groups)   Policies (for more information, refer to How Policies Work)   Tag namespaces in the root compartment (for more information, refer to Tags and Tag Namespace...

###### Note

* Excluded compartments are not visible in Cortex Cloud. Additional Security Capabilities: Enable additional Cortex Cloud security add-ons, if available. This may require additional cloud provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. The additional security capabilities you can enable include: Data security posture management: An agentless multi-cloud data security solution that discovers, classifies, protects, and governs sensitive data. Serverless functions scanning (Gen 1 only): Implement serverless scanning to detect and remediate vulnerabilities within serverless functions during the development lifecycle. Seamless integration into CI/CD pipelines enables automated security scans for a continuously secure pre-production environment. Registry scanning: Scan container registry images for vulnerabilities. malware, and secrets. You can configure your initial preference for scanning your registry. Any newly discovered registry, repository, or image in the account will be scanned by default. For more details, see Configure registry scanning for cloud accounts Agentless disk scanning: (Recommended) Implement agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Additional Security Capabilities: Enable additional Cortex Cloud security add-ons, if available. This may require additional cloud provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. The additional security capabilities you can enable include: Data security posture management: An agentless multi-cloud data security solution that discovers, classifies, protects, and governs sensitive data. Serverless functions scanning (Gen 1 only): Implement serverless scanning to detect and remediate vulnerabilities within serverless functions during the development lifecycle. Seamless integration into CI/CD pipelines enables automated security scans for a continuously secure pre-production environment. Registry scanning: Scan container registry images for vulnerabilities. malware, and secrets. You can configure your initial preference for scanning your registry. Any newly discovered registry, repository, or image in the account will be scanned by default. For more details, see Configure registry scanning for cloud accounts Agentless disk scanning: (Recommended) Implement agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Cloud Tags: Define tags and tag values to be added to any new resource created by Cortex Cloud in the cloud environment. Note: The managed_by = paloaltonetworks tag is automatically added to all resources. This tag is mandatory. You cannot edit or remove this tag. Log Collection Configuration: To maximize security coverage, enable the collection of audit logs. This may require additional cloud service provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Enter the following details for each preexisting OCI storage bucket that you intend to use for log collection: Region: The geographic OCI region where the bucket is located. For example, "us-phoenix-1". Bucket Name: The name of the OCI storage bucket. Compartment OCID: The Oracle Cloud Identifier (OCID) of the compartment that contains the bucket. Log Collection Configuration: To maximize security coverage, enable the collection of audit logs. This may require additional cloud service provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Enter the following details for each preexisting OCI storage bucket that you intend to use for log collection: Region: The geographic OCI region where the bucket is located. For example, "us-phoenix-1". Bucket Name: The name of the OCI storage bucket. Compartment OCID: The Oracle Cloud Identifier (OCID) of the compartment that contains the bucket. Download the OCI authentication template by clicking Download Terraform. The Terraform authentication template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The Terraform authentication template is valid for seven days from when it was created. Download the OCI authentication template by clicking Download Terraform. The Terraform authentication template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The Terraform authentication template is valid for seven days from when it was created. Cortex Cloud generates a Terraform authentication template based on the settings you configured in the OCI onboarding wizard. Next step: Apply the Terraform authentication template in OCI. 2.2.6.5.1 |Manually upload template to OCI PREREQUISITE: Before you begin, ensure you have: An Oracle Cloud Infrastructure account and the tenancy OCID. Permission to deploy a custom template and create its resources in OCI. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed...

###### 2.2.6.5.2. Configure the OCI connector for log collection

##### 2.2.6.6. Manually connect a cloud instance

##### 2.2.6.7. Edit your onboarded CSP configuration

###### Important

* When using Terraform authentication templates, you must execute the updated Terraform template from the same folder where the original Terraform template was executed.

##### 2.2.6.8. Outposts

###### Important

* Outpost scan is an alternative to the recommended standard cloud scan. Cloud scan is recommended because it is fully managed by Palo Alto Networks and incurs no compute costs for your organization. Outpost scan is an advanced deployment model reserved for specific data residency or architectural requirements.

###### 2.2.6.8.1. Outpost fundamentals and planning

####### Note

* Before you create your outpost, verify that your internet connection is active. An active internet connection is necessary for the notification to be sent to Cortex Cloud to create the new outpost.

####### Important

* While outposts provide maximum control over the scanning environment, cloud scan mode is the recommended default for most organizations.

####### Navigation

  Before onboarding your Cortex Cloud with the cloud service provider (CSP) onboarding wizard, create an outpost by navigating to Settings → Data Sources & Integrations → Outposts

  Settings → Data Sources & Integrations → Add New

  View and manage existing outposts by navigating to Settings → Data Sources & Integrations → Outposts

###### 2.2.6.8.2. Create an outpost

####### Prerequisite

* Before you begin, ensure you have: An AWS account Permission to create a stack and its resources in AWS Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the AWS CLI tool and configured your profile with the aws...

* Before you begin, ensure you have: A GCP account Permission to create the required resources in Google Cloud Deployment Manager Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool

* Before you begin, ensure you have: An active Azure subscription. Installed the Azure CLI tool. Permission to deploy a custom template and create its resources in Microsoft Azure ("Owner" or "Contributor" on the designated outpost subscription scope, and Active Directory "Cloud Application Administrator" or "Application Administrator" privileged...

####### Note

* Verify that your internet connection is active. An active internet connection is necessary for notifications to be sent to Cortex Cloud for creating the new outpost. If you are unable to establish an internet connection, contact customer support for a manual workaround.

* When creating an outpost for a specific Azure subscription, the outpost account must be in the same Azure organization as the monitored subscriptions.

####### Important

* While outposts provide maximum control over the scanning environment, cloud scan mode is the recommended default for most organizations. For details, see When to choose outpost scan.

####### Navigation

  Start the outpost creation wizard by navigating to Settings → Data Sources & Integrations → Outposts and clicking New Outpost

  A new outpost is created in pending status and can be viewed in the Outpost page at Settings → Data Sources & Integrations → Outposts

##### 2.2.6.9. Introduction to Terraform for Cloud service provider (CSP) onboarding

###### Important

* Always run these commands in the same folder where the original .tf files and .terraform folder live—this is where the state is stored.

* This .tfstate state file is critical because it is needed by the terraform destroy command to clean up created resources. It is critical that you never delete this file.

##### 2.2.6.10. Container Registry Scanning

###### 2.2.6.10.1. Overview of container registry scanning

####### 2.2.6.10.1.1. Registry Components

####### 2.2.6.10.1.2. How Container Registry Scanning Works

###### 2.2.6.10.2. Configure registry scanning for cloud accounts

####### Prerequisite

* Ensure that you have performed the all steps till Additional Security Capabilities as listed in the onboarding wizard for the required CSP: Onboard Amazon Web ServicesOnboard Amazon Web Services Onboard Google Cloud PlatformOnboard Google Cloud Platform Onboard Microsoft AzureOnboard Microsoft Azure Onboard Oracle Cloud InfrastructureOnboard Oracle...

###### 2.2.6.10.3. Modify the container registry scanning scope

###### 2.2.6.10.4. Scan re-evaluation process

###### 2.2.6.10.5. Connect Docker Hub registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.5.1. Manage a Docker Hub connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.6. Connect Docker V2 compliant container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.6.1. Manage a Docker V2 connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.7. Connect GitLab container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

####### Note

* When both the group ID and project ID are provided, the system retrieves container images from all projects within the specified group as well as from the specified project. If neither the group ID nor the project ID is provided, the system retrieves container images from all registries (across all groups and projects) accessible to the authenticated...

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.7.1. Manage a Gitlab Container Registry connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.8. Connect Harbor registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.8.1. Manage a Harbor connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.9. Connect JFrog container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.9.1. Manage a JFrog connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.10. Connect Sonatype Nexus registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

####### Note

* If you are using a CA certificate, enter the server IP address instead of the registry url.

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* If you are using a CA certificate, enter the server IP address instead of the registry URL.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.10.1. Manage a Sonatype connector

######## Note

* If you had selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

##### 2.2.6.11. Cloud service provider permissions

###### 2.2.6.11.1. Amazon Web Services provider permissions

###### 2.2.6.11.2. Google Cloud Platform provider permissions

###### 2.2.6.11.3. Microsoft Azure provider permissions

###### 2.2.6.11.4. Oracle Cloud Infrastructure provider permissions

#### 2.2.7. Onboard the Kubernetes Connector

##### Note

* This option is not supported for Fargate.

* For Fargate, you must provide the cluster resource identifier. The format of the identifier is arn:aws:eks:<region>:<account-id>:cluster/<cluster-name>.

* Basic authentication is only supported in Posture Management. If deploying Realtime Protection, select None .

##### 2.2.7.1. What's new in Kubernetes Connector?

##### 2.2.7.2. Supported Kubernetes distributions

###### Note

* In Google Container-Optimized OS release 100 and earlier, where the FANOTIFY EXEC flag is not supported, the Kernel configuration may be partial for the user mode agent to properly function. In such cases, the agent will fallback to asynchronous mode. In RHCOS version 4.12 and earlier, the Kernel configuration may be partial for the user mode agent to...

### 2.3. Post-deployment steps

#### 2.3.1. Set up your environment

##### 2.3.1.1. Configure server settings

###### Note

* Keyboard shortcuts, timezone, and timestamp format are not set universally and only apply to the user who sets them.

* The Cortex Agentic Assistant and AI case summarization are currently available for users in limited regions. For more information, see Cortex Agentic Assistant.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

###### Navigation

  Settings → Configurations → General → Server Settings

##### 2.3.1.2. Configure security settings

##### 2.3.1.3. Log forwarding

###### 2.3.1.3.1. Forward logs from Cortex Cloud to external services

####### License Type

  Requires Cortex XDR Pro per Endpoint

####### 2.3.1.3.1.1. Integrate a syslog receiver

######## Note

* Up to TLS 1.3 is supported. Make sure the self-signed CA includes your public key.

####### 2.3.1.3.1.2. Integrate Slack for outbound notifications

######## Note

* You are directed to the Slack browser to install Cortex Cloud. You can only use this link to install Cortex Cloud on Slack. Attempting to install from Slack Marketplace will redirect you to Cortex Cloud documentation.

####### 2.3.1.3.1.3. Configure notification forwarding

######## Prerequisite

* Before you can select a syslog receiver or a Slack channel, you must integrate these external services with Cortex Cloud. For more information, see: Integrate a syslog receiver Integrate Slack for outbound notifications

######## Note

* Notification Forwarding by Domain: To configure notification forwarding for issues by domain, select Log Type = Issues and filter the Issues table by Issue Domain. Case IDs in Notifications: If case matching completes before the notification is sent, the Case ID is included. If matching takes longer than the notification trigger, the notification is...

####### 2.3.1.3.1.4. Monitor administrative activity

###### 2.3.1.3.2. Data and log notification formats

####### Note

* Issues can be forwarded to email, syslog servers, and Slack in the alert format, if you prefer. The alert format can be selected when you configure your forwarding notification.

####### 2.3.1.3.2.1. Management audit log messages

####### 2.3.1.3.2.2. Issue notification format

####### 2.3.1.3.2.3. Agent Audit log notification format

####### 2.3.1.3.2.4. Management Audit log notification format

####### 2.3.1.3.2.5. Log format for IOC and BIOC issues

####### 2.3.1.3.2.6. Analytics log format

#### 2.3.2. Cortex MCP server

##### 2.3.2.1. Cortex MCP server overview

###### Note

* This feature is in Beta.

* The Cortex MCP Server empowers you to integrate AI into your security workflows using natural language. When using LLM-based suggestions, always review and approve actions suggested by the AI before they're executed. We recommend deploying the Cortex MCP server in a secure environment where access is limited to authorized users.

###### 2.3.2.1.1. Install the Cortex MCP server

####### Prerequisite

* If you are running the Cortex MCP server in a Poetry virtual environment, you must have Python 3.13 or higher. If you plan to run the Cortex MCP server in a Docker container, you must have Docker installed.

####### Note

* The MCP Server uses public APIs to communicate and is limited by the license quotas available in your tenant. This is particularly relevant when running XQL queries. For more information on running XQL query APIs, see Run XQL query APIs.

* It is critical to avoid assigning excessive permissions when creating an API key for the Cortex MCP Server. Since the key has both read and write capabilities, overly broad permissions can lead to unintended actions and potentially compromise your environment. Ensure the key follows the principle of least privilege and is granted only the minimum...

* When using Docker, we recommend using an .env file to set the Cortex API credentials as environment variables. While the credentials can be provided in the MCP client configuration settings, the .env file provides safer handling of API credentials and makes your configuration easily reproducible.

* By default, stdio (standard input/output) is used. You can also configure Streamable HTTP, to send requests directly to the tenant instead of through the MCP client. Streamable HTTP can be useful for testing in the browser without a MCP client and to bypass limits that may be in place for your MCP client. For Docker, you can include the Streamable HTTP...

####### Important

* To configure the Cortex MCP Server, you need the Cortex API URL, Cortex API key, and Cortex API key ID. You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

###### 2.3.2.1.2. Configure the MCP client

####### Navigation

  Settings → Developer → Edit Config

###### 2.3.2.1.3. Use the Cortex MCP server

####### Note

* The built-in tools retrieve information, but do not write to the tenant. You can create your own tools that include write actions. The examples below include both.

###### 2.3.2.1.4. Create custom Cortex MCP server tools

####### Note

* Any new or updated components provided by Cortex are automatically downloaded into the remote_components folder.  During each update, the folder is fully replaced and all existing contents are recreated. Do not add custom tools to this directory, as it is managed entirely by Cortex and is overwritten at every update.

#### 2.3.3. Manage user roles and access management

##### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

##### Note

* For more information on assigning user roles when generating an API key, see Manage API keys.

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* For features where scoping is not applicable, Role-Based Access Control (RBAC) is used and can be configured when managing user roles. For more information, see Manage user roles.

##### 2.3.3.1. Manage user roles

###### Prerequisite

* Managing user roles in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Navigation

  Settings → Configurations → Access Management → Roles

##### 2.3.3.2. Manage user access

###### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Note

* You can only reduce the permissions of an Account Admin user via Cortex Gateway.

* User permissions for components and datasets are based on the access permissions set in the user role. For more information on editing these user role permissions, see Manage user roles.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit User Permissions.

###### Navigation

  Settings → Configurations → Access Management → Users

###### 2.3.3.2.1. User access reference information

##### 2.3.3.3. Manage user scope

###### Prerequisite

* Configuring user scopes in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles. By default, Enable Scope Based Access Control is...

###### Note

* This configuration can impact the visibility of the related Security domain in the Cases and Issues scope area, but with not affect asset visibility.

* XQL-based dashboard widgets may require a few hours to initially reflect changes to the list or definitions of asset groups used for scoping. To view the most current data immediately, refresh the dashboard or its XQL widgets.

* For Cases and Issues domains, a workaround is to create a Dataset View for each required combination of domains, and allow the relevant entity access only to this Dataset View, not to the underlying cases and issues datasets.

* Make sure to assign the required default granular scoping for users. This depends on the structure and divisions within your organization and the particular purpose of each organizational unit to which scoped users belong.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Some areas and features in Cortex Cloud do not respect SBAC. In these cases, use RBAC permissions to restrict access.

* Action Required: Recent security enhancements enforce stricter default permissions for cases and issues that lack specific asset or endpoint references. This notice explains how to include access to these items if your users' visibility has been impacted.

* Before configuring, ensure that you review the Understand scoping section.

##### 2.3.3.4. Manage access to objects

###### 2.3.3.4.1. Manage access to custom dashboards

####### Prerequisite

* Configure tenant-level settings: An administrator must first establish the sharing framework under Settings → Configurations → Access Management → Objects. The configuration of these settings defines the authorized sharing workflows for custom dashboards:    Enable "Owners can Share objects they created": Grants owners the ability to share...

####### Note

* If you're designated as an Editor, you can always duplicate the widget and make your changes on the copy.

* Only Account Administrators and Instance Administrators have the authority to change the owner of an object.

###### 2.3.3.4.2. Manage access to saved queries

####### Prerequisite

* Configure tenant-level settings: An administrator must first establish the sharing framework under Settings → Configurations → Access Management → Objects. The configuration of these settings defines the authorized sharing workflows for saved queries in the Query Library, including the options that appear to users when clicking the three dot,...

####### Note

* If the role of a user is set to Edit Public Queries but not Create Queries, they can update existing public queries, but the Save as drop-down menu will be hidden, preventing them from creating new Query Library entries.

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

#### 2.3.4. Configure the Cortex Agentic Assistant

##### 2.3.4.1. Agentic Assistant components and concepts

###### Note

* Agents are bound by the same rules and robust permissions as a human user. In addition, you can mark actions that make real-world changes in production systems as sensitive, requiring a quick manual review and confirmation, ensuring peace of mind before critical system changes are made.

##### 2.3.4.2. Agents Hub

###### Note

* To manage agents in the Agents Hub, you must have the proper permissions. For more information, see Agentic Assistant role-based access control.

###### 2.3.4.2.1. Manage actions

####### Note

* To manage actions in the Agents Hub, you must have the correct permissions. For more information, see Agentic Assistant role-based access control.

###### 2.3.4.2.2. Register actions

####### Note

* To register actions, ensure you have the correct permissions. For more information, see Agentic Assistant role-based access control.

* Mandatory arguments cannot be deselected.

####### Important

* A single content item can be registered as different actions, with each action using different inputs and outputs from the same script. Only register the same script, command, or AI prompt as a new action if it is required for your use case, as providing an agent with many actions with overlapping abilities can reduce the ability of the agent to choose...

###### 2.3.4.2.3. Manage agents

####### Note

* In some cases, an agent may include actions with content items that are not relevant for all licenses. If that occurs, the grey circle appears, but you are not able to install the related content.

###### 2.3.4.2.4. Build agents

####### Note

* To build agents in the Agents Hub, you must have view/edit permissions. For more information, see Agentic Assistant role-based access control.

* If you clear the checkbox for a role, all actions associated with that role are also cleared. The exception is if another role is also selected, which is associated with the same actions. If you clear the checkbox for an action, all roles associated with that action are cleared. For example, if you select the Investigator role, and Send Mail and Tavily...

###### 2.3.4.2.5. Expand agent capabilities with MCP integrations

####### Note

* If you are using OAuth-based authentication, the Test button returns an error containing the command to run in the playground in order to test the connection.

* If an MCP tool is removed from the MCP server, the action will be unavailable due to missing content. If the tool is restored on the MCP server, the action is automatically reenabled.

####### Navigation

  Settings → Configurations → Data Collection → Integration Permissions

##### 2.3.4.3. Agentic Assistant role-based access control

#### 2.3.5. XQL query management

##### Prerequisite

* Setting query limits requires View/Edit permissions for Configurations → Query Management.

##### Note

* A scheduled query or report is run on behalf of the user that originally created it, even if it is edited and run by another user.

* Queries run by correlation rules are not restricted by the query limit. Very short queries do not count towards concurrent queries.

* To ensure optimal system performance, all queries (user-generated and otherwise) adhere to a default timeout limit of 60 minutes that is defined by Palo Alto that takes priority over the administrator defined value. Therefore, regardless of the value specified in this field, queries will be stopped after 60 minutes. You can override the default timeout...

* Query visibility is subject to Role-Based Access Control (RBAC); users can't see queries for datasets they do not have permission to access.

##### Navigation

  You can find Query Management options under Settings → Configurations → General → Query Management

#### 2.3.6. Customize cases and issues

##### 2.3.6.1. Customize cases and issues

###### 2.3.6.1.1. Set up case scoring

####### Note

* For scoped users, a small lock icon indicates that you don't have permissions to edit a rule.

####### Tip

* Right-click an issue field to add it as match criteria.

###### 2.3.6.1.2. Create a starring configuration

####### Tip

* Right-click an issue field to add it as match criteria.

###### 2.3.6.1.3. Create custom case statuses and resolution reasons

####### Note

* Before you create a custom status, please review the built-in options. For more information, see Resolution reasons for cases and issues. We recommend using the built-in statuses and resolution reasons where possible. Custom statuses and resolution reasons might not be supported by all content, and status syncing can take time. In addition, custom...

* After creation, custom statuses and resolution reasons cannot be deleted or modified.

####### Navigation

  Configurations → Object Setup → Cases → Properties

###### 2.3.6.1.4. Create a sync profile

####### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

#### 2.3.7. Dashboards and reports

## 3. Endpoint security

### 3.1. Endpoint protection

#### 3.1.1. Malware protection

#### 3.1.2. Exploit protection

#### 3.1.3. File analysis and protection flow

##### Note

* To enhance performance and efficiency, hash verdict requests from the Cortex XDR agent will be routed to the WildFire service with the lowest latency. File uploads for analysis will strictly adhere to the designated Cortex Cloud and WildFire regions, ensuring data remains within the appropriate geographical boundaries.

#### 3.1.4. Endpoint protection capabilities

#### 3.1.5. Endpoint protection modules

#### 3.1.6. Processes protected by exploit security policy

#### 3.1.7. File Integrity Monitoring (FIM)

##### License Type

  FIM requires the Cortex Cloud Runtime Security add-on.

##### Note

* Google Kubernetes Engine (GKE) is currently not supported

* It is recommended to create a policy that targets only the necessary files and folders.

* Platform cannot be changed once a rule group has been created

* A rule group can contain up to 100 rules.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* It is possible to ingest up to 15,000 events per day (24 hours) for each host/container.

##### Navigation

  Creating, modifying and viewing FIM rule groups and rules is be done in the Rule Groups page, located at the Inventory → Endpoints → File Integrity Monitoring menu

  In Inventory → Endpoints → Policy management → Extensions → Profiles, select +Add Profile and then select either Create New or Import from File

#### 3.1.8. WildFire analysis concepts

##### Note

* In cases when the Cortex Cloud agent gets a failed status from the WF service due to a general error or unsupported file type, and the Local Analysis is set to disabled or not applicable, Cortex Cloud will not generate an alert on the file.

#### 3.1.9. Guidelines for keeping Cortex XDR agents and content updated

##### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups. See how to define endpoint group.

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups.

##### Important

* When planning Cortex XDR agent upgrades and content updates, consult with the appropriate stakeholders and teams and follow the change management strategy in your organization.

##### Caution

* Before enabling Auto-Update for Cortex XDR agents, make sure to consult with all relevant stakeholders in your organization.

#### 3.1.10. About content updates

##### Note

* Cortex Cloud delivers the content update to the agent in parts and not as a single file, allowing the agent to retrieve only the updates and additions it needs.

#### 3.1.11. Endpoint data collection

##### Note

* For specific files only and only if the file was written.

##### Important

* Registry key is collected as a real key name, and not as a symbolic link. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, KEY_LOCAL_MACHINE\System\ControlSet001 will be collected. Instead of HKEY_CURRENT_USER, HKEY_USERS\<SID> will be collected, where SID is a SID of the current user.

### 3.2. Install and manage endpoints

#### 3.2.1. Set up endpoint protection

##### 3.2.1.1. Set up endpoint profiles and exception rules

###### Note

* Profiles associated with one or more targets that are beyond the scope of your defined user permissions are locked, and cannot be edited.

###### 3.2.1.1.1. Set up malware prevention profiles

####### License Type

  Requires the ITDR add-on.

####### Note

* In this profile, the Report options configure the endpoints to report the corresponding suspicious files, actions, processes, or behaviors to Cortex Cloud, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* As part of the anti-malware security flow, the Cortex XDR agent leverages the operating system's capability to identify revoked certificates for executables, and DLL files that attempt to run on the endpoint by accessing the Windows Certificate Revocation List (CRL). To allow the Cortex XDR agent access the CRL, you must enable internet access over...

* The Quarantine Malicious Executables feature is not available for malware identified on network drives.

* The Quarantine Malicious Script Files feature is not available for malware identified on network drives.

* If on-write actions were configured in earlier versions of Cortex Cloud, the same configuration has been preserved and applied globally for all file types. On-write file protection may have an impact on the resources required by the Cortex XDR agent.

* On-demand file protection may have an impact on the resources required by the Cortex XDR agent.

* We recommend that you disable scheduled scanning. VDI machine scans are based on the golden image and additional files will be examined upon execution.

* When periodic scanning is enabled in your profile, the Cortex XDR agent initiates an initial scan when it is first installed on the endpoint, regardless of the periodic scanning scheduling time.

* This feature only comes into effect after a restart.

* When you are actively evaluating with BAS tools, it is recommended to enable the BAS mode setting only for the duration of your evaluation, and for a limited number of agents.

* BAS tools mode with content older than version 1850 cannot be configured, the agent will be treated as Enabled.

* The Quarantine Malicious Mach-O Files feature is not available for malware identified on network drives.

* This module is supported by Cortex XDR agent 8.1.0 and later releases.

* The Quarantine Malicious ELF Files feature is not available for malware identified on network drives.

* Enabling on-demand scanning will automatically scan these core system directories: /etc, /tmp, /home, /usr, /bin, /sbin, /lib, /var, /opt, /dev, /root, /boot.

####### Warning

* For optimal user experience, we recommend that you set the action mode to either Allow or Run Local Analysis.

###### 3.2.1.1.2. Set up exploit prevention profiles

####### Note

* In this profile, the Report options configure the endpoints to report the corresponding exploit attempts to Cortex Cloud, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* In exploit prevention profiles, if you change the action mode for processes, you must restart the protected processes for the following security modules to take effect on the process and its forked processes: Brute Force Protection Java Deserialization SO Hijacking

* This step provides a temporary workaround for the following publicly known information-security vulnerabilities and exposures: CVE-2021-24074, CVE-2021-24086 and CVE-2021-24094.

* If you have Windows endpoints in your network that are unpatched and exposed to a known vulnerability, we strongly recommend that you upgrade to the latest Windows Update that has a fix for that vulnerability.

####### Warning

* This workaround applies only to the specific Windows versions listed as exposed to these CVEs, and requires a Cortex XDR agent release 7.1 or later and content 167-51646 or later. This workaround is not recommended for non-persistent, stateless, or linked-clone environments. In some cases, enabling this workaround can affect the network functionality...

###### 3.2.1.1.3. Set up agent settings profiles

####### License Type

  Requires a Cortex XDR Pro per Endpoint license. When you enable this feature, a Cortex XDR Pro per Endpoint license is consumed.

  Requires Host Insights add-on.

  Requires Forensics Add-on.

####### Prerequisite

* User Space Agent mode requires Linux kernel 5.0.0 or higher.

####### Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

* You can enable the option to maintain a persistent notification regarding the disconnection of the endpoint from the network. The settings Persistent Isolation Notification and Blocked Connectivity Notification must be enabled. Until the threat on the endpoint has been removed, the endpoint remains disconnected from the network.

* In Traps 5.0.6 and later releases, when protection is enabled, access will be read-only. In earlier Traps releases, enabling protection disables all access to services, processes, files, and registry values.

* If you choose the Enable option, you must also enable XDR Agent Tampering Protection in the malware profile and set it to Block. Ensure that both profiles are assigned to the same endpoints.

* When you enable Cortex XDR agent registration with the Windows Security Center, Windows automatically shuts down Microsoft Defender on Windows-based workstation endpoints. If you still want to allow Microsoft Defender to run on a workstation endpoint where Cortex Cloud is installed, you must use the Disable option. However, Palo Alto Networks does not...

* To enable access to these options, scroll down to Network Location Configuration, and set Action Mode to Enabled.

* When using Nmap, the Cortex XDR agent downloads an Nmap driver for the duration of the scan and removes the driver upon completion. If an Nmap scan is in process, Cortex Cloud identifies the Nmap driver and places any additional scans in a queue.

* If you disable content updates for a newly installed agent, the agent retrieves the content for the first time from Cortex Cloud, and then disables content updates on the endpoint. When you add a Cortex XDR agent to an endpoint group with a disabled content auto-upgrades policy, the policy is applied to the added agent as well.

* Automatic upgrades are not supported with non-persistent VDI and temporary sessions.

* The delay timer starts from the date of the target agent version's availability in the tenant.

* Limitations in the content download process: When you install the Cortex XDR agent, the agent retrieves the latest content update version available. A freshly installed agent can take between five to ten minutes (depending on your network and content update settings) to retrieve the content for the first time. During this time, your endpoint is not...

* If the Cortex XDR agent is initially unable to communicate without the local store, enforcement is not enabled and the agent will show as partially protected.

* If you choose the Enabled option, you must also set Anti Tampering Protection in the malware security profile to Block, and ensure that both profiles are assigned to the same endpoints.

* When protection is enabled, access to services, processes, files, and registry values will be read-only.

* If you disable content updates for a newly installed agent, the agent retrieves the content for the first time from Cortex Cloud, and then disables content updates on the endpoint.

* Automatic upgrades are not supported with non-persistent VDI and temporary sessions. When a Cortex XDR agent is added to an endpoint group, it inherits the group's policy, including the disabled content auto-upgrades setting.

* Automatic upgrades are not supported for XDR agents running on K8s.

* User Space Agent mode requires Linux kernel 5.0.0 or higher. Endpoints running an older Linux kernel version with this fallback enabled, will not start using User Space Agent mode, and will operate asynchronously.

####### Warning

* If you disable or delay automatic-content updates provided by Palo Alto Networks, it may affect the security level in your organization.

###### 3.2.1.1.4. Set up restrictions prevention profiles

####### Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Configure custom BIOC prevention rules here:

* Wildcards are supported.

###### 3.2.1.1.5. Set up exception profiles and rules

####### 3.2.1.1.5.1. Exception configuration

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Settings → Exception Configuration → Legacy Exceptions and click Start Simulation

####### 3.2.1.1.5.2. Issue exclusions

######## Note

* The agent continues to generate excluded issues on the endpoint, but they are not saved or displayed in Cortex Cloud. Configuration of an issue exclusion does not remove or delete any of the logs that would have triggered the issue notification. You can also set up issue exceptions by creating global endpoint policy exceptions. For more information,...

######## Navigation

  The Settings → Exception Configuration → Issue Exclusions page displays the issue exclusion rules in Cortex Cloud

####### 3.2.1.1.5.3. Add an IOC or BIOC rule exception

######## Note

* Cortex Cloud only supports exceptions with one attribute. See Add an alert exclusion rule to create advanced exceptions based on your filtered criteria.Add an alert exclusion rule

######## Navigation

  Settings → Exceptions Configuration → IOC/BIOC Suppression Rules

####### 3.2.1.1.5.4. Add a disable prevention rule for endpoints

######## Important

* All applicable prevention actions are skipped for the files and process that match the properties defined in the rule. Consider the consequences of disabling a prevention rule before you add the exception, and monitor it over time. You can only apply a Disable Prevention Rule to endpoints running Cortex XDR agents version 7.9 and later.

######## Navigation

  Settings → Exception Configuration → Disable Prevention Rules

####### 3.2.1.1.5.5. Add a disable injection and prevention rule

######## Important

* Exceptions are limited up to 48 hours by default and configurable up to one week. Consider the consequences of disabling a prevention rule before you add the exception and monitor it over time. You can only apply a Disable Prevention Rule to agents version 7.9 and later.

######## Navigation

  Settings → Exception Configuration → Disable Injection and Prevention

####### 3.2.1.1.5.6. Add a support exception rule for endpoints

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Your migrated rules are displayed on the Settings → Exception Configurations → Support Exception Rules page

  From Settings → Exception Configuration → Support Exception Rules, click + Import from file

####### 3.2.1.1.5.7. Add a legacy exception rule for endpoints

######## Note

* This exception prevents the agent from examining the specified file. Use with caution, as it may unintentionally allow unwanted or malicious behavior to go undetected.

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Your migrated rules are displayed on the Settings → Exception Configurations → Legacy Agent Exceptions page

##### 3.2.1.2. Define endpoint groups

###### Note

* Disconnecting Cloud Identity Engine in your Cortex Cloud deployment can affect existing endpoint groups and policy rules based on Active Directory properties.

##### 3.2.1.3. Configure global agent settings

###### Note

* Disabling this capability takes immediate effect on new hashes, fresh agent installations, and existing security policies. It could take up to a week to take effect on existing agents in your environment pending agent caching.

* If you have any Cortex Cloud filters, starring policies, exclusion policies, scoring rules, log forwarding queries, or automation rules configured for XSOAR/3rd party SIEM, we advise you to update those to support the changes before activating the feature. For example, change the query to include the previous description that is still available in the...

##### 3.2.1.4. Apply profiles to endpoints

###### Note

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

##### 3.2.1.5. Create an agent installation package

###### Note

* The profile will be applied if the security policy cannot be retrieved in real-time.

* The Cortex serverless library must be imported after other libraries to activate the hooks that enable auditing.

###### 3.2.1.5.1. Manage an agent installation package

####### Note

* Since Cortex Cloud relies on the installation package ID to approve agent registration during the installation, we recommend that you don't delete the installation package of active endpoints. If you install the Cortex XDR agent from a package after you delete it, Cortex Cloud denies the registration request leaving the agent in an unprotected state....

##### 3.2.1.6. Harden endpoint security

###### Navigation

  From Inventory → Endpoints → Policy Management → Extensions → Profiles, you can create profiles for the following hardened endpoint security capabilities

  To apply the profiles, from Inventory → Endpoints → Policy Management → Extensions → Policy Rules, you can view all the policy rules per operating system

###### 3.2.1.6.1. Device control

####### Note

* Operating systems report on devices in different ways. Sometimes, the same BLE device will report different services and interfaces, depending on the host's operating system. This may have an effect on the specific BLE services that are blocked for each operating system. Depending on your defined user scope permissions, creating device profiles,...

* For network printer print jobs, ensure that you also configure the Agent Settings profile, Network Location Configuration option. This setting must be set to Enabled, and configured. If you do not enable and configure this setting, all network printer operations will be treated as internal network print jobs. For network printer print jobs, ensure that...

* Currently, the default is set to Use Default (Allow), however, Palo Alto Networks may change the default definition at any time.

* You cannot edit or delete the default profiles pre-defined in Cortex Cloud.

* You cannot edit or delete the predefined profiles in Cortex Cloud.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* Permanent exceptions apply across platforms, allowing the devices on all operating systems.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

####### Navigation

  Endpoints → Policy Management → Settings → Device Management

###### 3.2.1.6.2. Host firewall

####### 3.2.1.6.2.1. Host firewall for Windows

######## Note

* A rule is always part of a rules group. It cannot stand on its own. A rule can belong to one rules group only and cannot be reused in different groups.

* When selecting ICMP protocol, you must enter a the ICMP Type and Code. Without these values the ICMP protocol is ignored by the Windows and macOS Cortex XDR agents.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows. New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until target is specified.

* The data is aggregated and reported periodically every 60 minutes since the first time the host firewall policy was enforced on the endpoint, not every round hour. The table lists enforcement events only for rules set to Report Matching Traffic.

######## Navigation

  From Inventory → Endpoints → Policy Management → Extensions and select + Add Profile or Import from File

####### 3.2.1.6.2.2. Host firewall for macOS

######## Note

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

######## Navigation

  From Inventory → Endpoints → Policy Management → Extensions Profiles → Profiles, select + New Profile or Import from File

  Additionally, to monitor the communication on your macOS endpoint, you can use the following operating system utilities: From the endpoint System Preferences → Security and Privacy → Firewall → Firewall options, you can view the list of blocked and allowed applications in the firewall

###### 3.2.1.6.3. Disk encryption

####### Note

* You must select the same encryption method configured by the Microsoft Windows Group Policy in your organization for the target endpoints. Otherwise, if you select a different encryption method than the one already applied through the Windows Group Policy, Cortex Cloud displays errors.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

####### Navigation

  You can monitor the Encryption Status of an endpoint in the Inventory → Endpoints → Disk Encryption Visibility table

###### 3.2.1.6.4. Host Inventory

####### Note

* Cortex Cloud includes only the first 10,000 results per endpoint. Cortex Cloud lists only users that belong to each group directly, and does not include users who belong to a group within the main group. If a local users group includes a domain user (whose credentials are stored on the Domain Controller server and not on the endpoint), Cortex Cloud...

####### Navigation

  Inventory → Endpoints → Host Inventory

###### 3.2.1.6.5. Vulnerability Assessment

####### Prerequisite

* The following are prerequisites for Cortex Cloud to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex Cloud lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex Cloud...

* The following are prerequisites for Cortex Cloud to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex Cloud collects all the information about the operating system and the installed...

####### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex Cloud Application Inventory.

####### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

####### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

##### 3.2.1.7. Set a Cortex XDR agent Critical Environment version

###### Note

* To ensure the stability of the line, CE versions maintenance release cadence is longer than in the standard line, we recommend that deployment is adjusted accordingly.

###### Navigation

  Settings → Configurations → General → Agent Configurations

  Inventory → Endpoints → All Endpoints

##### 3.2.1.8. Set an application proxy for Cortex XDR agents

###### Warning

* If adding a proxy to the allow list be aware of the following: This allows any application on the isolated endpoint to communicate through that proxy, potentially allowing a threat actor or malware to bypass the isolation and reach external resources. Ensure that no other non-security applications are utilizing this proxy if you choose to allow it.

###### Navigation

  Inventory → Endpoints → All Endpoints

#### 3.2.2. Manage endpoint protection

##### 3.2.2.1. Move agents between managing servers

###### Prerequisite

* Consider the following before making changes: Endpoint type is not Kubernetes Node. Installation type is not VDI. Ensure you have administrator privileges for Cortex Cloud in the hub.

###### Note

* Cortex Cloud does not support moving agents between FedRamp and commercial tenants.

###### Navigation

  Inventory → Endpoints → Agent Installations

  Inventory → Endpoints → All Endpoints

##### 3.2.2.2. Manage endpoint tags

###### Note

* The following explanations use Windows operating system installation parameters and Cytool argument examples.

* Tag names are case sensitive. In Windows and Mac, a tag name can contain spaces. Linux does not support tag names with spaces as command line arguments to the shell installer. Instead, tags can be set in the /etc/panw/cortex.conf configuration file, which supports all Linux installers.

* Tag names are case sensitive and can contain spaces.

* When SBAC is enabled, assigning tags may impact user permissions.

* If you remove the tag and there are assigned users or user groups with scope settings, this can impact user permissions in the system.

##### 3.2.2.3. Set an alias for an endpoint

###### Tip

* If you change your mind in the future, you can select Endpoint Control → Change Endpoint Alias again, and delete the required aliases.

##### 3.2.2.4. Manage endpoint prevention profiles

###### Note

* The filter is stored within the policy definition and assessed during runtime to extract the functions that match the filter criteria.

###### Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

##### 3.2.2.5. Upgrade Cortex XDR agents

###### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* It is possible to cancel an upgrade if the Status is Pending. Once the Status is In Progress, the action is already received by the agent locally and cannot be canceled from the management console. Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating...

###### Warning

* You must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check whether the extensions were approved, you can either verify that the...

###### Important

* The following list includes important points to take into account when upgrading the Cortex XDR agent: Review the recommended guidelines for keeping Cortex XDR agents and content updated. Read more here. You cannot upgrade the Cortex XDR agent on VDI endpoints or a Golden Image. You must reinstall (uninstall and install again) the relevant agent...

##### 3.2.2.6. Restart agent

##### 3.2.2.7. Uninstall the Cortex XDR agent

###### Note

* Before upgrading a Cortex XDR agent running on macOS 10.15.4 or later, you must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check...

###### Tip

* If needed, use the filter to filter the list of endpoints by attribute or group name.

###### Navigation

  Inventory → Endpoints → All Endpoints

##### 3.2.2.8. Clear agent database

###### Note

* Clearing the agent database is supported on all platforms with Cortex XDR agent version 7.9 or later, and is available only when using the debugging mode.

* You can only right-click to cancel the clear agent database for actions with a pending status.

##### 3.2.2.9. Delete Cortex XDR agents

###### Note

* To reinstate an endpoint, you have to uninstall and reinstall the agent.

###### Navigation

  Inventory → Endpoints → All Endpoints

##### 3.2.2.10. Manage agent tokens

###### Note

* Agent tokens are only supported for Windows and Mac.

* You can select a one or multiple agents to add a temporary token.

##### 3.2.2.11. Retrieve support file password

###### Navigation

  Retrieve Support File Password from Inventory → Endpoints → All Endpoints

##### 3.2.2.12. Monitor agent operational status

###### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex Cloud management console for specific reasons for the state.

###### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

###### Navigation

  You can monitor the Cortex XDR agent Operational Status in Inventory → Endpoints → All Endpoints

##### 3.2.2.13. Monitor agent activity

##### 3.2.2.14. Monitor agent upgrade status

###### Navigation

  From Inventory → Endpoints → All Endpoints, you can view the upgrade status of any Cortex XDR agent that you manage

### 3.3. Endpoint DLP

#### 3.3.1. Cortex Data Loss Prevention (DLP) module overview

##### Prerequisite

* Tenant should be onboarded to the new Cortex & Cloud Platform Endpoint DLP add-on License for Cortex and Cloud platforms Cortex agent 9.1 and above for Windows and macOS

##### Navigation

  Settings → Configuration → Access Management → Roles

#### 3.3.2. Personas workflow for DLP

#### 3.3.3. Best Practices

##### Note

* A good example would be to add the description from the Raised Issue Name of the specific Data-in-Motion rule.

* When adding a source, it becomes a mandatory requirement that must be met for the rule to trigger. You should only apply this setting if you want the rule to take action exclusively when files originate from those specific locations.

##### Navigation

  Refer to Modules → Data Security → Data Security Issues → Threats

  Modules → Data Security → Endpoint Data-in-Motion Rules → Endpoint DLP Settings to configure the tenant settings for DLP

#### 3.3.4. Configure DLP end-to-end

##### 3.3.4.1. Onboarding checklist for DLP

###### 3.3.4.1.1. Install DLP browser extension on your endpoint

####### Note

* The extensions are not enabled for Incognito or InPrivate modes in Chrome and Edge. It is recommended to disable these modes in the organization.

* It is highly recommended to refer to Install the Cortex XDR Agent using JAMF for a comprehensive overview of setting up a JAMF profile.Install the Cortex XDR Agent Using JAMF

####### Important

* Endpoints should be linked to the domain.

###### 3.3.4.1.2. Create endpoint applications

###### 3.3.4.1.3. Create endpoint application groups

####### Note

* The catalog contains a list of all supported and tested applications. If an application you need is not on the list, contact support for assistance.

###### 3.3.4.1.4. Create data-in-motion rules

####### Note

* This is not supported in the Beta release.

* Third-party application behaviour: When a file upload is blocked, the local application may display its own generic error message in response to the DLP restriction. In similar cases, some third-party applications might still proceed by sending a dummy file or an error placeholder instead of the actual data.

* To maximize data security, if you use Microsoft Purview for extensive manual and automated file classification tagging and are looking to integrate those labels directly with the DLP policies to trigger protective actions based on a file's sensitivity, refer to How to use information protection labels in Cortex Cloud Data Security.

* Distribution of the Endpoint DLP package is restricted to agents assigned to the data-in-motion policy. This ensures that only endpoints requiring DLP functionality are affected, rather than all eligible endpoints in the tenant.

###### 3.3.4.1.5. Configure endpoint DLP settings

####### Note

* When a fail-close action occurs, the system creates a Data movement blocked by Endpoint DLP fail-close action issue.

* The agent does not force-install the extension if it is already managed by the MDM on the endpoint. The XDR agent ensures full coverage by force-installing the extension on both managed and unmanaged browsers. But if a browser becomes officially managed by the organization later, the extension must be redeployed through the central management console...

* In the case of MDM, the extension is user-managed, so Cortex doesn't remove an installed MDM extension, it only disables communication with the DLP extension.

* You can specify the end-user message per rule.

#### 3.3.5. DLP status in all endpoints

##### Note

* It is recommended to work with the latest security content.

* Close and reopen your browser to activate the DLP extension.

#### 3.3.6. Cortex DLP threat detection and issues

##### Note

* Access to this page is restricted to users with the roles: Data Security Admin, Instance Administrator, and Account Admin.

* If the default action configured in Endpoint DLP Settings is set to Block file movement (fail-close), an issue is raised where the assigned severity is set to low, and includes the Name Data movement blocked by Endpoint DLP default action

##### Navigation

  Data Security → Data Security Issues → Threats

  From Data Security → Data Security Issues → Threats, you can view the DLP issues

## 4. Threat management

### 4.1. Detection rules

#### 4.1.1. What are detection rules?

##### 4.1.1.1. What's an IOC?

###### Note

* Cortex Cloud supports a maximum of 4,000,000 IOCs.

###### 4.1.1.1.1. IOC rule details

####### Note

* Field cannot exceed 36 characters.

####### Navigation

  In the Threat Management → Detection Rules → IOC page, you can view all configured or uploaded indicators of compromise (IOCs

###### 4.1.1.1.2. Create an IOC rule

####### Note

* To ensure your IOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex Cloud automatically does the following: Disables any IOC rules that reach 5000 or more hits over 24 hours. Creates a rule exception based on the PROCESS SHA256 field for IOC rules that hit more than 100 endpoints over 72 hours.

####### Navigation

  In Threat Management → Detection Rules → IOC, select + Add IOC

##### 4.1.1.2. What's a BIOC?

###### 4.1.1.2.1. BIOC rule details

####### Navigation

  Manage your behavioral indicator of compromise (BIOC) rules in Threat Management → Detection Rules → BIOC

###### 4.1.1.2.2. Create a BIOC rule

####### License Type

  Custom prevention rules are supported on Cortex Cloud agent 7.2 and later versions and enable you to configure and apply user-defined BIOC rules to Restriction profiles deployed on your Windows, Mac, and Linux endpoints.

####### Note

* To ensure your BIOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex Cloud automatically does the following: Disables BIOC rules that reach 5000 or more hits over a 24-hour period. Creates a rule exception based on the PROCESS SHA256 field for BIOC rules that hit more than 100 endpoints over a 72 hour period.

* A cloud_audit_log dataset requires a Cortex XDR Pro per GB license. Currently, you cannot create a BIOC rule on customized datasets and only the filter stage, alter stage, and functions without any aggregations are supported for XQL queries that define a BIOC. For BIOC rules, the field values in XQL are evaluated as case insensitive (config...

* To demonstrate the expected behavior of the rule before you save it, Cortex Cloud tests the BIOC on historical logs. After you save a BIOC rule, it will operate both on historical logs (up to 10,000 hits) and on new data received from your log sensors.

* To demonstrate the expected behavior of the rule before you save it, Cortex Cloud tests the BIOC on historical logs. After you save a BIOC rule, it will operate on both historical logs (up to 10,000 hits) and new data received from your log sensors.

* You can only import files that were exported from Cortex Cloud. You can not edit an exported file.

* You can only add to existing profiles you created, Cortex Cloud Default profiles will not appear as an option.

* Auto-disable will turn off both the BIOC rule detection and the BIOC prevention rule.

###### 4.1.1.2.3. Manage Global BIOC Rules

##### 4.1.1.3. What's a correlation rule?

###### Navigation

  After you configure your correlation rules, you can manage them in Threat Management → Detection Rules → Correlations, and view and analyze the generated issues in Cases and the Issues Table

###### 4.1.1.3.1. Correlation rule details

####### Note

* Only an administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex Cloud .

* For more information on troubleshooting server errors in scheduled correlation rules, Troubleshoot server errors in scheduled correlation rules.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

####### Navigation

  If you are assigned a role that enables Investigation → Rules privileges, you can manage all user-defined Correlation Rules from Threat Management → Detection Rules → Correlations

###### 4.1.1.3.2. Create a correlation rule

####### Note

* When you open the New Correlation Rule editor from XQL Search, this XQL Search field is already populated with the XQL query that you defined. An administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex Cloud . All other users can only create and view queries built with an existing dataset.

* The XQL features for call, top, and wildcards in datasets (dataset in (<dataset prefix>_*)) are currently not supported in Correlation Rules. If you add them to the XQL definition, you will not be able to Create or Save the Correlation Rule. The XQL features for transaction in datasets (dataset in (<dataset prefix>_*)) are currently not supported in...

* If a generated issue has severity Medium or above, a case is automatically opened. Low severity issues generated by correlation rules are not grouped into cases.

* There is no validation or auto complete for these parameters and the values can be null or empty. In these scenarios, Cortex Cloud does not display the null or empty values, but adds the text NULL or EMPTY in the descriptions.

* When more than one XDM field is listed, Cortex Cloud looks for the field value according to the order of the fields listed.

* When Use the Cortex Cloud default incident enrichment is not selected and you have not mapped any issue fields, the issue is dispatched into a new incident.

####### Important

* The maximum size of a lookup dataset is 50 MB. If the data exceeds this limit, the add to lookup action fails.

####### Tip

* When creating your correlation rule, you can use predefined values for different fields in the editor, such as Alert Name, Alert Description, and Drill-Down Query. For more information, see Field replacement syntax in correlation rules.

####### Navigation

  You can create a new correlation rule from either the Threat Management → Detection Rules → Correlation Rules page or when building a query in XQL Search

###### 4.1.1.3.3. Field replacement syntax in correlation rules

###### 4.1.1.3.4. Manage correlation rules

###### 4.1.1.3.5. Monitor correlation rules

####### Note

* In the dataset, the Query start time and Query end time indicate the time frame of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

###### 4.1.1.3.6. Troubleshoot server errors in scheduled correlation rules

##### 4.1.1.4. Manage IOC and BIOC rules

###### Note

* For Analytics BIOC rules, you can only disable and enable rules.

* You cannot delete global BIOCs delivered with content updates.

* For BIOC rules that are applied to prevention profiles: If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention on the agent works as usual. If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention...

* When a BIOC rule is disabled automatically by Cortex Cloud, for example due to the server anti flooding mechanism, prevention on the agent works as before.

###### Navigation

  Threat Management → Detection Rules → BIOC

##### 4.1.1.5. Attack surface rules

###### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

### 4.2. Analytics

#### 4.2.1. Analytics overview

##### 4.2.1.1. Analytics engine

##### 4.2.1.2. Analytics sensors

##### 4.2.1.3. Coverage of MITRE Attack tactics

##### 4.2.1.4. Review MITRE ATT&CK framework coverage

###### Note

* When a contributing data source type is active, it does not imply that all the rules and detectors associated with the data source type are active. Rule applicability is dependent on the data source's context and configuration. To enable an active status, data source types require the following setup: Endpoint: Installed Cortex XDR agent. Network: A...

##### 4.2.1.5. Analytics detection time intervals

###### Note

* When establishing a baseline, detectors compute limits beyond which network activity will require an issue. In some cases, detectors do not compute baseline limits; instead they are predetermined by Cortex Cloud engineers. The engineers determine the values used for predetermined limits using statistical analysis of malicious activity recorded...

##### 4.2.1.6. Analytics issues and Analytics BIOCs

##### 4.2.1.7. View and manage Analytics rules

###### Note

* The default severity is updated by content updates. If a content update determines a new default severity for the rule that's the same as the value you had previously determined, you won't have the option to reset to default. For example, if the default was Informational, and you changed the severity to Medium, and after a content update Cortex Cloud...

* When you select multiple rows, you can only enable or disable the selected rules.

###### Warning

* Changing the default severity may result in issues not being triggered or too many issues being triggered. Please consider this carefully before you change the severity recommended by Cortex Cloud. Any responsibility for not getting issues triggered as a result of changing the severity will be yours.

##### 4.2.1.8. Identity Analytics

###### Navigation

  After configuring your Cloud Identity Engine instance and Cortex Cloud Analytics, select Settings () → Configurations → Cortex Cloud - Analytics, and in the Featured in Analytics section, Enable Identity Analytics

##### 4.2.1.9. Identity Threat Module (ITDR)

##### 4.2.1.10. AI Detection & Response in Cortex Cloud (Beta)

###### Prerequisite

* To enable AIDR, you must have one of the following user roles: Instance Admin or Account Admin.

###### Navigation

  Settings → Configurations → Cortex - Analytics

###### 4.2.1.10.1. Data sources and supported services

###### 4.2.1.10.2. AI Detection & Response Dashboard

###### 4.2.1.10.3. Collect prompt logs

## 5. Web and API Security (WAAS)

### 5.1. Overview

#### License Type

  Requires the Cortex Cloud Runtime Security add-on.

### 5.2. Personas workflow

### 5.3. Secure your API landscape

#### 5.3.1. Gain visibility and assess risk of API endpoints

##### Note

* Data classification findings are only available for enabled profiles.

* Indicates that a JSON Web Token was identified, but it is unknown how to determine its type from the given string. It could be a non-standard JSON Web Token creation algorithm.

* To link APIs to business applications, the two prerequisites must be met: The VM must have XDR agent with WAAS enabled. Applications must be defined in Application Security Posture Management (ASPM).Application Security Posture Management (ASPM)

#### 5.3.2. Monitor and investigate API threats

#### 5.3.3. Configure API security from end to end

##### 5.3.3.1. Third-party integrations

###### 5.3.3.1.1. Ingest AWS API Gateway

####### Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

####### Important

* Leave '–'filter-pattern empty as displayed above.

###### 5.3.3.1.2. Ingest Azure APIM

####### License Type

  Requires the Data Collection add-on.

####### Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

####### Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

###### 5.3.3.1.3. Ingest Apigee Proxy

####### License Type

  Requires the Data Collection add-on.

####### Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

####### Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

###### 5.3.3.1.4. Ingest Kong

####### License Type

  Requires the Data Collection add-on.

####### Note

* Contact support to obtain the custom plugin file.

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

####### Important

* The size of the buffer must be equal or larger than the max body size setting in the plugin configuration, on every data plane node.

###### 5.3.3.1.5. Ingest-F5

####### License Type

  Requires the Data Collection add-on.

####### Note

* Extract the files from the F5 plugin to a folder before selecting to upload to F5.

* Select panw_apisec_set_ssl_data only if your client SSL profile is enabled.

* The provider for "context_provider" should always be uppercase. Supported providers: AWS, GCP, Azure, On-prem.

##### 5.3.3.2. Agent-based protection

###### Note

* Web and API Security (WAAS) profiles and policies are currently a Beta feature.

###### 5.3.3.2.1. Set up Web and API Security profiles

####### Note

* Web and API Security profiles and policies are currently a Beta feature.

* In this profile, the Report options configure the workload to report the corresponding malicious applications or APIs to Cortex Cloud, without blocking them. The Disabled options configure the workloads to neither analyze nor report the corresponding malware or behavior.

####### Navigation

  Inventory → Endpoints → Policy Management → Prevention → Profiles

###### 5.3.3.2.2. Apply Web and API Security profiles to workloads

####### Note

* Web and API Security profiles and policies are currently a Beta feature.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

###### 5.3.3.2.3. Manage Web and API Security prevention profiles

####### Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

###### 5.3.3.2.4. Add a disable prevention rule for cloud workloads

####### Important

* All applicable prevention actions are skipped for the files and process that match the properties defined in the rule. Consider the consequences of disabling a prevention rule before you add the exception, and monitor it over time.

####### Navigation

  Settings → Exceptions Configuration → Disable Prevention Rules

###### 5.3.3.2.5. Add a support exception rule for cloud workloads

####### Navigation

  From Settings → Exceptions Configuration → Support Exception Rules, click + Import from file

###### 5.3.3.2.6. Add a legacy exception rule for cloud workloads

####### Navigation

  Your rule is created, and can be viewed at the following location: Settings → Exceptions Configuration → Legacy Agent Exceptions

###### 5.3.3.2.7. Additional workload management tasks

####### Navigation

  Several management activities that can be performed on workloads are accessible from Inventory → Endpoints → All Endpoints and from Inventory → Endpoints → Groups

#### 5.3.4. API specification inventory

##### Note

* Even if you have already imported the specification, you can edit the API specification in Cortex Cloud and add or update the server list.

##### 5.3.4.1. Import API specification

###### Note

* Even if you already imported the file, you can edit the API asset and add or update the server list.

## 6. Review inventory and explore your cloud environment

### 6.1. Asset management

#### 6.1.1. All Assets

##### Note

* When working with the Asset Inventory page, consider the following: To maintain an accurate and clutter-free asset inventory, an automated cleanup process periodically removes outdated assets in the background.

* The options available are dependent on your license.

##### 6.1.1.1. Container Images

###### Navigation

  All Assets → Compute → Container Images

##### 6.1.1.2. Kubernetes Cluster

###### Note

* The Vulnerabilities tab is only available if the cluster you wish to analyze has a K8s connector.

###### Navigation

  Inventory → All Assets → Compute → Kubernetes Cluster for a Kubernetes Clusters assets overview

##### 6.1.1.3. Virtual Machine Image Scanning

###### 6.1.1.3.1. VM Images Page

####### Note

* The data in the Scanners column is accurate only for Core Image assets. Ignore the Scanners value for assets categorized as Registry, Build, or Runtime images, as it may not reflect an accurate scan status.

* The Last Scan value is only accurate for Core Image assets; ignore the Last Scan values for Registry, Build, and Runtime images, as they may be incorrect.

####### Navigation

  Inventory → All Assets → Compute → VM images for Agentless VM Image scanning overview

###### 6.1.1.3.2. VM Image Details Page

####### Navigation

  Inventory → All Assets → Compute → VM images

##### 6.1.1.4. Cortex Cloud discovery catalog

#### 6.1.2. Network configuration

##### 6.1.2.1. Configure your network parameters

###### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

###### Navigation

  In Cortex Cloud , select Assets → Network Configuration → Internal Domain Suffixes

#### 6.1.3. Asset Groups

##### Note

* When you create or edit an Asset Group, the changes are applied immediately to new assets and to existing assets that have been updated. However, it may take a few hours for the changes to appear on existing assets that have not been updated.

##### Navigation

  Inventory → Assets → Groups → Add Group

#### 6.1.4. Asset Roles

##### Note

* Asset Roles are available only if the Identity Threat Module add-on is enabled.

##### 6.1.4.1. Manage Asset Roles for Endpoints

###### Note

* Endpoint Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added endpoint removes the endpoint from the Included Endpoints list. If this endpoint is detected automatically as having this asset role in the future, it will appear in the Included Endpoints list. Excluding a manually added endpoint ensures that even if in the future the endpoint is detected as having this asset role, this...

##### 6.1.4.2. Manage Asset Roles for Users

###### Note

* User Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added user removes the user from the Included Users list. If this user is detected automatically as having this asset role in the future, it will appear in the Included Users list again. Excluding a manually added user ensures that even if in the future the user is detected as having this asset role, this detection is overridden and...

###### 6.1.4.2.1. Honey user

####### Prerequisite

* The honey user role is available only if the Identity Threat Module add-on is enabled.

#### 6.1.5. Manage Asset Scores

##### Note

* The Hosts tab is available if the Identity Threat Module add-on is enabled.

* As new alerts are associated with incidents, the User and Host Scores are recalculated. You can view the latest User and Host Scores on the Asset Scores page, or track the Score trend on the User Risk View and Host Risk View.

* Some User Associated Insights may not appear as part of the User Associated Incidents due to the insight generation mechanism. For example, when an insight related to one of the assets in an incident is generated a few days after the associated incident, the insight may not be associated with the incident.

#### 6.1.6. Vulnerability Assessment

##### Prerequisite

* The following are prerequisites for Cortex Cloud to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex Cloud lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex Cloud...

* The following are prerequisites for Cortex Cloud to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex Cloud collects all the information about the operating system and the installed...

##### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex Cloud Application Inventory.

##### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

##### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

## 7. Review and prioritize posture issues

### 7.1. Cases and issues

#### 7.1.1. Overview of cases

##### 7.1.1.1. What are cases?

##### 7.1.1.2. Resolving cases with AI

##### 7.1.1.3. Case lifecycle

##### 7.1.1.4. Case thresholds

##### 7.1.1.5. Case scope and impact

##### 7.1.1.6. Case and issue domains

#### 7.1.2. Case concepts

##### 7.1.2.1. Issues, findings, and events

###### 7.1.2.1.1. Issues

###### 7.1.2.1.2. Findings and events

##### 7.1.2.2. Case grouping

##### 7.1.2.3. Case scoring

##### 7.1.2.4. Case starring

###### Navigation

  You can manage all starring configurations under Case & Issues → Case Configuration → Starred Issues

##### 7.1.2.5. What is Causality?

###### Note

* There are no CGOs in the Cloud Causality View, when investigating cloud Cortex Cloud alerts and Cloud Audit Logs, or SaaS Causality View, when investigating SaaS-related alerts for 501 audit events, such as Office 365 audit logs and normalized logs.

#### 7.1.3. Analyze and resolve cases

##### 7.1.3.1. Review all cases

###### Note

* The legacy view is also available for users who prefer this format. From the Actions menu select Switch to legacy view.

##### 7.1.3.2. Start case analysis

###### 7.1.3.2.1. Agentic Assistant- Case Investigation agent

##### 7.1.3.3. Establish case context

###### 7.1.3.3.1. AI-generated case summaries

####### Note

* The AI-generated title and description is a calculated value that is regenerated each time you open a case. This value is not a saved static description, therefore it is not reflected in the saved case names in the list of cases in the Split view , or in the Case Name and Case Description columns in the Table view.

####### Navigation

  Configurations → General → Server Settings → AI Configuration and enable the following settings

###### 7.1.3.3.2. Assess case severity and score

###### 7.1.3.3.3. Update case attributes

####### Note

* The defined values are shown in the Case Name and Case Description columns in the Table view, and saved to the cases dataset. The case title is also shown the list of cases in the Split view. These values do not replace the AI-generated case title and summary. If the Summarize with AI toggle is enabled, AI-generated case summaries are automatically...

##### 7.1.3.4. Analyze case details

###### Note

* If you prefer a tabular or legacy layout, switch the case card to the Detailed view. This view preserves the legacy tab based format and custom layouts, ensuring full backward compatibility. You can switch between the new case experience and the legacy view based on personal workflow preferences. For more information, see Detailed View.

###### 7.1.3.4.1. Grouping graph

####### Note

* Similar issues are displayed as individual entities rather than in a parent/child hierarchy.

###### 7.1.3.4.2. Evidence

###### 7.1.3.4.3. Issue feed

###### 7.1.3.4.4. Associated assets and artifacts

####### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

###### 7.1.3.4.5. MITRE ATT&CK tactics and techniques

####### Note

* This component is available for cases associated with the Security domain or custom domains.

###### 7.1.3.4.6. Detailed View

####### Note

* When an issue is resolved, it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

###### 7.1.3.4.7. Issue card

####### Note

* This section is context-specific and shows data according to the issue context.

##### 7.1.3.5. Resolve the case

###### 7.1.3.5.1. Resolution Center

####### Note

* Tasks that are already In Progress but still require your input will appear in both the Pending and In Progress tabs.

###### 7.1.3.5.2. Collaborative notes and comments

###### 7.1.3.5.3. Resolve a case

####### Note

* If a case is resolved with the status Resolved - Auto Resolved, Cortex Cloud can reopen the case for up-to six hours if a new issue is triggered that matches the case. The six-hour period is defined by the timestamp of the last issue that was grouped into the case. After the six-hour period, any new issues are linked to a new case for a new...

###### 7.1.3.5.4. Resolution reasons for cases and issues

####### Note

* Cases and issues resolved as True Positive and False Positive help Cortex Cloud to identify real threats in your environment by comparing future cases and associated issues to the resolved cases. Therefore, the handling and scoring of future cases is affected by these resolutions.

##### 7.1.3.6. Additional case actions

###### 7.1.3.6.1. Create a case

####### Note

* To create a case manually, you must have View/Edit permission for Cases and Issues selected under Settings → Configurations → Access Management → Roles → Components → Cases & Issues.

* This option is only relevant for certain domains.

* You can't attach files to manually created cases.

####### Tip

* The issues that you link to a case can be linked to multiple cases, and the issue domains do not need to match the case domain.

###### 7.1.3.6.2. Merge a case

### 7.2. Investigation and response

#### 7.2.1. Investigate issues

##### 7.2.1.1. Overview of the Issues page

###### Note

* Every 12 hours, the system enforces a cleanup policy to remove the oldest issues once the maximum limit is exceeded. The default issue retention period in Cortex Cloud is 186 days.

##### 7.2.1.2. Link or unlink issues from a case

##### 7.2.1.3. Run an automation on an issue

###### Note

* In addition to automation, some playbooks contain manual tasks that prompt the analyst for input. This enables you to enhance an automation workflow with analyst input.

* You can also manually select a playbook to run from the Issue Work Plan tab.

##### 7.2.1.4. Use the War Room in an investigation

###### Note

* The case War Room is usually used for communication capabilities, but unlike the issue War Room, it does not include playbook specific entries. The case War Room enables you to investigate an entire case, not just an issue.

* Cortex Cloud does not index notes and chats.

###### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

* You can use the up/down arrow buttons in the CLI to do a reverse history search for previous commands with the same prefix.

###### Navigation

  Investigation & Response → Automation → Playground

##### 7.2.1.5. Use the Work Plan in an investigation

###### Important

* A playbook will not continue its execution path if a prior task has failed; you must resolve the failed task before subsequent tasks can run.

##### 7.2.1.6. Issue syncing

###### Prerequisite

* You must set up an integration before you can sync issues. For more information, see Set up an integration for mirroring issues.

###### Note

* Multiple tickets can be linked to an issue with outbound syncing. Issues with inbound syncing can be linked to a single ticket only.

* Using issue fields as variables is not currently supported.

* You can only define a single inbound profile. If you change the inbound sync profile the current profile is overwritten. You can define multiple outbound profiles; one issue can update multiple tickets.

* The inbound syncing flow runs every two minutes, and the outbound syncing flow runs every five minutes. In a bi-directional set-up, if the same field is updated in both tickets, the most recently updated value is used. In the external ticket, the logged history shows updates to the ticket. The user name that is logged with the history reflects the user...

* After an issue is resolved, ticket syncing remains active for up-to seven days. Therefore, you still update, change, or reopen the issue or external ticket and the tickets will continue to sync.

* If you change the selected inbound sync profile, the original sync profile is immediately overwritten.

###### Warning

* If you leave this field blank, all configured instances will be used.

###### Tip

* You can find a sync profile ID under Settings → Configurations → Object Setup → Issues → Sync Profiles. By default the ID field is not displayed in the table. Click the three dot menu and add it to the table layout.

###### Navigation

  Settings → Configurations → Marketplace

##### 7.2.1.7. Causality view

###### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

###### 7.2.1.7.1. Cloud causality view

###### 7.2.1.7.2. SaaS causality view

###### 7.2.1.7.3. Timeline

####### Note

* The Timeline view is not available when investigating cloud Cortex Cloud issues and cloud audit logs or SaaS-related issues for 501 audit events, such as Office 365 audit logs and normalized logs. Only the applicable cloud causality view and SaaS causality view is available for this data.

###### 7.2.1.7.4. Network causality view

####### Note

* The network causality view displays only the information it collects from the detectors. It is possible that the CI may not show some of the firewall or agent processes.

####### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

###### 7.2.1.7.5. Causality icons key

##### 7.2.1.8. Issue investigation actions

###### 7.2.1.8.1. Copy issues

###### 7.2.1.8.2. Update issue fields

####### Note

* You must create a custom status before you can select it.

####### Tip

* You can create custom issue statuses and resolution reasons, and use the setIssueStatus command to set these custom statuses for issues. For example, when a user starts investigating an issue, the issue status is automatically changed from New to Under Investigation. In some cases, it is useful to create an interim status, such as Triage. After you...

###### 7.2.1.8.3. Create profile exceptions

####### Navigation

  Inventory+Endpoints → Policy Management → Profiles

###### 7.2.1.8.4. Investigate contributing events

###### 7.2.1.8.5. Create a featured field

####### Note

* Featured Active Directory values are displayed in the User and Host fields accordingly.

####### Navigation

  Cases & Issues → Case Configuration → Featured Fields and select a type of featured field

###### 7.2.1.8.6. View generating BIOC or IOC rule

###### 7.2.1.8.7. Add a file path to a malware profile allow list

####### Navigation

  Inventory+Endpoints → Policy Management → Prevention → Profiles and locate the malware profile you selected

###### 7.2.1.8.8. Retrieve additional issue details

####### Tip

* If you require assistance from Palo Alto Networks support to investigate the issue, make sure to provide the downloaded ZIP file.

###### 7.2.1.8.9. Export issue details to a file

###### 7.2.1.8.10. Exclude an issue

###### 7.2.1.8.11. Query case and issue data

####### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

#### 7.2.2. Review findings

##### 7.2.2.1. Findings card

###### Note

* The information in this card is context specific, therefore some sections are not available for all findings.

#### 7.2.3. Investigate artifacts and assets

##### 7.2.3.1. Investigate an IP address

###### Note

* Requires a license key. Select Settings → Configurations → Integrations  → Threat Intelligence.

##### 7.2.3.2. Investigate an asset

###### Note

* The Asset view is available for hosts with a Cortex XDR agent installed.

##### 7.2.3.3. Investigate a file and process hash

###### Note

* Requires a license key. Go to Settings → Configurations → Integrations  → Threat Intelligence.

##### 7.2.3.4. Investigate a user

###### License Type

  If the Identity Threat module is enabled, you can open the User Risk View. This view displays insights and profiling information to help you investigate issues and cases. Viewing anomalies in the context of baseline behavior facilitates risk assessment and shortens the time you require for making verdicts. If the Identity Threat module is not enabled...

  The User Risk view is available with the ITDR add-on. Depending on your permissions, some information may be limited by your scope.

###### Note

* Cortex Cloud normalizes and displays case and issue times in your time zone. If you're in a half-hour time zone, the activity in the Issues & Insights Heatmap is displayed in the whole-hour time slot preceding it. For example, if you're in a UTC +4.5 time zone, the time displayed for the activity will be UTC +4.5, however, the visualization in the...

###### Tip

* You can also see a list of all users under Inventory → Assets → Asset Scores.

#### 7.2.4. Investigate endpoints

##### 7.2.4.1. Overview of the Action Center

###### Note

* Blocking files on endpoints is enforced by the endpoint malware profile. To block a hash value, ensure the hash value is configured in the Malware security profile. Select Override Report mode to allow the agent to block hashes, even if the Malware Profile is set to Report.

###### Navigation

  Investigation & Response → Response → Action Center

###### 7.2.4.1.1. Initiate and monitor endpoint actions

####### Navigation

  Investigation & Response → Response → Action Center → New Action

  Investigation & Response → Response → Action Center

###### 7.2.4.1.2. Action Center reference information

##### 7.2.4.2. Manage endpoints

###### Note

* For the Include endpoints from auto upgrade action, you cannot enable auto upgrade for Mobile, VDI, and TS installations.

* If an endpoint is excluded, the auto upgrade profile configuration is not available. If you exclude the endpoint from auto upgrade while the auto upgrade action is In progress, the ongoing upgrade will still take place.

* Content Status is calculated every 30 minutes. Therefore, there might be a delay of up to 30 minutes in displaying the data.

* Only supported for Windows and macOS.

* Changes to the agent status can take up to ten minutes to display on Cortex Cloud .

###### Navigation

  Inventory → Endpoints → All Endpoints

  Settings → Configurations → General → Agent Configurations → Endpoint Administration Cleanup

##### 7.2.4.3. Retrieve files from an endpoint

###### Note

* You cannot define a path using environment variables on Mac and Linux endpoints.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Disabling File Retrieval does not take effect on file retrieval actions that are in progress.

##### 7.2.4.4. Retrieve support logs from an endpoint

###### Navigation

  Investigation & Response → Response → Action Center → + New Action

##### 7.2.4.5. Scan an endpoint for malware

###### Navigation

  Investigation & Response → Response → Action Center → New Action

#### 7.2.5. Investigate files

##### 7.2.5.1. Manage file execution

###### Navigation

  Investigation & Response → Response → Action Center → New Action

##### 7.2.5.2. Manage quarantined files

###### Note

* This will restore all files with the same hash on all of your endpoints.

##### 7.2.5.3. Review WildFire analysis details

###### Note

* Cortex Cloud displays the preview of WildFire reports that were generated within the last couple of years. To view a report that was generated more than two years ago, you can download the report.

##### 7.2.5.4. Import file hash exceptions

###### Navigation

  Investigation & Response → Response → Action Center → New Action

#### 7.2.6. Cortex Assistant

##### Note

* If you are in an eligible region and have enabled the Cortex Agentic Assistant, the Cortex Agentic Assistant replaces the Cortex Assistant. The Cortex Assistant is available if you do not have access to the Cortex Agentic Assistant based on the tenant region or you have not enabled it. For more information, see Cortex Agentic Assistant.

##### Navigation

  To increase usability, you can create a personalized keyboard shortcut: Settings → Configurations → Server Settings → Keyboard Shortcuts and choose the shortcut you want to use

##### 7.2.6.1. Cortex Assistant layout

##### 7.2.6.2. Cortex Assistant capabilities

###### Note

* When you choose an option from the Respond column, Cortex Assistant will always prompt you to approve the action before executing.

#### 7.2.7. Automation

##### 7.2.7.1. Automation in Cortex Cloud

###### Note

* You can build end-to-end automation workflows from within the playbook editor, including creating automation rules, configuring integration instances, and creating and editing tasks. For more information, see Playbooks.

##### 7.2.7.2. Quick Actions

###### Note

* Quick Actions appear as War Room entries, but do not appear in the Work Plan.

##### 7.2.7.3. Automation Exclusion Center

###### Note

* By default, all users have read and edit permissions to lists. When creating a list of critical assets, we recommend limiting the read and edit permissions to specific roles.

###### 7.2.7.3.1. Manage automation exclusion policies

####### Note

* For the IAM User Hard Remediation and User Soft Remediation policies, we recommend including username, email, and ID for each user you want to exclude. Example: username1, user@example.com, userID112.

* You can also right click on a policy from the main Automation Exclusion Center page to disable or enable the policy. If you click on a list name in the Exclude column, that list opens in the Lists page.

##### 7.2.7.4. Playbooks

###### Prerequisite

* To provide playbook access, ensure the Playbooks RBAC permission is set to View or View/Edit. To completely restrict playbook access, first set the Cases & Issues RBAC permission to None and then set the Playbooks permission to None. Conversely, to provide access to cases and issues, first set the Playbooks permission to View or View/Edit (and then set...

###### 7.2.7.4.1. Playbooks overview

###### 7.2.7.4.2. Playbook development checklist

###### 7.2.7.4.3. Plan your playbook

###### 7.2.7.4.4. Manage playbooks

####### Note

* The library by default shows only playbooks that are not adopted. Click the Show Adopted checkbox to show the adopted playbooks, indicated by an Adopted mark. The library shows the most updated playbook version. Adopting an older version than shown should be done through Marketplace. Adopting a playbook does not make it run. Some content packs include...

###### 7.2.7.4.5. Build your playbook

####### 7.2.7.4.5.1. Task 1. Choose from existing playbooks or create your own

######## Note

* When a task inside of a sub-playbook is not configured, the alert is propagated to the main playbook. If multiple sub-playbooks are nested, and any of the sub-playbooks have non-configured components, the alert appears in the main playbook as well as in the sub-playbooks. Alerts also appear for the individual non-configured tasks within the...

######## Tip

* If there are additional relevant playbooks in Marketplace that are not in your Org repository, you can click Explore them now to see them in the Playbook Catalog and choose to adopt.

* To open multiple playbooks at the same time, edit the first playbook and then click New next to the playbook name to create a new tab. You can either create a new playbook, or add an existing one. You can view recently modified or deleted playbooks by clicking version history for all playbooks .

######## Navigation

  the Investigation & Response → Automation → Playbooks page to find an existing playbook, customize it, or create a playbook

####### 7.2.7.4.5.2. Task 2. Configure playbook settings

######## Note

* If the playbook has inputs and outputs, the Playbook Starts task will show back and forth arrows. Clicking them opens the Playbook Settings pane Inputs/Outputs tab.

* This rule will trigger the playbook to run if no other Automation Rule triggers the playbook first. You can view and edit the order the rules run in the Automation Rules page.

* If you do not add any fields, the group will be deleted when you click Save.

####### 7.2.7.4.5.3. Task 3. Add objects from the Task Library

####### 7.2.7.4.5.4. Task 4. Add custom playbook features

####### 7.2.7.4.5.5. Task 5. Test and debug the playbook

####### 7.2.7.4.5.6. Task 6. Manage playbook content

###### 7.2.7.4.6. Customize your playbook

####### 7.2.7.4.6.1. Configure a sub-playbook loop

######## Note

* Consider the following when adding a loop: The maximum number of loops (default is 100). A high number of loops or a high wait time combined with a large number of issues may affect performance. Periodically check looping conditions to ensure they are still valid for the data set. If you want a sub playbook task to loop over an array passed into its...

######## Tip

* Balance between the number of iterations and the interval so you do not overload the server.

####### 7.2.7.4.6.2. Filter and transform data

######## Caution

* You can change the context data root to filter, but it is not recommended to select a different root, as it affects the filter results. The drop-down list displays the filter root for backward compatibility.

######## Navigation

  Investigation & Response → Automation → Scripts → New Script

####### 7.2.7.4.6.3. Extend context

####### 7.2.7.4.6.4. Extract indicators

######## Note

* This configuration may delay playbook execution (issue creation). While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

####### 7.2.7.4.6.5. Update issue fields with playbook tasks

######## Note

* The setIssue script includes all available fields; use the scroll bar to see all the fields. The name field has a limit of 600 characters. If there are more than 600 characters, you can shorten the name field to under 600 characters and then include the full information in a long text field such as the description field.

###### 7.2.7.4.7. Test your playbook

####### Note

* The debugger does not support using parentIncidentFields.

* Using an existing issue in the debugger does not affect the original issue or change the original context data.

####### 7.2.7.4.7.1. Troubleshoot playbook performance

###### 7.2.7.4.8. Manage playbook content

####### Note

* Opening a playbook does not immediately lock it. A playbook is considered to be in edit mode only when a user makes a modification that causes the Save button to become available.

####### Important

* Manually unlocking a playbook may cause version conflicts. This turns off concurrent editing protection, and if the original user is still editing, their changes might be lost or overwritten.

####### Navigation

  Investigation & Response → Automations → Playbooks

###### 7.2.7.4.9. Best practices

####### Note

* If you reattach a detached playbook, any customizations you have made to the playbook will be overwritten when the playbook updates to the current version.

* Retries are not supported for data collection tasks that have errors sending emails (indicated by a server timeout). This is because retries only work on automation execution failures, not on email delivery issues.

##### 7.2.7.5. AI Prompts

###### Navigation

  On the AI Prompts page (Investigation → Response → Automation → AI Prompts), you can view, edit, and manually create prompts

###### 7.2.7.5.1. AI prompts role-based access control

###### 7.2.7.5.2. Use existing prompts

####### Navigation

  Investigation & Response → Automation → AI Prompts and in the Prompts Library search for the prompt you want to use

###### 7.2.7.5.3. Create a prompt

####### Navigation

  Investigation & Response → Automation → AI Prompts and click + New Prompt

##### 7.2.7.6. Create an automation rule

###### Note

* You can also define the conditions that trigger a specific playbook in the playbook editor. For more information, see Task 2. Configure playbook settings

* Quick Actions, by default, run using all available integration instances that contain the command. When selecting a Quick Action for an automation rule, you can instead choose one specific integration instance to use.

###### Important

* Automation rules apply to Medium and higher severity issues. They also apply to Low severity Analytic issues and Low severity ABIOC issues that are tagged with Identity or Cloud. Rules are evaluated in order, and only the first rule that matches the trigger conditions is executed.

##### 7.2.7.7. Scripts

###### 7.2.7.7.1. Use existing scripts

####### Navigation

  Investigation & Response → Automation → Scripts and in the Scripts Library search for the script you want to use

###### 7.2.7.7.2. Create a script

####### Note

* You can enable/disable a script in the Settings without having to duplicate the script. You can view recently modified or deleted scripts by clicking the version history for all scripts .

####### Important

* If you choose Python, from the Agentic Assistant you can use the Automation Engineer agent.

####### Tip

* If there is an error, you can copy the error message from the test result into the Agentic Assistant prompt and ask the Automation Engineer agent to correct the error.

###### 7.2.7.7.3. Use the Automation Engineer agent to accelerate script development and deployment

####### Note

* The Automation Engineer agent is available with the Cortex Agentic Assistant, for users with script editing permissions. For more information, see Cortex Agentic Assistant and Agentic Assistant role-based access control.

* If you make manual edits in the script and don't save the changes and you then modify the script with the Automation Engineer agent, you are prompted to confirm overwriting the manual edits.

####### Tip

* Use detailed prompts, for example, Get failed logins from last 24 hours and return as a table. Clearly define argument names, types, and default values. Mention if you expect the output in a specific format, such as a table, JSON, or plain text.

* If there is an error, you can copy the error message from the test result into the Agentic Assistant prompt and ask the Automation Engineer agent to correct the error.

###### 7.2.7.7.4. Change the Docker image in a script

####### 7.2.7.7.4.1. Connect an engine to an image registry

######## Note

* This procedure uses the --username and --password command line options to pass the username and password directly. For environments where command history or logs are visible to others, consider more secure methods like Docker configuration files for handling authentication in production or CI/CD environments. For more details, see docker login or...

##### 7.2.7.8. Context data

###### 7.2.7.8.1. Issue context data

###### 7.2.7.8.2. Case context data

###### 7.2.7.8.3. Search context data

###### 7.2.7.8.4. Add context data to an issue

###### 7.2.7.8.5. Add context data to a case

####### Note

* If you run the command in the issue War Room, the data is added to the following places: The case context data. The issue context data under the case tab. If you run the command in the Case War Room, the data is added to the case context data only.

###### 7.2.7.8.6. Delete context data from a case

###### 7.2.7.8.7. Use context data in a playbook

####### Caution

* Users with Trigger Playbook permissions on a given issue may still be able to modify the parent case via commands and scripts, even without full access to the case.

##### 7.2.7.9. Lists

###### Note

* The maximum size of a list is 209715 characters.

###### 7.2.7.9.1. Create a list

####### Note

* If you intend to use the list as part of an Automation Exclusion Policy, we recommend choosing specific roles for read and edit access. For more information on using lists in exclusion policies, see Manage automation exclusion policies.Manage automation exclusion policies

* If you want to edit a list from a content pack, you need to duplicate or detach a list. Detached lists do not receive updated content in subsequent Cortex Cloud content releases. To retain an updated list, reattach it.

###### 7.2.7.9.2. List commands

###### 7.2.7.9.3. Use cases: JSON lists

####### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

  Investigation & Response → Automation → Playbooks → New Playbook

###### 7.2.7.9.4. Transform a list into an array

####### Navigation

  Investigation & Response → Automation → Playbooks and create or edit a playbook

##### 7.2.7.10. Integrations

###### 7.2.7.10.1. Integrations in Cortex Cloud

###### 7.2.7.10.2. Add an integration instance

###### 7.2.7.10.3. Use integration commands in the CLI

####### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

###### 7.2.7.10.4. Troubleshoot Integrations

###### 7.2.7.10.5. Manage credentials

####### Navigation

  Settings → Configurations → Integrations → Credentials → New Credential

##### 7.2.7.11. Engines

###### 7.2.7.11.1. What is an engine?

####### Note

* You cannot share a multiple-engine installation with a single-engine installation.

* When you add an engine to a load-balancing group, you cannot use that engine separately. The engine does not appear in the engines menu when configuring an integration instance, but you can choose the load-balancing group.

###### 7.2.7.11.2. Engine requirements

####### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

* If you have configured a range of Approved IP Ranges under Allowed Sessions on the Security Settings page, the engine must communicate through one of the approved IPs.

###### 7.2.7.11.3. Install an engine

####### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex Cloud engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

####### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

####### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

####### 7.2.7.11.3.1. Docker

######## Note

* This section is relevant when installing an engine.

* Docker images can be downloaded together with their relevant content packs for offline installation.

####### 7.2.7.11.3.2. Podman

######## Note

* When upgrading an engine, the engine keeps the previously used container management type (regardless of distribution version).

###### 7.2.7.11.4. Manage engines

###### 7.2.7.11.5. Upgrade an engine

###### 7.2.7.11.6. Remove an engine

###### 7.2.7.11.7. Configure engines

####### Note

* A day is defined as 24 hours and may not exactly correspond to calendar days due to daylight savings, leap seconds, etc.

* In addition, to support engine upgrades from the UI, edit the /usr/local/demisto/upgrade.conf file on the engine to include the SERVER_URLS setting with the new tenant's address. Include only the host, without https:// or any additional path at the end of the host name. For example: SERVER_URLS="api-example.us.paloaltonetworks.com"

* If the engine loses communication for longer than this time, it will disconnect and you need to restart the service.

####### 7.2.7.11.7.1. Configure the engine to use a web proxy

######## Note

* You need to configure Docker to use a proxy. When using a BlueCoat proxy, ensure you encode the values correctly.

* In an environment with a single engine, go to /usr/local/demisto/upgrade.conf. In an environment with multiple engines, go to /usr/local/demisto/<engine-name>/upgrade.conf, replacing <engine-name> with the name of the engine. Note that the key is in the upgrade.conf file and must be https_proxy, even if your proxy address starts with http://.

####### 7.2.7.11.7.2. Configure the engine to call the server without using a proxy

####### 7.2.7.11.7.3. Configure an engine to use custom certificates

###### 7.2.7.11.8. Use an engine in an integration

####### Note

* Long-running integrations should not run on load-balancing groups.

###### 7.2.7.11.9. Run a script using an engine

####### Navigation

  Investigation & Response → Automation → Scripts

###### 7.2.7.11.10. Troubleshoot engines

####### Note

* Ensure that pop-ups are not blocked by your browser.

* If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom path. --keep - Extracts the installer files into the current working directory (without cleaning at the end). If using installer...

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl status d1_<Engine _name>

* Any changes made to variables in the upgrade_engine.sh file are reset after each upgrade. We recommend instead using the upgrade.conf file to set variables.

* You can ignore the following error: Cannot create folder '/var/lib/demisto'

###### 7.2.7.11.11. Troubleshoot integrations running on engines

####### Note

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

* Docker CE installations typically run Docker, while Docker EE installations typically run dockerroot.

#### 7.2.8. Response actions

##### 7.2.8.1. Initiate a Live Terminal session

###### Note

* You can run PowerShell 5.0 or a later release on Live Terminal of Windows.

* Network drives are not supported.

* On Windows endpoints, you cannot run GUI-based cmd commands like winver or appwiz.cpl.

* Disabling Live Terminal does not take effect on sessions that are in progress.

###### Tip

* You can fine-tune the Live Terminal session visibility on the endpoint by adjusting the User Interface options in your Agent Settings Profile.

##### 7.2.8.2. Isolate an endpoint

###### Note

* IP-based file storage protocol traffic will also be blocked. This might affect endpoint functionality if the endpoint uses such mounts.

* If file system operations become unresponsive during isolation, such as being unable to list folder content, unmount the mounted network shares.

###### Tip

* If needed, Filter the list of endpoints.

##### 7.2.8.3. Pause endpoint protection

###### Note

* Pausing your endpoint protection modules leaves your machines exposed to risks.

###### Navigation

  Investigation & Response → Response → Action Center and locate Action Type Pause Endpoint Protection or Resume Endpoint Protection

##### 7.2.8.4. Remediate changes from malicious activity

###### Prerequisite

* To initiate remediation suggestions, you must have the following system requirements: An App Administrator, Privileged Responder, or Privileged Security Admin role permissions which include the remediation permissions. EDR data collection enabled. Agent version 7.2 or above on Windows endpoints.

###### Note

* Endpoints that are part of the Case view and do not meet the required criteria are excluded from the remediation analysis.

##### 7.2.8.5. Search and destroy malicious files

###### Prerequisite

* The following are prerequisites to enable Cortex Cloud to search and destroy files on your endpoints: Supported platforms:    Windows: Cortex XDR agent version 7.2 or a later. If you plan to enable Search and Destroy on VDI sessions, you must perform the initial scan on the Golden Image.   Mac: Cortex XDR agent version 7.3 or a later release running on...

###### Note

* The Cortex Cloud agent does not include the following information in the local files inventory: Information about files that existed on the endpoint and were deleted before the Cortex Cloud agent was installed. Information about files where the file size exceeds the maximum file size for hash calculations that are pre-configured in Cortex Cloud . If...

##### 7.2.8.6. Manage external dynamic lists

###### License Type

  This functionality is not supported for XDR Prevent.

###### Note

* Ensure EDL sizes don't exceed your firewall model limit.

###### Tip

* You can also use the IP list and URL lists as part of a URL Filtering policy, or the domain list as part of a custom Anti-Spyware profile.

##### 7.2.8.7. Collect a memory image

###### License Type

  This functionality has the following license requirements: Forensics add-on license.

#### 7.2.9. Forensics

##### License Type

  Requires the Forensics add-on

##### 7.2.9.1. Forensic investigations

###### 7.2.9.1.1. Manage an investigation

####### 7.2.9.1.1.1. Create a new investigation

######## Note

* To set up user permissions, you must have Scope-Based Access Control (SBAC) enabled.

####### 7.2.9.1.1.2. Edit an investigation

####### 7.2.9.1.1.3. Close an investigation

######## Note

* When you close an investigation, Palo Alto Networks has a grace period of 24 hours before deleting any collections associated with the investigation. During this timeframe, you have the option to cancel the close investigation action.

####### 7.2.9.1.1.4. User permissions

######## Note

* Even if a user does not have access to view an investigation via the Forensics Investigations page, they can still query the results of the collections using an XQL query.

###### 7.2.9.1.2. Data collection

####### 7.2.9.1.2.1. Hunting

####### 7.2.9.1.2.2. Triage

####### 7.2.9.1.2.3. Configure collection

######## Note

* When search fields are specified, the search is limited based on those filters. If more than one entry is in a search filter field, the search returns entries that match any of them. For example: A File Search with two specified paths ("C:\Test\*" and "C:\Windows\*") will return results from both the Test and Windows folders. If you specify multiple...

* Data collected during a Triage Collection is categorized into Artifacts, Volatiles, and File Collection

* Supported only for the UFW tool (Firewall managment tool for some Linux distributions such as Ubuntu)

###### 7.2.9.1.3. Analysis and documentation

####### 7.2.9.1.3.1. Review alerts

####### 7.2.9.1.3.2. Investigation timeline

####### 7.2.9.1.3.3. Key assets & artifacts

###### 7.2.9.1.4. Export

####### Note

* You can export a collection more than once.

#### 7.2.10. Build XQL queries

##### Note

* If you have the Cortex Agentic Assistant, you can use natural language prompts to create and run XQL queries within the chat interface. For more information, see Create and run XQL queries with Agentic Assistant chat.

##### 7.2.10.1. About the Query Builder

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

##### 7.2.10.2. How to build XQL queries

###### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex Cloud. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

###### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

###### 7.2.10.2.1. Get started with XQL queries

###### 7.2.10.2.2. Useful XQL user interface features

####### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

###### 7.2.10.2.3. XQL Query best practices

###### 7.2.10.2.4. Expected results when querying fields

###### 7.2.10.2.5. Create XQL query

####### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined for the entire query, including queries that are part of the join stage. Yet, this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker...

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

###### 7.2.10.2.6. Review XQL query results

####### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* Results are received incrementally for the first 100K records, or up to 100MB worth of records, whichever comes first. After that, the next update is when the query has finished running completely.

* Real time query results are available only in the Query Builder and in free text query. Real time results are displayed only for queries run on hot datasets. The Sort option is available only after all the data is retrieved. When you formulate complex queries, the results will be displayed when the query has finished running completely, and not in real...

* In order for Cortex Cloud to provide a histogram for a field, the field must not contain an array or a JSON object.

###### 7.2.10.2.7. Translate to XQL

####### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

###### 7.2.10.2.8. Graph query results

####### License Type

  Building Cortex Query Language (XQL) queries in the Query Builder requires a Data Collection add-on.

####### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### 7.2.10.3. XQL query entities

###### 7.2.10.3.1. Create authentication query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 7.2.10.3.2. Create event log query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 7.2.10.3.3. Create file query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 7.2.10.3.4. Create image load query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 7.2.10.3.5. Create network connections query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 7.2.10.3.6. Create network query

####### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

###### 7.2.10.3.7. Create process query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 7.2.10.3.8. Create registry query

####### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

###### 7.2.10.3.9. Query across all entities

####### Navigation

  Investigation & Response → Search → Query Builder

##### 7.2.10.4. Overview of the Query Center

###### Note

* Very short queries might not be listed. You cannot cancel correlation queries. The default retention period for historic queries is aligned with issue retention.

###### 7.2.10.4.1. Edit and run queries in Query Center

####### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

####### Navigation

  Investigation & Response → Search → Query Center → Query History

####### 7.2.10.4.1.1. Query Center reference information

######## Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 7.2.10.5. Manage scheduled queries

###### Navigation

  Investigation & Response → Search → Scheduled Queries

###### 7.2.10.5.1. Scheduled Queries reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 7.2.10.6. Manage your query library

###### Note

* The Query to Library option is only available if your role has the Create Queries capability. For more information, see Manage access to saved queries.

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

###### Important

* The ability to create, edit, or share queries is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to saved queries.

#### 7.2.11. Quick Launcher

##### Note

* For hosts, Cortex Cloud displays results for exact matches but supports the use of wildcard (*) which changes the search to return matches that contain the specified text. For example, a search of compy-7* will return any hosts beginning with compy-7 such as compy-7000, compy-7abc, and so forth.

#### 7.2.12. Research a known threat

### 7.3. Customize cases and issues

#### 7.3.1. Customize cases and issues

##### 7.3.1.1. Set up case scoring

###### Note

* For scoped users, a small lock icon indicates that you don't have permissions to edit a rule.

###### Tip

* Right-click an issue field to add it as match criteria.

##### 7.3.1.2. Create a starring configuration

###### Tip

* Right-click an issue field to add it as match criteria.

##### 7.3.1.3. Create custom case statuses and resolution reasons

###### Note

* Before you create a custom status, please review the built-in options. For more information, see Resolution reasons for cases and issues. We recommend using the built-in statuses and resolution reasons where possible. Custom statuses and resolution reasons might not be supported by all content, and status syncing can take time. In addition, custom...

* After creation, custom statuses and resolution reasons cannot be deleted or modified.

###### Navigation

  Configurations → Object Setup → Cases → Properties

##### 7.3.1.4. Create a sync profile

###### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

## 8. Agentic Assistant chat

### 8.1. Get started with Agentic Assistant chat

#### Note

* The Cortex Agentic Assistant is currently available in limited regions. For more information see Cortex Agentic Assistant If your tenant is not within one of those regions, you have access to the Cortex Assistant. To enable the Cortex Agentic Assistant, go to Settings → Configurations → General → Server Settings → AI Configuration.

### 8.2. Choose an Agentic Assistant agent

#### Note

* Requires the Exposure Management add-on.

### 8.3. Chat with an Agentic Assistant agent

#### Note

* Case data is only loaded when you send your first message. Opening the chat interface without sending a prompt does not provide the agent with the case context.

* An agent's proposed plans and results may contain inaccuracies or errors. Always review the results carefully to ensure you fully understand the proposed action before proceeding.

#### Tip

* You can quickly jump to different product pages within Cortex Cloud by typing / in the prompt area. This shortcut is a built-in navigation feature that is available even if the Cortex Agentic Assistant is disabled.

### 8.4. Create and run XQL queries with Agentic Assistant chat

#### Note

* The TextToXQL action is a hidden system action and does not appear in the Agents Hub.

* If you are in a non-supported region and ask an agent to create an XQL query, it may attempt to generate the query using general logic. We do not recommend this, as it may result in inaccurate syntax and unreliable results.

* Running XQL queries manually through agent does not consume compute units. This includes scenarios where you prompt the agent to create and execute a multi-step plan.

### 8.5. Manage chat history

## 9. Review and report your security posture and progress

### 9.1. Monitor dashboards and reports

#### 9.1.1. About dashboards

##### Note

* Dashboards that are based on custom infrastructure cannot be exported. When importing a dashboard that already exists in the system, the imported dashboard overwrites the existing dashboard. To avoid overwriting the existing dashboard, duplicate and rename the existing dashboard before importing the new dashboard.

##### Important

* The ability to create, edit, or share custom dashboards is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to custom dashboards.

##### 9.1.1.1. Command Center dashboards

###### Note

* Access to these dashboards requires RBAC permissions under Dashboards & Reports. The Dashboards component must be Enabled in your role and requires View permissions for Command Center Dashboards. If certain options are unavailable, contact your administrator. For more information, Manage access to custom dashboards. The dashboards are available in dark...

###### 9.1.1.1.1. Cortex Agentic Assistant dashboard

####### Prerequisite

* The Cortex Agentic Assistant is only available after it is enabled, and for tenants in certain regions. For more information, see Cortex Agentic Assistant.

####### Note

* Access to this dashboard requires RBAC permissions under Dashboards & Reports. The Dashboards component must be Enabled in your role and requires View permissions for Command Center Dashboards. If certain options are unavailable, contact your administrator. For more information, see Manage access to custom dashboards.

###### 9.1.1.1.2. Cloud Security Operations

####### 9.1.1.1.2.1. Cloud Security Operations

######## Note

* Command Center data may not match the counts on the Issues page, and you may observe inconsistencies. This is because dashboard data is a snapshot of issues identified, whereas the Issues page provides the most up-to-date view of risks across your cloud assets. In addition, the Issues pages do not support all the currently available filters on the...

###### 9.1.1.1.3. Cortex Cloud Command Center

##### 9.1.1.2. Predefined dashboards

###### Note

* Select the star in the right corner of a widget to filter the data for cases that match case-starring policies. A purple star indicates that the widget is displaying only starred cases. The starring filter is persistent and continues to show the filtered results until you clear the star.

* Users can access all information on the dashboard when their user access is scoped to view All assets or assigned to the Instance Administrator role. Otherwise, users with granular scoping set to No assets or Select asset groups will have limited access to the dashboard. For more information on Scope-Based Access Control (SBAC), see Manage user...

##### 9.1.1.3. Reports

###### 9.1.1.3.1. Report templates

#### 9.1.2. Build custom dashboards and reports

##### 9.1.2.1. Build a custom dashboard

###### Note

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For case-related widgets, you can refine the displayed data to only show results from cases that match a...

##### 9.1.2.2. Manage your Widget Library

###### Note

* Unlike dashboards, individual widgets cannot be shared with other users directly from the Widget Library. Yet, if you add a Restricted widget to a dashboard and then share that dashboard, other users who have access to the dashboard will also be able to see that specific widget.

* Any dashboards or reports that include the widget are affected by the changes.

#### 9.1.3. Fine-tune dashboards and reports

##### 9.1.3.1. Create a custom widget using a script

###### Note

* If you have added arguments to the script, these appear when creating a widget.

* Available options are Pie, Column, Line, and Single Value. To display the result of the script as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### 9.1.3.1.1. Script-based widget examples

####### Note

* Add the widget tag in the script settings to make the script available for use in script-based widgets. For more information, see Create a script.

* If your script returns a time duration, configure the widget with the graph type Single Value and enable Show as Time..

##### 9.1.3.2. Create a text widget

###### Note

* From the Dashboard Manager, you can right-click an existing dashboard and choose Save as report template. You can also add text-based widgets directly to new or existing report templates, as described below.

##### 9.1.3.3. Create custom XQL widgets

###### Note

* Cortex Query Language (XQL) queries generated from the Widget Library do not appear in the Query Center. The results are used only for creating the custom widget.

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### Tip

* You can create a generic dashboard for multiple views of the same dataset by using an asterisk (*) when defining the dataset in the XQL widget as dataset = <dataset_name>*. The placement of the asterisk in the dataset name ensures that any view containing this prefix text is displayed in the results. The dataset in a query is defined as: If there are...

###### 9.1.3.3.1. Configure filters and inputs for custom XQL widgets

####### Prerequisite

* Fixed filters are based on parameters that are defined in custom XQL widgets. Before you can configure fixed filters, take the following steps: Create custom XQL widgets with parameters. For more information, see Create custom XQL widgets. Add the widgets to a custom dashboard. For more information, see Build a custom dashboard.

####### Note

* This option only appears if the dashboard contains custom XQL widgets with defined parameters.

* You can define up to four parameter filters on a single dashboard or report.

* If you specify more than one field, only the first field value is used.

####### Tip

* After the initial setup, when you access your dashboard the filters and inputs might need further refinement. You can make changes to the configured parameters in the XQL widgets, and update the Filters & Inputs on your dashboard until you are satisfied with the results.

###### 9.1.3.3.2. Configure dashboard drilldowns

####### Prerequisite

* To configure drilldowns your dashboard must contain custom XQL widgets. In addition, if you want to configure in-dashboard drilldowns your custom XQL widget must contain one or more parameters. For more information about configuring parameters in custom XQL widgets, see Create custom XQL widgets.

####### Note

* If the selected parameter is configured in other XQL widgets on the dashboard, these widgets are also affected by the drilldown.

####### 9.1.3.3.2.1. Variables in drilldowns

#### 9.1.4. Run or schedule reports

##### Note

* Report templates that are based on custom infrastructure cannot be exported. If you import a report template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template. You can also...

* The report name and description will be displayed in the report header and are not editable during customization.

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

* To send reports to Slack, Slack must be configured as an external application in Cortex Cloud. For more information, see Integrate Slack for outbound notifications

##### Navigation

  Under Settings → Configurations → General → Notifications, click + Add Forwarding Configuration

10. Discovery Engine

  10.1. What is the Discovery Engine?

11. Cortex Cloud AI Security

  11.1. What is Cortex Cloud AI Security?

  11.2. Supported services in Cortex Cloud AI Security

  11.3. Cortex Cloud AI Security concepts

  11.4. Cortex Cloud AI Security use cases

  11.5. How to perform advanced AI Security investigations using XQL

##### Note

* For more information, see Build XQL queries.

12. Cortex Cloud Application Security

  12.1. Onboard Data Sources

  12.1.1. Onboard version control systems

##### Note

* Cortex Cloud Application Security (which includes IaC and Secrets scanning), is an add-on to a license (such as Posture Security) that must be purchased separately.

* Disclaimer: When onboarding with third-party data sources, we outline the required steps for setup, but we do not monitor these external resources, and they may change over time. Always refer to the relevant third-party documentation for the most current integration steps.

##### Tip

* Navigate to Settings → Data Sources & Integrations → + Add New →  and enter your VCS data source in the search bar.

  12.1.1.1. AWS CodeCommit

##### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) AWS User Permissions: To onboard CodeCommit, the user logged into the AWS Console must have permissions to create (deploy) the CloudFormation stack provided by the wizard.    Permission:...

##### Note

* The Resource Name Prefix and ExternalID fields are pre-populated. You can modify the Resource Name Prefix, but DO NOT change the ExternalID!

* To create an additional AWS CodeCommit instance: Hover over the AWS CodeCommit card in the catalog and click Connect Another.

##### Tip

* The instance ID is identical to the stack ID on the AWS platform.

  12.1.1.2. Azure DevOps

##### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) Azure DevOps permissions: Ensure the user performing the integration holds one of the following roles in Azure DevOps:    Project Administrator: This permission is required to subscribe to...

##### Note

* This forces Azure to bypass browser cookies and issue a token for the correct directory.

* PATs are static. To onboard a different tenant, you must log in to that specific environment to generate a new token.

##### Important

* When redirected to the Microsoft login screen, do not immediately enter your email.

##### Navigation

  Settings → Data Sources & Integrations → + Add New

  User Settings → Personal access tokens → + New Token

  12.1.1.2.1. Azure DevOps onboarding system architecture

##### Note

* Microsoft has announced the deprecation of legacy OAuth methods by 2026, making Entra ID the required standard for long-term support.

  12.1.1.3. Bitbucket Cloud

##### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Bitbucket, grant the user performing the Cortex application authorization the following permissions. The level of access required depends on the modules you intend to use:    For code...

##### Note

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Cloud instance: Hover over the Bitbucket Cloud card in the catalog and click Connect Another.

  12.1.1.4. Bitbucket Data Center

##### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Bitbucket, grant the user performing the Cortex application authorization the following permissions:    Administrator permissions for projects   Administrator permissions for...

##### Note

* By default, the permissions of the access token are set according to your current access level. It is essential to define two levels of permissions, Project and Repository permissions. The Repository permissions inherit from Project permissions, requiring Repository permissions to match or exceed Project permissions Providing read and write permissions...

* For additional security, it is recommended to set an expiry automatically. The expiry date of a token cannot be changed after it is created. You can see the expiry dates for all your tokens on Profile picture → Manage account → Personal access tokens.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Data Center instance: Hover over the Bitbucket Data Center card in the catalog and click Connect Another.

##### Important

* Always refer to the Bitbucket documentation for information relating to creating a PAT.

  12.1.1.5. GitHub Cloud

##### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In GitHub, grant the user performing the Cortex application authorization the following permissions:    Organization Owner: Only an Organization Owner can directly authorize and install the...

##### Note

* To create an additional GitHub SaaS instance: Hover over the GitHub SaaS card in the catalog and click Connect Another.

##### Navigation

  Settings → Data Sources & Integrations → + Add New

  Verify integration: On Data Sources, select Code Providers → GitHub SaaS → View more and confirm that the status of your integrated GitHub instance is 'Connected

  12.1.1.6. GitHub Enterprise (On-Prem)

##### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In GitHub, you must have Organization Owner permissions to install the Cortex application. Users with only repository-level admin permissions cannot complete the installation unless the...

##### Note

* The domain is the hostname associated with your GitHub Enterprise (On-Prem) instance.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitHub Enterprise (On-Prem) instance: Hover over the GitHub Enterprise (On-Prem) card in the catalog and click Connect Another.

  12.1.1.7. GitLab SaaS

##### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Gitlab, the following permissions are required to integrate the application:    Maintainer (Project-level). Grants sufficient permissions to configure external integrations, manage...

##### Note

* A repository can only be integrated with a single instance. The first instance that connects with the repository will be the one that the repository is assigned to. This means that if multiple integrations attempt to connect to the same repository, only the first integration to establish the connection will be associated with that repository.

* To create an additional GitLab SaaS instance: Hover over the GitLab SaaS card and click in the catalog and Connect Another.

  12.1.1.8. GitLab Self Managed (On-Prem)

##### Prerequisite

* Authorize the user integrating Cortex Cloud Application Security with your GitLab Self Managed (On-Prem) instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including...

##### Note

* The domain is the hostname associated with your GitLab Self Managed (On-Prem) instance.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitLab Self Managed (On-Prem) instance: Hover over the GitLab Self Managed (On-Prem) card in the catalog and click Connect Another.

  12.1.2. Onboard CI/CD systems

  12.1.2.1. Onboard CircleCI for CI/CD pipeline scans

##### Prerequisite

* Before you begin: Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) CircleCI user requirements:    Permissions: To enable Cortex Cloud visibility for all CircleCI projects, a version control system (VCS) user with integration permissions must be authorized...

##### Note

* This integration utilizes a Personal Access Token (PAT) for authentication CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate...

* Select Add Another Instance if the data source instance has already been configured.

* To add an additional CircleCI instance, navigate to Settings → Data Sources & Integrations → , select the connected CircleCI integration, click  → Add Instance, and repeat the onboarding steps above.

  12.1.2.2. Onboard Jenkins for CI/CD pipeline scans

##### Prerequisite

* Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Jenkins:    To install and configure the Cortex plugin in Jenkins, you must be a Jenkins Administrator with Overall/Administer permissions   Ensure the build server allows outbound HTTPS (Port 443 traffic...

##### Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for code scans, refer to Onboard...

* Select Add Another Instance if the data source instance has already been configured.

* The integration is added on the console but integration is pending, and will only be completed after completing step 5 below. You can view the pending integration on the Jenkins Instances page: Select Data Sources →  Jenkins → View Details. The type of integration is Pipeline Risks

* Always refer to the official Jenkins documentation when installing plugins on Jenkins servers.

* To add an additional Jenkins instance, navigate to Settings → Data Sources → select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps above.

  12.1.3. Integrate CI tools

##### Navigation

  Settings → Data Sources & Integrations → hover over a CI tool → View Details

  Delete an instance: Right-click on an instance of the CI tool → Delete instance → Delete

  12.1.3.1. AWS CodeBuild

##### Prerequisite

* Before you begin:

##### Note

* Select Add Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional AWS CodeBuild instance, navigate to the Settings → Data Sources & Integrations →  page, select the connected AWS CodeBuild integration, click → Add Instance, and repeat the onboarding steps above.

  12.1.3.2. Onboard CircleCI for code scans

##### Prerequisite

* Before you begin:

##### Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for CI/CD scans, refer to...

* Select Add Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* To add an additional CircleCI instance, navigate to Settings → Data Sources & Integrations → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

##### Important

* The cortex-secrets naming convention for the context is mandatory to ensure functionality and must not be changed.

  12.1.3.3. Connect Cortex CLI

##### Prerequisite

* System requirements (OS-specific): The following operating system dependencies are required to run the Cortex Cloud CLI binary on specific architectures.    macOS (Intel Core i7, such as Sequoia):    To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew. Use this command: brew install vectorscan      RHEL...

##### Note

* Select Add Another Instance if a CLI instance is already onboarded.

* In the command above, {version} refers to the CLI version you wish to install (such as latest or a specific number), and {platform} refers to your operating system (such as, linux, darwin, windows).

##### Warning

* Using With upload results permissions may incur additional costs as per your license agreement.

  12.1.3.4. GitHub Actions

##### Prerequisite

* Before you begin:

##### Note

* Select Add Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional GitHub Actions instance, navigate to Settings → Data Sources & Integrations → select the menu for your connected GitHub Actions instance → + New Instance, and repeat the onboarding steps above.

  12.1.3.5. Onboard Jenkins for code scans

##### Prerequisite

* Grant Administrator permissions to the user integrating Cortex Cloud Application Security with Jenkins Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

* For Cortex Cloud Application Security CI tools, you must store secrets in Jenkins Credentials for use in your Jenkins pipelines using either of these methods:    Plain text storage: Store secrets directly as plain text in Jenkins Credentials. Access them in your pipeline using the credentials function, which retrieves the secret directly as plain...

##### Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for CI/CD scans, refer to Onboard...

* Select Add Another Instance if the data source instance has already been configured.

* This step is only required for new pipelines For private repositories, ensure the necessary credentials are configured in Jenkins Credentials

* This ensures your build runs within a Docker environment. If a node without Docker is used, the build will fail.

* To add an additional Jenkins instance, navigate to Settings → Data Sources & Integrations →  select the Jenkins integration, click  → Add Instance, and repeat the onboarding steps.

  12.1.3.6. Onboard Terraform Cloud (Run Tasks)

##### Prerequisite

* Before you begin: Procure a Terraform cloud license that is either a trial license or a TF Cloud license at the TEAM & GOVERNANCE level Terraform permissions: Grant the user or team the following permissions, depending on integration:    Manage Workspaces permissions at the organization level. These permissions are required to attach and manage the run...

##### Note

* Skip this step if you plan on using an existing token.

* Select Add Another Instance if the data source instance has already been configured.

* Cortex Cloud Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Cloud (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected your Terraform Cloud (Run Tasks) instance → + New Instance, and repeat the onboarding steps.

  12.1.3.7. Onboard Terraform Enterprise (Run Tasks)

##### Prerequisite

* Before you begin: Ensure access to a Terraform Enterprise console to enable you to provide a user or team token that authorizes Cortex Cloud Application Security to access workspaces and helps regulate run configurations Terraform Enterprise version compatibility: Ensure Run Tasks for workspaces on is compatible with version 1.1.9 and above Terraform...

##### Note

* For container image vulnerabilities, Cortex Cloud Application Security performs 'Image Referencer' scans within Terraform Enterprise (Run Tasks), as full SCA scans are not currently supported.

* Skip this step if you plan on using an existing token.

* Select Add Another Instance if the data source instance has already been configured.

* Cortex Cloud Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Enterprise (Run Tasks) instance, navigate to Settings → Data Sources & Integrations →  page, select the Terraform Enterprise (Run Tasks) integration, click  → Add Instance, and repeat the onboarding steps above.

  12.1.4. CLI pipeline code snippets

##### Prerequisite

* User permissions: Ensure the user performing the integration has permissions to edit pipeline configurations (such as YAML files).

  12.1.5. Onboard private package registries

  12.1.5.1. JFrog Artifactory

  12.1.5.2. Onboard JFrog Artifactory

##### Prerequisite

* Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) JFrog permissions:    The permissions associated with the user configured during the onboarding process determine the scope of scan results. Only repositories and artifacts the user can access are...

##### Note

* To authorize the scanner to connect through your firewall, select Enable access by IPs, and copy the displayed source IPs to your organization's allowlist.

* For Maven:    Select Mirror Registry if this repository mirrors an external repository   Use the Mirror Of value to define the duplication scope:    * mirrors all requests   Type a request [value]: Mirrors only specific requests (such as central). For Maven: Select Mirror Registry if this repository mirrors an external repository Use the Mirror Of...

  12.1.6. Supported third-party data sources

##### Note

* Only onboarded and scanned repositories can be mapped.

  12.1.6.1. Ingest Semgrep data

##### Prerequisite

* Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) Ensure that you have a connected version control system (VCS) and repositories Create a Semgrep API token  Note    To create a Semgrep API token, in Semgrep, navigate to Settings → Tokens → API...

##### Note

* Select Add Another Instance if the data source instance has already been configured.

* Mapping establishes relationships between Semgrep projects and Cortex Cloud code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects are ingested

  12.1.6.2. Ingest Snyk data

##### Prerequisite

* Permissions: The following user permissions are required:     Cortex Cloud permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator)    Ensure that you have a connected version control system (VCS) and repositories   Snyk API token:    Recommended. Generate an API token from a...

##### Note

* Select Add Another Instance if the data source instance has already been configured.

* Mapping establishes relationships between Snyk applications and Cortex Cloud code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped applications are ingested

##### Navigation

  Modules → Application Security → Vulnerabilities (under Issues

  12.1.6.3. Ingest SonarQube SAST data

##### Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Generate and copy a SonarQube API token. Ensure to assign Web API scope to the API token. Refer...

##### Note

* Mapping establishes relationships between SonarQube Applications and Cortex Cloud Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

  12.1.6.4. Ingest Veracode SAST data

##### Prerequisite

* Permissions: The following user permissions are required:    Cortex Cloud: Instance Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions   Veracode: At minimum, Reviewer permissions are required Permissions: The following user permissions are required: Cortex...

##### Note

* Only mapped applications will be ingested.

* This is the recommended option to ensure complete coverage and successful operation of all features.

* Mapping establishes relationships between Veracode projects and Cortex Cloud Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

  12.1.6.5. Generic 3rd Party AppSec Collector

##### Important

* File uploads are limited to a maximum size of 10 MB.

  12.1.6.5.1. Onboard the 3rd Party AppSec Collector

##### Prerequisite

* Permissions: The following Cortex Cloud user roles or RBAC permissions are required:    User roles: CortexCortex Cloud Cloud Instance Admin, AppSec Admin   RBAC: View/Edit permissions for Data Sources configurations are required when not using a dedicated user role    For more information about user permissions and groups, refer to Assign user roles...

##### Note

* We recommend using the tool.driver.name from the SARIF file.

* This is the newly created generic collector API URL endpoint.

* Only the validity of the format is tested. No findings will be generated from the test file.

##### Warning

* The API key ID and API secret cannot be retrieved once the wizard is closed.

  12.1.7. Manage data source integrations

##### Tip

* To quickly find your data source integration, use the search bar.

  12.1.8. Transporter over Broker VM

##### Prerequisite

* Ensure you have the necessary permissions and have already set up your Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex Cloud resources. The IP addresses for the Transporter are in the Broker VM Resources section of the Enable access to required PANW resources document Open port 4052 (inbound), which...

##### Note

* The broker enables multiple connections, allowing a single Transporter applet to connect to various VCS instances Multiple Transporter applets cannot be created on a single Broker VM. Each Broker VM is limited to a single Transporter applet instance

##### Warning

* The Transporter applet is not supported for FedRAMP customers.

  12.1.8.1. Set up a Transporter applet on Broker VM

##### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator)

##### Note

* You cannot add a Transporter applet through Clusters.

##### Navigation

  your AppSec Transporter under the App column → Configure → Add Connection (on the redirected AppSec Transporter setup page

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

  12.1.8.2. Set up a Transporter on your VCS

##### Prerequisite

* Ensure you have user permissions to onboard data sources.  Note The dedicated AppSec Admin role includes the required permissions. Ensure you have user permissions to onboard data sources. Before you begin you must setup a Transporter applet on your Broker VM. Refer to Set up a Transporter applet on Broker VM for more information

##### Note

* GitLab Enterprise webhook internal IP restriction: GitLab Enterprise's security policies prevent webhook subscriptions to internal IP addresses (such as broker addresses). These subscriptions can only be enabled through specific instance configuration. For more information, refer to https://docs.gitlab.com/security/webhooks/.

##### Navigation

  Settings → Data Sources & Integrations → + Add New → , and search for your VCS on-premises data source

  12.2. Cortex Cloud Application Security dashboard

##### Navigation

  Modules → Application Security → AppSec Dashboard

  12.3. Application Security Posture Management (ASPM)

  12.3.1. ASPM use cases

  12.3.2. ASPM key features

  12.3.3. ASPM user roles and permissions

##### Navigation

  You can view AppSec Admin permissions in the tenant by navigating to Settings → Configurations → Roles → AppSec Admin

  12.3.4. Code to Cloud

##### Navigation

  Full Code to Cloud (C2C) coverage is achieved when Cortex Cloud can resolve the following chain: Repository → Pipeline → Image → (optional Registry) → Runtime resources (including VMs, VM images, and IaC-defined infrastructure

  12.3.4.1. Supported integrations

  12.3.4.2. Code to Cloud visibility

##### Navigation

  Topology graph: Located in the Business Applications side card, this tab visualizes the entire path to production (Code → Build → Deploy → Run), allowing you

  12.3.4.3. Code to Cloud troubleshooting

##### Note

* Empty state messages and troubleshooting guidance for missing lineage are only visible to users with an active license.

  12.3.5. ASPM Command Center

  12.3.5.1. ASPM Command Center workflow

##### Note

* Breakdown by type: Issues are further broken down by type (such as IAC or Secrets).

  12.3.6. Coverage

  12.3.6.1. Coverage in the user interface

##### Navigation

  Modules, → Application Security → AppSec Coverage

  12.3.7. Compliance for Cortex Cloud Application Security

  12.3.7.1. Infrastructure-as-Code (IaC) compliance

  12.3.7.2. Manage IaC compliance

##### Prerequisite

* Add these properties to the IaC Rules table through the Table Settings Menu, as they are not exposed by default.

##### Navigation

  Modules → Application Security → AppSec Polices → Add Policy

  12.3.7.3. CI/CD Compliance

##### Navigation

  To access Compliance, select Posture Management → Compliance → Reports or Assessment

  12.3.7.3.1. Create CI/CD compliance reports

##### Note

* The CI/CD module supports GitHub and GitLab provider types.

* For more information about about Asset Groups, refer to Asset Groups.

* CIS GitLab Benchmark, CIS GitHub Benchmark, and the OWASP Top 10 CI/CD Risks standards are supported.

* For more information about assessment profiles, refer to Use an assessment profile to run compliance checks on your assets.

##### Navigation

  Posture Management → Compliance → Reports

  12.3.8. Urgency

  12.3.8.1. Urgency metrics

  12.3.9. Backlog baseline

  12.3.9.1. Backlog use cases

  12.3.9.2. Issue/Finding classification by scanner

##### Note

* In some cases/vendors, this is not accurate as findings are deleted every time new findings are uploaded. In such cases, the feature may not be accurate or supported For SAST, the vendor does not support policy in pull requests

* Scanner updates and new detections: When a security scanner is updated to support new languages, detection rules, or capabilities, any issues discovered by these new features for existing code are classified as part of the backlog.

  12.3.9.3. Using Backlog

  12.3.10. Service Lead Agreements (SLA)

  12.3.10.1. Configure and monitor Cortex Cloud Application Security SLAs

##### Navigation

  Settings → Configurations → Application Configuration (under Application Security

  12.3.11. Applications

  12.3.11.1. Defining Business Applications

  12.3.11.1.1. Defining business applications by Criteria

  12.3.11.1.2. Define applications by VCS criteria

##### Prerequisite

* Data source: Your Version Control System (e.g., GitHub, GitLab) must already be onboarded as a Data Source Permissions: You must have View/Edit permissions for Access Management SBAC: You can only create applications from VCS entities (Organizations, Projects, or Repositories) that are already included in your SBAC Asset Groups

##### Note

* This workflow allows you to unify assets across disparate providers (such as grouping a GitHub repository and a Bitbucket repository into one application) if they share naming conventions

  12.3.11.1.3. Manage application criteria

  12.3.11.1.4. Define applications by cloud tag-based criteria

##### Prerequisite

* Permissions: You must have View/Edit permissions for Access Management, or a role that includes these permissions.

##### Note

* You can only create applications based on the entities from onboarded Cloud accounts listed in the Cloud card.

* Kubernetes (K8S) labels: K8S labels are supported as tags for asset grouping only when they originate from a supported cloud provider; AWS, GCP, Azure, or OCI.

  12.3.11.1.5. How to manually build an application

##### Prerequisite

* Before you begin, ensure you have connected the necessary data sources. Refer to How to onboard data sources for more information.How to onboard data sources

##### Note

* These filters are represented by icons displayed on the Code pane after selecting a VCS.

* To edit application assets, click the Clear All icon before clicking Finish. This clears all application data, allowing you to restart the application building process from the beginning.

  12.3.11.2. Application management and visibility

##### Navigation

  Inventory → All Assets → Business Applications (under Application

  12.3.11.3. Business application assets

  12.3.11.3.1. Business application expanded asset details

##### Note

* The topology graph is available only when all application components (code, pipeline, build and deploy), are configured.

  12.3.11.3.2. Export business application data

##### Navigation

  Inventory → All Assets → Business Applications

  12.3.11.4. Scope user access to applications (Application SBAC)

##### Navigation

  Configure user scopes in Cortex Cloud by navigating to Settings → Configurations → Access Management

  12.3.11.4.1. Enable SBAC in the Cortex Cloud tenant

##### Prerequisite

* RBAC permissions: To configure user scopes you must have Administrator or View/Edit RBAC permissions for Access Management (under Configurations).

##### Note

* Exclusions (roles not governed by SBAC): Certain roles cannot have SBAC applied. For these roles, access and permissions are managed through Role-Based Access Control (RBAC). You must manually ensure that these roles have all necessary base permissions (for example Edit/View permissions to assets), because SBAC is bypassed and does not impose its usual...

##### Navigation

  Settings → Configurations → General → Server Settings → Enable Scope Based Access Control

  12.3.11.4.2. Create an application-based Asset Group

##### Note

* You cannot create SBAC based on static groups.

  12.3.11.4.3. Scope user access to an application

##### Note

* For more information about User Groups, refer to User group management.

##### Navigation

  Settings → Configurations → User Groups (under Access Management

  Right-click on a group in the table → Edit Group → select the Scope tab

  Assets → Select asset groups → select an Asset Group associated with applications

  Settings → Configurations → Users (under Access Management

  the chevron icon (>) in the Assets field → Select Asset groups → select the user group scoped to the application (see above

  12.3.11.4.4. Create application-scoped policies

##### Note

* Application-scoped policies apply to both code and CI/CD configuration policies.

##### Navigation

  Modules → Application Security → AppSec Polices (under Policy Management) → Add Policy

  Add Filter → Business Application Names → enter the required application name

  12.3.12. Repositories as assets

  12.3.12.1. Explore repository assets

  12.3.12.2. In-depth repository asset information

  12.3.12.3. Manage Repository assets

  12.3.12.4. Export Software Bill of Materials (SBOM)

  12.3.12.5. Manage issues detected in repositories

##### Note

* You can also find the repository issues in the general issue inventory table, and in the dedicated inventory of issues for each scanner type (see step 4 above for details).

  12.3.13. Manage 3rd party findings and generated issues

  12.3.14. Manage code weaknesses

##### Note

* You can customize policies to define which findings are categorized as issues.

##### Tip

* In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Code Weaknesses tab under the Repositories asset inventory. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from the table → Code Weaknesses In code Asset inventories, navigate to Inventory →...

##### Navigation

  To access SAST code violation issues, under Modules, select Application Security → Issues → Code Weaknesses

  12.3.14.1. Code weaknesses issue inventory

  12.3.14.2. Detailed code weakness issue information

##### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  12.3.14.3. Code weakness findings

##### Note

* Findings on the Cortex platform are not intended for direct action; but rather represent data collected by the platform. They must be promoted to issues to enable mitigation efforts to secure your codebase.

  12.4. CI/CD Security

  12.4.1. CI/CD Security user roles and permissions

  12.4.2. CI/CD Assets

  12.4.2.1. CI/CD Instances as assets

  12.4.2.1.1. Explore CI/CD Instance assets

##### Navigation

  To access CI/CD pipeline instances, under Inventory, select All Assets → Code → Category → CI/CD Instances

  12.4.2.1.2. In-depth CI/CD pipeline instance asset information

  12.4.2.1.3. Manage CI/CD pipeline instances

  12.4.2.2. CI/CD Pipelines as assets

  12.4.2.2.1. Explore CI/CD Pipeline assets

##### Navigation

  To access CI/CD pipelines assets, under Inventory, select All Assets → Code → CI/CD Pipelines

  12.4.2.2.2. In-depth CI/CD pipeline asset information

##### Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

  12.4.2.2.3. Manage CI/CD pipeline assets

  12.4.2.3. Version Control System (VCS) Organizations as assets

  12.4.2.3.1. Explore VCS Organization assets

##### Navigation

  To access VCS Organization assets, under Inventory, select All Assets → Code → VCS Organizations

  12.4.2.3.2. In-depth VCS Organization asset information

##### Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

  12.4.2.3.3. Manage VCS organization assets

  12.4.2.4. VCS Collaborators-as-assets

  12.4.2.4.1. In-depth Collaborator asset information

  12.4.2.4.2. Manage Collaborator assets

  12.4.3. Supply Chain Inventories

##### Note

* Although attributes are identical across inventories, their values for the same tool can differ, most commonly in Risk Factors and Type. This is because the inventory reflects your live environment, which may include different versions or configurations than the catalog—for example, a package may not have been upgraded or may be deployed differently.

##### Navigation

  In the inventory table, right-click on a tool → Change Status → select a status

  12.4.3.1. Supply Chain Tools

  12.4.3.1.1. Supply Chain Tools

##### Navigation

  To access Supply Chain Tools, select Modules → Application Security → Supply Chain Tools (under 3rd Party Tools

  12.4.3.1.2. Expanded Supply Chain tool information

##### Note

* AppSec Admin user permissions are required to perform these actions.

  12.4.3.2. Supply Chain Catalog

##### Navigation

  To access the Supply Chain Catalog, select Modules → Application Security → Supply Chain Catalog (under 3rd party tools

  12.4.4. CI/CD Risks

##### Note

* Cortex Cloud Application Security CI/CD pipeline scans create a comprehensive inventory of all CI/CD pipelines in your environment. For more information refer to CI/CD Pipelines as assets.

  12.4.4.1. CI/CD pipeline issues

##### Navigation

  To access CI/CD pipeline risks issues, under Modules, select Application Security → Issues → CI/CD Risks

  12.4.4.2. Expanded CI/CD risks issue information

##### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  12.4.4.3. VCS and CI/CD pipeline risk findings

  12.4.5. CI/CD Rules

##### Note

* Out-of-the-box rules cannot be modified Custom CI/CD rules are not supported

  12.4.5.1. CI/CD rules roles and permissions

  12.4.5.2. CI/CD rules inventory

  12.4.6. CI/CD Policies

##### Tip

* For Cortex Cloud Code policies, refer to Application Security Policies.

  12.4.6.1. CI/CD policies user roles and permissions

  12.4.6.2. CI/CD policies inventory

##### Note

* To view all out-of-the-box (OOTB) policies, filter by Policy Owner = System.

  12.4.6.3. Create custom CI/CD policies

##### Note

* PR Scan and CI Scan triggers are automatically disabled and unchecked. They can only be enabled if other scan types (that is non-CI/CD risk scans such as Secrets) are also selected, and will only run on non-CI/CD risks types of scans

* You can combine multiple conditions to create complex rules for when the policy should apply. Create conditions that apply to a CI/CD policy which detects high severity CI/CD risks on GitHub: Select Add Filter → Finding Type → CI/CD Risks → AND → Provider → [VCS/CI/CD system] → AND → Severity: → High.

* SBAC scope limitations do not apply to Matching Criteria For CI/CD policies, you can filter Matching Criteria by VCS Organization Name, CI/CD Pipeline [Name/ID], CI/CD Instance [Name/ID] or Collaborator [Name/Email/MFA Enabled/Last Observed]

  12.4.6.4. Manage CI/CD policies

##### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

  12.5. Code Security

  12.5.1. Code Security user roles and permissions

  12.5.2. Code Security assets

  12.5.3. Software packages as assets

  12.5.3.1. Explore software package assets

  12.5.3.2. In-depth software package asset information

  12.5.4. Infrastructure-as-Code (IaC) resources as assets

  12.5.4.1. Explore IaC assets

##### Navigation

  To access IaC assets, under Inventory, select All Assets → Code → IaC Resources

  12.5.4.2. In-depth IaC resource asset information

  12.5.5. Code Security scanners

  12.5.6. Secrets scanners

  12.5.6.1. Secrets issues

##### Navigation

  Under Modules, select Application Security → Issues → Secrets

  Inventory → All Assets → Code: On the Secrets tab under Repositories

  Inventory → All Assets → Code

  Inventory → All Assets → Application → select an option from the Application menu → select an item from the inventory → Secrets

  12.5.6.2. Secrets issues inventory

  12.5.6.3. Detailed Secrets issue information

##### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  12.5.6.4. Secrets findings

##### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

##### Navigation

  The Cortex Cloud Application Security Secrets Findings table is a pre-filtered view of the comprehensive Findings inventory (located at Cases & Issues → Issues → Findings Table tab

  To access Secrets findings, select Application Security → Issues → Secrets → click the Findings tab

  12.5.6.5. Manage Secrets issues

  12.5.7. Infrastructure as Code (IaC) misconfiguration scanner

  12.5.7.1. Supported frameworks and languages

  12.5.7.2. IaC misconfiguration issues

##### Tip

* You can also view IaC misconfiguration issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Configuration tab under Repository assets. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from...

##### Navigation

  To access IaC misconfiguration issues, under Modules, select Application Security → Issues → IaC misconfiguration

  12.5.7.3. IaC misconfiguration issues inventory

  12.5.7.4. Detailed IaC misconfiguration issue information

##### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  12.5.7.5. IaC misconfiguration findings

##### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

##### Navigation

  To access IaC misconfiguration findings, under Modules, select Application Security → Issues → IaC Misconfigurations → click the Findings tab

  12.5.7.6. Manage IaC misconfiguration issues

  12.5.8. IaC Drift Detection scans

  12.5.8.1. IaC Drift Detection issues

##### Navigation

  Modules → Application Security → IaC Drifts

  12.5.8.2. IaC Drift Detection issue inventory

  12.5.8.3. Detailed IaC drift detection issue information

  12.5.8.4. IaC Drift Detection findings

##### Navigation

  Modules → Application Security → IaC Drifts (under Issues) → click the Findings tab

  12.5.9. Software Composition Analysis (SCA ) scanners

  12.5.9.1. Supported Software Composition Analysis (SCA) frameworks and languages

  12.5.9.2. Software Composition Analysis (SCA) vulnerability issues

##### Tip

* In Asset inventories, navigate to Inventory → All Assets → Code:    On the Vulnerabilities tab under Repositories. Refer to In-depth repository asset information for more information Under the All Code inventory: Select an asset from the table → Vulnerabilities In Asset inventories, navigate to Inventory → All Assets → Code: On the...

##### Navigation

  To access CVE vulnerability issues, under Modules, select Application Security → Issues → Vulnerabilities

  12.5.9.2.1. Vulnerability issues inventory

  12.5.9.2.2. Detailed vulnerability issue information

##### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  12.5.9.2.3. CVE vulnerabilities findings

##### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

##### Navigation

  The Cortex Cloud Application Security Vulnerabilities Findings table is a pre-filtered view of the comprehensive Findings inventory (located at Cases & Issues → Issues → Findings Table tab

  To access CVE findings, under Modules, select Application Security → Issues → Vulnerabilities → click the Findings tab

  12.5.9.2.4. Manage SCA CVE vulnerability issues

  12.5.9.3. License miscompliance issues

##### Tip

* You can also view license miscompliance issues in dedicated tabs under other sections when available: In Application asset inventories: navigate to Inventory → All Assets →  Application → select an option from the Application menu → select an item from the inventory → Package Integrity In Asset inventories, navigate to Inventory → All...

##### Navigation

  To access license miscompliance issues, under Modules, select Application Security → Issues → Licenses

  12.5.9.3.1. License miscompliance issues inventory

  12.5.9.3.2. Expanded License miscompliance issues information

  12.5.9.3.3. License miscompliance findings

##### Navigation

  To access license miscompliance findings, under Modules, select Application Security → Issues → Licenses → click the Findings tab

  12.5.9.3.4. Open-source software license categories

  12.5.9.3.5. Manage license miscompliance issues

  12.5.9.4. Package Integrity

  12.5.9.4.1. Package Integrity inventory

##### Note

* You can modify the severity level from the severity field menu.

  12.5.9.4.2. Expanded Package Integrity issues inventory information

##### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  12.5.9.4.3. Package Integrity findings

##### Note

* Findings cannot be mitigated. They must be promoted to issues to enable remediation efforts to secure your software packages.

  12.5.9.4.4. Manage Package Integrity issues

  12.5.10. Application Security scans management

  12.5.10.1. Overview

##### Note

* While scans provide a comprehensive inventory of all issues detected during a scan, dedicated inventories are also maintained for specific scan types for more granular management. For more information, refer to Infrastructure as Code (IaC) misconfiguration scanner, Secrets scanners and Software Composition Analysis (SCA ) scanners.

  12.5.10.2. Branch periodic scans

##### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

  12.5.10.3. Pull Request scans

##### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

  12.5.10.4. CI scans

##### Note

* The inventory table displays scan issues for visibility only; remediation is not available in scan management. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

  12.5.10.5. Manage repository scan configurations

  12.5.10.6. Monitor data source instances health

  12.5.11. Application Security Policies

  12.5.11.1. User roles and permissions

  12.5.11.2. Policies inventory

##### Note

* To view all out-of-the-box (OOTB) policies, filter by Policy Owner = System.

  12.5.11.3. AI-recommended guardrails

  12.5.11.3.1. Manage AI-recommended guardrails

##### Note

* Recommended guardrails are generated based exclusively on findings from the Cortex Cloud Application Security Software Composition Analysis (SCA) scanner. They do not support SCA data ingested from third-party scanners, nor do they currently support other finding categories, such as Secrets or Infrastructure as Code (IaC).

* The total amount of available recommended guardrails is displayed on the AI Recommendations button.

* The AI-Recommended tag is only assigned to recommendations applied as-is, that is, without modifications. Edited recommendations generate policies without this label.

  12.5.11.4. Create Cortex Cloud Application Security policies

##### Note

* When an issue is created, only the first policy ID that triggered the issue is associated with it.

  12.5.11.4.1. Create code security policies

##### Note

* For a detailed list of all available attributes and their values by scanner type, refer to Cortex Cloud Application Security code policy Condition attributes .

* SBAC scope-based limitations do not apply to Asset Types

* When selecting Asset Groups, the code policy is evaluated only on the application and repository assets included in the group.

* For each application that matches the criteria, the policy is evaluated only on the repositories associated with that application.

* If you select only Code Weaknesses as the Finding Type in the condition step (indicating a third-party scanner), the PR and CI triggers are disabled, leaving only Periodic Scan enabled.

  12.5.11.4.1.1. Cortex Cloud Application Security code policy Condition attributes

  12.5.11.4.2. Create IaC Drift Detection policies

##### Navigation

  Modules → Application Security → AppSec Policies → Add Policies

  12.5.11.4.3. Manage Cortex Cloud Application Security policies

##### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

  12.5.12. Application Security Rules

##### Note

* Out-of-the-box rules cannot be modified directly. However, you can create a custom rule by cloning the existing one. This allows you to make changes to the original rule according to your requirements. Refer to Manage Cortex Cloud Application Security custom rules for more information.

  12.5.12.1. Roles and permissions

  12.5.12.2. Rules inventory

##### Navigation

  To filter rules relating to Secrets, select filter icon → Scanner (from the Select field) → Secrets (from the Value field

  12.5.12.3. Create custom Cortex Cloud Application Security rules

##### Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

  12.5.12.4. Manage Cortex Cloud Application Security custom rules

  12.5.12.5. Configure YAML file properties

  12.5.13. Application Security CLI

##### Prerequisite

* These requirements apply specifically to the Application Security CLI. For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of...

##### Note

* For detailed information about the Cortex Cloud CLI, refer to Cortex CLI.

  12.5.13.1. Connect Cortex CLI

##### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

##### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources & Integrations →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Cortex Cloud Application Security, refer to Cortex CLI usage for Cortex Cloud Application Security

##### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source or Integrations page after selecting + Add New.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

  12.5.13.2. Cortex CLI usage for Cortex Cloud Application Security

  12.5.13.3. CLI pipeline code snippets

##### Prerequisite

* User permissions: Ensure the user performing the integration has permissions to edit pipeline configurations (such as YAML files).

  12.5.13.4. Cortex CLI Cortex Cloud Application Security command line reference

##### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

##### Important

* The Cortex CLI Cortex Cloud Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id...

  12.5.13.5. Cortex CLI common command line reference guide

##### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

  12.5.13.6. Git Hooks

  12.5.13.6.1. Cortex CLI pre-commit hooks

##### Prerequisite

* These common prerequisites are required for all types of installation (both local and global) of the Cortex CLI pre-commit hook. Ensure you have a license for Cortex Cloud Application Security Install the Cortex Cloud CLI binary locally. Refer to Connect Cortex CLI for information about onboarding the CLIConnect Cortex CLI Obtain Cortex Cloud API...

* For local installation: Install the pre-commit framework version 3.2.0 or greater. Refer to https://pre-commit.com/ for installation instructions.

##### Note

* It is recommended you configure credentials for the Cortex CLI using a configuration file.

* The pre-commit framework is not required for global mode.

  12.5.13.6.1.1. Pre-commit hook usage

  12.5.13.6.2. Cortex CLI pre-receive hooks

##### Prerequisite

* Before you begin, ensure you have: Administrator access to the VCS server and console A valid license for Cortex Cloud Application Security The Cortex Cloud CLI binary or Docker image installed on the server (requires GLIBC (GNU C library) version 2.35 or greater). Refer to Connect Cortex CLI for information about onboarding the CLIConnect Cortex...

##### Note

* Make sure to create the directory under the home directory of the Linux user that runs the Git hooks. This user is typically not the root user.

  12.5.13.6.2.1. Pre-receive hook usage

  12.5.14. IDE

##### Note

* Not all remediation options are available for all findings or all type of scan category.

  12.5.14.1. System requirements

  12.5.14.2. Visual Studio (VS) Code and VS Code compatible IDEs

##### Prerequisite

* Before you begin (These prerequisites apply to both VS Code and VS Code compatibles): Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

##### Note

* Enforcement rules and CA certificates are not applicable to the open-source project.

##### Tip

* You can access Extensions using the keyboard shortcuts Ctrl+Shift+X (Windows) or Cmd+Shift+X (macOS).

##### Navigation

  Install through VS Code IDE Access the Activity bar → Extensions → Cortex Cloud → Install

  Access the Activity bar → Extensions → Cortex Cloud → Install

  12.5.14.2.1. How to use the Cortex Cloud extension in VS Code

##### Note

* Not all remediation options are available for all issues.

* The suppression is scoped to the file.

  12.5.14.3. JetBrains

##### Prerequisite

* Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install Node.js version 22 and...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

##### Note

* The Cortex AppSec code security plugin supports all JetBrains products.

##### Navigation

  Settings → Plugins → select the Marketplace tab → search for Prisma Cloud → Install → OK

  Settings → Tools → Cortex Cloud

  12.5.14.3.1. How to use the JetBrains Cortex Cloud extension

##### Note

* After selecting Fix Available, the number of issues displayed in the issue categories (such as IaC) reflect the number of fixable issues for that type.

* The corresponding file simultaneously opens in the Code editor, highlighting the issue within its exact code context. See below for more information.

* Not all types of remediation are available for all issue categories. For example, fixes are not available for License issues.

* Secrets and Licenses category issues are typically mitigated by following the guidance in the Documentation.

  12.5.15. Developer Suppressions

##### Note

* The check IDs and rule names are placeholders for illustration purposes and do not correspond to actual checks.

  12.6. API documentation

13. Cloud ASM

  13.1. What is Cloud ASM?

  13.2. Cloud ASM concepts

  13.2.1. Scanning

  13.2.1.1. Scanning cadences

  13.2.1.2. Scanning ports and protocols

##### Note

* The following lists are not exhaustive. For current and complete lists, contact your customer success team.

  13.2.1.3. Scanning activity

  13.2.2. Network mapping

  13.3. Enable Cloud ASM

##### Note

* Discovered services will increase workload consumption. ASM data will begin to appear in your tenant and be included in your licensing workload meter within 72 hours.

##### Navigation

  Settings → Configurations → Attack Surface → Data Management

  13.4. Attack Surface Management detections

  13.4.1. Attack surface rules

##### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

  13.4.2. Externally inferred CVEs

##### Note

* An externally inferred CVE might impact your service or asset, but additional investigation is required to confirm that the CVE is actually present.

  13.5. Attack surface assets

##### Navigation

  The internet-facing assets that were discovered in an attack surface management (ASM) scan and attributed to your organization are available in the inventory on the Inventory → Assets → All Assets → External Surface pages

  13.6. Review your unmanaged cloud services

##### Navigation

  Inventory → Assets → All Assets → External Surface → Services

  13.7. Review unmanaged cloud issues

  13.8. Attack Surface Management FedRAMP support

14. Network exposure detection

  14.1. What is Cloud Network Analyzer?

  14.2. Internet exposure detection

##### Note

* Currently, CNA supports only an isolated architecture with an AWS Gateway Load Balancer (GWLB) within a single VPC. Other more centralized topologies including one security VPC that forwards traffic to other workload VPCs are currently not supported.

  14.3. Outbound exposure detection

  14.4. East-west exposure detection

  14.5. Investigate an internet exposure

##### Note

* The Network tab is currently only available for virtual machines.

* The Network tab is only displayed when you have access to the main asset and associated ones, such as security groups, VPCs and subnets. For more information on Scope-Based Access Control (SBAC) for configuring granular scoping, see Manage user scope.Manage user scope

15. Cortex Cloud Data Classification

  15.1. What is Cortex Cloud Data Classification?

##### Navigation

  To access Data Classification management, click Settings → Configurations → Data Classification

  15.2. How to create and validate a custom data pattern

##### Note

* Once a custom data pattern is saved, it runs on all data in the same way as any out-of-the-box (OOTB) pattern, becoming globally applicable for all modules using Cortex Cloud Data Classification.

* For more information, see How to disable and enable data patterns in Data Classification.How to disable and enable data patterns in Data Classification

  15.3. How to disable and enable data patterns in Data Classification

##### Note

* Disabling data patterns can cause changes in your data profile results and stop detection of these data patterns.

* For more information about data patterns in data classification, see What is Cortex Cloud Data Classification?.

##### Navigation

  In the lower left part of the screen, click Settings → Configurations → Data Classification → Data Patterns

  15.4. How to create and validate a custom data profile

##### Note

* If you choose two data locations, only the filters they have in common will be included in the possible filter options.

* For more information, see How to disable and enable data profiles in Cortex Cloud Data Classification.

##### Important

* Deleting a data profile deletes all past data associated with it in all modules using Cortex Cloud Data Classification after a warning notification is displayed.

* Enabling and disabling a data profile removes or re-adds the data profile results to the data objects; that is, files and tables.

  15.5. How to disable and enable data profiles in Cortex Cloud Data Classification

##### Note

* Existing results on past scans are updated in the Asset and Object inventories within two hours after being disabled or enabled.

* For more information about data profiles in Cortex Cloud Data Classification, see What is Cortex Cloud Data Classification?.What is Cortex Cloud Data Classification?

##### Navigation

  In the lower left part of the screen, click Settings → Configurations → Data Classification → Data Profiles

  15.6. How to report a false positive in Cortex Cloud Data Classification

##### Note

* Alternatively, in Cortex Command Center, click Help → Submit a Support Case.

16. Cortex Cloud Data Security

  16.1. What is Cortex Cloud Data Security?

  16.2. Supported assets in Cortex Cloud Data Security

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* CMK (customer-managed key) in SQL Server is only supported in outpost mode.

* The list above refers to only data classification; however, Cortex Cloud Data Security discovers and monitors all cloud assets and services for usage and misconfigurations.

* For information about configuring data classification asset types, see How to configure the scanning settings for supported services.

  16.3. Cortex Cloud Data Security concepts

  16.4. Cortex Cloud Data Security use cases

  16.5. Data Inventory

##### Note

* To clear the filter in the filter panel, click Delete.

##### Navigation

  When you select Inventory → All Assets → Data → All Data Assets, a list of all data assets appears

  16.6. How to review errors in Cortex Cloud Data Security

  16.7. How to configure the scanning settings for supported services

##### Note

* If you do not select a scanning cadence, the default setting is applied. For more information, contact your Customer Support team.

  16.8. How to perform advanced Data Security investigations using XQL

##### Note

* For more information, see Build XQL queries.

  16.9. How to onboard Databricks

##### Note

* If you turn on this feature, both the cloud and region will be used for scanning, possibly incurring cost and requiring adherence to certain compliance policies.

  16.10. How to onboard Microsoft 365

##### Prerequisite

* You have generated a Globally Unique Identifier (GUID), also known as a Universally Unique Identifier (UUID). You will need this ID for the tenant you want to use for the Microsoft 365 instance. In order to use Microsoft 365, you must be registered with Microsoft Azure.

  16.11. How to onboard on-premise file shares to Cortex Cloud Data Security

##### Note

* Your data is scanned on the Broker VM itself, and only the metadata and classification results are transmitted from the on-premise environment to Cortex Cloud.

* For information about activating the DSPM Fileshare applet, see Activate DSPM Fileshare.

  16.12. How to onboard Snowflake

##### Prerequisite

* In order to use Snowflake, you must be registered with one of these cloud providers: Amazon AWS, Microsoft Azure, or Google Cloud Platform (GCP). Ensure you have the necessary account permissions to onboard. It is recommended to use Account Admin as the role for the onboarding.

##### Note

* The account identifier can be found using the user information at the bottom left. Hover over the account you wish to onboard and select the copy option at the top right. The account identifier is usually of the format: (organization).[account]

  16.13. How to use information protection labels in Cortex Cloud Data Security

##### Note

* Only If you have connected a Microsoft 365 instance to Cortex Cloud, the information protection labels appear. See How to onboard Microsoft 365.

17. Cortex Cloud Identity Security

  17.1. What is Cortex Cloud Identity Security?

  17.2. Review and improve your Identity Security posture

##### Tip

* Reducing the number of nonhuman entities that are either dormant or have administrative privileges is the most effective way to improve your security score.

  17.3. How does Effective Permission Calculation work?

  17.4. Cortex Cloud Identity Security functionality

##### Note

* Access to the Weak/Compromised Password widget and column requires the ITDR add-on.

* For more information about Effective Permission Calculation, see How does Effective Permission Calculation work?.

* When a policy is analyzed and categorized as excessive, a relevant finding and highlight is attached to that policy and the various identities being granted excessive permissions.

* Each action must be defined as either being administrative or not. The administrative tag is an additional tag for administrative actions, along with one of the other access level types. For example, the AWS action iam:CreateGroup is categorized as config and has the administrative tag as well.

##### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

  17.5. Achieve the principle of least privilege access

##### Note

* In the case of Amazon AWS, Cortex Cloud Identity Security also uses AWS Identity and Access Management (IAM) Access Advisor insights to expand the coverage of supported actions.

##### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

  17.6. Explore permissions using the simple and advanced access tables

  17.7. Create a custom detection rule in Cortex Cloud Identity Security

##### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

  17.8. Perform advanced Identity Security investigations using XQL

##### Note

* For more information, see Build XQL queries.

  17.9. Enable inactive human identity logs on Azure in Cortex Cloud Identity Security

##### Note

* For more information, see Ingest logs from Microsoft Azure Event Hub.

  17.10. Manage RBAC and SBAC in Cortex Cloud Identity Security

##### Important

* You can use the Cortex Cloud Identity Security RBAC roles to define access to the various sections and functionalities of Cortex Cloud Identity Security, but these roles do not directly control the specific data a user sees within those sections. Data visibility is further refined and limited by scope-based access control (SBAC) capabilities.

18. Cortex Advanced Email Security

  18.1. Cortex Advanced Email Security module overview

##### Prerequisite

* The following are prerequisites for using the Cortex Cloud Advanced Email Security module. REQUIREMENT DESCRIPTION Setup and Permissions Ensure Analytics is activated before enabling the Cortex Advanced Email Security module. Licenses and Add-ons Cortex Advanced Email Security add-on.

  18.2. Cortex Advanced Email Security module architecture and data flow

  18.3. Getting started with the Cortex Advanced Email Security module

##### Prerequisite

* Before you configure the Cortex Advanced Email Security module, ensure you have the following: Admin-level access to the target email platform Dedicated service account (recommended) for integration purposes (response actions) List of domains and mailboxes to be protected (to be used during the wizard configuration) Access to an internal phishing...

  18.4. Deploy and configure the Email Security module

  18.4.1. Integrate Microsoft 365 with the Cortex Advanced Email Security Module

##### License Type

  To configure a quick action, you must first create an application in Microsoft O365.

##### Navigation

  After you onboard your domains and configure the quick actions, Cortex Cloud manage your protected domains in Modules → Email Security → Email Security Configuration

  18.4.2. Configure the Cortex Advanced Email Security module

##### License Type

  Requires the Advanced Email Security module.

##### Note

* You can add email indicators to the Allow List also in Exceptions Configuration → Issue Exclusions. However, if you add multiple indicators in a rule using Issue Exclusions under Exceptions Configuration, you cannot edit the rule in the Email Security Allow List.

##### Navigation

  Modules → Email Security → Email Security Configuration

  18.5. Cortex Advanced Email Security threat detection and issues

##### Note

* Depending on data collection mode and platform capabilities, not all fields may be populated for every message. API and export documentation provides further clarification on optional vs required fields.

  18.5.1. Email Security Analytics Rules

##### Navigation

  The Email Security Analytics Rules page is in Modules → Email Security → Email Security Detection Rules

  18.6. Investigate and respond to email security issues

##### License Type

  Requires the Cortex Advanced Email Security module.

##### Navigation

  Modules → Email Security → Email Security Issues

  18.7. Automate remediation for the Cortex Advanced Email Security module

##### Note

* For automated actions not yet supported by the response engine, use the playbooks, scripts, and commands in the Cortex XSIAM automation engine. For more information, see Automation in Cortex Cloud.

##### Navigation

  Define the rules for your email security policy in Email Remediation Response Rules, located in Modules → Email Security → Remediation → Rules

  Review all the remediation actions initiated by your policy in the Email Remediation Action Center, located in Modules → Email Security → Remediation → Action Center

  18.7.1. Email Remediation Response Rules

##### Note

* For automated actions not yet supported by the response engine, use the playbooks, scripts, and commands in the Cortex XSIAM automation engine. For more information, see Automation in Cortex Cloud.

* If you apply a new template, all the customizations to the previous template you used will be lost.

##### Navigation

  The Email Remediation Response Rules page is under Modules → Email Security → Remediation → Rules and displays the following widgets and the Rules table

  18.7.2. Email Security Remediation Action Center

  18.8. Email Command Center

##### License Type

  Requires the Cortex Advanced Email Security module.

##### Note

* Adding more data into the Email Security module will ensure better detection of complicated email threat vectors.

* The number of remediated emails and the number of remediation actions may not always be equal. This is due to a number of reasons, including different policies that affect the email messages or manual actions taken.

  18.9. Advanced Email Security module security and compliance

19. Vulnerability management

  19.1. Vulnerability management in Cortex Cloud

##### License Type

  Requires the Cortex Cloud Posture Security, Cortex Cloud Runtime Security, Exposure Management, or ASM add-on.

##### Note

* Cortex Cloud vulnerability management provides the ability to identify and assess runtime vulnerabilities in every asset across traditional IT and cloud environments. For vulnerabilities detected in your software development lifecycle through application security scans, refer to the Cortex Cloud Application Security documentation.

  19.1.1. Cortex Cloud vulnerability concepts

##### Note

* CVE is an acronym for Common Vulnerabilities and Exposures, which is a list of publicly disclosed security threats. We often use the term "CVE" to refer to a vulnerability that has been a assigned a CVE ID. Cortex Cloud identifies CVEs and non-CVE vulnerabilities.

  19.1.2. Vulnerability Management dashboard

  19.2. Cortex Vulnerability Risk Score

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

  19.3. Vulnerability policies

  19.3.1. Create a vulnerability policy

##### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

  19.3.2. Update the Ignored CVEs, Asset Groups, and Assets policy

##### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

  19.3.3. Modify a vulnerability policy

##### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

  19.3.4. Configure a block grace period

##### Navigation

  Posture Management → Rules & Policies → Vulnerability Management → Vulnerability Policies - Prevention

  19.3.5. Enable or disable a vulnerability policy

##### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

  19.4. Investigate and remediate vulnerabilities

  19.4.1. View all Vulnerabilities

##### Navigation

  Posture Management → Vulnerability Management → Vulnerabilities

  19.4.2. View vulnerability issues

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

  19.4.3. View All Vulnerability Findings

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues and click the All Vulnerability Findings button

  19.4.4. View vulnerable assets

##### Navigation

  Posture Management → Vulnerability Management → Vulnerable Assets

  19.5. Vulnerability Intelligence

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

  19.6. Recast CVSS scores and CVSS severities

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

20. Cloud Security Rules and Policies

  20.1. Overview

  20.2. Cloud Security Rules

  20.3. Cloud Security Policies

##### Note

* If you have the following Scope Based Access Control (SBAC) settings in place, User Settings > Cases and Issues Scope > Select domains > Posture, you may encounter a Case mismatch in Issues/Cases/Findings counts. This is because the Case count on the Rules page captures Cases belonging to the Posture domain. Whereas Platform pages, capture Issues...

* 20.3.1 |Issues Issues are artifacts of the policy and represent actionable items that you need to address. They have several characteristics, such as: Lifecycle '–' Open, Dismiss, In-progress, Close Workflows '–' Assigned to different user personas for remediation Severity '–' Critical, High, Medium, Low, Info NOTE: A key distinction between Findings and Issues is that Findings are not actionable, while you can take an action on Issues. The Cloud Security Policies page allows you to manage policies that define security and compliance actions for cloud posture. You can create, edit, filter, and manage policies through a structured table and widget panel. The Policies page displays all the configured policies with the following fields. 20.4 |Create Rules You can create your own custom rules for Configuration (Config), Data, and Network Exposure. View all the Cloud Posture Security Rules on the Posture Management > Rules & Policies > Rules > Cloud Security page. 20.4.1 |Create a configuration rule Configuration (config) rules monitor your resource configurations for potential policy violations or misconfigurations. Perform this task to create a custom configuration rule that you can use in a cloud security policy. Navigate to Posture Management → Rules & Policies → Rules → Cloud Security. Select Create Rule > Config. Complete the Overview step: Enter a Rule Name and Description. Select a Severity. This will be the severity of any issues created with this rule. Add Labels (optional). These rules can be used find rules when creating custom policies. Enable Remediation using the toggle (optional). In a later step, you'll enter the remediation instructions. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. Click Next. Complete the Overview step: Enter a Rule Name and Description. Select a Severity. This will be the severity of any issues created with this rule. Add Labels (optional). These rules can be used find rules when creating custom policies. Enable Remediation using the toggle (optional). In a later step, you'll enter the remediation instructions. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. Complete the Rule Logic step to define what the rule is looking for. Select one of the following modes: Simple Mode: Presents a guided interface in which you can define basic conditions and address most common rule use cases. Advanced Mode: Presents a free-form XQL editor that allows you to build complex and flexible queries across unrestricted datasets. Supports advanced and custom use cases. Complete the Rule Logic step to define what the rule is looking for. Select one of the following modes: Simple Mode: Presents a guided interface in which you can define basic conditions and address most common rule use cases. Advanced Mode: Presents a free-form XQL editor that allows you to build complex and flexible queries across unrestricted datasets. Supports advanced and custom use cases. If you selected Simple Mode, complete the following steps: Select options from the dropdown menus to define the logic for your config rule, such as '''Find EC2 instances where accessKeys are allowed'', and then click Search to view all matching results. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Simple Mode, complete the following steps: Select options from the dropdown menus to define the logic for your config rule, such as '''Find EC2 instances where accessKeys are allowed'', and then click Search to view all matching results. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Advanced Mode, complete the following steps: Define an XQL query for the rule, following the guidelines in Guidelines for creating cloud security rules. For detailed information about how use XQL, see Get started with XQL. Click Test to determine if the query is valid. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Check the list of query results to verify that the query is working as intended. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Advanced Mode, complete the following steps: Define an XQL query for the rule, following the guidelines in Guidelines for creating cloud security rules. For detailed information about how use XQL, see Get started with XQL. Click Test to determine if the query is valid. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Check the list of query results to verify that the query is working as intended. (Optional) In the text field, define remediation actions or provide other information that will be included on issues created by this rule. Click Done to save your config rule. 20.4.1.1 |Guidelines for creating cloud security rules NOTE: XQL queries are supported for cloud security configuration rules only. XQL queries are not yet supported for other types of cloud security rules.

  20.4.1.2. Cloud security rule status for custom configuration rules

##### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

  20.4.2. Create a Data Rule

##### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

  20.4.3. Create a Network Exposure Rule

  20.4.4. Edit a Rule

  20.5. Create Policies

##### Note

* When creating Policies, note that Rules with the Informational severity level are excluded.

  20.5.1. Edit a Policy

  20.5.2. Use an Existing Policy to Create a New One

21. Cloud Workload Policies and Rules

##### Prerequisite

* Users need View/Edit RBAC permissions (under Policies → Compute Policies) or the Instance Administrator role to view, edit, and modify Cloud Workload Policies policies.

##### Important

* Users with SBAC granular scoping (in addition to the RBAC permissions required for Cloud Workload Policies) can only view Cloud Workload Policies, when their access is scoped to any of the available options: All assets, No assets, or Select asset groups. For more information on granular scoping, see Manage user scope. When no SBAC restriction is...

  21.1. How policies and rules work together

  21.2. Cloud Workload Policies

##### Note

* Issues are automatically resolved when the finding is no longer applicable to the asset or when the affected asset is removed from the inventory. For more details on Prevent and create issues, see Cloud Workload Preventive Action.

  21.2.1. Types of Cloud Workload Policies

  21.2.1.1. Trusted image cloud workload policies

##### Note

* Registry scanning is for finding problems that are objectively issues regardless of context, organization, or scope. Trust, however, is subjective. Depending on the scope and other factors, an issue may or may not be problematic, and can change over time depending on the context.

* Trusted image policies do not override other policies and their rules, such as malware policies, misconfiguration policies, and secrets policies.

##### Caution

* The default behavior for the prevent action when trust criteria are unavailable is Create an Issue. Be aware that changing this default will mean an incomplete deployment file can block a workload.

  21.2.2. Cloud Workload Policies page

##### Note

* Keep the following caveats in my mind when working with Policies: Instance Administrators are able to view all facets of policies without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be...

  21.2.2.1. Widgets panel

  21.2.2.1.1. Show or hide the widget panel

##### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  21.2.2.2. Change the layout of the policies table

##### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  21.2.2.3. Policy Details Panel

##### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  21.2.3. Enable or disable a Cloud Workload Policy

##### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  21.2.4. Create a Cloud Workload Policy

##### Note

* The Evaluation stage for Misconfiguration policies is supported only in the Runtime SDLC stage and is enforceable through the Kubernetes Admission Controller for clusters on-boarded using the Posture Management (KSPM) Connector.

* Use Create a new Custom Detection Rule to define and add new custom rules as required.

* Each rule may support different actions. While some include both Create an Issue and Prevent and Create an Issue, others provide only the Create an Issue option.

* All non-relevant (non-compute) assets are automatically excluded from the included asset list.

* See Cloud Workload Preventive Action, to learn more about the Prevent action behavior and prerequisites. If the Prevent and create an issue action is selected, the preventive actions in the CI pipeline will trigger a Fail Pipeline by returning an exit code of 2 in the CI tool.

* Choosing this option results in the automatic selection of all other asset scopes in the list.

* See Cloud Workload Preventive Action, to learn more about the Prevent action behavior and prerequisites.

##### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  21.2.5. Use an existing policy to create a new Cloud Workload policy

##### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  21.2.6. Edit a Cloud Workload Policy

##### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  21.2.7. Delete a Cloud Workload Policy

##### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  21.2.8. Cloud Workload Preventive Action

  21.3. Cloud Workload Rules

  21.3.1. Default (pre-defined) Rules

  21.3.2. Custom (user-defined) Rules

  21.3.3. Cloud Workload Rules page

##### Note

* Keep the following caveats in my mind when working with Rules: Instance Administrators are able to view all facets of Rules without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be able...

  21.3.3.1. Filter page results

  21.3.3.2. Change the layout of the rules table

  21.3.3.3. Rule details panel

  21.3.4. Create a new Custom Detection Rule

##### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

##### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

  21.3.5. Use an existing rule to create a new Custom Detection Rule

##### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

  21.3.6. Edit a Custom Detection Rule

##### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

  21.3.7. Delete a Custom Detection Rule

##### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

22. Monitor and track compliance adherence

  22.1. Cortex compliance flow

  22.2. Choose compliance standards from the compliance catalog

##### Navigation

  Cortex provides lists of available standards and controls in the Standards and Controls catalogs under Posture Management → Compliance → Catalogs

  22.2.1. Standards Catalog

  22.2.1.1. Use a built-in or custom standard

  22.2.2. Controls catalog

  22.2.2.1. Use a built-in or custom control

  22.2.2.1.1. Add a custom detection rule to a custom control

##### Note

* Only custom detection rules (not built-in) can be assigned to custom controls.

##### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

  22.2.2.1.2. Create a new Custom Detection Rule

##### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

##### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

  22.3. Use an assessment profile to run compliance checks on your assets

##### Navigation

  Under Posture Management → Compliance → Assessment Profiles, click Create New Assessment

  22.4. View and manage compliance assessments and reports

##### Note

* Compliance assessment results may take up to six hours to be generated.

  22.4.1. Assessments

##### Note

* If there are no rules associated with the control, the control will be assigned a severity of low.

  22.4.2. Reports

##### Navigation

  The Posture Management → Compliance → Results → Reports page shows a table listing compliance assessment report files

  22.5. View the compliance assessment of an individual asset

23. Data management

  23.1. Broker VM

  23.1.1. What is the Broker VM?

  23.1.2. Set up and configure Broker VM

##### Note

* The Broker VM comes with a 512 GB disk. Therefore, deploy the Broker VM with thin provisioning, meaning the hard disk can grow up to 512 GB but will do so only if needed.

* When DHCP is not enabled in your network and there isn't an IP address for your Broker VM, configure the Broker VM with a static IP using the serial console menu.

* When configuring a Local Agent Settings applet with installer and content caching, you need to configure an SSL certificate for the Broker VM as explained in the task below. For more information on specific requirements for the Local Agent Settings applet, see Activate Local Agent Settings. Keep in mind that several Broker VM applets, such as the...

* When a Broker VM is disconnected for more than 30 days, it will have to go through a re-registration process.

* You can configure another Broker VM as a proxy server for this Broker VM by selecting the HTTP type. When selecting HTTP to route Broker VM communication, you need to add the IP Address and Port number (set when activating the Agent Proxy) for another Broker VM registered in your tenant. This designates the other Broker VM as a proxy for this Broker VM.

* The Palo Alto Networks Broker VM supports only strong cipher SHA256-based certificates. MD5/SHA1-based certificates are not supported.

* If adding a CA certificate to the Broker VM is not possible, ensure that you've added the Broker Service FQDNs to the SSL Decryption Exclusion list on your firewalls. See Enable Access to Cortex XDR.

##### Important

* There can be instances in which the Broker VM requires up to 50% of the incoming bandwidth as outgoing. Such instances can be, network instability between the Broker VM and Cortex Cloud, or data that is being collected, but not well compressed.

* The internal network for the Broker VM must be unique and reserved. Other devices should not use the same IP as the Broker VM internal network as it can lead to communication issues with the Broker VM.

* If you use SSL decryption in your firewalls and proxies, see the Understanding CA certificate functionality in Broker VM deployments section below. In addition, verify that the proxies used support HTTP/2, gRPC-specific headers, and HTTP/2 trailers, and the inspection policies support gRPC traffic. Any devices that you use with this configuration...

* When configuring more than one network interface, ensure that only one Default Gateway is defined. The rest must be set to 0.0.0.0, which configures them as undefined. In addition, we recommend assigning each network interface to a different subnet, as oppose to configuring two interfaces on the same subnet which can potentially cause unexpected...

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and earlier, Cortex Cloud will only accept 172.17.0.0/16.

* We strongly recommend disabling SSH connectivity when it's not being used. Therefore, activate SSH connectivity when it's needed and disable it right afterwards. When generating a new SSH key ensure to avoid embedding the domain-style username, by not using any backslashes (\) in the comment field, to ensure the SSH key passes validation.

  23.1.2.1. Broker VM image installations

  23.1.2.1.1. Set up Broker VM on Alibaba Cloud

##### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* For Linux and Windows uploads, you can use Alibaba Cloud's graphical management tool called ossbrowser.

* The Object Storage Service must be created in the same Region as the image of the virtual machine.

##### Navigation

  Hamburger menu → Elastic Compute Service → Instances & Images → Instances

  23.1.2.1.2. Set up Broker VM on Amazon Web Services

##### Prerequisite

* Download a Cortex Cloud Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. You need to set up an AWS VM Import role (vmimport) before you continue with the steps to convert the image as it is required for the import-image CLI command. You can use a different role, if the...

##### Note

* Creating an AMI image can take up to 60 minutes to complete.

* Assigning security groups can take up to 15 minutes.

##### Important

* A t2.medium (4GB RAM) is the lowest machine type that can be used as an instance type. Usually, the lowest machine type is sufficient with the Local Agent Settings applet. Yet, when enabling more applets, 8 GB is required.

##### Navigation

  Log in to the AWS IAM Console, and in the navigation pane, select Access Management → Users → Add Users

  Obtain a registration token from the Cortex Cloud Web Console by selecting Settings → Configurations → Data Broker → Broker VMs → Add Broker → Generate Token

  23.1.2.1.3. Set up Broker VM on Google Cloud Platform (GCP)

##### Prerequisite

* Download a Cortex Cloud Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. To complete the set up, you must have G Cloud installed and have an authenticated user account.

* Before importing a GCP image using the gcloud CLI, ensure that you update the Google Cloud components to version 371.0.0 and above using the following command:

##### Note

* The import tool uses Cloud Build API, which must be enabled in your project. For the import to work, Cloud Build service account must have compute.admin and iam.serviceAccountUser roles. When using the Google Cloud console to import the image, you will be prompted to add these permissions automatically.

  23.1.2.1.4. Set up Broker VM on KVM using Ubuntu

##### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  23.1.2.1.5. Set up Broker VM on Microsoft Azure

##### Prerequisite

* Download a Cortex Cloud Broker VM VHD (Azure) image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* Extraction can take up to a few hours.

* Upload can take up to a few hours.

* For more information, see the Azure Documentation.

* Creating the VM can take up to 15 minutes. The Broker VM Web UI is not accessible during this time.

* For more information on creating a rule in an Azure VM, see Create a Security Rule in the Azure Documentation.

  23.1.2.1.6. Set up Broker VM on Microsoft Hyper-V

##### Prerequisite

* Download a Cortex Cloud Broker VM VHD image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  23.1.2.1.7. Set up Broker VM on Nutanix Hypervisor

##### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* Saving the image to Nutanix hypervisor can take time as it's a large file. We recommend verifying periodically that the connection is alive for the upload process to finish successfully.

* Creating the VM can take up to 15 minutes. The Broker VM Web user interface is not accessible during this time.

  23.1.2.1.8. Set up Broker VM on VMware ESXi using vSphere Client

##### Prerequisite

* Ensure you have a virtualization platform installed that is compatible with an OVA image, and have an authenticated user account. Download a Cortex Cloud Broker VM OVA image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  23.1.2.2. Broker VM data collector applets

##### License Type

  Some data collector applets require the Data Collection add-on.

  23.1.2.2.1. Activate Apache Kafka Collector

##### License Type

  Requires the Data Collection add-on. This data source is only available in your tenant if the tenant was activated before October 1, 2025 with an active Data Collection add-on.

##### Prerequisite

* Apache Kafka version 2.5.1 and above. Kafka cluster set up on premises, from which the data will be ingested. Privileges to manage Broker Service configuration, such as Instance Administrator privileges. Create a user in the Kafka cluster with the necessary permissions and the following authentication details:    Broker Certificate and Private Key for...

##### Note

* For CEF and LEEF logs, Cortex Cloud takes the vendor and product names from the log itself, regardless of what you configure on this page.

  23.1.2.2.2. Activate CSV Collector

##### License Type

  Requires the Data Collection add-on. This data source is only available in your tenant if the tenant was activated before October 1, 2025 with an active Data Collection add-on.

##### Prerequisite

* Set up and configure Broker VM. Ensure that you share the applicable CSV files. Know the complete file path for the Windows directory.

##### Note

* When you implement a wildcard file search, ensure that the CSV files share the same columns and header rows as all other logs that are collected from the CSV files to create a single dataset.

* The CSV Collector checks for new CSV files every 10 minutes.

  23.1.2.2.3. Activate Database Collector

##### License Type

  Requires the Data Collection add-on. This data source is only available in your tenant if the tenant was activated before October 1, 2025 with an active Data Collection add-on.

##### Prerequisite

* Set up and configure Broker VM

##### Note

* The reference data ingested using the DB Collector is counted towards license utilization.

##### Important

* When configuring the DB collector to work with an Oracle database and enabling this option, ensure the following steps are completed for a successful connection: Ensure you have the certificate of the Database server. Upload certificate to Broker CA Trust Store (Conditional): This step is only required if the Oracle server's certificate is self-signed...

  23.1.2.2.4. Activate DSPM Fileshare

##### Prerequisite

* Set up and configure Broker VM Know the complete path to the files and folders that you want Cortex Cloud to monitor. Necessary user permissions to access the network shares. For the SMB connection type, you need the user name and password.

##### Note

* The applet list displays only the applets for which you have permissions.

* By default, all configured connections are saved.

* For details regarding the connection fields, see the table above under File Share Connection.

* You can add multiple connections under a single instance of the DSPM Fileshare applet by returning to the File Share Connection screen and clicking Add Connection. Each new connection can be of either the NFS or SMB connection type.

  23.1.2.2.5. Activate Files and Folders Collector

##### License Type

  Requires the Data Collection add-on. This data source is only available in your tenant if the tenant was activated before October 1, 2025 with an active Data Collection add-on.

##### Prerequisite

* Set up and configure Broker VM. Know the complete path to the files and folders that you want Cortex Cloud to monitor. Ensure that the user permissions for the network share include the ability to rename and delete files in the folder that you want to configure collection.

##### Note

* Cortex Cloud only supports ingestion of files encoded in UTF-8 format.

* When using the Linux file share, including the Linux share with NFS, a Username and Password are not required, so these fields are grayed out in the screen.

* In Batch mode, the Files and Folders Collector supports collecting logs from a network share for a maximum file size of 500 MB.

* When uploading JSON files, Cortex Cloud only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* When the storing method is Replace, the maximum size for the total data to be imported into a lookup dataset is 30 MB each time the data is fetched. The inventory data ingested using the Files and Folders collector is counted towards license utilization. When you use a JOINT function with a lookup table in a query or correlation rule, make sure you...

* You can't specify a file name that's the same as a system file name. The name of a dataset created from a tsv file must always include the extension. If the original file name is mrkdptusrsnov23.tsv, you can name save the dataset with the name marketing_dept_users_Nov_2023.tsv.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

  23.1.2.2.6. Activate FTP Collector

##### License Type

  Requires the Data Collection add-on. This data source is only available in your tenant if the tenant was activated before October 1, 2025 with an active Data Collection add-on.

##### Prerequisite

* Set up and configure Broker VM. Ensure that the user permissions for the FTP, SFTP, or FTPS include the ability to rename and delete files in the folder that you want to configure collection. When setting up an FTPS Collector with a server using a Self-signed certificate, you must upload the certificate first to the Broker VM as a Trusted CA...

##### Note

* When configuring an SFTP connection, Cortex Cloud expects the private key to be in the RSA format that is included in the -----BEGIN RSA PRIVATE KEY----- tag. Cortex Cloud does not support providing the private key in the OpenSSH format from the -----BEGIN OPENSSH PRIVATE KEY----- tag. When using ssh-keygen using a Mac, you get the OpenSSH format by...

* When uploading JSON files, Cortex Cloud only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

  23.1.2.2.7. Activate Local Agent Settings

##### Note

* This is assuming a standard hardware setup with 2vCPU 8 GB memory.

* Broker VMs can act as as a proxy for routing XDR Collector traffic to the Cortex Cloud tenant. The Broker VM does not cache XDR Collector installers.

* When you install your XDR agents, you need to configure the IP address of the Broker VM and a port number during the installation. You can use the default 8888 port or set a custom port. You are not permitted to configure port numbers between 0-1024 and 63000-65000, or port numbers 4369, 5671, 5672, 5986, 6379, 8000, 9100, 15672, 25672. Additionally,...

##### Important

* A FQDN must be configured for Agent Installer and Content Caching to function properly.

* You can only enable Agent Installer and Content Caching, when in the Broker VM Configuration, you've uploaded your signed SSL Server Certificate and key and set the FQDN. For more information, see the Agent Installer and Content Caching requirements explained above.

  23.1.2.2.8. Activate Files and Folders Collector

##### License Type

  Requires the Data Collection add-on. This data source is only available in your tenant if the tenant was activated before October 1, 2025 with an active Data Collection add-on.

##### Prerequisite

* Set up and configure Broker VM. Know the complete path to the files and folders that you want Cortex Cloud to monitor. Ensure that the user permissions for the network share include the ability to rename and delete files in the folder that you want to configure collection.

##### Note

* Cortex Cloud only supports ingestion of files encoded in UTF-8 format.

* When using the Linux file share, including the Linux share with NFS, a Username and Password are not required, so these fields are grayed out in the screen.

* In Batch mode, the Files and Folders Collector supports collecting logs from a network share for a maximum file size of 500 MB.

* When uploading JSON files, Cortex Cloud only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* When the storing method is Replace, the maximum size for the total data to be imported into a lookup dataset is 30 MB each time the data is fetched. The inventory data ingested using the Files and Folders collector is counted towards license utilization. When you use a JOINT function with a lookup table in a query or correlation rule, make sure you...

* You can't specify a file name that's the same as a system file name. The name of a dataset created from a tsv file must always include the extension. If the original file name is mrkdptusrsnov23.tsv, you can name save the dataset with the name marketing_dept_users_Nov_2023.tsv.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

  23.1.2.2.9. Activate NetFlow Collector

##### License Type

  Requires the Data Collection add-on.

##### Prerequisite

* Set up and configure Broker VM

##### Note

* Since multiple network devices can send data to a single NetFlow Collector, we recommend that you configure a maximum of 50 NetFlow Collectors per Broker VM applet, with a maximum aggregated rate of approximately 50K flows per second (FPS) to maintain system performance.

* Since Cortex Cloud reserves some port numbers, it is best to select a port number that is not in the range of 0-1024 (except for 514), in the range of 63000-65000 or has one of the following values: 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672.

* The options available change, according to the set Source Network value.

  23.1.2.2.10. Activate Network Mapper

##### Prerequisite

* After you have configured and registered your Broker VM, you can choose to activate the Network Mapper application.

##### Note

* Each IP address range can receive multiple scan requests based on it's availability.

* IP address ranges are displayed according to what you defined as your Network Parameters.

  23.1.2.2.11. Activate Registry Scanner

##### Prerequisite

* To initialize registry scanning on your Broker VM, you must first add the necessary data connectors. For details, see:    Connect Docker Hub registry   Connect Docker V2 compliant container registry   Connect GitLab container registry   Connect Harbor registry   Connect JFrog container registry   Connect Sonatype Nexus registry To initialize registry...

##### Note

* You cannot activate the Registry Scanner directly on a new or existing Broker VM. You can only activate or deactivate existing Registry Scanner applets. To activate or deactivate existing applets, see Step 4 under Verify Registry Scanner connection section.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  23.1.2.2.12. Activate Syslog Collector

##### License Type

  Requires the Data Collection add-on.

##### Prerequisite

* Set up and configure Broker VM

##### Note

* Once configured, you cannot change the Port/PROTOCOL. If you don't want to use a data source, ensure to remove the data source from the list as explained in Task 5.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. For a Log Format set to CEF or LEEF, Cortex Cloud reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex Cloud uses these values even if you specified a value in the Vendor and...

* The server certificate and private key pair is expected in a PEM format. Cortex Cloud will notify you when your certificates are about to expire.

* Because some port numbers are reserved by Cortex Cloud , you must choose a port number that is not: In the range of 0-1024 (except for 514) In the range of 63000-65000 Values of 4052, 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672

* CORELIGHT is not available for a UDP protocol.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  23.1.2.2.12.1. Activate Windows Event Collector on Windows Core

##### License Type

  Requires the Data Collection add-on.

##### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

##### Note

* By default, Cortex Cloud collects Palo Alto Networks predefined Security events that are used by the Cortex Cloud detectors. Removing the Security collector interferes with the Cortex Cloud detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

  23.1.2.2.13. Activate Windows Event Collector

##### License Type

  Requires the Data Collection add-on.

##### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

##### Note

* You can also activate the Windows Event Collector on Windows Core. For more information, see Activate Windows Event Collector on Windows Core.

* By default, Cortex Cloud collects Palo Alto Networks predefined Security events that are used by the Cortex Cloud detectors. Removing the Security collector interferes with the Cortex Cloud detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

  23.1.2.2.13.1. Activate Windows Event Collector on Windows Core

##### License Type

  Requires the Data Collection add-on.

##### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

##### Note

* By default, Cortex Cloud collects Palo Alto Networks predefined Security events that are used by the Cortex Cloud detectors. Removing the Security collector interferes with the Cortex Cloud detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

  23.1.2.2.13.2. Renew WEC certificates

##### License Type

  Requires the Data Collection add-on.

##### Note

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* You can see more than one ca.wec.paloaltonetworks.com and forwarder.wec.paloaltonetworks.com file from a previous installation in the directory, so select the file with the most extended Expiration Date. You can verify that you are using the correct certificate: To verify the client certificate in the Personal → Certificates folder is related to the...

* Only perform this step under the following conditions: You have completed the WEF certification renewal process for ALL clients in your environment. Otherwise, events from the WEFs that you did not install the new client certificate will not be collected by the WEC. You are approaching the WEC server CA certificate expiration date, which is 2 years...

* If this query does not display results with a timestamp from after the renewal process, it could indicate that the renewal process is not complete, so wait a few minutes before running another query. If you are still having a problem, contact Technical Support.

##### Important

* After you receive a notification for renewing your WEC CA certificate, we recommend that you do not add any new WEF clients until the WEC certification renewal process is complete. Events from these WEF clients that are added afterwards will not be collected by the server until the WEC certificates are renewed.

  23.1.3. Manage Broker VM

##### Note

* For more information on troubleshooting errors and warnings for these broker applets, see Troubleshoot Broker VM applet errors.

* Certain fields are also exposed in the Clusters tab, when a Broker VM node is added to a High Availability (HA) cluster, and each cluster node is expanded to view the Broker VM nodes table. An asterisk (*) is beside every field that is also included in the Broker VM nodes table for each HA cluster.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  23.1.3.1. Edit Broker VM Configuration

##### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and lower, Cortex Cloud accepts only 172.17.0.0/16.

* Make sure you save the password before closing the window. The only way to re-generate a password is to disable ssh and re-enable.

  23.1.3.2. Increase Broker VM storage allocated for data caching

##### Note

* Follow your hypervisor documentation to understand how to add a persistent disk storage to your VM.

* If your disk is not listed and you didn't shutdown your Broker VM in your hypervisor before manually adding a disk to the VM, you'll need to reboot the Broker VM before the disk details are detected by the Broker VM. This can be performed either in the hypervisor or directly in the Broker VMs page.

##### Warning

* This operation is irreversible, and will make the disk become an integral part of the broker, where disconnecting the disk will result in errors and data loss.

  23.1.3.3. Monitor Broker VM using Prometheus

##### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* For more information on Docker, see the Docker website.

  23.1.3.4. Collect Broker VM Logs

##### Note

* The Download Logs (<TIMESTAMP>) is only displayed when you've downloaded your logs previously using Generate New Logs.

  23.1.3.5. Upgrade Broker VM

##### Important

* After a Broker VM upgrade, your broker may require a reboot to finish installing important updates. A notification about this will be sent to your Cortex Cloud console Notification Center.

  23.1.3.6. Import Broker VM Configuration

##### Important

* This option can only be used on Broker VMs with version 20.0 and later, and is only suitable for importing a configuration of brokers in the same version, or from a broker in an older version to a broker in a newer version.

* If your source Broker VM configuration includes a WEC applet, you'll need to ensure that you update the DNS record of this Broker VM's FQDN to point to the target Broker VM IP address.

  23.1.3.7. Open Live Terminal

##### Note

* You can either restart_routes or reboot the Broker VM for the changes in the /etc/network/routes file to take affect.

  23.1.3.8. Add Broker VM to cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  23.1.3.9. Switchover Primary Node in Cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  23.1.3.10. Remove from Cluster

##### Note

* If you've enabled a Load Balancer Health-Check on the cluster, you need to exclude this Broker VM from your Load Balancer settings.

  23.1.4. Manage Broker VM data collector applets

##### Note

* For more information on the Broker VM applet connectivity status, see Manage Broker VM.

  23.1.4.1. Activate DSPM Fileshare

##### Prerequisite

* Set up and configure Broker VM Know the complete path to the files and folders that you want Cortex Cloud to monitor. Necessary user permissions to access the network shares. For the SMB connection type, you need the user name and password.

##### Note

* The applet list displays only the applets for which you have permissions.

* By default, all configured connections are saved.

* For details regarding the connection fields, see the table above under File Share Connection.

* You can add multiple connections under a single instance of the DSPM Fileshare applet by returning to the File Share Connection screen and clicking Add Connection. Each new connection can be of either the NFS or SMB connection type.

  23.1.5. Broker VM High Availability Cluster

##### Note

* For Load Balancing, you must install a Load Balancer in your network, which will distribute the incoming data between the nodes.

* The following applets aren't supported when configuring Broker VMs in HA clusters: Cortex Network Scanner and Transporter.

  23.1.5.1. Configure High Availability Cluster

##### Prerequisite

* Be sure you do the following task before creating a cluster from an existing Broker VM: If the Broker VM is explicitly specified in some Agent Settings profile, which means Cortex Cloud agents retrieve release upgrades and content updates from this Broker VM, you must change the Broker VM's current designated role. To do this, you need to modify the...

##### Important

* You can only create a new cluster from an existing Broker VM, when the Broker VM version is 19.0 and later, and the STATUS is Connected. The Create a Cluster from this Broker option is only listed if the Broker VM is not already added to a cluster.

* When the Protocol is set to HTTPS, you may need to perform a few follow-up steps to establish a validated secure SSL connection with the Broker VM. If you're using your own Certificate Authority (CA) to sign the certificates, you'll need to place the CA in the client, such as the Load Balancer, and upload the certificates to the Broker VM. If you're...

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  23.1.5.2. Manage Broker VM clusters

##### Navigation

  After you've configured a cluster, you can manage all your Broker VM clusters from the Clusters tab on the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs → Clusters

  23.1.5.2.1. View cluster details

##### Note

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

##### Navigation

  The Clusters tab of the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs) enables you

  23.1.5.2.2. Edit cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs, and select the Clusters tab

  23.1.5.2.3. Add applet to cluster

##### Note

* With Cortex XDR Prevent, it's only relevant to configure a HA cluster with a Local Agent Settings applet as this is the only applet supported for this product license. The other applets are collector applets, which are only available in Cortex XDR Pro or Cortex XSIAM.

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

  23.1.5.2.4. Add Broker VM to cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  23.1.5.2.5. Remove cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  23.1.6. Broker VM notifications

  23.1.7. Monitor Broker VM activity

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  23.1.8. Troubleshoot Broker VM applet errors

  23.2. XDR Collectors

##### Note

* Ingestion of log events larger than 5 MB is not supported.

  23.2.1. XDR Collector audit logs

##### License Type

  Requires the Data Collection add-on.

  23.2.2. XDR Collector machine requirements and supported operating systems

##### License Type

  Requires the Data Collection add-on.

  23.2.3. Resources required to enable access to XDR Collectors

##### License Type

  Requires the Data Collection add-on.

##### Note

* Some of the IP addresses required for access are registered in the United States. As a result, some GeoIP databases do not correctly pinpoint the location in which IP addresses are used. All customer data is stored in your deployment region, regardless of the IP address registration and restricts data transmission through any infrastructure to that...

* Throughout this topic, refers to the chosen subdomain of your Cortex Cloud tenant and <region> is the region in which your Strata Logging Service is deployed.

  23.2.4. Manage XDR Collectors

##### License Type

  Requires the Data Collection add-on.

  23.2.4.1. XDR Collectors installation resource for Windows and Linux

##### License Type

  Requires the Data Collection add-on.

##### Note

* In some circumstances, such as after an XDR Collectors upgrade, the configured settings in the XML configuration file can be erased. Yet, this won't affect the saved settings in the XDR Collectors database.

  23.2.4.2. Create an XDR Collector installation package

##### License Type

  Requires the Data Collection add-on.

##### Note

* XDR Collectors cannot be moved between Cortex Cloud managing servers. In this situation, you need to uninstall the existing collector, and then install a new collector using an installation package from the new managing server. For more information on uninstalling, see Uninstall the XDR Collector.

* Since Cortex Cloud relies on the installation package ID to approve XDR Collector registration during install, it is not recommended to delete the installation package for any active on-premise collector machines. Hiding the installation package will remove it from the default list of available installation packages, and can be useful to eliminate...

  23.2.4.3. Install the XDR Collector installation package for Windows

##### License Type

  Requires the Data Collection add-on.

  23.2.4.3.1. Install the XDR Collector on Windows using the MSI

##### Note

* When the package is executed using the MSI, an installation log is generated in %TEMP%\MSI<Random characters>.log by default.

* If the XDR Collector does not connect to Cortex Cloud, verify your internet connection on the collector machine. If the XDR Collector still does not connect, verify that the installation package has not been removed from the Cortex Cloud tenant.

  23.2.4.3.2. Install the XDR Collector on Windows using Msiexec

  23.2.4.4. Install the XDR Collector installation package for Linux

##### License Type

  Requires the Data Collection add-on.

##### Note

* We recommend that you perform a Linux RPM or Linux DEB installation.

* If the XDR Collector does not connect to Cortex Cloud, verify your Internet connection on the collector machine. If the XDR Collector still does not connect, verify the installation package has not been removed from the Cortex Cloud management console.

* The XDR Collector does not support proxy communication in environments where proxy authentication is required.

##### Important

* When performing a XDR Collector installation or upgrade in Linux using a shell installer, the  /tmp folder cannot be marked as noexec. Otherwise, the installation or upgrade fails. As a workaround, before the installation or upgrade, use the following command:

  23.2.4.5. Configure the XDR Collector upgrade scheduler

##### License Type

  Requires the Data Collection add-on.

##### Navigation

  In Cortex Cloud, select Settings → Configurations → XDR Collectors → Configuration

  23.2.4.6. Set an application proxy for XDR Collectors

##### License Type

  Requires the Data Collection add-on.

##### Navigation

  In Cortex Cloud, select Settings → Configurations → XDR Collectors → Administration

  23.2.4.7. Set an alias for an XDR Collector machine

##### License Type

  Requires the Data Collection add-on.

##### Navigation

  Settings → Configurations → XDR Collectors → Administration

  23.2.4.8. Upgrade XDR Collectors

##### License Type

  Requires the Data Collection add-on.

##### Note

* The XDR Collector keeps the name of the original installation package after every upgrade.

  23.2.4.9. Uninstall the XDR Collector

##### License Type

  Requires the Data Collection add-on.

##### Navigation

  Settings → Configurations → XDR Collectors → Administration

  Investigation & Response → Response → Action Center

  23.2.5. Define XDR Collector machine groups

##### License Type

  Requires the Data Collection add-on.

##### Note

* XDR Collectors only support IPv4 addresses.

* Disconnecting Directory Sync in your Cortex Cloud deployment can affect existing collector machine groups and policy rules based on Active Directory properties.

  23.2.6. About Cortex XDR Collector content updates

##### License Type

  Requires the Data Collection add-on.

  23.2.7. XDR Collector profiles

##### License Type

  Requires the Data Collection add-on.

  23.2.7.1. Add an XDR Collector profile for Windows

##### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex Cloud collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex Cloud supports logs in single line format or multiline format. For more...

  23.2.7.1.1. Ingest logs from Windows DHCP using Elasticsearch Filebeat

##### Note

* Although this enrichment is available when configuring a Windows DHCP collector for a cloud data collection integration, we recommend configuring Cortex Cloud to receive Windows DHCP logs with an XDR Collector Windows Filebeat profile, because it is simpler to set up.

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the template provided by Cortex Cloud to make your customizations. We recommend that you edit the file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating your...

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the example file provided by Cortex Cloud to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your filebeat.yml file. Validate the syntax of the YML file before you finish creating...

* The tokenizer definition is dependent on the Windows server version that you are using, because the log format differs. For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%...

  23.2.7.1.2. Ingest Windows DNS debug logs using Elasticsearch Filebeat

##### Note

* Detailed logs are significantly larger, because more information is added to the logs.

* To avoid formatting issues in your filebeat.yml file, we recommend that you validate the syntax of the file.

  23.2.7.2. Add an XDR Collector profile for Linux

##### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex Cloud collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex Cloud supports logs in single line format or multiline format. For more...

  23.2.8. Apply profiles to collection machine policies

##### License Type

  Requires the Data Collection add-on.

##### Navigation

  Settings → Configurations → XDR Collectors → Policies → +Add Policy

  23.2.9. XDR Collector datasets

##### License Type

  Requires the Data Collection add-on.

  23.2.10. Troubleshoot XDR Collectors errors

  23.3. Data Ingestion

##### License Type

  Requires the Data Ingestion add-on

  23.3.1. Visibility of logs and issues from external sources

##### License Type

  Data collection may require an add-on.

##### Note

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs.

* Logs with sessionid = 0 are dropped.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. IOCs and BIOCs are only generated for these event types: sso and session_start.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. Analytics, IOCs and BIOCs are only generated on the Firewall data. The Zscaler Nanolog Streaming Service (NSS) feed for web logs is only used for Correlation Rules and threat hunting.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. The Zscaler Nanolog Streaming Service (NSS) feed for web logs is only used for Correlation Rules and threat hunting.

  23.3.2. Visibility of Cortex Cloud audit and authentication logs

##### Note

* Cortex Cloud can create Cortex Cloud issues (Analytics, IOC, BIOC, and Correlation Rules) when relevant from logs.

  23.3.3. External data ingestion vendor support

##### License Type

  Data collection may require an add-on.

  23.3.4. Manage instances

  23.3.4.1. How to configure the scanning settings for supported services

##### Note

* If you do not select a scanning cadence, the default setting is applied. For more information, contact your Customer Support team.

  23.3.4.2. Manage cloud instances

##### Note

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  23.3.4.3. Update cloud permissions after Cortex release updates

##### Prerequisite

* Ensure that the user account used to modify permissions has the necessary privileges within both the Cortex platform and your cloud environment, for example, AWS or Azure. You received a notification regarding a new version available that requires permission updates, or viewed a Needs Update status in the Data Sources & Integrations page.

##### Note

* Instances requiring updates will not change their connection status, for example, Connected, Warning, Error, Disabled, due to the pending permission update.

  23.3.4.4. Pending cloud instances

  23.3.4.5. Manage Kubernetes Connector instances

##### Note

* After uninstalling the Kubernetes connector, the connector status updates to Not connected 48 hours after the uninstall process is initiated.

##### Navigation

  You can also manage the Kubernetes Connector instances from Inventory → Assets → Kubernetes Clusters

  23.3.5. Palo Alto Networks integrations

##### License Type

  Data collection may require an add-on.

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

  23.3.5.1. About Palo Alto Networks integrations

##### Note

* For Palo Alto Networks Integrations there is an option to turn on or off the collection of URL and File log types. For more information, see Collecting URL and File log types.

* Roll-back of Strata Logging Service integration migration is not supported.

  23.3.5.2. Ingest data from Next-Generation Firewall

##### Prerequisite

* Ensure that you have completed the following on the NGFW or Panorama side: For Panorama only, ensure that the Panorama Cloud Services plugin is installed. Enable log forwarding profiles on firewall rules. On the Cortex Cloud side, ensure that you have user role permissions for Data Collection > Data Sources & Integrations. Configuration of data...

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* If your firewalls are located in a different region, or bandwidth issues are encountered due to large log size, you can ingest NGFW logs in CEF format, using the Syslog collector. However, the Syslog solution is not as powerful nor as comprehensive as this data collector, and should only be used when this data collector cannot be used. For more...

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version.

* Cortex Cloud does not validate your firewall credentials, you must ensure the certificates or PSK details have been updated in your firewalls in order for data to stream.

* It can take an hour or longer after connecting the firewall in Cortex Cloud until you start seeing notifications that the certificate has been approved, and that the logging service license has appeared on the firewall.

* IOC and BIOC issues are applicable on stitched data only, and are not available on raw data.

##### Tip

* You can see an overview of ingestion status for all log types, and a breakdown of each log type and its daily consumption quota on the NGFW Ingestion Dashboard.

  23.3.5.2.1. Ingest Next-Generation Firewall logs using the Syslog collector

##### Note

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version, to ensure that you have configured log forwarding correctly for all the log types that you would like to forward to Cortex Cloud. The following steps only cover...

* To avoid the possible effects of line formatting, do not copy/paste the message formats directly into the PAN-OS web interface. Instead, paste into a text editor, remove any carriage return or line feed characters, and then copy and paste into the web interface.

* From version 10.0 and later, the log format documented for log types (Traffic, Threat, and URL) exceeds the maximum supported 2048 characters in the Custom Log Format tab on the firewall and Panorama. Select the CEF keys and values to limit the number of characters to 2048, as per your requirements.

  23.3.5.3. Ingest data from Prisma Access

##### Prerequisite

* Configuration of data ingestion from multiple accounts requires Super User permissions in both Cortex Cloud tenant and Prisma Access accounts.

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* Cortex Cloud does not validate your Prisma Access account credentials. You must ensure the account has been deployed in order for data to stream.

  23.3.5.4. Ingest logs from Prisma Access Browser

  23.3.5.5. Ingest detection data from Strata Logging Service

##### Note

* IOC and BIOC issues are applicable on stitched data only and are not available on raw data.

  23.3.5.6. Ingest alerts and assets from IoT Security

  23.3.5.7. Collecting URL and File log types

  23.3.6. External data ingestion

  23.3.6.1. Ingest network connection logs

  23.3.6.1.1. Ingest network Route 53 logs from Amazon S3

##### Note

* For more information on configuring data collection from Amazon S3 for Route 53 DNS logs, see the AWS Documentation.

* For more information on creating a Stack, see Creating a stack on the AWS CloudFormation console.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex Cloud.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex Cloud.

  23.3.6.1.2. Ingest logs from Check Point firewalls

##### Note

* Logs with sessionid = 0 are dropped. Destination Port data is available only in the raw logs.

  23.3.6.1.3. Ingest logs from Cisco ASA firewalls and AnyConnect

  23.3.6.1.4. Ingest logs from Corelight Zeek

  23.3.6.1.5. Ingest logs from Fortinet Fortigate firewalls

  23.3.6.1.6. Ingest logs from Microsoft Azure Event Hub

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex Cloud, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

##### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex Cloud reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex Cloud uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

##### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  23.3.6.1.7. Ingest logs and data from Okta

##### Prerequisite

* Administrator privileges: Your Okta user must have a role capable of creating API tokens, such as Read-only Administrator, Super Administrator, or Organization Administrator. For more information, see the Okta Administrators Documentation.

  23.3.6.1.8. Ingest logs from Zscaler Internet Access

  23.3.6.1.9. Ingest logs from Zscaler Private Access

##### Note

* For more information on configuring the parameters on the screen, see the Zscaler Private Access (ZPA) documentation for Configuring a Log Receiver.

* You can only configure a ZPA log receiver to collect one type of log with your Syslog Collector in Cortex Cloud. To configure more that one log type, you'll need to add another log receiver.

  23.3.6.2. Ingest authentication logs and data

  23.3.6.2.1. Ingest authentication logs and data from PingOne

##### Navigation

  Reporting → Subscriptions → Add Subscription

  23.3.6.2.2. Ingest audit logs from AWS Cloud Trail

##### Note

* For more information on configuring data collection from Amazon S3 using AWS CloudTrail, see the AWS CloudTrail Documentation.

* For more information on creating an AWS CloudTrail trail, see Create a trail. If you already have an Amazon S3 bucket configured with AWS CloudTrail audit logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* It is your organization's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* The CloudWatch Logs - optional settings are not supported and should be left disabled.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It your organization's responsibility to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex Cloud.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex Cloud.

  23.3.6.2.3. Ingest logs and data from Google Workspace

##### Note

* For all types of data collected via the Admin Reports API, except alerts and emails, the log events are collected with a preset lag time as reported by Google Workspace. For more information on these lag times for the different types of data, see Google Workspace Data retention and lag times.

* Spam emails from the compliance email account, and from all other monitored email accounts, are not collected. Any draft emails written in the compliance email account are collected by the Google Workspace data collector, and are then deleted even if the email was never sent.

* For more information on the entire process, see Perform Google Workspace Domain-Wide Delegation of Authority.

* When collecting Google Workspace alerts with other types of data, except emails, you need to configure a service account in Google with the applicable permissions to collect events from the Google Reports API and alerts from the Alert Center API. If you prefer to use different service accounts to collect events and alerts separately, you'll need to...

* For more information on the Admin Reports API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information on the Gmail API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information about the events collected from the various Google Reports, see Google Workspace Reports API Documentation.

  23.3.6.2.4. Ingest logs from Microsoft Azure Event Hub

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex Cloud, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

##### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex Cloud reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex Cloud uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

##### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  23.3.6.2.5. Ingest logs from Microsoft Office 365

##### License Type

  Requires the ITDR Module add-on. Requires the Data Collection add-on for viewing alerts and Azure AD Activity Logs.

##### Note

* Ingesting Microsoft Entra ID (formerly known as Azure AD) authentication and audit events from Microsoft Graph API requires a Microsoft Entra ID P1 or P2 license (formerly Azure Active Directory Premium P1 or P2). Alternatively, if the directory type is Azure AD B2C, the sign-in reports are accessible through the API without any additional license...

* When auditing is turned off from the default setting, you need to first turn on auditing for your organization to collect Microsoft Office 365 audit events from the Management Activity API. Log duplication of up to 5% in Microsoft products is considered normal. In some cases, such as login to a portal using MFA, two log entries are recorded by design.

* To address Azure reporting latency, there is a 10-minute latency period for Cortex Cloud to receive Azure AD logs.

* For more information, see the Office 365 Management Activity API schema.

* In FedRAMP environments, Azure sign-in logs are not supported, due to vendor technical constraints.

* Use this option when you don't want to grant permissions for Azure AD Authentication and Azure AD Audit.

  23.3.6.2.6. Ingest logs and data from Okta

##### Prerequisite

* Administrator privileges: Your Okta user must have a role capable of creating API tokens, such as Read-only Administrator, Super Administrator, or Organization Administrator. For more information, see the Okta Administrators Documentation.

  23.3.6.2.7. Ingest logs and data from OneLogin

##### Note

* Event data is collected every 30 seconds.

* Inventory data snapshots are collected every 10 minutes.

  23.3.6.2.8. Ingest authentication logs from PingFederate

  23.3.6.3. Ingest operation and system logs from cloud providers

  23.3.6.3.1. Ingest generic logs from Amazon S3

##### License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

##### Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* You need to set up an Amazon S3 data collector to receive generic logs when collecting logs from BeyondTrust Privilege Management Cloud. For more information, see Ingest logs from BeyondTrust Privilege Management Cloud.

* It is the customer's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It is the responsibility of your organization to ensure that the user who performs this task of creating the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex Cloud.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex Cloud.

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex Cloud reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex Cloud uses these values even if you specified a value in the Vendor...

  23.3.6.3.2. Ingest logs and data from a GCP Pub/Sub

##### License Type

  Requires the Cloud Runtime add-on.

##### Note

* When collecting flow logs, we recommend that you include GKE annotations in your logs, which enable you to view the names of the containers that communicated with each other. GKE annotations are only included in logs if appended manually using the custom metadata configuration in GCP. For more information, see VPC Flow Logs Overview. In addition, to...

* For a Log Format set to CEF or LEEF, Cortex Cloud reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex Cloud uses these values even if you specified a value in the Vendor and Product fields in the GCP data collector settings. Yet, when the values are blank in the...

  23.3.6.3.3. Ingest logs from Google Kubernetes Engine

##### Note

* Cortex Cloud supports logs in single line format or multiline format. For more information on handling messages that span multiple lines of text in Elasticsearch Filebeat, see Manage Multiline Messages.

  23.3.6.3.4. Ingest logs from Microsoft Azure Event Hub

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex Cloud, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

##### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex Cloud reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex Cloud uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

##### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  23.3.6.3.5. Ingest logs and data from Okta

##### Prerequisite

* Administrator privileges: Your Okta user must have a role capable of creating API tokens, such as Read-only Administrator, Super Administrator, or Organization Administrator. For more information, see the Okta Administrators Documentation.

  23.3.6.4. Ingest cloud assets

##### Note

* The cloud accounts being onboarded must be owned by the customer performing the onboarding process.

  23.3.6.4.1. Onboard Amazon Web Services

##### Prerequisite

* Ensure you have access to AWS Management Console. Ensure you have the Required AWS permissions.

##### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* When onboarding an AWS organization or organizational unit (OU), Cortex Cloud creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

  23.3.6.4.1.1. Manually upload template to AWS

##### Prerequisite

* Before you begin, ensure you have: An AWS account Access to AWS Management Console Permission to create a stack and its resources in AWS CloudFormation

##### Note

* You must ensure that the KMS key region and the SNS topic region are the exact same as the AWS region where you are deploying the CloudFormation stack.

  23.3.6.4.2. Onboard Google Cloud Platform

##### Prerequisite

* Ensure you have cccess to Google Cloud Console. Ensure you have an admin user with the required admin GCP permissions. Ensure you have the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled)   If you plan on enabling Automation as...

##### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* If you want to connect to your GCP Workspace, you must first complete onboarding with the option disabled. Once the GCP cloud instance is created, perform the steps detailed in Connect Google Workspace with your GCP cloud instance.

  23.3.6.4.2.1. Manually upload template to GCP

##### Prerequisite

* Before you begin, ensure you have: A GCP account. Permission to create the required resources in Google Cloud Deployment Manager. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool. Reviewed the...

##### Note

* The directory you create must be a subdirectory of the home directory.

##### Important

* You must not delete or move the Terraform files from this folder. It will prevent you from being able to edit your cloud instance in the future.

  23.3.6.4.2.2. Connect Google Workspace with your GCP cloud instance

##### Prerequisite

* Ensure you have the Super Admin role in Google Workspace.

* Ensure you have the organization ID of the Google Workspace you want to connect:    Log in to your Google Admin Console. and navigate to Account → Account settings → Profile. Next to Customer ID is your organization ID. Ensure you have the organization ID of the Google Workspace you want to connect: Log in to your Google Admin Console. and navigate...

  23.3.6.4.2.3. Configure GCP integration instances and monitor integration instance health

##### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  23.3.6.4.2.4. Monitor GCP resources inside service perimeters

##### Note

* Each GCP cloud instance is assigned a scope within GCP. If the scope, whether it be organization, folder, or project, includes any projects with a service perimeter, this procedure must be performed for that cloud instance to authorize Cortex Cloud to scan the resources in the perimeter.

  23.3.6.4.3. Onboard Microsoft Azure

##### Prerequisite

* Ensure you have a Microsoft Azure subscription. Ensure you have the admin permissions required to onboard Microsoft Azure or the built-in Security Administrator role. Obtain the tenant ID and subscription ID. You can view these in the Microsoft Azure Portal in Management groups.

  23.3.6.4.3.1. Manually upload template to Microsoft Azure

##### Prerequisite

* Before you begin, ensure you have: An Azure subscription. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the Azure CLI...

##### Important

* You must not delete or move the Terraform files from this folder. It will prevent you from being able to edit your cloud instance in the future.

  23.3.6.4.3.2. Manually upload template to Microsoft Azure Resource Manager using the CLI

##### Prerequisite

* Ensure the Azure CLI tool is installed and you are authorized to create management group policies.

  23.3.6.4.4. Onboard Oracle Cloud Infrastructure

##### Prerequisite

* Ensure you have access to the Oracle Cloud Infrastructure console Permissions for all of the following are required:    Creation of identity groups (for more information, refer to Managing Groups)   Policies (for more information, refer to How Policies Work)   Tag namespaces in the root compartment (for more information, refer to Tags and Tag Namespace...

##### Note

* Excluded compartments are not visible in Cortex Cloud. Additional Security Capabilities: Enable additional Cortex Cloud security add-ons, if available. This may require additional cloud provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. The additional security capabilities you can enable include: Data security posture management: An agentless multi-cloud data security solution that discovers, classifies, protects, and governs sensitive data. Serverless functions scanning (Gen 1 only): Implement serverless scanning to detect and remediate vulnerabilities within serverless functions during the development lifecycle. Seamless integration into CI/CD pipelines enables automated security scans for a continuously secure pre-production environment. Registry scanning: Scan container registry images for vulnerabilities. malware, and secrets. You can configure your initial preference for scanning your registry. Any newly discovered registry, repository, or image in the account will be scanned by default. For more details, see Configure registry scanning for cloud accounts Agentless disk scanning: (Recommended) Implement agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Additional Security Capabilities: Enable additional Cortex Cloud security add-ons, if available. This may require additional cloud provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. The additional security capabilities you can enable include: Data security posture management: An agentless multi-cloud data security solution that discovers, classifies, protects, and governs sensitive data. Serverless functions scanning (Gen 1 only): Implement serverless scanning to detect and remediate vulnerabilities within serverless functions during the development lifecycle. Seamless integration into CI/CD pipelines enables automated security scans for a continuously secure pre-production environment. Registry scanning: Scan container registry images for vulnerabilities. malware, and secrets. You can configure your initial preference for scanning your registry. Any newly discovered registry, repository, or image in the account will be scanned by default. For more details, see Configure registry scanning for cloud accounts Agentless disk scanning: (Recommended) Implement agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Cloud Tags: Define tags and tag values to be added to any new resource created by Cortex Cloud in the cloud environment. Note: The managed_by = paloaltonetworks tag is automatically added to all resources. This tag is mandatory. You cannot edit or remove this tag. Log Collection Configuration: To maximize security coverage, enable the collection of audit logs. This may require additional cloud service provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Enter the following details for each preexisting OCI storage bucket that you intend to use for log collection: Region: The geographic OCI region where the bucket is located. For example, "us-phoenix-1". Bucket Name: The name of the OCI storage bucket. Compartment OCID: The Oracle Cloud Identifier (OCID) of the compartment that contains the bucket. Log Collection Configuration: To maximize security coverage, enable the collection of audit logs. This may require additional cloud service provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Enter the following details for each preexisting OCI storage bucket that you intend to use for log collection: Region: The geographic OCI region where the bucket is located. For example, "us-phoenix-1". Bucket Name: The name of the OCI storage bucket. Compartment OCID: The Oracle Cloud Identifier (OCID) of the compartment that contains the bucket. Download the OCI authentication template by clicking Download Terraform. The Terraform authentication template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The Terraform authentication template is valid for seven days from when it was created. Download the OCI authentication template by clicking Download Terraform. The Terraform authentication template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The Terraform authentication template is valid for seven days from when it was created. Cortex Cloud generates a Terraform authentication template based on the settings you configured in the OCI onboarding wizard. Next step: Apply the Terraform authentication template in OCI. 23.3.6.4.4.1 |Manually upload template to OCI PREREQUISITE: Before you begin, ensure you have: An Oracle Cloud Infrastructure account and the tenancy OCID. Permission to deploy a custom template and create its resources in OCI. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed...

  23.3.6.4.5. Cloud service provider permissions

  23.3.6.4.5.1. Google Cloud Platform provider permissions

  23.3.6.4.5.2. Amazon Web Services provider permissions

  23.3.6.4.5.3. Microsoft Azure provider permissions

  23.3.6.4.5.4. Oracle Cloud Infrastructure provider permissions

  23.3.6.4.6. Container Registry Scanning

  23.3.6.4.6.1. Overview of container registry scanning

  23.3.6.4.6.2. Configure registry scanning for cloud accounts

##### Prerequisite

* Ensure that you have performed the all steps till Additional Security Capabilities as listed in the onboarding wizard for the required CSP: Onboard Amazon Web ServicesOnboard Amazon Web Services Onboard Google Cloud PlatformOnboard Google Cloud Platform Onboard Microsoft AzureOnboard Microsoft Azure Onboard Oracle Cloud InfrastructureOnboard Oracle...

  23.3.6.4.6.3. Modify the container registry scanning scope

  23.3.6.4.6.4. Scan re-evaluation process

  23.3.6.4.6.5. Connect Docker Hub registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

##### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  23.3.6.4.6.6. Connect Docker V2 compliant container registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

##### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  23.3.6.4.6.7. Connect GitLab container registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

##### Note

* When both the group ID and project ID are provided, the system retrieves container images from all projects within the specified group as well as from the specified project. If neither the group ID nor the project ID is provided, the system retrieves container images from all registries (across all groups and projects) accessible to the authenticated...

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  23.3.6.4.6.8. Connect Harbor registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

##### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  23.3.6.4.6.9. Connect JFrog container registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

##### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  23.3.6.4.6.10. Connect Sonatype Nexus registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

##### Note

* If you are using a CA certificate, enter the server IP address instead of the registry url.

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* If you are using a CA certificate, enter the server IP address instead of the registry URL.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  23.3.6.4.7. Outposts

##### Important

* Outpost scan is an alternative to the recommended standard cloud scan. Cloud scan is recommended because it is fully managed by Palo Alto Networks and incurs no compute costs for your organization. Outpost scan is an advanced deployment model reserved for specific data residency or architectural requirements.

  23.3.6.4.8. Configure AWS integration instances and monitor integration instance health

##### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  23.3.6.5. Ingest data for API security

  23.3.6.5.1. Ingest AWS API Gateway

##### Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

##### Important

* Leave '–'filter-pattern empty as displayed above.

  23.3.6.5.2. Ingest Azure APIM

##### License Type

  Requires the Data Collection add-on.

##### Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

##### Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

  23.3.6.5.3. Ingest Apigee Proxy

##### License Type

  Requires the Data Collection add-on.

##### Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

##### Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

  23.3.6.5.4. Ingest Kong

##### License Type

  Requires the Data Collection add-on.

##### Note

* Contact support to obtain the custom plugin file.

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

##### Important

* The size of the buffer must be equal or larger than the max body size setting in the plugin configuration, on every data plane node.

  23.3.6.6. Additional log ingestion methods

  23.3.6.6.1. Ingest logs from a Syslog receiver

  23.3.6.6.2. Ingest Apache Kafka events as datasets

  23.3.6.6.3. Ingest CSV files as datasets

  23.3.6.6.4. Ingest database data as datasets

  23.3.6.6.5. Ingest logs in a network share as datasets

##### Note

* The Files and Folders Collector applet only starts to collect files that are more than 256 bytes.

  23.3.6.6.6. Ingest FTP files as datasets

  23.3.6.6.7. Ingest NetFlow flow records as datasets

  23.3.6.6.8. Set up an HTTP log collector to receive logs

##### Note

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex Cloud reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex Cloud uses these values even if you specified a value in the Vendor...

* Each record cannot exceed 5 MB in size.

  23.3.6.6.9. Ingest logs from BeyondTrust Privilege Management Cloud

##### Note

* For a Log Format set to Beyondtrust Cloud ECS, the following fields are automatically set and not configurable. Vendor: Beyondtrust Product: Privilege Management Compression: Uncompressed

  23.3.6.6.10. Ingest logs and data from Box

##### Prerequisite

* Set up an Enterprise Box plan.  Important To collect Box Shield Alerts, you must purchase Box Shield and it must be enabled on Box enterprise. Set up an Enterprise Box plan. Create a valid Box account that is assigned to a role with sufficient permissions for the data you want to collect. For example, create an account assigned to an Admin role to...

##### Note

* The Fetch Intervals are non-configurable.

* Collecting Box Shield Alerts requires implementing Box Shield,

* There is a current bug with the Groups API from Box. If you don't configure the Box app with the proper permissions for managing groups data, the Groups API from Box won't return an error message to Cortex Cloud indicating that the API failed to receive the data, and the Groups data will not be collected.

* For any future change that you make to your Box app, ensure that you send the changes for approval to the administrator, who will need to approve them as explained above.

* Inventory data snapshots are collected every 10 minutes.

  23.3.6.6.11. Ingest logs and data from Dropbox

##### License Type

  Requires the ITDR Module add-on.

##### Prerequisite

* Set up an Advanced Dropbox plan. Create a Dropbox Business admin account with Security admin permissions, which is required to authorize Cortex Cloud to access the Dropbox Business account and generate the OAuth 2.0 access token.

##### Note

* The Fetch Interval is non-configurable.

* When the App Key field is empty, the here link in the tooltip is disabled. When an incorrect App Key is entered, clicking the link results in a 404 error.

* Whenever you change the permissions of the Dropbox app, we recommend that you generate a new Access Code for the Dropbox data collector instance so that the permissions match the updates.

* Event data is collected every 60 seconds with a 10 minute lag time.

* Inventory data snapshots are collected every 10 minutes.

  23.3.6.6.12. Ingest logs from Forcepoint DLP

  23.3.6.6.13. Ingest report data from Workday

##### Prerequisite

* Create an Integration System User that is designated to access the custom report from Workday for data collection in Cortex Cloud. Create an Integration System Security Group for the Integration System User created in Step 1 for accessing the report. When setting this group ensure to define the following:    Type of Tenanted Security Group: Select...

##### Note

* Any user with permissions to view issues and cases can view the Workday data.

* For more information on completing any of the prerequisite steps, see the Workday documentation.

* The Business Object changes depending on the Data Source selected.

* Cortex Cloud uses a structured schema when integrating Workday data. To get the best Analytics results, specify all the fields marked with an asterisk from the recommended schema. workday_user_id* full_name* workday_manager_user_id* manager* worker_type* position_title* department* private_email_address* business_email_address* employment_start_date* em...

  23.3.7. Onboard the Kubernetes Connector

##### Note

* This option is not supported for Fargate.

* For Fargate, you must provide the cluster resource identifier. The format of the identifier is arn:aws:eks:<region>:<account-id>:cluster/<cluster-name>.

* Basic authentication is only supported in Posture Management. If deploying Realtime Protection, select None .

  23.3.7.1. What's new in Kubernetes Connector?

  23.3.7.2. Supported Kubernetes distributions

##### Note

* In Google Container-Optimized OS release 100 and earlier, where the FANOTIFY EXEC flag is not supported, the Kernel configuration may be partial for the user mode agent to properly function. In such cases, the agent will fallback to asynchronous mode. In RHCOS version 4.12 and earlier, the Kernel configuration may be partial for the user mode agent to...

  23.3.8. Verify collector connectivity

##### Note

* For more information on troubleshooting data collector applet errors, see Troubleshoot Broker VM applet connectivity.

  23.3.9. Overview of data ingestion metrics

##### Prerequisite

* For Cortex Cloud to monitor data ingestion health and create health issues, you must enable Cortex - Analytics. Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics.Enable the Analytics Engine and Identity Analytics

  23.3.9.1. Creating correlation rules to monitor data ingestion health

  23.3.9.2. Measuring data freshness

##### Note

* The max_delay metric is taken from the maximum bucket value with a restricted limit; therefore, metrics show whole numbers. The median and ninetieth_percentile metrics are statistical calculations that give an approximation of the real value; therefore, metrics show decimal numbers. Time slots with a zero log count or zero byte count display records...

  23.3.10. About health issues

##### Prerequisite

* For Cortex Cloud to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics.Enable the Analytics Engine and Identity Analytics

##### Note

* The Health Issues page displays issues that were triggered after July 2024. To see health issues that were triggered before this date, click Legacy Health Issues.

* Cortex Cloud enforces the dedup logic to health issues. This logic reduces the likelihood of identical health issues from flooding the issues dataset.

  23.3.10.1. Investigate and resolve health issues

  23.3.10.2. Monitor data ingestion health

  23.3.10.3. Monitor correlation rules

##### Note

* In the dataset, the Query start time and Query end time indicate the timeframe of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

  23.4. Dataset management

##### License Type

  Managing Roles requires an Account Admin or Instance Administrator role. For more information, see Predefined user roles.

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

##### Note

* Cold storage, in addition to a cold storage license, requires compute units (CU) to run cold storage queries. For more information on CU, see Manage compute units.

* Only datasets that are already handled as part of the GB license are supported for this license. In addition, the retention configuration is only available in Cortex Cloud, as opposed to the public APIs.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default. Datasets include dataset permission enforcements in the Cortex Query Language(XQL), Query Center, and XQL Widgets. For example, to view or access any of the endpoints and host_inventory datasets, you need role-based access control (RBAC)...

* You'll only be able to save the dataset view if the query contains no errors; otherwise, the Save button is disabled.

* For more information on user roles, see Manage user roles.

##### Important

* Cortex Cloud enforces retention on all log-type datasets excluding Host Inventory, Vulnerability Assessment, Metrics, and Users.

* This column is updated once a day. Therefore, if the dataset was created or updated by the target or lookup flows, it's possible that the Last Updated value is a day behind when the queries or reports were run as it was before this column was updated.

  23.4.1. What are datasets?

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

##### Note

* For more information on tasks specific to lookup datasets, see Lookup datasets.

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

##### Important

* By default, forensic datasets are not included in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  23.4.2. Lookup datasets

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

##### Note

* A lookup dataset can only be deleted if there are no other dependencies. For example, if a Correlation Rule is based on a lookup dataset, you wouldn't be able to delete the lookup dataset until you removed the dataset from the XQL query of the Correlation Rule.

##### Important

* When you create or add data to a lookup dataset using the target stage, the _time field won't be included by default unless you explicitly add it with the fields stage.

  23.4.2.1. Import a lookup dataset

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

* When uploading a CSV, TSV, or JSON file, ensure that the file meets the following requirements: The maximum size for the total data to be imported into a lookup dataset is 30 MB from the Dataset Management page. Otherwise, the limit is 50 MB using Cortex Query Language (XQL) or APIs. Field names can contain characters from different languages, special...

##### Important

* The name of a dataset created from a TSV file must always include the extension. For example, if the original file name is mrkdptusrsnov23.tsv, you can save the dataset with the name marketing_dept_users_Nov_2023.tsv.

  23.4.2.2. Download JSON file of lookup dataset

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

##### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  23.4.2.3. Set time to live for lookup datasets

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

##### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  23.4.3. Monitor datasets and dataset views activity

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  23.5. Manage Event Forwarding

##### Prerequisite

* Event Forwarding requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Dataset Management.

##### Note

* After exporting logs, you can download them from GCP for up to 14 days. The Pub/Sub subscription messages are available for 7 days.

* Requires the Endpoints Event Forwarding add-on.

* Requires the GB Event Forwarding add-on

##### Important

* Since data is aggregated and compressed, it may take up to two hours until the data is available in the forwarding bucket.

##### Navigation

  Under Settings → Configurations → Data Management → Event Forwarding, activate one or more of the following: Enable GB Event Forwarding Enable Endpoints Event Forwarding

  Under Settings → Configurations → Data Management → Event Forwarding, activate one or more of the following

  23.5.1. Endpoints Event Forwarding - included/excluded fields by event type

##### Prerequisite

* Event Forwarding requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Dataset Management.

  23.6. Manage compute units

##### Note

* For more information, see Import historical data into cold storage.Import historical data into cold storage

* The CU consumption of cold storage queries is based on the number of days in the query time frame. For example, when querying 1 hour of a specific day, the CU of querying this entire day is consumed. When querying 1 hour that extends past 2 days, such as from 23:50 to 00:50 of the following day, the CU of querying these two days is consumed.

  23.6.1. Compute units usage

##### Note

* To enable the add-on, select Settings  → Configurations → Cortex Cloud License → Addons tile, and select the Compute Unit tile and Enable.

##### Navigation

  Settings → Configurations → Data Management → Compute Unit Usage

24. Marketplace

  24.1. Cortex Marketplace

##### Navigation

  Settings → Configurations → Marketplace) or at Cortex Developer Docs Marketplace

  24.2. Content Pack Support Types

##### Note

* Palo Alto Networks is not liable for and does not warrant or support any content pack produced by a third-party publisher. Palo Alto Networks does not support content packs that do not have official available documentation.

  24.3. Cortex Cloud content

  24.4. Manage content packs

##### Note

* Optional content packs that are already installed are treated like they are required content packs to preserve content integrity.

* Cortex Cloud includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

* In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as scripts or integrations.

* Third-party product integrations are developed and tested against a specific product version. For products that are on-prem or cloud-based with specific API versions, the version developed and tested against will be included in the integration's documentation. Newer versions of the product are not always immediately tested, and it is expected that...

##### Caution

* If you want to downgrade, any content that depends on the content pack including any customizations may be deleted if it does not exist in the target content pack version.

* If another content pack is dependent on the content pack you want to delete, it may break the other content pack. You can reinstall the content pack, but you cannot restore detached and customized content.

##### Tip

* You can also find content packs that require updates by going to Settings → Data Sources & Integrations and filtering by Pack Version = Update Available. If you click on an integration in the filtered list, there is a link to the content pack in Marketplace for updates.

  24.5. Marketplace FAQs

  24.6. Content changes when upgrading Cortex Cloud versions

25. Serverless function posture security

  25.1. Onboard cloud providers for serverless functions

##### Note

* When scanning serverless functions with layers, those layers need to be from the same cloud account.

* Only functions containing zip files are supported.

##### Important

* Cortex supports Google Cloud Functions: 1st gen and 2nd gen Cloud Functions API.

  25.2. Serverless function posture policies

  25.2.1. Manage serverless function policies

##### Note

* You can select multiple types to view all your serverless function rules across your cloud providers.

* Refer to Create serverless function policies for more information on how to define the steps of a policy in the wizard.

  25.2.2. Create serverless function policies

##### Note

* You can select multiple options.

* For more information about rules, refer to Manage serverless function rules.

  25.3. Serverless function posture rules

  25.3.1. Manage serverless function rules

##### Note

* You can select multiple types to view all your serverless function policies across your cloud providers.

* Refer to Create serverless function rules for more information on how to define the steps of a rule in the wizard.

  25.3.2. Create serverless function rules

  25.3.3. Create an attack path rule for serverless functions

##### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  in as the operator → enter the CVE ID → Search

  > or >= as the operator → Severity level (such as High, Low) → Search

  > or >= as the operator → enter a score → Search

  25.3.4. Create a configuration rule for serverless functions

##### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  25.3.5. Create a network exposure rule for serverless functions

##### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  25.4. Serverless function usage

##### Navigation

  To access serverless function assets, under Inventory, select All Assets → Compute → Serverless Functions

  Posture Management → Vulnerability Management) → Vulnerability Issues

  Add Filters → Asset Category → Serverless Function

  Posture Management → Vulnerability Management) → Vulnerable Assets

  Add Filters → Asset Category → Serverless Functions

26. Serverless function runtime security

  26.1. Overview

  26.2. Set up serverless function protection

  26.3. Serverless runtime issues

##### Note

* Issues triggered within 24 hours, sharing the same name and description, will be aggregated into cases along with issues from the same function per execution.

27. Cortex CLI

##### Note

* The CLI Read Only Role is not supported for CWP as the system does not support offline mode.

  27.1. Connect Cortex CLI

##### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

##### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources & Integrations →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Cortex Cloud Application Security, refer to Cortex CLI usage for Cortex Cloud Application Security

##### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source or Integrations page after selecting + Add New.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

  27.2. Cortex CLI common command line reference guide

##### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

  27.3. Cortex CLI for API Security

##### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more informationConnect Cortex CLI Ensure your application exposes APIs and provides a corresponding OpenAPI Specification file Ensure that you have installed Java v 11 and above

  27.3.1. Cortex CLI API Security command line reference guide

  27.4. Cortex CLI for Cloud Workload Protection

##### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more informationConnect Cortex CLI Verify that Java version 11 and above is installed: Run java -version in your terminal. If not, refer to Java SE Development Kit 11.0.25 for information...

* Before you begin, ensure you have sudo privileges to execute the image scan.

* For direct scanning from your Docker daemon, the image must already exist in your local Docker repository. The CLI will not pull a new image if it does not exist locally. To scan an image that exists in your local Docker daemon, simply provide its name: The image scan accepts the following arguments: --api-base-url: Required - true. The public facing API URL. Refer to Connect Cortex CLI for more informationConnect Cortex CLI --api-key: Required - true. Your Cortex Cloud API key. Refer to Connect Cortex CLI for more informationConnect Cortex CLI --api-key-id: Required - true. Your Cortex Cloud API key ID image scan: Required - true. Refers to CWP as the type of scan By default, Cortex Cloud looks for the Docker socket at unix:///var/run/docker.sock. --docker-host <path> specifies the path to the Docker socket. Use this flag if your Docker socket is located elsewhere, for example unix:///var/snap/docker/common/run/docker.sock. To scan an image from a previously saved archive file (such as a .tar file), use the --archive flag: This example demonstrates how to create an image archive from your Docker or Podman environment, which can then be used for scanning or SBOM generation if you choose not to scan directly from the local daemon. With Docker: docker save -o ubuntu.tar ubuntu With Podman: podman save --format oci-archive -o /tmp/alpine-oci.tar alpine:latest You can generate a Software Bill of Materials (SBOM) for your container images using the Cortex CLI and and save the output to a specified file. This functionality enables you to store the SBOM for further analysis, auditing, and compliance. By default, this will retrieve the SBOM for an image from your local Docker daemon. To get an SBOM for an image from your local Docker daemon: Command: cortexcli image sbom: Exports a Software Bill of Materials (SBOM) document for a container image archive. Usage: cortexcli image sbom [command options] --archive-format value: Specifies the image archive format. Values: docker-archive (default), oci-archive --output-format value: Specifies the SBOM document output format. Values: json (default), xml --output-file value: Specifies the path to the file where the SBOM document will be saved --fields value [--fields value]: Specifies the fields to include in the SBOM document. Multiple fields can be specified including: author, binaries, license, name, purl, sourcePackage, type, version --help, -h: Displays help information for the command To export an SBOM from an image archive file, use the --archive flag: NAME: cortexcli image sbom - Exports an SBOM document for an image from the local Docker daemon or an image archive. USAGE: cortexcli image sbom [command options] [image name or archive file]. Docker socket not reachable: If you encounter errors indicating the Docker socket cannot be reached, ensure the Docker daemon is running and verify the path to your Docker socket. If it's not in the default location (unix:///var/run/docker.sock), use the --docker-host flag to specify the correct path Image not found: If you attempt to scan an image directly from the Docker daemon and receive an error that the image does not exist, confirm that the image is indeed present in your local Docker repository by running docker images. The CLI will not pull images 27.4.1 |Cloud Workload Protection command line reference This reference guide documents the Cloud Workload Protection commands and flags for the Cortex CLI, including the structure of base commands and subcommands. Refer to Cortex CLI common command line reference guide for Cortex CLI commands common to all supported modules. 27.5 |Cortex CLI for Code Security PREREQUISITE: For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

##### Note

* CWP does not support container image secret scanning for systems running on ARM architecture.

* For available CWP commands, refer to Cloud Workload Protection command line reference.

* --archive: When used with image scan, sets the scan source to an archive file. When used with image sbom, indicates the SBOM should be exported from an archive file The --archive flag can also be explicitly set as --archive=true --archive-format <value>: The image archive format (such as docker-archive or oci-archive). Default: docker-archive.

  27.5.1. Cortex CLI usage for Cortex Cloud Application Security

  27.5.2. Cortex CLI Cortex Cloud Application Security command line reference

##### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

##### Important

* The Cortex CLI Cortex Cloud Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id...

28. Cortex Cloud XQL

  28.1. Get started with XQL

  28.1.1. XQL language features

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

##### Navigation

  You submit XQL queries to Cortex Cloud using the Investigation & Response → Search → Query Builder user interface

  28.1.2. XQL Language Structure

##### Note

* Specifying a dataset is not required because Cortex Cloud uses xdr_data as the default dataset. If you have more than one dataset or lookup, you can change your default dataset by navigating to Settings → Configurations → Data Management → Dataset Management, right-click on the appropriate dataset, and select Set as default.

* You can also build a query that investigates data in both a cold dataset and hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide. For more information on hot and cold storage, see Dataset management.

  28.1.2.1. Adding comments in queries

  28.1.3. Supported operators

##### Note

* In some cases, using an IN or NOT IN operator combined with a dataset and filterfilter stage can be a better alternative to using a join stage.

  28.1.4. Datasets and presets

##### Note

* To set up this Cloud Identity Engine (previously called Directory Sync Service (DSS)) dataset, you need to set up a Cloud Identity Engine. Otherwise, you will not have a pan_dss_raw dataset. For more information, see Set up Cloud Identity Engine.Set up Cloud Identity Engine

* INFO issues are not included in this dataset. The issue fields included in this dataset are limited to certain fields available in the API. For the full list, see Get Alerts Multi-Events v2 API.

* The fields contained in this dataset are a subset of the fields in the xdr_data dataset.

* If the vendor and product are not specified in the Winlogbeat profile's configuration file, Cortex Cloud creates a default dataset called microsoft_windows_raw.

* To ensure GlobalProtect access authentication logs are sent to Cortex Cloud, verify that your PANW firewall's Log Settings for GlobalProtect has the Cortex Data Lake checkbox selected.

* Prisma Access firewalls do not send configuration logs to the Structured Log Storage (SLS).

* You can query in XQL for this data and build widgets based on the xdr_data dataset or using the preset device_control. To view in an XQL query these events, the Device Configuration of the endpoint profile must be set to Block. Otherwise, the USB events are not captured. The events are also captured when a group of device types are blocked on the...

  28.1.5. About examples

##### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

  28.1.6. JSON functions

##### Important

* JSON field names are case sensitive, so the key to field pairing must be identical in an XQL query for results to be found. For example, if a field value is "TIMESTAMP" and your query is defined to look for "timestamp", no results will be found.

  28.1.7. How to filter for empty values in the results table

  28.1.8. Understanding string manipulation in XQL

  28.2. Build XQL queries

##### Note

* If you have the Cortex Agentic Assistant, you can use natural language prompts to create and run XQL queries within the chat interface. For more information, see Create and run XQL queries with Agentic Assistant chat.

  28.2.1. About the Query Builder

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

  28.2.2. How to build XQL queries

##### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex Cloud. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

##### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  28.2.2.1. Get started with XQL queries

  28.2.2.2. Useful XQL user interface features

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

  28.2.2.3. XQL Query best practices

  28.2.2.4. Expected results when querying fields

  28.2.2.5. Create XQL query

##### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined for the entire query, including queries that are part of the join stage. Yet, this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker...

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

  28.2.2.6. Review XQL query results

##### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* Results are received incrementally for the first 100K records, or up to 100MB worth of records, whichever comes first. After that, the next update is when the query has finished running completely.

* Real time query results are available only in the Query Builder and in free text query. Real time results are displayed only for queries run on hot datasets. The Sort option is available only after all the data is retrieved. When you formulate complex queries, the results will be displayed when the query has finished running completely, and not in real...

* In order for Cortex Cloud to provide a histogram for a field, the field must not contain an array or a JSON object.

  28.2.2.7. Translate to XQL

##### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

  28.2.2.8. Graph query results

##### License Type

  Building Cortex Query Language (XQL) queries in the Query Builder requires a Data Collection add-on.

##### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

  28.2.3. XQL query entities

  28.2.3.1. Create authentication query

##### Navigation

  Investigation & Response → Search → Query Builder

  28.2.3.2. Create event log query

##### Navigation

  Investigation & Response → Search → Query Builder

  28.2.3.3. Create file query

##### Navigation

  Investigation & Response → Search → Query Builder

  28.2.3.4. Create image load query

##### Navigation

  Investigation & Response → Search → Query Builder

  28.2.3.5. Create network connections query

##### Navigation

  Investigation & Response → Search → Query Builder

  28.2.3.6. Create network query

##### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

  28.2.3.7. Create process query

##### Navigation

  Investigation & Response → Search → Query Builder

  28.2.3.8. Create registry query

##### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

  28.2.3.9. Query across all entities

##### Navigation

  Investigation & Response → Search → Query Builder

  28.2.4. Overview of the Query Center

##### Note

* Very short queries might not be listed. You cannot cancel correlation queries. The default retention period for historic queries is aligned with issue retention.

  28.2.4.1. Edit and run queries in Query Center

##### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

##### Navigation

  Investigation & Response → Search → Query Center → Query History

  28.2.4.1.1. Query Center reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  28.2.5. Manage scheduled queries

##### Navigation

  Investigation & Response → Search → Scheduled Queries

  28.2.5.1. Scheduled Queries reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  28.2.6. Manage your query library

##### Note

* The Query to Library option is only available if your role has the Create Queries capability. For more information, see Manage access to saved queries.

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

##### Important

* The ability to create, edit, or share queries is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to saved queries.

  28.3. Stages

  28.4. Functions

29. Graph Search

  29.1. What is Graph Search?

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  29.2. Get started with Graph Search queries

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

##### Navigation

  Understand your assets and findings data: Graph Search queries are based on the current data that has been collected for assets and findings from the data sources configured and then sent to the Unified Asset Inventory (UAI), which is displayed in the All Assets page (Inventory → Assets → All Assets

  29.3. How to build Graph Search queries?

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

##### Navigation

  You submit Graph Search queries using the Investigation & Response → Search → Query Builder → Graph Search built-in query interface

  29.4. Understand Graph Search query results

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  29.5. Create Graph Search query

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

##### Note

* For more information about the Query Library, see Manage the Graph Search Query Library.

##### Tip

* After running the query, you can view the complete query by hovering over the last THAT... in the Graph Search query interface, and the query is displayed in a tooltip. If your query doesn't find any results or you want to change your query for any reason, you can always click anywhere in the Graph Search query interface, where your existing query is...

  29.6. Graph Search examples

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  29.7. Manage the Graph Search Query Library

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

##### Navigation

  From Graph Search in the Query Builder Select Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Center

  29.8. Edit and run queries in Query Center

##### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

##### Navigation

  Investigation & Response → Search → Query Center → Query History

  29.8.1. Query Center reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  29.9. Supported assets and findings

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  29.10. FAQ on Graph Search

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.


## Cortex XSIAM Documentation


---

## 1. Learn about Cortex XSIAM

### 1.1. Get started with Cortex XSIAM

#### 1.1.1. Cortex XSIAM architecture

##### Note

* If you plan to stream data from a Strata Logging Service instance, it must reside in the same region as your Cortex XSIAM tenant.

### 1.2. Agentic AI in Cortex XSIAM

#### 1.2.1. Cortex Agentic Assistant

##### Note

* By default, you have access to the Cortex Assistant, which includes a natural language interface for entity investigation and provides a list of recommended responses such as running a playbook, performing a scan, or collecting support files. If you enable the Cortex Agentic Assistant, it replaces the Cortex Assistant interface entirely. For more...

##### Tip

* The system Help Center Agent provides fast access to documentation. You can ask natural language questions, such as "How do I create a dashboard?" or "Where can I review my data retention policies?" and the agent retrieves concise, relevant information from the official documentation site.

##### Navigation

  Settings → Configurations → General → Server Settings → Agentic Assistant

##### 1.2.1.1. Agentic Assistant use cases

##### 1.2.1.2. Compare Agentic Assistant with Cortex Assistant

##### 1.2.1.3. Agentic Assistant security

### 1.3. Cortex XSIAM product licenses

#### Note

* You can upgrade your license by purchasing add-ons or moving to a different XSIAM license.

* Full code security scanning requires a separate add-on.

* Existing users who have a Cortex XSIAM Enterprise Plus license retain all Cortex XSIAM Enterprise features, with cloud agent features. You can deploy agents for runtime detection on cloud sources, such as Kubernetes nodes, OpenShift clusters, or cloud VMs, whether in the cloud or on-premises. If you want the full cloud posture security bundle (Cloud...

#### 1.3.1. Data retention

##### Note

* Case data is retained according to the Last Updated date. Issue data is retained according to the Observation Time. Data collected within these dates is kept and displayed for 186 days. To ensure the accuracy of issues, Cortex XSIAM provides a grace period of up to 31 days for issues displayed in the Issues View, Issues table, and Cases View.

* Requires the Forensics add-on.

#### 1.3.2. Data storage lifecycle

##### Tip

* If you want your cold storage data to align with the hot storage data, you must ensure to purchase your cold storage license at the same time as your regular Cortex XSIAM license.

* You can view details about your Cortex XSIAM licenses by selecting Settings → Cortex XSIAM License.

#### 1.3.3. License allocation

##### Note

* For Cortex XSIAM Enterprise Plus licenses, if an endpoint requires a Cortex XDR per Endpoint license, and you've exceeded the number of available Cortex XDR per Endpoint licenses, one of your surplus Cloud per Host licenses is automatically consumed as a Cortex XDR per Endpoint license for the endpoint. After utilizing all available XDR per Endpoint...

* It can take up to an hour for Cortex XSIAM to display revived assets.

#### 1.3.4. License expiration

#### 1.3.5. Upgrade your tenant

### 1.4. In-product support case creation

#### Note

* When opening a support case through the Customer Support Portal, you need to manually select Cortex XSIAM as the product. While there may be discrepancies between the categories in this wizard and the Customer Support Portal process, that's because this wizard is designed specifically to focus on options relevant to Cortex XSIAM.

* Selecting an endpoint from the endpoint table and retrieving TSF requires full Retrieve Endpoint Data permissions under Endpoint Administration.

* Console recordings cannot exceed 10 minutes. The current recording time is displayed at the top of the window.

### 1.5. Supported web browsers

### 1.6. Use the interface

#### Note

* Each SAML login session is valid for 8 hours. Some menu items only appear if you have the relevant license.

* CMD fields have a 128-character limit. Shorten longer query strings to 127 characters and add an asterisk (*).

* Deleting a shared view removes it for all users.

### 1.7. Manage API keys

#### Note

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

#### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* For optimal performance, we recommend using a single field in the filter definition and simple comparison operators.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

* You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

## 2. Onboard Cortex XSIAM

### 2.1. Plan and prepare

#### Note

* This topic does not include any specific Cloud Security requirements. If you have a Cortex XSIAM Premium license or another XSIAM license with Cloud Posture Security/Runtime addons, you should also plan and prepare Cloud Posture Security and Runtime during or after completing this stage. For more information about Cloud Security onboarding, see Ingest...

* The XDR agent is included with the Cortex XSIAM Premium and Enterprise licenses and any other XSIAM license with the Enterprise Runtime Security (XDR) add-on.

#### 2.1.1. Plan your agent deployment

### 2.2. Deployment steps

#### 2.2.1. Cortex XSIAM onboarding checklist

##### Note

* This checklist does not include any specific Cloud Security requirements. If you have a Cortex XSIAM Premium license or another XSIAM license with Cloud Posture Security/Runtime, you should also onboard Cloud Posture Security and Runtime during or after completing this stage. For more information about Cloud Security onboarding, see Ingest cloud assets.

* You need EDR or network logs from at least 30 endpoints over a minimum of 2 weeks, or Cloud audit logs over a minimum of 2 weeks.

* The Cloud Identity Engine must be set up.

#### 2.2.2. Activate Cortex XSIAM

##### Prerequisite

* The Cortex XSIAM activation email. A Customer Support Portal (CSP) account. You need to set up your CSP account. For more information, see How to Create Your CSP User Account. When you create a CSP account, you can set up two-factor authentication (2FA) to log into the CSP by using an Email, Okta Verify, or Google Authenticator (non-FedRAMP accounts)....

##### Note

* When you activate, a production tenant is first activated. After activation, you can set up a development tenant (subject to your license).

* Activation can take about an hour and does not require you to remain on the activation page. Cortex XSIAM sends a notification to your email when the process is complete.

* If you want to change your tenant's name, the subdomain, or activate a development tenant (subject to license), on the right-hand side, click the ellipsis. You can only change the subdomain once, and it cannot be undone. After deleting the subdomain, you can reuse it after 7 days.

##### 2.2.2.1. Bring your own keys

###### Prerequisite

* Access to BYOK (Bring Your Own Keys) functionality is restricted to tenants that were initially activated with BYOK.

* To disable your encryption keys and deactivate a tenant, you must have an Account Admin role.

###### Note

* The new keys you import will serve as primary encryption keys for newly generated data.

* At any stage, you can select Continue Later to pause the process. To resume the process, in the Cortex gateway, select Continue Setup next to the tenant, and follow the wizard instructions from the point you left off, as detailed below. If you don't use either of your wrapping keys within three days, they expire and you'll have to restart the process.

* BYOK requires a 32-byte, symmetric, unencoded key in binary format.

###### Caution

* Disabling all encryption keys and deactivating the tenant renders the tenant inaccessible and non-operational. Disabling the keys affects the communication with the agents, may prevent the agents from receiving updates to policies, configurations, and crucial information, and may result in loss of data. To secure your tenant data and to prevent...

##### 2.2.2.2. Cortex XSIAM supported regions

##### 2.2.2.3. Enable access to required PANW resources

###### Note

* <tenant-name> refers to the selected subdomain of your Cortex XSIAM tenant, and <region> is the region in which your tenant is deployed. For more information, see Cortex XSIAM supported regions.

###### Navigation

  SSL decryption: If you use SSL decryption and experience difficulty connecting the Cortex XDR agent to the server, we recommend that you add the FQDNs required for access to your SSL Decryption Exclusion list in Device → Certificate Management → SSL Decryption Exclusion

#### 2.2.3. Set up users and roles

##### Note

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* The user who activated the Cortex product is assigned the Account Admin role. You cannot create additional Account Admin roles in the Cortex XSIAM tenant. If you do not want the user to have Account Admin permission, you must remove the Account Admin role in Cortex Gateway.

##### 2.2.3.1. User group management

###### Note

* You can create user groups in the tenant or Cortex Gateway. User groups created in Cortex Gateway cannot be mapped to SAML groups. Only user groups created in the tenant support SAML group mapping and scoring. We recommend creating user groups in the Cortex tenant because: User groups are available for all tenants, and you may want different user...

* If users have been created in the CSP, but you want them to access the tenant through SSO only, skip this field and add only SAML group mapping after SSO is set up, otherwise, users can access the tenant through both the CSP and SSO. If you have not yet created any users, skip this field and add them later. See Set up authentication .

* When using Azure AD for SSO, the SAML group mapping needs to be provided using the group object ID (GUID) and not the group name.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* For optimal performance, we recommend using a single field in the filter definition and simple comparison operators.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

##### 2.2.3.2. Assign user roles and groups

###### Note

* If an existing user in the Cortex Gateway no longer has a role or a user group assigned, the user is revoked. Any roles, user groups, or egress configurations created by that user are shown as created by Revoked user instead of the user's email address.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Setting Cortex Query Language (XQL) dataset access permissions for a user role can only be performed from Cortex XSIAM Access Management. For more information, see Manage user roles.

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* For optimal performance, we recommend using a single field in the filter definition and simple comparison operators.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit Users Permissions.

#### 2.2.4. Set up authentication

##### Tip

* You should have at least one user in the Customer Support Portal for backup, in case of any authentication issues with your IdP provider.

##### 2.2.4.1. Authenticate users through the Customer Support Portal

###### Note

* You must be assigned the Super User role in the Customer Support Portal to add users in the Customer Support Portal. The first Super User who logs into Cortex Gateway is automatically assigned the Account Admin role and has access to the tenant. The user who activates the Cortex XSIAM tenant will also be assigned the Account Admin role (if there is no...

* After users are added to the Customer Support Portal and they accept the invitation, you can manage them in Cortex Gateway or the Cortex XSIAM tenant.

##### 2.2.4.2. Authenticate users using SSO

###### Note

* To set up SSO authentication in the tenant, you must be assigned an Instance Administrator or Account Admin role. SAML 2.0 users must log in to Cortex XSIAM using the FQDN (full URL) of the tenant. To allow login directly from the IdP to , you must set the relay state on the IdP to the FQDN of the tenant. If you have multiple tenants, you must set up...

* The first SSO cannot be deleted, it can only be deactivated by toggling SSO Enabled to off. The Domain parameter is predefined for the first SSO. If you add additional SSO providers, you must provide the email Domain in the SSO Integration settings for all providers except the first. Cortex XSIAM uses this domain to determine to which identity provider...

* Cortex XSIAM requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex XSIAM. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a...

##### 2.2.4.3. Set up Okta as the Identity Provider Using SAML 2.0

###### Note

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Navigation

  Settings → Configurations → Access Management → Authentication Settings

  Settings → Configurations → Access Management → User Groups

##### 2.2.4.4. Set up Azure AD as the Identity Provider Using SAML 2.0

###### Note

* The default attributes shown on the main single sign-on page in Azure AD are not the values you need. You must click Edit next to Attributes and Claims to view and copy the actual values.

* The attribute claim name must exactly match the value sent by your IdP. In some cases, this may be the full attribute name/namespace, depending on the configuration of our IdP

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Important

* When copying the Single Sign-On URL value, remove idp/saml and leave the trailing /. For example, if the Single Sign-On URL is https://clientname.panproduct.region.paloaltonetworks.com/idp/saml, just copy https://clientname.panproduct.region.paloaltonetworks.com/.

###### Navigation

  Settings → Configurations → Access Management → User Groups

#### 2.2.5. Configure content

#### 2.2.6. Set up Cloud Identity Engine

##### Note

* The Activate risk signal sharing to CIE checkbox is available only after the second step is completed.

##### Navigation

  Settings → Configuration → Integrations → Cloud Identity Engine

#### 2.2.7. Install Cortex XDR agents

##### 2.2.7.1. Create an agent installation package

###### Note

* The profile will be applied if the security policy cannot be retrieved in real-time.

* The Cortex serverless library must be imported after other libraries to activate the hooks that enable auditing.

##### 2.2.7.2. Deploy agent installation packages

##### 2.2.7.3. Endpoint data collection

###### Note

* For specific files only and only if the file was written.

###### Important

* Registry key is collected as a real key name, and not as a symbolic link. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, KEY_LOCAL_MACHINE\System\ControlSet001 will be collected. Instead of HKEY_CURRENT_USER, HKEY_USERS\<SID> will be collected, where SID is a SID of the current user.

##### 2.2.7.4. Configure global agent settings

###### Note

* Disabling this capability takes immediate effect on new hashes, fresh agent installations, and existing security policies. It could take up to a week to take effect on existing agents in your environment pending agent caching.

* If you have any Cortex XSIAM filters, starring policies, exclusion policies, scoring rules, log forwarding queries, or automation rules configured for XSOAR/3rd party SIEM, we advise you to update those to support the changes before activating the feature. For example, change the query to include the previous description that is still available in the...

##### 2.2.7.5. Define endpoint groups

###### Note

* Disconnecting Cloud Identity Engine in your Cortex XSIAM deployment can affect existing endpoint groups and policy rules based on Active Directory properties.

##### 2.2.7.6. Manage endpoint profiles

##### 2.2.7.7. Guidelines for keeping Cortex XDR agents and content updated

###### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups. See how to define endpoint group.

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups.

###### Important

* When planning Cortex XDR agent upgrades and content updates, consult with the appropriate stakeholders and teams and follow the change management strategy in your organization.

###### Caution

* Before enabling Auto-Update for Cortex XDR agents, make sure to consult with all relevant stakeholders in your organization.

#### 2.2.8. Cortex XSIAM - Analytics

##### Prerequisite

* Before Cortex XSIAM - Analytics can start to analyze your endpoint data, perform the following steps: Configure Cortex XSIAM network parameters to monitor your internal networks. Enable the Analytics Engine. Make sure Cloud Identity Engine is set up. Enable Identity Analytics.

##### 2.2.8.1. Configure Cortex XSIAM network parameters

###### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

###### Navigation

  Inventory → Assets → Network Configuration → Internal Domain Suffixes

##### 2.2.8.2. Enable the Analytics Engine and Identity Analytics

###### Prerequisite

* Analytics Engine To create a baseline for enabling analytics, Cortex XSIAM requires a minimum of one of the following data sets: EDR or Network logs from at least 30 endpoints over a minimum of 2 weeks Cloud audit logs over a minimum of 5 days Identity Analytics Cortex XSIAM - Analytics must be activated. Cloud Identity Engine must be set up. For more...

###### Navigation

  Settings → Configurations → Cortex XSIAM - Analytics

### 2.3. Post-deployment

#### 2.3.1. Post-deployment checklist

##### Note

* This checklist includes post-deployment for the Cortex XSIAM environment, but does not include any specific Cloud Security requirements. See the relevant Cloud Security sections for specific post-deployment steps.

* If you set up Cloud Identity Engine, you can also leverage your Active Directory user, group, and computer details in endpoint groups.

* You can also use the Broker VM for high availability.

#### 2.3.2. Perform health checks

##### 2.3.2.1. Monitor agent operational status in Cortex XSIAM

###### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex XSIAM management console for specific reasons for the state.

###### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

#### 2.3.3. Cortex Marketplace

##### Navigation

  Settings → Configurations → Marketplace) or at Cortex Developer Docs Marketplace

##### 2.3.3.1. Content packs

###### Note

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

###### Navigation

  Settings → Configurations → Marketplace) or at Cortex Developer Docs Marketplace

##### 2.3.3.2. Install content packs

###### Note

* Currently, not all content packs are supported in the Data Sources & Integrations page. For example, content packs with several integrations are not yet supported.

* Content packs are also automatically installed when you adopt playbooks and configure tasks.

###### Navigation

  Settings → Configurations → Marketplace → Browse and locate the content pack you want to install

#### 2.3.4. Manage user roles and access management

##### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

##### Note

* For more information on assigning user roles when generating an API key, see Manage API keys.

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* For features where scoping is not applicable, Role-Based Access Control (RBAC) is used and can be configured when managing user roles. For more information, see Manage user roles.

##### 2.3.4.1. Manage user roles

###### Prerequisite

* Managing user roles in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Navigation

  Settings → Configurations → Access Management → Roles

##### 2.3.4.2. Manage user access

###### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Note

* You can only reduce the permissions of an Account Admin user via Cortex Gateway.

* User permissions for components and datasets are based on the access permissions set in the user role. For more information on editing these user role permissions, see Manage user roles.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* For optimal performance, we recommend using a single field in the filter definition and simple comparison operators.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit User Permissions.

###### Navigation

  Settings → Configurations → Access Management → Users

###### 2.3.4.2.1. User access reference information

##### 2.3.4.3. Manage user scope

###### Prerequisite

* Configuring user scopes in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles. By default, Enable Scope Based Access Control is...

###### Note

* This configuration can impact the visibility of the related Security domain in the Cases and Issues scope area, but with not affect asset visibility.

* Whenever a user's SBAC permissions are changed, Cortex XSIAM logs this event in the audit logs (Settings → Management Audit Logs). These monitored activity events are found on the Management Audit Logs table by filtering the Type column by Permissions and Subtype column by Scope Edit.

* XQL-based dashboard widgets may require a few hours to initially reflect changes to the list or definitions of asset groups used for scoping. To view the most current data immediately, refresh the dashboard or its XQL widgets.

* For Cases and Issues domains, a workaround is to create a Dataset View for each required combination of domains, and allow the relevant entity access only to this Dataset View, not to the underlying cases and issues datasets.

* This feature is included with a Cortex XSIAM Premium, Enterprise, and NG-SIEM licenses.

* Make sure to assign the required default granular scoping for users. This depends on the structure and divisions within your organization and the particular purpose of each organizational unit to which scoped users belong.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Some areas and features in Cortex XSIAM do not respect SBAC. In these cases, use RBAC permissions to restrict access.

* Action Required: Recent security enhancements enforce stricter default permissions for cases and issues that lack specific asset or endpoint references. This notice explains how to include access to these items if your users' visibility has been impacted.

* Before configuring, ensure that you review the Understand scoping section.

* For optimal performance, we recommend using a single field in the filter definition and simple comparison operators.

##### 2.3.4.4. Manage access to objects

###### 2.3.4.4.1. Manage access to custom dashboards

####### Prerequisite

* Configure tenant-level settings: An administrator must first establish the sharing framework under Settings → Configurations → Access Management → Objects. The configuration of these settings defines the authorized sharing workflows for custom dashboards:    Enable "Owners can Share objects they created": Grants owners the ability to share...

####### Note

* If you're designated as an Editor, you can always duplicate the widget and make your changes on the copy.

* Only Account Administrators and Instance Administrators have the authority to change the owner of an object.

###### 2.3.4.4.2. Manage access to saved queries

####### Prerequisite

* Configure tenant-level settings: An administrator must first establish the sharing framework under Settings → Configurations → Access Management → Objects. The configuration of these settings defines the authorized sharing workflows for saved queries in the Query Library, including the options that appear to users when clicking the three dot,...

####### Note

* If the role of a user is set to Edit Public Queries but not Create Queries, they can update existing public queries, but the Save as drop-down menu will be hidden, preventing them from creating new Query Library entries.

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

#### 2.3.5. Dashboards and reports

#### 2.3.6. Configure server settings

##### Note

* Keyboard shortcuts, timezone, and timestamp format are not set universally and only apply to the user who sets them.

* The Cortex Agentic Assistant and AI case summarization are currently available for users in limited regions. For more information, see Cortex Agentic Assistant.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Requires the TIM add-on. By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled.

* Requires an MSSP License and RBAC permissions to Cases & Issues and Investigation & Response → Automation. This setting is available for the parent tenant only.

##### Navigation

  Settings → Configurations → General → Server Settings

#### 2.3.7. Configure security settings

##### Navigation

  Settings → Configurations → General → Security Settings

#### 2.3.8. Log forwarding

##### 2.3.8.1. Forward logs from Cortex XSIAM to external services

###### License Type

  Requires an XDR Agent.

###### 2.3.8.1.1. Integrate a syslog receiver

####### Note

* Up to TLS 1.3 is supported. Make sure the self-signed CA includes your public key.

###### 2.3.8.1.2. Integrate Slack for outbound notifications

####### Note

* You are directed to the Slack browser to install Cortex XSIAM. You can only use this link to install Cortex XSIAM on Slack. Attempting to install from Slack Marketplace will redirect you to Cortex XSIAM documentation.

###### 2.3.8.1.3. Configure notification forwarding

####### Prerequisite

* Before you can select a syslog receiver or a Slack channel, you must integrate these external services with Cortex XSIAM. For more information, see: Integrate a syslog receiver Integrate Slack for outbound notifications

####### Note

* Notification Forwarding by Domain: To configure notification forwarding for issues by domain, select Log Type = Issues and filter the Issues table by Issue Domain. Case IDs in Notifications: If case matching completes before the notification is sent, the Case ID is included. If matching takes longer than the notification trigger, the notification is...

* This option will be deprecated in the next release. Configure issues with the filter Issue Domain = Health instead.

###### 2.3.8.1.4. Monitor administrative activity

##### 2.3.8.2. Data and log notification formats

###### Note

* Issues can be forwarded to email, syslog servers, and Slack in the alert format, if you prefer. The alert format can be selected when you configure your forwarding notification.

###### 2.3.8.2.1. Management audit log messages

###### 2.3.8.2.2. Issue notification format

###### 2.3.8.2.3. Agent Audit log notification format

###### 2.3.8.2.4. Management Audit log notification format

###### 2.3.8.2.5. Log format for IOC and BIOC issues

###### 2.3.8.2.6. Analytics log format

## 3. Configure Cortex XSIAM

### 3.1. Data management

#### 3.1.1. Configure Cortex Data Lake tier

##### License Type

  The Cortex Data Lake tier is only available with an active Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, or Cortex XSIAM Premium license.

##### Prerequisite

* The Cortex Data Lake tier require View/Edit RBAC permissions for Data Management (under Configurations → Data Management), the same permissions used for Dataset Management, ingestion rules, parsing rules, data model rules, and event forwarding.

##### Note

* Currently, specific data sources receive these capabilities temporarily; yet, be aware that these will be completely removed from the Cortex Data Lake tier in a future update.

#### 3.1.2. Broker VM

##### 3.1.2.1. What is the Broker VM?

##### 3.1.2.2. Set up and configure Broker VM

###### Note

* The Broker VM comes with a 512 GB disk. Therefore, deploy the Broker VM with thin provisioning, meaning the hard disk can grow up to 512 GB but will do so only if needed.

* When DHCP is not enabled in your network and there isn't an IP address for your Broker VM, configure the Broker VM with a static IP using the serial console menu.

* When configuring a Local Agent Settings applet with installer and content caching, you need to configure an SSL certificate for the Broker VM as explained in the task below. For more information on specific requirements for the Local Agent Settings applet, see Activate Local Agent Settings. Keep in mind that several Broker VM applets, such as the...

* When a Broker VM is disconnected for more than 30 days, it will have to go through a re-registration process.

* You can configure another Broker VM as a proxy server for this Broker VM by selecting the HTTP type. When selecting HTTP to route Broker VM communication, you need to add the IP Address and Port number (set when activating the Agent Proxy) for another Broker VM registered in your tenant. This designates the other Broker VM as a proxy for this Broker VM.

* The Palo Alto Networks Broker VM supports only strong cipher SHA256-based certificates. MD5/SHA1-based certificates are not supported.

* If adding a CA certificate to the Broker VM is not possible, ensure that you've added the Broker Service FQDNs to the SSL Decryption Exclusion list on your firewalls. See Enable Access to Cortex XDR.

###### Important

* There can be instances in which the Broker VM requires up to 50% of the incoming bandwidth as outgoing. Such instances can be, network instability between the Broker VM and Cortex XSIAM, or data that is being collected, but not well compressed.

* The internal network for the Broker VM must be unique and reserved. Other devices should not use the same IP as the Broker VM internal network as it can lead to communication issues with the Broker VM.

* If you use SSL decryption in your firewalls and proxies, see the Understanding CA certificate functionality in Broker VM deployments section below. In addition, verify that the proxies used support HTTP/2, gRPC-specific headers, and HTTP/2 trailers, and the inspection policies support gRPC traffic. Any devices that you use with this configuration...

* When configuring more than one network interface, ensure that only one Default Gateway is defined. The rest must be set to 0.0.0.0, which configures them as undefined. In addition, we recommend assigning each network interface to a different subnet, as oppose to configuring two interfaces on the same subnet which can potentially cause unexpected...

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and earlier, Cortex XSIAM will only accept 172.17.0.0/16.

* We strongly recommend disabling SSH connectivity when it's not being used. Therefore, activate SSH connectivity when it's needed and disable it right afterwards. When generating a new SSH key ensure to avoid embedding the domain-style username, by not using any backslashes (\) in the comment field, to ensure the SSH key passes validation.

###### 3.1.2.2.1. Broker VM image installations

####### 3.1.2.2.1.1. Set up Broker VM on Alibaba Cloud

######## Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

######## Note

* For Linux and Windows uploads, you can use Alibaba Cloud's graphical management tool called ossbrowser.

* The Object Storage Service must be created in the same Region as the image of the virtual machine.

######## Navigation

  Hamburger menu → Elastic Compute Service → Instances & Images → Instances

####### 3.1.2.2.1.2. Set up Broker VM on Amazon Web Services

######## Prerequisite

* Download a Cortex XSIAM Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. You need to set up an AWS VM Import role (vmimport) before you continue with the steps to convert the image as it is required for the import-image CLI command. You can use a different role, if the...

######## Note

* Creating an AMI image can take up to 60 minutes to complete.

* Assigning security groups can take up to 15 minutes.

######## Important

* A t2.medium (4GB RAM) is the lowest machine type that can be used as an instance type. Usually, the lowest machine type is sufficient with the Local Agent Settings applet. Yet, when enabling more applets, 8 GB is required.

######## Navigation

  Log in to the AWS IAM Console, and in the navigation pane, select Access Management → Users → Add Users

  Obtain a registration token from the Cortex XSIAM Web Console by selecting Settings → Configurations → Data Broker → Broker VMs → Add Broker → Generate Token

####### 3.1.2.2.1.3. Set up Broker VM on Google Cloud Platform (GCP)

######## Prerequisite

* Download a Cortex XSIAM Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. To complete the set up, you must have G Cloud installed and have an authenticated user account.

* Before importing a GCP image using the gcloud CLI, ensure that you update the Google Cloud components to version 371.0.0 and above using the following command:

######## Note

* The import tool uses Cloud Build API, which must be enabled in your project. For the import to work, Cloud Build service account must have compute.admin and iam.serviceAccountUser roles. When using the Google Cloud console to import the image, you will be prompted to add these permissions automatically.

####### 3.1.2.2.1.4. Set up Broker VM on KVM using Ubuntu

######## Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

####### 3.1.2.2.1.5. Set up Broker VM on Microsoft Azure

######## Prerequisite

* Download a Cortex XSIAM Broker VM VHD (Azure) image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

######## Note

* Extraction can take up to a few hours.

* Upload can take up to a few hours.

* For more information, see the Azure Documentation.

* Creating the VM can take up to 15 minutes. The Broker VM Web UI is not accessible during this time.

* For more information on creating a rule in an Azure VM, see Create a Security Rule in the Azure Documentation.

####### 3.1.2.2.1.6. Set up Broker VM on Microsoft Hyper-V

######## Prerequisite

* Download a Cortex XSIAM Broker VM VHD image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

####### 3.1.2.2.1.7. Set up Broker VM on Nutanix Hypervisor

######## Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

######## Note

* Saving the image to Nutanix hypervisor can take time as it's a large file. We recommend verifying periodically that the connection is alive for the upload process to finish successfully.

* Creating the VM can take up to 15 minutes. The Broker VM Web user interface is not accessible during this time.

####### 3.1.2.2.1.8. Set up Broker VM on VMware ESXi using vSphere Client

######## Prerequisite

* Ensure you have a virtualization platform installed that is compatible with an OVA image, and have an authenticated user account. Download a Cortex XSIAM Broker VM OVA image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

###### 3.1.2.2.2. Broker VM data collector applets

##### 3.1.2.3. Manage Broker VM

###### Note

* For more information on troubleshooting errors and warnings for these broker applets, see Troubleshoot Broker VM applet errors.

* Certain fields are also exposed in the Clusters tab, when a Broker VM node is added to a High Availability (HA) cluster, and each cluster node is expanded to view the Broker VM nodes table. An asterisk (*) is beside every field that is also included in the Broker VM nodes table for each HA cluster.

###### Navigation

  Settings → Configurations → Data Broker → Broker VMs

###### 3.1.2.3.1. Edit Broker VM Configuration

####### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and lower, Cortex XSIAM accepts only 172.17.0.0/16.

* Make sure you save the password before closing the window. The only way to re-generate a password is to disable ssh and re-enable.

###### 3.1.2.3.2. Increase Broker VM storage allocated for data caching

####### Note

* Follow your hypervisor documentation to understand how to add a persistent disk storage to your VM.

* If your disk is not listed and you didn't shutdown your Broker VM in your hypervisor before manually adding a disk to the VM, you'll need to reboot the Broker VM before the disk details are detected by the Broker VM. This can be performed either in the hypervisor or directly in the Broker VMs page.

####### Warning

* This operation is irreversible, and will make the disk become an integral part of the broker, where disconnecting the disk will result in errors and data loss.

###### 3.1.2.3.3. Monitor Broker VM using Prometheus

####### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* For more information on Docker, see the Docker website.

###### 3.1.2.3.4. Collect Broker VM Logs

####### Note

* The Download Logs (<TIMESTAMP>) is only displayed when you've downloaded your logs previously using Generate New Logs.

###### 3.1.2.3.5. Upgrade Broker VM

####### Important

* After a Broker VM upgrade, your broker may require a reboot to finish installing important updates. A notification about this will be sent to your Cortex XSIAM console Notification Center.

###### 3.1.2.3.6. Import Broker VM Configuration

####### Important

* This option can only be used on Broker VMs with version 20.0 and later, and is only suitable for importing a configuration of brokers in the same version, or from a broker in an older version to a broker in a newer version.

* If your source Broker VM configuration includes a WEC applet, you'll need to ensure that you update the DNS record of this Broker VM's FQDN to point to the target Broker VM IP address.

###### 3.1.2.3.7. Open Live Terminal

####### Note

* You can either restart_routes or reboot the Broker VM for the changes in the /etc/network/routes file to take affect.

###### 3.1.2.3.8. Add Broker VM to cluster

####### Navigation

  Settings → Configurations → Data Broker → Broker VMs

###### 3.1.2.3.9. Switchover Primary Node in Cluster

####### Navigation

  Settings → Configurations → Data Broker → Broker VMs

###### 3.1.2.3.10. Remove from Cluster

####### Note

* If you've enabled a Load Balancer Health-Check on the cluster, you need to exclude this Broker VM from your Load Balancer settings.

##### 3.1.2.4. Manage Broker VM data collector applets

###### Note

* For more information on the Broker VM applet connectivity status, see Manage Broker VM.

##### 3.1.2.5. Broker VM High Availability Cluster

###### Note

* For Load Balancing, you must install a Load Balancer in your network, which will distribute the incoming data between the nodes.

* The following applets aren't supported when configuring Broker VMs in HA clusters: Cortex Network Scanner and Transporter.

###### 3.1.2.5.1. Configure High Availability Cluster

####### Prerequisite

* Be sure you do the following task before creating a cluster from an existing Broker VM: If the Broker VM is explicitly specified in some Agent Settings profile, which means Cortex XSIAM agents retrieve release upgrades and content updates from this Broker VM, you must change the Broker VM's current designated role. To do this, you need to modify the...

####### Important

* You can only create a new cluster from an existing Broker VM, when the Broker VM version is 19.0 and later, and the STATUS is Connected. The Create a Cluster from this Broker option is only listed if the Broker VM is not already added to a cluster.

* When the Protocol is set to HTTPS, you may need to perform a few follow-up steps to establish a validated secure SSL connection with the Broker VM. If you're using your own Certificate Authority (CA) to sign the certificates, you'll need to place the CA in the client, such as the Load Balancer, and upload the certificates to the Broker VM. If you're...

####### Navigation

  Settings → Configurations → Data Broker → Broker VMs

###### 3.1.2.5.2. Manage Broker VM clusters

####### Navigation

  After you've configured a cluster, you can manage all your Broker VM clusters from the Clusters tab on the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs → Clusters

####### 3.1.2.5.2.1. View cluster details

######## Note

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

######## Navigation

  The Clusters tab of the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs) enables you

####### 3.1.2.5.2.2. Edit cluster

######## Navigation

  Settings → Configurations → Data Broker → Broker VMs, and select the Clusters tab

####### 3.1.2.5.2.3. Add applet to cluster

######## Note

* With Cortex XDR Prevent, it's only relevant to configure a HA cluster with a Local Agent Settings applet as this is the only applet supported for this product license. The other applets are collector applets, which are only available in Cortex XDR Pro or Cortex XSIAM.

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

####### 3.1.2.5.2.4. Add Broker VM to cluster

######## Navigation

  Settings → Configurations → Data Broker → Broker VMs

####### 3.1.2.5.2.5. Remove cluster

######## Navigation

  Settings → Configurations → Data Broker → Broker VMs

##### 3.1.2.6. Broker VM notifications

###### Note

* For more information on upgrading to a new Broker VM image, see Migrating to a New Broker VM Image.

##### 3.1.2.7. Monitor Broker VM activity

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 3.1.2.8. Troubleshoot Broker VM applet errors

###### Note

* For more information on creating correlation rules to trigger collection health issues, see How can I set up correlation rules to trigger collection health issues?.

#### 3.1.3. Dataset management

##### License Type

  Managing Roles requires an Account Admin or Instance Administrator role. For more information, see Predefined user roles.

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

##### Note

* Cold storage, in addition to a cold storage license, requires compute units (CU) to run cold storage queries. For more information on CU, see Manage compute units. For information on the CU add-on license, see Understand the Cortex XSIAM license planUnderstand the Cortex XSIAM license plan.

* Only datasets that are already handled as part of the GB license are supported for this license. In addition, the retention configuration is only available in Cortex XSIAM, as opposed to the public APIs.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default. Datasets include dataset permission enforcements in the Cortex Query Language(XQL), Query Center, and XQL Widgets. For example, to view or access any of the endpoints and host_inventory datasets, you need role-based access control (RBAC)...

* You'll only be able to save the dataset view if the query contains no errors; otherwise, the Save button is disabled.

* For more information on user roles, see Manage user roles.

##### Important

* Cortex XSIAM enforces retention on all log-type datasets excluding Host Inventory, Vulnerability Assessment, Metrics, and Users.

* This column is updated once a day. Therefore, if the dataset was created or updated by the target or lookup flows, it's possible that the Last Updated value is a day behind when the queries or reports were run as it was before this column was updated.

##### 3.1.3.1. What are datasets?

###### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

###### Note

* For more information on tasks specific to lookup datasets, see Lookup datasets.

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

###### Important

* By default, forensic datasets are not included in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

##### 3.1.3.2. Lookup datasets

###### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

###### Note

* A lookup dataset can only be deleted if there are no other dependencies. For example, if a Correlation Rule is based on a lookup dataset, you wouldn't be able to delete the lookup dataset until you removed the dataset from the XQL query of the Correlation Rule.

###### Important

* When you create or add data to a lookup dataset using the target stage, the _time field won't be included by default unless you explicitly add it with the fields stage.

###### 3.1.3.2.1. Import a lookup dataset

####### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

* When uploading a CSV, TSV, or JSON file, ensure that the file meets the following requirements: The maximum size for the total data to be imported into a lookup dataset is 30 MB from the Dataset Management page. Otherwise, the limit is 50 MB using Cortex Query Language (XQL) or APIs. Field names can contain characters from different languages, special...

####### Important

* The name of a dataset created from a TSV file must always include the extension. For example, if the original file name is mrkdptusrsnov23.tsv, you can save the dataset with the name marketing_dept_users_Nov_2023.tsv.

###### 3.1.3.2.2. Download JSON file of lookup dataset

####### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

####### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

###### 3.1.3.2.3. Set time to live for lookup datasets

####### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

####### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

##### 3.1.3.3. Monitor datasets and dataset views activity

###### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 3.1.4. Archived data

##### 3.1.4.1. Import historical data into cold storage

###### License Type

  Importing historical data into cold storage requires a Period-Based Retention - Cold Storage add-on license.

###### Prerequisite

* Importing historical data into cold storage requires a View/Edit RBAC permission for Data Management (under Configurations).

##### 3.1.4.2. Building XQL archived data queries

###### Prerequisite

* Archived cold storage, in addition to a Period-Based Retention - Cold Storage add-on license, requires compute units (CU) to run archived cold storage queries. Cortex XSIAM provides a free daily quota of compute units (CU) allocated according to your license size. Queries run without enough quota will fail. To expand your investigation capabilities,...

##### 3.1.4.3. Success and failure code responses to your HTTP POST requests

#### 3.1.5. Parsing Rules

##### 3.1.5.1. What are Parsing Rules?

###### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

##### 3.1.5.2. Parsing Rules editor views

###### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

##### 3.1.5.3. Parsing Rules file structure and syntax

###### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

###### Note

* For more information on the XQL syntax, see Cortex XQL Language Reference.

* An inner type of join stage is only supported in CONST, INGEST, and RULE sections and is not supported in a COLLECT section. You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

* The regexcapture function is only supported in Parsing Rules and cannot be used in any other XQL query.

* Every statement in the Parsing Rules file must end with a semicolon (;).

###### 3.1.5.3.1. INGEST

####### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

####### Note

* You can't add tags to parsing rules using the Next-Generation Firewall (NGFW) datasets that are in the format panw_ngfw_<text>_raw, and the Observability dataset called panw_observability_raw.

###### 3.1.5.3.2. COLLECT

####### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

####### Note

* The CSV Collector applet is not affected by the COLLECT rules applied to a Broker VM.

####### Tip

* To reduce the amount of data transmitted to Cortex XSIAM from the broker, use filters to drop logs. Yet, be aware that once the logs are modified using alter or fields stages, the Broker VM will convert the original log into a JSON format, which could increase the data size being sent from the broker to Cortex XSIAM.

###### 3.1.5.3.3. CONST

####### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

####### Note

* The dollar sign ($) must be adjacent to the [CONST] name, without any whitespace in between.

####### Important

* Only quoted or integer terminal values are considered valid for CONST sections.

###### 3.1.5.3.4. RULE

####### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

####### Note

* For more information on the XQL syntax, see Get started with XQL.

* You can also add tags using only the INGEST section. For more information, see INGEST.

###### 3.1.5.3.5. EXTEND

####### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

####### Note

* For more information on the XQL syntax, see Get started with XQL.

##### 3.1.5.4. Create Parsing Rules

###### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

###### Note

* You need Cortex XSIAM administrator or Instance Administrator permissions to access the Simulate view and perform these tests.

###### Important

* When creating Parsing Rules, the _time field is a mandatory field. If the field is null or invalid, the _insert_time field is used instead. This field can be automatically parsed depending on the type of data being ingested. For example, for CEF or LEEF logs, the parser first tries to ingest timestamps from these fields in the following order: rt,...

##### 3.1.5.5. Troubleshooting Parsing rules errors

###### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

###### Note

* Some errors can only be found after the applicable logs are collected in Cortex XSIAM.

##### 3.1.5.6. Parsing Rules Raw Dataset

###### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

#### 3.1.6. Data Model Rules

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

##### 3.1.6.1. What are Data Model Rules?

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

##### 3.1.6.2. Data Model Rules editor views

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

##### 3.1.6.3. Data Model Rules file structure and syntax

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

###### Note

* For more information on XQL syntax, see the XQL Language Reference Guide.

* You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

###### 3.1.6.3.1. MODEL

####### Note

* The Settings → Configurations → XQL Configuration → Case Sensitivity (case_sensitive) setting can overwrite this case_sensitive configuration for all fields in the application except for BIOCs, which will remain case insensitive no matter what this setting is set to. For more information on this setting, see XQL Configuration.Set up your...

* We recommend that you do not configure the same data source in both Marketplace and using a Cortex XSIAM data collector. Yet, if you do, the following will happen:External data ingestion For network data, all relevant logs from the different data sources are stitched to the same network story. For authentication data, all relevant logs from the...

###### 3.1.6.3.2. RULE

####### Note

* For more information on the XQL syntax, see the XQL Language Reference Guide.

###### 3.1.6.3.3. Field structure

####### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

####### Note

* For more information on these data model fields, see Cortex XSIAM Data Model Schema.

##### 3.1.6.4. How to map authentication story events?

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

* Familiarize yourself with the Cortex Data model (XDM) schema for field definitions and naming conventions, see Cortex XSIAM Data Model Schema.

###### Important

* This Feature focuses on authentication events related to SSO (Single Sign-On) and SaaS (Software-as-a-Service) application authentications. It does not cover internal authentication mechanisms such as Kerberos, NTLM, or traditional domain logon events generated by on-premise infrastructure.

* To maximize the variety of issues that are retrieved based on the XDM authentication stories, we recommend that the following additional fields are populated: xdm.target.resource_name, xdm.logon.type, xdm.source.user_agent, and xdm.source.host.device_category. Should you decide to change the default XDM mappings, ensure that both the mandatory and...

##### 3.1.6.5. Create Data Model Rules

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

###### Navigation

  In Cortex XSIAM, select Settings → Configurations → Data Management → Data Model Rules

##### 3.1.6.6. Troubleshooting Data Model Rules

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

###### Note

* Since this dataset also contains Parsing Rules errors, some of the fields are irrelevant for Data Model Rules and aren't included in the table.

###### Tip

* To ensure you and your colleagues stay informed about Data Model Rules activity, you can also Configure notification forwarding to forward your Data Model Rules audit logs to an email distribution list or Syslog server. For more information about the Data Model Rules audit logs, see Monitor Data Model Rules activity.

##### 3.1.6.7. Using data enrichment

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

###### Note

* For a complete list of auto-enriched fields, see the Cortex Data Model Schema Guide.

###### Important

* When manually mapping ASN fields that are enriched, such as xdm.source.asn.as_number, with other ISP and domain fields that are not enriched, such as xdm.source.asn.isp and xdm.source.asn.domain, it's possible to receive incorrect XDM query results due to the misalignment between the overridden enrichement and system enrichment fields.

##### 3.1.6.8. Data Model Rules notifications

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

##### 3.1.6.9. Monitor Data Model Rules activity

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 3.1.7. Manage Event Forwarding

##### Prerequisite

* Event Forwarding requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Dataset Management.

##### Note

* After exporting logs, you can download them from GCP for up to 14 days. The Pub/Sub subscription messages are available for 7 days.

* Requires the Endpoints Event Forwarding add-on.

* Requires the GB Event Forwarding add-on

##### Important

* Since data is aggregated and compressed, it may take up to two hours until the data is available in the forwarding bucket.

##### Navigation

  Under Settings → Configurations → Data Management → Event Forwarding, activate one or more of the following: Enable GB Event Forwarding Enable Endpoints Event Forwarding

  Under Settings → Configurations → Data Management → Event Forwarding, activate one or more of the following

##### 3.1.7.1. Endpoints Event Forwarding - included/excluded fields by event type

###### Prerequisite

* Event Forwarding requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Dataset Management.

#### 3.1.8. Manage compute units

##### Note

* For more information, see Import historical data into cold storage.

* The CU consumption of cold storage queries is based on the number of days in the query time frame. For example, when querying 1 hour of a specific day, the CU of querying this entire day is consumed. When querying 1 hour that extends past 2 days, such as from 23:50 to 00:50 of the following day, the CU of querying these two days is consumed.

##### 3.1.8.1. Compute units usage

###### Note

* To enable the add-on, select Settings  → Configurations → Cortex XSIAM License → Addons tile, and select the Compute Unit tile and Enable.

###### Navigation

  Settings → Configurations → Data Management → Compute Unit Usage

### 3.2. Cortex XSIAM Data Sources

#### 3.2.1. What are Cortex XSIAM data sources?

##### Note

* Some content packs provide parsing rules and data model rules for data sources ingested using a Syslog Collector applet of the Broker VM or for standard data sources, and won't be listed in the Data Sources & Integrations page.

##### Important

* We are actively working to evolve the UI to create a single, unified point of configuration for all data ingestion and integration points. This documentation is structured to help you navigate the current segmented process until that UI update is available.

#### 3.2.2. Complete data source catalog

#### 3.2.3. Vendor-specific data sources

##### Important

* In some cases, the same vendor is available through one or more of these options: standard data source, CSP onboarding data source, or content pack integration. Check the available descriptions for each data source in both the user interface and documentation to decide which option is more suitable for your needs.

##### 3.2.3.1. Amazon CloudWatch

###### 3.2.3.1.1. Ingest logs from Amazon CloudWatch

##### 3.2.3.2. Amazon S3

###### 3.2.3.2.1. Ingest audit logs from AWS Cloud Trail

####### Note

* For more information on configuring data collection from Amazon S3 using AWS CloudTrail, see the AWS CloudTrail Documentation.

* For more information on creating an AWS CloudTrail trail, see Create a trail. If you already have an Amazon S3 bucket configured with AWS CloudTrail audit logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* It is your organization's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* The CloudWatch Logs - optional settings are not supported and should be left disabled.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It your organization's responsibility to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

###### 3.2.3.2.2. Ingest network flow logs from Amazon S3

####### Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* To create a new VPC, click Launch VPC Wizard. For more information, see AWS VPC Flow Logs.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex XSIAM.

###### 3.2.3.2.3. Ingest generic logs from Amazon S3

####### License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

####### Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* You need to set up an Amazon S3 data collector to receive generic logs when collecting logs from BeyondTrust Privilege Management Cloud. For more information, see Ingest logs from BeyondTrust Privilege Management Cloud.

* If you want to ingest raw EDR events from SentinelOne DeepVisibility, use the SentinelOne DeepVisibility log collector. For more information, see Ingest raw EDR events from SentinelOne DeepVisibility.

* It is the customer's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It is the responsibility of your organization to ensure that the user who performs this task of creating the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor...

###### 3.2.3.2.4. Ingest network Route 53 logs from Amazon S3

####### Note

* For more information on configuring data collection from Amazon S3 for Route 53 DNS logs, see the AWS Documentation.

* For more information on creating a Stack, see Creating a stack on the AWS CloudFormation console.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex XSIAM.

###### 3.2.3.2.5. Create an assumed role

####### Note

* In AWS this is an optional field to configure, but this must be configured to set up the Amazon S3 Collector in Cortex XSIAM .

* The <s3-arn> and <sqs-arn> placeholders. These will be filled out later depending on which Amazon S3 logs you are configuring, including network flow logs, audit logs, or generic logs.

###### 3.2.3.2.6. Configure data collection from Amazon S3 manually

####### License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

####### Note

* If you already have an Amazon S3 bucket configured with VPC flow logs that you want to use for this configuration, you do not need to perform the prerequisite steps detailed in the first two bullets.

* It is your responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* If you already have an Amazon S3 bucket configured with VPC flow logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

##### 3.2.3.3. Amazon Web Services

##### 3.2.3.4. API Security

###### 3.2.3.4.1. Ingest data for API security

####### 3.2.3.4.1.1. Ingest AWS API Gateway

######## Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

######## Important

* Leave '–'filter-pattern empty as displayed above.

####### 3.2.3.4.1.2. Ingest Azure APIM

######## License Type

  Requires the Data Collection add-on.

######## Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

######## Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

####### 3.2.3.4.1.3. Ingest Apigee Proxy

######## License Type

  Requires the Data Collection add-on.

######## Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

######## Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

####### 3.2.3.4.1.4. Ingest Kong

######## License Type

  Requires the Data Collection add-on.

######## Note

* Contact support to obtain the custom plugin file.

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

######## Important

* The size of the buffer must be equal or larger than the max body size setting in the plugin configuration, on every data plane node.

####### 3.2.3.4.1.5. Ingest-F5

######## License Type

  Requires the Data Collection add-on.

######## Note

* Extract the files from the F5 plugin to a folder before selecting to upload to F5.

* Select panw_apisec_set_ssl_data only if your client SSL profile is enabled.

* The provider for "context_provider" should always be uppercase. Supported providers: AWS, GCP, Azure, On-prem.

##### 3.2.3.5. Azure Event Hub

###### 3.2.3.5.1. Ingest logs from Microsoft Azure Event Hub

####### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

####### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

####### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

##### 3.2.3.6. Azure Network Watcher

###### 3.2.3.6.1. Ingest network flow logs from Microsoft Azure Network Watcher

####### Prerequisite

* For NSG:    Ensure that your NSG flow logs in Azure Network Watcher conform to the requirements as outlined in Microsoft documentation. For more information, see Introduction to flow logging for network security groups.   Enable NSG flow logs in the Microsoft Azure Portal. For NSG: Ensure that your NSG flow logs in Azure Network Watcher conform to the...

####### Note

* In addition to your storage account, the template automatically creates another storage account that is required by the function app for internal use only. The internal storage account name is prefixed with cortex and is followed by a unique suffix based on the resource group, storage account, and container names.

##### 3.2.3.7. BeyondTrust Privilege Management Cloud

###### 3.2.3.7.1. Ingest logs from BeyondTrust Privilege Management Cloud

####### Note

* For a Log Format set to Beyondtrust Cloud ECS, the following fields are automatically set and not configurable. Vendor: Beyondtrust Product: Privilege Management Compression: Uncompressed

##### 3.2.3.8. Box

###### 3.2.3.8.1. Ingest logs and data from Box

####### Prerequisite

* Set up an Enterprise Box plan.  Important To collect Box Shield Alerts, you must purchase Box Shield and it must be enabled on Box enterprise. Set up an Enterprise Box plan. Create a valid Box account that is assigned to a role with sufficient permissions for the data you want to collect. For example, create an account assigned to an Admin role to...

####### Note

* The Fetch Intervals are non-configurable.

* Collecting Box Shield Alerts requires implementing Box Shield,

* There is a current bug with the Groups API from Box. If you don't configure the Box app with the proper permissions for managing groups data, the Groups API from Box won't return an error message to Cortex XSIAM indicating that the API failed to receive the data, and the Groups data will not be collected.

* For any future change that you make to your Box app, ensure that you send the changes for approval to the administrator, who will need to approve them as explained above.

* Inventory data snapshots are collected every 10 minutes.

##### 3.2.3.9. Check Point FW1/VPN1

##### 3.2.3.10. Cisco ASA firewalls and AnyConnect

##### 3.2.3.11. Corelight Zeek

##### 3.2.3.12. Cribl

###### 3.2.3.12.1. Ingest data from Cribl

####### Prerequisite

* Ensure that you have the credentials and IDs for each data source, such as Tenant ID, App ID and Client secret.

* Ensure that you have the copies of the Cortex XSIAM authorization token and API URL obtained in Task 2.

####### Note

* We do not support email data collection via Cribl.

* Only one Cribl data collector instance can be configured in Cortex XSIAM.

* When the logs are in CEF format, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Cribl collector settings. However, when the values are blank in the...

####### Important

* Raw data must be collected by Cribl and streamed as-is from the passed through source, because any changes made by Cribl might affect the way that Cortex XSIAM handles the data.

####### 3.2.3.12.1.1. Data source UUIDs

######## Note

* Do not use this generic UUID when your data source is listed in this table.

##### 3.2.3.13. CrowdStrike APIs

###### 3.2.3.13.1. Ingest alerts and metadata from CrowdStrike APIs

####### Note

* To enable some of the APIs, you may need to reach out to CrowdStrike support.

* For more information on configuring data collection from CrowdStrike APIs, see the CrowdStrike Documentation.

* Ensure that you save the SECRET value because this is the only time that it is displayed.

##### 3.2.3.14. CrowdStrike Falcon Data Replicator

###### 3.2.3.14.1. Ingest raw EDR events from CrowdStrike Falcon Data Replicator

####### Prerequisite

* Ensure that your organization has a license for the CrowdStrike Falcon Data Replicator (FDR). Ensure that CrowdStrike FDR is enabled. CrowdStrike FDR can only be enabled by CrowdStrike Support. If CrowdStrike FDR is not enabled, submit a support ticket through the CrowdStrike support portal. Follow these steps to check if CrowdStrike FDR is...

####### Note

* CrowdStrike can provide multiple streams. It can only be read once per stream. For more information on configuring data collection from CrowdStrike via Falcon Data Replicator, see CrowdStrike documentation.

* Ensure that you copy the Secret, and store it in a safe place. You will not be able to retrieve it later. If you need a new secret, you must reset the feed credentials.

* CrowdStrike Falcon Data Replicator only supports one FDR credential configuration.

* Ensure that you save the SECRET value, because this is the only time that it is displayed. You can go back to this page later to copy the other credentials, but you will not have access to the secret again.

##### 3.2.3.15. Dropbox

###### 3.2.3.15.1. Ingest logs and data from Dropbox

####### Prerequisite

* Set up an Advanced Dropbox plan. Create a Dropbox Business admin account with Security admin permissions, which is required to authorize Cortex XSIAM to access the Dropbox Business account and generate the OAuth 2.0 access token.

####### Note

* The Fetch Interval is non-configurable.

* When the App Key field is empty, the here link in the tooltip is disabled. When an incorrect App Key is entered, clicking the link results in a 404 error.

* Whenever you change the permissions of the Dropbox app, we recommend that you generate a new Access Code for the Dropbox data collector instance so that the permissions match the updates.

* Event data is collected every 60 seconds with a 10 minute lag time.

* Inventory data snapshots are collected every 10 minutes.

##### 3.2.3.16. Elasticsearch Filebeat

###### Note

* You can configure collecting container logs from Google Kubernetes Engine using Elasticsearch Filebeat with a Custom - Filebeat based Collector or with a content pack Integration. For more information, see Google Kubernetes Engine.

###### 3.2.3.16.1. Ingest logs from Elasticsearch Filebeat

##### 3.2.3.17. Forcepoint DLP

##### 3.2.3.18. Fortinet Fortigate

##### 3.2.3.19. Google Cloud Platform

###### 3.2.3.19.1. Ingest logs and data from a GCP Pub/Sub

####### Note

* When collecting flow logs, we recommend that you include GKE annotations in your logs, which enable you to view the names of the containers that communicated with each other. GKE annotations are only included in logs if appended manually using the custom metadata configuration in GCP. For more information, see VPC Flow Logs Overview. In addition, to...

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the GCP data collector settings. Yet, when the values are blank in the...

##### 3.2.3.20. Google Workspace

###### 3.2.3.20.1. Ingest logs and data from Google Workspace

####### Note

* For all types of data collected via the Admin Reports API, except alerts and emails, the log events are collected with a preset lag time as reported by Google Workspace. For more information on these lag times for the different types of data, see Google Workspace Data retention and lag times.

* Spam emails from the compliance email account, and from all other monitored email accounts, are not collected. Any draft emails written in the compliance email account are collected by the Google Workspace data collector, and are then deleted even if the email was never sent.

* For more information on the entire process, see Perform Google Workspace Domain-Wide Delegation of Authority.

* When collecting Google Workspace alerts with other types of data, except emails, you need to configure a service account in Google with the applicable permissions to collect events from the Google Reports API and alerts from the Alert Center API. If you prefer to use different service accounts to collect events and alerts separately, you'll need to...

* For more information on the Admin Reports API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information on the Gmail API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information about the events collected from the various Google Reports, see Google Workspace Reports API Documentation.

##### 3.2.3.21. Google Kubernetes Engine

###### Note

* It's also possible to use a Custom - Filebeat based Collector to ingest logs related to file activity on your endpoints and servers without using the Cortex XDR agent. For more information, see Elasticsearch Filebeat.

###### 3.2.3.21.1. Ingest logs from Google Kubernetes Engine

####### Note

* Cortex XSIAM supports logs in single line format or multiline format. For more information on handling messages that span multiple lines of text in Elasticsearch Filebeat, see Manage Multiline Messages.

##### 3.2.3.22. HTTP log collector

###### 3.2.3.22.1. Set up an HTTP log collector to receive logs

####### Note

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor...

* Each record cannot exceed 5 MB in size.

##### 3.2.3.23. Kubernetes

###### 3.2.3.23.1. Onboard the Kubernetes Connector

####### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security add-on.

####### Note

* This option is not supported for Fargate.

* For Fargate, you must provide the cluster resource identifier. The format of the identifier is arn:aws:eks:<region>:<account-id>:cluster/<cluster-name>.

* Basic authentication is only supported in Posture Management. If deploying Realtime Protection, select None .

###### 3.2.3.23.2. What's new in Kubernetes Connector?

###### 3.2.3.23.3. Supported Kubernetes distributions

####### Note

* In Google Container-Optimized OS release 100 and earlier, where the FANOTIFY EXEC flag is not supported, the Kernel configuration may be partial for the user mode agent to properly function. In such cases, the agent will fallback to asynchronous mode. In RHCOS version 4.12 and earlier, the Kernel configuration may be partial for the user mode agent to...

##### 3.2.3.24. Microsoft Azure

##### 3.2.3.25. Microsoft Defender for Endpoint Events

###### 3.2.3.25.1. Ingest raw EDR events from Microsoft Defender for Endpoint

####### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection. Create an Azure Event Hub. For more information, see Quickstart: Create an event hub using Azure portal.    Create a resource group (optional if you already have a resource group configured).   Create an Event Hubs namespace.   Create an event hub within the namespace....

####### Note

* The generic Cortex XSIAM Azure Event Hub collector does not offer full functionality for EDR data (such as stitching), and is therefore not suitable for EDR data ingestion.

* If you select all event types and leave Event-Hub name empty, an event hub will be created for each category in the selected namespace. If you are not using a Dedicated Event Hubs ClusterEvent Hub, namespaces have a limit of 10 Event Hubs.

##### 3.2.3.26. Microsoft Office 365

###### 3.2.3.26.1. Ingest logs from Microsoft Office 365

####### Note

* Ingesting Microsoft Entra ID (formerly known as Azure AD) authentication and audit events from Microsoft Graph API requires a Microsoft Entra ID P1 or P2 license (formerly Azure Active Directory Premium P1 or P2). Alternatively, if the directory type is Azure AD B2C, the sign-in reports are accessible through the API without any additional license...

* When auditing is turned off from the default setting, you need to first turn on auditing for your organization to collect Microsoft Office 365 audit events from the Management Activity API. Log duplication of up to 5% in Microsoft products is considered normal. In some cases, such as login to a portal using MFA, two log entries are recorded by design.

* To address Azure reporting latency, there is a 10-minute latency period for Cortex XSIAM to receive Azure AD logs.

* You can also implement the corresponding Cortex Data Model (XDM) mappings for these Microsoft Graph Security API v2 alerts using Cortex Marketplace via the Microsoft Graph Security content pack.

* For more information, see the Office 365 Management Activity API schema.

* In FedRAMP environments, Azure sign-in logs are not supported, due to vendor technical constraints.

* Use this option when you don't want to grant permissions for Azure AD Authentication and Azure AD Audit.

##### 3.2.3.27. Microsoft Office 365 (email)

###### 3.2.3.27.1. Ingest logs and data from Microsoft 365

####### License Type

  Email content visibility and licensing: Email subjects and bodies are stored in an encrypted format to ensure data privacy. To view this content or generate alerts for it, an Email Security module license is required. Without the license: Sensitive email content (subject, body, and attachments) remains encrypted and is not accessible for viewing or...

####### Prerequisite

* A user account with the Microsoft Azure Account Administrator role is required to set up a new Microsoft 365 email collector. The following Microsoft Graph API permissions are required:    Mailbox access (read-write)    Read and write mail in all mailboxes   Read contacts in all mailboxes   Read all user mailbox settings      User information, groups,...

####### Note

* For other logs from Microsoft Office 365, use the Office 365 data collector. For more information, see Ingest logs from Microsoft Office 365.

##### 3.2.3.28. Okta

###### 3.2.3.28.1. Ingest logs and data from Okta

####### Prerequisite

* Administrator privileges: Your Okta user must have a role capable of creating API tokens, such as Read-only Administrator, Super Administrator, or Organization Administrator. For more information, see the Okta Administrators Documentation.

##### 3.2.3.29. OneLogin

###### 3.2.3.29.1. Ingest logs and data from OneLogin

####### Note

* Event data is collected every 30 seconds.

* Inventory data snapshots are collected every 10 minutes.

##### 3.2.3.30. Oracle Cloud Infrastructure

##### 3.2.3.31. PingFederate

##### 3.2.3.32. PingOne

###### 3.2.3.32.1. Ingest authentication logs and data from PingOne

####### Navigation

  Reporting → Subscriptions → Add Subscription

##### 3.2.3.33. Proofpoint Targeted Attack Protection

###### 3.2.3.33.1. Ingest logs from Proofpoint Targeted Attack Protection

##### 3.2.3.34. Salesforce.com

###### 3.2.3.34.1. Ingest logs and data from Salesforce.com

####### Prerequisite

* Cortex XSIAM:    To manage collection integration in Cortex XSIAM, ensure that you have the privilege to View/Edit Log Collections (for example, Instance Administrator). Cortex XSIAM: To manage collection integration in Cortex XSIAM, ensure that you have the privilege to View/Edit Log Collections (for example, Instance...

####### Note

* For more detailed reference information, see Configure a Connected App for the OAuth 2.0 Client Credentials Flow. Unlike other data collector setups, in this case, the setup includes obtaining an OAuth 2.0 code from Salesforce.com, and this code is only valid for 15 minutes. Therefore, make sure that you enable the data collector within 15 minutes of...

* When these options are cleared, only these data types will be omitted from collection. All other data will be collected as usual.

##### 3.2.3.35. SentinelOne DeepVisibility

###### 3.2.3.35.1. Ingest raw EDR events from SentinelOne DeepVisibility

####### Prerequisite

* The SentinelOne DeepVisibility logs that will be collected by your dedicated Amazon S3 bucket must adhere to the following guidelines:    Each log file must use the 1 log per line format as multi-line format is not supported.   The log format must be compressed as gzip or uncompressed.   For best performance, we recommend limiting each file size to up...

####### Note

* It is your responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule on the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If you receive an error when trying to save your changes, check that the permissions are set up correctly, and fix them if necessary.

* It is the responsibility of your organization to ensure that the user who creates the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors.

* For more information, see Managing access keys for IAM users.

##### 3.2.3.36. ServiceNow CMDB

###### 3.2.3.36.1. Ingest data from ServiceNow CMDB

##### 3.2.3.37. Windows DHCP via Elasticsearch Filebeat

###### 3.2.3.37.1. Ingest logs from Windows DHCP using Elasticsearch Filebeat

####### Note

* To avoid formatting issues in filebeat.yml, we recommend that you edit the text file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating the profile.

* For more information on configuring the filebeat.yml file, see the Elastic Filebeat Documentation.

* To avoid formatting issues in your filebeat.yml, we recommend that you use the download example file to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your file.

* The tokenizer definition is dependent on the Windows server version that you are using as the log format differs. -For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" -For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{mac...

##### 3.2.3.38. Workday

###### 3.2.3.38.1. Ingest report data from Workday

####### Prerequisite

* Create an Integration System User that is designated to access the custom report from Workday for data collection in Cortex XSIAM. Create an Integration System Security Group for the Integration System User created in Step 1 for accessing the report. When setting this group ensure to define the following:    Type of Tenanted Security Group: Select...

####### Note

* Any user with permissions to view issues and cases can view the Workday data.

* For more information on completing any of the prerequisite steps, see the Workday documentation.

* The Business Object changes depending on the Data Source selected.

* Cortex XSIAM uses a structured schema when integrating Workday data. To get the best Analytics results, specify all the fields marked with an asterisk from the recommended schema. workday_user_id* full_name* workday_manager_user_id* manager* worker_type* position_title* department* private_email_address* business_email_address* employment_start_date* em...

##### 3.2.3.39. Zscaler Internet Access

##### 3.2.3.40. Zscaler Private Access

#### 3.2.4. Cloud service provider (CSP) onboarding

##### 3.2.4.1. Ingest cloud assets

###### Note

* The cloud accounts being onboarded must be owned by the customer performing the onboarding process.

##### 3.2.4.2. Onboard Amazon Web Services

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Security add-ons. For Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses, see Onboard Amazon Web Services with basic configuration.

###### Prerequisite

* Ensure you have access to AWS Management Console. Ensure you have the Required AWS permissions.

###### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* When onboarding an AWS organization or organizational unit (OU), Cortex XSIAM creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

###### 3.2.4.2.1. Onboard Amazon Web Services with basic configuration

####### License Type

  Onboarding Amazon Web Services (AWS) using the basic configuration is included with Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses. For onboarding AWS with a Cortex XSIAM Premium license, see Onboard Amazon Web Services.

####### Prerequisite

* Ensure you have access to AWS Management Console. Ensure you have the Required AWS permissions.

####### Note

* When onboarding an AWS organization or organizational unit (OU), Cortex XSIAM creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

###### 3.2.4.2.2. Manually upload template to AWS

####### Prerequisite

* Before you begin, ensure you have: An AWS account Access to AWS Management Console Permission to create a stack and its resources in AWS CloudFormation

####### Note

* You must ensure that the KMS key region and the SNS topic region are the exact same as the AWS region where you are deploying the CloudFormation stack.

###### 3.2.4.2.3. Configure AWS integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

##### 3.2.4.3. Onboard Google Cloud Platform

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Security add-ons. For Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses, see Onboard Google Cloud Platform with basic configuration.

###### Prerequisite

* Ensure you have cccess to Google Cloud Console. Ensure you have an admin user with the required admin GCP permissions. Ensure you have the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled)   If you plan on enabling Automation as...

###### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* If you want to connect to your GCP Workspace, you must first complete onboarding with the option disabled. Once the GCP cloud instance is created, perform the steps detailed in Connect Google Workspace with your GCP cloud instance.

###### 3.2.4.3.1. Onboard Google Cloud Platform with basic configuration

####### License Type

  Onboarding Google Cloud Platform (GCP) using the basic configuration is included with Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses. For onboarding GCP with a Cortex XSIAM Premium license, see Onboard Google Cloud Platform.

####### Prerequisite

* Ensure you have cccess to Google Cloud Console. Ensure you have an admin user with the required admin GCP permissions. Ensure you have the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled)   If you plan on enabling Automation as...

###### 3.2.4.3.2. Manually upload template to GCP

####### Prerequisite

* Before you begin, ensure you have: A GCP account. Permission to create the required resources in Google Cloud Deployment Manager. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool. Reviewed the...

####### Note

* The directory you create must be a subdirectory of the home directory.

####### Important

* You must not delete or move the Terraform files from this folder. It will prevent you from being able to edit your cloud instance in the future.

###### 3.2.4.3.3. Connect Google Workspace with your GCP cloud instance

####### Prerequisite

* Ensure you have the Super Admin role in Google Workspace.

* Ensure you have the organization ID of the Google Workspace you want to connect:    Log in to your Google Admin Console. and navigate to Account → Account settings → Profile. Next to Customer ID is your organization ID. Ensure you have the organization ID of the Google Workspace you want to connect: Log in to your Google Admin Console. and navigate...

###### 3.2.4.3.4. Configure GCP integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

###### 3.2.4.3.5. Monitor GCP resources inside service perimeters

####### Note

* Each GCP cloud instance is assigned a scope within GCP. If the scope, whether it be organization, folder, or project, includes any projects with a service perimeter, this procedure must be performed for that cloud instance to authorize Cortex XSIAM to scan the resources in the perimeter.

##### 3.2.4.4. Onboard Microsoft Azure

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Security add-ons. For Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses, see Onboard Microsoft Azure with basic configuration.

###### Prerequisite

* Ensure you have a Microsoft Azure subscription. Ensure you have the admin permissions required to onboard Microsoft Azure or the built-in Security Administrator role. Obtain the tenant ID and subscription ID. You can view these in the Microsoft Azure Portal in Management groups.

###### 3.2.4.4.1. Onboard Microsoft Azure with basic configuration

####### License Type

  Onboarding Microsoft Azure using the basic configuration is included with Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses. For onboarding Microsoft Azure with a Cortex XSIAM Premium license, see Onboard Microsoft Azure.

####### Prerequisite

* Ensure you have a Microsoft Azure subscription. Ensure you have the admin permissions required to onboard Microsoft Azure or the built-in Security Administrator role. Obtain the tenant ID and subscription ID. You can view these in the Microsoft Azure Portal in Management groups.

###### 3.2.4.4.2. Finalize Microsoft Azure onboarding by executing the authentication template

####### Prerequisite

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the relevant scope (subscription, management group, tenant). We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed Terraform on your local machine. You can...

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the relevant scope (subscription, management group, tenant). We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed the Azure CLI tool. Authorization to create...

####### Important

* Do not delete or move the Terraform files from this folder. It will prevent you from being able to edit your cloud instance in the future.

###### 3.2.4.4.3. Configure Azure integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

##### 3.2.4.5. Onboard Oracle Cloud Infrastructure

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Security add-ons. For Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses, see Onboard Oracle Cloud Infrastructure with basic configuration.

###### Prerequisite

* Ensure you have access to the Oracle Cloud Infrastructure console Permissions for all of the following are required:    Creation of identity groups (for more information, refer to Managing Groups)   Policies (for more information, refer to How Policies Work)   Tag namespaces in the root compartment (for more information, refer to Tags and Tag Namespace...

###### Note

* Excluded compartments are not visible in Cortex XSIAM. Additional Security Capabilities: Enable additional Cortex XSIAM security add-ons, if available. This may require additional cloud provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. The additional security capabilities you can enable include: Data security posture management: An agentless multi-cloud data security solution that discovers, classifies, protects, and governs sensitive data. Serverless functions scanning (Gen 1 only): Implement serverless scanning to detect and remediate vulnerabilities within serverless functions during the development lifecycle. Seamless integration into CI/CD pipelines enables automated security scans for a continuously secure pre-production environment. Registry scanning: Scan container registry images for vulnerabilities. malware, and secrets. You can configure your initial preference for scanning your registry. Any newly discovered registry, repository, or image in the account will be scanned by default. For more details, see Configure registry scanning for cloud accountsConfigure registry scanning for cloud accounts Agentless disk scanning: (Recommended) Implement agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Additional Security Capabilities: Enable additional Cortex XSIAM security add-ons, if available. This may require additional cloud provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. The additional security capabilities you can enable include: Data security posture management: An agentless multi-cloud data security solution that discovers, classifies, protects, and governs sensitive data. Serverless functions scanning (Gen 1 only): Implement serverless scanning to detect and remediate vulnerabilities within serverless functions during the development lifecycle. Seamless integration into CI/CD pipelines enables automated security scans for a continuously secure pre-production environment. Registry scanning: Scan container registry images for vulnerabilities. malware, and secrets. You can configure your initial preference for scanning your registry. Any newly discovered registry, repository, or image in the account will be scanned by default. For more details, see Configure registry scanning for cloud accountsConfigure registry scanning for cloud accounts Agentless disk scanning: (Recommended) Implement agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Cloud Tags: Define tags and tag values to be added to any new resource created by Cortex XSIAM in the cloud environment. Note: The managed_by = paloaltonetworks tag is automatically added to all resources. This tag is mandatory. You cannot edit or remove this tag. Log Collection Configuration: To maximize security coverage, enable the collection of audit logs. This may require additional cloud service provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Enter the following details for each preexisting OCI storage bucket that you intend to use for log collection: Region: The geographic OCI region where the bucket is located. For example, "us-phoenix-1". Bucket Name: The name of the OCI storage bucket. Compartment OCID: The Oracle Cloud Identifier (OCID) of the compartment that contains the bucket. Log Collection Configuration: To maximize security coverage, enable the collection of audit logs. This may require additional cloud service provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Enter the following details for each preexisting OCI storage bucket that you intend to use for log collection: Region: The geographic OCI region where the bucket is located. For example, "us-phoenix-1". Bucket Name: The name of the OCI storage bucket. Compartment OCID: The Oracle Cloud Identifier (OCID) of the compartment that contains the bucket. Download the OCI authentication template by clicking Download Terraform. The Terraform authentication template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The Terraform authentication template is valid for seven days from when it was created. Download the OCI authentication template by clicking Download Terraform. The Terraform authentication template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The Terraform authentication template is valid for seven days from when it was created. Cortex XSIAM generates a Terraform authentication template based on the settings you configured in the OCI onboarding wizard. Next step: Apply the Terraform authentication template in OCI. 3.2.4.5.1 |Onboard Oracle Cloud Infrastructure with basic configuration LICENSE TYPE: Onboarding Oracle Cloud Infrastructure (OCI) using the basic configuration is included with Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses. For onboarding OCI with a Cortex XSIAM Premium license, see Onboard Oracle Cloud Infrastructure.

###### 3.2.4.5.3. Configure the OCI connector for log collection

##### 3.2.4.6. Manually connect a cloud instance

##### 3.2.4.7. Edit your onboarded CSP configuration

###### Important

* When using Terraform authentication templates, you must execute the updated Terraform template from the same folder where the original Terraform template was executed.

##### 3.2.4.8. Outposts

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM product that has the Cloud Runtime Security add-on.

###### Important

* Outpost scan is an alternative to the recommended standard cloud scan. Cloud scan is recommended because it is fully managed by Palo Alto Networks and incurs no compute costs for your organization. Outpost scan is an advanced deployment model reserved for specific data residency or architectural requirements.

###### 3.2.4.8.1. Outpost fundamentals and planning

####### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM product that has the Cloud Runtime Security add-on.

####### Note

* Before you create your outpost, verify that your internet connection is active. An active internet connection is necessary for the notification to be sent to Cortex XSIAM to create the new outpost.

####### Important

* While outposts provide maximum control over the scanning environment, cloud scan mode is the recommended default for most organizations.

####### Navigation

  Before onboarding your Cortex XSIAM with the cloud service provider (CSP) onboarding wizard, create an outpost by navigating to Settings → Data Sources & Integrations → Outposts

  Settings → Data Sources & Integrations → Add New

  View and manage existing outposts by navigating to Settings → Data Sources & Integrations → Outposts

###### 3.2.4.8.2. Create an outpost

####### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM product that has the Cloud Runtime Security add-on.

####### Prerequisite

* Before you begin, ensure you have: An AWS account Permission to create a stack and its resources in AWS Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the AWS CLI tool and configured your profile with the aws...

* Before you begin, ensure you have: A GCP account Permission to create the required resources in Google Cloud Deployment Manager Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool

* Before you begin, ensure you have: An active Azure subscription. Installed the Azure CLI tool. Permission to deploy a custom template and create its resources in Microsoft Azure ("Owner" or "Contributor" on the designated outpost subscription scope, and Active Directory "Cloud Application Administrator" or "Application Administrator" privileged...

####### Note

* Verify that your internet connection is active. An active internet connection is necessary for notifications to be sent to Cortex XSIAM for creating the new outpost. If you are unable to establish an internet connection, contact customer support for a manual workaround.

* When creating an outpost for a specific Azure subscription, the outpost account must be in the same Azure organization as the monitored subscriptions.

####### Important

* While outposts provide maximum control over the scanning environment, cloud scan mode is the recommended default for most organizations. For details, see When to choose outpost scan.

####### Navigation

  Start the outpost creation wizard by navigating to Settings → Data Sources & Integrations → Outposts and clicking New Outpost

  A new outpost is created in pending status and can be viewed in the Outpost page at Settings → Data Sources & Integrations → Outposts

##### 3.2.4.9. Introduction to Terraform for Cloud service provider (CSP) onboarding

###### Important

* Always run these commands in the same folder where the original .tf files and .terraform folder live—this is where the state is stored.

* This .tfstate state file is critical because it is needed by the terraform destroy command to clean up created resources. It is critical that you never delete this file.

##### 3.2.4.10. Container Registry Scanning

###### 3.2.4.10.1. Overview of container registry scanning

####### 3.2.4.10.1.1. Registry Components

####### 3.2.4.10.1.2. How Container Registry Scanning Works

###### 3.2.4.10.2. Configure registry scanning for cloud accounts

####### Prerequisite

* Ensure that you have performed the all steps till Additional Security Capabilities as listed in the onboarding wizard for the required CSP: Onboard Amazon Web ServicesOnboard Amazon Web Services Onboard Google Cloud PlatformOnboard Google Cloud Platform Onboard Microsoft AzureOnboard Microsoft Azure Onboard Oracle Cloud InfrastructureOnboard Oracle...

###### 3.2.4.10.3. Modify the container registry scanning scope

###### 3.2.4.10.4. Scan re-evaluation process

###### 3.2.4.10.5. Connect Docker Hub registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 3.2.4.10.5.1. Manage a Docker Hub connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 3.2.4.10.6. Connect Docker V2 compliant container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 3.2.4.10.6.1. Manage a Docker V2 connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 3.2.4.10.7. Connect GitLab container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

####### Note

* When both the group ID and project ID are provided, the system retrieves container images from all projects within the specified group as well as from the specified project. If neither the group ID nor the project ID is provided, the system retrieves container images from all registries (across all groups and projects) accessible to the authenticated...

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 3.2.4.10.7.1. Manage a Gitlab Container Registry connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 3.2.4.10.8. Connect Harbor registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 3.2.4.10.8.1. Manage a Harbor connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 3.2.4.10.9. Connect JFrog container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 3.2.4.10.9.1. Manage a JFrog connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 3.2.4.10.10. Connect Sonatype Nexus registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

####### Note

* If you are using a CA certificate, enter the server IP address instead of the registry url.

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* If you are using a CA certificate, enter the server IP address instead of the registry URL.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 3.2.4.10.10.1. Manage a Sonatype connector

######## Note

* If you had selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

##### 3.2.4.11. Cloud service provider permissions

###### 3.2.4.11.1. Amazon Web Services provider permissions

###### 3.2.4.11.2. Google Cloud Platform provider permissions

###### 3.2.4.11.3. Microsoft Azure provider permissions

###### 3.2.4.11.4. Oracle Cloud Infrastructure provider permissions

#### 3.2.5. Generic on-premise data collectors

##### 3.2.5.1. Broker VM data collector applets

###### 3.2.5.1.1. Activate Apache Kafka Collector

####### Prerequisite

* Apache Kafka version 2.5.1 and above. Kafka cluster set up on premises, from which the data will be ingested. Privileges to manage Broker Service configuration, such as Instance Administrator privileges. Create a user in the Kafka cluster with the necessary permissions and the following authentication details:    Broker Certificate and Private Key for...

####### Note

* For CEF and LEEF logs, Cortex XSIAM takes the vendor and product names from the log itself, regardless of what you configure on this page.

###### 3.2.5.1.2. Activate Cortex Network Scanner

####### License Type

  Requires the Exposure Management add-on.

####### Prerequisite

* Review the Cortex Network Scanner deployment recommendations and complete any prerequisites. Set up and configure Broker VM

####### Important

* The Cortex Network Scanner applet is not supported for FedRAMP customers. Cortex Network Scanner does not support high availability (HA) Broker VM configuration.

####### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  Settings → Configurations → Network Scanners → Network Scanners and find your new scanner in the list

###### 3.2.5.1.3. Activate CSV Collector

####### Prerequisite

* Set up and configure Broker VM. Ensure that you share the applicable CSV files. Know the complete file path for the Windows directory.

####### Note

* When you implement a wildcard file search, ensure that the CSV files share the same columns and header rows as all other logs that are collected from the CSV files to create a single dataset.

* The CSV Collector checks for new CSV files every 10 minutes.

###### 3.2.5.1.4. Activate Database Collector

####### Prerequisite

* Set up and configure Broker VM

####### Note

* The reference data ingested using the DB Collector is counted towards license utilization.

####### Important

* When configuring the DB collector to work with an Oracle database and enabling this option, ensure the following steps are completed for a successful connection: Ensure you have the certificate of the Database server. Upload certificate to Broker CA Trust Store (Conditional): This step is only required if the Oracle server's certificate is self-signed...

###### 3.2.5.1.5. Activate DSPM Fileshare

####### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

####### Prerequisite

* Set up and configure Broker VM Know the complete path to the files and folders that you want Cortex XSIAM to monitor. Necessary user permissions to access the network shares. For the SMB connection type, you need the user name and password.

####### Note

* The applet list displays only the applets for which you have permissions.

* By default, all configured connections are saved.

* For details regarding the connection fields, see the table above under File Share Connection.

* You can add multiple connections under a single instance of the DSPM Fileshare applet by returning to the File Share Connection screen and clicking Add Connection. Each new connection can be of either the NFS or SMB connection type.

###### 3.2.5.1.6. Activate Files and Folders Collector

####### Prerequisite

* Set up and configure Broker VM. Know the complete path to the files and folders that you want Cortex XSIAM to monitor. Ensure that the user permissions for the network share include the ability to rename and delete files in the folder that you want to configure collection.

####### Note

* Cortex XSIAM only supports ingestion of files encoded in UTF-8 format.

* When using the Linux file share, including the Linux share with NFS, a Username and Password are not required, so these fields are grayed out in the screen.

* In Batch mode, the Files and Folders Collector supports collecting logs from a network share for a maximum file size of 500 MB.

* When uploading JSON files, Cortex XSIAM only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* When the storing method is Replace, the maximum size for the total data to be imported into a lookup dataset is 30 MB each time the data is fetched. The inventory data ingested using the Files and Folders collector is counted towards license utilization. When you use a JOINT function with a lookup table in a query or correlation rule, make sure you...

* You can't specify a file name that's the same as a system file name. The name of a dataset created from a tsv file must always include the extension. If the original file name is mrkdptusrsnov23.tsv, you can name save the dataset with the name marketing_dept_users_Nov_2023.tsv.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

###### 3.2.5.1.7. Activate FTP Collector

####### Prerequisite

* Set up and configure Broker VM. Ensure that the user permissions for the FTP, SFTP, or FTPS include the ability to rename and delete files in the folder that you want to configure collection. When setting up an FTPS Collector with a server using a Self-signed certificate, you must upload the certificate first to the Broker VM as a Trusted CA...

####### Note

* When configuring an SFTP connection, Cortex XSIAM expects the private key to be in the RSA format that is included in the -----BEGIN RSA PRIVATE KEY----- tag. Cortex XSIAM does not support providing the private key in the OpenSSH format from the -----BEGIN OPENSSH PRIVATE KEY----- tag. When using ssh-keygen using a Mac, you get the OpenSSH format by...

* When uploading JSON files, Cortex XSIAM only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

###### 3.2.5.1.8. Activate Local Agent Settings

####### License Type

  Requires Cortex XSIAM Enterprise, Premium, or any other XSIAM license that includes endpoints or Cortex Cloud Runtime Security.

####### Note

* This is assuming a standard hardware setup with 2vCPU 8 GB memory.

* Broker VMs can act as as a proxy for routing XDR Collector traffic to the Cortex XSIAM tenant. The Broker VM does not cache XDR Collector installers.

* When you install your XDR agents, you need to configure the IP address of the Broker VM and a port number during the installation. You can use the default 8888 port or set a custom port. You are not permitted to configure port numbers between 0-1024 and 63000-65000, or port numbers 4369, 5671, 5672, 5986, 6379, 8000, 9100, 15672, 25672. Additionally,...

####### Important

* A FQDN must be configured for WEC and Agent Installer and Content Caching to function properly.

* You can only enable Agent Installer and Content Caching, when in the Broker VM Configuration, you've uploaded your signed SSL Server Certificate and key and set the FQDN. For more information, see the Agent Installer and Content Caching requirements explained above.

###### 3.2.5.1.9. Activate NetFlow Collector

####### Prerequisite

* Set up and configure Broker VM

####### Note

* Since multiple network devices can send data to a single NetFlow Collector, we recommend that you configure a maximum of 50 NetFlow Collectors per Broker VM applet, with a maximum aggregated rate of approximately 50K flows per second (FPS) to maintain system performance.

* Since Cortex XSIAM reserves some port numbers, it is best to select a port number that is not in the range of 0-1024 (except for 514), in the range of 63000-65000 or has one of the following values: 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672.

* The options available change, according to the set Source Network value.

###### 3.2.5.1.10. Activate Network Mapper

####### License Type

  Requires Cortex XSIAM Enterprise, Premium, or any other XSIAM license that includes endpoints or Cortex Cloud Runtime Security.

####### Prerequisite

* After you have configured and registered your Broker VM, you can choose to activate the Network Mapper application.

####### Note

* Each IP address range can receive multiple scan requests based on it's availability.

* IP address ranges are displayed according to what you defined as your Network Parameters.

###### 3.2.5.1.11. Activate Registry Scanner

####### License Type

  Requires the Cortex XSIAM Premium license or any other XSIAM license with the Cloud Posture Security or the Cloud Runtime Security add-on.

####### Prerequisite

* To initialize registry scanning on your Broker VM, you must first add the necessary data connectors. For details, see:    Connect Docker Hub registry   Connect Docker V2 compliant container registry   Connect GitLab container registry   Connect Harbor registry   Connect JFrog container registry   Connect Sonatype Nexus registry To initialize registry...

####### Note

* You cannot activate the Registry Scanner directly on a new or existing Broker VM. You can only activate or deactivate existing Registry Scanner applets. To activate or deactivate existing applets, see Step 4 under Verify Registry Scanner connection section.

####### Navigation

  Settings → Configurations → Data Broker → Broker VMs

###### 3.2.5.1.12. Syslog Collector applet

####### 3.2.5.1.12.1. Activate Syslog Collector

######## Prerequisite

* Set up and configure Broker VM

######## Note

* Once configured, you cannot change the Port/PROTOCOL. If you don't want to use a data source, ensure to remove the data source from the list as explained in Task 5.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and...

* The server certificate and private key pair is expected in a PEM format. Cortex XSIAM will notify you when your certificates are about to expire.

* Because some port numbers are reserved by Cortex XSIAM , you must choose a port number that is not: In the range of 0-1024 (except for 514) In the range of 63000-65000 Values of 4052, 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672

* CORELIGHT is not available for a UDP protocol.

######## Navigation

  Settings → Configurations → Data Broker → Broker VMs

####### 3.2.5.1.12.2. Ingest logs from a Syslog receiver

####### 3.2.5.1.12.3. Check Point FW1/VPN1

######## 3.2.5.1.12.3.1. Ingest logs from Check Point firewalls

####### 3.2.5.1.12.4. Cisco ASA firewalls and AnyConnect

######## 3.2.5.1.12.4.1. Ingest logs from Cisco ASA firewalls and AnyConnect

####### 3.2.5.1.12.5. Corelight Zeek

######## 3.2.5.1.12.5.1. Ingest logs from Corelight Zeek

####### 3.2.5.1.12.6. Forcepoint DLP

######## 3.2.5.1.12.6.1. Ingest logs from Forcepoint DLP

####### 3.2.5.1.12.7. Fortinet Fortigate

######## 3.2.5.1.12.7.1. Ingest logs from Fortinet Fortigate firewalls

####### 3.2.5.1.12.8. Next-Generation Firewall

######## 3.2.5.1.12.8.1. Ingest Next-Generation Firewall logs using the Syslog collector

####### 3.2.5.1.12.9. PingFederate

######## 3.2.5.1.12.9.1. Ingest authentication logs from PingFederate

####### 3.2.5.1.12.10. Zscaler Internet Access

######## 3.2.5.1.12.10.1. Ingest logs from Zscaler Internet Access

####### 3.2.5.1.12.11. Zscaler Private Access

######## 3.2.5.1.12.11.1. Ingest logs from Zscaler Private Access

###### 3.2.5.1.13. Activate Transporter

####### License Type

  Included in the Cortex XSIAM Premium license. It is also included with any other XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

####### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator) Set up and configure Broker VMSet up and configure Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex XSIAM resources. The IP addresses...

####### Warning

* The Transporter applet is not supported for FedRAMP customers.

####### Navigation

  Settings → Configurations → Broker VMs (under Data Broker

  the Brokers tab → locate your Broker VM → hover and click + Add under the Apps column → AppSec Transporter

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

###### 3.2.5.1.14. Activate Windows Event Collector

####### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

####### Note

* You can also activate the Windows Event Collector on Windows Core. For more information, see Activate Windows Event Collector on Windows Core.

* By default, Cortex XSIAM collects Palo Alto Networks predefined Security events that are used by the Cortex XSIAM detectors. Removing the Security collector interferes with the Cortex XSIAM detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

####### 3.2.5.1.14.1. Activate Windows Event Collector on Windows Core

######## Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

######## Note

* By default, Cortex XSIAM collects Palo Alto Networks predefined Security events that are used by the Cortex XSIAM detectors. Removing the Security collector interferes with the Cortex XSIAM detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

####### 3.2.5.1.14.2. Renew WEC certificates

######## Note

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* You can see more than one ca.wec.paloaltonetworks.com and forwarder.wec.paloaltonetworks.com file from a previous installation in the directory, so select the file with the most extended Expiration Date. You can verify that you are using the correct certificate: To verify the client certificate in the Personal → Certificates folder is related to the...

* Only perform this step under the following conditions: You have completed the WEF certification renewal process for ALL clients in your environment. Otherwise, events from the WEFs that you did not install the new client certificate will not be collected by the WEC. You are approaching the WEC server CA certificate expiration date, which is 2 years...

* If this query does not display results with a timestamp from after the renewal process, it could indicate that the renewal process is not complete, so wait a few minutes before running another query. If you are still having a problem, contact Technical Support.

######## Important

* After you receive a notification for renewing your WEC CA certificate, we recommend that you do not add any new WEF clients until the WEC certification renewal process is complete. Events from these WEF clients that are added afterwards will not be collected by the server until the WEC certificates are renewed.

##### 3.2.5.2. XDR Collectors

###### Note

* Ingestion of log events larger than 5 MB is not supported.

###### 3.2.5.2.1. XDR Collector audit logs

###### 3.2.5.2.2. XDR Collector machine requirements and supported operating systems

###### 3.2.5.2.3. Resources required to enable access to XDR Collectors

####### Note

* Some of the IP addresses required for access are registered in the United States. As a result, some GeoIP databases do not correctly pinpoint the location in which IP addresses are used. All customer data is stored in your deployment region, regardless of the IP address registration and restricts data transmission through any infrastructure to that...

* Throughout this topic, <xsiam-tenant> refers to the chosen subdomain of your Cortex XSIAM tenant and <region> is the region in which your Strata Logging Service is deployed.

###### 3.2.5.2.4. Manage XDR Collectors

####### 3.2.5.2.4.1. XDR Collectors installation resource for Windows and Linux

######## Note

* In some circumstances, such as after an XDR Collectors upgrade, the configured settings in the XML configuration file can be erased. Yet, this won't affect the saved settings in the XDR Collectors database.

####### 3.2.5.2.4.2. Create an XDR Collector installation package

######## Note

* XDR Collectors cannot be moved between Cortex XSIAM managing servers. In this situation, you need to uninstall the existing collector, and then install a new collector using an installation package from the new managing server. For more information on uninstalling, see Uninstall the XDR Collector.

* Since Cortex XSIAM relies on the installation package ID to approve XDR Collector registration during install, it is not recommended to delete the installation package for any active on-premise collector machines. Hiding the installation package will remove it from the default list of available installation packages, and can be useful to eliminate...

####### 3.2.5.2.4.3. Install the XDR Collector installation package for Windows

######## 3.2.5.2.4.3.1. Install the XDR Collector on Windows using the MSI

######## 3.2.5.2.4.3.2. Install the XDR Collector on Windows using Msiexec

####### 3.2.5.2.4.4. Install the XDR Collector installation package for Linux

######## Note

* We recommend that you perform a Linux RPM or Linux DEB installation.

* If the XDR Collector does not connect to Cortex XSIAM, verify your Internet connection on the collector machine. If the XDR Collector still does not connect, verify the installation package has not been removed from the Cortex XSIAM management console.

* The XDR Collector does not support proxy communication in environments where proxy authentication is required.

######## Important

* When performing a XDR Collector installation or upgrade in Linux using a shell installer, the  /tmp folder cannot be marked as noexec. Otherwise, the installation or upgrade fails. As a workaround, before the installation or upgrade, use the following command:

####### 3.2.5.2.4.5. Configure the XDR Collector upgrade scheduler

######## Navigation

  In Cortex XSIAM, select Settings → Configurations → XDR Collectors → Configuration

####### 3.2.5.2.4.6. Set an application proxy for XDR Collectors

######## Navigation

  In Cortex XSIAM, select Settings → Configurations → XDR Collectors → Administration

####### 3.2.5.2.4.7. Set an alias for an XDR Collector machine

######## Navigation

  Settings → Configurations → XDR Collectors → Administration

####### 3.2.5.2.4.8. Upgrade XDR Collectors

######## Note

* The XDR Collector keeps the name of the original installation package after every upgrade.

####### 3.2.5.2.4.9. Uninstall the XDR Collector

######## Navigation

  Settings → Configurations → XDR Collectors → Administration

  Investigation & Response → Response → Action Center

###### 3.2.5.2.5. Define XDR Collector machine groups

####### Note

* XDR Collectors only support IPv4 addresses.

* Disconnecting Directory Sync in your Cortex XSIAM deployment can affect existing collector machine groups and policy rules based on Active Directory properties.

###### 3.2.5.2.6. About Cortex XDR Collector content updates

###### 3.2.5.2.7. XDR Collector profiles

####### 3.2.5.2.7.1. Add an XDR Collector profile for Windows

######## Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex XSIAM collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex XSIAM supports logs in single line format or multiline format. For more...

######## 3.2.5.2.7.1.1. Ingest logs from Windows DHCP using Elasticsearch Filebeat

######## 3.2.5.2.7.1.2. Ingest Windows DNS debug logs using Elasticsearch Filebeat

####### 3.2.5.2.7.2. Add an XDR Collector profile for Linux

######## Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex XSIAM collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex XSIAM supports logs in single line format or multiline format. For more...

###### 3.2.5.2.8. Apply profiles to collection machine policies

####### Navigation

  Settings → Configurations → XDR Collectors → Policies → +Add Policy

###### 3.2.5.2.9. XDR Collector datasets

###### 3.2.5.2.10. Troubleshoot XDR Collectors errors

####### Note

* For more information on creating correlation rules to trigger collection health issues, see How can I set up correlation rules to trigger collection health issues?.

#### 3.2.6. Palo Alto Networks integrations

##### License Type

  Data collection may require an add-on.

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

##### 3.2.6.1. About Palo Alto Networks integrations

###### Note

* For Palo Alto Networks Integrations there is an option to turn on or off the collection of URL and File log types. For more information, see Collecting URL and File log types.

* Roll-back of Strata Logging Service integration migration is not supported.

##### 3.2.6.2. Next-Generation Firewall

###### 3.2.6.2.1. Ingest data from Next-Generation Firewall

####### Prerequisite

* Ensure that you have completed the following on the NGFW or Panorama side: For Panorama only, ensure that the Panorama Cloud Services plugin is installed. Enable log forwarding profiles on firewall rules. On the Cortex XSIAM side, ensure that you have user role permissions for Data Collection > Data Sources & Integrations. Configuration of data...

####### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* If your firewalls are located in a different region, or bandwidth issues are encountered due to large log size, you can ingest NGFW logs in CEF format, using the Syslog collector. However, the Syslog solution is not as powerful nor as comprehensive as this data collector, and should only be used when this data collector cannot be used. For more...

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version.

* Cortex XSIAM does not validate your firewall credentials, you must ensure the certificates or PSK details have been updated in your firewalls in order for data to stream.

* It can take an hour or longer after connecting the firewall in Cortex XSIAM until you start seeing notifications that the certificate has been approved, and that the logging service license has appeared on the firewall.

* IOC and BIOC issues are applicable on stitched data only, and are not available on raw data.

####### Tip

* You can see an overview of ingestion status for all log types, and a breakdown of each log type and its daily consumption quota on the NGFW Ingestion Dashboard.

###### 3.2.6.2.2. Ingest Next-Generation Firewall logs using the Syslog collector

####### Note

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version, to ensure that you have configured log forwarding correctly for all the log types that you would like to forward to Cortex XSIAM. The following steps only cover...

* To avoid the possible effects of line formatting, do not copy/paste the message formats directly into the PAN-OS web interface. Instead, paste into a text editor, remove any carriage return or line feed characters, and then copy and paste into the web interface.

* From version 10.0 and later, the log format documented for log types (Traffic, Threat, and URL) exceeds the maximum supported 2048 characters in the Custom Log Format tab on the firewall and Panorama. Select the CEF keys and values to limit the number of characters to 2048, as per your requirements.

##### 3.2.6.3. Ingest data from Prisma Access

###### Prerequisite

* Configuration of data ingestion from multiple accounts requires Super User permissions in both Cortex XSIAM tenant and Prisma Access accounts.

###### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* Cortex XSIAM does not validate your Prisma Access account credentials. You must ensure the account has been deployed in order for data to stream.

##### 3.2.6.4. Ingest logs from Prisma Access Browser

##### 3.2.6.5. Ingest detection data from Strata Logging Service

###### Note

* IOC and BIOC issues are applicable on stitched data only and are not available on raw data.

##### 3.2.6.6. IoT Security

###### 3.2.6.6.1. Ingest alerts and assets from IoT Security

##### 3.2.6.7. Collecting URL and File log types

#### 3.2.7. External alerts using External Issue Mapping

##### 3.2.7.1. Ingest external alerts

###### Note

* If you send pre-parsed alerts using the Cortex XSIAM API, additional mapping is not required.

###### Navigation

  In Cortex XSIAM, select Settings → Configurations → Data Collection → External Issue Mapping

#### 3.2.8. Administration and troubleshooting

##### 3.2.8.1. Manage instances

###### 3.2.8.1.1. Add a new data source or instance

####### Note

* If a data source contains multiple integrations, the integration configured as the default integration will used by the Data Onboarder. The default integration of the content pack is indicated in each content pack's documentation. The other integrations are available for configuration in the Data Sources & Integrations page after installing the content...

* If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant page in the system, for example Correlations, Playbooks, or Scripts. If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant...

###### 3.2.8.1.2. How to configure the scanning settings for supported services

####### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

####### Note

* If you do not select a scanning cadence, the default setting is applied. For more information, contact your Customer Support team.

###### 3.2.8.1.3. Manage cloud instances

###### 3.2.8.1.4. Update cloud permissions after Cortex release updates

####### Prerequisite

* Ensure that the user account used to modify permissions has the necessary privileges within both the Cortex platform and your cloud environment, for example, AWS or Azure. You received a notification regarding a new version available that requires permission updates, or viewed a Needs Update status in the Data Sources & Integrations page.

####### Note

* Instances requiring updates will not change their connection status, for example, Connected, Warning, Error, Disabled, due to the pending permission update.

###### 3.2.8.1.5. Pending cloud instances

###### 3.2.8.1.6. Troubleshoot errors on cloud instances

####### Note

* Errors related to collection of audit logs in the cloud instance are recorded in the collection_auditing dataset. For more information, see Audit logs fields and query examples.

###### 3.2.8.1.7. Manage Kubernetes Connector instances

####### Note

* After uninstalling the Kubernetes connector, the connector status updates to Not connected 48 hours after the uninstall process is initiated.

####### Navigation

  You can also manage the Kubernetes Connector instances from Inventory → Assets → Kubernetes Clusters

##### 3.2.8.2. Integrations

###### Note

* Some integrations can be downloaded directly without having to initially download a content pack from Marketplace. For more information, see Define data sources.Define data sources In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require...

* If the integration was installed from a content pack, you need to duplicate the integration before editing.

* If the integration was installed from a content pack, you need to duplicate the integration before downloading.

* Integration commands are only available when the integration instance is enabled. Some commands depend on a successful connection between Cortex XSIAM and third-party integrations.

###### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

###### Navigation

  Settings → Configurations → Marketplace

###### 3.2.8.2.1. Integration use cases

###### 3.2.8.2.2. Add an integration instance

###### 3.2.8.2.3. Configure integration permissions

####### Navigation

  Settings → Configurations → Data Collection → Integration Permissions

###### 3.2.8.2.4. Fetch issues from an integration instance

####### Note

* In some integrations, the Issue Fetch interval is called Feed Fetch Interval. If the integration instance does not have the Issue Fetch Interval field, you need to add this field by editing the integration settings. If the integration is from a content pack, you need to create a copy of the integration. Any future updates to this integration will not...

* Some content packs include preconfigured correlation rules, but you should review them to see if they suit your use case and duplicate them if required. Go to Threat Management → Detection Rules → Correlations, search for the relevant rule, right-click, and select Preview Rule. For example, the ServiceNow v2 Alerts (automatically generated)...

####### 3.2.8.2.4.1. Map fields to issue types

######## Note

* In the Classification & Mapping page, the mapping does not indicate for which issue types they are configured. Therefore, when creating a mapper, it is best practice to add to the mapper name, the issue types the mapper is for. For example, Mail Listener - Phishing.

* When mapping a list, we recommend you map to a multi select field. Short text fields do not support lists. If you do need to map a list to a short text field, add a transformer in the relevant playbook task, to split the data back into a list.

######## Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

####### 3.2.8.2.4.2. Classify events using a classifier for issue types

######## Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

###### 3.2.8.2.5. Troubleshoot Integrations

###### 3.2.8.2.6. Forward Requests to Long-Running Integrations

####### Note

* This integration replaces the External Dynamic list integration, which is deprecated. For more information about how to set up the integration, see Manage external dynamic lists.

* When running on the tenant, you can only use long-running integrations provided by Cortex XSIAM, you cannot create custom ones. Custom long-running integrations are supported only on engines at this time. Configuring custom certificates or private API Keys in the long-running integration instance is supported only on engines, not on the Cortex XSIAM...

* For the TAXII Server and TAXII2 Server integrations, the xdr string is automatically replaced by crtx. For the Microsoft Teams integration, you can use the microsoft-teams-create-messaging-endpoint command to get the correct messaging endpoint based on the server URL, the server version, and the instance configurations. For more information, see...

##### 3.2.8.3. Verify collector connectivity

###### Note

* For more information on troubleshooting data collector applet errors, see Troubleshoot Broker VM applet connectivity.

* If an issue is triggered, the investigation options in the right-click menu of the Health Issues pages are context-specific. Make sure that you specify the relevant issue category.

##### 3.2.8.4. Overview of data ingestion metrics

###### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable Cortex - Analytics. Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics.

###### 3.2.8.4.1. Creating correlation rules to monitor data ingestion health

###### 3.2.8.4.2. Measuring data freshness

####### Note

* The max_delay metric is taken from the maximum bucket value with a restricted limit; therefore, metrics show whole numbers. The median and ninetieth_percentile metrics are statistical calculations that give an approximation of the real value; therefore, metrics show decimal numbers. Time slots with a zero log count or zero byte count display records...

##### 3.2.8.5. About health issues

###### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics.

###### Note

* The Health Issues page displays issues that were triggered after July 2024. To see health issues that were triggered before this date, click Legacy Health Issues.

* Cortex XSIAM enforces the dedup logic to health issues. This logic reduces the likelihood of identical health issues from flooding the issues dataset.

###### 3.2.8.5.1. Investigate and resolve health issues

###### 3.2.8.5.2. Monitor data ingestion health

###### 3.2.8.5.3. Monitor correlation rules

####### Note

* In the dataset, the Query start time and Query end time indicate the timeframe of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

### 3.3. Marketplace

#### 3.3.1. Cortex Marketplace

##### Navigation

  Settings → Configurations → Marketplace) or at Cortex Developer Docs Marketplace

#### 3.3.2. Content packs

##### Note

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

##### Navigation

  Settings → Configurations → Marketplace) or at Cortex Developer Docs Marketplace

#### 3.3.3. Content Pack Support Types

##### Note

* Palo Alto Networks is not liable for and does not warrant or support any content pack produced by a third-party publisher. Palo Alto Networks does not support content packs that do not have official available documentation.

#### 3.3.4. Cortex XSIAM content

#### 3.3.5. Manage content packs

##### Note

* Optional content packs that are already installed are treated like they are required content packs to preserve content integrity.

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

* In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as scripts or integrations.

* Third-party product integrations are developed and tested against a specific product version. For products that are on-prem or cloud-based with specific API versions, the version developed and tested against will be included in the integration's documentation. Newer versions of the product are not always immediately tested, and it is expected that...

##### Caution

* If you want to downgrade, any content that depends on the content pack including any customizations may be deleted if it does not exist in the target content pack version.

* If another content pack is dependent on the content pack you want to delete, it may break the other content pack. You can reinstall the content pack, but you cannot restore detached and customized content.

##### Tip

* You can also find content packs that require updates by going to Settings → Data Sources & Integrations and filtering by Pack Version = Update Available. If you click on an integration in the filtered list, there is a link to the content pack in Marketplace for updates.

#### 3.3.6. Marketplace FAQs

#### 3.3.7. Content changes when upgrading Cortex XSIAM versions

#### 3.3.8. Content pack contributions

### 3.4. Configure the Cortex Agentic Assistant

#### 3.4.1. Agentic Assistant components and concepts

##### Note

* Agents are bound by the same rules and robust permissions as a human user. In addition, you can mark actions that make real-world changes in production systems as sensitive, requiring a quick manual review and confirmation, ensuring peace of mind before critical system changes are made.

#### 3.4.2. Agents Hub

##### Note

* To manage agents in the Agents Hub, you must have the proper permissions. For more information, see Agentic Assistant role-based access control.

##### 3.4.2.1. Manage actions

###### Note

* To manage actions in the Agents Hub, you must have the correct permissions. For more information, see Agentic Assistant role-based access control.

##### 3.4.2.2. Register actions

###### Note

* To register actions, ensure you have the correct permissions. For more information, see Agentic Assistant role-based access control.

* Mandatory arguments cannot be deselected.

###### Important

* A single content item can be registered as different actions, with each action using different inputs and outputs from the same script. Only register the same script, command, or AI prompt as a new action if it is required for your use case, as providing an agent with many actions with overlapping abilities can reduce the ability of the agent to choose...

##### 3.4.2.3. Manage agents

###### Note

* In some cases, an agent may include actions with content items that are not relevant for all licenses. If that occurs, the grey circle appears, but you are not able to install the related content.

##### 3.4.2.4. Build agents

###### Note

* To build agents in the Agents Hub, you must have view/edit permissions. For more information, see Agentic Assistant role-based access control.

* If you clear the checkbox for a role, all actions associated with that role are also cleared. The exception is if another role is also selected, which is associated with the same actions. If you clear the checkbox for an action, all roles associated with that action are cleared. For example, if you select the Investigator role, and Send Mail and Tavily...

##### 3.4.2.5. Expand agent capabilities with MCP integrations

###### Note

* If you are using OAuth-based authentication, the Test button returns an error containing the command to run in the playground in order to test the connection.

* If an MCP tool is removed from the MCP server, the action will be unavailable due to missing content. If the tool is restored on the MCP server, the action is automatically reenabled. If you have a development and a production tenant, you can push actions created from MCP tools from development to production.

###### Navigation

  Settings → Configurations → Data Collection → Integration Permissions

#### 3.4.3. Agentic Assistant role-based access control

### 3.5. Cortex MCP server

#### 3.5.1. Cortex MCP server overview

##### Note

* This feature is in Beta.

* The Cortex MCP Server empowers you to integrate AI into your security workflows using natural language. When using LLM-based suggestions, always review and approve actions suggested by the AI before they're executed. We recommend deploying the Cortex MCP server in a secure environment where access is limited to authorized users.

##### 3.5.1.1. Install the Cortex MCP server

###### Prerequisite

* If you are running the Cortex MCP server in a Poetry virtual environment, you must have Python 3.13 or higher. If you plan to run the Cortex MCP server in a Docker container, you must have Docker installed.

###### Note

* The MCP Server uses public APIs to communicate and is limited by the license quotas available in your tenant. This is particularly relevant when running XQL queries. For more information on running XQL query APIs, see Run XQL query APIs.

* It is critical to avoid assigning excessive permissions when creating an API key for the Cortex MCP Server. Since the key has both read and write capabilities, overly broad permissions can lead to unintended actions and potentially compromise your environment. Ensure the key follows the principle of least privilege and is granted only the minimum...

* When using Docker, we recommend using an .env file to set the Cortex API credentials as environment variables. While the credentials can be provided in the MCP client configuration settings, the .env file provides safer handling of API credentials and makes your configuration easily reproducible.

* By default, stdio (standard input/output) is used. You can also configure Streamable HTTP, to send requests directly to the tenant instead of through the MCP client. Streamable HTTP can be useful for testing in the browser without a MCP client and to bypass limits that may be in place for your MCP client. For Docker, you can include the Streamable HTTP...

###### Important

* To configure the Cortex MCP Server, you need the Cortex API URL, Cortex API key, and Cortex API key ID. You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

##### 3.5.1.2. Configure the MCP client

###### Navigation

  Settings → Developer → Edit Config

##### 3.5.1.3. Use the Cortex MCP server

###### Note

* The built-in tools retrieve information, but do not write to the tenant. You can create your own tools that include write actions. The examples below include both.

##### 3.5.1.4. Create custom Cortex MCP server tools

###### Note

* Any new or updated components provided by Cortex are automatically downloaded into the remote_components folder.  During each update, the folder is fully replaced and all existing contents are recreated. Do not add custom tools to this directory, as it is managed entirely by Cortex and is overwritten at every update.

### 3.6. Automations

#### 3.6.1. Automation in Cortex XSIAM

##### Note

* You can build end-to-end automation workflows from within the playbook editor, including creating automation rules, configuring integration instances, and creating and editing tasks. For more information, see Playbooks.

#### 3.6.2. Quick Actions

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* Quick Actions appear as War Room entries, but do not appear in the Work Plan.

#### 3.6.3. Automation Exclusion Center

##### Note

* By default, all users have read and edit permissions to lists. When creating a list of critical assets, we recommend limiting the read and edit permissions to specific roles.

##### 3.6.3.1. Manage automation exclusion policies

###### Note

* For the IAM User Hard Remediation and User Soft Remediation policies, we recommend including username, email, and ID for each user you want to exclude. Example: username1, user@example.com, userID112.

* You can also right click on a policy from the main Automation Exclusion Center page to disable or enable the policy. If you click on a list name in the Exclude column, that list opens in the Lists page.

#### 3.6.4. Playbooks

##### Prerequisite

* To provide playbook access, ensure the Playbooks RBAC permission is set to View or View/Edit. To completely restrict playbook access, first set the Cases & Issues RBAC permission to None and then set the Playbooks permission to None. Conversely, to provide access to cases and issues, first set the Playbooks permission to View or View/Edit (and then set...

##### 3.6.4.1. Playbooks overview

##### 3.6.4.2. Playbook development checklist

##### 3.6.4.3. Plan your playbook

##### 3.6.4.4. Manage playbooks

###### Note

* The library by default shows only playbooks that are not adopted. Click the Show Adopted checkbox to show the adopted playbooks, indicated by an Adopted mark. The library shows the most updated playbook version. Adopting an older version than shown should be done through Marketplace. Adopting a playbook does not make it run. Some content packs include...

##### 3.6.4.5. Build your playbook

###### 3.6.4.5.1. Task 1. Choose from existing playbooks or create your own

####### Note

* When a task inside of a sub-playbook is not configured, the alert is propagated to the main playbook. If multiple sub-playbooks are nested, and any of the sub-playbooks have non-configured components, the alert appears in the main playbook as well as in the sub-playbooks. Alerts also appear for the individual non-configured tasks within the...

####### Tip

* If there are additional relevant playbooks in Marketplace that are not in your Org repository, you can click Explore them now to see them in the Playbook Catalog and choose to adopt.

* To open multiple playbooks at the same time, edit the first playbook and then click New next to the playbook name to create a new tab. You can either create a new playbook, or add an existing one. You can view recently modified or deleted playbooks by clicking version history for all playbooks .

####### Navigation

  the Investigation & Response → Automation → Playbooks page to find an existing playbook, customize it, or create a playbook

###### 3.6.4.5.2. Task 2. Configure playbook settings

####### Note

* If the playbook has inputs and outputs, the Playbook Starts task will show back and forth arrows. Clicking them opens the Playbook Settings pane Inputs/Outputs tab.

* This rule will trigger the playbook to run if no other Automation Rule triggers the playbook first. You can view and edit the order the rules run in the Automation Rules page.

* If you do not add any fields, the group will be deleted when you click Save.

###### 3.6.4.5.3. Task 3. Add objects from the Task Library

####### 3.6.4.5.3.1. Add Quick Actions, commands, and scripts

######## Note

* If the Quick Action requires an integration instance and it is not yet configured, you have the option to create an integration instance from within the playbook editor.

* If you want to add a script that is not yet adopted, Cortex XSIAM automatically installs the content pack containing the script. If the script requires an integration instance, you are prompted to configure one.

* If you do not have permission to download the script, contact your administrator for help. You can also filter by "show only configured" to show scripts you can use.

* Commands you run in the War Room can automatically populate parameters such as region, account ID, and tags, based on asset data. Commands can reference UIA attributes for the relevant asset(s) in the issue context and use those attributes as input. The issue must contain the relevant Asset ID. The syntax to reference attributes in the UAI is...

* The output value is dynamic and is derived from the context at the time that the task is processed. As a result, parallel tasks that are based on the same output may return inconsistent results.

######## Tip

* If your needs require a custom script, use the Agentic Assistant with the Automation Engineer agent to leverage the Cortex AgentiX built-in LLM to quickly and efficiently generate functional Python scripts from natural language prompts. For more information, see Create a script.

####### 3.6.4.5.3.2. Add sub-playbooks

######## Tip

* Balance between the number of iterations and the interval so you do not overload the server.

####### 3.6.4.5.3.3. Add AI prompt tasks

######## Note

* Selecting Local AI Prompt creates a local version of the task within your playbook. Any future updates made to the Prompts Library will not sync to this specific task. Choose Local AI Prompt if you need to customize the logic for a specific workflow and want to ensure its behavior remains unchanged, even if the Prompts Library is updated with...

####### 3.6.4.5.3.4. Add manual tasks and blank tasks

######## 3.6.4.5.3.4.1. Create a standard task

######## 3.6.4.5.3.4.2. Create a conditional task

######## 3.6.4.5.3.4.3. Create a communication task

####### 3.6.4.5.3.5. Create a section header

####### 3.6.4.5.3.6. Configure script error handling in a playbook

######## Note

* Use the GetErrorsFromEntry script (part of the Common Scripts Pack) to check whether the given entry returns an error and returns an error message. For example, when using the script in a playbook, you can fetch the error message from a given task, such as a runtime error. You can then add a step in the playbook flow to send those error messages to the...

* You can set up script error handling only when running a script in a Standard task or a Conditional task. For more information about error handling settings for these tasks, see Create a standard task or Create a conditional task. Built-in, Manual, and Ask Conditional tasks have On Error settings for number of retries and retry interval, but not Error...

###### 3.6.4.5.4. Task 4. Add custom playbook features

###### 3.6.4.5.5. Task 5. Test and debug the playbook

###### 3.6.4.5.6. Task 6. Manage playbook content

##### 3.6.4.6. Customize your playbook

###### 3.6.4.6.1. Configure a sub-playbook loop

####### Note

* Consider the following when adding a loop: The maximum number of loops (default is 100). A high number of loops or a high wait time combined with a large number of issues may affect performance. Periodically check looping conditions to ensure they are still valid for the data set. If you want a sub playbook task to loop over an array passed into its...

####### Tip

* Balance between the number of iterations and the interval so you do not overload the server.

###### 3.6.4.6.2. Filter and transform data

####### Caution

* You can change the context data root to filter, but it is not recommended to select a different root, as it affects the filter results. The drop-down list displays the filter root for backward compatibility.

####### Navigation

  Investigation & Response → Automation → Scripts → New Script

####### 3.6.4.6.2.1. Filter considerations, categories, and built-in filters

######## Note

* Is defined considers false and empty strings and lists to be defined values. If you don't want those to be included as defined, use Is not empty.

* Not defined considers false and empty strings and lists to be defined values. If you don't want those to be included as defined, use Is empty.

####### 3.6.4.6.2.2. Transformer considerations, categories, and built-in transformers

######## Note

* To make regex case non-sensitive, use the (?i) prefix (for example (?i)yourRegexText.

###### 3.6.4.6.3. Extend context

###### 3.6.4.6.4. Extract indicators

####### Note

* This configuration may delay playbook execution (issue creation). While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

###### 3.6.4.6.5. Update issue fields with playbook tasks

####### Note

* The setIssue script includes all available fields; use the scroll bar to see all the fields. The name field has a limit of 600 characters. If there are more than 600 characters, you can shorten the name field to under 600 characters and then include the full information in a long text field such as the description field. There are many fields already...

##### 3.6.4.7. Test your playbook

###### Note

* The debugger does not support using parentIncidentFields.

* Using an existing issue in the debugger does not affect the original issue or change the original context data.

###### 3.6.4.7.1. Troubleshoot playbook performance

##### 3.6.4.8. Manage playbook content

###### Note

* Opening a playbook does not immediately lock it. A playbook is considered to be in edit mode only when a user makes a modification that causes the Save button to become available.

###### Important

* Manually unlocking a playbook may cause version conflicts. This turns off concurrent editing protection, and if the original user is still editing, their changes might be lost or overwritten.

###### Navigation

  Investigation & Response → Automations → Playbooks

##### 3.6.4.9. Best practices

###### Note

* If you reattach a detached playbook, any customizations you have made to the playbook will be overwritten when the playbook updates to the current version.

* Retries are not supported for data collection tasks that have errors sending emails (indicated by a server timeout). This is because retries only work on automation execution failures, not on email delivery issues.

#### 3.6.5. AI Prompts

##### Navigation

  On the AI Prompts page (Investigation → Response → Automation → AI Prompts), you can view, edit, and manually create prompts

##### 3.6.5.1. AI prompts role-based access control

##### 3.6.5.2. Use existing prompts

###### Navigation

  Investigation & Response → Automation → AI Prompts and in the Prompts Library search for the prompt you want to use

##### 3.6.5.3. Create a prompt

###### Navigation

  Investigation & Response → Automation → AI Prompts and click + New Prompt

#### 3.6.6. Create an automation rule

##### Note

* You can also define the conditions that trigger a specific playbook in the playbook editor. For more information, see Task 2. Configure playbook settings

* Quick Actions, by default, run using all available integration instances that contain the command. When selecting a Quick Action for an automation rule, you can instead choose one specific integration instance to use.

##### Important

* Automation rules apply to Medium and higher severity issues. They also apply to Low severity Analytic issues and Low severity ABIOC issues that are tagged with Identity or Cloud. Rules are evaluated in order, and only the first rule that matches the trigger conditions is executed.

#### 3.6.7. Scripts

##### Prerequisite

* To provide scripts access, ensure the Scripts RBAC permission is set to View or View/Edit. To completely restrict scripts access, first set Playbooks and Playground RBAC permissions to None and then set the Scripts permission to None. Conversely, to provide access to playbooks or the Playground, the Scripts permission must first be set to View or...

##### Important

* The Automation Engineer agent is available when the Agentic Assistant feature is enabled, for users with script editing permissions. For more information, see Cortex Agentic Assistant and Agentic Assistant role-based access control.

##### Navigation

  On the Scripts page (Investigation → Response → Automation → Scripts), you can view, edit, and create scripts in JavaScript, Python, or PowerShell

##### 3.6.7.1. Use existing scripts

###### Navigation

  Investigation & Response → Automation → Scripts and in the Scripts Library search for the script you want to use

##### 3.6.7.2. Create a script

###### Note

* You can enable/disable a script in the Settings without having to duplicate the script. You can view recently modified or deleted scripts by clicking the version history for all scripts .

###### Important

* If you choose Python, from the Agentic Assistant you can use the Automation Engineer agent.

###### Tip

* If there is an error, you can copy the error message from the test result into the Agentic Assistant prompt and ask the Automation Engineer agent to correct the error.

##### 3.6.7.3. Use the Automation Engineer agent to accelerate script development and deployment

###### Note

* The Automation Engineer agent is available with the Cortex Agentic Assistant, for users with script editing permissions. For more information, see Cortex Agentic Assistant and Agentic Assistant role-based access control.

* If you make manual edits in the script and don't save the changes and you then modify the script with the Automation Engineer agent, you are prompted to confirm overwriting the manual edits.

###### Tip

* Use detailed prompts, for example, Get failed logins from last 24 hours and return as a table. Clearly define argument names, types, and default values. Mention if you expect the output in a specific format, such as a table, JSON, or plain text.

* If there is an error, you can copy the error message from the test result into the Agentic Assistant prompt and ask the Automation Engineer agent to correct the error.

##### 3.6.7.4. Change the Docker image in an integration or script

###### Note

* You can access publicly available Docker images from the Cortex XSIAM tenant even if there is no external connection to the Demisto registry, for example, if due to firewall constraints, your engine cannot access the Demisto registry.

#### 3.6.8. Context data

##### 3.6.8.1. Issue context data

##### 3.6.8.2. Case context data

##### 3.6.8.3. Search context data

##### 3.6.8.4. Add context data to an issue

##### 3.6.8.5. Add context data to a case

###### Note

* If you run the command in the issue War Room, the data is added to the following places: The case context data. The issue context data under the case tab. If you run the command in the Case War Room, the data is added to the case context data only.

##### 3.6.8.6. Delete context data from a case

##### 3.6.8.7. Use context data in a playbook

###### Note

* Generic polling does not work if a playbook's context data is shared globally. For more information, see Playbook polling.Playbook polling

###### Caution

* Users with Trigger Playbook permissions on a given issue may still be able to modify the parent case via commands and scripts, even without full access to the case.

#### 3.6.9. Lists

##### Note

* The maximum size of a list is 209715 characters.

##### 3.6.9.1. Create a list

###### Note

* If you intend to use the list as part of an Automation Exclusion Policy, we recommend choosing specific roles for read and edit access. For more information on using lists in exclusion policies, see Manage automation exclusion policies.

* If you want to edit a list from a content pack, you need to duplicate or detach a list. Detached lists do not receive updated content in subsequent Cortex XSIAM content releases. To retain an updated list, reattach it.

##### 3.6.9.2. List commands

##### 3.6.9.3. Use cases: JSON lists

###### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

  Investigation & Response → Automation → Playbooks → New Playbook

##### 3.6.9.4. Transform a list into an array

###### Navigation

  Investigation & Response → Automation → Playbooks and create or edit a playbook

#### 3.6.10. Jobs

##### 3.6.10.1. Manage jobs

###### Note

* Only Account Admins and Instance Administrator roles can create jobs and view/edit job runs. If the owner of a job has been removed from Cortex XSIAM, the job will fail to run. In this case, you must change the owner to a current user.

##### 3.6.10.2. Create a time triggered job

###### Note

* To view a human readable description of a cron schedule for an existing job, click  and select Job Schedule from the available columns.

###### Important

* We recommend to avoid triggering a job while a previous run of the job is active by configuring the playbook a job triggers to close the investigation before running a new instance of the job.

##### 3.6.10.3. Create a job triggered by a delta in a feed

###### Note

* A job triggered by a delta in a feed runs only if there is a change in the feed, and does not run on a feed's initial fetch. For the initial fetch, you can run the playbook manually and then set up an event triggered job for subsequent fetches. If you want to trigger a job after a feed completes a fetch operation and the feed does not change...

###### Navigation

  Investigation & Response → Automation → Jobs → New Job

### 3.7. Engines

#### 3.7.1. What is an engine?

##### Note

* You cannot share a multiple-engine installation with a single-engine installation.

* When you add an engine to a load-balancing group, you cannot use that engine separately. The engine does not appear in the engines menu when configuring an integration instance, but you can choose the load-balancing group.

#### 3.7.2. Engine requirements

##### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

* If you have configured a range of Approved IP Ranges under Allowed Sessions on the Security Settings page, the engine must communicate through one of the approved IPs.

#### 3.7.3. Install an engine

##### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex XSIAM engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

##### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

##### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

##### 3.7.3.1. Docker

###### Note

* This section is relevant when installing an engine.

* Docker images can be downloaded together with their relevant content packs for offline installation.

###### 3.7.3.1.1. Install Docker

####### Note

* For Red Hat's Docker distribution, you need Mirantis Container Runtime (formerly Docker Engine - Enterprise) to run specific Docker-dependent integrations and scripts. For more information, see Install Docker distribution for Red Hat on an engine server. To use the Mirantis Container Runtime (formerly Docker Engine - Enterprise) follow the deployment...

####### 3.7.3.1.1.1. Install Docker distribution for Red Hat on an engine server

######## Note

* If running RHEL v8 or higher, the engine installs Podman packages and configures the operating system to enable Podman in rootless mode.

####### 3.7.3.1.1.2. Docker image security

####### 3.7.3.1.1.3. Docker FAQs

####### 3.7.3.1.1.4. Troubleshoot Docker issues

####### 3.7.3.1.1.5. Configure Docker pull rate limit

####### 3.7.3.1.1.6. Change the Docker installation folder

###### 3.7.3.1.2. Docker hardening guide

####### Note

* The settings below can also be applied to Podman, with the exception of limiting available memory, limiting available CPU, and limiting PIDS.

* If you do not want to apply Docker memory limitations, you should explicitly set the advanced parameter: limit.docker.memory to false.

####### Tip

* We recommend reviewing Docker network hardening below before changing any parameters in the configuration file. To securely run Docker containers, we recommend using the latest Docker version.

##### 3.7.3.2. Podman

###### Note

* When upgrading an engine, the engine keeps the previously used container management type (regardless of distribution version).

###### 3.7.3.2.1. Change the container storage directory

####### Note

* Alternatively, the runroot setting may be set to some temporary directory that is accessible by the user demisto. If you choose to set the runroot, it must be a directory that is mounted as tmpfs (temporary filesystem), unlike the graphroot.

####### Warning

* Do not use NAS storage or a temporary (tmpfs) directory for the graphroot setting. The graphroot needs to be a local, non-temporary directory for Podman to work. For more information, see https://en.wikipedia.org/wiki/Network-attached_storage.

####### Tip

* We recommend reserving 150 GB for container storage, either in the /home partition or a different storage directory that you have set using the graphroot key.

###### 3.7.3.2.2. Install Podman

####### Note

* This procedure is intended for RHEL 8 or later. It may not work for other operating system types. Do not use NAS storage for the $HOME directory. The directory needs to be a local directory for Podman to work.

* If you edit the file with the root user, make sure to set the demisto user as file owner by running chown demisto:demisto /home/demisto/.config/containers/registries.conf

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

###### 3.7.3.2.3. Migrate From Docker to Podman

###### 3.7.3.2.4. Troubleshoot Podman

####### Note

* This step removes all Podman images, including any custom images you may have created.

* $(id -u demisto) is used to get the demisto user ID, which is part of the directory name. For example, /tmp/podman-run-993 Not all the directories above may be present.

* When you run podman container cleanup --rm -a, you might see a message such as running or paused containers cannot be moved without force. The message can be safely ignored, as it only pertains to current running containers, which are not removed.

* To change to the demisto OS user, run the following command: sudo su - -s /bin/bash demisto

* You must switch to user demisto before running the "system migrate" (running it as root will have no effect).

* The "system migrate" must be done by the user demisto.

####### Important

* The runroot must be located under the tmpfs file system type. This is required to clean Podman's run state on reboot and for performance reasons.

####### Caution

* Unlike the runroot, the graphroot must NOT be located under the tmpfs file system type. Using tmpfs for the graphroot might corrupt container images, causing command executions to fail. It also degrades performance by forcing Podman to needlessly re-pull images.

#### 3.7.4. Manage engines

##### Navigation

  You can manage your engines and load-balancing groups by going to Settings → Configurations → Data Broker → Engines

#### 3.7.5. Upgrade an engine

##### Note

* The upgrade.conf file is available on the engine after it has been upgraded to Cortex XSIAM 3.1. Any custom variables you add to the file are applied when you upgrade from Cortex XSIAM 3.1 to Cortex XSIAM 3.2 or later.

#### 3.7.6. Remove an engine

#### 3.7.7. Configure engines

##### Note

* A day is defined as 24 hours and may not exactly correspond to calendar days due to daylight savings, leap seconds, etc.

* In addition, to support engine upgrades from the UI, edit the /usr/local/demisto/upgrade.conf file on the engine to include the SERVER_URLS setting with the new tenant's address. Include only the host, without https:// or any additional path at the end of the host name. For example: SERVER_URLS="api-example.us.paloaltonetworks.com"

* If the engine loses communication for longer than this time, it will disconnect and you need to restart the service.

##### 3.7.7.1. Configure the engine to use a web proxy

###### Note

* You need to configure Docker to use a proxy. When using a BlueCoat proxy, ensure you encode the values correctly.

* In an environment with a single engine, go to /usr/local/demisto/upgrade.conf. In an environment with multiple engines, go to /usr/local/demisto/<engine-name>/upgrade.conf, replacing <engine-name> with the name of the engine. Note that the key is in the upgrade.conf file and must be https_proxy, even if your proxy address starts with http://.

##### 3.7.7.2. Configure the engine to call the server without using a proxy

###### 3.7.7.2.1. Use NGINX as a reverse proxy

####### Note

* For multi-tenant deployments, replace location ~ ^/(websocket|d1ws|d2ws) { with location ~ ^/(acc_\S+/)?(websocket|d1ws|d2ws)

##### 3.7.7.3. Configure an engine to use custom certificates

#### 3.7.8. Use an engine in an integration

##### Note

* Long-running integrations should not run on load-balancing groups.

#### 3.7.9. Run a script using an engine

##### Navigation

  Investigation & Response → Automation → Scripts

#### 3.7.10. Troubleshoot engines

##### Note

* Ensure that pop-ups are not blocked by your browser.

* If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom path. --keep - Extracts the installer files into the current working directory (without cleaning at the end). If using installer...

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl status d1_<Engine _name>

* Any changes made to variables in the upgrade_engine.sh file are reset after each upgrade. We recommend instead using the upgrade.conf file to set variables.

* You can ignore the following error: Cannot create folder '/var/lib/demisto'

##### Navigation

  When troubleshooting engines, access the logs from Settings → Configurations → Engines and select the engine from which you want to download the logs

#### 3.7.11. Troubleshoot integrations running on engines

##### Note

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

* Docker CE installations typically run Docker, while Docker EE installations typically run dockerroot.

### 3.8. Remote repository management

#### 3.8.1. Cortex XSIAM development tenant

##### Important

* Development tenants are not intended for performance checks; they cannot access production data, and they are connected to a limited number of endpoints. As a result, all development tenants have fewer resources than the production tenant, including data ingestion capacity and performance, and compute capabilities. In a development tenant, extreme...

#### 3.8.2. Set up a remote repository

##### Navigation

  If the content repository option is disabled for the production or development tenant (under Settings → Configurations → General → Remote Repository Settings, toggle the Content repository slider to off), the tenant becomes standalone and does not push or pull content

  If you are changing your remote repository settings, back up existing content to your local computer by navigating to Settings → Configurations → General → Server Settings → Custom Content and click Export all custom content

##### 3.8.2.1. Set up a built-in remote repository

###### Note

* Once enabled, development tenants have a red banner on the top left showing DEV.

* The first tenant that is enabled pushes its content to the remote repository first. For example, these instructions describe enabling the production tenant first, so the remote repository will initially contain production tenant content. You can enable a development tenant first if you want the remote repository to initially contain the content from...

###### Navigation

  Settings → Configurations → General → Remote Repository Settings and toggle the Content repository slider to enable the remote repository

##### 3.8.2.2. Set up a Private Remote Repository

###### Note

* Once enabled, the development push tenant has a red banner on the top left showing DEV.

* For repository vendors that use tokens, enter the token type in the username field and the token in the password field. Verify details with your vendor. If your private Git remote repository uses personal access tokens instead of usernames and passwords, enter the token type in the username field and the access token in the password field. For example,...

* You can't add an engine that has been added to a Load-Balancing Group.

* If your private Git remote repository uses personal access tokens instead of usernames and passwords, enter the access token in the password field and leave the username field blank. For repository vendors that use tokens, the token type is entered in the username field and the token is entered in the password field. Verify details with your vendor. If...

* The first tenant that is enabled pushes its content to the remote repository first. For example, these instructions describe enabling the production tenant first, so the remote repository will initially contain production tenant content. You can enable a development tenant first if you want the remote repository to initially contain the content from...

###### Tip

* Due to security concerns, there is a closed allow list of approved URLs for private repositories. If you want to use a URL that is excluded from the allow list, use an engine (engine groups are not supported).

#### 3.8.3. Push and pull content

##### Navigation

  Settings → Configurations → Remote Repository Content → User-Defined Content

#### 3.8.4. Remote repository troubleshooting

### 3.9. Multi-Tenant

#### 3.9.1. What is Cortex XSIAM multi-tenant?

##### Note

* By default, multi-tenant licenses include one child tenant.

##### 3.9.1.1. MSSP multi-tenant

##### 3.9.1.2. Enterprise multi-tenant

#### 3.9.2. Multi-tenant central licensing management

##### Note

* In MSSP or enterprise multi-tenant, the license specifies the maximum number of child tenants that can be created. Once this limit is reached, no additional tenants can be created, even if there remains allocation for endpoints or GBs.

#### 3.9.3. Onboard Cortex multi-tenant

##### 3.9.3.1. Onboarding checklist for multi-tenant central licensing deployments

###### 3.9.3.1.1. Step 1. Activate Cortex XSIAM (main account)

####### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

###### 3.9.3.1.2. Step 2. Create a child tenant

####### Note

* The main account is labeled in Cortex Gateway, but child tenants are not labeled. Cortex enables parent-child pairing between tenants located in different geographical regions. To enable this capability, contact your support team. To create a child tenant, ensure that you have Account Admin permissions.

* After activating a child tenant, you can't change the child tenant's name.

* This is a public FQDN, so be careful with sensitive information such as the company name. After activating a child tenant, you can only change the child tenant subdomain once.

* Ensure that you meet the minimum requirements for child tenant allocation.

* If you reach your limit for child tenants, depending on your license, you may be able to create more tenants. You may be charged for additional tenants. Contact Customer Support if you are approaching your authorized limit.

##### 3.9.3.2. Onboarding checklist for multi-tenant customer-owned license deployments

###### 3.9.3.2.1. Step 1. Activate Cortex Cortex XSIAM (parent and child tenants)

####### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

###### 3.9.3.2.2. Step 2. Define access configurations and role permissions

###### 3.9.3.2.3. Step 3. Pair a parent tenant with child tenant

####### Note

* This field is not enabled by default. To enable this, contact your support team.

#### 3.9.4. Dynamic license allocation

##### Note

* Changing the tenant's allocations might result in a short downtime of your tenant.

* After activating a child tenant, you can't change the child tenant's name.

* This is a public FQDN, so be careful with sensitive information such as the company name. After activating a child tenant, you can only change the child tenant subdomain once.

* Ensure that you meet the minimum requirements for child tenant allocation.

* If you reach your limit for child tenants, depending on your license, you may be able to create more tenants. You may be charged for additional tenants. Contact Customer Support if you are approaching your authorized limit.

* In a multi-tenant central licensing management environment, you cannot unpair a child tenant from the main account. The only way to remove the connection to the main account is to delete the tenant.

#### 3.9.5. Child tenant management

##### 3.9.5.1. Manage a child tenant

###### Note

* Once a configuration is created Cortex XSIAM resets the child tenant data and synchronizes the security actions configured in the parent tenant.

##### 3.9.5.2. Track your tenant management

###### Note

* This field is not enabled by default. To enable this, contact your support team.

###### Navigation

  To view child tenant details, in Cortex XSIAM, select Settings → Configurations → Tenant Management

##### 3.9.5.3. Investigate child tenant data

##### 3.9.5.4. Create and allocate configurations

###### Note

* You can configure Profiles only as Managed or Unmanaged. All profiles you create are automatically cloned to your child tenants.

##### 3.9.5.5. Create a security managed action

###### Note

* Profiles you create are automatically cloned to your child tenants.

#### 3.9.6. About managed threat hunting

##### 3.9.6.1. Set up Managed Threat Hunting

###### Navigation

  Settings → Configurations → Managed Services

##### 3.9.6.2. Investigate Managed Threat Hunting reports

###### Note

* The MTH page is available for users with the Managed Threat Hunting license and have the necessary permission to view and triage alerts and incidents in Cortex XSIAM.

### 3.10. XQL query management

#### Prerequisite

* Setting query limits requires View/Edit permissions for Configurations → Query Management.

#### Note

* A scheduled query or report is run on behalf of the user that originally created it, even if it is edited and run by another user.

* Queries run by correlation rules are not restricted by the query limit. Very short queries do not count towards concurrent queries.

* To ensure optimal system performance, all queries (user-generated and otherwise) adhere to a default timeout limit of 60 minutes that is defined by Palo Alto that takes priority over the administrator defined value. Therefore, regardless of the value specified in this field, queries will be stopped after 60 minutes. You can override the default timeout...

* Query visibility is subject to Role-Based Access Control (RBAC); users can't see queries for datasets they do not have permission to access.

#### Navigation

  You can find Query Management options under Settings → Configurations → General → Query Management

### 3.11. Customize cases and issues

#### 3.11.1. Customize cases and issues

##### 3.11.1.1. External integrations

##### 3.11.1.2. Set up case scoring

###### Note

* On the first activation, it can take up to 48 hours for SmartScore to calculate and display the score. Enabling SmartScore subsequently impacts the User Score.

* For scoped users, a small lock icon indicates that you don't have permissions to edit a rule.

###### Tip

* Right-click an issue field to add it as match criteria.

###### Navigation

  Settings → Configurations → Cortex XSIAM- Analytics and click Enable

  Cases & Issues → Case Configuration → Case Scoring and enable SmartScore

##### 3.11.1.3. Create a starring configuration

###### Tip

* Right-click an issue field to add it as match criteria.

##### 3.11.1.4. Create custom case statuses and resolution reasons

###### Note

* Before you create a custom status, please review the built-in options. For more information, see Resolution reasons for cases and issues. We recommend using the built-in statuses and resolution reasons where possible. Custom statuses and resolution reasons might not be supported by all content, and status syncing can take time. In addition, custom...

* After creation, custom statuses and resolution reasons cannot be deleted or modified.

###### Navigation

  Configurations → Object Setup → Cases → Properties

##### 3.11.1.5. Create a sync profile

###### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

##### 3.11.1.6. Create a case domain

###### Note

* Adding custom domains requires a View/Edit RBAC permission for Case Properties (under Object Setup). Once created, a custom case domain cannot be deleted or renamed.

###### Warning

* Before you add a custom domain, please review the built-in options. For more information, see Case and issue domains. We recommend using the built-in domains where possible. Custom domains might not be supported by all content. In addition, custom domains affect Cortex XSIAM's ability to learn, correctly identify, and score future cases. Smart...

###### Navigation

  You can see all domains under Configurations → Object Setup → Cases → Domains

  Settings → Configurations → Object Setup → Cases → Domains

  Settings → Configurations → Access Management → User Groups

  Settings → Configurations → Access Management → Users

  To enable access to the domain for an API key, got to Settings → Configurations → Integrations → API Keys

##### 3.11.1.7. Customize case fields and layouts

###### 3.11.1.7.1. Create case timers and SLAs

####### Prerequisite

* Before you can create a case SLA, you must first create a timer field. A timer field can be associated with a single case SLA.

####### Note

* If you edit this filter after creation, the timer and associated SLA will be removed from any case that no longer qualifies, even if the timer is already running.

####### Navigation

  Settings → Configurations → Object Setup → Cases and open the Fields tab

####### 3.11.1.7.1.1. Update case timer and SLA fields

###### 3.11.1.7.2. Case fields

####### Warning

* Deleting a case field or uninstalling a content pack containing a case field may affect capabilities based on the deleted field, layouts and case scoring.

####### 3.11.1.7.2.1. Case field types

######## Note

* You cannot set filters, starring rules, automation rules, layout rules, or issue exclusions based on the values in custom timestamp fields.

* When grid field is shown in the Cases table, if there are values in the field, they do not display in the Cases table. Instead, the column shows Data Available.

* When an HTML field is shown in the Issues table, if there is a value in the field, it does not display in the Cases table. Instead, the column shows Data Available.

* When a Markdown field is shown in the Cases table, if there is a value in the field, it does not display in the Cases table. Instead, the column shows Data Available.

* If you make changes to case fields you can update the context data by running a playbook, script, or command. For more information, see Update case fields. To update dynamic custom case fields, such as SLA and Timer fields, see Update case timer and SLA fields.

####### 3.11.1.7.2.2. Create custom case fields

######## Navigation

  Settings → Configurations → Object Setup → Cases → Fields → New Field

####### 3.11.1.7.2.3. Create a grid field for a case

######## Navigation

  Settings → Configurations → Object Setup → Cases → Fields → New Field

####### 3.11.1.7.2.4. Update case fields

######## Note

* Ensure that you have the required RBAC permission to write scripts.

###### 3.11.1.7.3. Case layouts

####### 3.11.1.7.3.1. Create custom case layouts

######## Note

* The script that runs when an action button is clicked accepts only mandatory arguments through the pop up window and does not provide an option for any non-mandatory arguments to be filled in when the button is clicked. We recommend using a wrapper script to collect and validate arguments in scenarios where there can be a combination of mandatory and...

######## Tip

* Limit the number of case fields to 50 in each section. You can create additional sections as needed.

####### 3.11.1.7.3.2. Create rules for case layouts

######## Note

* Layout rules support SBAC (scoped based access control). The following parameters are considered for editing access. If Scope-Based Access Control (SBAC) is enabled and Endpoint Scoping Mode is set to restrictive mode, you can edit a rule if you are scoped to all tags in the rule. If Scope-Based Access Control (SBAC) is enabled and Endpoint Scoping...

######## Navigation

  Settings → Configurations → Object Setup → Cases → Layout Rules → New Rule

##### 3.11.1.8. Customize issue fields and layouts

###### 3.11.1.8.1. Issue fields

####### Warning

* Deleting an issue field or uninstalling a content pack containing an issue field may affect detection and other capabilities based on the deleted field. For example, correlation, layouts, case scoring, starring rules, and playbook triggers.

####### 3.11.1.8.1.1. Issue field types

######## Note

* You cannot set filters, starring rules, automation rules, layout rules, or issue exclusions based on the values in custom timestamp fields.

* When grid field is shown in the Issues table, if there are values in the field, they do not display in the table. Instead, the column shows Data Available.

* When an HTML field is shown in the Issues table, if there is a value in the field, it does not display in the Issues table. Instead, the column shows Data Available. The following HTML tags are not permitted: blockquote, del, dd, div, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, iframe, ins, li, math, noscript, ol, pre, p, script, style, table,...

* When a Markdown field is shown in the Issues table, if there is a value in the field, it does not display in the table. Instead, the column shows Data Available.

####### 3.11.1.8.1.2. Create custom issue fields

######## Navigation

  Settings → Configurations → Object Setup → Issues → Fields → New Field

####### 3.11.1.8.1.3. Create a grid field for an issue

######## Navigation

  Settings → Configurations → Object Setup → Issues → Fields → New Field

####### 3.11.1.8.1.4. Issue timer fields

######## Navigation

  Settings → Configurations → General → Server Settings → Issues and Enable Timer Field

####### 3.11.1.8.1.5. Issue field triggered scripts

######## Note

* Fields that can hold a list, such as multi-select custom fields, return the delta in an array as a new argument. For example, if a multi-select field value has changed from ["a"] to ["a", "b"], the new argument of the script gets a value of ["b"].

* Issue field-triggered scripts must have the field-change-triggered tag to appear in the list. Issue field trigger scripts are not supported for all system fields. The following fields are not supported for issue field trigger scripts and may result in failing to populate the issue layout: Cases: Case ID, Cases IDs Asset Fields: Asset IDs, Asset Names,...

* When creating the script, add the field-change-triggered tag in the script settings.

* Verify that User can add rows is selected.

######## Caution

* This feature assumes fair and intended usage of field-triggered scripts. In cases of excessive or abusive usage, execution may be restricted or disabled. If script execution is restricted or disabled, fields are still updated, but without the results of the assigned script.

####### 3.11.1.8.1.6. Configure issue timer fields

######## Note

* Only scripts to which you have added the SLA tag appear in the list of scripts you can select. To add a tag to a script, create a new script or edit an existing script and enter the tag name in the script settings. When you hover over the machine name (below the Field Name) note the name which is used in the command line or script.

####### 3.11.1.8.1.7. Configure a playbook to run timers

######## Note

* When a task or section has a timer configured, it displays the hourglass icon.

* Timers are not started automatically when a case is created.

* If you stop a timer before the issue is closed, you must reset the timer using the resetTimer command before you can start the timer again. When you reset the timer, all fields are cleared.

####### 3.11.1.8.1.8. Automate changes to issue fields using timer scripts

####### 3.11.1.8.1.9. Use issue timer field commands manually in the CLI

######## Note

* When defining the values for the slaField use the machine name for the field, which is lowercase and without spaces. You can check the machine name by editing the issue field.

* Timer fields are not started automatically when an issue is created unless run in a playbook.

* After a timer field is stopped, before you can start the timer again you must reset the timer using the resetTimer command. Timers are automatically stopped when an issue is closed.

* When running commands in the CLI, you can specify the alertID to change the timer for a different issue.

###### 3.11.1.8.2. Issue layouts

####### 3.11.1.8.2.1. Create custom issue layouts

######## Note

* The script that runs when an action button is clicked accepts only mandatory arguments through the pop up window and does not provide an option for any non-mandatory arguments to be filled in when the button is clicked. We recommend using a wrapper script to collect and validate arguments in scenarios where there can be a combination of mandatory and...

######## Tip

* Limit the number of issue fields to 50 in each section. You can create additional sections as needed.

####### 3.11.1.8.2.2. Add a custom widget to an issue layout

######## Navigation

  Investigation & Response → Automation → Scripts and upload the following script: Expand script commonfields: id: ee3b9604-324b-4ab5-8164-15ddf6e428ab version: 49 name: IndicatorWidgetBar script: |- # Constants HIGH = 3 SUSPICIOUS = 2 LOW = 1 NONE = 0 indicators = [] scores = {HIGH: 0, SUSPICIOUS: 0, LOW: 0, NONE: 0} incident_id = demisto

  Investigation & Response → Automation → Scripts and upload the following script

  Settings → Configurations → Object Setup → Issues → Layouts

####### 3.11.1.8.2.3. Create rules for issue layouts

######## Navigation

  Settings → Configurations → Object Setup → Issues → Layout Rules → New Rule

##### 3.11.1.9. Run indicator extraction in the CLI

###### Note

* Triggering enrichment on a substantial amount of indicators can take time (since it's activating all enrichment integrations per indicator) and can result in performance degradation.

## 4. Protect your endpoints

### 4.1. Endpoint security

#### License Type

  Requires one of the following licenses Cortex XSIAM Premium Cortex XSIAM Enterprise Any other Cortex XSIAM license with the Cloud Runtime Security add-on or the Enterprise Runtime Security add-on

#### 4.1.1. Endpoint protection

##### 4.1.1.1. Malware protection

###### Note

* From Cortex XDR agent for Android version 9.0 and later, part of this module, which performs local analysis on the Android device itself, is deprecated. APK analysis will be handled only by Wildfire.

##### 4.1.1.2. Exploit protection

##### 4.1.1.3. File analysis and protection flow

###### Note

* To enhance performance and efficiency, hash verdict requests from the Cortex XDR agent will be routed to the WildFire service with the lowest latency. File uploads for analysis will strictly adhere to the designated Cortex XSIAM and WildFire regions, ensuring data remains within the appropriate geographical boundaries.

##### 4.1.1.4. Endpoint protection capabilities

##### 4.1.1.5. Endpoint protection modules

##### 4.1.1.6. Processes protected by exploit security policy

##### 4.1.1.7. File Integrity Monitoring (FIM)

###### License Type

  FIM requires the Cortex Cloud Runtime Security add-on.

###### Note

* Google Kubernetes Engine (GKE) is currently not supported

* It is recommended to create a policy that targets only the necessary files and folders.

* Platform cannot be changed once a rule group has been created

* A rule group can contain up to 100 rules.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* It is possible to ingest up to 15,000 events per day (24 hours) for each host/container.

###### Navigation

  Creating, modifying and viewing FIM rule groups and rules is be done in the Rule Groups page, located at the Inventory → Endpoints → File Integrity Monitoring menu

  In Inventory → Endpoints → Policy management → Extensions → Profiles, select +Add Profile and then select either Create New or Import from File

##### 4.1.1.8. WildFire analysis concepts

###### Note

* In cases when the Cortex XSIAM agent gets a failed status from the WF service due to a general error or unsupported file type, and the Local Analysis is set to disabled or not applicable, Cortex XSIAM will not generate an alert on the file.

##### 4.1.1.9. Guidelines for keeping Cortex XDR agents and content updated

###### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups. See how to define endpoint group.

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups.

###### Important

* When planning Cortex XDR agent upgrades and content updates, consult with the appropriate stakeholders and teams and follow the change management strategy in your organization.

###### Caution

* Before enabling Auto-Update for Cortex XDR agents, make sure to consult with all relevant stakeholders in your organization.

##### 4.1.1.10. About content updates

###### Note

* Cortex XSIAM delivers the content update to the agent in parts and not as a single file, allowing the agent to retrieve only the updates and additions it needs.

##### 4.1.1.11. Endpoint data collection

###### Note

* For specific files only and only if the file was written.

###### Important

* Registry key is collected as a real key name, and not as a symbolic link. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, KEY_LOCAL_MACHINE\System\ControlSet001 will be collected. Instead of HKEY_CURRENT_USER, HKEY_USERS\<SID> will be collected, where SID is a SID of the current user.

#### 4.1.2. Install and manage endpoints

##### 4.1.2.1. Set up endpoint protection

###### 4.1.2.1.1. Set up endpoint profiles and exception rules

####### Note

* Profiles associated with one or more targets that are beyond the scope of your defined user permissions are locked, and cannot be edited.

####### 4.1.2.1.1.1. Set up malware prevention profiles

######## License Type

  Requires the ITDR add-on.

######## Note

* In this profile, the Report options configure the endpoints to report the corresponding suspicious files, actions, processes, or behaviors to Cortex XSIAM, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* As part of the anti-malware security flow, the Cortex XDR agent leverages the operating system's capability to identify revoked certificates for executables, and DLL files that attempt to run on the endpoint by accessing the Windows Certificate Revocation List (CRL). To allow the Cortex XDR agent access the CRL, you must enable internet access over...

* The Quarantine Malicious Executables feature is not available for malware identified on network drives.

* The Quarantine Malicious Script Files feature is not available for malware identified on network drives.

* If on-write actions were configured in earlier versions of Cortex XSIAM, the same configuration has been preserved and applied globally for all file types. On-write file protection may have an impact on the resources required by the Cortex XDR agent.

* On-demand file protection may have an impact on the resources required by the Cortex XDR agent.

* We recommend that you disable scheduled scanning. VDI machine scans are based on the golden image and additional files will be examined upon execution.

* When periodic scanning is enabled in your profile, the Cortex XDR agent initiates an initial scan when it is first installed on the endpoint, regardless of the periodic scanning scheduling time.

* This feature only comes into effect after a restart.

* When you are actively evaluating with BAS tools, it is recommended to enable the BAS mode setting only for the duration of your evaluation, and for a limited number of agents.

* BAS tools mode with content older than version 1850 cannot be configured, the agent will be treated as Enabled.

* The Quarantine Malicious Mach-O Files feature is not available for malware identified on network drives.

* This module is supported by Cortex XDR agent 8.1.0 and later releases.

* The Quarantine Malicious ELF Files feature is not available for malware identified on network drives.

* Enabling on-demand scanning will automatically scan these core system directories: /etc, /tmp, /home, /usr, /bin, /sbin, /lib, /var, /opt, /dev, /root, /boot.

* From Cortex XDR agent for Android version 9.0 and later, part of this module, which performs local analysis on the Android device itself, is deprecated. APK analysis will be handled only by Wildfire.

* Blocking functionality is different for each security module. For SMS/MMS, Cortex XDR agent will move detected messages containing such URLs from unknown senders to the Junk folder.

* Ensure that the same numbers are not added multiple times with different leading zeros.

* To fully enable the Safari browser security module on the device side, each iOS device user must enable the Safari Safeguard module on the device, and grant it permission to work on all websites. If the iOS device user does not do this, the endpoint's operation status is reported as Partially Protected. The Safari browser security module will only...

* Cortex XDR agent version 8.4 or higher are required for this feature.

######## Warning

* For optimal user experience, we recommend that you set the action mode to either Allow or Run Local Analysis.

####### 4.1.2.1.1.2. Set up exploit prevention profiles

######## Note

* In this profile, the Report options configure the endpoints to report the corresponding exploit attempts to Cortex XSIAM, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* In exploit prevention profiles, if you change the action mode for processes, you must restart the protected processes for the following security modules to take effect on the process and its forked processes: Brute Force Protection Java Deserialization SO Hijacking

* This step provides a temporary workaround for the following publicly known information-security vulnerabilities and exposures: CVE-2021-24074, CVE-2021-24086 and CVE-2021-24094.

* If you have Windows endpoints in your network that are unpatched and exposed to a known vulnerability, we strongly recommend that you upgrade to the latest Windows Update that has a fix for that vulnerability.

######## Warning

* This workaround applies only to the specific Windows versions listed as exposed to these CVEs, and requires a Cortex XDR agent release 7.1 or later and content 167-51646 or later. This workaround is not recommended for non-persistent, stateless, or linked-clone environments. In some cases, enabling this workaround can affect the network functionality...

####### 4.1.2.1.1.3. Set up agent settings profiles

######## License Type

  Requires a Cortex XDR Pro per Endpoint license. When you enable this feature, a Cortex XDR Pro per Endpoint license is consumed.

  Requires Host Insights add-on.

  Requires Forensics Add-on.

######## Prerequisite

* User Space Agent mode requires Linux kernel 5.0.0 or higher.

######## Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

* You can enable the option to maintain a persistent notification regarding the disconnection of the endpoint from the network. The settings Persistent Isolation Notification and Blocked Connectivity Notification must be enabled. Until the threat on the endpoint has been removed, the endpoint remains disconnected from the network.

* In Traps 5.0.6 and later releases, when protection is enabled, access will be read-only. In earlier Traps releases, enabling protection disables all access to services, processes, files, and registry values.

* If you choose the Enable option, you must also enable XDR Agent Tampering Protection in the malware profile and set it to Block. Ensure that both profiles are assigned to the same endpoints.

* When you enable Cortex XDR agent registration with the Windows Security Center, Windows automatically shuts down Microsoft Defender on Windows-based workstation endpoints. If you still want to allow Microsoft Defender to run on a workstation endpoint where Cortex XSIAM is installed, you must use the Disable option. However, Palo Alto Networks does not...

* To enable access to these options, scroll down to Network Location Configuration, and set Action Mode to Enabled.

* When using Nmap, the Cortex XDR agent downloads an Nmap driver for the duration of the scan and removes the driver upon completion. If an Nmap scan is in process, Cortex XSIAM identifies the Nmap driver and places any additional scans in a queue.

* If you disable content updates for a newly installed agent, the agent retrieves the content for the first time from Cortex XSIAM, and then disables content updates on the endpoint. When you add a Cortex XDR agent to an endpoint group with a disabled content auto-upgrades policy, the policy is applied to the added agent as well.

* Automatic upgrades are not supported with non-persistent VDI and temporary sessions.

* The delay timer starts from the date of the target agent version's availability in the tenant.

* Limitations in the content download process: When you install the Cortex XDR agent, the agent retrieves the latest content update version available. A freshly installed agent can take between five to ten minutes (depending on your network and content update settings) to retrieve the content for the first time. During this time, your endpoint is not...

* If the Cortex XDR agent is initially unable to communicate without the local store, enforcement is not enabled and the agent will show as partially protected.

* If you choose the Enabled option, you must also set Anti Tampering Protection in the malware security profile to Block, and ensure that both profiles are assigned to the same endpoints.

* When protection is enabled, access to services, processes, files, and registry values will be read-only.

* If you disable content updates for a newly installed agent, the agent retrieves the content for the first time from Cortex XSIAM, and then disables content updates on the endpoint.

* Automatic upgrades are not supported with non-persistent VDI and temporary sessions. When a Cortex XDR agent is added to an endpoint group, it inherits the group's policy, including the disabled content auto-upgrades setting.

* Automatic upgrades are not supported for XDR agents running on K8s.

* User Space Agent mode requires Linux kernel 5.0.0 or higher. Endpoints running an older Linux kernel version with this fallback enabled, will not start using User Space Agent mode, and will operate asynchronously.

######## Warning

* If you disable or delay automatic-content updates provided by Palo Alto Networks, it may affect the security level in your organization.

####### 4.1.2.1.1.4. Set up restrictions prevention profiles

######## License Type

  A Threat Intel Management (TIM) license is required for this feature.

######## Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Configure custom BIOC prevention rules here: Detection & Threat Intel → Detection Rules → BIOC

* Configure this as follows: Prepare this restriction profile first, make a note of its name for later, and set it to Enabled. Prepare the prevention Indicator Rule (go to Detection & Threat Intel → Indicator Rules, ensuring to select Prevention when creating the rule), and while preparing it, map it to your restriction profile.

* Wildcards are supported.

####### 4.1.2.1.1.5. Set up exception profiles and rules

######## 4.1.2.1.1.5.1. Exception configuration

######## 4.1.2.1.1.5.2. Issue exclusions

######### 4.1.2.1.1.5.2.1. Add an issue exclusion rule

######## 4.1.2.1.1.5.3. Add an IOC or BIOC rule exception

######## 4.1.2.1.1.5.4. Add a disable prevention rule for endpoints

######## 4.1.2.1.1.5.5. Add a disable injection and prevention rule

######## 4.1.2.1.1.5.6. Add a support exception rule for endpoints

######## 4.1.2.1.1.5.7. Add a legacy exception rule for endpoints

######### 4.1.2.1.1.5.7.1. Add a new exceptions security profile

######### 4.1.2.1.1.5.7.2. Add a global endpoint policy exception

###### 4.1.2.1.2. Define endpoint groups

####### Note

* Disconnecting Cloud Identity Engine in your Cortex XSIAM deployment can affect existing endpoint groups and policy rules based on Active Directory properties.

###### 4.1.2.1.3. Configure global agent settings

####### Note

* Disabling this capability takes immediate effect on new hashes, fresh agent installations, and existing security policies. It could take up to a week to take effect on existing agents in your environment pending agent caching.

* If you have any Cortex XSIAM filters, starring policies, exclusion policies, scoring rules, log forwarding queries, or automation rules configured for XSOAR/3rd party SIEM, we advise you to update those to support the changes before activating the feature. For example, change the query to include the previous description that is still available in the...

###### 4.1.2.1.4. Apply profiles to endpoints

####### Note

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

###### 4.1.2.1.5. Create an agent installation package

####### Note

* The profile will be applied if the security policy cannot be retrieved in real-time.

* The Cortex serverless library must be imported after other libraries to activate the hooks that enable auditing.

####### 4.1.2.1.5.1. Manage an agent installation package

######## Note

* Since Cortex XSIAM relies on the installation package ID to approve agent registration during the installation, we recommend that you don't delete the installation package of active endpoints. If you install the Cortex XDR agent from a package after you delete it, Cortex XSIAM denies the registration request leaving the agent in an unprotected state....

###### 4.1.2.1.6. Harden endpoint security

####### Caution

* Hardened endpoint security capabilities are not supported for Android or iOS endpoints.

####### Navigation

  From Inventory → Endpoints → Policy Management → Extensions → Profiles, you can create profiles for the following hardened endpoint security capabilities

  To apply the profiles, from Inventory → Endpoints → Policy Management → Extensions → Policy Rules, you can view all the policy rules per operating system

####### 4.1.2.1.6.1. Device control

######## Note

* Operating systems report on devices in different ways. Sometimes, the same BLE device will report different services and interfaces, depending on the host's operating system. This may have an effect on the specific BLE services that are blocked for each operating system. Depending on your defined user scope permissions, creating device profiles,...

* For network printer print jobs, ensure that you also configure the Agent Settings profile, Network Location Configuration option. This setting must be set to Enabled, and configured. If you do not enable and configure this setting, all network printer operations will be treated as internal network print jobs. For network printer print jobs, ensure that...

* Currently, the default is set to Use Default (Allow), however, Palo Alto Networks may change the default definition at any time.

* You cannot edit or delete the default profiles pre-defined in Cortex XSIAM.

* You cannot edit or delete the predefined profiles in Cortex XSIAM.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* Permanent exceptions apply across platforms, allowing the devices on all operating systems.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

######## Navigation

  Endpoints → Policy Management → Settings → Device Management

####### 4.1.2.1.6.2. Host firewall

######## 4.1.2.1.6.2.1. Host firewall for Windows

######## 4.1.2.1.6.2.2. Host firewall for macOS

####### 4.1.2.1.6.3. Disk encryption

######## Note

* You must select the same encryption method configured by the Microsoft Windows Group Policy in your organization for the target endpoints. Otherwise, if you select a different encryption method than the one already applied through the Windows Group Policy, Cortex XSIAM displays errors.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

######## Navigation

  You can monitor the Encryption Status of an endpoint in the Inventory → Endpoints → Disk Encryption Visibility table

####### 4.1.2.1.6.4. Host Inventory

######## Note

* Cortex XSIAM includes only the first 10,000 results per endpoint. Cortex XSIAM lists only users that belong to each group directly, and does not include users who belong to a group within the main group. If a local users group includes a domain user (whose credentials are stored on the Domain Controller server and not on the endpoint), Cortex XSIAM...

######## Navigation

  Inventory → Endpoints → Host Inventory

####### 4.1.2.1.6.5. Vulnerability Assessment

######## Prerequisite

* The following are prerequisites for Cortex XSIAM to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XSIAM lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex XSIAM...

* The following are prerequisites for Cortex XSIAM to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex XSIAM collects all the information about the operating system and the installed...

######## Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex XSIAM Application Inventory.

######## Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

######## Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

###### 4.1.2.1.7. Set a Cortex XDR agent Critical Environment version

####### Note

* To ensure the stability of the line, CE versions maintenance release cadence is longer than in the standard line, we recommend that deployment is adjusted accordingly.

####### Navigation

  Settings → Configurations → General → Agent Configurations

  Inventory → Endpoints → All Endpoints

###### 4.1.2.1.8. Set an application proxy for Cortex XDR agents

####### Warning

* If adding a proxy to the allow list be aware of the following: This allows any application on the isolated endpoint to communicate through that proxy, potentially allowing a threat actor or malware to bypass the isolation and reach external resources. Ensure that no other non-security applications are utilizing this proxy if you choose to allow it.

####### Navigation

  Inventory → Endpoints → All Endpoints

##### 4.1.2.2. Manage endpoint protection

###### 4.1.2.2.1. Move agents between managing servers

####### Prerequisite

* Consider the following before making changes: Endpoint type is not Kubernetes Node. Installation type is not VDI. Ensure you have administrator privileges for Cortex XSIAM in the hub.

####### Note

* Cortex XSIAM does not support moving agents between FedRamp and commercial tenants.

####### Navigation

  Inventory → Endpoints → Agent Installations

  Inventory → Endpoints → All Endpoints

###### 4.1.2.2.2. Manage endpoint tags

####### Note

* The following explanations use Windows operating system installation parameters and Cytool argument examples.

* Tag names are case sensitive. In Windows and Mac, a tag name can contain spaces. Linux does not support tag names with spaces as command line arguments to the shell installer. Instead, tags can be set in the /etc/panw/cortex.conf configuration file, which supports all Linux installers.

* Tag names are case sensitive and can contain spaces.

* When SBAC is enabled, assigning tags may impact user permissions.

* If you remove the tag and there are assigned users or user groups with scope settings, this can impact user permissions in the system.

###### 4.1.2.2.3. Set an alias for an endpoint

####### Tip

* If you change your mind in the future, you can select Endpoint Control → Change Endpoint Alias again, and delete the required aliases.

###### 4.1.2.2.4. Manage endpoint prevention profiles

####### Note

* The filter is stored within the policy definition and assessed during runtime to extract the functions that match the filter criteria.

####### Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

###### 4.1.2.2.5. Upgrade Cortex XDR agents

####### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* It is possible to cancel an upgrade if the Status is Pending. Once the Status is In Progress, the action is already received by the agent locally and cannot be canceled from the management console. Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating...

####### Warning

* You must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check whether the extensions were approved, you can either verify that the...

####### Important

* The following list includes important points to take into account when upgrading the Cortex XDR agent: Review the recommended guidelines for keeping Cortex XDR agents and content updated. Read more here. You cannot upgrade the Cortex XDR agent on VDI endpoints or a Golden Image. You must reinstall (uninstall and install again) the relevant agent...

###### 4.1.2.2.6. Restart agent

###### 4.1.2.2.7. Uninstall the Cortex XDR agent

####### Note

* Before upgrading a Cortex XDR agent running on macOS 10.15.4 or later, you must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check...

####### Tip

* If needed, use the filter to filter the list of endpoints by attribute or group name.

####### Navigation

  Inventory → Endpoints → All Endpoints

###### 4.1.2.2.8. Clear agent database

####### Note

* Clearing the agent database is supported on all platforms with Cortex XDR agent version 7.9 or later, and is available only when using the debugging mode.

* You can only right-click to cancel the clear agent database for actions with a pending status.

###### 4.1.2.2.9. Delete Cortex XDR agents

####### Note

* To reinstate an endpoint, you have to uninstall and reinstall the agent.

####### Navigation

  Inventory → Endpoints → All Endpoints

###### 4.1.2.2.10. Manage agent tokens

####### Note

* Agent tokens are only supported for Windows and Mac.

* You can select a one or multiple agents to add a temporary token.

###### 4.1.2.2.11. Retrieve support file password

####### Navigation

  Retrieve Support File Password from Inventory → Endpoints → All Endpoints

###### 4.1.2.2.12. Send push notifications to iOS

###### 4.1.2.2.13. Monitor agent operational status

####### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex XSIAM management console for specific reasons for the state.

####### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

####### Navigation

  You can monitor the Cortex XDR agent Operational Status in Inventory → Endpoints → All Endpoints

###### 4.1.2.2.14. Monitor agent activity

###### 4.1.2.2.15. Monitor agent upgrade status

####### Navigation

  From Inventory → Endpoints → All Endpoints, you can view the upgrade status of any Cortex XDR agent that you manage

### 4.2. Endpoint DLP

#### 4.2.1. Cortex Data Loss Prevention (DLP) module overview

##### Prerequisite

* Tenant should be onboarded to the new Cortex & Cloud Platform Endpoint DLP add-on License for Cortex and Cloud platforms Cortex agent 9.1 and above for Windows and macOS

##### Navigation

  Settings → Configuration → Access Management → Roles

#### 4.2.2. Personas workflow for DLP

#### 4.2.3. Best Practices

##### Note

* A good example would be to add the description from the Raised Issue Name of the specific Data-in-Motion rule.

* When adding a source, it becomes a mandatory requirement that must be met for the rule to trigger. You should only apply this setting if you want the rule to take action exclusively when files originate from those specific locations.

##### Navigation

  Refer to Modules → Data Security → Data Security Issues → Threats

  Modules → Data Security → Endpoint Data-in-Motion Rules → Endpoint DLP Settings to configure the tenant settings for DLP

#### 4.2.4. Configure DLP end-to-end

##### 4.2.4.1. Onboarding checklist for DLP

###### 4.2.4.1.1. Install DLP browser extension on your endpoint

####### Note

* The extensions are not enabled for Incognito or InPrivate modes in Chrome and Edge. It is recommended to disable these modes in the organization.

* It is highly recommended to refer to Install the Cortex XDR Agent using JAMF for a comprehensive overview of setting up a JAMF profile.Install the Cortex XDR Agent Using JAMF

####### Important

* Endpoints should be linked to the domain.

###### 4.2.4.1.2. Create endpoint applications

###### 4.2.4.1.3. Create endpoint application groups

####### Note

* The catalog contains a list of all supported and tested applications. If an application you need is not on the list, contact support for assistance.

###### 4.2.4.1.4. Create data-in-motion rules

####### Note

* This is not supported in the Beta release.

* Third-party application behaviour: When a file upload is blocked, the local application may display its own generic error message in response to the DLP restriction. In similar cases, some third-party applications might still proceed by sending a dummy file or an error placeholder instead of the actual data.

* To maximize data security, if you use Microsoft Purview for extensive manual and automated file classification tagging and are looking to integrate those labels directly with the DLP policies to trigger protective actions based on a file's sensitivity, refer to How to use information protection labels in Cortex Cloud Data Security.

* Distribution of the Endpoint DLP package is restricted to agents assigned to the data-in-motion policy. This ensures that only endpoints requiring DLP functionality are affected, rather than all eligible endpoints in the tenant.

###### 4.2.4.1.5. Configure endpoint DLP settings

####### Note

* When a fail-close action occurs, the system creates a Data movement blocked by Endpoint DLP fail-close action issue.

* The agent does not force-install the extension if it is already managed by the MDM on the endpoint. The XDR agent ensures full coverage by force-installing the extension on both managed and unmanaged browsers. But if a browser becomes officially managed by the organization later, the extension must be redeployed through the central management console...

* In the case of MDM, the extension is user-managed, so Cortex doesn't remove an installed MDM extension, it only disables communication with the DLP extension.

* You can specify the end-user message per rule.

#### 4.2.5. DLP status in all endpoints

##### Note

* It is recommended to work with the latest security content.

* Close and reopen your browser to activate the DLP extension.

#### 4.2.6. Cortex DLP threat detection and issues

##### Note

* Access to this page is restricted to users with the roles: Data Security Admin, Instance Administrator, and Account Admin.

* If the default action configured in Endpoint DLP Settings is set to Block file movement (fail-close), an issue is raised where the assigned severity is set to low, and includes the Name Data movement blocked by Endpoint DLP default action

##### Navigation

  Data Security → Data Security Issues → Threats

  From Data Security → Data Security Issues → Threats, you can view the DLP issues

## 5. Detect, investigate, and respond to threats

### 5.1. Monitor dashboards and reports

#### 5.1.1. About dashboards

##### Note

* Dashboards that are based on custom infrastructure cannot be exported. When importing a dashboard that already exists in the system, the imported dashboard overwrites the existing dashboard. To avoid overwriting the existing dashboard, duplicate and rename the existing dashboard before importing the new dashboard.

##### Important

* The ability to create, edit, or share custom dashboards is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to custom dashboards.

##### 5.1.1.1. Command Center dashboards

###### Note

* Access to these dashboards requires RBAC permissions under Dashboards & Reports. The Dashboards component must be Enabled in your role and requires View permissions for Command Center Dashboards. If certain options are unavailable, contact your administrator. For more information, Manage access to custom dashboards. The dashboards are available in dark...

###### 5.1.1.1.1. Cortex Command Center

####### Note

* Access to this dashboard requires RBAC permissions under Dashboards & Reports. The Dashboards component must be Enabled in your role and requires View permissions for Command Center Dashboards and Asset Inventory. If certain options are unavailable, contact your administrator. For more information, see Manage access to custom dashboards.

###### 5.1.1.1.2. XSIAM Command Center

####### 5.1.1.1.2.1. Cortex Agentic Assistant dashboard

######## Prerequisite

* The Cortex Agentic Assistant is only available after it is enabled, and for tenants in certain regions. For more information, see Cortex Agentic Assistant.

######## Note

* Access to this dashboard requires RBAC permissions under Dashboards & Reports. The Dashboards component must be Enabled in your role and requires View permissions for Command Center Dashboards. If certain options are unavailable, contact your administrator. For more information, see Manage access to custom dashboards.

####### 5.1.1.1.2.2. Data Inventory

####### 5.1.1.1.2.3. Dynamic View

####### 5.1.1.1.2.4. Cases Overview

###### 5.1.1.1.3. Cloud Detection and Response (CDR) Command Center

####### License Type

  Requires Cortex XSIAM Premium, or any other XSIAM license with the Cloud Runtime Security or the Cloud Posture Security add-on.

###### 5.1.1.1.4. Cloud Security Operations

####### 5.1.1.1.4.1. Cloud Security Operations

######## License Type

  Requires Cortex XSIAM Premium, or any other XSIAM license with the Cloud Runtime Security or the Cloud Posture Security add-on.

######## Note

* Command Center data may not match the counts on the Issues page, and you may observe inconsistencies. This is because dashboard data is a snapshot of issues identified, whereas the Issues page provides the most up-to-date view of risks across your cloud assets. In addition, the Issues pages do not support all the currently available filters on the...

######## 5.1.1.1.4.1.1. Dashboard Widgets

######### 5.1.1.1.4.1.1.1. Generate Reports

######### 5.1.1.1.4.1.1.2. Filter Options

###### 5.1.1.1.5. Cortex Cloud Command Center

##### 5.1.1.2. Predefined dashboards

###### License Type

  Requires the Cortex XSIAM Premium license or any other XSIAM license with the Attack Surface Management (ASM) add-on.

  Requires Cortex XSIAM Premium or any other XSIAM license with the Cloud Posture Security or Cloud Runtime Security add-on.

  Requires the ITDR add-on.

###### Note

* Requires Cortex XSIAM Premium, Enterprise, or any other XSIAM license that includes the Enterprise Runtime or Cloud Runtime Security add-on.

* Requires a Cortex XSIAM Enterprise Plus license.

* Requires Cortex XSIAM Premium, Enterprise, or any other XSIAM license that includes the Enterprise Runtime add-on.

* Users can access all information on the dashboard when their user access is scoped to view All assets or assigned to the Instance Administrator role. Otherwise, users with granular scoping set to No assets or Select asset groups will have limited access to the dashboard. For more information on Scope-Based Access Control (SBAC), see Manage user...

##### 5.1.1.3. Reports

###### 5.1.1.3.1. Report templates

#### 5.1.2. Build custom dashboards and reports

##### 5.1.2.1. Build a custom dashboard

###### Note

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For case-related widgets, you can refine the displayed data to only show results from cases that match a...

##### 5.1.2.2. Manage your Widget Library

###### Note

* Unlike dashboards, individual widgets cannot be shared with other users directly from the Widget Library. Yet, if you add a Restricted widget to a dashboard and then share that dashboard, other users who have access to the dashboard will also be able to see that specific widget.

* Any dashboards or reports that include the widget are affected by the changes.

#### 5.1.3. Fine-tune dashboards and reports

##### 5.1.3.1. Create a custom widget using a script

###### Note

* If you have added arguments to the script, these appear when creating a widget.

* Available options are Pie, Column, Line, and Single Value. To display the result of the script as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### 5.1.3.1.1. Script-based widget examples

####### Note

* Add the widget tag in the script settings to make the script available for use in script-based widgets. For more information, see Create a script.

* If your script returns a time duration, configure the widget with the graph type Single Value and enable Show as Time..

##### 5.1.3.2. Create a text widget

###### Note

* From the Dashboard Manager, you can right-click an existing dashboard and choose Save as report template. You can also add text-based widgets directly to new or existing report templates, as described below.

##### 5.1.3.3. Create custom XQL widgets

###### Note

* Cortex Query Language (XQL) queries generated from the Widget Library do not appear in the Query Center. The results are used only for creating the custom widget.

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### Tip

* You can create a generic dashboard for multiple views of the same dataset by using an asterisk (*) when defining the dataset in the XQL widget as dataset = <dataset_name>*. The placement of the asterisk in the dataset name ensures that any view containing this prefix text is displayed in the results. The dataset in a query is defined as: If there are...

###### 5.1.3.3.1. Configure filters and inputs for custom XQL widgets

####### Prerequisite

* Fixed filters are based on parameters that are defined in custom XQL widgets. Before you can configure fixed filters, take the following steps: Create custom XQL widgets with parameters. For more information, see Create custom XQL widgets. Add the widgets to a custom dashboard. For more information, see Build a custom dashboard.

####### Note

* This option only appears if the dashboard contains custom XQL widgets with defined parameters.

* You can define up to four parameter filters on a single dashboard or report.

* If you specify more than one field, only the first field value is used.

####### Tip

* After the initial setup, when you access your dashboard the filters and inputs might need further refinement. You can make changes to the configured parameters in the XQL widgets, and update the Filters & Inputs on your dashboard until you are satisfied with the results.

##### 5.1.3.4. Configure dashboard drilldowns

###### Prerequisite

* To configure drilldowns your dashboard must contain custom XQL widgets. In addition, if you want to configure in-dashboard drilldowns your custom XQL widget must contain one or more parameters. For more information about configuring parameters in custom XQL widgets, see Create custom XQL widgets.

###### Note

* If the selected parameter is configured in other XQL widgets on the dashboard, these widgets are also affected by the drilldown.

###### 5.1.3.4.1. Variables in drilldowns

#### 5.1.4. Run or schedule reports

##### Note

* Report templates that are based on custom infrastructure cannot be exported. If you import a report template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template. You can also...

* The report name and description will be displayed in the report header and are not editable during customization.

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

* To send reports to Slack, Slack must be configured as an external application in Cortex XSIAM. For more information, see Integrate Slack for outbound notifications

##### Navigation

  Under Settings → Configurations → General → Notifications, click + Add Forwarding Configuration

### 5.2. Investigation and response

#### 5.2.1. Overview of cases

##### 5.2.1.1. What are cases?

##### 5.2.1.2. Resolving cases with AI

##### 5.2.1.3. Case lifecycle

##### 5.2.1.4. Case thresholds

##### 5.2.1.5. Case scope and impact

##### 5.2.1.6. Case and issue domains

###### Note

* You can create your own custom domains to match specific scenarios in your environment. For more information, see Create a case domain.Create a case domain

#### 5.2.2. Case concepts

##### 5.2.2.1. Issues, findings, and events

###### 5.2.2.1.1. Issues

###### 5.2.2.1.2. Findings and events

##### 5.2.2.2. Case grouping

##### 5.2.2.3. Case scoring

###### Note

* Requires a Cortex XSIAM Premium, Enterprise, or Enterprise Plus license.

* SmartScore requires sufficient data to calculate and display the score. On first activation, this can take up to 48 hours. If sufficient data is not available, no score is assigned. If no match is found and there is sufficient data available, Cortex XSIAM assigns a SmartScore. If Cortex XSIAM doesn't have sufficient data to assign a score, you can...

##### 5.2.2.4. Case starring

###### Navigation

  You can manage all starring configurations under Case & Issues → Case Configuration → Starred Issues

##### 5.2.2.5. SLAs and tracking

###### License Type

  This feature requires a Cortex XSIAM Premium, Cortex XSIAM Enterprise, or Cortex XSIAM NG SIEM license.

##### 5.2.2.6. What is Causality?

###### Note

* There are no CGOs in the Cloud Causality View, when investigating cloud Cortex XSIAM alerts and Cloud Audit Logs, or SaaS Causality View, when investigating SaaS-related alerts for 501 audit events, such as Office 365 audit logs and normalized logs.

#### 5.2.3. Analyze and resolve cases

##### 5.2.3.1. Review all cases

###### Note

* The legacy view is also available for users who prefer this format. From the Actions menu select Switch to legacy view.

###### Navigation

  You can enable this setting from Settings → Configurations → General → Server Settings → Unified Case View

##### 5.2.3.2. Start case analysis

###### 5.2.3.2.1. Agentic Assistant- Case Investigation agent

##### 5.2.3.3. Establish case context

###### 5.2.3.3.1. AI-generated case summaries

####### Note

* The AI-generated title and description is a calculated value that is regenerated each time you open a case. This value is not a saved static description, therefore it is not reflected in the saved case names in the list of cases in the Split view , or in the Case Name and Case Description columns in the Table view.

####### Navigation

  Configurations → General → Server Settings → AI Configuration and enable the following settings

###### 5.2.3.3.2. Assess case severity and score

###### 5.2.3.3.3. Update case attributes

####### Note

* The defined values are shown in the Case Name and Case Description columns in the Table view, and saved to the cases dataset. The case title is also shown the list of cases in the Split view. These values do not replace the AI-generated case title and summary. If the Summarize with AI toggle is enabled, AI-generated case summaries are automatically...

##### 5.2.3.4. Analyze case details

###### Note

* If you prefer a tabular or legacy layout, switch the case card to the Detailed view. This view preserves the legacy tab based format and custom layouts, ensuring full backward compatibility. You can switch between the new case experience and the legacy view based on personal workflow preferences. For more information, see Detailed View.

###### 5.2.3.4.1. Grouping graph

####### Note

* Similar issues are displayed as individual entities rather than in a parent/child hierarchy.

###### 5.2.3.4.2. Evidence

###### 5.2.3.4.3. Issue feed

###### 5.2.3.4.4. Associated assets and artifacts

####### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

###### 5.2.3.4.5. MITRE ATT&CK tactics and techniques

####### Note

* This component is available for cases associated with the Security domain or custom domains.

###### 5.2.3.4.6. Detailed View

####### Note

* When an issue is resolved, it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

* Cloud-related issues are displayed in the User Name grouping. Prisma Cloud Compute issues are displayed in the Host Name grouping.

##### 5.2.3.5. Resolve the case

###### 5.2.3.5.1. Resolution Center

####### Note

* Tasks that are already In Progress but still require your input will appear in both the Pending and In Progress tabs.

###### 5.2.3.5.2. Collaborative notes and comments

###### 5.2.3.5.3. Resolve a case

####### Note

* If a case is resolved with the status Resolved - Auto Resolved, Cortex XSIAM can reopen the case for up-to six hours if a new issue is triggered that matches the case. The six-hour period is defined by the timestamp of the last issue that was grouped into the case. After the six-hour period, any new issues are linked to a new case for a new...

###### 5.2.3.5.4. Resolution reasons for cases and issues

####### Note

* The displayed resolution reasons are domain-specific. You can see the resolution reasons that are defined for a domain under Configurations → Object Setup → Cases → Domains.

* Cases and issues resolved as True Positive and False Positive help Cortex XSIAM to identify real threats in your environment by comparing future cases and associated issues to the resolved cases. Therefore, the handling and scoring of future cases is affected by these resolutions.

##### 5.2.3.6. Additional case actions

###### 5.2.3.6.1. Create a case

####### Note

* To create a case manually, you must have View/Edit permission for Cases and Issues selected under Settings → Configurations → Access Management → Roles → Components → Cases & Issues.

* You can assign a case to a single domain only, and you cannot change the assigned domain. For more information, see Case and issue domains.

* This option is only relevant for certain domains.

* You can't attach files to manually created cases.

####### Tip

* The issues that you link to a case can be linked to multiple cases, and the issue domains do not need to match the case domain.

###### 5.2.3.6.2. Merge a case

##### 5.2.3.7. Unified case view

###### License Type

  Requires an MSSP license.

###### Note

* Requires the following RBAC permissions:    Cases & Issues   Investigation & Response → Automation Requires the following RBAC permissions: Cases & Issues Investigation & Response → Automation This view is available for the parent tenant only. To take actions on a child tenant from a parent tenant, you must have the appropriate permissions for both...

* Custom case layouts of child tenants are not visible in the parent tenant.

#### 5.2.4. Investigate issues

##### 5.2.4.1. Overview of the Issues page

###### Note

* Every 12 hours, the system enforces a cleanup policy to remove the oldest issues once the maximum limit is exceeded. The default issue retention period in Cortex XSIAM is 186 days.

##### 5.2.4.2. Issue card

###### License Type

  Requires Cortex XSIAM Premium license or any other XSIAM license with the TIM add-on.

###### Note

* This section is context-specific and shows data according to the issue context.

##### 5.2.4.3. Link or unlink issues from a case

##### 5.2.4.4. Run an automation on an issue

###### Note

* In addition to automation, some playbooks contain manual tasks that prompt the analyst for input. This enables you to enhance an automation workflow with analyst input.

* You can also manually select a playbook to run from the Issue Work Plan tab.

##### 5.2.4.5. Use the War Room in an investigation

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* The case War Room is usually used for communication capabilities, but unlike the issue War Room, it does not include playbook specific entries. The case War Room enables you to investigate an entire case, not just an issue.

* Cortex XSIAM does not index notes and chats.

###### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

* You can use the up/down arrow buttons in the CLI to do a reverse history search for previous commands with the same prefix.

###### Navigation

  Investigation & Response → Automation → Playground

##### 5.2.4.6. Use the Work Plan in an investigation

###### Important

* A playbook will not continue its execution path if a prior task has failed; you must resolve the failed task before subsequent tasks can run.

##### 5.2.4.7. Issue syncing

###### Prerequisite

* You must set up an integration before you can sync issues. For more information, see Set up an integration for mirroring issues.

###### Note

* Multiple tickets can be linked to an issue with outbound syncing. Issues with inbound syncing can be linked to a single ticket only.

* Using issue fields as variables is not currently supported.

* You can only define a single inbound profile. If you change the inbound sync profile the current profile is overwritten. You can define multiple outbound profiles; one issue can update multiple tickets.

* The inbound syncing flow runs every two minutes, and the outbound syncing flow runs every five minutes. In a bi-directional set-up, if the same field is updated in both tickets, the most recently updated value is used. In the external ticket, the logged history shows updates to the ticket. The user name that is logged with the history reflects the user...

* After an issue is resolved, ticket syncing remains active for up-to seven days. Therefore, you still update, change, or reopen the issue or external ticket and the tickets will continue to sync.

* If you change the selected inbound sync profile, the original sync profile is immediately overwritten.

###### Warning

* If you leave this field blank, all configured instances will be used.

###### Tip

* You can find a sync profile ID under Settings → Configurations → Object Setup → Issues → Sync Profiles. By default the ID field is not displayed in the table. Click the three dot menu and add it to the table layout.

###### Navigation

  Settings → Configurations → Marketplace

##### 5.2.4.8. Cortex Response and Remediation content pack

###### 5.2.4.8.1. Investigate an issue using Cortex Response and Remediation playbooks

###### 5.2.4.8.2. Example use cases

##### 5.2.4.9. Causality view

###### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

###### 5.2.4.9.1. Network causality view

####### Note

* The network causality view displays only the information it collects from the detectors. It is possible that the CI may not show some of the firewall or agent processes.

####### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

###### 5.2.4.9.2. Cloud causality view

###### 5.2.4.9.3. SaaS causality view

###### 5.2.4.9.4. Timeline

####### Note

* The Timeline view is not available when investigating cloud Cortex XSIAM issues and cloud audit logs or SaaS-related issues for 501 audit events, such as Office 365 audit logs and normalized logs. Only the applicable cloud causality view and SaaS causality view is available for this data.

###### 5.2.4.9.5. Causality icons key

##### 5.2.4.10. Issue investigation actions

###### 5.2.4.10.1. Copy issues

###### 5.2.4.10.2. Update issue fields

####### Note

* You must create a custom status before you can select it.

####### Tip

* You can create custom issue statuses and resolution reasons, and use the setIssueStatus command to set these custom statuses for issues. For example, when a user starts investigating an issue, the issue status is automatically changed from New to Under Investigation. In some cases, it is useful to create an interim status, such as Triage. After you...

###### 5.2.4.10.3. Query case and issue data

####### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

###### 5.2.4.10.4. Exclude an issue

###### 5.2.4.10.5. Create a featured field

####### Note

* Featured Active Directory values are displayed in the User and Host fields accordingly.

####### Navigation

  Cases & Issues → Case Configuration → Featured Fields and select a type of featured field

###### 5.2.4.10.6. Export issue details to a file

###### 5.2.4.10.7. Investigate contributing events

###### 5.2.4.10.8. Retrieve additional issue details

####### Tip

* If you require assistance from Palo Alto Networks support to investigate the issue, make sure to provide the downloaded ZIP file.

###### 5.2.4.10.9. View generating BIOC or IOC rule

###### 5.2.4.10.10. Create profile exceptions

####### Navigation

  Inventory+Endpoints → Policy Management → Profiles

###### 5.2.4.10.11. Add a file path to a malware profile allow list

####### License Type

  Requires Cortex XSIAM Enterprise, Premium, or any other XSIAM license that includes endpoints or Cortex Cloud Runtime Security.

####### Navigation

  Inventory+Endpoints → Policy Management → Prevention → Profiles and locate the malware profile you selected

###### 5.2.4.10.12. Close an issue

####### Note

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

#### 5.2.5. Review findings

##### Note

* Some finding types require the Cortex XSIAM Premium license, or any other XSIAM license with the Cloud Posture Security or Cloud Runtime Security add-on.

##### 5.2.5.1. Findings card

###### Note

* The information in this card is context specific, therefore some sections are not available for all findings.

#### 5.2.6. Investigate artifacts and assets

##### 5.2.6.1. Investigate an IP address

###### Note

* Requires a license key. Select Settings → Configurations → Integrations  → Threat Intelligence.

##### 5.2.6.2. Investigate an asset

###### Note

* The Asset view is available for hosts with a Cortex XDR agent installed.

##### 5.2.6.3. Investigate a host

###### License Type

  The Host Risk View requires the Identity Threat Module add-on. Depending on your permissions, some information may be limited by your scope.

###### Note

* Cortex XSIAM normalizes and displays case and issue times in your time zone. If you're in a half-hour time zone, the activity in the graphs is displayed in the whole-hour time slot preceding it. For example, if you're in a UTC +4.5 time zone, the time displayed for the activity will be UTC +4.5, however, the visualization will be in the UTC +4 slot.

###### Tip

* You can also see a list of all hosts under Inventory → Assets → Asset Scores.

##### 5.2.6.4. Investigate a file and process hash

###### Note

* Requires a license key. Go to Settings → Configurations → Integrations  → Threat Intelligence.

##### 5.2.6.5. Investigate a user

###### License Type

  If the Identity Threat module is enabled, you can open the User Risk View. This view displays insights and profiling information to help you investigate issues and cases. Viewing anomalies in the context of baseline behavior facilitates risk assessment and shortens the time you require for making verdicts. If the Identity Threat module is not enabled...

  The User Risk view is available with the ITDR add-on. Depending on your permissions, some information may be limited by your scope.

###### Note

* Cortex XSIAM normalizes and displays case and issue times in your time zone. If you're in a half-hour time zone, the activity in the Issues & Insights Heatmap is displayed in the whole-hour time slot preceding it. For example, if you're in a UTC +4.5 time zone, the time displayed for the activity will be UTC +4.5, however, the visualization in the...

###### Tip

* You can also see a list of all users under Inventory → Assets → Asset Scores.

#### 5.2.7. Investigate endpoints

##### 5.2.7.1. Overview of the Action Center

###### Note

* For actions on endpoints, you need a Cortex XSIAM Premium, or Enterprise license, or any other XSIAM license with the Enterprise Runtime Security or Cloud Runtime Security add-on.

* Blocking files on endpoints is enforced by the endpoint malware profile. To block a hash value, ensure the hash value is configured in the Malware security profile. Select Override Report mode to allow the agent to block hashes, even if the Malware Profile is set to Report.

###### Navigation

  Investigation & Response → Response → Action Center

###### 5.2.7.1.1. Initiate and monitor endpoint actions

####### Navigation

  Investigation & Response → Response → Action Center → New Action

  Investigation & Response → Response → Action Center

###### 5.2.7.1.2. Action Center reference information

##### 5.2.7.2. Manage endpoints

###### Note

* For the Include endpoints from auto upgrade action, you cannot enable auto upgrade for Mobile, VDI, and TS installations.

* If an endpoint is excluded, the auto upgrade profile configuration is not available. If you exclude the endpoint from auto upgrade while the auto upgrade action is In progress, the ongoing upgrade will still take place.

* Content Status is calculated every 30 minutes. Therefore, there might be a delay of up to 30 minutes in displaying the data.

* Only supported for Windows and macOS.

* Changes to the agent status can take up to ten minutes to display on Cortex XSIAM .

###### Navigation

  Inventory → Endpoints → All Endpoints

  Settings → Configurations → General → Agent Configurations → Endpoint Administration Cleanup

##### 5.2.7.3. Retrieve files from an endpoint

###### Note

* You cannot define a path using environment variables on Mac and Linux endpoints.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Disabling File Retrieval does not take effect on file retrieval actions that are in progress.

##### 5.2.7.4. Retrieve support logs from an endpoint

###### Navigation

  Investigation & Response → Response → Action Center → + New Action

##### 5.2.7.5. Retrieve support file password

###### Navigation

  Retrieve Support File Password from Inventory → Endpoints → All Endpoints

##### 5.2.7.6. Scan an endpoint for malware

###### Navigation

  Investigation & Response → Response → Action Center → New Action

#### 5.2.8. Investigate files

##### Note

* To take actions on endpoints, you need the Cortex XSIAM Premium, Enterprise, or any other XSIAM license with the Enterprise Runtime Security (XDR) add-on.

##### 5.2.8.1. Manage file execution

###### Navigation

  Investigation & Response → Response → Action Center → New Action

##### 5.2.8.2. Manage quarantined files

###### Note

* This will restore all files with the same hash on all of your endpoints.

##### 5.2.8.3. Review WildFire analysis details

###### Note

* Cortex XSIAM displays the preview of WildFire reports that were generated within the last couple of years. To view a report that was generated more than two years ago, you can download the report.

##### 5.2.8.4. Import file hash exceptions

###### Navigation

  Investigation & Response → Response → Action Center → New Action

#### 5.2.9. Cortex Assistant

##### Note

* If you are in an eligible region and have enabled the Cortex Agentic Assistant, the Cortex Agentic Assistant replaces the Cortex Assistant. The Cortex Assistant is available if you do not have access to the Cortex Agentic Assistant based on the tenant region or you have not enabled it. For more information, see Cortex Agentic Assistant.

##### Navigation

  To increase usability, you can create a personalized keyboard shortcut: Settings → Configurations → Server Settings → Keyboard Shortcuts and choose the shortcut you want to use

##### 5.2.9.1. Cortex Assistant layout

##### 5.2.9.2. Cortex Assistant capabilities

###### Note

* When you choose an option from the Respond column, Cortex Assistant will always prompt you to approve the action before executing.

#### 5.2.10. Response actions

##### Caution

* Response actions are not supported for Android endpoints.

##### 5.2.10.1. Initiate a Live Terminal session

###### Note

* You can run PowerShell 5.0 or a later release on Live Terminal of Windows.

* Network drives are not supported.

* On Windows endpoints, you cannot run GUI-based cmd commands like winver or appwiz.cpl.

* Disabling Live Terminal does not take effect on sessions that are in progress.

###### Tip

* You can fine-tune the Live Terminal session visibility on the endpoint by adjusting the User Interface options in your Agent Settings Profile.

##### 5.2.10.2. Isolate an endpoint

###### Note

* IP-based file storage protocol traffic will also be blocked. This might affect endpoint functionality if the endpoint uses such mounts.

* If file system operations become unresponsive during isolation, such as being unable to list folder content, unmount the mounted network shares.

###### Tip

* If needed, Filter the list of endpoints.

##### 5.2.10.3. Pause endpoint protection

###### Note

* Pausing your endpoint protection modules leaves your machines exposed to risks.

###### Navigation

  Investigation & Response → Response → Action Center and locate Action Type Pause Endpoint Protection or Resume Endpoint Protection

##### 5.2.10.4. Run agent scripts on an endpoint

###### Prerequisite

* To run scripts on an endpoint, you must have the following system requirements: Endpoints running the Agent v7.1 and later. Since the agent uses its built-in capabilities and many available Python modules to execute the scripts, no additional setup is required on the endpoint. Role in the hub with the following permissions to run and configure...

###### Note

* *Since all scripts are running under System context, you cannot perform any registry operations on user-specific hives (HKEY_CURRENT_USER of a specific user).

* Always use lowercase for variable names.

* Disabling Script Execution does not take effect on scripts that are in progress.

##### 5.2.10.5. Remediate changes from malicious activity

###### Prerequisite

* To initiate remediation suggestions, you must have the following system requirements: An App Administrator, Privileged Responder, or Privileged Security Admin role permissions which include the remediation permissions. EDR data collection enabled. Agent version 7.2 or above on Windows endpoints.

###### Note

* Endpoints that are part of the Case view and do not meet the required criteria are excluded from the remediation analysis.

##### 5.2.10.6. Search and destroy malicious files

###### Prerequisite

* The following are prerequisites to enable Cortex XSIAM to search and destroy files on your endpoints: Supported platforms:    Windows: Cortex XDR agent version 7.2 or a later. If you plan to enable Search and Destroy on VDI sessions, you must perform the initial scan on the Golden Image.   Mac: Cortex XDR agent version 7.3 or a later release running on...

###### Note

* The Cortex XSIAM agent does not include the following information in the local files inventory: Information about files that existed on the endpoint and were deleted before the Cortex XSIAM agent was installed. Information about files where the file size exceeds the maximum file size for hash calculations that are pre-configured in Cortex XSIAM . If...

##### 5.2.10.7. Manage external dynamic lists

###### Note

* To configure an EDL, you must have a role that includes EDL permissions, such as Instance Admin or Account Admin. Configuring custom certificates or private API Keys in the EDL integration instance is supported only on engines, not on the Cortex XSIAM server. For EDL integrations on the server, you must set a username and password. For long-running...

* The legacy external dynamic list PAN-OS integration is deprecated. Configure the EDL integration on the Data Sources & Integrations page (by clicking the Automation & Feed Integration link.

* If the EDL integration runs on the Cortex XSIAM server, you do not need to enter a Listen Port in the instance settings. The system auto-selects an unused port for the EDL integration when the instance is saved. If you enter a value for Listen Port, it will be overwritten by the port auto-selected by the system

###### Important

* The EDL URL must always be prefixed by ext-.

##### 5.2.10.8. Collect a memory image

###### License Type

  This functionality has the following license requirements: Forensics add-on license.

#### 5.2.11. Forensics

##### License Type

  Requires the Forensics add-on

##### 5.2.11.1. Forensic investigations

###### 5.2.11.1.1. Manage an investigation

####### 5.2.11.1.1.1. Create a new investigation

######## Note

* To set up user permissions, you must have Scope-Based Access Control (SBAC) enabled.

####### 5.2.11.1.1.2. Edit an investigation

####### 5.2.11.1.1.3. Close an investigation

######## Note

* When you close an investigation, Palo Alto Networks has a grace period of 24 hours before deleting any collections associated with the investigation. During this timeframe, you have the option to cancel the close investigation action.

####### 5.2.11.1.1.4. User permissions

######## Note

* Even if a user does not have access to view an investigation via the Forensics Investigations page, they can still query the results of the collections using an XQL query.

###### 5.2.11.1.2. Data collection

####### 5.2.11.1.2.1. Hunting

######## 5.2.11.1.2.1.1. Create a hunt

######## 5.2.11.1.2.1.2. Hunt results

######## 5.2.11.1.2.1.3. Hunt status

####### 5.2.11.1.2.2. Triage

######## 5.2.11.1.2.2.1. Create a triage

######## 5.2.11.1.2.2.2. Upload an offline triage package

######## 5.2.11.1.2.2.3. Offline triage collection

######## 5.2.11.1.2.2.4. Triage results

######## 5.2.11.1.2.2.5. Triage status

####### 5.2.11.1.2.3. Configure collection

######## Note

* When search fields are specified, the search is limited based on those filters. If more than one entry is in a search filter field, the search returns entries that match any of them. For example: A File Search with two specified paths ("C:\Test\*" and "C:\Windows\*") will return results from both the Test and Windows folders. If you specify multiple...

* Data collected during a Triage Collection is categorized into Artifacts, Volatiles, and File Collection

* Supported only for the UFW tool (Firewall managment tool for some Linux distributions such as Ubuntu)

###### 5.2.11.1.3. Analysis and documentation

####### 5.2.11.1.3.1. Review alerts

####### 5.2.11.1.3.2. Investigation timeline

####### 5.2.11.1.3.3. Key assets & artifacts

###### 5.2.11.1.4. Export

####### Note

* You can export a collection more than once.

#### 5.2.12. Notebooks

##### Note

* The Instance Administrator role has these permissions by default.

* You can only add one instance of Notebooks. Notebooks have access to approved sites on the internet when embedded in Cortex XSIAM. To delete the Notebook, hover over Notebooks and select the delete icon. Installing or uninstalling some plug-ins and packages requires the Notebooks server to refresh the web page. For these actions, go to File → Shut...

##### Important

* You need a daily minimum of 1000 compute units. After activation, 1,000 units are deducted daily at 00:00 UTC. XQL and BQ queries performed in Cortex XSIAM Notebooks are calculated similarly to Compute Unit usage of XQL queries originating from public APIs. You can't create a Jupyter instance without sufficient Compute Units. Based on your security...

##### Navigation

  Before you begin, ensure that you have the View/Edit permissions in Settings → Configurations → Access Management → Roles → Configurations → Apps

  In Cortex XSIAM, select Settings → Configurations → Integrations → Apps

  View/Edit permissions in Settings → Configurations → Access Management → Roles → Apps → Jupyter

##### 5.2.12.1. Manage datasets in Notebooks

###### Note

* If a schema is not provided, the function automatically detects the schema.

* Using this function, you can only delete datasets created using the Notebooks APIs. When you delete a dataset, the rules that use the dataset return an error.

##### 5.2.12.2. Notebooks scheduler

#### 5.2.13. Build XQL queries

##### Note

* If you have the Cortex Agentic Assistant, you can use natural language prompts to create and run XQL queries within the chat interface. For more information, see Create and run XQL queries with Agentic Assistant chat.

##### 5.2.13.1. About the Query Builder

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

##### 5.2.13.2. How to build XQL queries

###### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

###### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

###### 5.2.13.2.1. Get started with XQL queries

####### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

###### 5.2.13.2.2. Useful XQL user interface features

####### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

###### 5.2.13.2.3. XQL Query best practices

###### 5.2.13.2.4. Expected results when querying fields

###### 5.2.13.2.5. Create XQL query

####### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined for the entire query, including queries that are part of the join stage. Yet, this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

###### 5.2.13.2.6. Review XQL query results

####### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* Results are received incrementally for the first 100K records, or up to 100MB worth of records, whichever comes first. After that, the next update is when the query has finished running completely.

* Real time query results are available only in the Query Builder and in free text query. Real time results are displayed only for queries run on hot datasets. The Sort option is available only after all the data is retrieved. When you formulate complex queries, the results will be displayed when the query has finished running completely, and not in real...

* In order for Cortex XSIAM to provide a histogram for a field, the field must not contain an array or a JSON object.

###### 5.2.13.2.7. Translate to XQL

####### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

###### 5.2.13.2.8. Graph query results

####### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### 5.2.13.3. Query Builder templates

###### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

###### 5.2.13.3.1. Get started with Query Builder templates

###### 5.2.13.3.2. Considerations for using Query Builder templates

###### 5.2.13.3.3. Create a query from a template

####### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

###### 5.2.13.3.4. Run a free text query

####### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

###### 5.2.13.3.5. Query Builder template examples

####### Navigation

  Investigation & Response → Search → Query Builder

##### 5.2.13.4. Overview of the Query Center

###### Note

* Very short queries might not be listed. You cannot cancel correlation queries. The default retention period for historic queries is aligned with issue retention.

###### 5.2.13.4.1. Edit and run queries in Query Center

####### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

####### Navigation

  Investigation & Response → Search → Query Center → Query History

####### 5.2.13.4.1.1. Query Center reference information

######## Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 5.2.13.5. Manage scheduled queries

###### Navigation

  Investigation & Response → Search → Scheduled Queries

###### 5.2.13.5.1. Scheduled Queries reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 5.2.13.6. Manage your query library

###### Note

* The Query to Library option is only available if your role has the Create Queries capability. For more information, see Manage access to saved queries.

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

###### Important

* The ability to create, edit, or share queries is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to saved queries.

##### 5.2.13.7. Federated Search

###### 5.2.13.7.1. Federated Search

####### Note

* Federated Search is not enabled by default. To enable it in your tenant, please contact your Customer Support Team.

* Federated search query costs are calculated according to timeframe, complexity, and any cross-cloud egress costs that may apply.

* For optimal results, we recommend the Parquet format.

* The list of supported regions may change in the future.

###### 5.2.13.7.2. Federated Search configuration

####### Prerequisite

* Access to Cortex XSIAM communication. For a list of the authorized IP addresses, see Enable access to required PANW resources. An AWS bucket that contains your data sources. Permissions to modify IAM policies in AWS.

* Access to Cortex XSIAM communication. For a list of the authorized IP addresses, see Enable access to required PANW resources. A GCS bucket that contains your data sources. Permissions to modify IAM policies in GCS.

* Access to Cortex XSIAM communication. For a list of the authorized IP addresses, see Enable access to required PANW resources. An Azure Blob Storage blob with your data sources. Permissions to modify IAM policies in Azure Blob Storage.

####### Note

* We highly recommend that you don't change the auto-detected schema. However, if the auto-detected schema is incorrect, you can add, edit or delete fields. You can't delete the ds field, which is used for Hive partitioning. After you save the schema, you can't delete any fields you added during setup.

* You can only configure regions that are in the multi-region of your tenant.

* We highly recommend that you don't change the auto-detected schema. You can't delete the ds field, which is used for Hive partitioning. After you save the schema, you can't delete any fields you added during setup.

* Copy the Directory (tenant) ID, the Application (client) ID, and the Object ID. You will use these in the connection step.

* We highly recommend that you don't change the auto-detected schema. However, you can add, edit or delete fields. You can't delete the ds field, which is used for Hive partitioning. After you save the schema, you can't delete any fields you added during setup.

* When you create, delete, or update an external dataset, the action is recorded in the Management Audit Logs under the type External Datasets.

####### Navigation

  Settings → Configurations → Data Management → Dataset management → External Datasets and click Add External Dataset

###### 5.2.13.7.3. Query using Federated Search

####### Note

* The following aren't available in Federated Search and remain exclusive to fully ingested data. Complex, cross-source analytical functions, for example correlations, widgets, dashboards, and APIs search, target and view XQL stages

####### Navigation

  Incident Response → Investigation → Query Builder and select XQL

###### 5.2.13.7.4. Manage external datasets

####### Note

* We highly recommend that you don't change the auto-detected schema. However, in the Edit window you can add new fields or delete the new fields you added in the Edit window. You can't delete the fields that were configured during setup.

####### Navigation

  Manage external datasets created for federates searches in Settings → Configurations → Data Management → Dataset management → External Datasets

##### 5.2.13.8. Legacy Query Builder

###### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

###### 5.2.13.8.1. Create authentication query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 5.2.13.8.2. Create event log query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 5.2.13.8.3. Create file query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 5.2.13.8.4. Create image load query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 5.2.13.8.5. Create network connections query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 5.2.13.8.6. Create network query

####### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

###### 5.2.13.8.7. Create process query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 5.2.13.8.8. Create registry query

####### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

###### 5.2.13.8.9. Query across all entities

####### Navigation

  Investigation & Response → Search → Query Builder

#### 5.2.14. Research a known threat

### 5.3. Agentic Assistant chat

#### 5.3.1. Get started with Agentic Assistant chat

##### Note

* The Cortex Agentic Assistant is currently available in limited regions. For more information see Cortex Agentic Assistant If your tenant is not within one of those regions, you have access to the Cortex Assistant. To enable the Cortex Agentic Assistant, go to Settings → Configurations → General → Server Settings → AI Configuration.

#### 5.3.2. Choose an Agentic Assistant agent

##### Note

* Requires the Exposure Management add-on.

#### 5.3.3. Chat with an Agentic Assistant agent

##### Note

* Case data is only loaded when you send your first message. Opening the chat interface without sending a prompt does not provide the agent with the case context.

* An agent's proposed plans and results may contain inaccuracies or errors. Always review the results carefully to ensure you fully understand the proposed action before proceeding.

##### Tip

* You can quickly jump to different product pages within Cortex XSIAM by typing / in the prompt area. This shortcut is a built-in navigation feature that is available even if the Cortex Agentic Assistant is disabled.

#### 5.3.4. Create and run XQL queries with Agentic Assistant chat

##### Note

* The TextToXQL action is a hidden system action and does not appear in the Agents Hub.

* If you are in a non-supported region and ask an agent to create an XQL query, it may attempt to generate the query using general logic. We do not recommend this, as it may result in inaccurate syntax and unreliable results.

* Running XQL queries manually through agent does not consume compute units. This includes scenarios where you prompt the agent to create and execute a multi-step plan.

#### 5.3.5. Manage chat history

### 5.4. Inventory management

#### 5.4.1. Asset management

##### 5.4.1.1. All Assets

###### Note

* When working with the Asset Inventory page, consider the following: To maintain an accurate and clutter-free asset inventory, an automated cleanup process periodically removes outdated assets in the background.

* The options available are dependent on your license.

###### 5.4.1.1.1. Container Images

####### Navigation

  All Assets → Compute → Container Images

###### 5.4.1.1.2. Kubernetes Cluster

####### Note

* The Vulnerabilities tab is only available if the cluster you wish to analyze has a K8s connector.

####### Navigation

  Inventory → All Assets → Compute → Kubernetes Cluster for a Kubernetes Clusters assets overview

###### 5.4.1.1.3. Container Instances

####### Navigation

  Asset Inventory → Compute → Container Instances

###### 5.4.1.1.4. External Surface assets

####### License Type

  Requires the Attack Surface Management (ASM) add-on

####### 5.4.1.1.4.1. External Surface attribution evidence

##### 5.4.1.2. Network configuration

###### 5.4.1.2.1. Configure your network parameters

####### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

* Viewing external IP address ranges requires the Attack Surface Management add-on.

####### Navigation

  In Cortex XSIAM , select Assets → Network Configuration → Internal Domain Suffixes

##### 5.4.1.3. Asset Groups

###### Note

* When you create or edit an Asset Group, the changes are applied immediately to new assets and to existing assets that have been updated. However, it may take a few hours for the changes to appear on existing assets that have not been updated.

###### Navigation

  Inventory → Assets → Groups → Add Group

##### 5.4.1.4. Asset Roles

###### Note

* Asset Roles are available only if the Identity Threat Module add-on is enabled.

###### 5.4.1.4.1. Manage Asset Roles for Endpoints

####### Note

* Endpoint Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added endpoint removes the endpoint from the Included Endpoints list. If this endpoint is detected automatically as having this asset role in the future, it will appear in the Included Endpoints list. Excluding a manually added endpoint ensures that even if in the future the endpoint is detected as having this asset role, this...

###### 5.4.1.4.2. Manage Asset Roles for Users

####### Note

* User Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added user removes the user from the Included Users list. If this user is detected automatically as having this asset role in the future, it will appear in the Included Users list again. Excluding a manually added user ensures that even if in the future the user is detected as having this asset role, this detection is overridden and...

####### 5.4.1.4.2.1. Honey user

######## Prerequisite

* The honey user role is available only if the Identity Threat Module add-on is enabled.

##### 5.4.1.5. Manage Asset Scores

###### Note

* The Hosts tab is available if the Identity Threat Module add-on is enabled.

* As new alerts are associated with incidents, the User and Host Scores are recalculated. You can view the latest User and Host Scores on the Asset Scores page, or track the Score trend on the User Risk View and Host Risk View.

* Some User Associated Insights may not appear as part of the User Associated Incidents due to the insight generation mechanism. For example, when an insight related to one of the assets in an incident is generated a few days after the associated incident, the insight may not be associated with the incident.

##### 5.4.1.6. Vulnerability Assessment

###### Prerequisite

* The following are prerequisites for Cortex XSIAM to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XSIAM lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex XSIAM...

* The following are prerequisites for Cortex XSIAM to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex XSIAM collects all the information about the operating system and the installed...

###### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex XSIAM Application Inventory.

###### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

###### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

### 5.5. Threat management

#### 5.5.1. Detection rules

##### 5.5.1.1. What are detection rules?

###### 5.5.1.1.1. What's an IOC?

####### Note

* Cortex XSIAM supports a maximum of 4,000,000 IOCs.

####### 5.5.1.1.1.1. IOC rule details

######## Note

* Field cannot exceed 36 characters.

######## Navigation

  In the Threat Management → Detection Rules → IOC page, you can view all configured or uploaded indicators of compromise (IOCs

####### 5.5.1.1.1.2. Create an IOC rule

######## Note

* To ensure your IOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically does the following: Disables any IOC rules that reach 5000 or more hits over 24 hours. Creates a rule exception based on the PROCESS SHA256 field for IOC rules that hit more than 100 endpoints over 72 hours. If you have the Threat...

######## Navigation

  In Threat Management → Detection Rules → IOC, select + Add IOC

###### 5.5.1.1.2. What's a BIOC?

####### 5.5.1.1.2.1. BIOC rule details

######## Navigation

  Manage your behavioral indicator of compromise (BIOC) rules in Threat Management → Detection Rules → BIOC

####### 5.5.1.1.2.2. Create a BIOC rule

######## License Type

  Custom prevention rules are supported on Cortex XSIAM agent 7.2 and later versions and enable you to configure and apply user-defined BIOC rules to Restriction profiles deployed on your Windows, Mac, and Linux endpoints.

######## Note

* To ensure your BIOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically does the following: Disables BIOC rules that reach 5000 or more hits over a 24-hour period. Creates a rule exception based on the PROCESS SHA256 field for BIOC rules that hit more than 100 endpoints over a 72 hour period.

* A cloud_audit_log dataset requires a Cortex XDR Pro per GB license. Currently, you cannot create a BIOC rule on customized datasets and only the filter stage, alter stage, and functions without any aggregations are supported for XQL queries that define a BIOC. For BIOC rules, the field values in XQL are evaluated as case insensitive (config...

* To demonstrate the expected behavior of the rule before you save it, Cortex XSIAM tests the BIOC on historical logs. After you save a BIOC rule, it will operate both on historical logs (up to 10,000 hits) and on new data received from your log sensors.

* To demonstrate the expected behavior of the rule before you save it, Cortex XSIAM tests the BIOC on historical logs. After you save a BIOC rule, it will operate on both historical logs (up to 10,000 hits) and new data received from your log sensors.

* You can only import files that were exported from Cortex XSIAM. You can not edit an exported file.

* You can only add to existing profiles you created, Cortex XSIAM Default profiles will not appear as an option.

* Auto-disable will turn off both the BIOC rule detection and the BIOC prevention rule.

####### 5.5.1.1.2.3. Manage Global BIOC Rules

###### 5.5.1.1.3. What's a correlation rule?

####### Navigation

  After you configure your correlation rules, you can manage them in Threat Management → Detection Rules → Correlations, and view and analyze the generated issues in Cases and the Issues Table

####### 5.5.1.1.3.1. Correlation rule details

######## Note

* Only an administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM .

* For more information on troubleshooting server errors in scheduled correlation rules, Troubleshoot server errors in scheduled correlation rules.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

######## Navigation

  If you are assigned a role that enables Investigation → Rules privileges, you can manage all user-defined Correlation Rules from Threat Management → Detection Rules → Correlations

####### 5.5.1.1.3.2. Create a correlation rule

######## Prerequisite

* To enable pivots from issues to a third-party source system, ensure that you know the dataset field name that contains the URL of the source system. Some vendors already provide this URL as part of their API, and you can find it in the third-party product dataset. If there is no URL, you cannot enable this feature.

######## Note

* When creating a Real Time Correlation Rule, you can only generate an issue as the resulting action for the Correlation Rule. All other options are disabled. To ensure your Correlation rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically disables Correlation rules that reach 5000 or more hits over a...

* When you open the New Correlation Rule editor from XQL Search, this XQL Search field is already populated with the XQL query that you defined. An administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM . All other users can only create and view queries built with an existing dataset.

* The XQL features for call, top, and wildcards in datasets (dataset in (<dataset prefix>_*)) are currently not supported in Correlation Rules. If you add them to the XQL definition, you will not be able to Create or Save the Correlation Rule. The XQL features for transaction in datasets (dataset in (<dataset prefix>_*)) are currently not supported in...

* The incident that contains the issues will also be assigned to the selected domain. For more information, see Case and issue domains. If you want to generate a health issue, choose the Health domain. For more information about health issues, see About health issues.

* If a generated issue has severity Medium or above, a case is automatically opened. Low severity issues generated by correlation rules are not grouped into cases.

* There is no validation or auto complete for these parameters and the values can be null or empty. In these scenarios, Cortex XSIAM does not display the null or empty values, but adds the text NULL or EMPTY in the descriptions.

* When more than one XDM field is listed, Cortex XSIAM looks for the field value according to the order of the fields listed.

* When Use the Cortex XSIAM default incident enrichment is not selected and you have not mapped any issue fields, the issue is dispatched into a new incident.

######## Important

* The maximum size of a lookup dataset is 50 MB. If the data exceeds this limit, the add to lookup action fails.

######## Tip

* When creating your correlation rule, you can use predefined values for different fields in the editor, such as Alert Name, Alert Description, and Drill-Down Query. For more information, see Field replacement syntax in correlation rules.

######## Navigation

  You can create a new correlation rule from either the Threat Management → Detection Rules → Correlation Rules page or when building a query in XQL Search

####### 5.5.1.1.3.3. Field replacement syntax in correlation rules

####### 5.5.1.1.3.4. Manage correlation rules

######## Note

* Execute Rule is not available for real time correlation rules.

####### 5.5.1.1.3.5. Monitor correlation rules

######## Note

* In the dataset, the Query start time and Query end time indicate the time frame of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

####### 5.5.1.1.3.6. Troubleshoot server errors in scheduled correlation rules

###### 5.5.1.1.4. Manage IOC and BIOC rules

####### Note

* For Analytics BIOC rules, you can only disable and enable rules.

* You cannot delete global BIOCs delivered with content updates.

* For BIOC rules that are applied to prevention profiles: If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention on the agent works as usual. If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention...

* When a BIOC rule is disabled automatically by Cortex XSIAM, for example due to the server anti flooding mechanism, prevention on the agent works as before.

####### Navigation

  Threat Management → Detection Rules → BIOC

#### 5.5.2. Analytics

##### 5.5.2.1. Analytics overview

###### 5.5.2.1.1. Analytics engine

###### 5.5.2.1.2. Analytics sensors

###### 5.5.2.1.3. Coverage of MITRE Attack tactics

###### 5.5.2.1.4. Review MITRE ATT&CK framework coverage

####### Note

* When a contributing data source type is active, it does not imply that all the rules and detectors associated with the data source type are active. Rule applicability is dependent on the data source's context and configuration. To enable an active status, data source types require the following setup: Endpoint: Installed Cortex XDR agent. Network: A...

###### 5.5.2.1.5. Analytics detection time intervals

####### Note

* When establishing a baseline, detectors compute limits beyond which network activity will require an issue. In some cases, detectors do not compute baseline limits; instead they are predetermined by Cortex XSIAM engineers. The engineers determine the values used for predetermined limits using statistical analysis of malicious activity recorded...

###### 5.5.2.1.6. Analytics issues and Analytics BIOCs

###### 5.5.2.1.7. View and manage Analytics rules

####### Note

* The default severity is updated by content updates. If a content update determines a new default severity for the rule that's the same as the value you had previously determined, you won't have the option to reset to default. For example, if the default was Informational, and you changed the severity to Medium, and after a content update Cortex XSIAM...

* When you select multiple rows, you can only enable or disable the selected rules.

####### Warning

* Changing the default severity may result in issues not being triggered or too many issues being triggered. Please consider this carefully before you change the severity recommended by Cortex XSIAM. Any responsibility for not getting issues triggered as a result of changing the severity will be yours.

###### 5.5.2.1.8. Identity Analytics

####### Navigation

  After configuring your Cloud Identity Engine instance and Cortex XSIAM Analytics, select Settings () → Configurations → Cortex XSIAM - Analytics, and in the Featured in Analytics section, Enable Identity Analytics

###### 5.5.2.1.9. Identity Threat Module (ITDR)

###### 5.5.2.1.10. AI Detection & Response in Cortex XSIAM (Beta)

####### Prerequisite

* To enable AIDR, you must have one of the following user roles: Instance Admin or Account Admin.

####### Navigation

  Settings → Configurations → Cortex - Analytics

####### 5.5.2.1.10.1. Data sources and supported services

####### 5.5.2.1.10.2. AI Detection & Response Dashboard

####### 5.5.2.1.10.3. Collect prompt logs

#### 5.5.3. Threat Intel Management

##### 5.5.3.1. Get started with Threat Intel Management

###### Note

* You must have the Cortex XSIAM Premium license or any other XSIAM license with the Threat Intel Management (TIM) add-on to use this feature.

###### 5.5.3.1.1. What is Threat Intel Management?

####### Note

* You must have the Cortex XSIAM Premium license or any other XSIAM license with the Threat Intel Management (TIM) add-on to use this feature.

###### 5.5.3.1.2. Threat Intel Management use cases

###### 5.5.3.1.3. Roles and responsibilities in Threat Intel Management

###### 5.5.3.1.4. Indicator concepts

####### Note

* You can store up to 100,000,000 indicators.

###### 5.5.3.1.5. Indicator lifecycle

####### Note

* To run enhancement scripts and reputation commands, you must configure a relevant enrichment integration, such as VirusTotal, IPinfo v2, etc.

####### Tip

* We recommend defining your policy for handling expired indicators.

##### 5.5.3.2. Indicator configuration

###### 5.5.3.2.1. Configure Threat Intelligence feed integrations

####### Note

* Some third-party services (such as Whois and VirusTotal) enforce strict rate limits based on the source IP address. If you encounter quota management issues, we recommend running them on an engine. This routes the traffic through your own private network, ensuring the external service sees a unique, dedicated IP address exclusive to your organization.

* Some feeds only provide information about new indicators and do not specify when indicators are removed. Indicators from these feeds cannot be automatically expired on removal. If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its...

###### 5.5.3.2.2. Customize indicator fields and types

####### 5.5.3.2.2.1. Create an indicator type

######## Note

* If you miss mapping any field, you can create additional new indicator fields and either relate them to all indicator types, or relate them only to the new indicator type (recommended).

######## Navigation

  Settings → Configurations → Object Setup → Indicators → Types

######## 5.5.3.2.2.1.1. Indicator type profile

######## 5.5.3.2.2.1.2. File indicators

######## 5.5.3.2.2.1.3. Formatting scripts

######## 5.5.3.2.2.1.4. Enhancement scripts

######## 5.5.3.2.2.1.5. Reputation scripts

######## 5.5.3.2.2.1.6. Reputation commands

######## 5.5.3.2.2.1.7. Map custom indicator fields

####### 5.5.3.2.2.2. Create an indicator field

######## Note

* Cortex XSIAM IOC fields are based on the STIX 2.1 specifications. For more information, see Indicator field structure.

* The following HTML tags are not permitted: blockquote, del, dd, div, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, iframe, ins, li, math, noscript, ol, pre, p, script, style, table, ul, address, article, aside, canvas, details, dialog, figcaption, figure, footer, header, hgroup, main, nav, output, progress, section, video. The following CSS tags...

######## Navigation

  Settings → Configurations → Object Setup → Indicators → Fields → New Field

######## 5.5.3.2.2.2.1. Indicator field structure

######## 5.5.3.2.2.2.2. Indicator field trigger scripts

###### 5.5.3.2.3. Indicator classification and mapping

####### Note

* When creating a new indicator type, you classify and map the indicator fields in the indicator type settings. For more details, see Map custom indicator fields.

* You can optionally skip importing data. Click the pencil on the right of each indicator type on the right pane to enter the value manually.

* In the Classification & Mapping page, the mapping does not indicate for which indicator types they are configured. When creating a mapper, it is best practice to add to the mapper name and the indicator type the mapper is for. For example, Mail Listener - Phishing. When mapping a list, we recommend you map to a multi-select field. Short text fields do...

###### 5.5.3.2.4. Indicator extraction

####### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Reputation commands, such as !ip and !domain, can only be used after you configure and enable a reputation integration instance, such as VirusTotal and Whois.

* The inline configuration may delay playbook execution.

* While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks. All indicators are automatically extracted and enriched before a playbook is run. For an on-field change, extraction occurs before the next playbook tasks run.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

####### 5.5.3.2.4.1. Set the indicator extraction mode for a playbook task

####### 5.5.3.2.4.2. Disable indicator extraction for scripts or integrations

######## Note

* The TIM add-on is included in the Cortex XSIAM Premium license.

###### 5.5.3.2.5. Configure Threat Intelligence feed integrations

####### Note

* Some third-party services (such as Whois and VirusTotal) enforce strict rate limits based on the source IP address. If you encounter quota management issues, we recommend running them on an engine. This routes the traffic through your own private network, ensuring the external service sees a unique, dedicated IP address exclusive to your organization.

* Some feeds only provide information about new indicators and do not specify when indicators are removed. Indicators from these feeds cannot be automatically expired on removal. If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its...

###### 5.5.3.2.6. Exclude indicators from enrichment

###### 5.5.3.2.7. Generate issues from indicators using indicator rules for prevention and detection

####### Note

* Indicators should be present in the Threat Intelligence database (Threat Management → Threat Intelligence → Indicators) before creating detection and prevention rules.

* Although you can create IOC rules for detection, indicator rules are designed to leverage threat intelligence indicators like MD5 and SHA256 hashes that are present in your TIM library. These rules directly integrate with and rely on the indicators ingested and managed by TIM. Indicators must be in the TIM database before creating these rules. For more...

* You can't change the Preventable = True, Status = Active and Type = File filters, which comply with the requirements of the supported indicator type for Prevention on the Agent.

* The Indicator Rule shows the number of issues generated by the rule, You can view the issues that were generated using the Indicator rule, by right-clicking the rule and select View related issues.

* You can't change the Detectable = True and Status = Active filters, which comply with the requirements of the supported indicator type for detection.

* The Issue source is Threat Intelligence.

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

###### 5.5.3.2.8. Export indicators

####### Caution

* You should not run a query on a field that you might change in the playbook flow. For example, you shouldn't have a playbook with query Verdict:Malicious and then change the indicator verdict as a part of the playbook.

##### 5.5.3.3. Indicator management

###### Note

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

##### 5.5.3.4. Indicator investigation

###### 5.5.3.4.1. Indicator verdict

###### 5.5.3.4.2. Extract and enrich an indicator

####### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Triggering enrichment on a substantial number of indicators can take time (because it's activating all enrichment integrations per indicator) and can result in performance degradation.

* Reputation commands, such as !ip, !domain can only be used when you configure and enable a reputation integration instance, such as VirusTotal and WHOIS.

###### 5.5.3.4.3. Expire an indicator

####### Note

* You need to run these commands in the Case or Issue War Room.

###### 5.5.3.4.4. Manage indicator relationships

####### Note

* You can also add an indicator relationship from the Quick View when selecting an indicator from an issue.

###### 5.5.3.4.5. Delete and exclude indicators

####### Caution

* Ensure you are using the correct syntax when defining the values for your exclusion lists.

### 5.6. Attack Surface Management

#### License Type

  Included in Cortex XSIAM Premium. For Cortex XDR 4.x or any other XSIAM license, the ASM add-on is required.

#### 5.6.1. Get started with Attack Surface Management

##### 5.6.1.1. What is Attack Surface Management?

###### 5.6.1.1.1. Attack Surface Management use cases

##### 5.6.1.2. Network mapping

##### 5.6.1.3. Scanning

###### 5.6.1.3.1. Scanning cadences

###### 5.6.1.3.2. Known Assets Monitoring

###### 5.6.1.3.3. Scanning ports and protocols

####### Note

* The following lists are not exhaustive. For current and complete lists, contact your customer success team.

###### 5.6.1.3.4. Scanning activity

##### 5.6.1.4. GeoIP data collection

##### 5.6.1.5. Attack Surface Management FedRAMP support

#### 5.6.2. Attack Surface Management detections

##### 5.6.2.1. Attack surface rules

###### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

##### 5.6.2.2. Attack Surface Testing

###### Note

* Requires the ASM add-on.

###### 5.6.2.2.1. Attack surface tests

####### Note

* Attack surface testing scans are typically not CFAA compliant, meaning that they may attempt more extensive fuzzing to confirm or deny the presence of a CVE. Additionally, some attack surface tests are more intrusive than others. Tests are labeled with the level of intrusiveness, so you can decide whether to run more intrusive tests.

####### 5.6.2.2.1.1. Attack Surface Testing intrusivity

###### 5.6.2.2.2. Set up Attack Surface Testing

####### Navigation

  Settings → Configurations → Access Management → Roles, and select the role

  Modules → Attack Surface → Policies → Attack Surface Tests

  Settings → Configurations → Attack Surface → Attack Surface Testing

###### 5.6.2.2.3. Manage attack surface tests

####### Navigation

  Modules → Attack Surface → Policies → Attack Surface Tests

###### 5.6.2.2.4. View issues created from Attack Surface Testing results

####### Navigation

  Modules → Attack Surface → Attack Surface Issues

###### 5.6.2.2.5. Source IP addresses for Attack Surface Testing scans

####### Navigation

  Settings → Configurations → Attack Surface → Attack Surface Testing and refer to the Source IP Addresses section

##### 5.6.2.3. Externally inferred CVEs

###### Note

* An externally inferred CVE might impact your service or asset, but additional investigation is required to confirm that the CVE is actually present.

##### 5.6.2.4. Digital Risk Protection

###### Note

* Both of these attack surface rules are based on the attributed domain assets that appear in the asset inventory. If there are no attributed domains in your inventory, Cortex XSIAM will not generate Digital Risk Protection findings and issues.

###### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

#### 5.6.3. Attack surface assets

##### Navigation

  The internet-facing assets that were discovered in an attack surface management (ASM) scan and attributed to your organization are available in the inventory on the Inventory → Assets → All Assets → External Surface pages

  Inventory → Assets → Network Configuration → IP Address Ranges → External IP Address Ranges

##### 5.6.3.1. Upload or remove ASM assets

###### Note

* You must have the Instance Administrator role to upload or remove assets.

###### 5.6.3.1.1. Upload assets

####### Note

* If an asset upload request has an invalid CSV or includes one or more invalid assets, the entire request will fail, and none of the assets will be uploaded. If this happens, Cortex XSIAM will display an error message indicating what caused the error, so you can fix the problem and resubmit if you choose.

####### Navigation

  Settings → Configurations → Asset Management → Asset Uploads/Removals

###### 5.6.3.1.2. Remove assets

####### Note

* If an asset removal request has an incorrectly formatted CSV or includes one or more invalid assets, the entire request will fail, and none of the assets will be removed. If this happens, Cortex XSIAM will display an error message indicating what caused the error, so you can fix the problem and resubmit if you choose.

####### Navigation

  Settings → Configurations → Asset Management → Asset Uploads/Removals

#### 5.6.4. Deploy ASM and Exposure Management enrichment and remediation automation

##### Note

* For details and requirements regarding the enrichment information that can be collected and the specific issues that can be remediated automatically, review the Exposure Management Content Pack information in Marketplace.

* Cortex Exposure Management playbooks only run on issues that were created after the automation rules have been configured.

##### Navigation

  Settings → Configurations → Marketplace → Browse and locate the Cortex Exposure Management content pack

  Investigation & Response → Automation → Automation Rules

#### 5.6.5. ASM enrichment of cloud assets

##### Navigation

  Inventory → Assets → All Assets → External Surface → Services

#### 5.6.6. Emerging Vulnerabilities

##### License Type

  Requires the ASM add-on

##### Note

* You must have a role with Attack Surface Rules permission to access the Emerging Vulnerabilities page. When setting up Roles Based Access Control (RBAC), you can find Attack Surface Rules in the Detection & Threat Intel component.

##### Navigation

  Posture Management → Vulnerability Management → Emerging Vulnerabilities

#### 5.6.7. Global Lookup

##### Navigation

  Modules → Attack Surface → Global Lookup

### 5.7. Vulnerability management

#### 5.7.1. Vulnerability management in Cortex XSIAM

##### License Type

  Requires the Cortex Cloud Posture Security, Cortex Cloud Runtime Security, Exposure Management, or ASM add-on.

##### Note

* Cortex XSIAM vulnerability management provides the ability to identify and assess runtime vulnerabilities in every asset across traditional IT and cloud environments. For vulnerabilities detected in your software development lifecycle through application security scans, refer to the Cortex Cloud Application Security documentation.

##### 5.7.1.1. Cortex XSIAM vulnerability concepts

###### Note

* CVE is an acronym for Common Vulnerabilities and Exposures, which is a list of publicly disclosed security threats. We often use the term "CVE" to refer to a vulnerability that has been a assigned a CVE ID. Cortex XSIAM identifies CVEs and non-CVE vulnerabilities.

##### 5.7.1.2. Vulnerability Management dashboard

#### 5.7.2. Cortex Vulnerability Risk Score

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

#### 5.7.3. Vulnerability policies

##### 5.7.3.1. Create a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

##### 5.7.3.2. Update the Ignored CVEs, Asset Groups, and Assets policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

##### 5.7.3.3. Modify a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

##### 5.7.3.4. Configure a block grace period

###### Navigation

  Posture Management → Rules & Policies → Vulnerability Management → Vulnerability Policies - Prevention

##### 5.7.3.5. Enable or disable a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

#### 5.7.4. Investigate and remediate vulnerabilities

##### 5.7.4.1. View all Vulnerabilities

###### Navigation

  Posture Management → Vulnerability Management → Vulnerabilities

##### 5.7.4.2. View vulnerability issues

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

##### 5.7.4.3. View All Vulnerability Findings

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues and click the All Vulnerability Findings button

##### 5.7.4.4. View vulnerable assets

###### Navigation

  Posture Management → Vulnerability Management → Vulnerable Assets

#### 5.7.5. Vulnerability Intelligence

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

#### 5.7.6. Recast CVSS scores and CVSS severities

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

### 5.8. Cloud Security

#### 5.8.1. Discovery Engine

##### 5.8.1.1. What is the Discovery Engine?

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM product that has the Cloud Runtime Security or Cloud Posture Security add-ons.

#### 5.8.2. Monitor and track compliance adherence

##### Note

* Requires Cortex XSIAM Premium or any other XSIAM license with the Cloud Runtime Security or Cloud Posture Security add-on.

##### 5.8.2.1. Cortex compliance flow

##### 5.8.2.2. Choose compliance standards from the compliance catalog

###### Navigation

  Cortex provides lists of available standards and controls in the Standards and Controls catalogs under Posture Management → Compliance → Catalogs

###### 5.8.2.2.1. Standards Catalog

####### 5.8.2.2.1.1. Use a built-in or custom standard

###### 5.8.2.2.2. Controls catalog

####### 5.8.2.2.2.1. Use a built-in or custom control

######## 5.8.2.2.2.1.1. Add a custom detection rule to a custom control

######## 5.8.2.2.2.1.2. Create a new Custom Detection Rule

##### 5.8.2.3. Use an assessment profile to run compliance checks on your assets

###### Navigation

  Under Posture Management → Compliance → Assessment Profiles, click Create New Assessment

##### 5.8.2.4. View and manage compliance assessments and reports

###### Note

* Compliance assessment results may take up to six hours to be generated.

###### 5.8.2.4.1. Assessments

####### Note

* If there are no rules associated with the control, the control will be assigned a severity of low.

###### 5.8.2.4.2. Reports

####### Navigation

  The Posture Management → Compliance → Results → Reports page shows a table listing compliance assessment report files

##### 5.8.2.5. View the compliance assessment of an individual asset

#### 5.8.3. Cloud Security Rules and Policies

##### 5.8.3.1. Overview

##### 5.8.3.2. Cloud Security Rules

##### 5.8.3.3. Cloud Security Policies

###### Note

* If you have the following Scope Based Access Control (SBAC) settings in place, User Settings > Cases and Issues Scope > Select domains > Posture, you may encounter a Case mismatch in Issues/Cases/Findings counts. This is because the Case count on the Rules page captures Cases belonging to the Posture domain. Whereas Platform pages, capture Issues...

* 5.8.3.3.1 |Issues Issues are artifacts of the policy and represent actionable items that you need to address. They have several characteristics, such as: Lifecycle '–' Open, Dismiss, In-progress, Close Workflows '–' Assigned to different user personas for remediation Severity '–' Critical, High, Medium, Low, Info NOTE: A key distinction between Findings and Issues is that Findings are not actionable, while you can take an action on Issues. The Cloud Security Policies page allows you to manage policies that define security and compliance actions for cloud posture. You can create, edit, filter, and manage policies through a structured table and widget panel. The Policies page displays all the configured policies with the following fields. 5.8.3.4 |Create Rules You can create your own custom rules for Configuration (Config), Data, and Network Exposure. View all the Cloud Posture Security Rules on the Posture Management > Rules & Policies > Rules > Cloud Security page. 5.8.3.4.1 |Create a configuration rule Configuration (config) rules monitor your resource configurations for potential policy violations or misconfigurations. Perform this task to create a custom configuration rule that you can use in a cloud security policy. Navigate to Posture Management → Rules & Policies → Rules → Cloud Security. Select Create Rule > Config. Complete the Overview step: Enter a Rule Name and Description. Select a Severity. This will be the severity of any issues created with this rule. Add Labels (optional). These rules can be used find rules when creating custom policies. Enable Remediation using the toggle (optional). In a later step, you'll enter the remediation instructions. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. Click Next. Complete the Overview step: Enter a Rule Name and Description. Select a Severity. This will be the severity of any issues created with this rule. Add Labels (optional). These rules can be used find rules when creating custom policies. Enable Remediation using the toggle (optional). In a later step, you'll enter the remediation instructions. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. Complete the Rule Logic step to define what the rule is looking for. Select one of the following modes: Simple Mode: Presents a guided interface in which you can define basic conditions and address most common rule use cases. Advanced Mode: Presents a free-form XQL editor that allows you to build complex and flexible queries across unrestricted datasets. Supports advanced and custom use cases. Complete the Rule Logic step to define what the rule is looking for. Select one of the following modes: Simple Mode: Presents a guided interface in which you can define basic conditions and address most common rule use cases. Advanced Mode: Presents a free-form XQL editor that allows you to build complex and flexible queries across unrestricted datasets. Supports advanced and custom use cases. If you selected Simple Mode, complete the following steps: Select options from the dropdown menus to define the logic for your config rule, such as '''Find EC2 instances where accessKeys are allowed'', and then click Search to view all matching results. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Simple Mode, complete the following steps: Select options from the dropdown menus to define the logic for your config rule, such as '''Find EC2 instances where accessKeys are allowed'', and then click Search to view all matching results. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Advanced Mode, complete the following steps: Define an XQL query for the rule, following the guidelines in Guidelines for creating cloud security rules. For detailed information about how use XQL, see Get started with XQL. Click Test to determine if the query is valid. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Check the list of query results to verify that the query is working as intended. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Advanced Mode, complete the following steps: Define an XQL query for the rule, following the guidelines in Guidelines for creating cloud security rules. For detailed information about how use XQL, see Get started with XQL. Click Test to determine if the query is valid. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Check the list of query results to verify that the query is working as intended. (Optional) In the text field, define remediation actions or provide other information that will be included on issues created by this rule. Click Done to save your config rule. 5.8.3.4.1.1 |Guidelines for creating cloud security rules NOTE: XQL queries are supported for cloud security configuration rules only. XQL queries are not yet supported for other types of cloud security rules.

####### 5.8.3.4.1.2. Cloud security rule status for custom configuration rules

######## Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

###### 5.8.3.4.2. Create a Data Rule

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

###### 5.8.3.4.3. Create a Network Exposure Rule

###### 5.8.3.4.4. Edit a Rule

##### 5.8.3.5. Create Policies

###### Note

* When creating Policies, note that Rules with the Informational severity level are excluded.

###### 5.8.3.5.1. Edit a Policy

###### 5.8.3.5.2. Use an Existing Policy to Create a New One

#### 5.8.4. Cortex Cloud Data Classification

##### 5.8.4.1. What is Cortex Cloud Data Classification?

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Navigation

  To access Data Classification management, click Settings → Configurations → Data Classification

##### 5.8.4.2. How to create and validate a custom data pattern

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* Once a custom data pattern is saved, it runs on all data in the same way as any out-of-the-box (OOTB) pattern, becoming globally applicable for all modules using Cortex Cloud Data Classification.

* For more information, see How to disable and enable data patterns in Data Classification.How to disable and enable data patterns in Data Classification

##### 5.8.4.3. How to disable and enable data patterns in Data Classification

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* Disabling data patterns can cause changes in your data profile results and stop detection of these data patterns.

* For more information about data patterns in data classification, see What is Cortex Cloud Data Classification?.

###### Navigation

  In the lower left part of the screen, click Settings → Configurations → Data Classification → Data Patterns

##### 5.8.4.4. How to create and validate a custom data profile

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* If you choose two data locations, only the filters they have in common will be included in the possible filter options.

* For more information, see How to disable and enable data profiles in Cortex Cloud Data Classification.

###### Important

* Deleting a data profile deletes all past data associated with it in all modules using Cortex Cloud Data Classification after a warning notification is displayed.

* Enabling and disabling a data profile removes or re-adds the data profile results to the data objects; that is, files and tables.

##### 5.8.4.5. How to disable and enable data profiles in Cortex Cloud Data Classification

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* Existing results on past scans are updated in the Asset and Object inventories within two hours after being disabled or enabled.

* For more information about data profiles in Cortex Cloud Data Classification, see What is Cortex Cloud Data Classification?.What is Cortex Cloud Data Classification?

###### Navigation

  In the lower left part of the screen, click Settings → Configurations → Data Classification → Data Profiles

##### 5.8.4.6. How to report a false positive in Cortex Cloud Data Classification

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* Alternatively, in Cortex Command Center, click Help → Submit a Support Case.

#### 5.8.5. Cortex Cloud Data Security

##### 5.8.5.1. What is Cortex Cloud Data Security?

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### 5.8.5.2. Supported assets in Cortex Cloud Data Security

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* CMK (customer-managed key) in SQL Server is only supported in outpost mode.

* The list above refers to only data classification; however, Cortex Cloud Data Security discovers and monitors all cloud assets and services for usage and misconfigurations.

* For information about configuring data classification asset types, see How to configure the scanning settings for supported services.

##### 5.8.5.3. Cortex Cloud Data Security concepts

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### 5.8.5.4. Cortex Cloud Data Security use cases

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### 5.8.5.5. Data Inventory

###### Note

* To clear the filter in the filter panel, click Delete.

###### Navigation

  When you select Inventory → All Assets → Data → All Data Assets, a list of all data assets appears

##### 5.8.5.6. How to review errors in Cortex Cloud Data Security

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### 5.8.5.7. How to configure the scanning settings for supported services

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* If you do not select a scanning cadence, the default setting is applied. For more information, contact your Customer Support team.

##### 5.8.5.8. How to perform advanced Data Security investigations using XQL

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* For more information, see Build XQL queries.Build XQL queries

##### 5.8.5.9. How to onboard Databricks

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* If you turn on this feature, both the cloud and region will be used for scanning, possibly incurring cost and requiring adherence to certain compliance policies.

##### 5.8.5.10. How to onboard Microsoft 365

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Prerequisite

* You have generated a Globally Unique Identifier (GUID), also known as a Universally Unique Identifier (UUID). You will need this ID for the tenant you want to use for the Microsoft 365 instance. In order to use Microsoft 365, you must be registered with Microsoft Azure.

##### 5.8.5.11. How to onboard on-premise file shares to Cortex Cloud Data Security

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* Your data is scanned on the Broker VM itself, and only the metadata and classification results are transmitted from the on-premise environment to Cortex XSIAM.

* For information about activating the DSPM Fileshare applet, see Activate DSPM Fileshare.

##### 5.8.5.12. How to onboard Snowflake

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Prerequisite

* In order to use Snowflake, you must be registered with one of these cloud providers: Amazon AWS, Microsoft Azure, or Google Cloud Platform (GCP). Ensure you have the necessary account permissions to onboard. It is recommended to use Account Admin as the role for the onboarding.

###### Note

* The account identifier can be found using the user information at the bottom left. Hover over the account you wish to onboard and select the copy option at the top right. The account identifier is usually of the format: (organization).[account]

##### 5.8.5.13. How to use information protection labels in Cortex Cloud Data Security

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* Only If you have connected a Microsoft 365 instance to Cortex Cloud, the information protection labels appear. See How to onboard Microsoft 365.

#### 5.8.6. Cortex Cloud Identity Security

##### 5.8.6.1. What is Cortex Cloud Identity Security?

##### 5.8.6.2. Review and improve your Identity Security posture

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Management or Cloud Runtime Security add-on.

###### Tip

* Reducing the number of nonhuman entities that are either dormant or have administrative privileges is the most effective way to improve your security score.

##### 5.8.6.3. How does Effective Permission Calculation work?

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### 5.8.6.4. Cortex Cloud Identity Security functionality

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* Access to the Weak/Compromised Password widget and column requires the ITDR add-on.

* For more information about Effective Permission Calculation, see How does Effective Permission Calculation work?.

* When a policy is analyzed and categorized as excessive, a relevant finding and highlight is attached to that policy and the various identities being granted excessive permissions.

* Each action must be defined as either being administrative or not. The administrative tag is an additional tag for administrative actions, along with one of the other access level types. For example, the AWS action iam:CreateGroup is categorized as config and has the administrative tag as well.

###### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

##### 5.8.6.5. Achieve the principle of least privilege access

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* In the case of Amazon AWS, Cortex Cloud Identity Security also uses AWS Identity and Access Management (IAM) Access Advisor insights to expand the coverage of supported actions.

###### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

##### 5.8.6.6. Explore permissions using the simple and advanced access tables

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### 5.8.6.7. Create a custom detection rule in Cortex Cloud Identity Security

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

##### 5.8.6.8. Perform advanced Identity Security investigations using XQL

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* For more information, see Build XQL queries.Build XQL queries

##### 5.8.6.9. Enable inactive human identity logs on Azure in Cortex Cloud Identity Security

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* For more information, see Ingest logs from Microsoft Azure Event Hub.

##### 5.8.6.10. Manage RBAC and SBAC in Cortex Cloud Identity Security

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Important

* You can use the Cortex Cloud Identity Security RBAC roles to define access to the various sections and functionalities of Cortex Cloud Identity Security, but these roles do not directly control the specific data a user sees within those sections. Data visibility is further refined and limited by scope-based access control (SBAC) capabilities.

#### 5.8.7. Network exposure detection

##### 5.8.7.1. What is Cloud Network Analyzer?

##### 5.8.7.2. Internet exposure detection

###### Note

* Currently, CNA supports only an isolated architecture with an AWS Gateway Load Balancer (GWLB) within a single VPC. Other more centralized topologies including one security VPC that forwards traffic to other workload VPCs are currently not supported.

##### 5.8.7.3. Outbound exposure detection

##### 5.8.7.4. East-west exposure detection

##### 5.8.7.5. Investigate an internet exposure

###### Note

* The Network tab is currently only available for virtual machines.

* The Network tab is only displayed when you have access to the main asset and associated ones, such as security groups, VPCs and subnets. For more information on Scope-Based Access Control (SBAC) for configuring granular scoping, see Manage user scope.Manage user scope

#### 5.8.8. Cortex Cloud AI Security

##### 5.8.8.1. What is Cortex Cloud AI Security?

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### 5.8.8.2. Supported services in Cortex Cloud AI Security

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### 5.8.8.3. Cortex Cloud AI Security concepts

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### 5.8.8.4. Cortex Cloud AI Security use cases

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### 5.8.8.5. How to perform advanced AI Security investigations using XQL

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

###### Note

* For more information, see Build XQL queries.Build XQL queries

#### 5.8.9. Serverless function posture security

##### 5.8.9.1. Onboard cloud providers for serverless functions

###### Note

* When scanning serverless functions with layers, those layers need to be from the same cloud account.

* Only functions containing zip files are supported.

###### Important

* Cortex supports Google Cloud Functions: 1st gen and 2nd gen Cloud Functions API.

##### 5.8.9.2. Serverless function posture policies

###### 5.8.9.2.1. Manage serverless function policies

####### Note

* You can select multiple types to view all your serverless function rules across your cloud providers.

* Refer to Create serverless function policies for more information on how to define the steps of a policy in the wizard.

###### 5.8.9.2.2. Create serverless function policies

####### Note

* You can select multiple options.

* For more information about rules, refer to Manage serverless function rules.

##### 5.8.9.3. Serverless function posture rules

###### 5.8.9.3.1. Manage serverless function rules

####### Note

* You can select multiple types to view all your serverless function policies across your cloud providers.

* Refer to Create serverless function rules for more information on how to define the steps of a rule in the wizard.

###### 5.8.9.3.2. Create serverless function rules

###### 5.8.9.3.3. Create an attack path rule for serverless functions

####### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  in as the operator → enter the CVE ID → Search

  > or >= as the operator → Severity level (such as High, Low) → Search

  > or >= as the operator → enter a score → Search

###### 5.8.9.3.4. Create a configuration rule for serverless functions

####### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

###### 5.8.9.3.5. Create a network exposure rule for serverless functions

####### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

##### 5.8.9.4. Serverless function usage

###### Navigation

  To access serverless function assets, under Inventory, select All Assets → Compute → Serverless Functions

  Posture Management → Vulnerability Management) → Vulnerability Issues

  Add Filters → Asset Category → Serverless Function

  Posture Management → Vulnerability Management) → Vulnerable Assets

  Add Filters → Asset Category → Serverless Functions

#### 5.8.10. Cortex Cloud Application Security

##### 5.8.10.1. Onboard Data Sources

###### 5.8.10.1.1. Onboard version control systems

####### Note

* Application Security (which includes IaC and Secrets scanning), is an add-on to a license (such as Posture Security) that must be purchased separately.

* Disclaimer: When onboarding with third-party data sources, we outline the required steps for setup, but we do not monitor these external resources, and they may change over time. Always refer to the relevant third-party documentation for the most current integration steps.

####### Tip

* Navigate to Settings → Data Sources & Integrations → + Add New →  and enter your VCS data source in the search bar.

####### 5.8.10.1.1.1. AWS CodeCommit

######## Prerequisite

* Before you begin, ensure the following: Cortex XSIAM user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) AWS user permissions: To onboard CodeCommit, the user logged into the AWS Console must have permissions to deploy the CloudFormation stack and authorize the...

######## Tip

* The instance ID is identical to the stack ID on the AWS platform.

######## Navigation

  Modules → Application Security → Periodic scans

####### 5.8.10.1.1.2. Azure DevOps

######## Prerequisite

* Before you begin: Cortex XSIAM user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) Azure DevOps permissions: Ensure the user performing the integration holds one of the following roles in Azure DevOps:    Project Administrator: This permission is required to subscribe...

######## Note

* This forces Azure to bypass browser cookies and issue a token for the correct directory.

* PATs are static. To onboard a different tenant, you must log in to that specific environment to generate a new token.

######## Important

* When redirected to the Microsoft login screen, do not immediately enter your email.

######## Navigation

  Settings → Data Sources & Integrations → + Add New

  User Settings → Personal access tokens → + New Token

######## 5.8.10.1.1.2.1. Azure DevOps onboarding system architecture

####### 5.8.10.1.1.3. Bitbucket Cloud

######## Prerequisite

* Before you begin: Cortex XSIAM user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Bitbucket, grant the user performing the Cortex application authorization the following permissions. The level of access required depends on the modules you intend to use:    For code...

######## Note

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Cloud instance: Hover over the Bitbucket Cloud card in the catalog and click Connect Another.

####### 5.8.10.1.1.4. Bitbucket Data Center

######## Prerequisite

* Before you begin: Cortex XSIAM user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Bitbucket, grant the user performing the Cortex application authorization the following permissions:    Administrator permissions for projects   Administrator permissions for...

######## Note

* By default, the permissions of the access token are set according to your current access level. It is essential to define two levels of permissions, Project and Repository permissions. The Repository permissions inherit from Project permissions, requiring Repository permissions to match or exceed Project permissions Providing read and write permissions...

* For additional security, it is recommended to set an expiry automatically. The expiry date of a token cannot be changed after it is created. You can see the expiry dates for all your tokens on Profile picture → Manage account → Personal access tokens.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Data Center instance: Hover over the Bitbucket Data Center card in the catalog and click Connect Another.

######## Important

* Always refer to the Bitbucket documentation for information relating to creating a PAT.

####### 5.8.10.1.1.5. GitHub Cloud

######## Prerequisite

* Before you begin: Cortex XSIAM user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In GitHub, grant the user performing the Cortex application authorization the following permissions:    Organization Owner: Only an Organization Owner can directly authorize and install...

######## Note

* To create an additional GitHub SaaS instance: Hover over the GitHub SaaS card in the catalog and click Connect Another.

######## Navigation

  Settings → Data Sources & Integrations → + Add New

  Verify integration: On Data Sources, select Code Providers → GitHub SaaS → View more and confirm that the status of your integrated GitHub instance is 'Connected

####### 5.8.10.1.1.6. GitHub Enterprise (On-Prem)

######## Prerequisite

* Before you begin: Cortex XSIAM user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In GitHub, you must have Organization Owner permissions to install the Cortex application. Users with only repository-level admin permissions cannot complete the installation unless the...

######## Note

* The domain is the hostname associated with your GitHub Enterprise (On-Prem) instance.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitHub Enterprise (On-Prem) instance: Hover over the GitHub Enterprise (On-Prem) card in the catalog and click Connect Another.

####### 5.8.10.1.1.7. GitLab SaaS

######## Prerequisite

* Before you begin: Cortex XSIAM user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Gitlab, the following permissions are required to integrate the application:    Maintainer (Project-level). Grants sufficient permissions to configure external integrations, manage...

######## Note

* A repository can only be integrated with a single instance. The first instance that connects with the repository will be the one that the repository is assigned to. This means that if multiple integrations attempt to connect to the same repository, only the first integration to establish the connection will be associated with that repository.

* To create an additional GitLab SaaS instance: Hover over the GitLab SaaS card and click in the catalog and Connect Another.

####### 5.8.10.1.1.8. GitLab Self Managed (On-Prem)

######## Prerequisite

* Authorize the user integrating Application Security with your GitLab Self Managed (On-Prem) instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including all groups...

######## Note

* The domain is the hostname associated with your GitLab Self Managed (On-Prem) instance.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitLab Self Managed (On-Prem) instance: Hover over the GitLab Self Managed (On-Prem) card in the catalog and click Connect Another.

###### 5.8.10.1.2. Onboard CI/CD systems

####### 5.8.10.1.2.1. Onboard CircleCI for CI/CD pipeline scans

######## Prerequisite

* Before you begin: Cortex XSIAM user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) CircleCI user requirements:    Permissions: To enable Cortex XSIAM visibility for all CircleCI projects, a version control system (VCS) user with integration permissions must be...

######## Note

* This integration utilizes a Personal Access Token (PAT) for authentication CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate...

* Select Add Another Instance if the data source instance has already been configured.

* To add an additional CircleCI instance, navigate to Settings → Data Sources & Integrations → , select the connected CircleCI integration, click  → Add Instance, and repeat the onboarding steps above.

####### 5.8.10.1.2.2. Onboard Jenkins for CI/CD pipeline scans

######## Prerequisite

* Cortex XSIAM user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Jenkins:    To install and configure the Cortex plugin in Jenkins, you must be a Jenkins Administrator with Overall/Administer permissions   Ensure the build server allows outbound HTTPS (Port 443...

######## Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for code scans, refer to Onboard...

* Select Add Another Instance if the data source instance has already been configured.

* The integration is added on the console but integration is pending, and will only be completed after completing step 5 below. You can view the pending integration on the Jenkins Instances page: Select Data Sources →  Jenkins → View Details. The type of integration is Pipeline Risks

* Always refer to the official Jenkins documentation when installing plugins on Jenkins servers.

* To add an additional Jenkins instance, navigate to Settings → Data Sources → select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps above.

###### 5.8.10.1.3. Integrate CI tools

####### Navigation

  Settings → Data Sources & Integrations → hover over a CI tool → View Details

  Delete an instance: Right-click on an instance of the CI tool → Delete instance → Delete

####### 5.8.10.1.3.1. AWS CodeBuild

######## Prerequisite

* Before you begin:

######## Note

* Select Add Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional AWS CodeBuild instance, navigate to the Settings → Data Sources & Integrations →  page, select the connected AWS CodeBuild integration, click → Add Instance, and repeat the onboarding steps above.

####### 5.8.10.1.3.2. Onboard CircleCI for code scans

######## Prerequisite

* Before you begin:

######## Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for CI/CD scans, refer to...

* Select Add Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* To add an additional CircleCI instance, navigate to Settings → Data Sources & Integrations → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

######## Important

* The cortex-secrets naming convention for the context is mandatory to ensure functionality and must not be changed.

####### 5.8.10.1.3.3. Connect Cortex CLI

######## Prerequisite

* System requirements (OS-specific): The following operating system dependencies are required to run the Cortex XSIAM CLI binary on specific architectures.    macOS (Intel Core i7, such as Sequoia):    To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew. Use this command: brew install vectorscan      RHEL...

######## Note

* Select Add Another Instance if a CLI instance is already onboarded.

* In the command above, {version} refers to the CLI version you wish to install (such as latest or a specific number), and {platform} refers to your operating system (such as, linux, darwin, windows).

######## Warning

* Using With upload results permissions may incur additional costs as per your license agreement.

####### 5.8.10.1.3.4. GitHub Actions

######## Prerequisite

* Before you begin:

######## Note

* Select Add Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional GitHub Actions instance, navigate to Settings → Data Sources & Integrations → select the menu for your connected GitHub Actions instance → + New Instance, and repeat the onboarding steps above.

####### 5.8.10.1.3.5. Onboard Jenkins for code scans

######## Prerequisite

* Grant Administrator permissions to the user integrating Application Security with Jenkins Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

* For Application Security CI tools, you must store secrets in Jenkins Credentials for use in your Jenkins pipelines using either of these methods:    Plain text storage: Store secrets directly as plain text in Jenkins Credentials. Access them in your pipeline using the credentials function, which retrieves the secret directly as plain text   Credentials...

######## Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for CI/CD scans, refer to Onboard...

* Select Add Another Instance if the data source instance has already been configured.

* This step is only required for new pipelines For private repositories, ensure the necessary credentials are configured in Jenkins Credentials

* This ensures your build runs within a Docker environment. If a node without Docker is used, the build will fail.

* To add an additional Jenkins instance, navigate to Settings → Data Sources & Integrations →  select the Jenkins integration, click  → Add Instance, and repeat the onboarding steps.

####### 5.8.10.1.3.6. Onboard Terraform Cloud (Run Tasks)

######## Prerequisite

* Before you begin: Procure a Terraform cloud license that is either a trial license or a TF Cloud license at the TEAM & GOVERNANCE level Terraform permissions: Grant the user or team the following permissions, depending on integration:    Manage Workspaces permissions at the organization level. These permissions are required to attach and manage the run...

######## Note

* Skip this step if you plan on using an existing token.

* Select Add Another Instance if the data source instance has already been configured.

* Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Cloud (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected your Terraform Cloud (Run Tasks) instance → + New Instance, and repeat the onboarding steps.

####### 5.8.10.1.3.7. Onboard Terraform Enterprise (Run Tasks)

######## Prerequisite

* Before you begin: Ensure access to a Terraform Enterprise console to enable you to provide a user or team token that authorizes Application Security to access workspaces and helps regulate run configurations Terraform Enterprise version compatibility: Ensure Run Tasks for workspaces on is compatible with version 1.1.9 and above Terraform Enterprise...

######## Note

* For container image vulnerabilities, Application Security performs 'Image Referencer' scans within Terraform Enterprise (Run Tasks), as full SCA scans are not currently supported.

* Skip this step if you plan on using an existing token.

* Select Add Another Instance if the data source instance has already been configured.

* Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Enterprise (Run Tasks) instance, navigate to Settings → Data Sources & Integrations →  page, select the Terraform Enterprise (Run Tasks) integration, click  → Add Instance, and repeat the onboarding steps above.

###### 5.8.10.1.4. CLI pipeline code snippets

####### Prerequisite

* User permissions: Ensure the user performing the integration has permissions to edit pipeline configurations (such as YAML files).

###### 5.8.10.1.5. Onboard private package registries

####### 5.8.10.1.5.1. JFrog Artifactory

####### 5.8.10.1.5.2. Onboard JFrog Artifactory

######## Prerequisite

* Cortex XSIAM user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) JFrog permissions:    The permissions associated with the user configured during the onboarding process determine the scope of scan results. Only repositories and artifacts the user can access are...

######## Note

* To authorize the scanner to connect through your firewall, select Enable access by IPs, and copy the displayed source IPs to your organization's allowlist.

* For Maven:    Select Mirror Registry if this repository mirrors an external repository   Use the Mirror Of value to define the duplication scope:    * mirrors all requests   Type a request [value]: Mirrors only specific requests (such as central). For Maven: Select Mirror Registry if this repository mirrors an external repository Use the Mirror Of...

###### 5.8.10.1.6. Supported third-party data sources

####### Note

* Only onboarded and scanned repositories can be mapped.

####### 5.8.10.1.6.1. Ingest Semgrep data

######## Prerequisite

* Cortex XSIAM user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) Ensure that you have a connected version control system (VCS) and repositories Create a Semgrep API token  Note    To create a Semgrep API token, in Semgrep, navigate to Settings → Tokens → API...

######## Note

* Select Add Another Instance if the data source instance has already been configured.

* Mapping establishes relationships between Semgrep projects and Cortex XSIAM code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects are ingested

####### 5.8.10.1.6.2. Ingest Snyk data

######## Prerequisite

* Permissions: The following user permissions are required:     Cortex XSIAM user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator)    Ensure that you have a connected version control system (VCS) and repositories   Snyk API token:    Recommended. Generate an API token from...

######## Note

* Select Add Another Instance if the data source instance has already been configured.

* Mapping establishes relationships between Snyk applications and Cortex XSIAM code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped applications are ingested

######## Navigation

  Modules → Application Security → Vulnerabilities (under Issues

####### 5.8.10.1.6.3. Ingest SonarQube SAST data

######## Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Generate and copy a SonarQube API token. Ensure to assign Web API scope to the API token. Refer...

######## Note

* Mapping establishes relationships between SonarQube Applications and Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

####### 5.8.10.1.6.4. Ingest Veracode SAST data

######## Prerequisite

* Permissions: The following user permissions are required:    Cortex Cloud: Instance Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions   Veracode: At minimum, Reviewer permissions are required Permissions: The following user permissions are required: Cortex...

######## Note

* Only mapped applications will be ingested.

* This is the recommended option to ensure complete coverage and successful operation of all features.

* Mapping establishes relationships between Veracode projects and Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

####### 5.8.10.1.6.5. Generic 3rd Party AppSec Collector

######## Important

* File uploads are limited to a maximum size of 10 MB.

######## 5.8.10.1.6.5.1. Onboard the 3rd Party AppSec Collector

###### 5.8.10.1.7. Manage data source integrations

####### Tip

* To quickly find your data source integration, use the search bar.

###### 5.8.10.1.8. Transporter over Broker VM

####### Prerequisite

* Ensure you have the necessary permissions and have already set up your Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex XSIAM resources. The IP addresses for the Transporter are in the Broker VM Resources section of the Enable access to required PANW resources document Open port 4052 (inbound), which...

####### Note

* The broker enables multiple connections, allowing a single Transporter applet to connect to various VCS instances Multiple Transporter applets cannot be created on a single Broker VM. Each Broker VM is limited to a single Transporter applet instance

####### Warning

* The Transporter applet is not supported for FedRAMP customers.

####### 5.8.10.1.8.1. Set up a Transporter applet on Broker VM

######## Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator)

######## Note

* You cannot add a Transporter applet through Clusters.

######## Navigation

  your AppSec Transporter under the App column → Configure → Add Connection (on the redirected AppSec Transporter setup page

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

####### 5.8.10.1.8.2. Set up a Transporter on your VCS

######## Prerequisite

* Ensure you have user permissions to onboard data sources.  Note The dedicated AppSec Admin role includes the required permissions. Ensure you have user permissions to onboard data sources. Before you begin you must setup a Transporter applet on your Broker VM. Refer to Set up a Transporter applet on Broker VM for more information

######## Note

* GitLab Enterprise webhook internal IP restriction: GitLab Enterprise's security policies prevent webhook subscriptions to internal IP addresses (such as broker addresses). These subscriptions can only be enabled through specific instance configuration. For more information, refer to https://docs.gitlab.com/security/webhooks/.

######## Navigation

  Settings → Data Sources & Integrations → + Add New → , and search for your VCS on-premises data source

##### 5.8.10.2. Application Security dashboard

###### Navigation

  Modules → Application Security → AppSec Dashboard

##### 5.8.10.3. Application Security Posture Management (ASPM)

###### 5.8.10.3.1. ASPM use cases

###### 5.8.10.3.2. ASPM key features

###### 5.8.10.3.3. ASPM user roles and permissions

####### Navigation

  You can view AppSec Admin permissions in the tenant by navigating to Settings → Configurations → Roles → AppSec Admin

###### 5.8.10.3.4. Code to Cloud

####### Navigation

  Full Code to Cloud (C2C) coverage is achieved when Cortex XSIAM can resolve the following chain: Repository → Pipeline → Image → (optional Registry) → Runtime resources (including VMs, VM images, and IaC-defined infrastructure

####### 5.8.10.3.4.1. Supported integrations

####### 5.8.10.3.4.2. Code to Cloud visibility

######## Navigation

  Topology graph: Located in the Business Applications side card, this tab visualizes the entire path to production (Code → Build → Deploy → Run), allowing you

####### 5.8.10.3.4.3. Code to Cloud troubleshooting

######## Note

* Empty state messages and troubleshooting guidance for missing lineage are only visible to users with an active license.

###### 5.8.10.3.5. ASPM Command Center

####### 5.8.10.3.5.1. ASPM Command Center workflow

######## Note

* Breakdown by type: Issues are further broken down by type (such as IAC or Secrets).

###### 5.8.10.3.6. Coverage

####### 5.8.10.3.6.1. Coverage in the user interface

######## Navigation

  Modules, → Application Security → AppSec Coverage

###### 5.8.10.3.7. Compliance for Application Security

####### 5.8.10.3.7.1. Infrastructure-as-Code (IaC) compliance

####### 5.8.10.3.7.2. Manage IaC compliance

######## Prerequisite

* Add these properties to the IaC Rules table through the Table Settings Menu, as they are not exposed by default.

######## Navigation

  Modules → Application Security → AppSec Polices → Add Policy

####### 5.8.10.3.7.3. CI/CD Compliance

######## Navigation

  To access Compliance, select Posture Management → Compliance → Reports or Assessment

######## 5.8.10.3.7.3.1. Create CI/CD compliance reports

###### 5.8.10.3.8. Urgency

####### 5.8.10.3.8.1. Urgency metrics

###### 5.8.10.3.9. Backlog baseline

####### 5.8.10.3.9.1. Backlog use cases

####### 5.8.10.3.9.2. Issue/Finding classification by scanner

######## Note

* In some cases/vendors, this is not accurate as findings are deleted every time new findings are uploaded. In such cases, the feature may not be accurate or supported For SAST, the vendor does not support policy in pull requests

* Scanner updates and new detections: When a security scanner is updated to support new languages, detection rules, or capabilities, any issues discovered by these new features for existing code are classified as part of the backlog.

####### 5.8.10.3.9.3. Using Backlog

###### 5.8.10.3.10. Service Lead Agreements (SLA)

####### 5.8.10.3.10.1. Configure and monitor Application Security SLAs

######## Navigation

  Settings → Configurations → Application Configuration (under Application Security

###### 5.8.10.3.11. Applications

####### 5.8.10.3.11.1. Defining Business Applications

######## 5.8.10.3.11.1.1. Defining business applications by Criteria

######## 5.8.10.3.11.1.2. Define applications by VCS criteria

######## 5.8.10.3.11.1.3. Manage application criteria

######## 5.8.10.3.11.1.4. Define applications by cloud tag-based criteria

######## 5.8.10.3.11.1.5. How to manually build an application

####### 5.8.10.3.11.2. Application management and visibility

######## Navigation

  Inventory → All Assets → Business Applications (under Application

####### 5.8.10.3.11.3. Business application assets

######## 5.8.10.3.11.3.1. Business application expanded asset details

######## 5.8.10.3.11.3.2. Export business application data

####### 5.8.10.3.11.4. Scope user access to applications (Application SBAC)

######## Navigation

  Configure user scopes in Cortex XSIAM by navigating to Settings → Configurations → Access Management

######## 5.8.10.3.11.4.1. Enable SBAC in the Cortex XSIAM tenant

######## 5.8.10.3.11.4.2. Create an application-based Asset Group

######## 5.8.10.3.11.4.3. Scope user access to an application

######## 5.8.10.3.11.4.4. Create application-scoped policies

###### 5.8.10.3.12. Repositories as assets

####### 5.8.10.3.12.1. Explore repository assets

####### 5.8.10.3.12.2. In-depth repository asset information

####### 5.8.10.3.12.3. Manage Repository assets

####### 5.8.10.3.12.4. Export Software Bill of Materials (SBOM)

####### 5.8.10.3.12.5. Manage issues detected in repositories

######## Note

* You can also find the repository issues in the general issue inventory table, and in the dedicated inventory of issues for each scanner type (see step 4 above for details).

###### 5.8.10.3.13. Manage 3rd party findings and generated issues

###### 5.8.10.3.14. Manage code weaknesses

####### Note

* You can customize policies to define which findings are categorized as issues.

####### Tip

* In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Code Weaknesses tab under the Repositories asset inventory. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from the table → Code Weaknesses In code Asset inventories, navigate to Inventory →...

####### Navigation

  To access SAST code violation issues, under Modules, select Application Security → Issues → Code Weaknesses

####### 5.8.10.3.14.1. Code weaknesses issue inventory

####### 5.8.10.3.14.2. Detailed code weakness issue information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 5.8.10.3.14.3. Code weakness findings

######## Note

* Findings on the Cortex platform are not intended for direct action; but rather represent data collected by the platform. They must be promoted to issues to enable mitigation efforts to secure your codebase.

##### 5.8.10.4. CI/CD Security

###### 5.8.10.4.1. CI/CD Security user roles and permissions

###### 5.8.10.4.2. CI/CD Assets

####### 5.8.10.4.2.1. CI/CD Instances as assets

######## 5.8.10.4.2.1.1. Explore CI/CD Instance assets

######## 5.8.10.4.2.1.2. In-depth CI/CD pipeline instance asset information

######## 5.8.10.4.2.1.3. Manage CI/CD pipeline instances

####### 5.8.10.4.2.2. CI/CD Pipelines as assets

######## 5.8.10.4.2.2.1. Explore CI/CD Pipeline assets

######## 5.8.10.4.2.2.2. In-depth CI/CD pipeline asset information

######## 5.8.10.4.2.2.3. Manage CI/CD pipeline assets

####### 5.8.10.4.2.3. Version Control System (VCS) Organizations as assets

######## 5.8.10.4.2.3.1. Explore VCS Organization assets

######## 5.8.10.4.2.3.2. In-depth VCS Organization asset information

######## 5.8.10.4.2.3.3. Manage VCS organization assets

####### 5.8.10.4.2.4. VCS Collaborators-as-assets

######## 5.8.10.4.2.4.1. In-depth Collaborator asset information

######## 5.8.10.4.2.4.2. Manage Collaborator assets

###### 5.8.10.4.3. Supply Chain Inventories

####### Note

* Although attributes are identical across inventories, their values for the same tool can differ, most commonly in Risk Factors and Type. This is because the inventory reflects your live environment, which may include different versions or configurations than the catalog—for example, a package may not have been upgraded or may be deployed differently.

####### Navigation

  In the inventory table, right-click on a tool → Change Status → select a status

####### 5.8.10.4.3.1. Supply Chain Tools

######## 5.8.10.4.3.1.1. Supply Chain Tools

######## 5.8.10.4.3.1.2. Expanded Supply Chain tool information

####### 5.8.10.4.3.2. Supply Chain Catalog

######## Navigation

  To access the Supply Chain Catalog, select Modules → Application Security → Supply Chain Catalog (under 3rd party tools

###### 5.8.10.4.4. CI/CD Risks

####### Note

* Application Security CI/CD pipeline scans create a comprehensive inventory of all CI/CD pipelines in your environment. For more information refer to CI/CD Pipelines as assets.

####### 5.8.10.4.4.1. CI/CD pipeline issues

######## Navigation

  To access CI/CD pipeline risks issues, under Modules, select Application Security → Issues → CI/CD Risks

####### 5.8.10.4.4.2. Expanded CI/CD risks issue information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 5.8.10.4.4.3. VCS and CI/CD pipeline risk findings

###### 5.8.10.4.5. CI/CD Rules

####### Note

* Out-of-the-box rules cannot be modified Custom CI/CD rules are not supported

####### 5.8.10.4.5.1. CI/CD rules roles and permissions

####### 5.8.10.4.5.2. CI/CD rules inventory

###### 5.8.10.4.6. CI/CD Policies

####### Tip

* For Cortex XSIAM Code policies, refer to Application Security Policies.

####### 5.8.10.4.6.1. CI/CD policies user roles and permissions

####### 5.8.10.4.6.2. CI/CD policies inventory

######## Note

* To view all out-of-the-box (OOTB) policies, filter by Policy Owner = System.

####### 5.8.10.4.6.3. Create custom CI/CD policies

######## Note

* PR Scan and CI Scan triggers are automatically disabled and unchecked. They can only be enabled if other scan types (that is non-CI/CD risk scans such as Secrets) are also selected, and will only run on non-CI/CD risks types of scans

* You can combine multiple conditions to create complex rules for when the policy should apply. Create conditions that apply to a CI/CD policy which detects high severity CI/CD risks on GitHub: Select Add Filter → Finding Type → CI/CD Risks → AND → Provider → [VCS/CI/CD system] → AND → Severity: → High.

* SBAC scope limitations do not apply to Matching Criteria For CI/CD policies, you can filter Matching Criteria by VCS Organization Name, CI/CD Pipeline [Name/ID], CI/CD Instance [Name/ID] or Collaborator [Name/Email/MFA Enabled/Last Observed]

####### 5.8.10.4.6.4. Manage CI/CD policies

######## Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

##### 5.8.10.5. Code Security

###### 5.8.10.5.1. Code Security user roles and permissions

###### 5.8.10.5.2. Code Security assets

###### 5.8.10.5.3. Software packages as assets

####### 5.8.10.5.3.1. Explore software package assets

####### 5.8.10.5.3.2. In-depth software package asset information

###### 5.8.10.5.4. Infrastructure-as-Code (IaC) resources as assets

####### 5.8.10.5.4.1. Explore IaC assets

######## Navigation

  To access IaC assets, under Inventory, select All Assets → Code → IaC Resources

####### 5.8.10.5.4.2. In-depth IaC resource asset information

###### 5.8.10.5.5. Code Security scanners

###### 5.8.10.5.6. Secrets scanners

####### 5.8.10.5.6.1. Secrets issues

######## Navigation

  Under Modules, select Application Security → Issues → Secrets

  Inventory → All Assets → Code: On the Secrets tab under Repositories

  Inventory → All Assets → Code

  Inventory → All Assets → Application → select an option from the Application menu → select an item from the inventory → Secrets

####### 5.8.10.5.6.2. Secrets issues inventory

####### 5.8.10.5.6.3. Detailed Secrets issue information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 5.8.10.5.6.4. Secrets findings

######## Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

######## Navigation

  The Application Security Secrets Findings table is a pre-filtered view of the comprehensive Findings inventory (located at Cases & Issues → Issues → Findings Table tab

  To access Secrets findings, select Application Security → Issues → Secrets → click the Findings tab

####### 5.8.10.5.6.5. Manage Secrets issues

###### 5.8.10.5.7. Infrastructure as Code (IaC) misconfiguration scanner

####### 5.8.10.5.7.1. Supported frameworks and languages

####### 5.8.10.5.7.2. IaC misconfiguration issues

######## Tip

* You can also view IaC misconfiguration issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Configuration tab under Repository assets. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from...

######## Navigation

  To access IaC misconfiguration issues, under Modules, select Application Security → Issues → IaC misconfiguration

####### 5.8.10.5.7.3. IaC misconfiguration issues inventory

####### 5.8.10.5.7.4. Detailed IaC misconfiguration issue information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 5.8.10.5.7.5. IaC misconfiguration findings

######## Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

######## Navigation

  To access IaC misconfiguration findings, under Modules, select Application Security → Issues → IaC Misconfigurations → click the Findings tab

####### 5.8.10.5.7.6. Manage IaC misconfiguration issues

###### 5.8.10.5.8. IaC Drift Detection scans

####### 5.8.10.5.8.1. IaC Drift Detection issues

######## Navigation

  Modules → Application Security → IaC Drifts

####### 5.8.10.5.8.2. IaC Drift Detection issue inventory

####### 5.8.10.5.8.3. Detailed IaC drift detection issue information

####### 5.8.10.5.8.4. IaC Drift Detection findings

######## Navigation

  Modules → Application Security → IaC Drifts (under Issues) → click the Findings tab

###### 5.8.10.5.9. Software Composition Analysis (SCA ) scanners

####### 5.8.10.5.9.1. Supported Software Composition Analysis (SCA) frameworks and languages

####### 5.8.10.5.9.2. Software Composition Analysis (SCA) vulnerability issues

######## Tip

* In Asset inventories, navigate to Inventory → All Assets → Code:    On the Vulnerabilities tab under Repositories. Refer to In-depth repository asset information for more information Under the All Code inventory: Select an asset from the table → Vulnerabilities In Asset inventories, navigate to Inventory → All Assets → Code: On the...

######## Navigation

  To access CVE vulnerability issues, under Modules, select Application Security → Issues → Vulnerabilities

######## 5.8.10.5.9.2.1. Vulnerability issues inventory

######## 5.8.10.5.9.2.2. Detailed vulnerability issue information

######## 5.8.10.5.9.2.3. CVE vulnerabilities findings

######## 5.8.10.5.9.2.4. Manage SCA CVE vulnerability issues

####### 5.8.10.5.9.3. License miscompliance issues

######## Tip

* You can also view license miscompliance issues in dedicated tabs under other sections when available: In Application asset inventories: navigate to Inventory → All Assets →  Application → select an option from the Application menu → select an item from the inventory → Package Integrity In Asset inventories, navigate to Inventory → All...

######## Navigation

  To access license miscompliance issues, under Modules, select Application Security → Issues → Licenses

######## 5.8.10.5.9.3.1. License miscompliance issues inventory

######## 5.8.10.5.9.3.2. Expanded License miscompliance issues information

######## 5.8.10.5.9.3.3. License miscompliance findings

######## 5.8.10.5.9.3.4. Open-source software license categories

######## 5.8.10.5.9.3.5. Manage license miscompliance issues

####### 5.8.10.5.9.4. Package Integrity

######## 5.8.10.5.9.4.1. Package Integrity inventory

######## 5.8.10.5.9.4.2. Expanded Package Integrity issues inventory information

######## 5.8.10.5.9.4.3. Package Integrity findings

######## 5.8.10.5.9.4.4. Manage Package Integrity issues

###### 5.8.10.5.10. Application Security scans management

####### 5.8.10.5.10.1. Overview

######## Note

* While scans provide a comprehensive inventory of all issues detected during a scan, dedicated inventories are also maintained for specific scan types for more granular management. For more information, refer to Infrastructure as Code (IaC) misconfiguration scanner, Secrets scanners and Software Composition Analysis (SCA ) scanners.

####### 5.8.10.5.10.2. Branch periodic scans

######## Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

####### 5.8.10.5.10.3. Pull Request scans

######## Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

####### 5.8.10.5.10.4. CI scans

######## Note

* The inventory table displays scan issues for visibility only; remediation is not available in scan management. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

####### 5.8.10.5.10.5. Manage repository scan configurations

####### 5.8.10.5.10.6. Monitor data source instances health

###### 5.8.10.5.11. Application Security Policies

####### 5.8.10.5.11.1. User roles and permissions

####### 5.8.10.5.11.2. Policies inventory

######## Note

* To view all out-of-the-box (OOTB) policies, filter by Policy Owner = System.

####### 5.8.10.5.11.3. AI-recommended guardrails

######## 5.8.10.5.11.3.1. Manage AI-recommended guardrails

####### 5.8.10.5.11.4. Create Application Security policies

######## Note

* When an issue is created, only the first policy ID that triggered the issue is associated with it.

######## 5.8.10.5.11.4.1. Create code security policies

######### 5.8.10.5.11.4.1.1. Application Security code policy Condition attributes

######## 5.8.10.5.11.4.2. Create IaC Drift Detection policies

######## 5.8.10.5.11.4.3. Manage Application Security policies

###### 5.8.10.5.12. Application Security Rules

####### Note

* Out-of-the-box rules cannot be modified directly. However, you can create a custom rule by cloning the existing one. This allows you to make changes to the original rule according to your requirements. Refer to Manage Application Security custom rules for more information.

####### 5.8.10.5.12.1. Roles and permissions

####### 5.8.10.5.12.2. Rules inventory

######## Navigation

  To filter rules relating to Secrets, select filter icon → Scanner (from the Select field) → Secrets (from the Value field

####### 5.8.10.5.12.3. Create custom Application Security rules

######## Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

####### 5.8.10.5.12.4. Manage Application Security custom rules

####### 5.8.10.5.12.5. Configure YAML file properties

###### 5.8.10.5.13. Application Security CLI

####### Prerequisite

* These requirements apply specifically to the Application Security CLI. For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of...

####### Note

* For detailed information about the Cortex XSIAM CLI, refer to Cortex CLI.

####### 5.8.10.5.13.1. Connect Cortex CLI

######## Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

######## Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources & Integrations →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Application Security, refer to Cortex CLI usage for Application Security

######## Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source or Integrations page after selecting + Add New.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

####### 5.8.10.5.13.2. Cortex CLI usage for Application Security

####### 5.8.10.5.13.3. CLI pipeline code snippets

######## Prerequisite

* User permissions: Ensure the user performing the integration has permissions to edit pipeline configurations (such as YAML files).

####### 5.8.10.5.13.4. Cortex CLI Application Security command line reference

######## Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

######## Important

* The Cortex CLI Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id <YOUR_AUTH_ID>...

####### 5.8.10.5.13.5. Cortex CLI common command line reference guide

######## Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

####### 5.8.10.5.13.6. Git Hooks

######## 5.8.10.5.13.6.1. Cortex CLI pre-commit hooks

######### 5.8.10.5.13.6.1.1. Pre-commit hook usage

######## 5.8.10.5.13.6.2. Cortex CLI pre-receive hooks

######### 5.8.10.5.13.6.2.1. Pre-receive hook usage

###### 5.8.10.5.14. IDE

####### Note

* Not all remediation options are available for all findings or all type of scan category.

####### 5.8.10.5.14.1. System requirements

####### 5.8.10.5.14.2. Visual Studio (VS) Code and VS Code compatible IDEs

######## Prerequisite

* Before you begin (These prerequisites apply to both VS Code and VS Code compatibles): Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

######## Note

* Enforcement rules and CA certificates are not applicable to the open-source project.

######## Tip

* You can access Extensions using the keyboard shortcuts Ctrl+Shift+X (Windows) or Cmd+Shift+X (macOS).

######## Navigation

  Install through VS Code IDE Access the Activity bar → Extensions → Cortex Cloud → Install

  Access the Activity bar → Extensions → Cortex Cloud → Install

######## 5.8.10.5.14.2.1. How to use the Cortex Cloud extension in VS Code

####### 5.8.10.5.14.3. JetBrains

######## Prerequisite

* Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install Node.js version 22 and...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

######## Note

* The Cortex AppSec code security plugin supports all JetBrains products.

######## Navigation

  Settings → Plugins → select the Marketplace tab → search for Prisma Cloud → Install → OK

  Settings → Tools → Cortex Cloud

######## 5.8.10.5.14.3.1. How to use the JetBrains Cortex XSIAM extension

###### 5.8.10.5.15. Developer Suppressions

####### Note

* The check IDs and rule names are placeholders for illustration purposes and do not correspond to actual checks.

##### 5.8.10.6. API documentation

#### 5.8.11. Cloud Workload Policies and Rules

##### Prerequisite

* Users need View/Edit RBAC permissions (under Policies → Compute Policies) or the Instance Administrator role to view, edit, and modify Cloud Workload Policies policies.

##### Important

* Users with SBAC granular scoping (in addition to the RBAC permissions required for Cloud Workload Policies) can only view Cloud Workload Policies, when their access is scoped to any of the available options: All assets, No assets, or Select asset groups. For more information on granular scoping, see Manage user scope. When no SBAC restriction is...

##### 5.8.11.1. How policies and rules work together

##### 5.8.11.2. Cloud Workload Policies

###### Note

* Issues are automatically resolved when the finding is no longer applicable to the asset or when the affected asset is removed from the inventory. For more details on Prevent and create issues, see Cloud Workload Preventive Action.

###### 5.8.11.2.1. Types of Cloud Workload Policies

####### 5.8.11.2.1.1. Trusted image cloud workload policies

######## Note

* Registry scanning is for finding problems that are objectively issues regardless of context, organization, or scope. Trust, however, is subjective. Depending on the scope and other factors, an issue may or may not be problematic, and can change over time depending on the context.

* Trusted image policies do not override other policies and their rules, such as malware policies, misconfiguration policies, and secrets policies.

######## Caution

* The default behavior for the prevent action when trust criteria are unavailable is Create an Issue. Be aware that changing this default will mean an incomplete deployment file can block a workload.

###### 5.8.11.2.2. Cloud Workload Policies page

####### Note

* Keep the following caveats in my mind when working with Policies: Instance Administrators are able to view all facets of policies without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be...

####### 5.8.11.2.2.1. Widgets panel

######## 5.8.11.2.2.1.1. Show or hide the widget panel

####### 5.8.11.2.2.2. Change the layout of the policies table

######## Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

####### 5.8.11.2.2.3. Policy Details Panel

######## Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 5.8.11.2.3. Enable or disable a Cloud Workload Policy

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 5.8.11.2.4. Create a Cloud Workload Policy

####### Note

* The Evaluation stage for Misconfiguration policies is supported only in the Runtime SDLC stage and is enforceable through the Kubernetes Admission Controller for clusters on-boarded using the Posture Management (KSPM) Connector.

* Use Create a new Custom Detection Rule to define and add new custom rules as required.

* Each rule may support different actions. While some include both Create an Issue and Prevent and Create an Issue, others provide only the Create an Issue option.

* All non-relevant (non-compute) assets are automatically excluded from the included asset list.

* See Cloud Workload Preventive Action, to learn more about the Prevent action behavior and prerequisites. If the Prevent and create an issue action is selected, the preventive actions in the CI pipeline will trigger a Fail Pipeline by returning an exit code of 2 in the CI tool.

* Choosing this option results in the automatic selection of all other asset scopes in the list.

* See Cloud Workload Preventive Action, to learn more about the Prevent action behavior and prerequisites.

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 5.8.11.2.5. Use an existing policy to create a new Cloud Workload policy

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 5.8.11.2.6. Edit a Cloud Workload Policy

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 5.8.11.2.7. Delete a Cloud Workload Policy

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 5.8.11.2.8. Cloud Workload Preventive Action

##### 5.8.11.3. Cloud Workload Rules

###### 5.8.11.3.1. Default (pre-defined) Rules

###### 5.8.11.3.2. Custom (user-defined) Rules

###### 5.8.11.3.3. Cloud Workload Rules page

####### Note

* Keep the following caveats in my mind when working with Rules: Instance Administrators are able to view all facets of Rules without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be able...

####### 5.8.11.3.3.1. Filter page results

####### 5.8.11.3.3.2. Change the layout of the rules table

####### 5.8.11.3.3.3. Rule details panel

###### 5.8.11.3.4. Create a new Custom Detection Rule

####### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

####### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

###### 5.8.11.3.5. Use an existing rule to create a new Custom Detection Rule

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

###### 5.8.11.3.6. Edit a Custom Detection Rule

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

###### 5.8.11.3.7. Delete a Custom Detection Rule

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

#### 5.8.12. Web and API Security (WAAS)

##### 5.8.12.1. Overview

###### License Type

  Requires Cortex XSIAM Premium or any other XSIAM license with the Cloud Runtime Security add-on.

##### 5.8.12.2. Personas workflow

##### 5.8.12.3. Secure your API landscape

###### 5.8.12.3.1. Gain visibility and assess risk of API endpoints

####### Note

* Data classification findings are only available for enabled profiles.

* Indicates that a JSON Web Token was identified, but it is unknown how to determine its type from the given string. It could be a non-standard JSON Web Token creation algorithm.

* To link APIs to business applications, the two prerequisites must be met: The VM must have XDR agent with WAAS enabled. Applications must be defined in Application Security Posture Management (ASPM).Application Security Posture Management (ASPM)

###### 5.8.12.3.2. Monitor and investigate API threats

###### 5.8.12.3.3. Configure API security from end to end

####### 5.8.12.3.3.1. Third-party integrations

######## 5.8.12.3.3.1.1. Ingest AWS API Gateway

######## 5.8.12.3.3.1.2. Ingest Azure APIM

######## 5.8.12.3.3.1.3. Ingest Apigee Proxy

######## 5.8.12.3.3.1.4. Ingest Kong

######## 5.8.12.3.3.1.5. Ingest-F5

####### 5.8.12.3.3.2. Agent-based protection

######## Note

* Web and API Security (WAAS) profiles and policies are currently a Beta feature.

######## 5.8.12.3.3.2.1. Set up Web and API Security profiles

######## 5.8.12.3.3.2.2. Apply Web and API Security profiles to workloads

######## 5.8.12.3.3.2.3. Manage Web and API Security prevention profiles

######## 5.8.12.3.3.2.4. Add a disable prevention rule for cloud workloads

######## 5.8.12.3.3.2.5. Add a support exception rule for cloud workloads

######## 5.8.12.3.3.2.6. Add a legacy exception rule for cloud workloads

######## 5.8.12.3.3.2.7. Additional workload management tasks

###### 5.8.12.3.4. API specification inventory

####### Note

* Even if you have already imported the specification, you can edit the API specification in Cortex XSIAM and add or update the server list.

####### 5.8.12.3.4.1. Import API specification

######## Note

* Even if you already imported the file, you can edit the API asset and add or update the server list.

#### 5.8.13. Serverless function runtime security

##### 5.8.13.1. Overview

##### 5.8.13.2. Set up serverless function protection

##### 5.8.13.3. Serverless runtime issues

###### Note

* Issues triggered within 24 hours, sharing the same name and description, will be aggregated into cases along with issues from the same function per execution.

### 5.9. Cortex Advanced Email Security

#### 5.9.1. Cortex Advanced Email Security module overview

##### Prerequisite

* The following are prerequisites for using the Cortex XSIAM Advanced Email Security module. REQUIREMENT DESCRIPTION Setup and Permissions Ensure Analytics is activated before enabling the Cortex Advanced Email Security module. Licenses and Add-ons Cortex Advanced Email Security add-on.

#### 5.9.2. Cortex Advanced Email Security module architecture and data flow

#### 5.9.3. Getting started with the Cortex Advanced Email Security module

##### Prerequisite

* Before you configure the Cortex Advanced Email Security module, ensure you have the following: Admin-level access to the target email platform Dedicated service account (recommended) for integration purposes (response actions) List of domains and mailboxes to be protected (to be used during the wizard configuration) Access to an internal phishing...

#### 5.9.4. Deploy and configure the Email Security module

##### 5.9.4.1. Integrate Microsoft 365 with the Cortex Advanced Email Security Module

###### License Type

  To configure a quick action, you must first create an application in Microsoft O365.

###### Navigation

  After you onboard your domains and configure the quick actions, Cortex XSIAM manage your protected domains in Modules → Email Security → Email Security Configuration

##### 5.9.4.2. Configure the Cortex Advanced Email Security module

###### License Type

  Requires the Advanced Email Security module.

###### Note

* You can add email indicators to the Allow List also in Exceptions Configuration → Issue Exclusions. However, if you add multiple indicators in a rule using Issue Exclusions under Exceptions Configuration, you cannot edit the rule in the Email Security Allow List.

###### Navigation

  Modules → Email Security → Email Security Configuration

#### 5.9.5. Cortex Advanced Email Security threat detection and issues

##### Note

* Depending on data collection mode and platform capabilities, not all fields may be populated for every message. API and export documentation provides further clarification on optional vs required fields.

##### 5.9.5.1. Email Security Analytics Rules

###### Navigation

  The Email Security Analytics Rules page is in Modules → Email Security → Email Security Detection Rules

#### 5.9.6. Investigate and respond to email security issues

##### License Type

  Requires the Cortex Advanced Email Security module.

##### Navigation

  Modules → Email Security → Email Security Issues

#### 5.9.7. Automate remediation for the Cortex Advanced Email Security module

##### Note

* For automated actions not yet supported by the response engine, use the playbooks, scripts, and commands in the Cortex XSIAM automation engine. For more information, see Automation in Cortex XSIAM.

##### Navigation

  Define the rules for your email security policy in Email Remediation Response Rules, located in Modules → Email Security → Remediation → Rules

  Review all the remediation actions initiated by your policy in the Email Remediation Action Center, located in Modules → Email Security → Remediation → Action Center

##### 5.9.7.1. Email Remediation Response Rules

###### Note

* For automated actions not yet supported by the response engine, use the playbooks, scripts, and commands in the Cortex XSIAM automation engine. For more information, see Automation in Cortex XSIAM.

* If you apply a new template, all the customizations to the previous template you used will be lost.

###### Navigation

  The Email Remediation Response Rules page is under Modules → Email Security → Remediation → Rules and displays the following widgets and the Rules table

##### 5.9.7.2. Email Security Remediation Action Center

#### 5.9.8. Email Command Center

##### License Type

  Requires the Cortex Advanced Email Security module.

##### Note

* Adding more data into the Email Security module will ensure better detection of complicated email threat vectors.

* The number of remediated emails and the number of remediation actions may not always be equal. This is due to a number of reasons, including different policies that affect the email messages or manual actions taken.

#### 5.9.9. Advanced Email Security module security and compliance

##### Note

* For information about how Cortex handles personal and private information, see the Cortex Privacy Datasheet.

### 5.10. Exposure management

#### 5.10.1. Exposure Management

##### License Type

  Requires the Exposure Management add-on.

#### 5.10.2. Get started with Exposure Management

##### 5.10.2.1. Exposure Management FedRAMP support

#### 5.10.3. Exposure Management Command Center

#### 5.10.4. Security controls

##### 5.10.4.1. Automatically detect security controls

###### Note

* Auto-detection of controls is supported when certain constraints regarding topology and configuration are met. Learn more about Network Exposure Detection.

##### 5.10.4.2. Manually attested security control taxonomy

###### Tip

* Take an inventory of your top 10-15 security controls, check which ones need to be manually added into the Cortex Platform and use the taxonomy to map them into the system.

##### 5.10.4.3. Establish security control roles

###### Note

* Ensure that you have clear visibility into the controls that are created and implemented, by periodically reviewing the Audit Logs as part of your change management process. Audit logs track the following actions: Create/Update/Delete Security Controls Create/Update/Delete Effectiveness Rules Update an Effectiveness Value in a findings or issues

###### Tip

* Start with a centralized model. This helps a core team master the new object models, states, and taxonomies to prevent confusion and ensure high-quality control creation.

##### 5.10.4.4. Create a security control

##### 5.10.4.5. Manage security controls

###### Navigation

  Alternatively, you can also find Detected Controls and Detected Controls Coverage on the Vulnerability Issue (Posture Management → Vulnerability Management → Vulnerability Issues page

##### 5.10.4.6. Set compensating controls

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues and sort the vulnerabilities listed by their CVRS score or Compensating Control Effectiveness

##### 5.10.4.7. Improve controls coverage

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

##### 5.10.4.8. Create effectiveness rules

###### Note

* Only users with the role Exposure Management Administrator can create effectiveness rules.

###### Tip

* Use All, rather than selecting individual CVEs, unless you explicitly only want to mark specific CVEs as Effectively Mitigated.

##### 5.10.4.9. Manage effectiveness rules

#### 5.10.5. Cortex Network Scanner

##### 5.10.5.1. Get started with Cortex Network Scanner

###### License Type

  Requires the Exposure Management add-on.

###### Prerequisite

* Review the Cortex Network Scanner deployment recommendations and complete any prerequisites. Set up and configure Broker VM

###### Note

* The Cortex Network Scanner applet is not supported in High Availability (HA) cluster configurations. The Cortex Network Scanner applet is not supported for FedRAMP customers.

###### Important

* The Cortex Network Scanner applet is not supported for FedRAMP customers. Cortex Network Scanner does not support high availability (HA) Broker VM configuration.

###### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  Settings → Configurations → Network Scanners → Network Scanners and find your new scanner in the list

##### 5.10.5.2. Add a network

###### Navigation

  Settings → Configurations → Network Scanning → Networks and click + Add Network

##### 5.10.5.3. Define target groups

###### Navigation

  Settings → Configurations → Network Scanning → Target Group Management

##### 5.10.5.4. Manage credentials

###### Prerequisite

* Before initiating an authenticated scan, complete the following prerequisites on your target hosts: Create dedicated service accounts. We highly recommend creating dedicated service accounts on your target devices specifically for the network scanner. Avoid using existing administrative accounts or personal user accounts. This practice enhances...

###### Note

* For security reasons, you cannot edit saved credentials, but you can delete them and create new ones as needed.

###### Navigation

  Settings → Configurations → Network Scanners → Credential Management

  Settings → Configurations → Network Scanning → Credential Management

##### 5.10.5.5. Create a scan

###### Note

* Be sure that scanner traffic is allowed from each selected scanner to its selected targets. See Deployment recommendations  for more information.

###### Tip

* Most use cases can use the default advanced settings.

* ICMP Ping provides the quickest discovery scan and is good for initial discovery and scoping, however in the modern enterprise environment ICMP response can be blocked by the firewall or endpoint security rules. Using additional methods increases the accuracy of the host discovery, although makes the scan take a longer time. The best approach is to use...

##### 5.10.5.6. Manage scans

###### Navigation

  Settings → Configurations → Network Scanners → Scan Management

##### 5.10.5.7. View issues triggered by network scanner findings

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

  Alternatively, you can also view issues triggered by the Network Scanner from the Findings page, Posture Management → Vulnerability Management → Vulnerability Issues → All Vulnerability Findings

  Settings → Configurations → Network Scanners → Scan Management → Rescan History

#### 5.10.6. Service Level Agreements (SLAs) for issue resolution

##### Note

* These filters support filtering of whole days only, for example Resolution SLA > 1 filters for issues that have a Resolution SLA of greater than one day.

##### Navigation

  Settings → Configurations → Object Setup → Issues

  Settings → Configurations → Object Setup → Issues and select the SLA Rules tab

## 6. Reference and developer docs

### 6.1. Cortex XSIAM XQL

#### 6.1.1. Get started with XQL

##### 6.1.1.1. XQL language features

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

###### Navigation

  You submit XQL queries to Cortex XSIAM using the Investigation & Response → Search → Query Builder user interface

##### 6.1.1.2. XQL Language Structure

###### 6.1.1.2.1. Adding comments in queries

##### 6.1.1.3. Supported operators

###### Note

* In some cases, using an IN or NOT IN operator combined with a dataset and filter stage can be a better alternative to using a join stage.

##### 6.1.1.4. Datasets and presets

###### Note

* To set up this Cloud Identity Engine (previously called Directory Sync Service (DSS)) dataset, you need to set up a Cloud Identity Engine. Otherwise, you will not have a pan_dss_raw dataset. For more information, see Set up Cloud Identity Engine.

* INFO issues are not included in this dataset. This dataset includes issues from the Security and Health domains. For more information, see Overview of the Issues page.

* The fields contained in this dataset are a subset of the fields in the xdr_data dataset.

* If the vendor and product are not specified in the Winlogbeat profile's configuration file, Cortex XSIAM creates a default dataset called microsoft_windows_raw.

* To ensure GlobalProtect access authentication logs are sent to Cortex XSIAM, verify that your PANW firewall's Log Settings for GlobalProtect has the Cortex Data Lake checkbox selected.

* You must have the Cortex XSIAM Threat Intel Management (TIM) Add-on to use this dataset.

* Prisma Access firewalls do not send configuration logs to the Structured Log Storage (SLS).

* You can query in XQL for this data and build widgets based on the xdr_data dataset or using the preset device_control. To view in an XQL query these events, the Device Configuration of the endpoint profile must be set to Block. Otherwise, the USB events are not captured. The events are also captured when a group of device types are blocked on the...

###### Important

* This dataset will not be updated after June 2024. Use the health_alerts dataset instead.

##### 6.1.1.5. About examples

###### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

##### 6.1.1.6. JSON functions

###### Important

* JSON field names are case sensitive, so the key to field pairing must be identical in an XQL query for results to be found. For example, if a field value is "TIMESTAMP" and your query is defined to look for "timestamp", no results will be found.

##### 6.1.1.7. How to filter for empty values in the results table

##### 6.1.1.8. Understanding string manipulation in XQL

#### 6.1.2. Build XQL queries

##### Note

* If you have the Cortex Agentic Assistant, you can use natural language prompts to create and run XQL queries within the chat interface. For more information, see Create and run XQL queries with Agentic Assistant chat.

##### 6.1.2.1. About the Query Builder

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

##### 6.1.2.2. How to build XQL queries

###### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

###### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

###### 6.1.2.2.1. Get started with XQL queries

####### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

###### 6.1.2.2.2. Useful XQL user interface features

####### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

###### 6.1.2.2.3. XQL Query best practices

###### 6.1.2.2.4. Expected results when querying fields

###### 6.1.2.2.5. Create XQL query

####### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined for the entire query, including queries that are part of the join stage. Yet, this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

###### 6.1.2.2.6. Review XQL query results

####### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* Results are received incrementally for the first 100K records, or up to 100MB worth of records, whichever comes first. After that, the next update is when the query has finished running completely.

* Real time query results are available only in the Query Builder and in free text query. Real time results are displayed only for queries run on hot datasets. The Sort option is available only after all the data is retrieved. When you formulate complex queries, the results will be displayed when the query has finished running completely, and not in real...

* In order for Cortex XSIAM to provide a histogram for a field, the field must not contain an array or a JSON object.

###### 6.1.2.2.7. Translate to XQL

####### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

###### 6.1.2.2.8. Graph query results

####### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### 6.1.2.3. Query Builder templates

###### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

###### 6.1.2.3.1. Get started with Query Builder templates

###### 6.1.2.3.2. Considerations for using Query Builder templates

###### 6.1.2.3.3. Create a query from a template

####### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

###### 6.1.2.3.4. Run a free text query

####### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

###### 6.1.2.3.5. Query Builder template examples

####### Navigation

  Investigation & Response → Search → Query Builder

##### 6.1.2.4. Overview of the Query Center

###### Note

* Very short queries might not be listed. You cannot cancel correlation queries. The default retention period for historic queries is aligned with issue retention.

###### 6.1.2.4.1. Edit and run queries in Query Center

####### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

####### Navigation

  Investigation & Response → Search → Query Center → Query History

####### 6.1.2.4.1.1. Query Center reference information

######## Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 6.1.2.5. Manage scheduled queries

###### Navigation

  Investigation & Response → Search → Scheduled Queries

###### 6.1.2.5.1. Scheduled Queries reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 6.1.2.6. Manage your query library

###### Note

* The Query to Library option is only available if your role has the Create Queries capability. For more information, see Manage access to saved queries.

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

###### Important

* The ability to create, edit, or share queries is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to saved queries.

##### 6.1.2.7. Federated Search

###### 6.1.2.7.1. Federated Search

####### Note

* Federated Search is not enabled by default. To enable it in your tenant, please contact your Customer Support Team.

* Federated search query costs are calculated according to timeframe, complexity, and any cross-cloud egress costs that may apply.

* For optimal results, we recommend the Parquet format.

* The list of supported regions may change in the future.

###### 6.1.2.7.2. Federated Search configuration

####### Prerequisite

* Access to Cortex XSIAM communication. For a list of the authorized IP addresses, see Enable access to required PANW resources. An AWS bucket that contains your data sources. Permissions to modify IAM policies in AWS.

* Access to Cortex XSIAM communication. For a list of the authorized IP addresses, see Enable access to required PANW resources. A GCS bucket that contains your data sources. Permissions to modify IAM policies in GCS.

* Access to Cortex XSIAM communication. For a list of the authorized IP addresses, see Enable access to required PANW resources. An Azure Blob Storage blob with your data sources. Permissions to modify IAM policies in Azure Blob Storage.

####### Note

* We highly recommend that you don't change the auto-detected schema. However, if the auto-detected schema is incorrect, you can add, edit or delete fields. You can't delete the ds field, which is used for Hive partitioning. After you save the schema, you can't delete any fields you added during setup.

* You can only configure regions that are in the multi-region of your tenant.

* We highly recommend that you don't change the auto-detected schema. You can't delete the ds field, which is used for Hive partitioning. After you save the schema, you can't delete any fields you added during setup.

* Copy the Directory (tenant) ID, the Application (client) ID, and the Object ID. You will use these in the connection step.

* We highly recommend that you don't change the auto-detected schema. However, you can add, edit or delete fields. You can't delete the ds field, which is used for Hive partitioning. After you save the schema, you can't delete any fields you added during setup.

* When you create, delete, or update an external dataset, the action is recorded in the Management Audit Logs under the type External Datasets.

####### Navigation

  Settings → Configurations → Data Management → Dataset management → External Datasets and click Add External Dataset

###### 6.1.2.7.3. Query using Federated Search

####### Note

* The following aren't available in Federated Search and remain exclusive to fully ingested data. Complex, cross-source analytical functions, for example correlations, widgets, dashboards, and APIs search, target and view XQL stages

####### Navigation

  Incident Response → Investigation → Query Builder and select XQL

###### 6.1.2.7.4. Manage external datasets

####### Note

* We highly recommend that you don't change the auto-detected schema. However, in the Edit window you can add new fields or delete the new fields you added in the Edit window. You can't delete the fields that were configured during setup.

####### Navigation

  Manage external datasets created for federates searches in Settings → Configurations → Data Management → Dataset management → External Datasets

##### 6.1.2.8. Legacy Query Builder

###### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

###### 6.1.2.8.1. Create authentication query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 6.1.2.8.2. Create event log query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 6.1.2.8.3. Create file query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 6.1.2.8.4. Create image load query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 6.1.2.8.5. Create network connections query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 6.1.2.8.6. Create network query

####### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

###### 6.1.2.8.7. Create process query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 6.1.2.8.8. Create registry query

####### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

###### 6.1.2.8.9. Query across all entities

####### Navigation

  Investigation & Response → Search → Query Builder

#### 6.1.3. Stages

#### 6.1.4. Functions

### 6.2. Graph Search

#### 6.2.1. What is Graph Search?

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

#### 6.2.2. Get started with Graph Search queries

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

##### Navigation

  Understand your assets and findings data: Graph Search queries are based on the current data that has been collected for assets and findings from the data sources configured and then sent to the Unified Asset Inventory (UAI), which is displayed in the All Assets page (Inventory → Assets → All Assets

#### 6.2.3. How to build Graph Search queries?

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

##### Navigation

  You submit Graph Search queries using the Investigation & Response → Search → Query Builder → Graph Search built-in query interface

#### 6.2.4. Understand Graph Search query results

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

#### 6.2.5. Create Graph Search query

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

##### Note

* For more information about the Query Library, see Manage the Graph Search Query Library.

##### Tip

* After running the query, you can view the complete query by hovering over the last THAT... in the Graph Search query interface, and the query is displayed in a tooltip. If your query doesn't find any results or you want to change your query for any reason, you can always click anywhere in the Graph Search query interface, where your existing query is...

#### 6.2.6. Graph Search examples

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

#### 6.2.7. Manage the Graph Search Query Library

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

##### Navigation

  From Graph Search in the Query Builder Select Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Center

#### 6.2.8. Edit and run queries in Query Center

##### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

##### Navigation

  Investigation & Response → Search → Query Center → Query History

##### 6.2.8.1. Query Center reference information

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 6.2.9. Supported assets and findings

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

#### 6.2.10. FAQ on Graph Search

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

### 6.3. Cortex CLI

#### Note

* The CLI Read Only Role is not supported for CWP as the system does not support offline mode.

#### 6.3.1. Connect Cortex CLI

##### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

##### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources & Integrations →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Application Security, refer to Cortex CLI usage for Application Security

##### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source or Integrations page after selecting + Add New.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

#### 6.3.2. Cortex CLI common command line reference guide

##### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

#### 6.3.3. Cortex CLI for API Security

##### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more informationConnect Cortex CLI Ensure your application exposes APIs and provides a corresponding OpenAPI Specification file Ensure that you have installed Java v 11 and above

##### 6.3.3.1. Cortex CLI API Security command line reference guide

#### 6.3.4. Cortex CLI for Cloud Workload Protection

##### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more informationConnect Cortex CLI Verify that Java version 11 and above is installed: Run java -version in your terminal. If not, refer to Java SE Development Kit 11.0.25 for information...

* Before you begin, ensure you have sudo privileges to execute the image scan.

* For direct scanning from your Docker daemon, the image must already exist in your local Docker repository. The CLI will not pull a new image if it does not exist locally. To scan an image that exists in your local Docker daemon, simply provide its name: The image scan accepts the following arguments: --api-base-url: Required - true. The public facing API URL. Refer to Connect Cortex CLI for more informationConnect Cortex CLI --api-key: Required - true. Your Cortex Cloud API key. Refer to Connect Cortex CLI for more informationConnect Cortex CLI --api-key-id: Required - true. Your Cortex Cloud API key ID image scan: Required - true. Refers to CWP as the type of scan By default, Cortex XSIAM looks for the Docker socket at unix:///var/run/docker.sock. --docker-host <path> specifies the path to the Docker socket. Use this flag if your Docker socket is located elsewhere, for example unix:///var/snap/docker/common/run/docker.sock. To scan an image from a previously saved archive file (such as a .tar file), use the --archive flag: This example demonstrates how to create an image archive from your Docker or Podman environment, which can then be used for scanning or SBOM generation if you choose not to scan directly from the local daemon. With Docker: docker save -o ubuntu.tar ubuntu With Podman: podman save --format oci-archive -o /tmp/alpine-oci.tar alpine:latest You can generate a Software Bill of Materials (SBOM) for your container images using the Cortex CLI and and save the output to a specified file. This functionality enables you to store the SBOM for further analysis, auditing, and compliance. By default, this will retrieve the SBOM for an image from your local Docker daemon. To get an SBOM for an image from your local Docker daemon: Command: cortexcli image sbom: Exports a Software Bill of Materials (SBOM) document for a container image archive. Usage: cortexcli image sbom [command options] --archive-format value: Specifies the image archive format. Values: docker-archive (default), oci-archive --output-format value: Specifies the SBOM document output format. Values: json (default), xml --output-file value: Specifies the path to the file where the SBOM document will be saved --fields value [--fields value]: Specifies the fields to include in the SBOM document. Multiple fields can be specified including: author, binaries, license, name, purl, sourcePackage, type, version --help, -h: Displays help information for the command To export an SBOM from an image archive file, use the --archive flag: NAME: cortexcli image sbom - Exports an SBOM document for an image from the local Docker daemon or an image archive. USAGE: cortexcli image sbom [command options] [image name or archive file]. Docker socket not reachable: If you encounter errors indicating the Docker socket cannot be reached, ensure the Docker daemon is running and verify the path to your Docker socket. If it's not in the default location (unix:///var/run/docker.sock), use the --docker-host flag to specify the correct path Image not found: If you attempt to scan an image directly from the Docker daemon and receive an error that the image does not exist, confirm that the image is indeed present in your local Docker repository by running docker images. The CLI will not pull images 6.3.4.1 |Cloud Workload Protection command line reference This reference guide documents the Cloud Workload Protection commands and flags for the Cortex CLI, including the structure of base commands and subcommands. Refer to Cortex CLI common command line reference guide for Cortex CLI commands common to all supported modules. 6.3.5 |Cortex CLI for Code Security PREREQUISITE: For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

##### Note

* CWP does not support container image secret scanning for systems running on ARM architecture.

* For available CWP commands, refer to Cloud Workload Protection command line reference.

* --archive: When used with image scan, sets the scan source to an archive file. When used with image sbom, indicates the SBOM should be exported from an archive file The --archive flag can also be explicitly set as --archive=true --archive-format <value>: The image archive format (such as docker-archive or oci-archive). Default: docker-archive.

##### 6.3.5.1. Cortex CLI usage for Application Security

##### 6.3.5.2. Cortex CLI Application Security command line reference

###### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

###### Important

* The Cortex CLI Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id <YOUR_AUTH_ID>...

### 6.4. Cortex XSIAM 3.x Documentation

### 6.5. Reference

#### 6.5.1. Cloud service provider permissions

#### 6.5.2. Microsoft Windows security auditing setup

##### 6.5.2.1. Enable security auditing event IDs

###### Note

* We recommend you configure security auditing using Group Policy Object (GPO). Using GPO simplifies audit management and ensures that auditing settings are uniformly applied across your network, reducing the risk of misconfigurations on individual machines.

###### 6.5.2.1.1. Enable security auditing event IDs with GPO

####### Note

* We recommend that you configure the Group Policy Object (GPO) to apply to all endpoints and not just Domain Controllers. This ensures comprehensive auditing across your entire network.

####### Navigation

  Server Manager → Tools → Group Policy Management

  Computer Configuration → Policies → Windows Settings → Security Settings → Advanced Audit Policy Configuration → Audit Policies

###### 6.5.2.1.2. Set up local machine security auditing without GPO

###### 6.5.2.1.3. Additional setup for Active Directory Certificate Services (ADCS) events

####### Note

* Enabling auditing for Active Directory Certificate Services (ADCS) restarts (events 4880 and 4881) can significantly slow down the service if you have a large database. To prevent delays: Clean up the database: Remove any unnecessary entries to reduce its size. Skip this audit: If restart speed is critical, consider not enabling auditing for ADCS...

###### 6.5.2.1.4. Enable auditing access to AD domain objects - 4662

####### Note

* The Descendant msDS-DelegatedManagedServiceAccount Objects configuration is relevant only for Windows Server 2025.

##### 6.5.2.2. Enable additional event logs using Event Viewer

###### Navigation

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → User Profile Service, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → CAPI2, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → DNS Client Events, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → DriverFrameworks-UserMode, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → PowerShell, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → Windows Defender, right click Operational and select Enable Log

  In Event viewer → Application and Services Logs → Microsoft → Windows → TerminalServices-ClientActiveXCore → Microsoft-Windows-TerminalServices-RDPClient, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → Windows Firewall With Advanced Security → Firewall, right click Operational and select Enable Log

##### 6.5.2.3. Enable LDAP server events logging (1644)

###### 6.5.2.3.1. Enable LDAP server events logging using RegEdit

###### 6.5.2.3.2. Enable LDAP server events logging using GPO

####### Navigation

  Computer Configuration → Preferences → Windows Settings → Registry

###### 6.5.2.3.3. Validate log collection for LDAP Server events

#### 6.5.3. XDM fields for mapping authentication events

##### Note

* For more information on the entire Cortex Data model (XDM) schema, see Cortex XSIAM Data Model Schema.

* Do not map a static string, list, or empty string. You must map this field from the raw log field that best represents the actual source IP used in the authentication attempt. In cases where multiple IP fields are available, such as client_ip, source_ip, and original_client_ip, choose the field that captures the IP address from which the user initially...

* Mapping should be done per event type. The same system could be an IDP in one event and an SP in another.

* For more information on the event outcome constants in the Cortex Data Model, see XDM_CONST.OUTCOME.

* Outcome is based on a conclusive event type reflecting the true end state of the authentication flow.Critical for effectiveness of detection rules. Incorrect derivation can lead to missed detections or false positives.

* These are the most common values, but other logon types also exist. For a complete list, see XDM_CONST.LOGON_TYPE.

* For more information, see XDM_CONST.USER_TYPE.

* For more information, see XDM_CONST.PRIVILEGE_LEVEL.

* For more information, see XDM_CONST.OS_FAMILY.

* While xdm.network.session_id aggregates multiple user actions within a broader session window. xdm.session.context.id is used to correlate events that belong to a single authentication request or transaction.

#### 6.5.4. Cortex Network Scanner OSS

#### 6.5.5. Fair Usage policy for Cortex XSIAM


## Cortex XSIAM Premium Documentation


---

## 1. Get started with Cortex XSIAM

### 1.1. Get started with Cortex XSIAM

#### 1.1.1. Cortex XSIAM architecture

##### Note

* If you plan to stream data from a Strata Logging Service instance, it must reside in the same region as your Cortex XSIAM tenant.

### 1.2. Fair Usage policy for Cortex XSIAM

### 1.3. Cortex XSIAM product licenses

#### Note

* You can upgrade your license by purchasing add-ons or moving to a different XSIAM license.

* Full code security scanning requires a separate add-on.

* Existing users who have a Cortex XSIAM Enterprise Plus license retain all Cortex XSIAM Enterprise features, with cloud agent features. You can deploy agents for runtime detection on cloud sources, such as Kubernetes nodes, OpenShift clusters, or cloud VMs, whether in the cloud or on-premises. If you want the full cloud posture security bundle (Cloud...

#### 1.3.1. Data retention

##### Note

* Case data is retained according to the Last Updated date. Issue data is retained according to the Observation Time. Data collected within these dates is kept and displayed for 186 days. To ensure the accuracy of issues, Cortex XSIAM provides a grace period of up to 31 days for issues displayed in the Issues View, Issues table, and Cases View.

* Requires the Forensics add-on.

#### 1.3.2. Data storage lifecycle

##### Tip

* You can view details about your Cortex XSIAM licenses by selecting Settings → Cortex XSIAM License.

#### 1.3.3. License allocation

##### Note

* For Cortex XSIAM Enterprise Plus licenses, if an endpoint requires a Cortex XDR per Endpoint license, and you've exceeded the number of available Cortex XDR per Endpoint licenses, one of your surplus Cloud per Host licenses is automatically consumed as a Cortex XDR per Endpoint license for the endpoint. After utilizing all available XDR per Endpoint...

* It can take up to an hour for Cortex XSIAM to display revived assets.

#### 1.3.4. License expiration

#### 1.3.5. Upgrade your tenant

### 1.4. Security Operations Center roles and responsibilities

### 1.5. In-product support case creation

#### Note

* When opening a support case through the Customer Support Portal, you need to manually select Cortex XSIAM as the product. While there may be discrepancies between the categories in this wizard and the Customer Support Portal process, that's because this wizard is designed specifically to focus on options relevant to Cortex XSIAM.

* Selecting an endpoint from the endpoint table and retrieving TSF requires full Retrieve Endpoint Data permissions under Endpoint Administration.

* Console recordings cannot exceed 10 minutes. The current recording time is displayed at the top of the window.

### 1.6. Supported web browsers

### 1.7. Use the interface

#### Note

* Each SAML login session is valid for 8 hours. Some menu items only appear if you have the relevant license.

* CMD fields have a 128-character limit. Shorten longer query strings to 127 characters and add an asterisk (*).

* Deleting a shared view removes it for all users.

### 1.8. What is Cortex Gateway?

## 2. Onboard and configure Cortex XSIAM

### 2.1. Deployment steps

#### 2.1.1. Cortex XSIAM onboarding checklist

##### Note

* This checklist does not include any specific Cloud Security requirements. If you have a Cortex XSIAM Premium license or another XSIAM license with Cloud Posture Security/Runtime, you should also onboard Cloud Posture Security and Runtime during or after completing this stage. For more information about Cloud Security onboarding, see Ingest cloud assets.

* You need EDR or network logs from at least 30 endpoints over a minimum of 2 weeks, or Cloud audit logs over a minimum of 2 weeks.

* The Cloud Identity Engine must be set up.

#### 2.1.2. Activate Cortex XSIAM

##### Prerequisite

* The Cortex XSIAM activation email. A Customer Support Portal (CSP) account. You need to set up your CSP account. For more information, see How to Create Your CSP User Account. When you create a CSP account, you can set up two-factor authentication (2FA) to log into the CSP by using an Email, Okta Verify, or Google Authenticator (non-FedRAMP accounts)....

##### Note

* When you activate, a production tenant is first activated. After activation, you can set up a development tenant (subject to your license).

* Activation can take about an hour and does not require you to remain on the activation page. Cortex XSIAM sends a notification to your email when the process is complete.

* If you want to change your tenant's name, the subdomain, or activate a development tenant (subject to license), on the right-hand side, click the ellipsis. You can only change the subdomain once, and it cannot be undone. After deleting the subdomain, you can reuse it after 7 days.

##### 2.1.2.1. Bring your own keys

###### Prerequisite

* Access to BYOK (Bring Your Own Keys) functionality is restricted to tenants that were initially activated with BYOK.

* To disable your encryption keys and deactivate a tenant, you must have an Account Admin role.

###### Note

* The new keys you import will serve as primary encryption keys for newly generated data.

* At any stage, you can select Continue Later to pause the process. To resume the process, in the Cortex gateway, select Continue Setup next to the tenant, and follow the wizard instructions from the point you left off, as detailed below. If you don't use either of your wrapping keys within three days, they expire and you'll have to restart the process.

* BYOK requires a 32-byte, symmetric, unencoded key in binary format.

###### Caution

* Disabling all encryption keys and deactivating the tenant renders the tenant inaccessible and non-operational. Disabling the keys affects the communication with the agents, may prevent the agents from receiving updates to policies, configurations, and crucial information, and may result in loss of data. To secure your tenant data and to prevent...

##### 2.1.2.2. Cortex XSIAM supported regions

##### 2.1.2.3. Enable access to required PANW resources

###### Note

* <tenant-name> refers to the selected subdomain of your Cortex XSIAM tenant, and <region> is the region in which your tenant is deployed. For more information, see Cortex XSIAM supported regions.

###### Navigation

  SSL decryption: If you use SSL decryption and experience difficulty connecting the Cortex XDR agent to the server, we recommend that you add the FQDNs required for access to your SSL Decryption Exclusion list in Device → Certificate Management → SSL Decryption Exclusion

#### 2.1.3. Set up users and roles

##### Note

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* The user who activated the Cortex product is assigned the Account Admin role. You cannot create additional Account Admin roles in the Cortex XSIAM tenant. If you do not want the user to have Account Admin permission, you must remove the Account Admin role in Cortex Gateway.

##### 2.1.3.1. User group management

###### Note

* You can create user groups in the tenant or Cortex Gateway. User groups created in Cortex Gateway cannot be mapped to SAML groups. Only user groups created in the tenant support SAML group mapping and scoring. We recommend creating user groups in the Cortex tenant because: User groups are available for all tenants, and you may want different user...

* If users have been created in the CSP, but you want them to access the tenant through SSO only, skip this field and add only SAML group mapping after SSO is set up, otherwise, users can access the tenant through both the CSP and SSO. If you have not yet created any users, skip this field and add them later. See Set up authentication .

* When using Azure AD for SSO, the SAML group mapping needs to be provided using the group object ID (GUID) and not the group name.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* For optimal performance, we recommend using a single field in the filter definition and simple comparison operators.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

##### 2.1.3.2. Assign user roles and groups

###### Note

* If an existing user in the Cortex Gateway no longer has a role or a user group assigned, the user is revoked. Any roles, user groups, or egress configurations created by that user are shown as created by Revoked user instead of the user's email address.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Setting Cortex Query Language (XQL) dataset access permissions for a user role can only be performed from Cortex XSIAM Access Management. For more information, see Manage user roles.

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* For optimal performance, we recommend using a single field in the filter definition and simple comparison operators.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit Users Permissions.

#### 2.1.4. Set up authentication

##### Tip

* You should have at least one user in the Customer Support Portal for backup, in case of any authentication issues with your IdP provider.

##### 2.1.4.1. Authenticate users through the Customer Support Portal

###### Note

* You must be assigned the Super User role in the Customer Support Portal to add users in the Customer Support Portal. The first Super User who logs into Cortex Gateway is automatically assigned the Account Admin role and has access to the tenant. The user who activates the Cortex XSIAM tenant will also be assigned the Account Admin role (if there is no...

* After users are added to the Customer Support Portal and they accept the invitation, you can manage them in Cortex Gateway or the Cortex XSIAM tenant.

##### 2.1.4.2. Authenticate users using SSO

###### Note

* To set up SSO authentication in the tenant, you must be assigned an Instance Administrator or Account Admin role. SAML 2.0 users must log in to Cortex XSIAM using the FQDN (full URL) of the tenant. To allow login directly from the IdP to , you must set the relay state on the IdP to the FQDN of the tenant. If you have multiple tenants, you must set up...

* The first SSO cannot be deleted, it can only be deactivated by toggling SSO Enabled to off. The Domain parameter is predefined for the first SSO. If you add additional SSO providers, you must provide the email Domain in the SSO Integration settings for all providers except the first. Cortex XSIAM uses this domain to determine to which identity provider...

* Cortex XSIAM requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex XSIAM. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a...

##### 2.1.4.3. Set up Okta as the Identity Provider Using SAML 2.0

###### Note

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Navigation

  Settings → Configurations → Access Management → Authentication Settings

  Settings → Configurations → Access Management → User Groups

##### 2.1.4.4. Set up Azure AD as the Identity Provider Using SAML 2.0

###### Note

* The default attributes shown on the main single sign-on page in Azure AD are not the values you need. You must click Edit next to Attributes and Claims to view and copy the actual values.

* The attribute claim name must exactly match the value sent by your IdP. In some cases, this may be the full attribute name/namespace, depending on the configuration of our IdP

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Important

* When copying the Single Sign-On URL value, remove idp/saml and leave the trailing /. For example, if the Single Sign-On URL is https://clientname.panproduct.region.paloaltonetworks.com/idp/saml, just copy https://clientname.panproduct.region.paloaltonetworks.com/.

###### Navigation

  Settings → Configurations → Access Management → User Groups

#### 2.1.5. Configure content

#### 2.1.6. Set up Cloud Identity Engine

##### Note

* The Activate risk signal sharing to CIE checkbox is available only after the second step is completed.

##### Navigation

  Settings → Configuration → Integrations → Cloud Identity Engine

#### 2.1.7. Install Cortex XDR agents

##### 2.1.7.1. Create an agent installation package

###### Note

* The profile will be applied if the security policy cannot be retrieved in real-time.

* The Cortex serverless library must be imported after other libraries to activate the hooks that enable auditing.

##### 2.1.7.2. Deploy agent installation packages

##### 2.1.7.3. Endpoint data collection

###### Note

* For specific files only and only if the file was written.

###### Important

* Registry key is collected as a real key name, and not as a symbolic link. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, KEY_LOCAL_MACHINE\System\ControlSet001 will be collected. Instead of HKEY_CURRENT_USER, HKEY_USERS\<SID> will be collected, where SID is a SID of the current user.

##### 2.1.7.4. Configure global agent settings

###### Note

* Disabling this capability takes immediate effect on new hashes, fresh agent installations, and existing security policies. It could take up to a week to take effect on existing agents in your environment pending agent caching.

* If you have any Cortex XSIAM filters, starring policies, exclusion policies, scoring rules, log forwarding queries, or automation rules configured for XSOAR/3rd party SIEM, we advise you to update those to support the changes before activating the feature. For example, change the query to include the previous description that is still available in the...

##### 2.1.7.5. Define endpoint groups

###### Note

* Disconnecting Cloud Identity Engine in your Cortex XSIAM deployment can affect existing endpoint groups and policy rules based on Active Directory properties.

##### 2.1.7.6. Manage endpoint profiles

##### 2.1.7.7. Guidelines for keeping Cortex XDR agents and content updated

###### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups. See how to define endpoint group.

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups.

###### Important

* When planning Cortex XDR agent upgrades and content updates, consult with the appropriate stakeholders and teams and follow the change management strategy in your organization.

###### Caution

* Before enabling Auto-Update for Cortex XDR agents, make sure to consult with all relevant stakeholders in your organization.

#### 2.1.8. Cortex XSIAM - Analytics

##### Prerequisite

* Before Cortex XSIAM - Analytics can start to analyze your endpoint data, perform the following steps: Configure Cortex XSIAM network parameters to monitor your internal networks. Enable the Analytics Engine. Make sure Cloud Identity Engine is set up. Enable Identity Analytics.

##### 2.1.8.1. Configure Cortex XSIAM network parameters

###### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

###### Navigation

  Inventory → Assets → Network Configuration → Internal Domain Suffixes

##### 2.1.8.2. Enable the Analytics Engine and Identity Analytics

###### Prerequisite

* Analytics Engine To create a baseline for enabling analytics, Cortex XSIAM requires a minimum of one of the following data sets: EDR or Network logs from at least 30 endpoints over a minimum of 2 weeks Cloud audit logs over a minimum of 5 days Identity Analytics Cortex XSIAM - Analytics must be activated. Cloud Identity Engine must be set up. For more...

###### Navigation

  Settings → Configurations → Cortex XSIAM - Analytics

### 2.2. Post-deployment steps

#### 2.2.1. Perform health checks

##### 2.2.1.1. Monitor agent operational status in Cortex XSIAM

###### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex XSIAM management console for specific reasons for the state.

###### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

#### 2.2.2. Set up your environment

##### 2.2.2.1. Configure server settings

###### Note

* Keyboard shortcuts, timezone, and timestamp format are not set universally and only apply to the user who sets them.

* The Cortex Agentic Assistant and AI case summarization are currently available for users in limited regions. For more information, see Cortex Agentic Assistant.Cortex Agentic Assistant

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Requires the TIM add-on. By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled.

* Requires an MSSP License and RBAC permissions to Cases & Issues and Investigation & Response → Automation. This setting is available for the parent tenant only.

###### Navigation

  Settings → Configurations → General → Server Settings

##### 2.2.2.2. Configure security settings

###### Navigation

  Settings → Configurations → General → Security Settings

##### 2.2.2.3. Log forwarding

###### 2.2.2.3.1. Forward logs from Cortex XSIAM to external services

####### License Type

  Requires an XDR Agent.

####### 2.2.2.3.1.1. Integrate a syslog receiver

######## Note

* Up to TLS 1.3 is supported. Make sure the self-signed CA includes your public key.

####### 2.2.2.3.1.2. Integrate Slack for outbound notifications

######## Note

* You are directed to the Slack browser to install Cortex XSIAM. You can only use this link to install Cortex XSIAM on Slack. Attempting to install from Slack Marketplace will redirect you to Cortex XSIAM documentation.

####### 2.2.2.3.1.3. Configure notification forwarding

######## Prerequisite

* Before you can select a syslog receiver or a Slack channel, you must integrate these external services with Cortex XSIAM. For more information, see: Integrate a syslog receiver Integrate Slack for outbound notifications

######## Note

* Notification Forwarding by Domain: To configure notification forwarding for issues by domain, select Log Type = Issues and filter the Issues table by Issue Domain. Case IDs in Notifications: If case matching completes before the notification is sent, the Case ID is included. If matching takes longer than the notification trigger, the notification is...

* This option will be deprecated in the next release. Configure issues with the filter Issue Domain = Health instead.

####### 2.2.2.3.1.4. Monitor administrative activity

###### 2.2.2.3.2. Data and log notification formats

####### Note

* Issues can be forwarded to email, syslog servers, and Slack in the alert format, if you prefer. The alert format can be selected when you configure your forwarding notification.

####### 2.2.2.3.2.1. Management audit log messages

####### 2.2.2.3.2.2. Issue notification format

####### 2.2.2.3.2.3. Agent Audit log notification format

####### 2.2.2.3.2.4. Management Audit log notification format

####### 2.2.2.3.2.5. Log format for IOC and BIOC issues

####### 2.2.2.3.2.6. Analytics log format

#### 2.2.3. Remote repository management

##### 2.2.3.1. Cortex XSIAM development tenant

###### Important

* Development tenants are not intended for performance checks; they cannot access production data, and they are connected to a limited number of endpoints. As a result, all development tenants have fewer resources than the production tenant, including data ingestion capacity and performance, and compute capabilities. In a development tenant, extreme...

##### 2.2.3.2. Set up a remote repository

###### Navigation

  If the content repository option is disabled for the production or development tenant (under Settings → Configurations → General → Remote Repository Settings, toggle the Content repository slider to off), the tenant becomes standalone and does not push or pull content

  If you are changing your remote repository settings, back up existing content to your local computer by navigating to Settings → Configurations → General → Server Settings → Custom Content and click Export all custom content

###### 2.2.3.2.1. Set up a built-in remote repository

####### Note

* Once enabled, development tenants have a red banner on the top left showing DEV.

* The first tenant that is enabled pushes its content to the remote repository first. For example, these instructions describe enabling the production tenant first, so the remote repository will initially contain production tenant content. You can enable a development tenant first if you want the remote repository to initially contain the content from...

####### Navigation

  Settings → Configurations → General → Remote Repository Settings and toggle the Content repository slider to enable the remote repository

###### 2.2.3.2.2. Set up a Private Remote Repository

####### Note

* Once enabled, the development push tenant has a red banner on the top left showing DEV.

* For repository vendors that use tokens, enter the token type in the username field and the token in the password field. Verify details with your vendor. If your private Git remote repository uses personal access tokens instead of usernames and passwords, enter the token type in the username field and the access token in the password field. For example,...

* You can't add an engine that has been added to a Load-Balancing Group.

* If your private Git remote repository uses personal access tokens instead of usernames and passwords, enter the access token in the password field and leave the username field blank. For repository vendors that use tokens, the token type is entered in the username field and the token is entered in the password field. Verify details with your vendor. If...

* The first tenant that is enabled pushes its content to the remote repository first. For example, these instructions describe enabling the production tenant first, so the remote repository will initially contain production tenant content. You can enable a development tenant first if you want the remote repository to initially contain the content from...

####### Tip

* Due to security concerns, there is a closed allow list of approved URLs for private repositories. If you want to use a URL that is excluded from the allow list, use an engine (engine groups are not supported).

##### 2.2.3.3. Push and pull content

###### Navigation

  Settings → Configurations → Remote Repository Content → User-Defined Content

##### 2.2.3.4. Remote repository troubleshooting

#### 2.2.4. Manage user roles and access management

##### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

##### Note

* For more information on assigning user roles when generating an API key, see Manage API keys.Manage API keys

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* For features where scoping is not applicable, Role-Based Access Control (RBAC) is used and can be configured when managing user roles. For more information, see Manage user roles.

##### 2.2.4.1. Manage user roles

###### Prerequisite

* Managing user roles in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Navigation

  Settings → Configurations → Access Management → Roles

##### 2.2.4.2. Manage user access

###### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Note

* You can only reduce the permissions of an Account Admin user via Cortex Gateway.

* User permissions for components and datasets are based on the access permissions set in the user role. For more information on editing these user role permissions, see Manage user roles.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* For optimal performance, we recommend using a single field in the filter definition and simple comparison operators.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit User Permissions.

###### Navigation

  Settings → Configurations → Access Management → Users

###### 2.2.4.2.1. User access reference information

##### 2.2.4.3. Manage user scope

###### Prerequisite

* Configuring user scopes in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles. By default, Enable Scope Based Access Control is...

###### Note

* This configuration can impact the visibility of the related Security domain in the Cases and Issues scope area, but with not affect asset visibility.

* Whenever a user's SBAC permissions are changed, Cortex XSIAM logs this event in the audit logs (Settings → Management Audit Logs). These monitored activity events are found on the Management Audit Logs table by filtering the Type column by Permissions and Subtype column by Scope Edit.

* XQL-based dashboard widgets may require a few hours to initially reflect changes to the list or definitions of asset groups used for scoping. To view the most current data immediately, refresh the dashboard or its XQL widgets.

* For Cases and Issues domains, a workaround is to create a Dataset View for each required combination of domains, and allow the relevant entity access only to this Dataset View, not to the underlying cases and issues datasets.

* This feature is included with a Cortex XSIAM Premium, Enterprise, and NG-SIEM licenses.

* Make sure to assign the required default granular scoping for users. This depends on the structure and divisions within your organization and the particular purpose of each organizational unit to which scoped users belong.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Some areas and features in Cortex XSIAM do not respect SBAC. In these cases, use RBAC permissions to restrict access.

* Action Required: Recent security enhancements enforce stricter default permissions for cases and issues that lack specific asset or endpoint references. This notice explains how to include access to these items if your users' visibility has been impacted.

* Before configuring, ensure that you review the Understand scoping section.

* For optimal performance, we recommend using a single field in the filter definition and simple comparison operators.

#### 2.2.5. Configure the Cortex Agentic Assistant

##### 2.2.5.1. Agentic Assistant components and concepts

###### Note

* Agents are bound by the same rules and robust permissions as a human user. In addition, you can mark actions that make real-world changes in production systems as sensitive, requiring a quick manual review and confirmation, ensuring peace of mind before critical system changes are made.

##### 2.2.5.2. Agents Hub

###### Note

* To manage agents in the Agents Hub, you must have the proper permissions. For more information, see Agentic Assistant role-based access control.

###### 2.2.5.2.1. Manage actions

####### Note

* To manage actions in the Agents Hub, you must have the correct permissions. For more information, see Agentic Assistant role-based access control.

###### 2.2.5.2.2. Register actions

####### Note

* To register actions, ensure you have the correct permissions. For more information, see Agentic Assistant role-based access control.

* Mandatory arguments cannot be deselected.

####### Important

* A single content item can be registered as different actions, with each action using different inputs and outputs from the same script. Only register the same script, command, or AI prompt as a new action if it is required for your use case, as providing an agent with many actions with overlapping abilities can reduce the ability of the agent to choose...

###### 2.2.5.2.3. Manage agents

####### Note

* In some cases, an agent may include actions with content items that are not relevant for all licenses. If that occurs, the grey circle appears, but you are not able to install the related content.

###### 2.2.5.2.4. Build agents

####### Note

* To build agents in the Agents Hub, you must have view/edit permissions. For more information, see Agentic Assistant role-based access control.

* If you clear the checkbox for a role, all actions associated with that role are also cleared. The exception is if another role is also selected, which is associated with the same actions. If you clear the checkbox for an action, all roles associated with that action are cleared. For example, if you select the Investigator role, and Send Mail and Tavily...

* Only users with view/edit permissions for scripts can register actions.

###### 2.2.5.2.5. Expand agent capabilities with MCP integrations

####### Note

* If you are using OAuth-based authentication, the Test button returns an error containing the command to run in the playground in order to test the connection.

* If an MCP tool is removed from the MCP server, the action will be unavailable due to missing content. If the tool is restored on the MCP server, the action is automatically reenabled. If you have a development and a production tenant, you can push actions created from MCP tools from development to production.

####### Navigation

  Settings → Configurations → Data Collection → Integration Permissions

##### 2.2.5.3. Agentic Assistant role-based access control

#### 2.2.6. Dashboards and reports

### 2.3. Cortex MCP server

#### 2.3.1. Cortex MCP server overview

##### Note

* This feature is in Beta.

* The Cortex MCP Server empowers you to integrate AI into your security workflows using natural language. When using LLM-based suggestions, always review and approve actions suggested by the AI before they're executed. We recommend deploying the Cortex MCP server in a secure environment where access is limited to authorized users.

##### 2.3.1.1. Install the Cortex MCP server

###### Prerequisite

* If you are running the Cortex MCP server in a Poetry virtual environment, you must have Python 3.13 or higher. If you plan to run the Cortex MCP server in a Docker container, you must have Docker installed.

###### Note

* The MCP Server uses public APIs to communicate and is limited by the license quotas available in your tenant. This is particularly relevant when running XQL queries. For more information on running XQL query APIs, see Run XQL query APIs.

* It is critical to avoid assigning excessive permissions when creating an API key for the Cortex MCP Server. Since the key has both read and write capabilities, overly broad permissions can lead to unintended actions and potentially compromise your environment. Ensure the key follows the principle of least privilege and is granted only the minimum...

* When using Docker, we recommend using an .env file to set the Cortex API credentials as environment variables. While the credentials can be provided in the MCP client configuration settings, the .env file provides safer handling of API credentials and makes your configuration easily reproducible.

* By default, stdio (standard input/output) is used. You can also configure Streamable HTTP, to send requests directly to the tenant instead of through the MCP client. Streamable HTTP can be useful for testing in the browser without a MCP client and to bypass limits that may be in place for your MCP client. For Docker, you can include the Streamable HTTP...

###### Important

* To configure the Cortex MCP Server, you need the Cortex API URL, Cortex API key, and Cortex API key ID. You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

##### 2.3.1.2. Configure the MCP client

###### Navigation

  Settings → Developer → Edit Config

##### 2.3.1.3. Use the Cortex MCP server

###### Note

* The built-in tools retrieve information, but do not write to the tenant. You can create your own tools that include write actions. The examples below include both.

##### 2.3.1.4. Create custom Cortex MCP server tools

###### Note

* Any new or updated components provided by Cortex are automatically downloaded into the remote_components folder.  During each update, the folder is fully replaced and all existing contents are recreated. Do not add custom tools to this directory, as it is managed entirely by Cortex and is overwritten at every update.

### 2.4. Automations

#### 2.4.1. Automation in Cortex XSIAM

##### Note

* You can build end-to-end automation workflows from within the playbook editor, including creating automation rules, configuring integration instances, and creating and editing tasks. For more information, see Playbooks.

#### 2.4.2. Quick Actions

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### 2.4.3. Automation Exclusion Center

##### Note

* By default, all users have read and edit permissions to lists. When creating a list of critical assets, we recommend limiting the read and edit permissions to specific roles.

##### 2.4.3.1. Manage automation exclusion policies

###### Note

* For the IAM User Hard Remediation and User Soft Remediation policies, we recommend including username, email, and ID for each user you want to exclude. Example: username1, user@example.com, userID112.

* You can also right click on a policy from the main Automation Exclusion Center page to disable or enable the policy. If you click on a list name in the Exclude column, that list opens in the Lists page.

#### 2.4.4. Playbooks

##### Prerequisite

* To provide playbook access, ensure the Playbooks RBAC permission is set to View or View/Edit. To completely restrict playbook access, first set the Cases & Issues RBAC permission to None and then set the Playbooks permission to None. Conversely, to provide access to cases and issues, first set the Playbooks permission to View or View/Edit (and then set...

##### 2.4.4.1. Playbooks overview

##### 2.4.4.2. Playbook development checklist

##### 2.4.4.3. Plan your playbook

##### 2.4.4.4. Manage playbooks

###### Note

* The library by default shows only playbooks that are not adopted. Click the Show Adopted checkbox to show the adopted playbooks, indicated by an Adopted mark. The library shows the most updated playbook version. Adopting an older version than shown should be done through Marketplace. Adopting a playbook does not make it run. Some content packs include...

##### 2.4.4.5. Build your playbook

###### 2.4.4.5.1. Task 1. Choose from existing playbooks or create your own

####### Note

* When a task inside of a sub-playbook is not configured, the alert is propagated to the main playbook. If multiple sub-playbooks are nested, and any of the sub-playbooks have non-configured components, the alert appears in the main playbook as well as in the sub-playbooks. Alerts also appear for the individual non-configured tasks within the...

####### Tip

* If there are additional relevant playbooks in Marketplace that are not in your Org repository, you can click Explore them now to see them in the Playbook Catalog and choose to adopt.

* To open multiple playbooks at the same time, edit the first playbook and then click New next to the playbook name to create a new tab. You can either create a new playbook, or add an existing one. You can view recently modified or deleted playbooks by clicking version history for all playbooks .

####### Navigation

  the Investigation & Response → Automation → Playbooks page to find an existing playbook, customize it, or create a playbook

###### 2.4.4.5.2. Task 2. Configure playbook settings

####### Note

* If the playbook has inputs and outputs, the Playbook Starts task will show back and forth arrows. Clicking them opens the Playbook Settings pane Inputs/Outputs tab.

* This rule will trigger the playbook to run if no other Automation Rule triggers the playbook first. You can view and edit the order the rules run in the Automation Rules page.

* If you do not add any fields, the group will be deleted when you click Save.

###### 2.4.4.5.3. Task 3. Add objects from the Task Library

####### 2.4.4.5.3.1. Add Quick Actions, commands, and scripts

######## Note

* If the Quick Action requires an integration instance and it is not yet configured, you have the option to create an integration instance from within the playbook editor.

* If you want to add a script that is not yet adopted, Cortex XSIAM automatically installs the content pack containing the script. If the script requires an integration instance, you are prompted to configure one.

* If you do not have permission to download the script, contact your administrator for help. You can also filter by "show only configured" to show scripts you can use.

* Commands you run in the War Room can automatically populate parameters such as region, account ID, and tags, based on asset data. Commands can reference UIA attributes for the relevant asset(s) in the issue context and use those attributes as input. The issue must contain the relevant Asset ID. The syntax to reference attributes in the UAI is...

* The output value is dynamic and is derived from the context at the time that the task is processed. As a result, parallel tasks that are based on the same output may return inconsistent results.

######## Tip

* If your needs require a custom script, use the Agentic Assistant with the Automation Engineer agent to leverage the Cortex AgentiX built-in LLM to quickly and efficiently generate functional Python scripts from natural language prompts. For more information, see Create a script.

####### 2.4.4.5.3.2. Add sub-playbooks

######## Tip

* Balance between the number of iterations and the interval so you do not overload the server.

####### 2.4.4.5.3.3. Add AI prompt tasks

######## Note

* Selecting Local AI Prompt creates a local version of the task within your playbook. Any future updates made to the Prompts Library will not sync to this specific task. Choose Local AI Prompt if you need to customize the logic for a specific workflow and want to ensure its behavior remains unchanged, even if the Prompts Library is updated with...

####### 2.4.4.5.3.4. Add manual tasks and blank tasks

######## 2.4.4.5.3.4.1. Create a standard task

######## 2.4.4.5.3.4.2. Create a conditional task

######## 2.4.4.5.3.4.3. Create a communication task

####### 2.4.4.5.3.5. Create a section header

####### 2.4.4.5.3.6. Configure script error handling in a playbook

######## Note

* Use the GetErrorsFromEntry script (part of the Common Scripts Pack) to check whether the given entry returns an error and returns an error message. For example, when using the script in a playbook, you can fetch the error message from a given task, such as a runtime error. You can then add a step in the playbook flow to send those error messages to the...

* You can set up script error handling only when running a script in a Standard task or a Conditional task. For more information about error handling settings for these tasks, see Create a standard task or Create a conditional task. Built-in, Manual, and Ask Conditional tasks have On Error settings for number of retries and retry interval, but not Error...

###### 2.4.4.5.4. Task 4. Add custom playbook features

###### 2.4.4.5.5. Task 5. Test and debug the playbook

###### 2.4.4.5.6. Task 6. Manage playbook content

##### 2.4.4.6. Customize your playbook

###### 2.4.4.6.1. Configure a sub-playbook loop

####### Note

* Consider the following when adding a loop: The maximum number of loops (default is 100). A high number of loops or a high wait time combined with a large number of issues may affect performance. Periodically check looping conditions to ensure they are still valid for the data set. If you want a sub playbook task to loop over an array passed into its...

####### Tip

* Balance between the number of iterations and the interval so you do not overload the server.

###### 2.4.4.6.2. Filter and transform data

####### Caution

* You can change the context data root to filter, but it is not recommended to select a different root, as it affects the filter results. The drop-down list displays the filter root for backward compatibility.

####### Navigation

  Investigation & Response → Automation → Scripts → New Script

####### 2.4.4.6.2.1. Filter considerations, categories, and built-in filters

######## Note

* Is defined considers false and empty strings and lists to be defined values. If you don't want those to be included as defined, use Is not empty.

* Not defined considers false and empty strings and lists to be defined values. If you don't want those to be included as defined, use Is empty.

####### 2.4.4.6.2.2. Transformer considerations, categories, and built-in transformers

######## Note

* To make regex case non-sensitive, use the (?i) prefix (for example (?i)yourRegexText.

###### 2.4.4.6.3. Extend context

###### 2.4.4.6.4. Extract indicators

####### Note

* This configuration may delay playbook execution (issue creation). While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

###### 2.4.4.6.5. Update issue fields with playbook tasks

####### Note

* The setIssue script includes all available fields; use the scroll bar to see all the fields. The name field has a limit of 600 characters. If there are more than 600 characters, you can shorten the name field to under 600 characters and then include the full information in a long text field such as the description field. There are many fields already...

##### 2.4.4.7. Test your playbook

###### Note

* The debugger does not support using parentIncidentFields.

* Using an existing issue in the debugger does not affect the original issue or change the original context data.

###### 2.4.4.7.1. Troubleshoot playbook performance

##### 2.4.4.8. Manage playbook content

###### Note

* Opening a playbook does not immediately lock it. A playbook is considered to be in edit mode only when a user makes a modification that causes the Save button to become available.

###### Important

* Manually unlocking a playbook may cause version conflicts. This turns off concurrent editing protection, and if the original user is still editing, their changes might be lost or overwritten.

###### Navigation

  Investigation & Response → Automations → Playbooks

##### 2.4.4.9. Best practices

###### Note

* If you reattach a detached playbook, any customizations you have made to the playbook will be overwritten when the playbook updates to the current version.

* Retries are not supported for data collection tasks that have errors sending emails (indicated by a server timeout). This is because retries only work on automation execution failures, not on email delivery issues.

#### 2.4.5. AI Prompts

##### Navigation

  On the AI Prompts page (Investigation → Response → Automation → AI Prompts), you can view, edit, and manually create prompts

##### 2.4.5.1. AI prompts role-based access control

##### 2.4.5.2. Use existing prompts

###### Navigation

  Investigation & Response → Automation → AI Prompts and in the Prompts Library search for the prompt you want to use

##### 2.4.5.3. Create a prompt

###### Navigation

  Investigation & Response → Automation → AI Prompts and click + New Prompt

#### 2.4.6. Create an automation rule

##### Note

* You can also define the conditions that trigger a specific playbook in the playbook editor. For more information, see Task 2. Configure playbook settings

* Quick Actions, by default, run using all available integration instances that contain the command. When selecting a Quick Action for an automation rule, you can instead choose one specific integration instance to use.

##### Important

* Automation rules apply to Medium and higher severity issues. They also apply to Low severity Analytic issues and Low severity ABIOC issues that are tagged with Identity or Cloud. Rules are evaluated in order, and only the first rule that matches the trigger conditions is executed.

#### 2.4.7. Scripts

##### Prerequisite

* To provide scripts access, ensure the Scripts RBAC permission is set to View or View/Edit. To completely restrict scripts access, first set Playbooks and Playground RBAC permissions to None and then set the Scripts permission to None. Conversely, to provide access to playbooks or the Playground, the Scripts permission must first be set to View or...

##### Important

* The Automation Engineer agent is available when the Agentic Assistant feature is enabled, for users with script editing permissions. For more information, see Cortex Agentic Assistant and Agentic Assistant role-based access control.Cortex Agentic Assistant

##### Navigation

  On the Scripts page (Investigation → Response → Automation → Scripts), you can view, edit, and create scripts in JavaScript, Python, or PowerShell

##### 2.4.7.1. Use existing scripts

###### Navigation

  Investigation & Response → Automation → Scripts and in the Scripts Library search for the script you want to use

##### 2.4.7.2. Create a script

###### Note

* You can enable/disable a script in the Settings without having to duplicate the script. You can view recently modified or deleted scripts by clicking the version history for all scripts .

###### Important

* If you choose Python, from the Agentic Assistant you can use the Automation Engineer agent.

###### Tip

* If there is an error, you can copy the error message from the test result into the Agentic Assistant prompt and ask the Automation Engineer agent to correct the error.

##### 2.4.7.3. Use the Automation Engineer agent to accelerate script development and deployment

###### Note

* The Automation Engineer agent is available with the Cortex Agentic Assistant, for users with script editing permissions. For more information, see Cortex Agentic Assistant and Agentic Assistant role-based access control.Cortex Agentic Assistant

* If you make manual edits in the script and don't save the changes and you then modify the script with the Automation Engineer agent, you are prompted to confirm overwriting the manual edits.

###### Tip

* Use detailed prompts, for example, Get failed logins from last 24 hours and return as a table. Clearly define argument names, types, and default values. Mention if you expect the output in a specific format, such as a table, JSON, or plain text.

* If there is an error, you can copy the error message from the test result into the Agentic Assistant prompt and ask the Automation Engineer agent to correct the error.

##### 2.4.7.4. Change the Docker image in an integration or script

###### Note

* You can access publicly available Docker images from the Cortex XSIAM tenant even if there is no external connection to the Demisto registry, for example, if due to firewall constraints, your engine cannot access the Demisto registry.

#### 2.4.8. Context data

##### 2.4.8.1. Issue context data

##### 2.4.8.2. Case context data

##### 2.4.8.3. Search context data

##### 2.4.8.4. Add context data to an issue

##### 2.4.8.5. Add context data to a case

###### Note

* If you run the command in the issue War Room, the data is added to the following places: The case context data. The issue context data under the case tab. If you run the command in the Case War Room, the data is added to the case context data only.

##### 2.4.8.6. Delete context data from a case

##### 2.4.8.7. Use context data in a playbook

###### Note

* Generic polling does not work if a playbook's context data is shared globally. For more information, see Playbook polling.Playbook polling

###### Caution

* Users with Trigger Playbook permissions on a given issue may still be able to modify the parent case via commands and scripts, even without full access to the case.

#### 2.4.9. Lists

##### Note

* The maximum size of a list is 209715 characters.

##### 2.4.9.1. Create a list

###### Note

* If you intend to use the list as part of an Automation Exclusion Policy, we recommend choosing specific roles for read and edit access. For more information on using lists in exclusion policies, see Manage automation exclusion policies.

* If you want to edit a list from a content pack, you need to duplicate or detach a list. Detached lists do not receive updated content in subsequent Cortex XSIAM content releases. To retain an updated list, reattach it.

##### 2.4.9.2. List commands

##### 2.4.9.3. Use cases: JSON lists

###### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

  Investigation & Response → Automation → Playbooks → New Playbook

##### 2.4.9.4. Transform a list into an array

###### Navigation

  Investigation & Response → Automation → Playbooks and create or edit a playbook

#### 2.4.10. Jobs

##### 2.4.10.1. Manage jobs

###### Note

* Only Account Admins and Instance Administrator roles can create jobs and view/edit job runs. If the owner of a job has been removed from Cortex XSIAM, the job will fail to run. In this case, you must change the owner to a current user.

##### 2.4.10.2. Create a time triggered job

###### Note

* To view a human readable description of a cron schedule for an existing job, click  and select Job Schedule from the available columns.

###### Important

* We recommend to avoid triggering a job while a previous run of the job is active by configuring the playbook a job triggers to close the investigation before running a new instance of the job.

##### 2.4.10.3. Create a job triggered by a delta in a feed

###### Note

* A job triggered by a delta in a feed runs only if there is a change in the feed, and does not run on a feed's initial fetch. For the initial fetch, you can run the playbook manually and then set up an event triggered job for subsequent fetches. If you want to trigger a job after a feed completes a fetch operation and the feed does not change...

###### Navigation

  Investigation & Response → Automation → Jobs → New Job

### 2.5. XQL query management

#### Prerequisite

* Setting query limits requires View/Edit permissions for Configurations → Query Management.

#### Note

* A scheduled query or report is run on behalf of the user that originally created it, even if it is edited and run by another user.

* Queries run by correlation rules are not restricted by the query limit. Very short queries do not count towards concurrent queries.

* To ensure optimal system performance, all queries (user-generated and otherwise) adhere to a default timeout limit of 60 minutes that is defined by Palo Alto that takes priority over the administrator defined value. Therefore, regardless of the value specified in this field, queries will be stopped after 60 minutes. You can override the default timeout...

* Query visibility is subject to Role-Based Access Control (RBAC); users can't see queries for datasets they do not have permission to access.

#### Navigation

  You can find Query Management options under Settings → Configurations → General → Query Management

## 3. Endpoint security

### License Type

  Requires one of the following licenses Cortex XSIAM Premium Cortex XSIAM Enterprise Any other Cortex XSIAM license with the Cloud Runtime Security add-on or the Enterprise Runtime Security add-on

### 3.1. Endpoint protection

#### 3.1.1. Malware protection

##### Note

* From Cortex XDR agent for Android version 9.0 and later, part of this module, which performs local analysis on the Android device itself, is deprecated. APK analysis will be handled only by Wildfire.

#### 3.1.2. Exploit protection

#### 3.1.3. File analysis and protection flow

##### Note

* To enhance performance and efficiency, hash verdict requests from the Cortex XDR agent will be routed to the WildFire service with the lowest latency. File uploads for analysis will strictly adhere to the designated Cortex XSIAM and WildFire regions, ensuring data remains within the appropriate geographical boundaries.

#### 3.1.4. Endpoint protection capabilities

#### 3.1.5. Endpoint protection modules

#### 3.1.6. Processes protected by exploit security policy

#### 3.1.7. File Integrity Monitoring (FIM)

##### License Type

  FIM requires the Cortex Cloud Runtime Security add-on.

##### Note

* Google Kubernetes Engine (GKE) is currently not supported

* It is recommended to create a policy that targets only the necessary files and folders.

* Platform cannot be changed once a rule group has been created

* A rule group can contain up to 100 rules.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* It is possible to ingest up to 15,000 events per day (24 hours) for each host/container.

##### Navigation

  Creating, modifying and viewing FIM rule groups and rules is be done in the Rule Groups page, located at the Inventory → Endpoints → File Integrity Monitoring menu

  In Inventory → Endpoints → Policy management → Extensions → Profiles, select +Add Profile and then select either Create New or Import from File

#### 3.1.8. WildFire analysis concepts

##### Note

* In cases when the Cortex XSIAM agent gets a failed status from the WF service due to a general error or unsupported file type, and the Local Analysis is set to disabled or not applicable, Cortex XSIAM will not generate an alert on the file.

#### 3.1.9. Guidelines for keeping Cortex XDR agents and content updated

##### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups. See how to define endpoint group.

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups.

##### Important

* When planning Cortex XDR agent upgrades and content updates, consult with the appropriate stakeholders and teams and follow the change management strategy in your organization.

##### Caution

* Before enabling Auto-Update for Cortex XDR agents, make sure to consult with all relevant stakeholders in your organization.

#### 3.1.10. About content updates

##### Note

* Cortex XSIAM delivers the content update to the agent in parts and not as a single file, allowing the agent to retrieve only the updates and additions it needs.

#### 3.1.11. Endpoint data collection

##### Note

* For specific files only and only if the file was written.

##### Important

* Registry key is collected as a real key name, and not as a symbolic link. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, KEY_LOCAL_MACHINE\System\ControlSet001 will be collected. Instead of HKEY_CURRENT_USER, HKEY_USERS\<SID> will be collected, where SID is a SID of the current user.

### 3.2. Install and manage endpoints

#### 3.2.1. Set up endpoint protection

##### 3.2.1.1. Set up endpoint profiles and exception rules

###### Note

* Profiles associated with one or more targets that are beyond the scope of your defined user permissions are locked, and cannot be edited.

###### 3.2.1.1.1. Set up malware prevention profiles

####### License Type

  Requires the ITDR add-on.

####### Note

* In this profile, the Report options configure the endpoints to report the corresponding suspicious files, actions, processes, or behaviors to Cortex XSIAM, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* As part of the anti-malware security flow, the Cortex XDR agent leverages the operating system's capability to identify revoked certificates for executables, and DLL files that attempt to run on the endpoint by accessing the Windows Certificate Revocation List (CRL). To allow the Cortex XDR agent access the CRL, you must enable internet access over...

* The Quarantine Malicious Executables feature is not available for malware identified on network drives.

* The Quarantine Malicious Script Files feature is not available for malware identified on network drives.

* If on-write actions were configured in earlier versions of Cortex XSIAM, the same configuration has been preserved and applied globally for all file types. On-write file protection may have an impact on the resources required by the Cortex XDR agent.

* On-demand file protection may have an impact on the resources required by the Cortex XDR agent.

* We recommend that you disable scheduled scanning. VDI machine scans are based on the golden image and additional files will be examined upon execution.

* When periodic scanning is enabled in your profile, the Cortex XDR agent initiates an initial scan when it is first installed on the endpoint, regardless of the periodic scanning scheduling time.

* This feature only comes into effect after a restart.

* When you are actively evaluating with BAS tools, it is recommended to enable the BAS mode setting only for the duration of your evaluation, and for a limited number of agents.

* BAS tools mode with content older than version 1850 cannot be configured, the agent will be treated as Enabled.

* The Quarantine Malicious Mach-O Files feature is not available for malware identified on network drives.

* This module is supported by Cortex XDR agent 8.1.0 and later releases.

* The Quarantine Malicious ELF Files feature is not available for malware identified on network drives.

* Enabling on-demand scanning will automatically scan these core system directories: /etc, /tmp, /home, /usr, /bin, /sbin, /lib, /var, /opt, /dev, /root, /boot.

* From Cortex XDR agent for Android version 9.0 and later, part of this module, which performs local analysis on the Android device itself, is deprecated. APK analysis will be handled only by Wildfire.

* Blocking functionality is different for each security module. For SMS/MMS, Cortex XDR agent will move detected messages containing such URLs from unknown senders to the Junk folder.

* Ensure that the same numbers are not added multiple times with different leading zeros.

* To fully enable the Safari browser security module on the device side, each iOS device user must enable the Safari Safeguard module on the device, and grant it permission to work on all websites. If the iOS device user does not do this, the endpoint's operation status is reported as Partially Protected. The Safari browser security module will only...

* Cortex XDR agent version 8.4 or higher are required for this feature.

####### Warning

* For optimal user experience, we recommend that you set the action mode to either Allow or Run Local Analysis.

###### 3.2.1.1.2. Set up exploit prevention profiles

####### Note

* In this profile, the Report options configure the endpoints to report the corresponding exploit attempts to Cortex XSIAM, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* In exploit prevention profiles, if you change the action mode for processes, you must restart the protected processes for the following security modules to take effect on the process and its forked processes: Brute Force Protection Java Deserialization SO Hijacking

* This step provides a temporary workaround for the following publicly known information-security vulnerabilities and exposures: CVE-2021-24074, CVE-2021-24086 and CVE-2021-24094.

* If you have Windows endpoints in your network that are unpatched and exposed to a known vulnerability, we strongly recommend that you upgrade to the latest Windows Update that has a fix for that vulnerability.

####### Warning

* This workaround applies only to the specific Windows versions listed as exposed to these CVEs, and requires a Cortex XDR agent release 7.1 or later and content 167-51646 or later. This workaround is not recommended for non-persistent, stateless, or linked-clone environments. In some cases, enabling this workaround can affect the network functionality...

###### 3.2.1.1.3. Set up agent settings profiles

####### License Type

  Requires a Cortex XDR Pro per Endpoint license. When you enable this feature, a Cortex XDR Pro per Endpoint license is consumed.

  Requires Host Insights add-on.

  Requires Forensics Add-on.

####### Prerequisite

* User Space Agent mode requires Linux kernel 5.0.0 or higher.

####### Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

* You can enable the option to maintain a persistent notification regarding the disconnection of the endpoint from the network. The settings Persistent Isolation Notification and Blocked Connectivity Notification must be enabled. Until the threat on the endpoint has been removed, the endpoint remains disconnected from the network.

* In Traps 5.0.6 and later releases, when protection is enabled, access will be read-only. In earlier Traps releases, enabling protection disables all access to services, processes, files, and registry values.

* If you choose the Enable option, you must also enable XDR Agent Tampering Protection in the malware profile and set it to Block. Ensure that both profiles are assigned to the same endpoints.

* When you enable Cortex XDR agent registration with the Windows Security Center, Windows automatically shuts down Microsoft Defender on Windows-based workstation endpoints. If you still want to allow Microsoft Defender to run on a workstation endpoint where Cortex XSIAM is installed, you must use the Disable option. However, Palo Alto Networks does not...

* To enable access to these options, scroll down to Network Location Configuration, and set Action Mode to Enabled.

* When using Nmap, the Cortex XDR agent downloads an Nmap driver for the duration of the scan and removes the driver upon completion. If an Nmap scan is in process, Cortex XSIAM identifies the Nmap driver and places any additional scans in a queue.

* If you disable content updates for a newly installed agent, the agent retrieves the content for the first time from Cortex XSIAM, and then disables content updates on the endpoint. When you add a Cortex XDR agent to an endpoint group with a disabled content auto-upgrades policy, the policy is applied to the added agent as well.

* Automatic upgrades are not supported with non-persistent VDI and temporary sessions.

* The delay timer starts from the date of the target agent version's availability in the tenant.

* Limitations in the content download process: When you install the Cortex XDR agent, the agent retrieves the latest content update version available. A freshly installed agent can take between five to ten minutes (depending on your network and content update settings) to retrieve the content for the first time. During this time, your endpoint is not...

* If the Cortex XDR agent is initially unable to communicate without the local store, enforcement is not enabled and the agent will show as partially protected.

* If you choose the Enabled option, you must also set Anti Tampering Protection in the malware security profile to Block, and ensure that both profiles are assigned to the same endpoints.

* When protection is enabled, access to services, processes, files, and registry values will be read-only.

* If you disable content updates for a newly installed agent, the agent retrieves the content for the first time from Cortex XSIAM, and then disables content updates on the endpoint.

* Automatic upgrades are not supported with non-persistent VDI and temporary sessions. When a Cortex XDR agent is added to an endpoint group, it inherits the group's policy, including the disabled content auto-upgrades setting.

* Automatic upgrades are not supported for XDR agents running on K8s.

* User Space Agent mode requires Linux kernel 5.0.0 or higher. Endpoints running an older Linux kernel version with this fallback enabled, will not start using User Space Agent mode, and will operate asynchronously.

####### Warning

* If you disable or delay automatic-content updates provided by Palo Alto Networks, it may affect the security level in your organization.

###### 3.2.1.1.4. Set up restrictions prevention profiles

####### License Type

  A Threat Intel Management (TIM) license is required for this feature.

####### Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Configure custom BIOC prevention rules here: Detection & Threat Intel → Detection Rules → BIOC

* Configure this as follows: Prepare this restriction profile first, make a note of its name for later, and set it to Enabled. Prepare the prevention Indicator Rule (go to Detection & Threat Intel → Indicator Rules, ensuring to select Prevention when creating the rule), and while preparing it, map it to your restriction profile.

* Wildcards are supported.

###### 3.2.1.1.5. Set up exception profiles and rules

####### 3.2.1.1.5.1. Exception configuration

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Settings → Exception Configuration → Legacy Exceptions and click Start Simulation

####### 3.2.1.1.5.2. Issue exclusions

######## Note

* The agent continues to generate excluded issues on the endpoint, but they are not saved or displayed in Cortex XSIAM. Configuration of an issue exclusion does not remove or delete any of the logs that would have triggered the issue notification. You can also set up issue exceptions by creating global endpoint policy exceptions. For more information,...

######## Navigation

  The Settings → Exception Configuration → Issue Exclusions page displays the issue exclusion rules in Cortex XSIAM

######## 3.2.1.1.5.2.1. Add an issue exclusion rule

####### 3.2.1.1.5.3. Add an IOC or BIOC rule exception

######## Note

* Cortex XSIAM only supports exceptions with one attribute. See Add an alert exclusion rule to create advanced exceptions based on your filtered criteria.Add an alert exclusion rule

######## Navigation

  Settings → Exceptions Configuration → IOC/BIOC Suppression Rules

####### 3.2.1.1.5.4. Add a disable prevention rule for endpoints

######## Important

* All applicable prevention actions are skipped for the files and process that match the properties defined in the rule. Consider the consequences of disabling a prevention rule before you add the exception, and monitor it over time. You can only apply a Disable Prevention Rule to endpoints running Cortex XDR agents version 7.9 and later.

######## Navigation

  Settings → Exception Configuration → Disable Prevention Rules

####### 3.2.1.1.5.5. Add a disable injection and prevention rule

######## Important

* Exceptions are limited up to 48 hours by default and configurable up to one week. Consider the consequences of disabling a prevention rule before you add the exception and monitor it over time. You can only apply a Disable Prevention Rule to agents version 7.9 and later.

######## Navigation

  Settings → Exception Configuration → Disable Injection and Prevention

####### 3.2.1.1.5.6. Add a support exception rule for endpoints

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Your migrated rules are displayed on the Settings → Exception Configurations → Support Exception Rules page

  From Settings → Exception Configuration → Support Exception Rules, click + Import from file

####### 3.2.1.1.5.7. Add a legacy exception rule for endpoints

######## Note

* This exception prevents the agent from examining the specified file. Use with caution, as it may unintentionally allow unwanted or malicious behavior to go undetected.

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Your migrated rules are displayed on the Settings → Exception Configurations → Legacy Agent Exceptions page

######## 3.2.1.1.5.7.1. Add a new exceptions security profile

######## 3.2.1.1.5.7.2. Add a global endpoint policy exception

##### 3.2.1.2. Define endpoint groups

###### Note

* Disconnecting Cloud Identity Engine in your Cortex XSIAM deployment can affect existing endpoint groups and policy rules based on Active Directory properties.

##### 3.2.1.3. Configure global agent settings

###### Note

* Disabling this capability takes immediate effect on new hashes, fresh agent installations, and existing security policies. It could take up to a week to take effect on existing agents in your environment pending agent caching.

* If you have any Cortex XSIAM filters, starring policies, exclusion policies, scoring rules, log forwarding queries, or automation rules configured for XSOAR/3rd party SIEM, we advise you to update those to support the changes before activating the feature. For example, change the query to include the previous description that is still available in the...

##### 3.2.1.4. Apply profiles to endpoints

###### Note

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

##### 3.2.1.5. Create an agent installation package

###### Note

* The profile will be applied if the security policy cannot be retrieved in real-time.

* The Cortex serverless library must be imported after other libraries to activate the hooks that enable auditing.

###### 3.2.1.5.1. Manage an agent installation package

####### Note

* Since Cortex XSIAM relies on the installation package ID to approve agent registration during the installation, we recommend that you don't delete the installation package of active endpoints. If you install the Cortex XDR agent from a package after you delete it, Cortex XSIAM denies the registration request leaving the agent in an unprotected state....

##### 3.2.1.6. Harden endpoint security

###### Caution

* Hardened endpoint security capabilities are not supported for Android or iOS endpoints.

###### Navigation

  From Inventory → Endpoints → Policy Management → Extensions → Profiles, you can create profiles for the following hardened endpoint security capabilities

  To apply the profiles, from Inventory → Endpoints → Policy Management → Extensions → Policy Rules, you can view all the policy rules per operating system

###### 3.2.1.6.1. Device control

####### Note

* Operating systems report on devices in different ways. Sometimes, the same BLE device will report different services and interfaces, depending on the host's operating system. This may have an effect on the specific BLE services that are blocked for each operating system. Depending on your defined user scope permissions, creating device profiles,...

* For network printer print jobs, ensure that you also configure the Agent Settings profile, Network Location Configuration option. This setting must be set to Enabled, and configured. If you do not enable and configure this setting, all network printer operations will be treated as internal network print jobs. For network printer print jobs, ensure that...

* Currently, the default is set to Use Default (Allow), however, Palo Alto Networks may change the default definition at any time.

* You cannot edit or delete the default profiles pre-defined in Cortex XSIAM.

* You cannot edit or delete the predefined profiles in Cortex XSIAM.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* Permanent exceptions apply across platforms, allowing the devices on all operating systems.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

####### Navigation

  Endpoints → Policy Management → Settings → Device Management

###### 3.2.1.6.2. Host firewall

####### 3.2.1.6.2.1. Host firewall for Windows

######## Note

* A rule is always part of a rules group. It cannot stand on its own. A rule can belong to one rules group only and cannot be reused in different groups.

* When selecting ICMP protocol, you must enter a the ICMP Type and Code. Without these values the ICMP protocol is ignored by the Windows and macOS Cortex XDR agents.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows. New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until target is specified.

* The data is aggregated and reported periodically every 60 minutes since the first time the host firewall policy was enforced on the endpoint, not every round hour. The table lists enforcement events only for rules set to Report Matching Traffic.

######## Navigation

  From Inventory → Endpoints → Policy Management → Extensions and select + Add Profile or Import from File

####### 3.2.1.6.2.2. Host firewall for macOS

######## Note

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

######## Navigation

  From Inventory → Endpoints → Policy Management → Extensions Profiles → Profiles, select + New Profile or Import from File

  Additionally, to monitor the communication on your macOS endpoint, you can use the following operating system utilities: From the endpoint System Preferences → Security and Privacy → Firewall → Firewall options, you can view the list of blocked and allowed applications in the firewall

###### 3.2.1.6.3. Disk encryption

####### Note

* You must select the same encryption method configured by the Microsoft Windows Group Policy in your organization for the target endpoints. Otherwise, if you select a different encryption method than the one already applied through the Windows Group Policy, Cortex XSIAM displays errors.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

####### Navigation

  You can monitor the Encryption Status of an endpoint in the Inventory → Endpoints → Disk Encryption Visibility table

###### 3.2.1.6.4. Host Inventory

####### Note

* Cortex XSIAM includes only the first 10,000 results per endpoint. Cortex XSIAM lists only users that belong to each group directly, and does not include users who belong to a group within the main group. If a local users group includes a domain user (whose credentials are stored on the Domain Controller server and not on the endpoint), Cortex XSIAM...

####### Navigation

  Inventory → Endpoints → Host Inventory

###### 3.2.1.6.5. Vulnerability Assessment

####### Prerequisite

* The following are prerequisites for Cortex XSIAM to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XSIAM lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex XSIAM...

* The following are prerequisites for Cortex XSIAM to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex XSIAM collects all the information about the operating system and the installed...

####### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex XSIAM Application Inventory.

####### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

####### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

##### 3.2.1.7. Set a Cortex XDR agent Critical Environment version

###### Note

* To ensure the stability of the line, CE versions maintenance release cadence is longer than in the standard line, we recommend that deployment is adjusted accordingly.

###### Navigation

  Settings → Configurations → General → Agent Configurations

  Inventory → Endpoints → All Endpoints

##### 3.2.1.8. Set an application proxy for Cortex XDR agents

###### Warning

* If adding a proxy to the allow list be aware of the following: This allows any application on the isolated endpoint to communicate through that proxy, potentially allowing a threat actor or malware to bypass the isolation and reach external resources. Ensure that no other non-security applications are utilizing this proxy if you choose to allow it.

###### Navigation

  Inventory → Endpoints → All Endpoints

#### 3.2.2. Manage endpoint protection

##### 3.2.2.1. Move agents between managing servers

###### Prerequisite

* Consider the following before making changes: Endpoint type is not Kubernetes Node. Installation type is not VDI. Ensure you have administrator privileges for Cortex XSIAM in the hub.

###### Note

* Cortex XSIAM does not support moving agents between FedRamp and commercial tenants.

###### Navigation

  Inventory → Endpoints → Agent Installations

  Inventory → Endpoints → All Endpoints

##### 3.2.2.2. Manage endpoint tags

###### Note

* The following explanations use Windows operating system installation parameters and Cytool argument examples.

* Tag names are case sensitive. In Windows and Mac, a tag name can contain spaces. Linux does not support tag names with spaces as command line arguments to the shell installer. Instead, tags can be set in the /etc/panw/cortex.conf configuration file, which supports all Linux installers.

* Tag names are case sensitive and can contain spaces.

* When SBAC is enabled, assigning tags may impact user permissions.

* If you remove the tag and there are assigned users or user groups with scope settings, this can impact user permissions in the system.

##### 3.2.2.3. Set an alias for an endpoint

###### Tip

* If you change your mind in the future, you can select Endpoint Control → Change Endpoint Alias again, and delete the required aliases.

##### 3.2.2.4. Manage endpoint prevention profiles

###### Note

* The filter is stored within the policy definition and assessed during runtime to extract the functions that match the filter criteria.

###### Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

##### 3.2.2.5. Upgrade Cortex XDR agents

###### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* It is possible to cancel an upgrade if the Status is Pending. Once the Status is In Progress, the action is already received by the agent locally and cannot be canceled from the management console. Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating...

###### Warning

* You must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check whether the extensions were approved, you can either verify that the...

###### Important

* The following list includes important points to take into account when upgrading the Cortex XDR agent: Review the recommended guidelines for keeping Cortex XDR agents and content updated. Read more here. You cannot upgrade the Cortex XDR agent on VDI endpoints or a Golden Image. You must reinstall (uninstall and install again) the relevant agent...

##### 3.2.2.6. Restart agent

##### 3.2.2.7. Uninstall the Cortex XDR agent

###### Note

* Before upgrading a Cortex XDR agent running on macOS 10.15.4 or later, you must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check...

###### Tip

* If needed, use the filter to filter the list of endpoints by attribute or group name.

###### Navigation

  Inventory → Endpoints → All Endpoints

##### 3.2.2.8. Clear agent database

###### Note

* Clearing the agent database is supported on all platforms with Cortex XDR agent version 7.9 or later, and is available only when using the debugging mode.

* You can only right-click to cancel the clear agent database for actions with a pending status.

##### 3.2.2.9. Delete Cortex XDR agents

###### Note

* To reinstate an endpoint, you have to uninstall and reinstall the agent.

###### Navigation

  Inventory → Endpoints → All Endpoints

##### 3.2.2.10. Manage agent tokens

###### Note

* Agent tokens are only supported for Windows and Mac.

* You can select a one or multiple agents to add a temporary token.

##### 3.2.2.11. Retrieve support file password

###### Navigation

  Retrieve Support File Password from Inventory → Endpoints → All Endpoints

##### 3.2.2.12. Send push notifications to iOS

##### 3.2.2.13. Monitor agent operational status

###### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex XSIAM management console for specific reasons for the state.

###### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

###### Navigation

  You can monitor the Cortex XDR agent Operational Status in Inventory → Endpoints → All Endpoints

##### 3.2.2.14. Monitor agent activity

##### 3.2.2.15. Monitor agent upgrade status

###### Navigation

  From Inventory → Endpoints → All Endpoints, you can view the upgrade status of any Cortex XDR agent that you manage

## 4. Web and API Security (WAAS)

### 4.1. Overview

#### License Type

  Requires Cortex XSIAM Premium or any other XSIAM license with the Cloud Runtime Security add-on.

### 4.2. Personas workflow

### 4.3. Secure your API landscape

#### 4.3.1. Gain visibility and assess risk of API endpoints

##### Note

* Data classification findings are only available for enabled profiles.

* Indicates that a JSON Web Token was identified, but it is unknown how to determine its type from the given string. It could be a non-standard JSON Web Token creation algorithm.

* To link APIs to business applications, the two prerequisites must be met: The VM must have XDR agent with WAAS enabled. Applications must be defined in Application Security Posture Management (ASPM).Application Security Posture Management (ASPM)

#### 4.3.2. Monitor and investigate API threats

#### 4.3.3. Configure API security from end to end

##### 4.3.3.1. Third-party integrations

###### 4.3.3.1.1. Ingest AWS API Gateway

####### Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

####### Important

* Leave '–'filter-pattern empty as displayed above.

###### 4.3.3.1.2. Ingest Azure APIM

####### License Type

  Requires the Data Collection add-on.

####### Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

####### Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

###### 4.3.3.1.3. Ingest Apigee Proxy

####### License Type

  Requires the Data Collection add-on.

####### Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

####### Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

###### 4.3.3.1.4. Ingest Kong

####### License Type

  Requires the Data Collection add-on.

####### Note

* Contact support to obtain the custom plugin file.

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

####### Important

* The size of the buffer must be equal or larger than the max body size setting in the plugin configuration, on every data plane node.

###### 4.3.3.1.5. Ingest-F5

####### License Type

  Requires the Data Collection add-on.

####### Note

* Extract the files from the F5 plugin to a folder before selecting to upload to F5.

* Select panw_apisec_set_ssl_data only if your client SSL profile is enabled.

* The provider for "context_provider" should always be uppercase. Supported providers: AWS, GCP, Azure, On-prem.

##### 4.3.3.2. Agent-based protection

###### Note

* Web and API Security (WAAS) profiles and policies are currently a Beta feature.

###### 4.3.3.2.1. Set up Web and API Security profiles

####### Note

* Web and API Security profiles and policies are currently a Beta feature.

* In this profile, the Report options configure the workload to report the corresponding malicious applications or APIs to Cortex XSIAM, without blocking them. The Disabled options configure the workloads to neither analyze nor report the corresponding malware or behavior.

####### Navigation

  Inventory → Endpoints → Policy Management → Prevention → Profiles

###### 4.3.3.2.2. Apply Web and API Security profiles to workloads

####### Note

* Web and API Security profiles and policies are currently a Beta feature.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

###### 4.3.3.2.3. Manage Web and API Security prevention profiles

####### Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

###### 4.3.3.2.4. Add a disable prevention rule for cloud workloads

####### Important

* All applicable prevention actions are skipped for the files and process that match the properties defined in the rule. Consider the consequences of disabling a prevention rule before you add the exception, and monitor it over time.

####### Navigation

  Settings → Exceptions Configuration → Disable Prevention Rules

###### 4.3.3.2.5. Add a support exception rule for cloud workloads

####### Navigation

  From Settings → Exceptions Configuration → Support Exception Rules, click + Import from file

###### 4.3.3.2.6. Add a legacy exception rule for cloud workloads

####### Navigation

  Your rule is created, and can be viewed at the following location: Settings → Exceptions Configuration → Legacy Agent Exceptions

###### 4.3.3.2.7. Additional workload management tasks

####### Navigation

  Several management activities that can be performed on workloads are accessible from Inventory → Endpoints → All Endpoints and from Inventory → Endpoints → Groups

#### 4.3.4. API specification inventory

##### Note

* Even if you have already imported the specification, you can edit the API specification in Cortex XSIAM and add or update the server list.

##### 4.3.4.1. Import API specification

###### Note

* Even if you already imported the file, you can edit the API asset and add or update the server list.

## 5. Monitor dashboards and reports

### 5.1. About dashboards

#### Note

* Dashboards that are based on custom infrastructure cannot be exported. When importing a dashboard that already exists in the system, the imported dashboard overwrites the existing dashboard. To avoid overwriting the existing dashboard, duplicate and rename the existing dashboard before importing the new dashboard.

#### Important

* The ability to create, edit, or share custom dashboards is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to custom dashboards.Manage access to custom dashboards

#### 5.1.1. Command Center dashboards

##### Note

* Access to these dashboards requires RBAC permissions under Dashboards & Reports. The Dashboards component must be Enabled in your role and requires View permissions for Command Center Dashboards. If certain options are unavailable, contact your administrator. For more information, Manage access to custom dashboards.Manage access to custom...

##### 5.1.1.1. Cortex Command Center

###### Note

* Access to this dashboard requires RBAC permissions under Dashboards & Reports. The Dashboards component must be Enabled in your role and requires View permissions for Command Center Dashboards and Asset Inventory. If certain options are unavailable, contact your administrator. For more information, see Manage access to custom dashboards.Manage access...

##### 5.1.1.2. XSIAM Command Center

###### 5.1.1.2.1. Cortex Agentic Assistant dashboard

####### Prerequisite

* The Cortex Agentic Assistant is only available after it is enabled, and for tenants in certain regions. For more information, see Cortex Agentic Assistant.Cortex Agentic Assistant

####### Note

* Access to this dashboard requires RBAC permissions under Dashboards & Reports. The Dashboards component must be Enabled in your role and requires View permissions for Command Center Dashboards. If certain options are unavailable, contact your administrator. For more information, see Manage access to custom dashboards.Manage access to custom dashboards

###### 5.1.1.2.2. Data Inventory

###### 5.1.1.2.3. Dynamic View

###### 5.1.1.2.4. Cases Overview

##### 5.1.1.3. Cloud Detection and Response (CDR) Command Center

###### License Type

  Requires Cortex XSIAM Premium, or any other XSIAM license with the Cloud Runtime Security or the Cloud Posture Security add-on.

##### 5.1.1.4. Cloud Security Operations

###### 5.1.1.4.1. Cloud Security Operations

####### License Type

  Requires Cortex XSIAM Premium, or any other XSIAM license with the Cloud Runtime Security or the Cloud Posture Security add-on.

####### Note

* Command Center data may not match the counts on the Issues page, and you may observe inconsistencies. This is because dashboard data is a snapshot of issues identified, whereas the Issues page provides the most up-to-date view of risks across your cloud assets. In addition, the Issues pages do not support all the currently available filters on the...

####### 5.1.1.4.1.1. Dashboard Widgets

######## Note

* The Last updated time indicated on each widget may differ as widget data is gathered at varying intervals.

######## 5.1.1.4.1.1.1. Generate Reports

######## 5.1.1.4.1.1.2. Filter Options

##### 5.1.1.5. Cortex Cloud Command Center

#### 5.1.2. Predefined dashboards

##### License Type

  Requires the Cortex XSIAM Premium license or any other XSIAM license with the Attack Surface Management (ASM) add-on.

  Requires Cortex XSIAM Premium or any other XSIAM license with the Cloud Posture Security or Cloud Runtime Security add-on.

  Requires the ITDR add-on.

##### Note

* Requires Cortex XSIAM Premium, Enterprise, or any other XSIAM license that includes the Enterprise Runtime or Cloud Runtime Security add-on.

* Requires a Cortex XSIAM Enterprise Plus license.

* Requires Cortex XSIAM Premium, Enterprise, or any other XSIAM license that includes the Enterprise Runtime add-on.

* Users can access all information on the dashboard when their user access is scoped to view All assets or assigned to the Instance Administrator role. Otherwise, users with granular scoping set to No assets or Select asset groups will have limited access to the dashboard. For more information on Scope-Based Access Control (SBAC), see Manage user...

#### 5.1.3. Reports

##### 5.1.3.1. Report templates

### 5.2. Build custom dashboards and reports

#### 5.2.1. Build a custom dashboard

##### Note

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For case-related widgets, you can refine the displayed data to only show results from cases that match a...

#### 5.2.2. Manage your Widget Library

##### Note

* Unlike dashboards, individual widgets cannot be shared with other users directly from the Widget Library. Yet, if you add a Restricted widget to a dashboard and then share that dashboard, other users who have access to the dashboard will also be able to see that specific widget.

* Any dashboards or reports that include the widget are affected by the changes.

### 5.3. Fine-tune dashboards and reports

#### 5.3.1. Create a custom widget using a script

##### Note

* If you have added arguments to the script, these appear when creating a widget.

* Available options are Pie, Column, Line, and Single Value. To display the result of the script as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### 5.3.1.1. Script-based widget examples

###### Note

* Add the widget tag in the script settings to make the script available for use in script-based widgets. For more information, see Create a script.

* If your script returns a time duration, configure the widget with the graph type Single Value and enable Show as Time..

#### 5.3.2. Create a text widget

##### Note

* From the dashboard manager, you can right-click an existing dashboard and choose Save as report template. You can also add text-based widgets directly to new or existing report templates, as described below.

#### 5.3.3. Create custom XQL widgets

##### Note

* Cortex Query Language (XQL) queries generated from the Widget Library do not appear in the Query Center. The results are used only for creating the custom widget.

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### Tip

* You can create a generic dashboard for multiple views of the same dataset by defining the dataset in the XQL widget as dataset = <dataset_name>*. The placement of the asterisk (*) in the dataset name ensures that any view containing this prefix text is displayed in the results. The dataset in a query is defined as: If there are multiple datasets that...

##### Navigation

  All of your predefined and custom XQL widgets are available in the Widget Library under Dashboards & Reports → Customize → Widget Library

##### 5.3.3.1. Configure filters and inputs for custom XQL widgets

###### Prerequisite

* Fixed filters are based on parameters that are defined in custom XQL widgets. Before you can configure fixed filters, take the following steps: Create custom XQL widgets with parameters. For more information, see Create custom XQL widgets. Add the widgets to a Custom dashboard. For more information, see Build a custom dashboard.

###### Note

* If you specify more than one field, only the first field value is used.

###### Tip

* After the initial setup, when you access your dashboard the filters and inputs might need further refinement. You can make changes to the configured parameters in the XQL widgets, and update the Filters & Inputs on your dashboard until you are satisfied with the results.

#### 5.3.4. Configure dashboard drilldowns

##### Prerequisite

* To configure drilldowns your dashboard must contain custom XQL widgets. In addition, if you want to configure in-dashboard drilldowns your custom XQL widget must contain one or more parameters. For more information about configuring parameters in custom XQL widgets, see Create custom XQL widgets.

##### Note

* If the selected parameter is configured in other XQL widgets on the dashboard, these widgets are also affected by the drilldown.

##### 5.3.4.1. Variables in drilldowns

### 5.4. Run or schedule reports

#### Note

* Report templates that are based on custom infrastructure cannot be exported. If you import a report template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

* The report name and description will be displayed in the report header and are not editable during customization.

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

* To send reports to Slack, Slack must be configured as an external application in Cortex XSIAM. For more information, see Integrate Slack for outbound notifications

#### Navigation

  Dashboards & Reports → Customize → Report Templates

  Dashboards & Reports → Customize → Dashboards Manager

  Under Settings → Configurations → General → Notifications, click + Add Forwarding Configuration

## 6. Investigation and response

### 6.1. Overview of cases

#### 6.1.1. What are cases?

#### 6.1.2. Resolving cases with AI

#### 6.1.3. Case lifecycle

#### 6.1.4. Case thresholds

#### 6.1.5. Case scope and impact

#### 6.1.6. Case and issue domains

##### Note

* You can create your own custom domains to match specific scenarios in your environment. For more information, see Create a case domain.Create a case domain

### 6.2. Case concepts

#### 6.2.1. Issues, findings, and events

##### 6.2.1.1. Issues

##### 6.2.1.2. Findings and events

#### 6.2.2. Case grouping

#### 6.2.3. Case scoring

##### Note

* Requires a Cortex XSIAM Premium, Enterprise, or Enterprise Plus license.

* SmartScore requires sufficient data to calculate and display the score. On first activation, this can take up to 48 hours. If sufficient data is not available, no score is assigned. If no match is found and there is sufficient data available, Cortex XSIAM assigns a SmartScore. If Cortex XSIAM doesn't have sufficient data to assign a score, you can...

#### 6.2.4. Case starring

##### Navigation

  You can manage all starring configurations under Case & Issues → Case Configuration → Starred Issues

#### 6.2.5. SLAs and tracking

##### License Type

  This feature requires a Cortex XSIAM Premium, Cortex XSIAM Enterprise, or Cortex XSIAM NG SIEM license.

#### 6.2.6. What is Causality?

##### Note

* There are no CGOs in the Cloud Causality View, when investigating cloud Cortex XSIAM alerts and Cloud Audit Logs, or SaaS Causality View, when investigating SaaS-related alerts for 501 audit events, such as Office 365 audit logs and normalized logs.

### 6.3. Analyze and resolve cases

#### 6.3.1. Review all cases

##### Note

* The legacy view is also available for users who prefer this format. From the Actions menu select Switch to legacy view.

##### Navigation

  You can enable this setting from Settings → Configurations → General → Server Settings → Unified Case View

#### 6.3.2. Start case analysis

##### 6.3.2.1. Agentic Assistant- Case Investigation agent

#### 6.3.3. Establish case context

##### 6.3.3.1. AI-generated case summaries

###### Note

* The AI-generated title and description is a calculated value that is regenerated each time you open a case. This value is not a saved static description, therefore it is not reflected in the saved case names in the list of cases in the Split view , or in the Case Name and Case Description columns in the Table view.

###### Navigation

  Configurations → General → Server Settings → AI Configuration and enable the following settings

##### 6.3.3.2. Assess case severity and score

##### 6.3.3.3. Update case attributes

###### Note

* The defined values are shown in the Case Name and Case Description columns in the Table view, and saved to the cases dataset. The case title is also shown the list of cases in the Split view. These values do not replace the AI-generated case title and summary. If the Summarize with AI toggle is enabled, AI-generated case summaries are automatically...

#### 6.3.4. Analyze case details

##### Note

* If you prefer a tabular or legacy layout, switch the case card to the Detailed view. This view preserves the legacy tab based format and custom layouts, ensuring full backward compatibility. You can switch between the new case experience and the legacy view based on personal workflow preferences. For more information, see Detailed View.

##### 6.3.4.1. Grouping graph

###### Note

* Similar issues are displayed as individual entities rather than in a parent/child hierarchy.

##### 6.3.4.2. Evidence

##### 6.3.4.3. Issue feed

##### 6.3.4.4. Associated assets and artifacts

###### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

##### 6.3.4.5. MITRE ATT&CK tactics and techniques

###### Note

* This component is available for cases associated with the Security domain or custom domains.

##### 6.3.4.6. Detailed View

###### Note

* When an issue is resolved, it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

* Cloud-related issues are displayed in the User Name grouping. Prisma Cloud Compute issues are displayed in the Host Name grouping.

#### 6.3.5. Resolve the case

##### 6.3.5.1. Resolution Center

###### Note

* Tasks that are already In Progress but still require your input will appear in both the Pending and In Progress tabs.

##### 6.3.5.2. Collaborative notes and comments

##### 6.3.5.3. Resolve a case

###### Note

* If a case is resolved with the status Resolved - Auto Resolved, Cortex XSIAM can reopen the case for up-to six hours if a new issue is triggered that matches the case. The six-hour period is defined by the timestamp of the last issue that was grouped into the case. After the six-hour period, any new issues are linked to a new case for a new...

##### 6.3.5.4. Resolution reasons for cases and issues

###### Note

* The displayed resolution reasons are domain-specific. You can see the resolution reasons that are defined for a domain under Configurations → Object Setup → Cases → Domains.

* Cases and issues resolved as True Positive and False Positive help Cortex XSIAM to identify real threats in your environment by comparing future cases and associated issues to the resolved cases. Therefore, the handling and scoring of future cases is affected by these resolutions.

#### 6.3.6. Additional case actions

##### 6.3.6.1. Create a case

###### Note

* To create a case manually, you must have View/Edit permission for Cases and Issues selected under Settings → Configurations → Access Management → Roles → Components → Cases & Issues.

* You can assign a case to a single domain only, and you cannot change the assigned domain. For more information, see Case and issue domains.

* This option is only relevant for certain domains.

* You can't attach files to manually created cases.

###### Tip

* The issues that you link to a case can be linked to multiple cases, and the issue domains do not need to match the case domain.

##### 6.3.6.2. Merge a case

#### 6.3.7. Unified case view

##### License Type

  Requires an MSSP license.

##### Note

* Requires the following RBAC permissions:    Cases & Issues   Investigation & Response → Automation Requires the following RBAC permissions: Cases & Issues Investigation & Response → Automation This view is available for the parent tenant only. To take actions on a child tenant from a parent tenant, you must have the appropriate permissions for both...

* Custom case layouts of child tenants are not visible in the parent tenant.

### 6.4. Investigate issues

#### 6.4.1. Overview of the Issues page

##### Note

* Every 12 hours, the system enforces a cleanup policy to remove the oldest issues once the maximum limit is exceeded. The default issue retention period in Cortex XSIAM is 186 days.

#### 6.4.2. Issue card

##### License Type

  Requires Cortex XSIAM Premium license or any other XSIAM license with the TIM add-on.

##### Note

* This section is context-specific and shows data according to the issue context.

#### 6.4.3. Link or unlink issues from a case

#### 6.4.4. Run an automation on an issue

##### Note

* In addition to automation, some playbooks contain manual tasks that prompt the analyst for input. This enables you to enhance an automation workflow with analyst input.

* You can also manually select a playbook to run from the Issue Work Plan tab.

#### 6.4.5. Use the War Room in an investigation

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* The case War Room is usually used for communication capabilities, but unlike the issue War Room, it does not include playbook specific entries. The case War Room enables you to investigate an entire case, not just an issue.

* Cortex XSIAM does not index notes and chats.

##### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

* You can use the up/down arrow buttons in the CLI to do a reverse history search for previous commands with the same prefix.

##### Navigation

  Investigation & Response → Automation → Playground

#### 6.4.6. Use the Work Plan in an investigation

##### Important

* A playbook will not continue its execution path if a prior task has failed; you must resolve the failed task before subsequent tasks can run.

#### 6.4.7. Issue syncing

##### Prerequisite

* You must set up an integration before you can sync issues. For more information, see Set up an integration for mirroring issues.

##### Note

* Multiple tickets can be linked to an issue with outbound syncing. Issues with inbound syncing can be linked to a single ticket only.

* Using issue fields as variables is not currently supported.

* You can only define a single inbound profile. If you change the inbound sync profile the current profile is overwritten. You can define multiple outbound profiles; one issue can update multiple tickets.

* The inbound syncing flow runs every two minutes, and the outbound syncing flow runs every five minutes. In a bi-directional set-up, if the same field is updated in both tickets, the most recently updated value is used. In the external ticket, the logged history shows updates to the ticket. The user name that is logged with the history reflects the user...

* After an issue is resolved, ticket syncing remains active for up-to seven days. Therefore, you still update, change, or reopen the issue or external ticket and the tickets will continue to sync.

* If you change the selected inbound sync profile, the original sync profile is immediately overwritten.

##### Warning

* If you leave this field blank, all configured instances will be used.

##### Tip

* You can find a sync profile ID under Settings → Configurations → Object Setup → Issues → Sync Profiles. By default the ID field is not displayed in the table. Click the three dot menu and add it to the table layout.

##### Navigation

  Settings → Configurations → Marketplace

#### 6.4.8. Cortex Response and Remediation content pack

##### 6.4.8.1. Investigate an issue using Cortex Response and Remediation playbooks

##### 6.4.8.2. Example use cases

#### 6.4.9. Causality view

##### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

##### 6.4.9.1. Network causality view

###### Note

* The network causality view displays only the information it collects from the detectors. It is possible that the CI may not show some of the firewall or agent processes.

###### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

##### 6.4.9.2. Cloud causality view

##### 6.4.9.3. SaaS causality view

##### 6.4.9.4. Timeline

###### Note

* The Timeline view is not available when investigating cloud Cortex XSIAM issues and cloud audit logs or SaaS-related issues for 501 audit events, such as Office 365 audit logs and normalized logs. Only the applicable cloud causality view and SaaS causality view is available for this data.

##### 6.4.9.5. Causality icons key

#### 6.4.10. Issue investigation actions

##### 6.4.10.1. Copy issues

##### 6.4.10.2. Update issue fields

###### Note

* You must create a custom status before you can select it.

###### Tip

* You can create custom issue statuses and resolution reasons, and use the setIssueStatus command to set these custom statuses for issues. For example, when a user starts investigating an issue, the issue status is automatically changed from New to Under Investigation. In some cases, it is useful to create an interim status, such as Triage. After you...

##### 6.4.10.3. Query case and issue data

###### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

##### 6.4.10.4. Exclude an issue

##### 6.4.10.5. Create a featured field

###### Note

* Featured Active Directory values are displayed in the User and Host fields accordingly.

###### Navigation

  Cases & Issues → Case Configuration → Featured Fields and select a type of featured field

##### 6.4.10.6. Export issue details to a file

##### 6.4.10.7. Investigate contributing events

##### 6.4.10.8. Retrieve additional issue details

###### Tip

* If you require assistance from Palo Alto Networks support to investigate the issue, make sure to provide the downloaded ZIP file.

##### 6.4.10.9. View generating BIOC or IOC rule

##### 6.4.10.10. Create profile exceptions

###### Navigation

  Inventory+Endpoints → Policy Management → Profiles

##### 6.4.10.11. Add a file path to a malware profile allow list

###### License Type

  Requires Cortex XSIAM Enterprise, Premium, or any other XSIAM license that includes endpoints or Cortex Cloud Runtime Security.

###### Navigation

  Inventory+Endpoints → Policy Management → Prevention → Profiles and locate the malware profile you selected

##### 6.4.10.12. Close an issue

###### Note

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

### 6.5. Review findings

#### Note

* Some finding types require the Cortex XSIAM Premium license, or any other XSIAM license with the Cloud Posture Security or Cloud Runtime Security add-on.

#### 6.5.1. Findings card

##### Note

* The information in this card is context specific, therefore some sections are not available for all findings.

### 6.6. Investigate artifacts and assets

#### 6.6.1. Investigate an IP address

##### Note

* Requires a license key. Select Settings → Configurations → Integrations  → Threat Intelligence.

#### 6.6.2. Investigate an asset

##### Note

* The Asset view is available for hosts with a Cortex XDR agent installed.

#### 6.6.3. Investigate a host

##### License Type

  The Host Risk View requires the Identity Threat Module add-on.

##### Tip

* You can also see a list of all hosts under Inventory → Assets → Asset Scores.

#### 6.6.4. Investigate a file and process hash

##### Note

* Requires a license key. Go to Settings → Configurations → Integrations  → Threat Intelligence.

#### 6.6.5. Investigate a user

##### License Type

  If the Identity Threat module is enabled, you can open the User Risk View. This view displays insights and profiling information to help you investigate issues and cases. Viewing anomalies in the context of baseline behavior facilitates risk assessment and shortens the time you require for making verdicts. If the Identity Threat module is not enabled...

  The User Risk view is available with the ITDR add-on. Depending on your permissions, some information may be limited by your scope.

##### Note

* Cortex XSIAM normalizes and displays case and issue times in your time zone. If you're in a half-hour time zone, the activity in the Issues & Insights Heatmap is displayed in the whole-hour time slot preceding it. For example, if you're in a UTC +4.5 time zone, the time displayed for the activity will be UTC +4.5, however, the visualization in the...

##### Tip

* You can also see a list of all users under Inventory → Assets → Asset Scores.

### 6.7. Investigate endpoints

#### 6.7.1. Overview of the Action Center

##### Note

* For actions on endpoints, you need a Cortex XSIAM Premium, or Enterprise license, or any other XSIAM license with the Enterprise Runtime Security or Cloud Runtime Security add-on.

* Blocking files on endpoints is enforced by the endpoint malware profile. To block a hash value, ensure the hash value is configured in the Malware security profile. Select Override Report mode to allow the agent to block hashes, even if the Malware Profile is set to Report.

##### Navigation

  Investigation & Response → Response → Action Center

##### 6.7.1.1. Initiate and monitor endpoint actions

###### Navigation

  Investigation & Response → Response → Action Center → New Action

  Investigation & Response → Response → Action Center

##### 6.7.1.2. Action Center reference information

#### 6.7.2. Manage endpoints

##### Note

* For the Include endpoints from auto upgrade action, you cannot enable auto upgrade for Mobile, VDI, and TS installations.

* If an endpoint is excluded, the auto upgrade profile configuration is not available. If you exclude the endpoint from auto upgrade while the auto upgrade action is In progress, the ongoing upgrade will still take place.

* Content Status is calculated every 30 minutes. Therefore, there might be a delay of up to 30 minutes in displaying the data.

* Only supported for Windows and macOS.

* Changes to the agent status can take up to ten minutes to display on Cortex XSIAM .

##### Navigation

  Inventory → Endpoints → All Endpoints

  Settings → Configurations → General → Agent Configurations → Endpoint Administration Cleanup

#### 6.7.3. Retrieve files from an endpoint

##### Note

* You cannot define a path using environment variables on Mac and Linux endpoints.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Disabling File Retrieval does not take effect on file retrieval actions that are in progress.

#### 6.7.4. Retrieve support logs from an endpoint

##### Navigation

  Investigation & Response → Response → Action Center → + New Action

#### 6.7.5. Retrieve support file password

##### Navigation

  Retrieve Support File Password from Inventory → Endpoints → All Endpoints

#### 6.7.6. Scan an endpoint for malware

##### Navigation

  Investigation & Response → Response → Action Center → New Action

### 6.8. Investigate files

#### Note

* To take actions on endpoints, you need the Cortex XSIAM Premium, Enterprise, or any other XSIAM license with the Enterprise Runtime Security (XDR) add-on.

#### 6.8.1. Manage file execution

##### Navigation

  Investigation & Response → Response → Action Center → New Action

#### 6.8.2. Manage quarantined files

##### Note

* This will restore all files with the same hash on all of your endpoints.

#### 6.8.3. Review WildFire analysis details

##### Note

* Cortex XSIAM displays the preview of WildFire reports that were generated within the last couple of years. To view a report that was generated more than two years ago, you can download the report.

#### 6.8.4. Import file hash exceptions

##### Navigation

  Investigation & Response → Response → Action Center → New Action

### 6.9. Cortex Assistant

#### Note

* If you are in an eligible region and have enabled the Cortex Agentic Assistant, the Cortex Agentic Assistant replaces the Cortex Assistant. The Cortex Assistant is available if you do not have access to the Cortex Agentic Assistant based on the tenant region or you have not enabled it. For more information, see Cortex Agentic Assistant.Cortex Agentic...

#### Navigation

  To increase usability, you can create a personalized keyboard shortcut: Settings → Configurations → Server Settings → Keyboard Shortcuts and choose the shortcut you want to use

#### 6.9.1. Cortex Assistant layout

#### 6.9.2. Cortex Assistant capabilities

##### Note

* When you choose an option from the Respond column, Cortex Assistant will always prompt you to approve the action before executing.

### 6.10. Response actions

#### Caution

* Response actions are not supported for Android endpoints.

#### 6.10.1. Initiate a Live Terminal session

##### Note

* You can run PowerShell 5.0 or a later release on Live Terminal of Windows.

* Network drives are not supported.

* On Windows endpoints, you cannot run GUI-based cmd commands like winver or appwiz.cpl.

* Disabling Live Terminal does not take effect on sessions that are in progress.

##### Tip

* You can fine-tune the Live Terminal session visibility on the endpoint by adjusting the User Interface options in your Agent Settings Profile.

#### 6.10.2. Isolate an endpoint

##### Note

* IP-based file storage protocol traffic will also be blocked. This might affect endpoint functionality if the endpoint uses such mounts.

* If file system operations become unresponsive during isolation, such as being unable to list folder content, unmount the mounted network shares.

##### Tip

* If needed, Filter the list of endpoints.

#### 6.10.3. Pause endpoint protection

##### Note

* Pausing your endpoint protection modules leaves your machines exposed to risks.

##### Navigation

  Investigation & Response → Response → Action Center and locate Action Type Pause Endpoint Protection or Resume Endpoint Protection

#### 6.10.4. Run agent scripts on an endpoint

##### Prerequisite

* To run scripts on an endpoint, you must have the following system requirements: Endpoints running the Agent v7.1 and later. Since the agent uses its built-in capabilities and many available Python modules to execute the scripts, no additional setup is required on the endpoint. Role in the hub with the following permissions to run and configure...

##### Note

* *Since all scripts are running under System context, you cannot perform any registry operations on user-specific hives (HKEY_CURRENT_USER of a specific user).

* Always use lowercase for variable names.

* Disabling Script Execution does not take effect on scripts that are in progress.

#### 6.10.5. Remediate changes from malicious activity

##### Prerequisite

* To initiate remediation suggestions, you must have the following system requirements: An App Administrator, Privileged Responder, or Privileged Security Admin role permissions which include the remediation permissions. EDR data collection enabled. Agent version 7.2 or above on Windows endpoints.

##### Note

* Endpoints that are part of the Case view and do not meet the required criteria are excluded from the remediation analysis.

#### 6.10.6. Search and destroy malicious files

##### Prerequisite

* The following are prerequisites to enable Cortex XSIAM to search and destroy files on your endpoints: Supported platforms:    Windows: Cortex XDR agent version 7.2 or a later. If you plan to enable Search and Destroy on VDI sessions, you must perform the initial scan on the Golden Image.   Mac: Cortex XDR agent version 7.3 or a later release running on...

##### Note

* The Cortex XSIAM agent does not include the following information in the local files inventory: Information about files that existed on the endpoint and were deleted before the Cortex XSIAM agent was installed. Information about files where the file size exceeds the maximum file size for hash calculations that are pre-configured in Cortex XSIAM . If...

#### 6.10.7. Manage external dynamic lists

##### Note

* To configure an EDL, you must have a role that includes EDL permissions, such as Instance Admin or Account Admin. Configuring custom certificates or private API Keys in the EDL integration instance is supported only on engines, not on the Cortex XSIAM server. For EDL integrations on the server, you must set a username and password. For long-running...

* The legacy external dynamic list PAN-OS integration is deprecated. Configure the EDL integration on the Data Sources & Integrations page (by clicking the Automation & Feed Integration link.

* If the EDL integration runs on the Cortex XSIAM server, you do not need to enter a Listen Port in the instance settings. The system auto-selects an unused port for the EDL integration when the instance is saved. If you enter a value for Listen Port, it will be overwritten by the port auto-selected by the system

##### Important

* The EDL URL must always be prefixed by ext-.

#### 6.10.8. Collect a memory image

##### License Type

  This functionality has the following license requirements: Forensics add-on license.

### 6.11. Forensics

#### License Type

  Requires the Forensics add-on

#### 6.11.1. Forensic investigations

##### 6.11.1.1. Manage an investigation

###### 6.11.1.1.1. Create a new investigation

####### Note

* To set up user permissions, you must have Scope-Based Access Control (SBAC) enabled.

###### 6.11.1.1.2. Edit an investigation

###### 6.11.1.1.3. Close an investigation

####### Note

* When you close an investigation, Palo Alto Networks has a grace period of 24 hours before deleting any collections associated with the investigation. During this timeframe, you have the option to cancel the close investigation action.

###### 6.11.1.1.4. User permissions

####### Note

* Even if a user does not have access to view an investigation via the Forensics Investigations page, they can still query the results of the collections using an XQL query.

##### 6.11.1.2. Data collection

###### 6.11.1.2.1. Hunting

####### 6.11.1.2.1.1. Create a hunt

######## Note

* You can save hunts in an incomplete state and edit them later. After a hunt has run, you cannot edit it. Instead, you can duplicate the hunt with the same configuration.

####### 6.11.1.2.1.2. Hunt results

######## Note

* The grouping button () shows the number of affected endpoints grouped by executable name. This enables you to perform hunting via frequency analysis (referred to as stacking) and provides a birds eye view of potential malware files that require further analysis.

* The grouping button () shows the number of affected endpoints grouped by file path. This enables you to perform hunting via frequency analysis (referred to as stacking) and provides a birds eye view of potential malware files that require further analysis.

####### 6.11.1.2.1.3. Hunt status

###### 6.11.1.2.2. Triage

####### 6.11.1.2.2.1. Create a triage

####### 6.11.1.2.2.2. Upload an offline triage package

######## Note

* Do not upload memory images captured by the Offline Triage Collector. These images are collected for analysis using third-party tools and are not intended for upload.

####### 6.11.1.2.2.3. Offline triage collection

######## Note

* Security software running on the endpoint (including the Cortex agent) can interfere with or block the execution of the offline triage collector. Disable any security software on the endpoint while the collector is running, or whitelist the collector in your security software before running the offline triage collector.

####### 6.11.1.2.2.4. Triage results

####### 6.11.1.2.2.5. Triage status

###### 6.11.1.2.3. Configure collection

####### Note

* When search fields are specified, the search is limited based on those filters. If more than one entry is in a search filter field, the search returns entries that match any of them. For example: A File Search with two specified paths ("C:\Test\*" and "C:\Windows\*") will return results from both the Test and Windows folders. If you specify multiple...

* Data collected during a Triage Collection is categorized into Artifacts, Volatiles, and File Collection

* Supported only for the UFW tool (Firewall managment tool for some Linux distributions such as Ubuntu)

##### 6.11.1.3. Analysis and documentation

###### 6.11.1.3.1. Review alerts

###### 6.11.1.3.2. Investigation timeline

###### 6.11.1.3.3. Key assets & artifacts

##### 6.11.1.4. Export

###### Note

* You can export a collection more than once.

### 6.12. Notebooks

#### Note

* The Instance Administrator role has these permissions by default.

* You can only add one instance of Notebooks. Notebooks have access to approved sites on the internet when embedded in Cortex XSIAM. To delete the Notebook, hover over Notebooks and select the delete icon. Installing or uninstalling some plug-ins and packages requires the Notebooks server to refresh the web page. For these actions, go to File → Shut...

#### Important

* You need a daily minimum of 1000 compute units. After activation, 1,000 units are deducted daily at 00:00 UTC. XQL and BQ queries performed in Cortex XSIAM Notebooks are calculated similarly to Compute Unit usage of XQL queries originating from public APIs. You can't create a Jupyter instance without sufficient Compute Units. Based on your security...

#### Navigation

  Before you begin, ensure that you have the View/Edit permissions in Settings → Configurations → Access Management → Roles → Configurations → Apps

  In Cortex XSIAM, select Settings → Configurations → Integrations → Apps

  View/Edit permissions in Settings → Configurations → Access Management → Roles → Apps → Jupyter

#### 6.12.1. Manage datasets in Notebooks

##### Note

* If a schema is not provided, the function automatically detects the schema.

* Using this function, you can only delete datasets created using the Notebooks APIs. When you delete a dataset, the rules that use the dataset return an error.

#### 6.12.2. Notebooks scheduler

### 6.13. Build XQL queries

#### Note

* If you have the Cortex Agentic Assistant, you can use natural language prompts to create and run XQL queries within the chat interface. For more information, see Create and run XQL queries with Agentic Assistant chat.Cortex Agentic AssistantCreate and run XQL queries with Agentic Assistant chat

#### 6.13.1. About the Query Builder

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

#### 6.13.2. How to build XQL queries

##### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

##### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

##### 6.13.2.1. Get started with XQL queries

###### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

##### 6.13.2.2. Useful XQL user interface features

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

##### 6.13.2.3. XQL Query best practices

##### 6.13.2.4. Expected results when querying fields

##### 6.13.2.5. Create XQL query

###### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined for the entire query, including queries that are part of the join stage. Yet, this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

##### 6.13.2.6. Review XQL query results

###### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* Results are received incrementally for the first 100K records, or up to 100MB worth of records, whichever comes first. After that, the next update is when the query has finished running completely.

* Real time query results are available only in the Query Builder and in free text query. Real time results are displayed only for queries run on hot datasets. The Sort option is available only after all the data is retrieved. When you formulate complex queries, the results will be displayed when the query has finished running completely, and not in real...

* In order for Cortex XSIAM to provide a histogram for a field, the field must not contain an array or a JSON object.

##### 6.13.2.7. Translate to XQL

###### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

##### 6.13.2.8. Graph query results

###### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

#### 6.13.3. Query Builder templates

##### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

##### 6.13.3.1. Get started with Query Builder templates

##### 6.13.3.2. Considerations for using Query Builder templates

##### 6.13.3.3. Create a query from a template

###### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

##### 6.13.3.4. Run a free text query

###### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

##### 6.13.3.5. Query Builder template examples

###### Navigation

  Investigation & Response → Search → Query Builder

#### 6.13.4. Overview of the Query Center

##### Note

* Very short queries might not be listed. The default retention period for historic queries is aligned with issue retention.

##### 6.13.4.1. Edit and run queries in Query Center

###### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

###### Navigation

  Investigation & Response → Search → Query Center → Query History

###### 6.13.4.1.1. Query Center reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 6.13.5. Manage scheduled queries

##### Navigation

  Investigation & Response → Search → Scheduled Queries

##### 6.13.5.1. Scheduled Queries reference information

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 6.13.6. Manage your query library

##### Note

* The Query to Library option is only available if your role has the Create Queries capability. For more information, see Manage access to saved queries.Manage access to saved queries

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

##### Important

* The ability to create, edit, or share queries is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to saved queries.Manage access to saved queries

#### 6.13.7. Federated Search

##### 6.13.7.1. Federated Search

###### Note

* Federated Search is not enabled by default. To enable it in your tenant, please contact your Customer Support Team.

* Federated search query costs are calculated according to timeframe, complexity, and any cross-cloud egress costs that may apply.

* For optimal results, we recommend the Parquet format.

* The list of supported regions may change in the future.

##### 6.13.7.2. Federated Search configuration

###### Prerequisite

* Access to Cortex XSIAM communication. For a list of the authorized IP addresses, see Enable access to required PANW resources. An AWS bucket that contains your data sources. Permissions to modify IAM policies in AWS.

* Access to Cortex XSIAM communication. For a list of the authorized IP addresses, see Enable access to required PANW resources. A GCS bucket that contains your data sources. Permissions to modify IAM policies in GCS.

* Access to Cortex XSIAM communication. For a list of the authorized IP addresses, see Enable access to required PANW resources. An Azure Blob Storage blob with your data sources. Permissions to modify IAM policies in Azure Blob Storage.

###### Note

* We highly recommend that you don't change the auto-detected schema. However, if the auto-detected schema is incorrect, you can add, edit or delete fields. You can't delete the ds field, which is used for Hive partitioning. After you save the schema, you can't delete any fields you added during setup.

* You can only configure regions that are in the multi-region of your tenant.

* We highly recommend that you don't change the auto-detected schema. You can't delete the ds field, which is used for Hive partitioning. After you save the schema, you can't delete any fields you added during setup.

* Copy the Directory (tenant) ID, the Application (client) ID, and the Object ID. You will use these in the connection step.

* We highly recommend that you don't change the auto-detected schema. However, you can add, edit or delete fields. You can't delete the ds field, which is used for Hive partitioning. After you save the schema, you can't delete any fields you added during setup.

* When you create, delete, or update an external dataset, the action is recorded in the Management Audit Logs under the type External Datasets.

###### Navigation

  Settings → Configurations → Data Management → Dataset management → External Datasets and click Add External Dataset

##### 6.13.7.3. Query using Federated Search

###### Note

* The following aren't available in Federated Search and remain exclusive to fully ingested data. Complex, cross-source analytical functions, for example correlations, widgets, dashboards, and APIs search, target and view XQL stages

###### Navigation

  Incident Response → Investigation → Query Builder and select XQL

##### 6.13.7.4. Manage external datasets

###### Note

* We highly recommend that you don't change the auto-detected schema. However, in the Edit window you can add new fields or delete the new fields you added in the Edit window. You can't delete the fields that were configured during setup.

###### Navigation

  Manage external datasets created for federates searches in Settings → Configurations → Data Management → Dataset management → External Datasets

#### 6.13.8. Legacy Query Builder

##### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

##### 6.13.8.1. Create authentication query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.13.8.2. Create event log query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.13.8.3. Create file query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.13.8.4. Create image load query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.13.8.5. Create network connections query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.13.8.6. Create network query

###### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

##### 6.13.8.7. Create process query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.13.8.8. Create registry query

###### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

##### 6.13.8.9. Query across all entities

###### Navigation

  Investigation & Response → Search → Query Builder

### 6.14. Research a known threat

## 7. Threat management

### 7.1. Detection rules

#### 7.1.1. What are detection rules?

##### 7.1.1.1. What's an IOC?

###### Note

* Cortex XSIAM supports a maximum of 4,000,000 IOCs.

###### 7.1.1.1.1. IOC rule details

####### Note

* Field cannot exceed 36 characters.

####### Navigation

  In the Threat Management → Detection Rules → IOC page, you can view all configured or uploaded indicators of compromise (IOCs

###### 7.1.1.1.2. Create an IOC rule

####### Note

* To ensure your IOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically does the following: Disables any IOC rules that reach 5000 or more hits over 24 hours. Creates a rule exception based on the PROCESS SHA256 field for IOC rules that hit more than 100 endpoints over 72 hours. If you have the Threat...

####### Navigation

  In Threat Management → Detection Rules → IOC, select + Add IOC

##### 7.1.1.2. What's a BIOC?

###### 7.1.1.2.1. BIOC rule details

####### Navigation

  Manage your behavioral indicator of compromise (BIOC) rules in Threat Management → Detection Rules → BIOC

###### 7.1.1.2.2. Create a BIOC rule

####### License Type

  Custom prevention rules are supported on Cortex XSIAM agent 7.2 and later versions and enable you to configure and apply user-defined BIOC rules to Restriction profiles deployed on your Windows, Mac, and Linux endpoints.

####### Note

* To ensure your BIOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically does the following: Disables BIOC rules that reach 5000 or more hits over a 24-hour period. Creates a rule exception based on the PROCESS SHA256 field for BIOC rules that hit more than 100 endpoints over a 72 hour period.

* A cloud_audit_log dataset requires a Cortex XDR Pro per GB license. Currently, you cannot create a BIOC rule on customized datasets and only the filter stage, alter stage, and functions without any aggregations are supported for XQL queries that define a BIOC. For BIOC rules, the field values in XQL are evaluated as case insensitive (config...

* To demonstrate the expected behavior of the rule before you save it, Cortex XSIAM tests the BIOC on historical logs. After you save a BIOC rule, it will operate both on historical logs (up to 10,000 hits) and on new data received from your log sensors.

* To demonstrate the expected behavior of the rule before you save it, Cortex XSIAM tests the BIOC on historical logs. After you save a BIOC rule, it will operate on both historical logs (up to 10,000 hits) and new data received from your log sensors.

* You can only import files that were exported from Cortex XSIAM. You can not edit an exported file.

* You can only add to existing profiles you created, Cortex XSIAM Default profiles will not appear as an option.

* Auto-disable will turn off both the BIOC rule detection and the BIOC prevention rule.

###### 7.1.1.2.3. Manage Global BIOC Rules

##### 7.1.1.3. What's a correlation rule?

###### Navigation

  After you configure your correlation rules, you can manage them in Threat Management → Detection Rules → Correlations, and view and analyze the generated issues in Cases and the Issues Table

###### 7.1.1.3.1. Correlation rule details

####### Note

* Only an administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM .

* For more information on troubleshooting server errors in scheduled correlation rules, Troubleshoot server errors in scheduled correlation rules.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

####### Navigation

  If you are assigned a role that enables Investigation → Rules privileges, you can manage all user-defined Correlation Rules from Threat Management → Detection Rules → Correlations

###### 7.1.1.3.2. Create a correlation rule

####### Prerequisite

* To enable pivots from issues to a third-party source system, ensure that you know the dataset field name that contains the URL of the source system. Some vendors already provide this URL as part of their API, and you can find it in the third-party product dataset. If there is no URL, you cannot enable this feature.

####### Note

* When creating a Real Time Correlation Rule, you can only generate an issue as the resulting action for the Correlation Rule. All other options are disabled. To ensure your Correlation rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically disables Correlation rules that reach 5000 or more hits over a...

* When you open the New Correlation Rule editor from XQL Search, this XQL Search field is already populated with the XQL query that you defined. An administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM . All other users can only create and view queries built with an existing dataset.

* The XQL features for call, top, and wildcards in datasets (dataset in (<dataset prefix>_*)) are currently not supported in Correlation Rules. If you add them to the XQL definition, you will not be able to Create or Save the Correlation Rule. The XQL features for transaction in datasets (dataset in (<dataset prefix>_*)) are currently not supported in...

* The incident that contains the issues will also be assigned to the selected domain. For more information, see Case and issue domains. If you want to generate a health issue, choose the Health domain. For more information about health issues, see About health issues.

* If a generated issue has severity Medium or above, a case is automatically opened. Low severity issues generated by correlation rules are not grouped into cases.

* There is no validation or auto complete for these parameters and the values can be null or empty. In these scenarios, Cortex XSIAM does not display the null or empty values, but adds the text NULL or EMPTY in the descriptions.

* When more than one XDM field is listed, Cortex XSIAM looks for the field value according to the order of the fields listed.

* When Use the Cortex XSIAM default incident enrichment is not selected and you have not mapped any issue fields, the issue is dispatched into a new incident.

####### Important

* The maximum size of a lookup dataset is 50 MB. If the data exceeds this limit, the add to lookup action fails.

####### Tip

* When creating your correlation rule, you can use predefined values for different fields in the editor, such as Alert Name, Alert Description, and Drill-Down Query. For more information, see Field replacement syntax in correlation rules.

####### Navigation

  You can create a new correlation rule from either the Threat Management → Detection Rules → Correlation Rules page or when building a query in XQL Search

###### 7.1.1.3.3. Field replacement syntax in correlation rules

###### 7.1.1.3.4. Manage correlation rules

####### Note

* Execute Rule is not available for real time correlation rules.

###### 7.1.1.3.5. Monitor correlation rules

####### Note

* In the dataset, the Query start time and Query end time indicate the time frame of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

###### 7.1.1.3.6. Troubleshoot server errors in scheduled correlation rules

##### 7.1.1.4. Manage IOC and BIOC rules

###### Note

* For Analytics BIOC rules, you can only disable and enable rules.

* You cannot delete global BIOCs delivered with content updates.

* For BIOC rules that are applied to prevention profiles: If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention on the agent works as usual. If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention...

* When a BIOC rule is disabled automatically by Cortex XSIAM, for example due to the server anti flooding mechanism, prevention on the agent works as before.

###### Navigation

  Threat Management → Detection Rules → BIOC

### 7.2. Analytics

#### 7.2.1. Analytics overview

##### 7.2.1.1. Analytics engine

##### 7.2.1.2. Analytics sensors

##### 7.2.1.3. Coverage of MITRE Attack tactics

##### 7.2.1.4. Review MITRE ATT&CK framework coverage

###### Note

* When a contributing data source type is active, it does not imply that all the rules and detectors associated with the data source type are active. Rule applicability is dependent on the data source's context and configuration. To enable an active status, data source types require the following setup: Endpoint: Installed Cortex XDR agent. Network: A...

##### 7.2.1.5. Analytics detection time intervals

###### Note

* When establishing a baseline, detectors compute limits beyond which network activity will require an issue. In some cases, detectors do not compute baseline limits; instead they are predetermined by Cortex XSIAM engineers. The engineers determine the values used for predetermined limits using statistical analysis of malicious activity recorded...

##### 7.2.1.6. Analytics issues and Analytics BIOCs

##### 7.2.1.7. View and manage Analytics rules

###### Note

* The default severity is updated by content updates. If a content update determines a new default severity for the rule that's the same as the value you had previously determined, you won't have the option to reset to default. For example, if the default was Informational, and you changed the severity to Medium, and after a content update Cortex XSIAM...

* When you select multiple rows, you can only enable or disable the selected rules.

###### Warning

* Changing the default severity may result in issues not being triggered or too many issues being triggered. Please consider this carefully before you change the severity recommended by Cortex XSIAM. Any responsibility for not getting issues triggered as a result of changing the severity will be yours.

##### 7.2.1.8. Identity Analytics

###### Navigation

  After configuring your Cloud Identity Engine instance and Cortex XSIAM Analytics, select Settings () → Configurations → Cortex XSIAM - Analytics, and in the Featured in Analytics section, Enable Identity Analytics

##### 7.2.1.9. Identity Threat Module (ITDR)

##### 7.2.1.10. AI Detection & Response in Cortex XSIAM (Beta)

###### Prerequisite

* To enable AIDR, you must have one of the following user roles: Instance Admin or Account Admin.

###### Navigation

  Settings → Configurations → Cortex - Analytics

###### 7.2.1.10.1. Data sources and supported services

###### 7.2.1.10.2. AI Detection & Response Dashboard

###### 7.2.1.10.3. Collect prompt logs

### 7.3. Threat Intel Management

#### 7.3.1. Get started with Threat Intel Management

##### Note

* You must have the Cortex XSIAM Premium license or any other XSIAM license with the Threat Intel Management (TIM) add-on to use this feature.

##### 7.3.1.1. What is Threat Intel Management?

###### Note

* You must have the Cortex XSIAM Premium license or any other XSIAM license with the Threat Intel Management (TIM) add-on to use this feature.

##### 7.3.1.2. Threat Intel Management use cases

##### 7.3.1.3. Roles and responsibilities in Threat Intel Management

##### 7.3.1.4. Indicator concepts

###### Note

* You can store up to 100,000,000 indicators.

##### 7.3.1.5. Indicator lifecycle

###### Note

* To run enhancement scripts and reputation commands, you must configure a relevant enrichment integration, such as VirusTotal, IPinfo v2, etc.

###### Tip

* We recommend defining your policy for handling expired indicators.

#### 7.3.2. Indicator configuration

##### 7.3.2.1. Configure Threat Intelligence feed integrations

###### Note

* Some third-party services (such as Whois and VirusTotal) enforce strict rate limits based on the source IP address. If you encounter quota management issues, we recommend running them on an engine. This routes the traffic through your own private network, ensuring the external service sees a unique, dedicated IP address exclusive to your organization.

* Some feeds only provide information about new indicators and do not specify when indicators are removed. Indicators from these feeds cannot be automatically expired on removal. If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its...

##### 7.3.2.2. Customize indicator fields and types

###### 7.3.2.2.1. Create an indicator type

####### Note

* If you miss mapping any field, you can create additional new indicator fields and either relate them to all indicator types, or relate them only to the new indicator type (recommended).

####### Navigation

  Settings → Configurations → Object Setup → Indicators → Types

####### 7.3.2.2.1.1. Indicator type profile

######## Note

* Indicator cache expiration rules only apply to standard enrichment (for example, running the enrichIndicators command). If you run a reputation command, such as !ip, the commands executes even if the cache has not expired.

######## Tip

* To control which integrations run when explicitly executing a command (and not during enrichment), add the using-brand argument to specify only the integrations you want to use. For example: !url url="https://www.google.com" using-brand="AutoFocus V2,VirusTotal"

####### 7.3.2.2.1.2. File indicators

######## Note

* A new File indicator only affects new indicators ingested to the Cortex XSIAM platform. Indicators that were already in Cortex XSIAM continue to appear as their respective hash-related indicators.

######## Navigation

  Settings → Configurations → Object Setup → Indicators → Types

####### 7.3.2.2.1.3. Formatting scripts

######## Note

* Formatting scripts must have the indicator-format tag to appear in the list.

* Formatting scripts for out-of-the-box indicator types are system-level, which means that the formatting scripts for these indicator types are not configurable. To create a formatting script for an out-of-the-box indicator type, you need to disable the existing indicator type and create a new (custom) indicator type. If you configured a formatting...

####### 7.3.2.2.1.4. Enhancement scripts

######## Note

* Enhancement scripts are different from reputation commands. A reputation command runs every integration that has that command within it, to enrich the indicator. The reputation command ip , for example, runs every IP integration command in your enabled integrations, to collect data from multiple sources. An enhancement script is manually run after the...

* Enhancement scripts must have the enhancement tag applied to appear in the list.

####### 7.3.2.2.1.5. Reputation scripts

######## Note

* Reputation scripts must have the reputation tag applied to appear in the list.

####### 7.3.2.2.1.6. Reputation commands

######## Note

* Running a reputation command directly (such as !ip) might not apply the result to an indicator, nor does it use the enrichment cache. To ensure an indicator is enriched, and to take advantage of caching, use the enrichIndicators command or the Enrich button in the UI. This runs the appropriate reputation command/script based on the indicator type...

####### 7.3.2.2.1.7. Map custom indicator fields

######## Note

* Some integrations have indicator mappers and classifiers, such as AWS. If you want to use an integration mapper or classifier, see Indicator classification and mapping.

######## Navigation

  Settings → Configurations → Object Setup → Indicators → Types

###### 7.3.2.2.2. Create an indicator field

####### Note

* Cortex XSIAM IOC fields are based on the STIX 2.1 specifications. For more information, see Indicator field structure.

* The following HTML tags are not permitted: blockquote, del, dd, div, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, iframe, ins, li, math, noscript, ol, pre, p, script, style, table, ul, address, article, aside, canvas, details, dialog, figcaption, figure, footer, header, hgroup, main, nav, output, progress, section, video. The following CSS tags...

####### Navigation

  Settings → Configurations → Object Setup → Indicators → Fields → New Field

####### 7.3.2.2.2.1. Indicator field structure

####### 7.3.2.2.2.2. Indicator field trigger scripts

######## Note

* Indicator field trigger scripts must have the field-change-triggered-indicator tag to appear in the list.

##### 7.3.2.3. Indicator classification and mapping

###### Note

* When creating a new indicator type, you classify and map the indicator fields in the indicator type settings. For more details, see Map custom indicator fields.

* You can optionally skip importing data. Click the pencil on the right of each indicator type on the right pane to enter the value manually.

* In the Classification & Mapping page, the mapping does not indicate for which indicator types they are configured. When creating a mapper, it is best practice to add to the mapper name and the indicator type the mapper is for. For example, Mail Listener - Phishing. When mapping a list, we recommend you map to a multi-select field. Short text fields do...

##### 7.3.2.4. Indicator extraction

###### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Reputation commands, such as !ip and !domain, can only be used after you configure and enable a reputation integration instance, such as VirusTotal and Whois.

* The inline configuration may delay playbook execution.

* While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks. All indicators are automatically extracted and enriched before a playbook is run. For an on-field change, extraction occurs before the next playbook tasks run.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

###### 7.3.2.4.1. Set the indicator extraction mode for a playbook task

###### 7.3.2.4.2. Disable indicator extraction for scripts or integrations

####### Note

* The TIM add-on is included in the Cortex XSIAM Premium license.

##### 7.3.2.5. Configure Threat Intelligence feed integrations

###### Note

* Some third-party services (such as Whois and VirusTotal) enforce strict rate limits based on the source IP address. If you encounter quota management issues, we recommend running them on an engine. This routes the traffic through your own private network, ensuring the external service sees a unique, dedicated IP address exclusive to your organization.

* Some feeds only provide information about new indicators and do not specify when indicators are removed. Indicators from these feeds cannot be automatically expired on removal. If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its...

##### 7.3.2.6. Exclude indicators from enrichment

##### 7.3.2.7. Generate issues from indicators using indicator rules for prevention and detection

###### Note

* Indicators should be present in the Threat Intelligence database (Threat Management → Threat Intelligence → Indicators) before creating detection and prevention rules.

* Although you can create IOC rules for detection, indicator rules are designed to leverage threat intelligence indicators like MD5 and SHA256 hashes that are present in your TIM library. These rules directly integrate with and rely on the indicators ingested and managed by TIM. Indicators must be in the TIM database before creating these rules. For more...

* You can't change the Preventable = True, Status = Active and Type = File filters, which comply with the requirements of the supported indicator type for Prevention on the Agent.

* The Indicator Rule shows the number of issues generated by the rule, You can view the issues that were generated using the Indicator rule, by right-clicking the rule and select View related issues.

* You can't change the Detectable = True and Status = Active filters, which comply with the requirements of the supported indicator type for detection.

* The Issue source is Threat Intelligence.

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

##### 7.3.2.8. Export indicators

###### Caution

* You should not run a query on a field that you might change in the playbook flow. For example, you shouldn't have a playbook with query Verdict:Malicious and then change the indicator verdict as a part of the playbook.

#### 7.3.3. Indicator management

##### Note

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

#### 7.3.4. Indicator investigation

##### 7.3.4.1. Indicator verdict

##### 7.3.4.2. Extract and enrich an indicator

###### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Triggering enrichment on a substantial number of indicators can take time (because it's activating all enrichment integrations per indicator) and can result in performance degradation.

* Reputation commands, such as !ip, !domain can only be used when you configure and enable a reputation integration instance, such as VirusTotal and WHOIS.

##### 7.3.4.3. Expire an indicator

###### Note

* You need to run these commands in the Case or Issue War Room.

##### 7.3.4.4. Manage indicator relationships

###### Note

* You can also add an indicator relationship from the Quick View when selecting an indicator from an issue.

##### 7.3.4.5. Delete and exclude indicators

###### Caution

* Ensure you are using the correct syntax when defining the values for your exclusion lists.

## 8. Inventory management

### 8.1. Asset management

#### 8.1.1. All Assets

##### Note

* When working with the Asset Inventory page, consider the following: To maintain an accurate and clutter-free asset inventory, an automated cleanup process periodically removes outdated assets in the background.

* The options available are dependent on your license.

##### 8.1.1.1. Container Images

###### Navigation

  All Assets → Compute → Container Images

##### 8.1.1.2. Kubernetes Cluster

###### Note

* The Vulnerabilities tab is only available if the cluster you wish to analyze has a K8s connector.

###### Navigation

  Inventory → All Assets → Compute → Kubernetes Cluster for a Kubernetes Clusters assets overview

##### 8.1.1.3. Container Instances

###### Navigation

  Asset Inventory → Compute → Container Instances

##### 8.1.1.4. External Surface assets

###### License Type

  Requires the Attack Surface Management (ASM) add-on

###### 8.1.1.4.1. External Surface attribution evidence

#### 8.1.2. Network configuration

##### 8.1.2.1. Configure your network parameters

###### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

* Viewing external IP address ranges requires the Attack Surface Management add-on.

###### Navigation

  In Cortex XSIAM , select Assets → Network Configuration → Internal Domain Suffixes

#### 8.1.3. Asset Groups

##### Note

* When you create or edit an Asset Group, the changes are applied immediately to new assets and to existing assets that have been updated. However, it may take a few hours for the changes to appear on existing assets that have not been updated.

##### Navigation

  Inventory → Assets → Groups → Add Group

#### 8.1.4. Asset Roles

##### Note

* Asset Roles are available only if the Identity Threat Module add-on is enabled.

##### 8.1.4.1. Manage Asset Roles for Endpoints

###### Note

* Endpoint Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added endpoint removes the endpoint from the Included Endpoints list. If this endpoint is detected automatically as having this asset role in the future, it will appear in the Included Endpoints list. Excluding a manually added endpoint ensures that even if in the future the endpoint is detected as having this asset role, this...

##### 8.1.4.2. Manage Asset Roles for Users

###### Note

* User Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added user removes the user from the Included Users list. If this user is detected automatically as having this asset role in the future, it will appear in the Included Users list again. Excluding a manually added user ensures that even if in the future the user is detected as having this asset role, this detection is overridden and...

###### 8.1.4.2.1. Honey user

####### Prerequisite

* The honey user role is available only if the Identity Threat Module add-on is enabled.

#### 8.1.5. Manage Asset Scores

##### Note

* The Hosts tab is available if the Identity Threat Module add-on is enabled.

* As new alerts are associated with incidents, the User and Host Scores are recalculated. You can view the latest User and Host Scores on the Asset Scores page, or track the Score trend on the User Risk View and Host Risk View.

* Some User Associated Insights may not appear as part of the User Associated Incidents due to the insight generation mechanism. For example, when an insight related to one of the assets in an incident is generated a few days after the associated incident, the insight may not be associated with the incident.

#### 8.1.6. Vulnerability Assessment

##### Prerequisite

* The following are prerequisites for Cortex XSIAM to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XSIAM lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex XSIAM...

* The following are prerequisites for Cortex XSIAM to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex XSIAM collects all the information about the operating system and the installed...

##### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex XSIAM Application Inventory.

##### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

##### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

## 9. Modules

### 9.1. Discovery Engine

#### 9.1.1. What is the Discovery Engine?

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM product that has the Cloud Runtime Security or Cloud Posture Security add-ons.

### 9.2. Cortex Cloud AI Security

#### 9.2.1. What is Cortex Cloud AI Security?

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### 9.2.2. Supported services in Cortex Cloud AI Security

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### 9.2.3. Cortex Cloud AI Security concepts

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### 9.2.4. Cortex Cloud AI Security use cases

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### 9.2.5. How to perform advanced AI Security investigations using XQL

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* For more information, see Build XQL queries.Build XQL queries

### 9.3. Cortex Cloud Application Security

#### 9.3.1. Onboard Data Sources

##### 9.3.1.1. Onboard version control systems

###### Note

* Application Security (which includes IaC and Secrets scanning), is an add-on to a license (such as Posture Security) that must be purchased separately.

* Disclaimer: When onboarding with third-party data sources, we outline the required steps for setup, but we do not monitor these external resources, and they may change over time. Always refer to the relevant third-party documentation for the most current integration steps.

###### Tip

* Navigate to Settings → Data Sources & Integrations → + Add New →  and enter your VCS data source in the search bar.

###### 9.3.1.1.1. AWS CodeCommit

####### Prerequisite

* Before you begin: In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the following options:    Dedicated user roles: AppSec Admin or Instance Administrator role   Custom roles (RBAC): View & Edit permissions for Data Sources In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions...

####### Note

* The Resource Name Prefix and ExternalID fields are pre-populated. You can modify the Resource Name Prefix, but DO NOT change the ExternalID!

* To create an additional AWS CodeCommit instance: Hover over the AWS CodeCommit card in the catalog and click Connect Another.

###### 9.3.1.1.2. Azure DevOps

####### Prerequisite

* Before you begin: In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the following options:    Dedicated user roles: AppSec Admin or Instance Administrator role   Custom roles (RBAC): View & Edit permissions for Data Sources In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions...

* An Azure account that has an active subscription The Azure account must be at least a Application Developer An external tenant

* Before you begin: Confirm your Azure DevOps organization is connected to Microsoft Entra ID. For more information refer to https://learn.microsoft.com/en-us/azure/devops/organizations/accounts/connect-organization-to-azure-ad?view=azure-devops Enable Third-Party Application Access via OAuth: In Azure, navigate to Organization Settings → Security →...

####### Note

* To create an additional Azure Repos instance: Hover over the Azure Repos card in the catalog and click Connect Another.

####### Navigation

  Settings → Data Sources & Integrations → + Add New

  User Settings → Personal access tokens → + New Token

###### 9.3.1.1.3. Bitbucket Cloud

####### Prerequisite

* Before you begin: In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the following options:    Dedicated user roles: AppSec Admin or Instance Administrator role   Custom roles (RBAC): View & Edit permissions for Data Sources In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions...

####### Note

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Cloud instance: Hover over the Bitbucket Cloud card in the catalog and click Connect Another.

###### 9.3.1.1.4. Bitbucket Data Center

####### Prerequisite

* Before you begin: In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the following options:    Dedicated user roles: AppSec Admin or Instance Administrator role   Custom roles (RBAC): View & Edit permissions for Data Sources In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions...

####### Note

* By default, the permissions of the access token are set according to your current access level. It is essential to define two levels of permissions, Project and Repository permissions. The Repository permissions inherit from Project permissions, requiring Repository permissions to match or exceed Project permissions Providing read and write permissions...

* For additional security, it is recommended to set an expiry automatically. The expiry date of a token cannot be changed after it is created. You can see the expiry dates for all your tokens on Profile picture → Manage account → Personal access tokens.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Data Center instance: Hover over the Bitbucket Data Center card in the catalog and click Connect Another.

####### Important

* Always refer to the Bitbucket documentation for information relating to creating a PAT.

###### 9.3.1.1.5. GitHub Cloud

####### Prerequisite

* Before you begin: In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the following options:    Dedicated user roles: AppSec Admin or Instance Administrator role   Custom roles (RBAC): View & Edit permissions for Data Sources In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions...

####### Note

* To create an additional GitHub SaaS instance: Hover over the GitHub SaaS card in the catalog and click Connect Another.

####### Navigation

  Settings → Data Sources & Integrations → + Add New

  Verify integration: On Data Sources, select Code Providers → GitHub SaaS → View more and confirm that the status of your integrated GitHub instance is 'Connected

###### 9.3.1.1.6. GitHub Enterprise (On-Prem)

####### Prerequisite

* Before you begin: In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the following options:    Dedicated user roles: AppSec Admin or Instance Administrator role   Custom roles (RBAC): View & Edit permissions for Data Sources In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions...

####### Note

* The domain is the hostname associated with your GitHub Enterprise (On-Prem) instance.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitHub Enterprise (On-Prem) instance: Hover over the GitHub Enterprise (On-Prem) card in the catalog and click Connect Another.

###### 9.3.1.1.7. GitLab SaaS

####### Prerequisite

* Before you begin: In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the following options:    Dedicated user roles: AppSec Admin or Instance Administrator role   Custom roles (RBAC): View & Edit permissions for Data Sources In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions...

####### Note

* A repository can only be integrated with a single instance. The first instance that connects with the repository will be the one that the repository is assigned to. This means that if multiple integrations attempt to connect to the same repository, only the first integration to establish the connection will be associated with that repository.

* To create an additional GitLab SaaS instance: Hover over the GitLab SaaS card and click in the catalog and Connect Another.

###### 9.3.1.1.8. GitLab Self Managed (On-Prem)

####### Prerequisite

* Authorize the user integrating Application Security with your GitLab Self Managed (On-Prem) instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including all groups...

####### Note

* The domain is the hostname associated with your GitLab Self Managed (On-Prem) instance.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitLab Self Managed (On-Prem) instance: Hover over the GitLab Self Managed (On-Prem) card in the catalog and click Connect Another.

##### 9.3.1.2. Onboard CI/CD systems

###### 9.3.1.2.1. Onboard CircleCI for CI/CD pipeline scans

####### Prerequisite

* Before you begin: In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the following options:    Dedicated user roles: AppSec Admin or Instance Administrator role   Custom roles (RBAC): View & Edit permissions for Data Sources In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions...

####### Note

* This integration utilizes a Personal Access Token (PAT) for authentication CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate...

* Select Connect Another Instance if the data source instance has already been configured.

* To add an additional CircleCI instance, navigate to Settings → Data Sources & Integrations → , select the connected CircleCI integration, click  → Add Instance, and repeat the onboarding steps above.

###### 9.3.1.2.2. Onboard Jenkins for CI/CD pipeline scans

####### Prerequisite

* In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the following options:    Dedicated user roles: AppSec Admin or Instance Administrator role   Custom roles (RBAC): View & Edit permissions for Data Sources In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the...

####### Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for code scans, refer to Onboard...

* Select Connect Another Instance if the data source instance has already been configured.

* The integration is added on the console but integration is pending, and will only be completed after completing step 5 below. You can view the pending integration on the Jenkins Instances page: Select Data Sources →  Jenkins → View Details. The type of integration is Pipeline Risks

* Always refer to the official Jenkins documentation when installing plugins on Jenkins servers.

* To add an additional Jenkins instance, navigate to Settings → Data Sources → select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps above.

##### 9.3.1.3. Integrate CI tools

###### Navigation

  Settings → Data Sources & Integrations → hover over a CI tool → View Details

  Delete an instance: Right-click on an instance of the CI tool → Delete instance → Delete

###### 9.3.1.3.1. AWS CodeBuild

####### Prerequisite

* Before you begin:

####### Note

* Select Connect Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional AWS CodeBuild instance, navigate to the Settings → Data Sources & Integrations →  page, select the connected AWS CodeBuild integration, click → Add Instance, and repeat the onboarding steps above.

###### 9.3.1.3.2. Onboard CircleCI for code scans

####### Prerequisite

* Before you begin:

####### Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for CI/CD scans, refer to...

* Select Connect Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* To add an additional CircleCI instance, navigate to Settings → Data Sources & Integrations → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

####### Important

* The cortex-secrets naming convention for the context is mandatory to ensure functionality and must not be changed.

###### 9.3.1.3.3. Connect Cortex CLI

####### Prerequisite

* System requirements (OS-specific): The following operating system dependencies are required to run the Cortex XSIAM CLI binary on specific architectures.    macOS (Intel Core i7, such as Sequoia):    To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew. Use this command: brew install vectorscan      RHEL...

####### Note

* Select Add Another Instance if a CLI instance is already onboarded.

* In the command above, {version} refers to the CLI version you wish to install (such as latest or a specific number), and {platform} refers to your operating system (such as, linux, darwin, windows).

####### Warning

* Using With upload results permissions may incur additional costs as per your license agreement.

###### 9.3.1.3.4. GitHub Actions

####### Prerequisite

* Before you begin:

####### Note

* Select Connect Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional GitHub Actions instance, navigate to Settings → Data Sources & Integrations → select the menu for your connected GitHub Actions instance → + New Instance, and repeat the onboarding steps above.

###### 9.3.1.3.5. Onboard Jenkins for code scans

####### Prerequisite

* Grant Administrator permissions to the user integrating Application Security with Jenkins Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurations.Egress configurations

* For Application Security CI tools, you must store secrets in Jenkins Credentials for use in your Jenkins pipelines using either of these methods:    Plain text storage: Store secrets directly as plain text in Jenkins Credentials. Access them in your pipeline using the credentials function, which retrieves the secret directly as plain text   Credentials...

####### Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for CI/CD scans, refer to Onboard...

* Select Connect Another Instance if the data source instance has already been configured.

* This step is only required for new pipelines For private repositories, ensure the necessary credentials are configured in Jenkins Credentials

* This ensures your build runs within a Docker environment. If a node without Docker is used, the build will fail.

* To add an additional Jenkins instance, navigate to Settings → Data Sources & Integrations →  select the Jenkins integration, click  → Add Instance, and repeat the onboarding steps.

###### 9.3.1.3.6. Onboard Terraform Cloud (Run Tasks)

####### Prerequisite

* Before you begin: Procure a Terraform cloud license that is either a trial license or a TF Cloud license at the TEAM & GOVERNANCE level Terraform permissions: Grant the user or team the following permissions, depending on integration:    Manage Workspaces permissions at the organization level. These permissions are required to attach and manage the run...

####### Note

* Skip this step if you plan on using an existing token.

* Select Connect Another Instance if the data source instance has already been configured.

* Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Cloud (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected your Terraform Cloud (Run Tasks) instance → + New Instance, and repeat the onboarding steps.

###### 9.3.1.3.7. Onboard Terraform Enterprise (Run Tasks)

####### Prerequisite

* Before you begin: Ensure access to a Terraform Enterprise console to enable you to provide a user or team token that authorizes Application Security to access workspaces and helps regulate run configurations Terraform Enterprise version compatibility: Ensure Run Tasks for workspaces on is compatible with version 1.1.9 and above Terraform Enterprise...

####### Note

* For container image vulnerabilities, Application Security performs 'Image Referencer' scans within Terraform Enterprise (Run Tasks), as full SCA scans are not currently supported.

* Skip this step if you plan on using an existing token.

* Select Connect Another Instance if the data source instance has already been configured.

* Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Enterprise (Run Tasks) instance, navigate to Settings → Data Sources & Integrations →  page, select the Terraform Enterprise (Run Tasks) integration, click  → Add Instance, and repeat the onboarding steps above.

##### 9.3.1.4. CLI pipeline code snippets

###### Prerequisite

* User permissions: Ensure the user performing the integration has permissions to edit pipeline configurations (such as YAML files).

##### 9.3.1.5. Onboard private package registries

###### 9.3.1.5.1. JFrog Artifactory

###### 9.3.1.5.2. Onboard JFrog Artifactory

####### Prerequisite

* In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the following options:    Dedicated user roles: AppSec Admin or Instance Administrator role   Custom roles (RBAC): View & Edit permissions for Data Sources In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the...

####### Note

* To authorize the scanner to connect through your firewall, select Enable access by IPs, and copy the displayed source IPs to your organization's allowlist.

* For Maven:    Select Mirror Registry if this repository mirrors an external repository   Use the Mirror Of value to define the duplication scope:    * mirrors all requests   Type a request [value]: Mirrors only specific requests (such as central). For Maven: Select Mirror Registry if this repository mirrors an external repository Use the Mirror Of...

##### 9.3.1.6. Supported third-party data sources

###### Note

* Only onboarded and scanned repositories can be mapped.

###### 9.3.1.6.1. Ingest Semgrep data

####### Prerequisite

* In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the following options:    Dedicated user roles: AppSec Admin or Instance Administrator role   Custom roles (RBAC): View & Edit permissions for Data Sources In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the...

####### Note

* Select Connect Another Instance if the data source instance has already been configured.

* Mapping establishes relationships between Semgrep projects and Cortex XSIAM code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects are ingested

###### 9.3.1.6.2. Ingest Snyk data

####### Prerequisite

* Permissions: The following user permissions are required:     In Cortex XSIAM: Ensure you have the required Data Sources View/Edit permissions through one of the following options:    Dedicated user roles: AppSec Admin or Instance Administrator role   Custom roles (RBAC): View & Edit permissions for Data Sources       Ensure that you have a connected...

####### Note

* Select Connect Another Instance if the data source instance has already been configured.

* Mapping establishes relationships between Snyk applications and Cortex XSIAM code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped applications are ingested

####### Navigation

  Modules → Application Security → Vulnerabilities (under Issues

###### 9.3.1.6.3. Ingest SonarQube SAST data

####### Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Generate and copy a SonarQube API token. Ensure to assign Web API scope to the API token. Refer...

####### Note

* Mapping establishes relationships between SonarQube Applications and Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

###### 9.3.1.6.4. Ingest Veracode SAST data

####### Prerequisite

* Permissions: The following user permissions are required:    Cortex Cloud: Instance Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions   Veracode: At minimum, Reviewer permissions are required Permissions: The following user permissions are required: Cortex...

####### Note

* Only mapped applications will be ingested.

* This is the recommended option to ensure complete coverage and successful operation of all features.

* Mapping establishes relationships between Veracode projects and Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

###### 9.3.1.6.5. Generic 3rd Party AppSec Collector

####### Important

* File uploads are limited to a maximum size of 10 MB.

####### 9.3.1.6.5.1. Onboard the 3rd Party AppSec Collector

######## Prerequisite

* Permissions: The following Cortex XSIAM user roles or RBAC permissions are required:    User roles: CortexCortex XSIAM Cloud Instance Admin, AppSec Admin   RBAC: View/Edit permissions for Data Sources configurations are required when not using a dedicated user role    For more information about user permissions and groups, refer to Assign user roles...

######## Note

* We recommend using the tool.driver.name from the SARIF file.

* This is the newly created generic collector API URL endpoint.

* Only the validity of the format is tested. No findings will be generated from the test file.

######## Warning

* The API key ID and API secret cannot be retrieved once the wizard is closed.

##### 9.3.1.7. Manage data source integrations

###### Tip

* To quickly find your data source integration, use the search bar.

##### 9.3.1.8. Transporter over Broker VM

###### Prerequisite

* Ensure you have the necessary permissions and have already set up your Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex XSIAM resources. The IP addresses for the Transporter are in the Broker VM Resources section of the Enable access to required PANW resources document Open port 4052 (inbound), which...

###### Note

* The broker enables multiple connections, allowing a single Transporter applet to connect to various VCS instances Multiple Transporter applets cannot be created on a single Broker VM. Each Broker VM is limited to a single Transporter applet instance

###### Warning

* The Transporter applet is not supported for FedRAMP customers.

###### 9.3.1.8.1. Set up a Transporter applet on Broker VM

####### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator)

####### Note

* You cannot add a Transporter applet through Clusters.

####### Navigation

  your AppSec Transporter under the App column → Configure → Add Connection (on the redirected AppSec Transporter setup page

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

###### 9.3.1.8.2. Set up a Transporter on your VCS

####### Prerequisite

* Ensure you have user permissions to onboard data sources.  Note The dedicated AppSec Admin role includes the required permissions. Ensure you have user permissions to onboard data sources. Before you begin you must setup a Transporter applet on your Broker VM. Refer to Set up a Transporter applet on Broker VM for more information

####### Note

* GitLab Enterprise webhook internal IP restriction: GitLab Enterprise's security policies prevent webhook subscriptions to internal IP addresses (such as broker addresses). These subscriptions can only be enabled through specific instance configuration. For more information, refer to https://docs.gitlab.com/security/webhooks/.

####### Navigation

  Settings → Data Sources & Integrations → + Add New → , and search for your VCS on-premises data source

#### 9.3.2. Application Security dashboard

##### Navigation

  Modules → Application Security → AppSec Dashboard

#### 9.3.3. Application Security Posture Management (ASPM)

##### 9.3.3.1. ASPM use cases

##### 9.3.3.2. ASPM key features

##### 9.3.3.3. ASPM user roles and permissions

###### Navigation

  You can view AppSec Admin permissions in the tenant by navigating to Settings → Configurations → Roles → AppSec Admin

##### 9.3.3.4. Code to Cloud

###### Navigation

  Full Code to Cloud (C2C) coverage is achieved when Cortex XSIAM can resolve the following chain: Repository → Pipeline → Image → (optional Registry) → Runtime resources (including VMs, VM images, and IaC-defined infrastructure

###### 9.3.3.4.1. Supported integrations

###### 9.3.3.4.2. Code to Cloud visibility

####### Navigation

  Topology graph: Located in the Business Applications side card, this tab visualizes the entire path to production (Code → Build → Deploy → Run), allowing you

###### 9.3.3.4.3. Code to Cloud troubleshooting

####### Note

* Empty state messages and troubleshooting guidance for missing lineage are only visible to users with an active license.

##### 9.3.3.5. ASPM Command Center

###### 9.3.3.5.1. ASPM Command Center workflow

####### Note

* Breakdown by type: Issues are further broken down by type (such as IAC or Secrets).

##### 9.3.3.6. Coverage

###### 9.3.3.6.1. Coverage in the user interface

####### Navigation

  Modules, → Application Security → AppSec Coverage

##### 9.3.3.7. Compliance for Application Security

###### 9.3.3.7.1. Infrastructure-as-Code (IaC) compliance

###### 9.3.3.7.2. Manage IaC compliance

####### Prerequisite

* Add these properties to the IaC Rules table through the Table Settings Menu, as they are not exposed by default.

####### Navigation

  Modules → Application Security → AppSec Polices → Add Policy

###### 9.3.3.7.3. CI/CD Compliance

####### Navigation

  To access Compliance, select Posture Management → Compliance → Reports or Assessment

####### 9.3.3.7.3.1. Create CI/CD compliance reports

######## Note

* The CI/CD module supports GitHub and GitLab provider types.

* For more information about about Asset Groups, refer to Asset Groups.

* CIS GitLab Benchmark, CIS GitHub Benchmark, and the OWASP Top 10 CI/CD Risks standards are supported.

* For more information about assessment profiles, refer to Use an assessment profile to run compliance checks on your assets.Use an assessment profile to run compliance checks on your assets

######## Navigation

  Posture Management → Compliance → Reports

##### 9.3.3.8. Urgency

###### 9.3.3.8.1. Urgency metrics

##### 9.3.3.9. Backlog baseline

###### 9.3.3.9.1. Backlog use cases

###### 9.3.3.9.2. Issue/Finding classification by scanner

####### Note

* In some cases/vendors, this is not accurate as findings are deleted every time new findings are uploaded. In such cases, the feature may not be accurate or supported For SAST, the vendor does not support policy in pull requests

* Scanner updates and new detections: When a security scanner is updated to support new languages, detection rules, or capabilities, any issues discovered by these new features for existing code are classified as part of the backlog.

###### 9.3.3.9.3. Using Backlog

##### 9.3.3.10. Service Lead Agreements (SLA)

###### 9.3.3.10.1. Configure and monitor Application Security SLAs

####### Navigation

  Settings → Configurations → Application Configuration (under Application Security

##### 9.3.3.11. Applications

###### 9.3.3.11.1. Defining Business Applications

####### 9.3.3.11.1.1. Defining business applications by Criteria

####### 9.3.3.11.1.2. Define applications by VCS criteria

######## Prerequisite

* Data source: Your Version Control System (e.g., GitHub, GitLab) must already be onboarded as a Data Source Permissions: You must have View/Edit permissions for Access Management SBAC: You can only create applications from VCS entities (Organizations, Projects, or Repositories) that are already included in your SBAC Asset Groups

######## Note

* This workflow allows you to unify assets across disparate providers (such as grouping a GitHub repository and a Bitbucket repository into one application) if they share naming conventions

####### 9.3.3.11.1.3. Manage application criteria

####### 9.3.3.11.1.4. Define applications by cloud tag-based criteria

######## Prerequisite

* Permissions: You must have View/Edit permissions for Access Management, or a role that includes these permissions.

######## Note

* You can only create applications based on the entities from onboarded Cloud accounts listed in the Cloud card.

* Kubernetes (K8S) labels: K8S labels are supported as tags for asset grouping only when they originate from a supported cloud provider; AWS, GCP, Azure, or OCI.

####### 9.3.3.11.1.5. How to manually build an application

######## Prerequisite

* Before you begin, ensure you have connected the necessary data sources. Refer to How to onboard data sources for more information.How to onboard data sources

######## Note

* These filters are represented by icons displayed on the Code pane after selecting a VCS.

* To edit application assets, click the Clear All icon before clicking Finish. This clears all application data, allowing you to restart the application building process from the beginning.

###### 9.3.3.11.2. Application management and visibility

####### Navigation

  Inventory → All Assets → Business Applications (under Application

###### 9.3.3.11.3. Business application assets

####### 9.3.3.11.3.1. Business application expanded asset details

######## Note

* The topology graph is available only when all application components (code, pipeline, build and deploy), are configured.

####### 9.3.3.11.3.2. Export business application data

######## Navigation

  Inventory → All Assets → Business Applications

###### 9.3.3.11.4. Scope user access to applications (Application SBAC)

####### Navigation

  Configure user scopes in Cortex XSIAM by navigating to Settings → Configurations → Access Management

####### 9.3.3.11.4.1. Enable SBAC in the Cortex XSIAM tenant

######## Prerequisite

* RBAC permissions: To configure user scopes you must have Administrator or View/Edit RBAC permissions for Access Management (under Configurations).

######## Note

* Exclusions (roles not governed by SBAC): Certain roles cannot have SBAC applied. For these roles, access and permissions are managed through Role-Based Access Control (RBAC). You must manually ensure that these roles have all necessary base permissions (for example Edit/View permissions to assets), because SBAC is bypassed and does not impose its usual...

######## Navigation

  Settings → Configurations → General → Server Settings → Enable Scope Based Access Control

####### 9.3.3.11.4.2. Create an application-based Asset Group

######## Note

* You cannot create SBAC based on static groups.

####### 9.3.3.11.4.3. Scope user access to an application

######## Note

* For more information about User Groups, refer to User group management.

######## Navigation

  Settings → Configurations → User Groups (under Access Management

  Right-click on a group in the table → Edit Group → select the Scope tab

  Assets → Select asset groups → select an Asset Group associated with applications

  Settings → Configurations → Users (under Access Management

  the chevron icon (>) in the Assets field → Select Asset groups → select the user group scoped to the application (see above

####### 9.3.3.11.4.4. Create application-scoped policies

######## Note

* Application-scoped policies apply to both code and CI/CD configuration policies.

######## Navigation

  Modules → Application Security → AppSec Polices (under Policy Management) → Add Policy

  Add Filter → Business Application Names → enter the required application name

##### 9.3.3.12. Repositories as assets

###### 9.3.3.12.1. Explore repository assets

###### 9.3.3.12.2. In-depth repository asset information

###### 9.3.3.12.3. Manage Repository assets

###### 9.3.3.12.4. Export Software Bill of Materials (SBOM)

###### 9.3.3.12.5. Manage issues detected in repositories

####### Note

* You can also find the repository issues in the general issue inventory table, and in the dedicated inventory of issues for each scanner type (see step 4 above for details).

##### 9.3.3.13. Manage 3rd party findings and generated issues

##### 9.3.3.14. Manage code weaknesses

###### Note

* You can customize policies to define which findings are categorized as issues.

###### Tip

* In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Code Weaknesses tab under the Repositories asset inventory. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from the table → Code Weaknesses In code Asset inventories, navigate to Inventory →...

###### Navigation

  To access SAST code violation issues, under Modules, select Application Security → Issues → Code Weaknesses

###### 9.3.3.14.1. Code weaknesses issue inventory

###### 9.3.3.14.2. Detailed code weakness issue information

####### Note

* Not all properties are shown for every issue; availability depends on the context and the information collected for that specific issue.

###### 9.3.3.14.3. Code weakness findings

####### Note

* Findings on the Cortex platform are not intended for direct action; but rather represent data collected by the platform. They must be promoted to issues to enable mitigation efforts to secure your codebase.

#### 9.3.4. CI/CD Security

##### 9.3.4.1. CI/CD Security user roles and permissions

##### 9.3.4.2. CI/CD Assets

###### 9.3.4.2.1. CI/CD Instances as assets

####### 9.3.4.2.1.1. Explore CI/CD Instance assets

######## Navigation

  To access CI/CD pipeline instances, under Inventory, select All Assets → Code → Category → CI/CD Instances

####### 9.3.4.2.1.2. In-depth CI/CD pipeline instance asset information

####### 9.3.4.2.1.3. Manage CI/CD pipeline instances

###### 9.3.4.2.2. CI/CD Pipelines as assets

####### 9.3.4.2.2.1. Explore CI/CD Pipeline assets

######## Navigation

  To access CI/CD pipelines assets, under Inventory, select All Assets → Code → CI/CD Pipelines

####### 9.3.4.2.2.2. In-depth CI/CD pipeline asset information

######## Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

####### 9.3.4.2.2.3. Manage CI/CD pipeline assets

###### 9.3.4.2.3. Version Control System (VCS) Organizations as assets

####### 9.3.4.2.3.1. Explore VCS Organization assets

######## Navigation

  To access VCS Organization assets, under Inventory, select All Assets → Code → VCS Organizations

####### 9.3.4.2.3.2. In-depth VCS Organization asset information

######## Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

####### 9.3.4.2.3.3. Manage VCS organization assets

###### 9.3.4.2.4. VCS Collaborators-as-assets

####### 9.3.4.2.4.1. In-depth Collaborator asset information

####### 9.3.4.2.4.2. Manage Collaborator assets

##### 9.3.4.3. Supply Chain Inventories

###### Note

* Although attributes are identical across inventories, their values for the same tool can differ, most commonly in Risk Factors and Type. This is because the inventory reflects your live environment, which may include different versions or configurations than the catalog—for example, a package may not have been upgraded or may be deployed differently.

###### Navigation

  In the inventory table, right-click on a tool → Change Status → select a status

###### 9.3.4.3.1. Supply Chain Tools

####### 9.3.4.3.1.1. Supply Chain Tools

######## Navigation

  To access Supply Chain Tools, select Modules → Application Security → Supply Chain Tools (under 3rd Party Tools

####### 9.3.4.3.1.2. Expanded Supply Chain tool information

######## Note

* AppSec Admin user permissions are required to perform these actions.

###### 9.3.4.3.2. Supply Chain Catalog

####### Navigation

  To access the Supply Chain Catalog, select Modules → Application Security → Supply Chain Catalog (under 3rd party tools

##### 9.3.4.4. CI/CD Risks

###### Note

* Application Security CI/CD pipeline scans create a comprehensive inventory of all CI/CD pipelines in your environment. For more information refer to CI/CD Pipelines as assets.

###### 9.3.4.4.1. CI/CD pipeline issues

####### Navigation

  To access CI/CD pipeline risks issues, under Modules, select Application Security → Issues → CI/CD Risks

###### 9.3.4.4.2. Expanded CI/CD risks issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 9.3.4.4.3. VCS and CI/CD pipeline risk findings

##### 9.3.4.5. CI/CD Rules

###### Note

* Out-of-the-box rules cannot be modified Custom CI/CD rules are not supported

###### 9.3.4.5.1. CI/CD rules roles and permissions

###### 9.3.4.5.2. CI/CD rules inventory

##### 9.3.4.6. CI/CD Policies

###### Tip

* For Cortex XSIAM Code policies, refer to Application Security Policies.

###### 9.3.4.6.1. CI/CD policies user roles and permissions

###### 9.3.4.6.2. CI/CD policies inventory

####### Note

* To view all out-of-the-box (OOTB) policies, filter by Policy Owner = System.

###### 9.3.4.6.3. Create custom CI/CD policies

####### Note

* PR Scan and CI Scan triggers are automatically disabled and unchecked. They can only be enabled if other scan types (that is non-CI/CD risk scans such as Secrets) are also selected, and will only run on non-CI/CD risks types of scans

* You can combine multiple conditions to create complex rules for when the policy should apply. Create conditions that apply to a CI/CD policy which detects high severity CI/CD risks on GitHub: Select Add Filter → Finding Type → CI/CD Risks → AND → Provider → [VCS/CI/CD system] → AND → Severity: → High.

* SBAC scope limitations do not apply to Matching Criteria For CI/CD policies, you can filter Matching Criteria by VCS Organization Name, CI/CD Pipeline [Name/ID], CI/CD Instance [Name/ID] or Collaborator [Name/Email/MFA Enabled/Last Observed]

###### 9.3.4.6.4. Manage CI/CD policies

####### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

#### 9.3.5. Code Security

##### 9.3.5.1. Code Security user roles and permissions

##### 9.3.5.2. Code Security assets

##### 9.3.5.3. Software packages as assets

###### 9.3.5.3.1. Explore software package assets

###### 9.3.5.3.2. In-depth software package asset information

##### 9.3.5.4. Infrastructure-as-Code (IaC) resources as assets

###### 9.3.5.4.1. Explore IaC assets

####### Navigation

  To access IaC assets, under Inventory, select All Assets → Code → IaC Resources

###### 9.3.5.4.2. In-depth IaC resource asset information

##### 9.3.5.5. Code Security scanners

##### 9.3.5.6. Secrets scanners

###### 9.3.5.6.1. Secretsissues

####### Navigation

  Under Modules, select Application Security → Issues → Secrets

  Inventory → All Assets → Code: On the Secrets tab under Repositories

  Inventory → All Assets → Code

  Inventory → All Assets → Application → select an option from the Application menu → select an item from the inventory → Secrets

###### 9.3.5.6.2. Secrets issues inventory

###### 9.3.5.6.3. Detailed Secrets issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 9.3.5.6.4. Secrets findings

####### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

####### Navigation

  The Application Security Secrets Findings table is a pre-filtered view of the comprehensive Findings inventory (located at Cases & Issues → Issues → Findings Table tab

  To access Secrets findings, select Application Security → Issues → Secrets → click the Findings tab

###### 9.3.5.6.5. Manage Secrets issues

##### 9.3.5.7. Infrastructure as Code (IaC) misconfiguration scanner

###### 9.3.5.7.1. Supported frameworks and languages

###### 9.3.5.7.2. IaC misconfiguration issues

####### Tip

* You can also view IaC misconfiguration issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Configuration tab under Repository assets. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from...

####### Navigation

  To access IaC misconfiguration issues, under Modules, select Application Security → Issues → IaC misconfiguration

###### 9.3.5.7.3. IaC misconfiguration issues inventory

###### 9.3.5.7.4. Detailed IaC issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 9.3.5.7.5. IaC misconfiguration findings

####### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

####### Navigation

  To access IaC misconfiguration findings, under Modules, select Application Security → Issues → IaC Misconfigurations → click the Findings tab

###### 9.3.5.7.6. Manage IaC misconfiguration issues

##### 9.3.5.8. IaC Drift Detection scans

###### 9.3.5.8.1. IaC Drift Detection issues

####### Navigation

  Modules → Application Security → IaC Drifts

###### 9.3.5.8.2. IaC Drift Detection issue inventory

###### 9.3.5.8.3. Detailed IaC drift detection issue information

###### 9.3.5.8.4. IaC Drift Detection findings

####### Navigation

  Modules → Application Security → IaC Drifts (under Issues) → click the Findings tab

##### 9.3.5.9. Software Composition Analysis (SCA ) scanners

###### 9.3.5.9.1. Supported Software Composition Analysis (SCA) frameworks and languages

###### 9.3.5.9.2. Software Composition Analysis (SCA) vulnerability issues

####### Tip

* In Asset inventories, navigate to Inventory → All Assets → Code:    On the Vulnerabilities tab under Repositories. Refer to In-depth repository asset information for more information Under the All Code inventory: Select an asset from the table → Vulnerabilities In Asset inventories, navigate to Inventory → All Assets → Code: On the...

####### Navigation

  To access CVE vulnerability issues, under Modules, select Application Security → Issues → Vulnerabilities

####### 9.3.5.9.2.1. Vulnerability issues inventory

####### 9.3.5.9.2.2. Detailed vulnerability issue information

######## Note

* Not all properties are shown for every issue; availability depends on the context and the information collected for that specific issue.

####### 9.3.5.9.2.3. CVE vulnerabilities findings

######## Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

######## Navigation

  The Application Security Vulnerabilities Findings table is a pre-filtered view of the comprehensive Findings inventory (located at Cases & Issues → Issues → Findings Table tab

  To access CVE findings, under Modules, select Application Security → Issues → Vulnerabilities → click the Findings tab

####### 9.3.5.9.2.4. Manage SCA CVE vulnerability issues

###### 9.3.5.9.3. License miscompliance issues

####### Tip

* You can also view license miscompliance issues in dedicated tabs under other sections when available: In Application asset inventories: navigate to Inventory → All Assets →  Application → select an option from the Application menu → select an item from the inventory → Package Integrity In Asset inventories, navigate to Inventory → All...

####### Navigation

  To access license miscompliance issues, under Modules, select Application Security → Issues → Licenses

####### 9.3.5.9.3.1. License miscompliance issues inventory

####### 9.3.5.9.3.2. Expanded License miscompliance issues information

####### 9.3.5.9.3.3. License miscompliance findings

######## Navigation

  To access license miscompliance findings, under Modules, select Application Security → Issues → Licenses → click the Findings tab

####### 9.3.5.9.3.4. Open-source software license categories

####### 9.3.5.9.3.5. Manage license miscompliance issues

###### 9.3.5.9.4. Package Integrity

####### 9.3.5.9.4.1. Package Integrity inventory

######## Note

* You can modify the severity level from the severity field menu.

####### 9.3.5.9.4.2. Expanded Package Integrity issues inventory information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 9.3.5.9.4.3. Package Integrity findings

######## Note

* Findings cannot be mitigated. They must be promoted to issues to enable remediation efforts to secure your software packages.

####### 9.3.5.9.4.4. Manage Package Integrity issues

##### 9.3.5.10. Application Security scans management

###### 9.3.5.10.1. Overview

####### Note

* While scans provide a comprehensive inventory of all issues detected during a scan, dedicated inventories are also maintained for specific scan types for more granular management. For more information, refer to Infrastructure as Code (IaC) misconfiguration scanner, Secrets scanners and Software Composition Analysis (SCA ) scanners.

###### 9.3.5.10.2. Branch periodic scans

####### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

###### 9.3.5.10.3. Pull Request scans

####### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

###### 9.3.5.10.4. CI scans

####### Note

* The inventory table displays scan issues for visibility only; remediation is not available in scan management. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

###### 9.3.5.10.5. Manage repository scan configurations

###### 9.3.5.10.6. Monitor data source instances health

##### 9.3.5.11. Application Security Policies

###### 9.3.5.11.1. User roles and permissions

###### 9.3.5.11.2. Policies inventory

####### Note

* To view all out-of-the-box (OOTB) policies, filter by Policy Owner = System.

###### 9.3.5.11.3. AI-recommended guardrails

####### 9.3.5.11.3.1. Manage AI-recommended guardrails

######## Note

* Recommended guardrails are generated based exclusively on findings from the Application Security Software Composition Analysis (SCA) scanner. They do not support SCA data ingested from third-party scanners, nor do they currently support other finding categories, such as Secrets or Infrastructure as Code (IaC).

* The total amount of available recommended guardrails is displayed on the AI Recommendations button.

* The AI-Recommended tag is only assigned to recommendations applied as-is, that is, without modifications. Edited recommendations generate policies without this label.

###### 9.3.5.11.4. Create Application Security policies

####### Note

* When an issue is created, only the first policy ID that triggered the issue is associated with it.

####### 9.3.5.11.4.1. Create code security policies

######## Note

* For a detailed list of all available attributes and their values by scanner type, refer to Application Security code policy Condition attributes .

* SBAC scope-based limitations do not apply to Asset Types

* When selecting Asset Groups, the code policy is evaluated only on the application and repository assets included in the group.

* For each application that matches the criteria, the policy is evaluated only on the repositories associated with that application.

* If you select only Code Weaknesses as the Finding Type in the condition step (indicating a third-party scanner), the PR and CI triggers are disabled, leaving only Periodic Scan enabled.

######## 9.3.5.11.4.1.1. Application Security code policy Condition attributes

####### 9.3.5.11.4.2. Create IaC Drift Detection policies

######## Navigation

  Modules → Application Security → AppSec Policies → Add Policies

####### 9.3.5.11.4.3. Manage Application Security policies

######## Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

##### 9.3.5.12. Application Security Rules

###### Note

* Out-of-the-box rules cannot be modified directly. However, you can create a custom rule by cloning the existing one. This allows you to make changes to the original rule according to your requirements. Refer to Manage Application Security custom rules for more information.

###### 9.3.5.12.1. Roles and permissions

###### 9.3.5.12.2. Rules inventory

####### Navigation

  To filter rules relating to Secrets, select filter icon → Scanner (from the Select field) → Secrets (from the Value field

###### 9.3.5.12.3. Create custom Application Security rules

####### Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

###### 9.3.5.12.4. Manage Application Security custom rules

###### 9.3.5.12.5. Configure YAML file properties

##### 9.3.5.13. Application Security CLI

###### Prerequisite

* These requirements apply specifically to the Application Security CLI. For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of...

###### Note

* For detailed information about the Cortex XSIAM CLI, refer to Cortex CLI.

###### 9.3.5.13.1. Connect Cortex CLI

####### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

####### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources & Integrations →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Application Security, refer to Cortex CLI usage for Application Security

####### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source or Integrations page after selecting + Add New.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

###### 9.3.5.13.2. Cortex CLI usage for Application Security

###### 9.3.5.13.3. CLI pipeline code snippets

####### Prerequisite

* User permissions: Ensure the user performing the integration has permissions to edit pipeline configurations (such as YAML files).

###### 9.3.5.13.4. Cortex CLI Application Security command line reference

####### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

####### Important

* The Cortex CLI Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id <YOUR_AUTH_ID>...

###### 9.3.5.13.5. Cortex CLI common command line reference guide

####### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

###### 9.3.5.13.6. Git Hooks

####### 9.3.5.13.6.1. Cortex CLI pre-commit hooks

######## Prerequisite

* These common prerequisites are required for all types of installation (both local and global) of the Cortex CLI pre-commit hook. Ensure you have a license for Application Security Install the Cortex XSIAM CLI binary locally. Refer to Connect Cortex CLI for information about onboarding the CLIConnect Cortex CLI Obtain Cortex XSIAM API credentials (API...

* For local installation: Install the pre-commit framework version 3.2.0 or greater. Refer to https://pre-commit.com/ for installation instructions.

######## Note

* It is recommended you configure credentials for the Cortex CLI using a configuration file.

* The pre-commit framework is not required for global mode.

######## 9.3.5.13.6.1.1. Pre-commit hook usage

####### 9.3.5.13.6.2. Cortex CLI pre-receive hooks

######## Prerequisite

* Before you begin, ensure you have: Administrator access to the VCS server and console A valid license for Application Security The Cortex XSIAM CLI binary or Docker image installed on the server (requires GLIBC (GNU C library) version 2.35 or greater). Refer to Connect Cortex CLI for information about onboarding the CLIConnect Cortex CLI Cortex XSIAM...

######## Note

* Make sure to create the directory under the home directory of the Linux user that runs the Git hooks. This user is typically not the root user.

######## 9.3.5.13.6.2.1. Pre-receive hook usage

##### 9.3.5.14. IDE

###### Note

* Not all remediation options are available for all findings or all type of scan category.

###### 9.3.5.14.1. System requirements

###### 9.3.5.14.2. Visual Studio (VS) Code and VS Code compatible IDEs

####### Prerequisite

* Before you begin (These prerequisites apply to both VS Code and VS Code compatibles): Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

####### Note

* Enforcement rules and CA certificates are not applicable to the open-source project.

####### Tip

* You can access Extensions using the keyboard shortcuts Ctrl+Shift+X (Windows) or Cmd+Shift+X (macOS).

####### Navigation

  Install through VS Code IDE Access the Activity bar → Extensions → Cortex Cloud → Install

  Access the Activity bar → Extensions → Cortex Cloud → Install

####### 9.3.5.14.2.1. How to use the Cortex Cloud extension in VS Code

######## Note

* Not all remediation options are available for all issues.

* The suppression is scoped to the file.

###### 9.3.5.14.3. JetBrains

####### Prerequisite

* Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install Node.js version 22 and...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

####### Note

* The Cortex AppSec code security plugin supports all JetBrains products.

####### Navigation

  Settings → Plugins → select the Marketplace tab → search for Prisma Cloud → Install → OK

  Settings → Tools → Cortex Cloud

####### 9.3.5.14.3.1. How to use the JetBrains Cortex XSIAM extension

######## Note

* After selecting Fix Available, the number of issues displayed in the issue categories (such as IaC) reflect the number of fixable issues for that type.

* The corresponding file simultaneously opens in the Code editor, highlighting the issue within its exact code context. See below for more information.

* Not all types of remediation are available for all issue categories. For example, fixes are not available for License issues.

* Secrets and Licenses category issues are typically mitigated by following the guidance in the Documentation.

##### 9.3.5.15. Developer Suppressions

###### Note

* The check IDs and rule names are placeholders for illustration purposes and do not correspond to actual checks.

#### 9.3.6. API documentation

### 9.4. Attack Surface Management

#### License Type

  Included in Cortex XSIAM Premium. For Cortex XDR 4.x or any other XSIAM license, the ASM add-on is required.

#### 9.4.1. Get started with Attack Surface Management

##### 9.4.1.1. What is Attack Surface Management?

###### 9.4.1.1.1. Attack Surface Management use cases

##### 9.4.1.2. Network mapping

##### 9.4.1.3. Scanning

###### 9.4.1.3.1. Scanning cadences

###### 9.4.1.3.2. Known Assets Monitoring

###### 9.4.1.3.3. Scanning ports and protocols

####### Note

* The following lists are not exhaustive. For current and complete lists, contact your customer success team.

###### 9.4.1.3.4. Scanning activity

##### 9.4.1.4. GeoIP data collection

##### 9.4.1.5. Attack Surface Management FedRAMP support

#### 9.4.2. Attack Surface Management detections

##### 9.4.2.1. Attack surface rules

###### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

##### 9.4.2.2. Attack Surface Testing

###### Note

* Requires the ASM add-on.

###### 9.4.2.2.1. Attack surface tests

####### Note

* Attack surface testing scans are typically not CFAA compliant, meaning that they may attempt more extensive fuzzing to confirm or deny the presence of a CVE. Additionally, some attack surface tests are more intrusive than others. Tests are labeled with the level of intrusiveness, so you can decide whether to run more intrusive tests.

####### 9.4.2.2.1.1. Attack Surface Testing intrusivity

###### 9.4.2.2.2. Set up Attack Surface Testing

####### Navigation

  Settings → Configurations → Access Management → Roles, and select the role

  Modules → Attack Surface → Policies → Attack Surface Tests

  Settings → Configurations → Attack Surface → Attack Surface Testing

###### 9.4.2.2.3. Manage attack surface tests

####### Navigation

  Modules → Attack Surface → Policies → Attack Surface Tests

###### 9.4.2.2.4. View issues created from Attack Surface Testing results

####### Navigation

  Modules → Attack Surface → Attack Surface Issues

###### 9.4.2.2.5. Source IP addresses for Attack Surface Testing scans

####### Navigation

  Settings → Configurations → Attack Surface → Attack Surface Testing and refer to the Source IP Addresses section

##### 9.4.2.3. Externally inferred CVEs

###### Note

* An externally inferred CVE might impact your service or asset, but additional investigation is required to confirm that the CVE is actually present.

##### 9.4.2.4. Digital Risk Protection

###### Note

* Both of these attack surface rules are based on the attributed domain assets that appear in the asset inventory. If there are no attributed domains in your inventory, Cortex XSIAM will not generate Digital Risk Protection findings and issues.

###### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

#### 9.4.3. Attack surface assets

##### Navigation

  The internet-facing assets that were discovered in an attack surface management (ASM) scan and attributed to your organization are available in the inventory on the Inventory → Assets → All Assets → External Surface pages

  Inventory → Assets → Network Configuration → IP Address Ranges → External IP Address Ranges

##### 9.4.3.1. Upload or remove ASM assets

###### Note

* You must have the Instance Administrator role to upload or remove assets.

###### 9.4.3.1.1. Upload assets

####### Note

* If an asset upload request has an invalid CSV or includes one or more invalid assets, the entire request will fail, and none of the assets will be uploaded. If this happens, Cortex XSIAM will display an error message indicating what caused the error, so you can fix the problem and resubmit if you choose.

####### Navigation

  Settings → Configurations → Asset Management → Asset Uploads/Removals

###### 9.4.3.1.2. Remove assets

####### Note

* If an asset removal request has an incorrectly formatted CSV or includes one or more invalid assets, the entire request will fail, and none of the assets will be removed. If this happens, Cortex XSIAM will display an error message indicating what caused the error, so you can fix the problem and resubmit if you choose.

####### Navigation

  Settings → Configurations → Asset Management → Asset Uploads/Removals

#### 9.4.4. Deploy ASM and Exposure Management enrichment and remediation automation

##### Note

* For details and requirements regarding the enrichment information that can be collected and the specific issues that can be remediated automatically, review the Exposure Management Content Pack information in Marketplace.

* Cortex Exposure Management playbooks only run on issues that were created after the automation rules have been configured.

##### Navigation

  Settings → Configurations → Marketplace → Browse and locate the Cortex Exposure Management content pack

  Investigation & Response → Automation → Automation Rules

#### 9.4.5. ASM enrichment of cloud assets

##### Navigation

  Inventory → Assets → All Assets → External Surface → Services

#### 9.4.6. Emerging Vulnerabilities

##### License Type

  Requires the ASM add-on

##### Note

* You must have a role with Attack Surface Rules permission to access the Emerging Vulnerabilities page. When setting up Roles Based Access Control (RBAC), you can find Attack Surface Rules in the Detection & Threat Intel component.

##### Navigation

  Posture Management → Vulnerability Management → Emerging Vulnerabilities

#### 9.4.7. Global Lookup

##### Navigation

  Modules → Attack Surface → Global Lookup

### 9.5. Cloud Security Rules and Policies

#### 9.5.1. Overview

#### 9.5.2. Cloud Security Rules

#### 9.5.3. Cloud Security Policies

##### Note

* If you have the following Scope Based Access Control (SBAC) settings in place, User Settings > Cases and Issues Scope > Select domains > Posture, you may encounter a Case mismatch in Issues/Cases/Findings counts. This is because the Case count on the Rules page captures Cases belonging to the Posture domain. Whereas Platform pages, capture Issues...

* 9.5.3.1 |Issues Issues are artifacts of the policy and represent actionable items that you need to address. They have several characteristics, such as: Lifecycle '–' Open, Dismiss, In-progress, Close Workflows '–' Assigned to different user personas for remediation Severity '–' Critical, High, Medium, Low, Info NOTE: A key distinction between Findings and Issues is that Findings are not actionable, while you can take an action on Issues. The Cloud Security Policies page allows you to manage policies that define security and compliance actions for cloud posture. You can create, edit, filter, and manage policies through a structured table and widget panel. The Policies page displays all the configured policies with the following fields. 9.5.4 |Create Rules You can create your own custom rules for Configuration (Config), Attack Paths, and Network Exposure. View all the Cloud Posture Security Rules on the Posture Management > Rules & Policies > Rules > Cloud Security page. 9.5.4.1 |Create a configuration rule Configuration (config) rules monitor your resource configurations for potential policy violations or misconfigurations. Perform this task to create a custom configuration rule that you can use in a cloud security policy. Navigate to Posture Management → Rules & Policies → Rules → Cloud Security. Select Create Rule > Config. Complete the Overview step: Enter a Rule Name and Description. Select a Severity. This will be the severity of any issues created with this rule. Add Labels (optional). These rules can be used find rules when creating custom policies. Enable Remediation using the toggle (optional). In a later step, you'll enter the remediation instructions. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. Click Next. Complete the Overview step: Enter a Rule Name and Description. Select a Severity. This will be the severity of any issues created with this rule. Add Labels (optional). These rules can be used find rules when creating custom policies. Enable Remediation using the toggle (optional). In a later step, you'll enter the remediation instructions. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. Complete the Rule Logic step to define what the rule is looking for. Select one of the following modes: Simple Mode: Presents a guided interface in which you can define basic conditions and address most common rule use cases. Advanced Mode: Presents a free-form XQL editor that allows you to build complex and flexible queries across unrestricted datasets. Supports advanced and custom use cases. Complete the Rule Logic step to define what the rule is looking for. Select one of the following modes: Simple Mode: Presents a guided interface in which you can define basic conditions and address most common rule use cases. Advanced Mode: Presents a free-form XQL editor that allows you to build complex and flexible queries across unrestricted datasets. Supports advanced and custom use cases. If you selected Simple Mode, complete the following steps: Select options from the dropdown menus to define the logic for your config rule, such as '''Find EC2 instances where accessKeys are allowed'', and then click Search to view all matching results. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Simple Mode, complete the following steps: Select options from the dropdown menus to define the logic for your config rule, such as '''Find EC2 instances where accessKeys are allowed'', and then click Search to view all matching results. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Advanced Mode, complete the following steps: Define an XQL query for the rule, following the guidelines in ???. For detailed XQL query instructions, see Get started with XQL. Click Test to determine if the query is valid. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Check the list of query results to verify that the query is working as intended. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Advanced Mode, complete the following steps: Define an XQL query for the rule, following the guidelines in ???. For detailed XQL query instructions, see Get started with XQL. Click Test to determine if the query is valid. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Check the list of query results to verify that the query is working as intended. (Optional) In the text field, define remediation actions or provide other information that will be included on issues created by this rule. Click Done to save your config rule. 9.5.4.1.1 |Guidelines for creating cloud security rules NOTE: XQL queries are supported for cloud security configuration rules only. XQL queries are not yet supported for other types of cloud security rules.

###### 9.5.4.1.2. Cloud security rule status for custom configuration rules

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

##### 9.5.4.2. Create a Data Rule

###### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

##### 9.5.4.3. Create a Network Exposure Rule

##### 9.5.4.4. Edit a Rule

#### 9.5.5. Create Policies

##### Note

* When creating Policies, note that Rules with the Informational severity level are excluded.

##### 9.5.5.1. Edit a Policy

##### 9.5.5.2. Use an Existing Policy to Create a New One

### 9.6. Cloud Workload Policies and Rules

#### Prerequisite

* Users need View/Edit RBAC permissions (under Policies → Compute Policies) or the Instance Administrator role to view, edit, and modify Cloud Workload Policies policies.

#### Important

* Users with SBAC granular scoping (in addition to the RBAC permissions required for Cloud Workload Policies) can only view Cloud Workload Policies, when their access is scoped to any of the available options: All assets, No assets, or Select asset groups. For more information on granular scoping, see Manage user scope. When no SBAC restriction is...

#### 9.6.1. How policies and rules work together

#### 9.6.2. Cloud Workload Policies

##### Note

* Issues are automatically resolved when the finding is no longer applicable to the asset or when the affected asset is removed from the inventory. For more details on Prevent and create issues, see Cloud Workload Preventive Action.

##### 9.6.2.1. Types of Cloud Workload Policies

###### 9.6.2.1.1. Trusted image cloud workload policies

####### Note

* Registry scanning is for finding problems that are objectively issues regardless of context, organization, or scope. Trust, however, is subjective. Depending on the scope and other factors, an issue may or may not be problematic, and can change over time depending on the context.

* Trusted image policies do not override other policies and their rules, such as malware policies, misconfiguration policies, and secrets policies.

####### Caution

* The default behavior for the prevent action when trust criteria are unavailable is Create an Issue. Be aware that changing this default will mean an incomplete deployment file can block a workload.

##### 9.6.2.2. Cloud Workload Policies page

###### Note

* Keep the following caveats in my mind when working with Policies: Instance Administrators are able to view all facets of policies without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be...

###### 9.6.2.2.1. Widgets panel

####### 9.6.2.2.1.1. Show or hide the widget panel

######## Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 9.6.2.2.2. Change the layout of the policies table

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 9.6.2.2.3. Policy Details Panel

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.6.2.3. Enable or disable a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.6.2.4. Create a Cloud Workload Policy

###### Note

* The Evaluation stage for Misconfiguration policies is supported only in the Runtime SDLC stage and is enforceable through the Kubernetes Admission Controller for clusters on-boarded using the Posture Management (KSPM) Connector.

* Use Create a new Custom Detection Rule to define and add new custom rules as required.Create a new Custom Detection Rule

* Each rule may support different actions. While some include both Create an Issue and Prevent and Create an Issue, others provide only the Create an Issue option.

* All non-relevant (non-compute) assets are automatically excluded from the included asset list.

* See Cloud Workload Preventive Action, to learn more about the Prevent action behavior and prerequisites. If the Prevent and create an issue action is selected, the preventive actions in the CI pipeline will trigger a Fail Pipeline by returning an exit code of 2 in the CI tool.

* Choosing this option results in the automatic selection of all other asset scopes in the list.

* See Cloud Workload Preventive Action, to learn more about the Prevent action behavior and prerequisites.

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.6.2.5. Use an existing policy to create a new Cloud Workload policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.6.2.6. Edit a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.6.2.7. Delete a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.6.2.8. Cloud Workload Preventive Action

#### 9.6.3. Cloud Workload Rules

##### 9.6.3.1. Default (pre-defined) Rules

##### 9.6.3.2. Custom (user-defined) Rules

##### 9.6.3.3. Cloud Workload Rules page

###### Note

* Keep the following caveats in my mind when working with Rules: Instance Administrators are able to view all facets of Rules without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be able...

###### 9.6.3.3.1. Filter page results

###### 9.6.3.3.2. Change the layout of the rules table

###### 9.6.3.3.3. Rule details panel

##### 9.6.3.4. Create a new Custom Detection Rule

###### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

###### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

##### 9.6.3.5. Use an existing rule to create a new Custom Detection Rule

###### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

##### 9.6.3.6. Edit a Custom Detection Rule

###### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

##### 9.6.3.7. Delete a Custom Detection Rule

###### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

### 9.7. Cortex Cloud Data Classification

#### 9.7.1. What is Cortex Cloud Data Classification?

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Navigation

  To access Data Classification management, click Settings → Configurations → Data Classification

#### 9.7.2. How to create and validate a custom data pattern

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* Once a custom data pattern is saved, it runs on all data in the same way as any out-of-the-box (OOTB) pattern, becoming globally applicable for all modules using Cortex Cloud Data Classification.

* For more information, see How to disable and enable data patterns in Data Classification.How to disable and enable data patterns in Data Classification

#### 9.7.3. How to disable and enable data patterns in Data Classification

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* Disabling data patterns can cause changes in your data profile results and stop detection of these data patterns.

* For more information about data patterns in data classification, see What is Cortex Cloud Data Classification?.

##### Navigation

  In the lower left part of the screen, click Settings → Configurations → Data Classification → Data Patterns

#### 9.7.4. How to create and validate a custom data profile

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* If you choose two data locations, only the filters they have in common will be included in the possible filter options.

* For more information, see How to disable and enable data profiles in Cortex Cloud Data Classification.

##### Important

* Deleting a data profile deletes all past data associated with it in all modules using Cortex Cloud Data Classification after a warning notification is displayed.

* Enabling and disabling a data profile removes or re-adds the data profile results to the data objects; that is, files and tables.

#### 9.7.5. How to disable and enable data profiles in Cortex Cloud Data Classification

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* Existing results on past scans are updated in the Asset and Object inventories within two hours after being disabled or enabled.

* For more information about data profiles in Cortex Cloud Data Classification, see What is Cortex Cloud Data Classification?.What is Cortex Cloud Data Classification?

##### Navigation

  In the lower left part of the screen, click Settings → Configurations → Data Classification → Data Profiles

#### 9.7.6. How to report a false positive in Cortex Cloud Data Classification

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* Alternatively, in Cortex Command Center, click Help → Submit a Support Case.

### 9.8. Cortex Cloud Data Security

#### 9.8.1. What is Cortex Cloud Data Security?

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### 9.8.2. Supported assets in Cortex Cloud Data Security

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* CMK (customer-managed key) in SQL Server is only supported in outpost mode.

* The list above refers to only data classification; however, Cortex Cloud Data Security discovers and monitors all cloud assets and services for usage and misconfigurations.

* For information about configuring data classification asset types, see How to configure the scanning settings for supported services.

#### 9.8.3. Cortex Cloud Data Security concepts

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### 9.8.4. Cortex Cloud Data Security use cases

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### 9.8.5. Data Inventory

##### Note

* To clear the filter in the filter panel, click Delete.

##### Navigation

  When you select Inventory → All Assets → Data → All Data Assets, a list of all data assets appears

#### 9.8.6. How to review errors in Cortex Cloud Data Security

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### 9.8.7. How to configure the scanning settings for supported services

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* If you do not select a scanning cadence, the default setting is applied. For more information, contact your Customer Support team.

#### 9.8.8. How to perform advanced Data Security investigations using XQL

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* For more information, see Build XQL queries.Build XQL queries

#### 9.8.9. How to onboard Databricks

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* If you turn on this feature, both the cloud and region will be used for scanning, possibly incurring cost and requiring adherence to certain compliance policies.

#### 9.8.10. How to onboard Microsoft 365

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* You have generated a Globally Unique Identifier (GUID), also known as a Universally Unique Identifier (UUID). You will need this ID for the tenant you want to use for the Microsoft 365 instance. In order to use Microsoft 365, you must be registered with Microsoft Azure.

#### 9.8.11. How to onboard on-premise file shares to Cortex Cloud Data Security

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* Your data is scanned on the Broker VM itself, and only the metadata and classification results are transmitted from the on-premise environment to Cortex XSIAM.

* For information about activating the DSPM Fileshare applet, see Activate DSPM Fileshare.

#### 9.8.12. How to onboard Snowflake

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* In order to use Snowflake, you must be registered with one of these cloud providers: Amazon AWS, Microsoft Azure, or Google Cloud Platform (GCP). Ensure you have the necessary account permissions to onboard. It is recommended to use Account Admin as the role for the onboarding.

##### Note

* The account identifier can be found using the user information at the bottom left. Hover over the account you wish to onboard and select the copy option at the top right. The account identifier is usually of the format: (organization).[account]

#### 9.8.13. How to use information protection labels in Cortex Cloud Data Security

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* Only If you have connected a Microsoft 365 instance to Cortex Cloud, the information protection labels appear. See How to onboard Microsoft 365.

### 9.9. Cortex Cloud Identity Security

#### 9.9.1. What is Cortex Cloud Identity Security?

#### 9.9.2. Review and improve your Identity Security posture

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Management or Cloud Runtime Security add-on.

##### Tip

* Reducing the number of nonhuman entities that are either dormant or have administrative privileges is the most effective way to improve your security score.

#### 9.9.3. How does Effective Permission Calculation work?

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### 9.9.4. Cortex Cloud Identity Security functionality

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* Access to the Weak/Compromised Password widget and column requires the ITDR add-on.

* For more information about Effective Permission Calculation, see How does Effective Permission Calculation work?.

* When a policy is analyzed and categorized as excessive, a relevant finding and highlight is attached to that policy and the various identities being granted excessive permissions.

* Each action must be defined as either being administrative or not. The administrative tag is an additional tag for administrative actions, along with one of the other access level types. For example, the AWS action iam:CreateGroup is categorized as config and has the administrative tag as well.

##### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

#### 9.9.5. Achieve the principle of least privilege access

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* In the case of Amazon AWS, Cortex Cloud Identity Security also uses AWS Identity and Access Management (IAM) Access Advisor insights to expand the coverage of supported actions.

##### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

#### 9.9.6. Explore permissions using the simple and advanced access tables

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### 9.9.7. Create a custom detection rule in Cortex Cloud Identity Security

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

#### 9.9.8. Perform advanced Identity Security investigations using XQL

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* For more information, see Build XQL queries.Build XQL queries

#### 9.9.9. Enable inactive human identity logs on Azure in Cortex Cloud Identity Security

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* For more information, see Ingest logs from Microsoft Azure Event Hub.

#### 9.9.10. Manage RBAC and SBAC in Cortex Cloud Identity Security

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Important

* You can use the Cortex Cloud Identity Security RBAC roles to define access to the various sections and functionalities of Cortex Cloud Identity Security, but these roles do not directly control the specific data a user sees within those sections. Data visibility is further refined and limited by scope-based access control (SBAC) capabilities.

### 9.10. Cortex Advanced Email Security

#### 9.10.1. Cortex Advanced Email Security module overview

##### Prerequisite

* The following are prerequisites for using the Cortex XSIAM Advanced Email Security module. REQUIREMENT DESCRIPTION Setup and Permissions Ensure Analytics is activated before enabling the Cortex Advanced Email Security module. Licenses and Add-ons Cortex Advanced Email Security add-on.

#### 9.10.2. Cortex Advanced Email Security module architecture and data flow

#### 9.10.3. Getting started with the Cortex Advanced Email Security module

##### Prerequisite

* Before you configure the Cortex Advanced Email Security module, ensure you have the following: Admin-level access to the target email platform Dedicated service account (recommended) for integration purposes (response actions) List of domains and mailboxes to be protected (to be used during the wizard configuration) Access to an internal phishing...

#### 9.10.4. Deploy and configure the Email Security module

##### 9.10.4.1. Integrate Microsoft 365 with the Cortex Advanced Email Security Module

###### License Type

  To configure a quick action, you must first create an application in Microsoft O365.

###### Navigation

  After you onboard your domains and configure the quick actions, Cortex XSIAM manage your protected domains in Modules → Email Security → Email Security Configuration

##### 9.10.4.2. Configure the Cortex Advanced Email Security module

###### License Type

  Requires the Advanced Email Security module.

###### Note

* You can add email indicators to the Allow List also in Exceptions Configuration → Issue Exclusions. However, if you add multiple indicators in a rule using Issue Exclusions under Exceptions Configuration, you cannot edit the rule in the Email Security Allow List.

###### Navigation

  Modules → Email Security → Email Security Configuration

#### 9.10.5. Cortex Advanced Email Security threat detection and issues

##### Note

* Depending on data collection mode and platform capabilities, not all fields may be populated for every message. API and export documentation provides further clarification on optional vs required fields.

##### 9.10.5.1. Email Security Analytics Rules

###### Navigation

  The Email Security Analytics Rules page is in Modules → Email Security → Email Security Detection Rules

#### 9.10.6. Investigate and respond to email security issues

##### License Type

  Requires the Cortex Advanced Email Security module.

##### Navigation

  Modules → Email Security → Email Security Issues

#### 9.10.7. Automate remediation for the Cortex Advanced Email Security module

##### Note

* For automated actions not yet supported by the response engine, use the playbooks, scripts, and commands in the Cortex XSIAM automation engine. For more information, see Automation in Cortex XSIAM.

##### Navigation

  Define the rules for your email security policy in Email Remediation Response Rules, located in Modules → Email Security → Remediation → Rules

  Review all the remediation actions initiated by your policy in the Email Remediation Action Center, located in Modules → Email Security → Remediation → Action Center

##### 9.10.7.1. Email Remediation Response Rules

###### Note

* For automated actions not yet supported by the response engine, use the playbooks, scripts, and commands in the Cortex XSIAM automation engine. For more information, see Automation in Cortex XSIAM.

* If you apply a new template, all the customizations to the previous template you used will be lost.

###### Navigation

  The Email Remediation Response Rules page is under Modules → Email Security → Remediation → Rules and displays the following widgets and the Rules table

##### 9.10.7.2. Email Security Remediation Action Center

#### 9.10.8. Email Command Center

##### License Type

  Requires the Cortex Advanced Email Security module.

##### Note

* Adding more data into the Email Security module will ensure better detection of complicated email threat vectors.

* The number of remediated emails and the number of remediation actions may not always be equal. This is due to a number of reasons, including different policies that affect the email messages or manual actions taken.

#### 9.10.9. Advanced Email Security module security and compliance

##### Note

* For information about how Cortex handles personal and private information, see the Cortex Privacy Datasheet.

### 9.11. Exposure management

#### 9.11.1. Exposure Management

##### License Type

  Requires the Exposure Management add-on.

#### 9.11.2. Get started with Exposure Management

##### 9.11.2.1. Exposure Management FedRAMP support

#### 9.11.3. Exposure Management Command Center

#### 9.11.4. Security controls

##### 9.11.4.1. Automatically detect security controls

###### Note

* Auto-detection of controls is supported when certain constraints regarding topology and configuration are met. Learn more about Network Exposure Detection.Network exposure detection

##### 9.11.4.2. Manually attested security control taxonomy

###### Tip

* Take an inventory of your top 10-15 security controls, check which ones need to be manually added into the Cortex Platform and use the taxonomy to map them into the system.

##### 9.11.4.3. Establish security control roles

###### Note

* Ensure that you have clear visibility into the controls that are created and implemented, by periodically reviewing the Audit Logs as part of your change management process. Audit logs track the following actions: Create/Update/Delete Security Controls Create/Update/Delete Effectiveness Rules Update an Effectiveness Value in a findings or issues

###### Tip

* Start with a centralized model. This helps a core team master the new object models, states, and taxonomies to prevent confusion and ensure high-quality control creation.

##### 9.11.4.4. Create a security control

##### 9.11.4.5. Manage security controls

###### Navigation

  Alternatively, you can also find Detected Controls and Detected Controls Coverage on the Vulnerability Issue (Posture Management → Vulnerability Management → Vulnerability Issues page

##### 9.11.4.6. Set compensating controls

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues and sort the vulnerabilities listed by their CVRS score or Compensating Control Effectiveness

##### 9.11.4.7. Improve controls coverage

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

##### 9.11.4.8. Create effectiveness rules

###### Note

* Only users with the role Exposure Management Administrator can create effectiveness rules.

###### Tip

* Use All, rather than selecting individual CVEs, unless you explicitly only want to mark specific CVEs as Effectively Mitigated.

##### 9.11.4.9. Manage effectiveness rules

#### 9.11.5. Cortex Network Scanner

##### 9.11.5.1. Get started with Cortex Network Scanner

###### License Type

  Requires the Exposure Management add-on.

###### Prerequisite

* Review the Cortex Network Scanner deployment recommendations and complete any prerequisites. Set up and configure Broker VM

###### Note

* The Cortex Network Scanner applet is not supported in High Availability (HA) cluster configurations. The Cortex Network Scanner applet is not supported for FedRAMP customers.

###### Important

* The Cortex Network Scanner applet is not supported for FedRAMP customers. Cortex Network Scanner does not support high availability (HA) Broker VM configuration.

###### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  Settings → Configurations → Network Scanners → Network Scanners and find your new scanner in the list

##### 9.11.5.2. Add a network

###### Navigation

  Settings → Configurations → Network Scanning → Networks and click + Add Network

##### 9.11.5.3. Define target groups

###### Navigation

  Settings → Configurations → Network Scanning → Target Group Management

##### 9.11.5.4. Manage credentials

###### Prerequisite

* Before initiating an authenticated scan, complete the following prerequisites on your target hosts: Create dedicated service accounts. We highly recommend creating dedicated service accounts on your target devices specifically for the network scanner. Avoid using existing administrative accounts or personal user accounts. This practice enhances...

###### Note

* For security reasons, you cannot edit saved credentials, but you can delete them and create new ones as needed.

###### Navigation

  Settings → Configurations → Network Scanners → Credential Management

  Settings → Configurations → Network Scanning → Credential Management

##### 9.11.5.5. Create a scan

###### Note

* Be sure that scanner traffic is allowed from each selected scanner to its selected targets. See Deployment recommendations  for more information.

###### Tip

* Most use cases can use the default advanced settings.

* ICMP Ping provides the quickest discovery scan and is good for initial discovery and scoping, however in the modern enterprise environment ICMP response can be blocked by the firewall or endpoint security rules. Using additional methods increases the accuracy of the host discovery, although makes the scan take a longer time. The best approach is to use...

##### 9.11.5.6. Manage scans

###### Navigation

  Settings → Configurations → Network Scanners → Scan Management

##### 9.11.5.7. View issues triggered by network scanner findings

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

  Alternatively, you can also view issues triggered by the Network Scanner from the Findings page, Posture Management → Vulnerability Management → Vulnerability Issues → All Vulnerability Findings

  Settings → Configurations → Network Scanners → Scan Management → Rescan History

#### 9.11.6. Service Level Agreements (SLAs) for issue resolution

##### Note

* These filters support filtering of whole days only, for example Resolution SLA > 1 filters for issues that have a Resolution SLA of greater than one day.

##### Navigation

  Settings → Configurations → Object Setup → Issues

  Settings → Configurations → Object Setup → Issues and select the SLA Rules tab

### 9.12. Vulnerability management

#### 9.12.1. Vulnerability management in Cortex XSIAM

##### License Type

  Requires the Cortex Cloud Posture Security, Cortex Cloud Runtime Security, Exposure Management, or ASM add-on.

##### Note

* Cortex XSIAM vulnerability management provides the ability to identify and assess runtime vulnerabilities in every asset across traditional IT and cloud environments. For vulnerabilities detected in your software development lifecycle through application security scans, refer to the Cortex Cloud Application Security documentation.

##### 9.12.1.1. Cortex XSIAM vulnerability concepts

###### Note

* CVE is an acronym for Common Vulnerabilities and Exposures, which is a list of publicly disclosed security threats. We often use the term "CVE" to refer to a vulnerability that has been a assigned a CVE ID. Cortex XSIAM identifies CVEs and non-CVE vulnerabilities.

##### 9.12.1.2. Vulnerability Management dashboard

#### 9.12.2. Cortex Vulnerability Risk Score

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

#### 9.12.3. Vulnerability policies

##### 9.12.3.1. Create a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

##### 9.12.3.2. Update the Ignored CVEs, Asset Groups, and Assets policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

##### 9.12.3.3. Modify a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

##### 9.12.3.4. Configure a block grace period

###### Navigation

  Posture Management → Rules & Policies → Vulnerability Management → Vulnerability Policies - Prevention

##### 9.12.3.5. Enable or disable a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

#### 9.12.4. Investigate and remediate vulnerabilities

##### 9.12.4.1. View all Vulnerabilities

###### Navigation

  Posture Management → Vulnerability Management → Vulnerabilities

##### 9.12.4.2. View vulnerability issues

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

##### 9.12.4.3. View All Vulnerability Findings

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues and click the All Vulnerability Findings button

##### 9.12.4.4. View vulnerable assets

###### Navigation

  Posture Management → Vulnerability Management → Vulnerable Assets

#### 9.12.5. Vulnerability Intelligence

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

#### 9.12.6. Recast CVSS scores and CVSS severities

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

10. Serverless function security

  10.1. Overview

  10.2. Serverless function posture security

  10.2.1. Onboard cloud providers for serverless functions

##### Note

* When scanning serverless functions with layers, those layers need to be from the same cloud account.

* Only functions containing zip files are supported.

##### Important

* Cortex supports Google Cloud Functions: 1st gen and 2nd gen Cloud Functions API.

  10.2.2. Serverless function posture policies

  10.2.2.1. Manage serverless function policies

##### Note

* You can select multiple types to view all your serverless function rules across your cloud providers.

* Refer to Create serverless function policies for more information on how to define the steps of a policy in the wizard.

  10.2.2.2. Create serverless function policies

##### Note

* You can select multiple options.

* For more information about rules, refer to Manage serverless function rules.

  10.2.3. Serverless function posture rules

  10.2.3.1. Manage serverless function rules

##### Note

* You can select multiple types to view all your serverless function policies across your cloud providers.

* Refer to Create serverless function rules for more information on how to define the steps of a rule in the wizard.

  10.2.3.2. Create serverless function rules

  10.2.3.3. Create an attack path rule for serverless functions

##### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  in as the operator → enter the CVE ID → Search

  > or >= as the operator → Severity level (such as High, Low) → Search

  > or >= as the operator → enter a score → Search

  10.2.3.4. Create a configuration rule for serverless functions

##### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  10.2.3.5. Create a network exposure rule for serverless functions

##### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  10.2.4. Serverless function usage

##### Navigation

  To access serverless function assets, under Inventory, select All Assets → Compute → Serverless Functions

  Posture Management → Vulnerability Management) → Vulnerability Issues

  Add Filters → Asset Category → Serverless Function

  Posture Management → Vulnerability Management) → Vulnerable Assets

  Add Filters → Asset Category → Serverless Functions

  10.3. Serverless function runtime security

  10.3.1. Overview

  10.3.2. Set up serverless function protection

  10.3.3. Serverless runtime issues

##### Note

* Issues triggered within 24 hours, sharing the same name and description, will be aggregated into cases along with issues from the same function per execution.

11. Data management

  11.1. Configure Cortex Data Lake tier

##### License Type

  The Cortex Data Lake tier is only available with an active Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, or Cortex XSIAM Premium license.

##### Prerequisite

* The Cortex Data Lake tier require View/Edit RBAC permissions for Data Management (under Configurations → Data Management), the same permissions used for Dataset Management, ingestion rules, parsing rules, data model rules, and event forwarding.

##### Note

* Currently, specific data sources receive these capabilities temporarily; yet, be aware that these will be completely removed from the Cortex Data Lake tier in a future update.

  11.2. Broker VM

  11.2.1. What is the Broker VM?

  11.2.2. Set up and configure Broker VM

##### Note

* The Broker VM comes with a 512 GB disk. Therefore, deploy the Broker VM with thin provisioning, meaning the hard disk can grow up to 512 GB but will do so only if needed.

* When DHCP is not enabled in your network and there isn't an IP address for your Broker VM, configure the Broker VM with a static IP using the serial console menu.

* When configuring a Local Agent Settings applet with installer and content caching, you need to configure an SSL certificate for the Broker VM as explained in the task below. For more information on specific requirements for the Local Agent Settings applet, see Activate Local Agent Settings. Keep in mind that several Broker VM applets, such as the...

* When a Broker VM is disconnected for more than 30 days, it will have to go through a re-registration process.

* You can configure another Broker VM as a proxy server for this Broker VM by selecting the HTTP type. When selecting HTTP to route Broker VM communication, you need to add the IP Address and Port number (set when activating the Agent Proxy) for another Broker VM registered in your tenant. This designates the other Broker VM as a proxy for this Broker VM.

* The Palo Alto Networks Broker VM supports only strong cipher SHA256-based certificates. MD5/SHA1-based certificates are not supported.

* If adding a CA certificate to the Broker VM is not possible, ensure that you've added the Broker Service FQDNs to the SSL Decryption Exclusion list on your firewalls. See Enable Access to Cortex XDR.

##### Important

* There can be instances in which the Broker VM requires up to 50% of the incoming bandwidth as outgoing. Such instances can be, network instability between the Broker VM and Cortex XSIAM, or data that is being collected, but not well compressed.

* The internal network for the Broker VM must be unique and reserved. Other devices should not use the same IP as the Broker VM internal network as it can lead to communication issues with the Broker VM.

* If you use SSL decryption in your firewalls and proxies, see the Understanding CA certificate functionality in Broker VM deployments section below. In addition, verify that the proxies used support HTTP/2, gRPC-specific headers, and HTTP/2 trailers, and the inspection policies support gRPC traffic. Any devices that you use with this configuration...

* When configuring more than one network interface, ensure that only one Default Gateway is defined. The rest must be set to 0.0.0.0, which configures them as undefined. In addition, we recommend assigning each network interface to a different subnet, as oppose to configuring two interfaces on the same subnet which can potentially cause unexpected...

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and earlier, Cortex XSIAM will only accept 172.17.0.0/16.

* We strongly recommend disabling SSH connectivity when it's not being used. Therefore, activate SSH connectivity when it's needed and disable it right afterwards. When generating a new SSH key ensure to avoid embedding the domain-style username, by not using any backslashes (\) in the comment field, to ensure the SSH key passes validation.

  11.2.2.1. Broker VM image installations

  11.2.2.1.1. Set up Broker VM on Alibaba Cloud

##### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* For Linux and Windows uploads, you can use Alibaba Cloud's graphical management tool called ossbrowser.

* The Object Storage Service must be created in the same Region as the image of the virtual machine.

##### Navigation

  Hamburger menu → Elastic Compute Service → Instances & Images → Instances

  11.2.2.1.2. Set up Broker VM on Amazon Web Services

##### Prerequisite

* Download a Cortex XSIAM Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. You need to set up an AWS VM Import role (vmimport) before you continue with the steps to convert the image as it is required for the import-image CLI command. You can use a different role, if the...

##### Note

* Creating an AMI image can take up to 60 minutes to complete.

* Assigning security groups can take up to 15 minutes.

##### Important

* A t2.medium (4GB RAM) is the lowest machine type that can be used as an instance type. Usually, the lowest machine type is sufficient with the Local Agent Settings applet. Yet, when enabling more applets, 8 GB is required.

##### Navigation

  Log in to the AWS IAM Console, and in the navigation pane, select Access Management → Users → Add Users

  Obtain a registration token from the Cortex XSIAM Web Console by selecting Settings → Configurations → Data Broker → Broker VMs → Add Broker → Generate Token

  11.2.2.1.3. Set up Broker VM on Google Cloud Platform (GCP)

##### Prerequisite

* Download a Cortex XSIAM Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. To complete the set up, you must have G Cloud installed and have an authenticated user account.

* Before importing a GCP image using the gcloud CLI, ensure that you update the Google Cloud components to version 371.0.0 and above using the following command:

##### Note

* The import tool uses Cloud Build API, which must be enabled in your project. For the import to work, Cloud Build service account must have compute.admin and iam.serviceAccountUser roles. When using the Google Cloud console to import the image, you will be prompted to add these permissions automatically.

  11.2.2.1.4. Set up Broker VM on KVM using Ubuntu

##### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  11.2.2.1.5. Set up Broker VM on Microsoft Azure

##### Prerequisite

* Download a Cortex XSIAM Broker VM VHD (Azure) image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* Extraction can take up to a few hours.

* Upload can take up to a few hours.

* For more information, see the Azure Documentation.

* Creating the VM can take up to 15 minutes. The Broker VM Web UI is not accessible during this time.

* For more information on creating a rule in an Azure VM, see Create a Security Rule in the Azure Documentation.

  11.2.2.1.6. Set up Broker VM on Microsoft Hyper-V

##### Prerequisite

* Download a Cortex XSIAM Broker VM VHD image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  11.2.2.1.7. Set up Broker VM on Nutanix Hypervisor

##### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* Saving the image to Nutanix hypervisor can take time as it's a large file. We recommend verifying periodically that the connection is alive for the upload process to finish successfully.

* Creating the VM can take up to 15 minutes. The Broker VM Web user interface is not accessible during this time.

  11.2.2.1.8. Set up Broker VM on VMware ESXi using vSphere Client

##### Prerequisite

* Ensure you have a virtualization platform installed that is compatible with an OVA image, and have an authenticated user account. Download a Cortex XSIAM Broker VM OVA image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  11.2.2.2. Broker VM data collector applets

  11.2.3. Manage Broker VM

##### Note

* For more information on troubleshooting errors and warnings for these broker applets, see Troubleshoot Broker VM applet errors.

* Certain fields are also exposed in the Clusters tab, when a Broker VM node is added to a High Availability (HA) cluster, and each cluster node is expanded to view the Broker VM nodes table. An asterisk (*) is beside every field that is also included in the Broker VM nodes table for each HA cluster.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.2.3.1. Edit Broker VM Configuration

##### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and lower, Cortex XSIAM accepts only 172.17.0.0/16.

* Make sure you save the password before closing the window. The only way to re-generate a password is to disable ssh and re-enable.

  11.2.3.2. Increase Broker VM storage allocated for data caching

##### Note

* Follow your hypervisor documentation to understand how to add a persistent disk storage to your VM.

* If your disk is not listed and you didn't shutdown your Broker VM in your hypervisor before manually adding a disk to the VM, you'll need to reboot the Broker VM before the disk details are detected by the Broker VM. This can be performed either in the hypervisor or directly in the Broker VMs page.

##### Warning

* This operation is irreversible, and will make the disk become an integral part of the broker, where disconnecting the disk will result in errors and data loss.

  11.2.3.3. Monitor Broker VM using Prometheus

##### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* For more information on Docker, see the Docker website.

  11.2.3.4. Collect Broker VM Logs

##### Note

* The Download Logs (<TIMESTAMP>) is only displayed when you've downloaded your logs previously using Generate New Logs.

  11.2.3.5. Upgrade Broker VM

##### Important

* After a Broker VM upgrade, your broker may require a reboot to finish installing important updates. A notification about this will be sent to your Cortex XSIAM console Notification Center.

  11.2.3.6. Import Broker VM Configuration

##### Important

* This option can only be used on Broker VMs with version 20.0 and later, and is only suitable for importing a configuration of brokers in the same version, or from a broker in an older version to a broker in a newer version.

* If your source Broker VM configuration includes a WEC applet, you'll need to ensure that you update the DNS record of this Broker VM's FQDN to point to the target Broker VM IP address.

  11.2.3.7. Open Live Terminal

##### Note

* You can either restart_routes or reboot the Broker VM for the changes in the /etc/network/routes file to take affect.

  11.2.3.8. Add Broker VM to cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.2.3.9. Switchover Primary Node in Cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.2.3.10. Remove from Cluster

##### Note

* If you've enabled a Load Balancer Health-Check on the cluster, you need to exclude this Broker VM from your Load Balancer settings.

  11.2.4. Manage Broker VM data collector applets

##### Note

* For more information on the Broker VM applet connectivity status, see Manage Broker VM.

  11.2.5. Broker VM High Availability Cluster

##### Note

* For Load Balancing, you must install a Load Balancer in your network, which will distribute the incoming data between the nodes.

* The following applets aren't supported when configuring Broker VMs in HA clusters: Cortex Network Scanner and Transporter.

  11.2.5.1. Configure High Availability Cluster

##### Prerequisite

* Be sure you do the following task before creating a cluster from an existing Broker VM: If the Broker VM is explicitly specified in some Agent Settings profile, which means Cortex XSIAM agents retrieve release upgrades and content updates from this Broker VM, you must change the Broker VM's current designated role. To do this, you need to modify the...

##### Important

* You can only create a new cluster from an existing Broker VM, when the Broker VM version is 19.0 and later, and the STATUS is Connected. The Create a Cluster from this Broker option is only listed if the Broker VM is not already added to a cluster.

* When the Protocol is set to HTTPS, you may need to perform a few follow-up steps to establish a validated secure SSL connection with the Broker VM. If you're using your own Certificate Authority (CA) to sign the certificates, you'll need to place the CA in the client, such as the Load Balancer, and upload the certificates to the Broker VM. If you're...

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.2.5.2. Manage Broker VM clusters

##### Navigation

  After you've configured a cluster, you can manage all your Broker VM clusters from the Clusters tab on the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs → Clusters

  11.2.5.2.1. View cluster details

##### Note

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

##### Navigation

  The Clusters tab of the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs) enables you

  11.2.5.2.2. Edit cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs, and select the Clusters tab

  11.2.5.2.3. Add applet to cluster

##### Note

* With Cortex XDR Prevent, it's only relevant to configure a HA cluster with a Local Agent Settings applet as this is the only applet supported for this product license. The other applets are collector applets, which are only available in Cortex XDR Pro or Cortex XSIAM.

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

  11.2.5.2.4. Add Broker VM to cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.2.5.2.5. Remove cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.2.6. Broker VM notifications

##### Note

* For more information on upgrading to a new Broker VM image, see Migrating to a New Broker VM Image.

  11.2.7. Monitor Broker VM activity

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  11.2.8. Troubleshoot Broker VM applet errors

##### Note

* For more information on creating correlation rules to trigger collection health issues, see How can I set up correlation rules to trigger collection health issues?.

  11.3. Dataset management

##### License Type

  Managing Roles requires an Account Admin or Instance Administrator role. For more information, see Predefined user roles.

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

##### Note

* Cold storage, in addition to a cold storage license, requires compute units (CU) to run cold storage queries. For more information on CU, see Manage compute units. For information on the CU add-on license, see Understand the Cortex XSIAM license planUnderstand the Cortex XSIAM license plan.

* Only datasets that are already handled as part of the GB license are supported for this license. In addition, the retention configuration is only available in Cortex XSIAM, as opposed to the public APIs.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default. Datasets include dataset permission enforcements in the Cortex Query Language(XQL), Query Center, and XQL Widgets. For example, to view or access any of the endpoints and host_inventory datasets, you need role-based access control (RBAC)...

* You'll only be able to save the dataset view if the query contains no errors; otherwise, the Save button is disabled.

* For more information on user roles, see Manage user roles.

##### Important

* Cortex XSIAM enforces retention on all log-type datasets excluding Host Inventory, Vulnerability Assessment, Metrics, and Users.

* This column is updated once a day. Therefore, if the dataset was created or updated by the target or lookup flows, it's possible that the Last Updated value is a day behind when the queries or reports were run as it was before this column was updated.

  11.3.1. What are datasets?

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

##### Note

* For more information on tasks specific to lookup datasets, see Lookup datasets.

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

##### Important

* By default, forensic datasets are not included in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  11.3.2. Lookup datasets

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

##### Note

* A lookup dataset can only be deleted if there are no other dependencies. For example, if a Correlation Rule is based on a lookup dataset, you wouldn't be able to delete the lookup dataset until you removed the dataset from the XQL query of the Correlation Rule.

##### Important

* When you create or add data to a lookup dataset using the target stage, the _time field won't be included by default unless you explicitly add it with the fields stage.

  11.3.2.1. Import a lookup dataset

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

* When uploading a CSV, TSV, or JSON file, ensure that the file meets the following requirements: The maximum size for the total data to be imported into a lookup dataset is 30 MB from the Dataset Management page. Otherwise, the limit is 50 MB using Cortex Query Language (XQL) or APIs. Field names can contain characters from different languages, special...

##### Important

* The name of a dataset created from a TSV file must always include the extension. For example, if the original file name is mrkdptusrsnov23.tsv, you can save the dataset with the name marketing_dept_users_Nov_2023.tsv.

  11.3.2.2. Download JSON file of lookup dataset

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

##### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  11.3.2.3. Set time to live for lookup datasets

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

##### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  11.3.3. Monitor datasets and dataset views activity

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  11.4. Archived data

  11.4.1. Import historical data into cold storage

##### License Type

  Importing historical data into cold storage requires a Period-Based Retention - Cold Storage add-on license.

##### Prerequisite

* Importing historical data into cold storage requires a View/Edit RBAC permission for Data Management (under Configurations).

  11.4.2. Building XQL archived data queries

##### Prerequisite

* Archived cold storage, in addition to a Period-Based Retention - Cold Storage add-on license, requires compute units (CU) to run archived cold storage queries. Cortex XSIAM provides a free daily quota of compute units (CU) allocated according to your license size. Queries run without enough quota will fail. To expand your investigation capabilities,...

  11.4.3. Success and failure code responses to your HTTP POST requests

  11.5. Parsing Rules

  11.5.1. What are Parsing Rules?

##### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

  11.5.2. Parsing Rules editor views

##### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

  11.5.3. Parsing Rules file structure and syntax

##### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

##### Note

* For more information on the XQL syntax, see Cortex XQL Language Reference.

* An inner type of join stage is only supported in CONST, INGEST, and RULE sections and is not supported in a COLLECT section. You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

* The regexcapture function is only supported in Parsing Rules and cannot be used in any other XQL query.

* Every statement in the Parsing Rules file must end with a semicolon (;).

  11.5.3.1. INGEST

##### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

##### Note

* You can't add tags to parsing rules using the Next-Generation Firewall (NGFW) datasets that are in the format panw_ngfw_<text>_raw, and the Observability dataset called panw_observability_raw.

  11.5.3.2. COLLECT

##### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

##### Note

* The CSV Collector applet is not affected by the COLLECT rules applied to a Broker VM.

##### Tip

* To reduce the amount of data transmitted to Cortex XSIAM from the broker, use filters to drop logs. Yet, be aware that once the logs are modified using alter or fields stages, the Broker VM will convert the original log into a JSON format, which could increase the data size being sent from the broker to Cortex XSIAM.

  11.5.3.3. CONST

##### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

##### Note

* The dollar sign ($) must be adjacent to the [CONST] name, without any whitespace in between.

##### Important

* Only quoted or integer terminal values are considered valid for CONST sections.

  11.5.3.4. RULE

##### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

##### Note

* For more information on the XQL syntax, see Get started with XQL.

* You can also add tags using only the INGEST section. For more information, see INGEST.

  11.5.3.5. EXTEND

##### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

##### Note

* For more information on the XQL syntax, see Get started with XQL.

  11.5.4. Create Parsing Rules

##### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

##### Note

* You need Cortex XSIAM administrator or Instance Administrator permissions to access the Simulate view and perform these tests.

##### Important

* When creating Parsing Rules, the _time field is a mandatory field. If the field is null or invalid, the _insert_time field is used instead. This field can be automatically parsed depending on the type of data being ingested. For example, for CEF or LEEF logs, the parser first tries to ingest timestamps from these fields in the following order: rt,...

  11.5.5. Troubleshooting Parsing rules errors

##### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

##### Note

* Some errors can only be found after the applicable logs are collected in Cortex XSIAM.

  11.5.6. Parsing Rules Raw Dataset

##### Prerequisite

* Parsing Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Data Model Rules, and Event Forwarding.

  11.6. Data Model Rules

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

  11.6.1. What are Data Model Rules?

##### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

  11.6.2. Data Model Rules editor views

##### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

  11.6.3. Data Model Rules file structure and syntax

##### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

##### Note

* For more information on XQL syntax, see the XQL Language Reference Guide.

* You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

  11.6.3.1. MODEL

##### Note

* The Settings → Configurations → XQL Configuration → Case Sensitivity (case_sensitive) setting can overwrite this case_sensitive configuration for all fields in the application except for BIOCs, which will remain case insensitive no matter what this setting is set to. For more information on this setting, see XQL Configuration.

* We recommend that you do not configure the same data source in both Marketplace and using a Cortex XSIAM data collector. Yet, if you do, the following will happen:External data ingestion For network data, all relevant logs from the different data sources are stitched to the same network story. For authentication data, all relevant logs from the...

  11.6.3.2. RULE

##### Note

* For more information on the XQL syntax, see the XQL Language Reference Guide.

  11.6.3.3. Field structure

##### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

##### Note

* For more information on these data model fields, see Cortex XSIAM Data Model Schema.

  11.6.4. How to map authentication story events?

##### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

* Familiarize yourself with the Cortex Data model (XDM) schema for field definitions and naming conventions, see Cortex XSIAM Data Model Schema.

##### Important

* This Feature focuses on authentication events related to SSO (Single Sign-On) and SaaS (Software-as-a-Service) application authentications. It does not cover internal authentication mechanisms such as Kerberos, NTLM, or traditional domain logon events generated by on-premise infrastructure.

* To maximize the variety of issues that are retrieved based on the XDM authentication stories, we recommend that the following additional fields are populated: xdm.target.resource_name, xdm.logon.type, xdm.source.user_agent, and xdm.source.host.device_category. Should you decide to change the default XDM mappings, ensure that both the mandatory and...

  11.6.5. Create Data Model Rules

##### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → Data Management → Data Model Rules

  11.6.6. Troubleshooting Data Model Rules

##### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

##### Note

* Since this dataset also contains Parsing Rules errors, some of the fields are irrelevant for Data Model Rules and aren't included in the table.

##### Tip

* To ensure you and your colleagues stay informed about Data Model Rules activity, you can also Configure notification forwarding to forward your Data Model Rules audit logs to an email distribution list or Syslog server. For more information about the Data Model Rules audit logs, see Monitor Data Model Rules activity.

  11.6.7. Using data enrichment

##### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

##### Note

* For a complete list of auto-enriched fields, see the Cortex Data Model Schema Guide.

##### Important

* When manually mapping ASN fields that are enriched, such as xdm.source.asn.as_number, with other ISP and domain fields that are not enriched, such as xdm.source.asn.isp and xdm.source.asn.domain, it's possible to receive incorrect XDM query results due to the misalignment between the overridden enrichement and system enrichment fields.

  11.6.8. Data Model Rules notifications

##### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

  11.6.9. Monitor Data Model Rules activity

##### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  11.7. Ingestion Rules

  11.7.1. What's changed: architectural shift to XDM on-write

##### Prerequisite

* Ingestion rules require View/Edit RBAC permissions for Data Management (under Configurations → Data Management), the same permissions required for Dataset Management, parsing rules, data model rules, event forwarding, and Cortex Data Lake tier.

##### Note

* Ingestion rules and the AI-powered ingestion rule generator are not enabled by default. To enable these features in your tenant, please contact your Customer Support Team.

* When using the new datasets, you can only use the fields in the old dataset logs by extracting them as they aren't available out-of-the-box.

* The cortex_agent and network_events datasets are provided as an alternative to the xdr_data dataset.

  11.7.2. What are ingestion rules?

##### Prerequisite

* Ingestion rules require View/Edit RBAC permissions for Data Management (under Configurations → Data Management), the same permissions required for Dataset Management, parsing rules, data model rules, event forwarding, and Cortex Data Lake tier.

##### Note

* Ingestion rules and the AI-powered ingestion rule generator are not enabled by default. To enable these features in your tenant, please contact your Customer Support Team.

  11.7.3. Understand the dataset structure and data settings

##### Prerequisite

* Ingestion rules require View/Edit RBAC permissions for Data Management (under Configurations → Data Management), the same permissions required for Dataset Management, parsing rules, data model rules, event forwarding, and Cortex Data Lake tier.

##### Note

* Ingestion rules are not enabled by default. To enable this feature in your tenant, please contact your Customer Support Team.

* Log fields are not automatically extracted as columns.

  11.7.3.1. Fields in new XDM datasets for ingestion rules

##### Prerequisite

* Ingestion rules require View/Edit RBAC permissions for Data Management (under Configurations → Data Management), the same permissions required for Dataset Management, parsing rules, data model rules, event forwarding, Cortex Data Lake tier.

##### Note

* Ingestion rules are not enabled by default. To enable this feature in your tenant, please contact your Customer Support Team.

##### Navigation

  The two new datasets, as all other new datasets, are available on the Dataset Management page (Settings → Configurations → Data Management), where you can view the complete dataset schema with a list of all the fields included in the datasets

  11.7.3.2. Supported products and associated datasets

##### Prerequisite

* Ingestion rules require View/Edit RBAC permissions for Data Management (under Configurations → Data Management), the same permissions required for Dataset Management, parsing rules, data model rules, event forwarding, and Cortex Data Lake tier.

##### Note

* Ingestion rules are not enabled by default. To enable this feature in your tenant, please contact your Customer Support Team.

  11.7.4. XQL syntax for ingestion rules

##### Prerequisite

* Ingestion rules require View/Edit RBAC permissions for Data Management (under Configurations → Data Management), the same permissions required for Dataset Management, parsing rules, data model rules, event forwarding, and Cortex Data Lake tier.

##### Note

* Ingestion rules are not enabled by default. To enable this feature in your tenant, please contact your Customer Support Team.

* The Settings → Configurations → XQL Configuration → Case Sensitivity (case_sensitive) setting can overwrite this case_sensitive configuration for all fields in the application except for BIOCs, which will remain case insensitive no matter what this setting is set to. For more information on this setting, see XQL Configuration.

##### Important

* Rule override: When a user overrides the default rule, the entire rule content is overridden and replaced by the user rule content.

  11.7.4.1. parse_cef

  11.7.4.2. parse_cef_with_options

##### Note

* If null is passed for the <string_field_pattern> or <array_parent_prefixes> options, the default configuration for that parameter is automatically used. This means:

  11.7.4.3. parse_cef_with_schema

  11.7.4.4. parse_json

  11.7.4.5. parse_leef

  11.7.4.6. parse_wec_xml

  11.7.4.7. XDM fields structure in ingestion rules

##### Prerequisite

* Ingestion rules require View/Edit RBAC permissions for Data Management (under Configurations → Data Management), the same permissions required for Dataset Management, parsing rules, data model rules, event forwarding, and Cortex Data Lake tier.

##### Note

* Ingestion rules are not enabled by default. To enable this feature in your tenant, please contact your Customer Support Team.

* For more information on these XDM fields, see Cortex XSIAM Data Model Schema.

  11.7.5. Generate AI-powered ingestion rules (recommended)

##### Prerequisite

* Ingestion rules require View/Edit RBAC permissions for Data Management (under Configurations → Data Management), the same permissions required for Dataset Management, parsing rules, data model rules, event forwarding, and Cortex Data Lake tier. The AI generation option is available when adding an ingestion rule only when the Agents & LLM Experience...

##### Note

* Ingestion rules and the AI-powered ingestion rule generator are not enabled by default. To enable these features in your tenant, please contact your Customer Support Team.

  11.7.6. Create ingestion rules

##### Prerequisite

* Ingestion rules require View/Edit RBAC permissions for Data Management (under Configurations → Data Management), the same permissions required for Dataset Management, parsing rules, data model rules, event forwarding, and Cortex Data Lake tier.

##### Note

* Ingestion rules and the AI-powered ingestion rule generator is not enabled by default. To enable these features in your tenant, please contact your Customer Support Team.

* For more information on creating the ingestion rule using AI, see Generate AI-powered ingestion rules (recommended).

##### Important

* Before creating a new ingestion rule from scratch, we recommend generating the rule with AI. For more information, see Generate AI-powered ingestion rules (recommended).

* At this point, our recommendation is to: Not convert any user-defined content, such as parsing rules or date model rules, to ingestion rules yet, but rather test the current out-of-the-box rules available. Not use these datasets for real-time correlation rules, as these aren't supported at this point.

  11.7.7. Edit ingestion rules

##### Prerequisite

* Ingestion rules require View/Edit RBAC permissions for Data Management (under Configurations → Data Management), the same permissions required for Dataset Management, parsing rules, data model rules, event forwarding, and Cortex Data Lake tier.

##### Note

* Ingestion rules and the AI-powered ingestion rule generator are not enabled by default. To enable these features in your tenant, please contact your Customer Support Team.

* For more information on creating the ingestion rule using AI, see Generate AI-powered ingestion rules (recommended).

  11.7.8. Troubleshooting ingestion rules errors

##### Prerequisite

* Ingestion rules require View/Edit RBAC permissions for Data Management (under Configurations → Data Management), the same permissions required for Dataset Management, parsing rules, data model rules, event forwarding, and Cortex Data Lake tier.

##### Note

* Ingestion rules are not enabled by default. To enable this feature in your tenant, please contact your Customer Support Team.

* Some errors can only be found after the applicable logs are collected in Cortex XSIAM.

  11.8. Manage Event Forwarding

##### Prerequisite

* Event Forwarding requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Dataset Management.

##### Note

* After exporting logs, you can download them from GCP for up to 14 days. The Pub/Sub subscription messages are available for 7 days.

* Requires the Endpoints Event Forwarding add-on.

* Requires the GB Event Forwarding add-on

##### Important

* Since data is aggregated and compressed, it may take up to two hours until the data is available in the forwarding bucket.

##### Navigation

  Under Settings → Configurations → Data Management → Event Forwarding, activate one or more of the following: Enable GB Event Forwarding Enable Endpoints Event Forwarding

  Under Settings → Configurations → Data Management → Event Forwarding, activate one or more of the following

  11.8.1. Endpoints Event Forwarding - included/excluded fields by event type

##### Prerequisite

* Event Forwarding requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Dataset Management.

  11.9. Manage compute units

##### Note

* For more information, see Import historical data into cold storage.

* The CU consumption of cold storage queries is based on the number of days in the query time frame. For example, when querying 1 hour of a specific day, the CU of querying this entire day is consumed. When querying 1 hour that extends past 2 days, such as from 23:50 to 00:50 of the following day, the CU of querying these two days is consumed.

  11.9.1. Compute units usage

##### Note

* To enable the add-on, select Settings  → Configurations → Cortex XSIAM License → Addons tile, and select the Compute Unit tile and Enable.

##### Navigation

  Settings → Configurations → Data Management → Compute Unit Usage

12. Cortex XSIAM Data Sources

  12.1. What are Cortex XSIAM data sources?

##### Note

* Some content packs provide parsing rules and data model rules for data sources ingested using a Syslog Collector applet of the Broker VM or for standard data sources, and won't be listed in the Data Sources & Integrations page.

##### Important

* We are actively working to evolve the UI to create a single, unified point of configuration for all data ingestion and integration points. This documentation is structured to help you navigate the current segmented process until that UI update is available.

  12.2. Complete data source catalog

  12.3. Vendor-specific data sources

##### Important

* In some cases, the same vendor is available through one or more of these options: standard data source, CSP onboarding data source, or content pack integration. Check the available descriptions for each data source in both the user interface and documentation to decide which option is more suitable for your needs.

  12.3.1. Amazon CloudWatch

  12.3.1.1. Ingest logs from Amazon CloudWatch

  12.3.2. Amazon S3

  12.3.2.1. Ingest audit logs from AWS Cloud Trail

##### Note

* For more information on configuring data collection from Amazon S3 using AWS CloudTrail, see the AWS CloudTrail Documentation.

* For more information on creating an AWS CloudTrail trail, see Create a trail. If you already have an Amazon S3 bucket configured with AWS CloudTrail audit logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* It is your organization's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* The CloudWatch Logs - optional settings are not supported and should be left disabled.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It your organization's responsibility to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

  12.3.2.2. Ingest network flow logs from Amazon S3

##### Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* To create a new VPC, click Launch VPC Wizard. For more information, see AWS VPC Flow Logs.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex XSIAM.

  12.3.2.3. Ingest generic logs from Amazon S3

##### License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

##### Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* You need to set up an Amazon S3 data collector to receive generic logs when collecting logs from BeyondTrust Privilege Management Cloud. For more information, see Ingest logs from BeyondTrust Privilege Management Cloud.

* If you want to ingest raw EDR events from SentinelOne DeepVisibility, use the SentinelOne DeepVisibility log collector. For more information, see Ingest raw EDR events from SentinelOne DeepVisibility.

* It is the customer's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It is the responsibility of your organization to ensure that the user who performs this task of creating the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor...

  12.3.2.4. Ingest network Route 53 logs from Amazon S3

##### Note

* For more information on configuring data collection from Amazon S3 for Route 53 DNS logs, see the AWS Documentation.

* For more information on creating a Stack, see Creating a stack on the AWS CloudFormation console.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex XSIAM.

  12.3.2.5. Create an assumed role

##### Note

* In AWS this is an optional field to configure, but this must be configured to set up the Amazon S3 Collector in Cortex XSIAM .

* The <s3-arn> and <sqs-arn> placeholders. These will be filled out later depending on which Amazon S3 logs you are configuring, including network flow logs, audit logs, or generic logs.

  12.3.2.6. Configure data collection from Amazon S3 manually

##### License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

##### Note

* If you already have an Amazon S3 bucket configured with VPC flow logs that you want to use for this configuration, you do not need to perform the prerequisite steps detailed in the first two bullets.

* It is your responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* If you already have an Amazon S3 bucket configured with VPC flow logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

  12.3.3. Amazon Web Services

  12.3.4. API Security

  12.3.4.1. Ingest data for API security

  12.3.4.1.1. Ingest AWS API Gateway

##### Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

##### Important

* Leave '–'filter-pattern empty as displayed above.

  12.3.4.1.2. Ingest Azure APIM

##### License Type

  Requires the Data Collection add-on.

##### Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

##### Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

  12.3.4.1.3. Ingest Apigee Proxy

##### License Type

  Requires the Data Collection add-on.

##### Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

##### Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

  12.3.4.1.4. Ingest Kong

##### License Type

  Requires the Data Collection add-on.

##### Note

* Contact support to obtain the custom plugin file.

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

##### Important

* The size of the buffer must be equal or larger than the max body size setting in the plugin configuration, on every data plane node.

  12.3.4.1.5. Ingest-F5

##### License Type

  Requires the Data Collection add-on.

##### Note

* Extract the files from the F5 plugin to a folder before selecting to upload to F5.

* Select panw_apisec_set_ssl_data only if your client SSL profile is enabled.

* The provider for "context_provider" should always be uppercase. Supported providers: AWS, GCP, Azure, On-prem.

  12.3.5. Azure Event Hub

  12.3.5.1. Ingest logs from Microsoft Azure Event Hub

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

##### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

##### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  12.3.6. Azure Network Watcher

  12.3.6.1. Ingest network flow logs from Microsoft Azure Network Watcher

##### Prerequisite

* For NSG:    Ensure that your NSG flow logs in Azure Network Watcher conform to the requirements as outlined in Microsoft documentation. For more information, see Introduction to flow logging for network security groups.   Enable NSG flow logs in the Microsoft Azure Portal. For NSG: Ensure that your NSG flow logs in Azure Network Watcher conform to the...

##### Note

* In addition to your storage account, the template automatically creates another storage account that is required by the function app for internal use only. The internal storage account name is prefixed with cortex and is followed by a unique suffix based on the resource group, storage account, and container names.

  12.3.7. BeyondTrust Privilege Management Cloud

  12.3.7.1. Ingest logs from BeyondTrust Privilege Management Cloud

##### Note

* For a Log Format set to Beyondtrust Cloud ECS, the following fields are automatically set and not configurable. Vendor: Beyondtrust Product: Privilege Management Compression: Uncompressed

  12.3.8. Box

  12.3.8.1. Ingest logs and data from Box

##### Prerequisite

* Set up an Enterprise Box plan.  Important To collect Box Shield Alerts, you must purchase Box Shield and it must be enabled on Box enterprise. Set up an Enterprise Box plan. Create a valid Box account that is assigned to a role with sufficient permissions for the data you want to collect. For example, create an account assigned to an Admin role to...

##### Note

* The Fetch Intervals are non-configurable.

* Collecting Box Shield Alerts requires implementing Box Shield,

* There is a current bug with the Groups API from Box. If you don't configure the Box app with the proper permissions for managing groups data, the Groups API from Box won't return an error message to Cortex XSIAM indicating that the API failed to receive the data, and the Groups data will not be collected.

* For any future change that you make to your Box app, ensure that you send the changes for approval to the administrator, who will need to approve them as explained above.

* Inventory data snapshots are collected every 10 minutes.

  12.3.9. Check Point FW1/VPN1

  12.3.10. Cisco ASA firewalls and AnyConnect

  12.3.11. Corelight Zeek

  12.3.12. Cribl

  12.3.12.1. Ingest data from Cribl

##### Prerequisite

* Ensure that you have the credentials and IDs for each data source, such as Tenant ID, App ID and Client secret.

* Ensure that you have the copies of the Cortex XSIAM authorization token and API URL obtained in Task 2.

##### Note

* We do not support email data collection via Cribl.

* Only one Cribl data collector instance can be configured in Cortex XSIAM.

* When the logs are in CEF format, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Cribl collector settings. However, when the values are blank in the...

##### Important

* Raw data must be collected by Cribl and streamed as-is from the passed through source, because any changes made by Cribl might affect the way that Cortex XSIAM handles the data.

  12.3.12.1.1. Data source UUIDs

##### Note

* Do not use this generic UUID when your data source is listed in this table.

  12.3.13. CrowdStrike APIs

  12.3.13.1. Ingest alerts and metadata from CrowdStrike APIs

##### Note

* To enable some of the APIs, you may need to reach out to CrowdStrike support.

* For more information on configuring data collection from CrowdStrike APIs, see the CrowdStrike Documentation.

* Ensure that you save the SECRET value because this is the only time that it is displayed.

  12.3.14. CrowdStrike Falcon Data Replicator

  12.3.14.1. Ingest raw EDR events from CrowdStrike Falcon Data Replicator

##### Prerequisite

* Ensure that your organization has a license for the CrowdStrike Falcon Data Replicator (FDR). Ensure that CrowdStrike FDR is enabled. CrowdStrike FDR can only be enabled by CrowdStrike Support. If CrowdStrike FDR is not enabled, submit a support ticket through the CrowdStrike support portal. Follow these steps to check if CrowdStrike FDR is...

##### Note

* CrowdStrike can provide multiple streams. It can only be read once per stream. For more information on configuring data collection from CrowdStrike via Falcon Data Replicator, see CrowdStrike documentation.

* Ensure that you copy the Secret, and store it in a safe place. You will not be able to retrieve it later. If you need a new secret, you must reset the feed credentials.

* CrowdStrike Falcon Data Replicator only supports one FDR credential configuration.

* Ensure that you save the SECRET value, because this is the only time that it is displayed. You can go back to this page later to copy the other credentials, but you will not have access to the secret again.

  12.3.15. Dropbox

  12.3.15.1. Ingest logs and data from Dropbox

##### Prerequisite

* Set up an Advanced Dropbox plan. Create a Dropbox Business admin account with Security admin permissions, which is required to authorize Cortex XSIAM to access the Dropbox Business account and generate the OAuth 2.0 access token.

##### Note

* The Fetch Interval is non-configurable.

* When the App Key field is empty, the here link in the tooltip is disabled. When an incorrect App Key is entered, clicking the link results in a 404 error.

* Whenever you change the permissions of the Dropbox app, we recommend that you generate a new Access Code for the Dropbox data collector instance so that the permissions match the updates.

* Event data is collected every 60 seconds with a 10 minute lag time.

* Inventory data snapshots are collected every 10 minutes.

  12.3.16. Elasticsearch Filebeat

##### Note

* You can configure collecting container logs from Google Kubernetes Engine using Elasticsearch Filebeat with a Custom - Filebeat based Collector or with a content pack Integration. For more information, see Google Kubernetes Engine.

  12.3.16.1. Ingest logs from Elasticsearch Filebeat

  12.3.17. Forcepoint DLP

  12.3.18. Fortinet Fortigate

  12.3.19. Google Cloud Platform

  12.3.19.1. Ingest logs and data from a GCP Pub/Sub

##### Note

* When collecting flow logs, we recommend that you include GKE annotations in your logs, which enable you to view the names of the containers that communicated with each other. GKE annotations are only included in logs if appended manually using the custom metadata configuration in GCP. For more information, see VPC Flow Logs Overview. In addition, to...

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the GCP data collector settings. Yet, when the values are blank in the...

  12.3.20. Google Workspace

  12.3.20.1. Ingest logs and data from Google Workspace

##### Note

* For all types of data collected via the Admin Reports API, except alerts and emails, the log events are collected with a preset lag time as reported by Google Workspace. For more information on these lag times for the different types of data, see Google Workspace Data retention and lag times.

* Spam emails from the compliance email account, and from all other monitored email accounts, are not collected. Any draft emails written in the compliance email account are collected by the Google Workspace data collector, and are then deleted even if the email was never sent.

* For more information on the entire process, see Perform Google Workspace Domain-Wide Delegation of Authority.

* When collecting Google Workspace alerts with other types of data, except emails, you need to configure a service account in Google with the applicable permissions to collect events from the Google Reports API and alerts from the Alert Center API. If you prefer to use different service accounts to collect events and alerts separately, you'll need to...

* For more information on the Admin Reports API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information on the Gmail API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information about the events collected from the various Google Reports, see Google Workspace Reports API Documentation.

  12.3.21. Google Kubernetes Engine

##### Note

* It's also possible to use a Custom - Filebeat based Collector to ingest logs related to file activity on your endpoints and servers without using the Cortex XDR agent. For more information, see Elasticsearch Filebeat.

  12.3.21.1. Ingest logs from Google Kubernetes Engine

##### Note

* Cortex XSIAM supports logs in single line format or multiline format. For more information on handling messages that span multiple lines of text in Elasticsearch Filebeat, see Manage Multiline Messages.

  12.3.22. HTTP log collector

  12.3.22.1. Set up an HTTP log collector to receive logs

##### Note

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor...

* Each record cannot exceed 5 MB in size.

  12.3.23. Kubernetes

  12.3.23.1. Onboard the Kubernetes Connector

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security add-on.

##### Note

* This option is not supported for Fargate.

* For Fargate, you must provide the cluster resource identifier. The format of the identifier is arn:aws:eks:<region>:<account-id>:cluster/<cluster-name>.

* Basic authentication is only supported in Posture Management. If deploying Realtime Protection, select None .

  12.3.23.2. What's new in Kubernetes Connector?

  12.3.23.3. Supported Kubernetes distributions

##### Note

* In Google Container-Optimized OS release 100 and earlier, where the FANOTIFY EXEC flag is not supported, the Kernel configuration may be partial for the user mode agent to properly function. In such cases, the agent will fallback to asynchronous mode. In RHCOS version 4.12 and earlier, the Kernel configuration may be partial for the user mode agent to...

  12.3.24. Microsoft Azure

  12.3.25. Microsoft Defender for Endpoint Events

  12.3.25.1. Ingest raw EDR events from Microsoft Defender for Endpoint

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection. Create an Azure Event Hub. For more information, see Quickstart: Create an event hub using Azure portal.    Create a resource group (optional if you already have a resource group configured).   Create an Event Hubs namespace.   Create an event hub within the namespace....

##### Note

* The generic Cortex XSIAM Azure Event Hub collector does not offer full functionality for EDR data (such as stitching), and is therefore not suitable for EDR data ingestion.

* If you select all event types and leave Event-Hub name empty, an event hub will be created for each category in the selected namespace. If you are not using a Dedicated Event Hubs ClusterEvent Hub, namespaces have a limit of 10 Event Hubs.

  12.3.26. Microsoft Office 365

  12.3.26.1. Ingest logs from Microsoft Office 365

##### Note

* Ingesting Microsoft Entra ID (formerly known as Azure AD) authentication and audit events from Microsoft Graph API requires a Microsoft Entra ID P1 or P2 license (formerly Azure Active Directory Premium P1 or P2). Alternatively, if the directory type is Azure AD B2C, the sign-in reports are accessible through the API without any additional license...

* When auditing is turned off from the default setting, you need to first turn on auditing for your organization to collect Microsoft Office 365 audit events from the Management Activity API. Log duplication of up to 5% in Microsoft products is considered normal. In some cases, such as login to a portal using MFA, two log entries are recorded by design.

* To address Azure reporting latency, there is a 10-minute latency period for Cortex XSIAM to receive Azure AD logs.

* You can also implement the corresponding Cortex Data Model (XDM) mappings for these Microsoft Graph Security API v2 alerts using Cortex Marketplace via the Microsoft Graph Security content pack.

* For more information, see the Office 365 Management Activity API schema.

* In FedRAMP environments, Azure sign-in logs are not supported, due to vendor technical constraints.

* Use this option when you don't want to grant permissions for Azure AD Authentication and Azure AD Audit.

  12.3.27. Microsoft Office 365 (email)

  12.3.27.1. Ingest logs and data from Microsoft 365

##### License Type

  Email data: The subject, body, and attachments are visible only with an Email Security module license.

##### Prerequisite

* A user account with the Microsoft Azure Account Administrator role is required to set up a new Microsoft 365 email collector. The following Microsoft Graph API permissions are required:    Mailbox access (read-write)    Read and write mail in all mailboxes   Read contacts in all mailboxes   Read all user mailbox settings      User information, groups,...

##### Note

* For other logs from Microsoft Office 365, use the Office 365 data collector. For more information, see Ingest logs from Microsoft Office 365.

  12.3.28. Okta

  12.3.28.1. Ingest logs and data from Okta

##### Prerequisite

* Administrator privileges: Your Okta user must have a role capable of creating API tokens, such as Read-only Administrator, Super Administrator, or Organization Administrator. For more information, see the Okta Administrators Documentation.

  12.3.29. OneLogin

  12.3.29.1. Ingest logs and data from OneLogin

##### Note

* Event data is collected every 30 seconds.

* Inventory data snapshots are collected every 10 minutes.

  12.3.30. Oracle Cloud Infrastructure

  12.3.31. PingFederate

  12.3.32. PingOne

  12.3.32.1. Ingest authentication logs and data from PingOne

##### Navigation

  Reporting → Subscriptions → Add Subscription

  12.3.33. Proofpoint Targeted Attack Protection

  12.3.33.1. Ingest logs from Proofpoint Targeted Attack Protection

  12.3.34. Salesforce.com

  12.3.34.1. Ingest logs and data from Salesforce.com

##### Prerequisite

* Cortex XSIAM:    To manage collection integration in Cortex XSIAM, ensure that you have the privilege to View/Edit Log Collections (for example, Instance Administrator). Cortex XSIAM: To manage collection integration in Cortex XSIAM, ensure that you have the privilege to View/Edit Log Collections (for example, Instance...

##### Note

* For more detailed reference information, see Configure a Connected App for the OAuth 2.0 Client Credentials Flow. Unlike other data collector setups, in this case, the setup includes obtaining an OAuth 2.0 code from Salesforce.com, and this code is only valid for 15 minutes. Therefore, make sure that you enable the data collector within 15 minutes of...

* When these options are cleared, only these data types will be omitted from collection. All other data will be collected as usual.

  12.3.35. SentinelOne DeepVisibility

  12.3.35.1. Ingest raw EDR events from SentinelOne DeepVisibility

##### Prerequisite

* The SentinelOne DeepVisibility logs that will be collected by your dedicated Amazon S3 bucket must adhere to the following guidelines:    Each log file must use the 1 log per line format as multi-line format is not supported.   The log format must be compressed as gzip or uncompressed.   For best performance, we recommend limiting each file size to up...

##### Note

* It is your responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule on the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If you receive an error when trying to save your changes, check that the permissions are set up correctly, and fix them if necessary.

* It is the responsibility of your organization to ensure that the user who creates the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors.

* For more information, see Managing access keys for IAM users.

  12.3.36. ServiceNow CMDB

  12.3.36.1. Ingest data from ServiceNow CMDB

  12.3.37. Windows DHCP via Elasticsearch Filebeat

  12.3.37.1. Ingest logs from Windows DHCP using Elasticsearch Filebeat

##### Note

* To avoid formatting issues in filebeat.yml, we recommend that you edit the text file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating the profile.

* For more information on configuring the filebeat.yml file, see the Elastic Filebeat Documentation.

* To avoid formatting issues in your filebeat.yml, we recommend that you use the download example file to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your file.

* The tokenizer definition is dependent on the Windows server version that you are using as the log format differs. -For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" -For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{mac...

  12.3.38. Workday

  12.3.38.1. Ingest report data from Workday

##### Prerequisite

* Create an Integration System User that is designated to access the custom report from Workday for data collection in Cortex XSIAM. Create an Integration System Security Group for the Integration System User created in Step 1 for accessing the report. When setting this group ensure to define the following:    Type of Tenanted Security Group: Select...

##### Note

* Any user with permissions to view issues and cases can view the Workday data.

* For more information on completing any of the prerequisite steps, see the Workday documentation.

* The Business Object changes depending on the Data Source selected.

* Cortex XSIAM uses a structured schema when integrating Workday data. To get the best Analytics results, specify all the fields marked with an asterisk from the recommended schema. workday_user_id* full_name* workday_manager_user_id* manager* worker_type* position_title* department* private_email_address* business_email_address* employment_start_date* em...

  12.3.39. Zscaler Internet Access

  12.3.40. Zscaler Private Access

  12.4. Cloud service provider (CSP) onboarding

  12.4.1. Ingest cloud assets

##### Note

* The cloud accounts being onboarded must be owned by the customer performing the onboarding process.

  12.4.2. Onboard Amazon Web Services

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Security add-ons. For Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses, see Onboard Amazon Web Services with basic configuration.

##### Prerequisite

* Ensure you have access to AWS Management Console. Ensure you have the Required AWS permissions.

##### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* When onboarding an AWS organization or organizational unit (OU), Cortex XSIAM creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

  12.4.2.1. Onboard Amazon Web Services with basic configuration

##### License Type

  Onboarding Amazon Web Services (AWS) using the basic configuration is included with Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses. For onboarding AWS with a Cortex XSIAM Premium license, see Onboard Amazon Web Services.

##### Prerequisite

* Ensure you have access to AWS Management Console. Ensure you have the Required AWS permissions.

##### Note

* When onboarding an AWS organization or organizational unit (OU), Cortex XSIAM creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

  12.4.2.2. Manually upload template to AWS

##### Prerequisite

* Before you begin, ensure you have: An AWS account Access to AWS Management Console Permission to create a stack and its resources in AWS CloudFormation

##### Note

* You must ensure that the KMS key region and the SNS topic region are the exact same as the AWS region where you are deploying the CloudFormation stack.

  12.4.2.3. Configure AWS integration instances and monitor integration instance health

##### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  12.4.3. Onboard Google Cloud Platform

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Security add-ons. For Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses, see Onboard Google Cloud Platform with basic configuration.

##### Prerequisite

* Ensure you have cccess to Google Cloud Console. Ensure you have an admin user with the required admin GCP permissions. Ensure you have the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled)   If you plan on enabling Automation as...

##### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* If you want to connect to your GCP Workspace, you must first complete onboarding with the option disabled. Once the GCP cloud instance is created, perform the steps detailed in Connect Google Workspace with your GCP cloud instance.

  12.4.3.1. Onboard Google Cloud Platform with basic configuration

##### License Type

  Onboarding Google Cloud Platform (GCP) using the basic configuration is included with Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses. For onboarding GCP with a Cortex XSIAM Premium license, see Onboard Google Cloud Platform.

##### Prerequisite

* Ensure you have cccess to Google Cloud Console. Ensure you have an admin user with the required admin GCP permissions. Ensure you have the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled)   If you plan on enabling Automation as...

  12.4.3.2. Manually upload template to GCP

##### Prerequisite

* Before you begin, ensure you have: A GCP account. Permission to create the required resources in Google Cloud Deployment Manager. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool. Reviewed the...

##### Note

* The directory you create must be a subdirectory of the home directory.

##### Important

* You must not delete or move the Terraform files from this folder. It will prevent you from being able to edit your cloud instance in the future.

  12.4.3.3. Connect Google Workspace with your GCP cloud instance

##### Prerequisite

* Ensure you have the Super Admin role in Google Workspace.

* Ensure you have the organization ID of the Google Workspace you want to connect:    Log in to your Google Admin Console. and navigate to Account → Account settings → Profile. Next to Customer ID is your organization ID. Ensure you have the organization ID of the Google Workspace you want to connect: Log in to your Google Admin Console. and navigate...

  12.4.3.4. Configure GCP integration instances and monitor integration instance health

##### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  12.4.3.5. Monitor GCP resources inside service perimeters

##### Note

* Each GCP cloud instance is assigned a scope within GCP. If the scope, whether it be organization, folder, or project, includes any projects with a service perimeter, this procedure must be performed for that cloud instance to authorize Cortex XSIAM to scan the resources in the perimeter.

  12.4.4. Onboard Microsoft Azure

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Security add-ons. For Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses, see Onboard Microsoft Azure with basic configuration.

##### Prerequisite

* Ensure you have a Microsoft Azure subscription. Ensure you have the admin permissions required to onboard Microsoft Azure or the built-in Security Administrator role. Obtain the tenant ID and subscription ID. You can view these in the Microsoft Azure Portal in Management groups.

  12.4.4.1. Onboard Microsoft Azure with basic configuration

##### License Type

  Onboarding Microsoft Azure using the basic configuration is included with Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses. For onboarding Microsoft Azure with a Cortex XSIAM Premium license, see Onboard Microsoft Azure.

##### Prerequisite

* Ensure you have a Microsoft Azure subscription. Ensure you have the admin permissions required to onboard Microsoft Azure or the built-in Security Administrator role. Obtain the tenant ID and subscription ID. You can view these in the Microsoft Azure Portal in Management groups.

  12.4.4.2. Finalize Microsoft Azure onboarding by executing the authentication template

##### Prerequisite

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the relevant scope (subscription, management group, tenant). We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed Terraform on your local machine. You can...

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the relevant scope (subscription, management group, tenant). We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed the Azure CLI tool. Authorization to create...

##### Important

* Do not delete or move the Terraform files from this folder. It will prevent you from being able to edit your cloud instance in the future.

  12.4.4.3. Configure Azure integration instances and monitor integration instance health

##### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  12.4.5. Onboard Oracle Cloud Infrastructure

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Security add-ons. For Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses, see Onboard Oracle Cloud Infrastructure with basic configuration.

##### Prerequisite

* Ensure you have access to the Oracle Cloud Infrastructure console Permissions for all of the following are required:    Creation of identity groups (for more information, refer to Managing Groups)   Policies (for more information, refer to How Policies Work)   Tag namespaces in the root compartment (for more information, refer to Tags and Tag Namespace...

##### Note

* Excluded compartments are not visible in Cortex XSIAM. Additional Security Capabilities: Enable additional Cortex XSIAM security add-ons, if available. This may require additional cloud provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. The additional security capabilities you can enable include: Data security posture management: An agentless multi-cloud data security solution that discovers, classifies, protects, and governs sensitive data. Serverless functions scanning (Gen 1 only): Implement serverless scanning to detect and remediate vulnerabilities within serverless functions during the development lifecycle. Seamless integration into CI/CD pipelines enables automated security scans for a continuously secure pre-production environment. Registry scanning: Scan container registry images for vulnerabilities. malware, and secrets. You can configure your initial preference for scanning your registry. Any newly discovered registry, repository, or image in the account will be scanned by default. For more details, see Configure registry scanning for cloud accountsConfigure registry scanning for cloud accounts Agentless disk scanning: (Recommended) Implement agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Additional Security Capabilities: Enable additional Cortex XSIAM security add-ons, if available. This may require additional cloud provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. The additional security capabilities you can enable include: Data security posture management: An agentless multi-cloud data security solution that discovers, classifies, protects, and governs sensitive data. Serverless functions scanning (Gen 1 only): Implement serverless scanning to detect and remediate vulnerabilities within serverless functions during the development lifecycle. Seamless integration into CI/CD pipelines enables automated security scans for a continuously secure pre-production environment. Registry scanning: Scan container registry images for vulnerabilities. malware, and secrets. You can configure your initial preference for scanning your registry. Any newly discovered registry, repository, or image in the account will be scanned by default. For more details, see Configure registry scanning for cloud accountsConfigure registry scanning for cloud accounts Agentless disk scanning: (Recommended) Implement agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Cloud Tags: Define tags and tag values to be added to any new resource created by Cortex XSIAM in the cloud environment. Note: The managed_by = paloaltonetworks tag is automatically added to all resources. This tag is mandatory. You cannot edit or remove this tag. Log Collection Configuration: To maximize security coverage, enable the collection of audit logs. This may require additional cloud service provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Enter the following details for each preexisting OCI storage bucket that you intend to use for log collection: Region: The geographic OCI region where the bucket is located. For example, "us-phoenix-1". Bucket Name: The name of the OCI storage bucket. Compartment OCID: The Oracle Cloud Identifier (OCID) of the compartment that contains the bucket. Log Collection Configuration: To maximize security coverage, enable the collection of audit logs. This may require additional cloud service provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Enter the following details for each preexisting OCI storage bucket that you intend to use for log collection: Region: The geographic OCI region where the bucket is located. For example, "us-phoenix-1". Bucket Name: The name of the OCI storage bucket. Compartment OCID: The Oracle Cloud Identifier (OCID) of the compartment that contains the bucket. Download the OCI authentication template by clicking Download Terraform. The Terraform authentication template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The Terraform authentication template is valid for seven days from when it was created. Download the OCI authentication template by clicking Download Terraform. The Terraform authentication template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The Terraform authentication template is valid for seven days from when it was created. Cortex XSIAM generates a Terraform authentication template based on the settings you configured in the OCI onboarding wizard. Next step: Apply the Terraform authentication template in OCI. 12.4.5.1 |Onboard Oracle Cloud Infrastructure with basic configuration LICENSE TYPE: Onboarding Oracle Cloud Infrastructure (OCI) using the basic configuration is included with Cortex XSIAM NG SIEM, Cortex XSIAM Enterprise, and Cortex XSIAM Enterprise+ licenses. For onboarding OCI with a Cortex XSIAM Premium license, see Onboard Oracle Cloud Infrastructure.

  12.4.5.3. Configure the OCI connector for log collection

  12.4.6. Manually connect a cloud instance

  12.4.7. Edit your onboarded CSP configuration

##### Important

* When using Terraform authentication templates, you must execute the updated Terraform template from the same folder where the original Terraform template was executed.

  12.4.8. Outposts

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM product that has the Cloud Runtime Security add-on.

##### Important

* Outpost scan is an alternative to the recommended standard cloud scan. Cloud scan is recommended because it is fully managed by Palo Alto Networks and incurs no compute costs for your organization. Outpost scan is an advanced deployment model reserved for specific data residency or architectural requirements.

  12.4.8.1. Outpost fundamentals and planning

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM product that has the Cloud Runtime Security add-on.

##### Note

* Before you create your outpost, verify that your internet connection is active. An active internet connection is necessary for the notification to be sent to Cortex XSIAM to create the new outpost.

##### Important

* While outposts provide maximum control over the scanning environment, cloud scan mode is the recommended default for most organizations.

##### Navigation

  Before onboarding your Cortex XSIAM with the cloud service provider (CSP) onboarding wizard, create an outpost by navigating to Settings → Data Sources & Integrations → Outposts

  Settings → Data Sources & Integrations → Add New

  View and manage existing outposts by navigating to Settings → Data Sources & Integrations → Outposts

  12.4.8.2. Create an outpost

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM product that has the Cloud Runtime Security add-on.

##### Prerequisite

* Before you begin, ensure you have: An AWS account Permission to create a stack and its resources in AWS Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the AWS CLI tool and configured your profile with the aws...

* Before you begin, ensure you have: A GCP account Permission to create the required resources in Google Cloud Deployment Manager Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool

* Before you begin, ensure you have: An active Azure subscription. Installed the Azure CLI tool. Permission to deploy a custom template and create its resources in Microsoft Azure ("Owner" or "Contributor" on the designated outpost subscription scope, and Active Directory "Cloud Application Administrator" or "Application Administrator" privileged...

##### Note

* Verify that your internet connection is active. An active internet connection is necessary for notifications to be sent to Cortex XSIAM for creating the new outpost. If you are unable to establish an internet connection, contact customer support for a manual workaround.

* When creating an outpost for a specific Azure subscription, the outpost account must be in the same Azure organization as the monitored subscriptions.

##### Important

* While outposts provide maximum control over the scanning environment, cloud scan mode is the recommended default for most organizations. For details, see When to choose outpost scan.

##### Navigation

  Start the outpost creation wizard by navigating to Settings → Data Sources & Integrations → Outposts and clicking New Outpost

  A new outpost is created in pending status and can be viewed in the Outpost page at Settings → Data Sources & Integrations → Outposts

  12.4.9. Introduction to Terraform for Cloud service provider (CSP) onboarding

##### Important

* Always run these commands in the same folder where the original .tf files and .terraform folder live—this is where the state is stored.

* This .tfstate state file is critical because it is needed by the terraform destroy command to clean up created resources. It is critical that you never delete this file.

  12.4.10. Container Registry Scanning

  12.4.10.1. Overview of container registry scanning

  12.4.10.1.1. Registry Components

  12.4.10.1.2. How Container Registry Scanning Works

  12.4.10.2. Configure registry scanning for cloud accounts

##### Prerequisite

* Ensure that you have performed the all steps till Additional Security Capabilities as listed in the onboarding wizard for the required CSP: Onboard Amazon Web ServicesOnboard Amazon Web Services Onboard Google Cloud PlatformOnboard Google Cloud Platform Onboard Microsoft AzureOnboard Microsoft Azure Onboard Oracle Cloud InfrastructureOnboard Oracle...

  12.4.10.3. Modify the container registry scanning scope

  12.4.10.4. Scan re-evaluation process

  12.4.10.5. Connect Docker Hub registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

##### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  12.4.10.5.1. Manage a Docker Hub connector

##### Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

  12.4.10.6. Connect Docker V2 compliant container registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

##### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  12.4.10.6.1. Manage a Docker V2 connector

##### Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

  12.4.10.7. Connect GitLab container registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

##### Note

* When both the group ID and project ID are provided, the system retrieves container images from all projects within the specified group as well as from the specified project. If neither the group ID nor the project ID is provided, the system retrieves container images from all registries (across all groups and projects) accessible to the authenticated...

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  12.4.10.7.1. Manage a Gitlab Container Registry connector

##### Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

  12.4.10.8. Connect Harbor registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

##### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  12.4.10.8.1. Manage a Harbor connector

##### Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

  12.4.10.9. Connect JFrog container registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

##### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  12.4.10.9.1. Manage a JFrog connector

##### Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

  12.4.10.10. Connect Sonatype Nexus registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

##### Note

* If you are using a CA certificate, enter the server IP address instead of the registry url.

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* If you are using a CA certificate, enter the server IP address instead of the registry URL.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  12.4.10.10.1. Manage a Sonatype connector

##### Note

* If you had selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

  12.4.11. Cloud service provider permissions

  12.4.11.1. Amazon Web Services provider permissions

  12.4.11.2. Google Cloud Platform provider permissions

  12.4.11.3. Microsoft Azure provider permissions

  12.4.11.4. Oracle Cloud Infrastructure provider permissions

  12.5. Generic on-premise data collectors

  12.5.1. Broker VM data collector applets

  12.5.1.1. Activate Apache Kafka Collector

##### Prerequisite

* Apache Kafka version 2.5.1 and above. Kafka cluster set up on premises, from which the data will be ingested. Privileges to manage Broker Service configuration, such as Instance Administrator privileges. Create a user in the Kafka cluster with the necessary permissions and the following authentication details:    Broker Certificate and Private Key for...

##### Note

* For CEF and LEEF logs, Cortex XSIAM takes the vendor and product names from the log itself, regardless of what you configure on this page.

  12.5.1.2. Activate Cortex Network Scanner

##### License Type

  Requires the Exposure Management add-on.

##### Prerequisite

* Review the Cortex Network Scanner deployment recommendations and complete any prerequisites. Set up and configure Broker VM

##### Important

* The Cortex Network Scanner applet is not supported for FedRAMP customers. Cortex Network Scanner does not support high availability (HA) Broker VM configuration.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  Settings → Configurations → Network Scanners → Network Scanners and find your new scanner in the list

  12.5.1.3. Activate CSV Collector

##### Prerequisite

* Set up and configure Broker VM. Ensure that you share the applicable CSV files. Know the complete file path for the Windows directory.

##### Note

* When you implement a wildcard file search, ensure that the CSV files share the same columns and header rows as all other logs that are collected from the CSV files to create a single dataset.

* The CSV Collector checks for new CSV files every 10 minutes.

  12.5.1.4. Activate Database Collector

##### Prerequisite

* Set up and configure Broker VM

##### Note

* The reference data ingested using the DB Collector is counted towards license utilization.

##### Important

* When configuring the DB collector to work with an Oracle database and enabling this option, ensure the following steps are completed for a successful connection: Ensure you have the certificate of the Database server. Upload certificate to Broker CA Trust Store (Conditional): This step is only required if the Oracle server's certificate is self-signed...

  12.5.1.5. Activate DSPM Fileshare

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Set up and configure Broker VM Know the complete path to the files and folders that you want Cortex XSIAM to monitor. Necessary user permissions to access the network shares. For the SMB connection type, you need the user name and password.

##### Note

* The applet list displays only the applets for which you have permissions.

* By default, all configured connections are saved.

* For details regarding the connection fields, see the table above under File Share Connection.

* You can add multiple connections under a single instance of the DSPM Fileshare applet by returning to the File Share Connection screen and clicking Add Connection. Each new connection can be of either the NFS or SMB connection type.

  12.5.1.6. Activate Files and Folders Collector

##### Prerequisite

* Set up and configure Broker VM. Know the complete path to the files and folders that you want Cortex XSIAM to monitor. Ensure that the user permissions for the network share include the ability to rename and delete files in the folder that you want to configure collection.

##### Note

* Cortex XSIAM only supports ingestion of files encoded in UTF-8 format.

* When using the Linux file share, including the Linux share with NFS, a Username and Password are not required, so these fields are grayed out in the screen.

* In Batch mode, the Files and Folders Collector supports collecting logs from a network share for a maximum file size of 500 MB.

* When uploading JSON files, Cortex XSIAM only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* When the storing method is Replace, the maximum size for the total data to be imported into a lookup dataset is 30 MB each time the data is fetched. The inventory data ingested using the Files and Folders collector is counted towards license utilization. When you use a JOINT function with a lookup table in a query or correlation rule, make sure you...

* You can't specify a file name that's the same as a system file name. The name of a dataset created from a tsv file must always include the extension. If the original file name is mrkdptusrsnov23.tsv, you can name save the dataset with the name marketing_dept_users_Nov_2023.tsv.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

  12.5.1.7. Activate FTP Collector

##### Prerequisite

* Set up and configure Broker VM. Ensure that the user permissions for the FTP, SFTP, or FTPS include the ability to rename and delete files in the folder that you want to configure collection. When setting up an FTPS Collector with a server using a Self-signed certificate, you must upload the certificate first to the Broker VM as a Trusted CA...

##### Note

* When configuring an SFTP connection, Cortex XSIAM expects the private key to be in the RSA format that is included in the -----BEGIN RSA PRIVATE KEY----- tag. Cortex XSIAM does not support providing the private key in the OpenSSH format from the -----BEGIN OPENSSH PRIVATE KEY----- tag. When using ssh-keygen using a Mac, you get the OpenSSH format by...

* When uploading JSON files, Cortex XSIAM only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

  12.5.1.8. Activate Local Agent Settings

##### License Type

  Requires Cortex XSIAM Enterprise, Premium, or any other XSIAM license that includes endpoints or Cortex Cloud Runtime Security.

##### Note

* This is assuming a standard hardware setup with 2vCPU 8 GB memory.

* Broker VMs can act as as a proxy for routing XDR Collector traffic to the Cortex XSIAM tenant. The Broker VM does not cache XDR Collector installers.

* When you install your XDR agents, you need to configure the IP address of the Broker VM and a port number during the installation. You can use the default 8888 port or set a custom port. You are not permitted to configure port numbers between 0-1024 and 63000-65000, or port numbers 4369, 5671, 5672, 5986, 6379, 8000, 9100, 15672, 25672. Additionally,...

##### Important

* A FQDN must be configured for WEC and Agent Installer and Content Caching to function properly.

* You can only enable Agent Installer and Content Caching, when in the Broker VM Configuration, you've uploaded your signed SSL Server Certificate and key and set the FQDN. For more information, see the Agent Installer and Content Caching requirements explained above.

  12.5.1.9. Activate NetFlow Collector

##### Prerequisite

* Set up and configure Broker VM

##### Note

* Since multiple network devices can send data to a single NetFlow Collector, we recommend that you configure a maximum of 50 NetFlow Collectors per Broker VM applet, with a maximum aggregated rate of approximately 50K flows per second (FPS) to maintain system performance.

* Since Cortex XSIAM reserves some port numbers, it is best to select a port number that is not in the range of 0-1024 (except for 514), in the range of 63000-65000 or has one of the following values: 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672.

* The options available change, according to the set Source Network value.

  12.5.1.10. Activate Network Mapper

##### License Type

  Requires Cortex XSIAM Enterprise, Premium, or any other XSIAM license that includes endpoints or Cortex Cloud Runtime Security.

##### Prerequisite

* After you have configured and registered your Broker VM, you can choose to activate the Network Mapper application.

##### Note

* Each IP address range can receive multiple scan requests based on it's availability.

* IP address ranges are displayed according to what you defined as your Network Parameters.

  12.5.1.11. Activate Registry Scanner

##### License Type

  Requires the Cortex XSIAM Premium license or any other XSIAM license with the Cloud Posture Security or the Cloud Runtime Security add-on.

##### Prerequisite

* To initialize registry scanning on your Broker VM, you must first add the necessary data connectors. For details, see:    Connect Docker Hub registry   Connect Docker V2 compliant container registry   Connect GitLab container registry   Connect Harbor registry   Connect JFrog container registry   Connect Sonatype Nexus registry To initialize registry...

##### Note

* You cannot activate the Registry Scanner directly on a new or existing Broker VM. You can only activate or deactivate existing Registry Scanner applets. To activate or deactivate existing applets, see Step 4 under Verify Registry Scanner connection section.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  12.5.1.12. Syslog Collector applet

  12.5.1.12.1. Activate Syslog Collector

##### Prerequisite

* Set up and configure Broker VM

##### Note

* Once configured, you cannot change the Port/PROTOCOL. If you don't want to use a data source, ensure to remove the data source from the list as explained in Task 5.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and...

* The server certificate and private key pair is expected in a PEM format. Cortex XSIAM will notify you when your certificates are about to expire.

* Because some port numbers are reserved by Cortex XSIAM , you must choose a port number that is not: In the range of 0-1024 (except for 514) In the range of 63000-65000 Values of 4052, 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672

* CORELIGHT is not available for a UDP protocol.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  12.5.1.12.2. Ingest logs from a Syslog receiver

  12.5.1.12.3. Check Point FW1/VPN1

  12.5.1.12.3.1. Ingest logs from Check Point firewalls

##### Note

* Logs with sessionid = 0 are dropped. Destination Port data is available only in the raw logs.

  12.5.1.12.4. Cisco ASA firewalls and AnyConnect

  12.5.1.12.4.1. Ingest logs from Cisco ASA firewalls and AnyConnect

  12.5.1.12.5. Corelight Zeek

  12.5.1.12.5.1. Ingest logs from Corelight Zeek

  12.5.1.12.6. Forcepoint DLP

  12.5.1.12.6.1. Ingest logs from Forcepoint DLP

  12.5.1.12.7. Fortinet Fortigate

  12.5.1.12.7.1. Ingest logs from Fortinet Fortigate firewalls

  12.5.1.12.8. Next-Generation Firewall

  12.5.1.12.8.1. Ingest Next-Generation Firewall logs using the Syslog collector

##### Note

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version, to ensure that you have configured log forwarding correctly for all the log types that you would like to forward to Cortex XSIAM. The following steps only cover...

* To avoid the possible effects of line formatting, do not copy/paste the message formats directly into the PAN-OS web interface. Instead, paste into a text editor, remove any carriage return or line feed characters, and then copy and paste into the web interface.

* From version 10.0 and later, the log format documented for log types (Traffic, Threat, and URL) exceeds the maximum supported 2048 characters in the Custom Log Format tab on the firewall and Panorama. Select the CEF keys and values to limit the number of characters to 2048, as per your requirements.

  12.5.1.12.9. PingFederate

  12.5.1.12.9.1. Ingest authentication logs from PingFederate

  12.5.1.12.10. Zscaler Internet Access

  12.5.1.12.10.1. Ingest logs from Zscaler Internet Access

  12.5.1.12.11. Zscaler Private Access

  12.5.1.12.11.1. Ingest logs from Zscaler Private Access

##### Note

* For more information on configuring the parameters on the screen, see the Zscaler Private Access (ZPA) documentation for Configuring a Log Receiver.

* You can only configure a ZPA log receiver to collect one type of log with your Syslog Collector in Cortex XSIAM. To configure more that one log type, you'll need to add another log receiver.

  12.5.1.13. Activate Transporter

##### License Type

  Included in the Cortex XSIAM Premium license. It is also included with any other XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator) Set up and configure Broker VMSet up and configure Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex XSIAM resources. The IP addresses...

##### Warning

* The Transporter applet is not supported for FedRAMP customers.

##### Navigation

  Settings → Configurations → Broker VMs (under Data Broker

  the Brokers tab → locate your Broker VM → hover and click + Add under the Apps column → AppSec Transporter

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

  12.5.1.14. Activate Windows Event Collector

##### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

##### Note

* You can also activate the Windows Event Collector on Windows Core. For more information, see Activate Windows Event Collector on Windows Core.

* By default, Cortex XSIAM collects Palo Alto Networks predefined Security events that are used by the Cortex XSIAM detectors. Removing the Security collector interferes with the Cortex XSIAM detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

  12.5.1.14.1. Activate Windows Event Collector on Windows Core

##### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

##### Note

* By default, Cortex XSIAM collects Palo Alto Networks predefined Security events that are used by the Cortex XSIAM detectors. Removing the Security collector interferes with the Cortex XSIAM detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

  12.5.1.14.2. Renew WEC certificates

##### Note

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* You can see more than one ca.wec.paloaltonetworks.com and forwarder.wec.paloaltonetworks.com file from a previous installation in the directory, so select the file with the most extended Expiration Date. You can verify that you are using the correct certificate: To verify the client certificate in the Personal → Certificates folder is related to the...

* Only perform this step under the following conditions: You have completed the WEF certification renewal process for ALL clients in your environment. Otherwise, events from the WEFs that you did not install the new client certificate will not be collected by the WEC. You are approaching the WEC server CA certificate expiration date, which is 2 years...

* If this query does not display results with a timestamp from after the renewal process, it could indicate that the renewal process is not complete, so wait a few minutes before running another query. If you are still having a problem, contact Technical Support.

##### Important

* After you receive a notification for renewing your WEC CA certificate, we recommend that you do not add any new WEF clients until the WEC certification renewal process is complete. Events from these WEF clients that are added afterwards will not be collected by the server until the WEC certificates are renewed.

  12.5.2. XDR Collectors

##### Note

* Ingestion of log events larger than 5 MB is not supported.

  12.5.2.1. XDR Collector audit logs

  12.5.2.2. XDR Collector machine requirements and supported operating systems

  12.5.2.3. Resources required to enable access to XDR Collectors

##### Note

* Some of the IP addresses required for access are registered in the United States. As a result, some GeoIP databases do not correctly pinpoint the location in which IP addresses are used. All customer data is stored in your deployment region, regardless of the IP address registration and restricts data transmission through any infrastructure to that...

* Throughout this topic, <xsiam-tenant> refers to the chosen subdomain of your Cortex XSIAM tenant and <region> is the region in which your Strata Logging Service is deployed.

  12.5.2.4. Manage XDR Collectors

  12.5.2.4.1. XDR Collectors installation resource for Windows and Linux

##### Note

* In some circumstances, such as after an XDR Collectors upgrade, the configured settings in the XML configuration file can be erased. Yet, this won't affect the saved settings in the XDR Collectors database.

  12.5.2.4.2. Create an XDR Collector installation package

##### Note

* XDR Collectors cannot be moved between Cortex XSIAM managing servers. In this situation, you need to uninstall the existing collector, and then install a new collector using an installation package from the new managing server. For more information on uninstalling, see Uninstall the XDR Collector.

* Since Cortex XSIAM relies on the installation package ID to approve XDR Collector registration during install, it is not recommended to delete the installation package for any active on-premise collector machines. Hiding the installation package will remove it from the default list of available installation packages, and can be useful to eliminate...

  12.5.2.4.3. Install the XDR Collector installation package for Windows

  12.5.2.4.3.1. Install the XDR Collector on Windows using the MSI

##### Note

* When the package is executed using the MSI, an installation log is generated in %TEMP%\MSI<Random characters>.log by default.

* If the XDR Collector does not connect to Cortex XSIAM, verify your internet connection on the collector machine. If the XDR Collector still does not connect, verify that the installation package has not been removed from the Cortex XSIAM tenant.

  12.5.2.4.3.2. Install the XDR Collector on Windows using Msiexec

  12.5.2.4.4. Install the XDR Collector installation package for Linux

##### Note

* We recommend that you perform a Linux RPM or Linux DEB installation.

* If the XDR Collector does not connect to Cortex XSIAM, verify your Internet connection on the collector machine. If the XDR Collector still does not connect, verify the installation package has not been removed from the Cortex XSIAM management console.

* The XDR Collector does not support proxy communication in environments where proxy authentication is required.

##### Important

* When performing a XDR Collector installation or upgrade in Linux using a shell installer, the  /tmp folder cannot be marked as noexec. Otherwise, the installation or upgrade fails. As a workaround, before the installation or upgrade, use the following command:

  12.5.2.4.5. Configure the XDR Collector upgrade scheduler

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → XDR Collectors → Configuration

  12.5.2.4.6. Set an application proxy for XDR Collectors

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → XDR Collectors → Administration

  12.5.2.4.7. Set an alias for an XDR Collector machine

##### Navigation

  Settings → Configurations → XDR Collectors → Administration

  12.5.2.4.8. Upgrade XDR Collectors

##### Note

* The XDR Collector keeps the name of the original installation package after every upgrade.

  12.5.2.4.9. Uninstall the XDR Collector

##### Navigation

  Settings → Configurations → XDR Collectors → Administration

  Investigation & Response → Response → Action Center

  12.5.2.5. Define XDR Collector machine groups

##### Note

* XDR Collectors only support IPv4 addresses.

* Disconnecting Directory Sync in your Cortex XSIAM deployment can affect existing collector machine groups and policy rules based on Active Directory properties.

  12.5.2.6. About Cortex XDR Collector content updates

  12.5.2.7. XDR Collector profiles

  12.5.2.7.1. Add an XDR Collector profile for Windows

##### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex XSIAM collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex XSIAM supports logs in single line format or multiline format. For more...

  12.5.2.7.1.1. Ingest logs from Windows DHCP using Elasticsearch Filebeat

##### Note

* Although this enrichment is available when configuring a Windows DHCP collector for a cloud data collection integration, we recommend configuring Cortex XSIAM to receive Windows DHCP logs with an XDR Collector Windows Filebeat profile, because it is simpler to set up.

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the template provided by Cortex XSIAM to make your customizations. We recommend that you edit the file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating your...

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the example file provided by Cortex XSIAM to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your filebeat.yml file. Validate the syntax of the YML file before you finish creating...

* The tokenizer definition is dependent on the Windows server version that you are using, because the log format differs. For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%...

  12.5.2.7.1.2. Ingest Windows DNS debug logs using Elasticsearch Filebeat

##### Note

* Detailed logs are significantly larger, because more information is added to the logs.

* To avoid formatting issues in your filebeat.yml file, we recommend that you validate the syntax of the file.

  12.5.2.7.2. Add an XDR Collector profile for Linux

##### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex XSIAM collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex XSIAM supports logs in single line format or multiline format. For more...

  12.5.2.8. Apply profiles to collection machine policies

##### Navigation

  Settings → Configurations → XDR Collectors → Policies → +Add Policy

  12.5.2.9. XDR Collector datasets

  12.5.2.10. Troubleshoot XDR Collectors errors

##### Note

* For more information on creating correlation rules to trigger collection health issues, see How can I set up correlation rules to trigger collection health issues?.

  12.6. Palo Alto Networks integrations

##### License Type

  Data collection may require an add-on.

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

  12.6.1. About Palo Alto Networks integrations

##### Note

* For Palo Alto Networks Integrations there is an option to turn on or off the collection of URL and File log types. For more information, see Collecting URL and File log types.

* Roll-back of Strata Logging Service integration migration is not supported.

  12.6.2. Next-Generation Firewall

  12.6.2.1. Ingest data from Next-Generation Firewall

##### Prerequisite

* Ensure that you have completed the following on the NGFW or Panorama side: For Panorama only, ensure that the Panorama Cloud Services plugin is installed. Enable log forwarding profiles on firewall rules. On the Cortex XSIAM side, ensure that you have user role permissions for Data Collection > Data Sources & Integrations. Configuration of data...

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* If your firewalls are located in a different region, or bandwidth issues are encountered due to large log size, you can ingest NGFW logs in CEF format, using the Syslog collector. However, the Syslog solution is not as powerful nor as comprehensive as this data collector, and should only be used when this data collector cannot be used. For more...

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version.

* Cortex XSIAM does not validate your firewall credentials, you must ensure the certificates or PSK details have been updated in your firewalls in order for data to stream.

* It can take an hour or longer after connecting the firewall in Cortex XSIAM until you start seeing notifications that the certificate has been approved, and that the logging service license has appeared on the firewall.

* IOC and BIOC issues are applicable on stitched data only, and are not available on raw data.

##### Tip

* You can see an overview of ingestion status for all log types, and a breakdown of each log type and its daily consumption quota on the NGFW Ingestion Dashboard.

  12.6.2.2. Ingest Next-Generation Firewall logs using the Syslog collector

##### Note

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version, to ensure that you have configured log forwarding correctly for all the log types that you would like to forward to Cortex XSIAM. The following steps only cover...

* To avoid the possible effects of line formatting, do not copy/paste the message formats directly into the PAN-OS web interface. Instead, paste into a text editor, remove any carriage return or line feed characters, and then copy and paste into the web interface.

* From version 10.0 and later, the log format documented for log types (Traffic, Threat, and URL) exceeds the maximum supported 2048 characters in the Custom Log Format tab on the firewall and Panorama. Select the CEF keys and values to limit the number of characters to 2048, as per your requirements.

  12.6.3. Ingest data from Prisma Access

##### Prerequisite

* Configuration of data ingestion from multiple accounts requires Super User permissions in both Cortex XSIAM tenant and Prisma Access accounts.

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* Cortex XSIAM does not validate your Prisma Access account credentials. You must ensure the account has been deployed in order for data to stream.

  12.6.4. Ingest logs from Prisma Access Browser

  12.6.5. Ingest detection data from Strata Logging Service

##### Note

* IOC and BIOC issues are applicable on stitched data only and are not available on raw data.

  12.6.6. IoT Security

  12.6.6.1. Ingest alerts and assets from IoT Security

  12.6.7. Collecting URL and File log types

  12.7. External alerts using External Issue Mapping

  12.7.1. Ingest external alerts

##### Note

* If you send pre-parsed alerts using the Cortex XSIAM API, additional mapping is not required.

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → Data Collection → External Issue Mapping

  12.8. Administration and troubleshooting

  12.8.1. Manage instances

  12.8.1.1. Add a new data source or instance

##### Note

* If a data source contains multiple integrations, the integration configured as the default integration will used by the Data Onboarder. The default integration of the content pack is indicated in each content pack's documentation. The other integrations are available for configuration in the Data Sources & Integrations page after installing the content...

* If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant page in the system, for example Correlations, Playbooks, or Scripts. If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant...

  12.8.1.2. How to configure the scanning settings for supported services

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Note

* If you do not select a scanning cadence, the default setting is applied. For more information, contact your Customer Support team.

  12.8.1.3. Manage cloud instances

  12.8.1.4. Update cloud permissions after Cortex release updates

##### Prerequisite

* Ensure that the user account used to modify permissions has the necessary privileges within both the Cortex platform and your cloud environment, for example, AWS or Azure. You received a notification regarding a new version available that requires permission updates, or viewed a Needs Update status in the Data Sources & Integrations page.

##### Note

* Instances requiring updates will not change their connection status, for example, Connected, Warning, Error, Disabled, due to the pending permission update.

  12.8.1.5. Pending cloud instances

  12.8.1.6. Troubleshoot errors on cloud instances

##### Note

* Errors related to collection of audit logs in the cloud instance are recorded in the collection_auditing dataset. For more information, see Audit logs fields and query examples.

  12.8.1.7. Manage Kubernetes Connector instances

##### Note

* After uninstalling the Kubernetes connector, the connector status updates to Not connected 48 hours after the uninstall process is initiated.

##### Navigation

  You can also manage the Kubernetes Connector instances from Inventory → Assets → Kubernetes Clusters

  12.8.2. Integrations

##### Note

* Some integrations can be downloaded directly without having to initially download a content pack from Marketplace. For more information, see Define data sources.Define data sources In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require...

* If the integration was installed from a content pack, you need to duplicate the integration before editing.

* If the integration was installed from a content pack, you need to duplicate the integration before downloading.

* Integration commands are only available when the integration instance is enabled. Some commands depend on a successful connection between Cortex XSIAM and third-party integrations.

##### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

##### Navigation

  Settings → Configurations → Marketplace

  12.8.2.1. Integration use cases

  12.8.2.2. Add an integration instance

  12.8.2.3. Configure integration permissions

##### Navigation

  Settings → Configurations → Data Collection → Integration Permissions

  12.8.2.4. Fetch issues from an integration instance

##### Note

* In some integrations, the Issue Fetch interval is called Feed Fetch Interval. If the integration instance does not have the Issue Fetch Interval field, you need to add this field by editing the integration settings. If the integration is from a content pack, you need to create a copy of the integration. Any future updates to this integration will not...

* Some content packs include preconfigured correlation rules, but you should review them to see if they suit your use case and duplicate them if required. Go to Threat Management → Detection Rules → Correlations, search for the relevant rule, right-click, and select Preview Rule. For example, the ServiceNow v2 Alerts (automatically generated)...

  12.8.2.4.1. Map fields to issue types

##### Note

* In the Classification & Mapping page, the mapping does not indicate for which issue types they are configured. Therefore, when creating a mapper, it is best practice to add to the mapper name, the issue types the mapper is for. For example, Mail Listener - Phishing.

* When mapping a list, we recommend you map to a multi select field. Short text fields do not support lists. If you do need to map a list to a short text field, add a transformer in the relevant playbook task, to split the data back into a list.

##### Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

  12.8.2.4.2. Classify events using a classifier for issue types

##### Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

  12.8.2.5. Troubleshoot Integrations

  12.8.2.6. Forward Requests to Long-Running Integrations

##### Note

* This integration replaces the External Dynamic list integration, which is deprecated. For more information about how to set up the integration, see Manage external dynamic lists.

* When running on the tenant, you can only use long-running integrations provided by Cortex XSIAM, you cannot create custom ones. Custom long-running integrations are supported only on engines at this time. Configuring custom certificates or private API Keys in the long-running integration instance is supported only on engines, not on the Cortex XSIAM...

* For the TAXII Server and TAXII2 Server integrations, the xdr string is automatically replaced by crtx. For the Microsoft Teams integration, you can use the microsoft-teams-create-messaging-endpoint command to get the correct messaging endpoint based on the server URL, the server version, and the instance configurations. For more information, see...

  12.8.3. Verify collector connectivity

##### Note

* For more information on troubleshooting data collector applet errors, see Troubleshoot Broker VM applet connectivity.

* If an issue is triggered, the investigation options in the right-click menu of the Health Issues pages are context-specific. Make sure that you specify the relevant issue category.

  12.8.4. Overview of data ingestion metrics

##### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable Cortex - Analytics. Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics.

  12.8.4.1. Creating correlation rules to monitor data ingestion health

  12.8.4.2. Measuring data freshness

##### Note

* The max_delay metric is taken from the maximum bucket value with a restricted limit; therefore, metrics show whole numbers. The median and ninetieth_percentile metrics are statistical calculations that give an approximation of the real value; therefore, metrics show decimal numbers. Time slots with a zero log count or zero byte count display records...

  12.8.5. About health issues

##### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics.

##### Note

* The Health Issues page displays issues that were triggered after July 2024. To see health issues that were triggered before this date, click Legacy Health Issues.

* Cortex XSIAM enforces the dedup logic to health issues. This logic reduces the likelihood of identical health issues from flooding the issues dataset.

  12.8.5.1. Investigate and resolve health issues

  12.8.5.2. Monitor data ingestion health

  12.8.5.3. Monitor correlation rules

##### Note

* In the dataset, the Query start time and Query end time indicate the timeframe of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

13. Marketplace

  13.1. Cortex Marketplace

##### Navigation

  Settings → Configurations → Marketplace) or at Cortex Developer Docs Marketplace

  13.2. Content packs

##### Note

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

##### Navigation

  Settings → Configurations → Marketplace) or at Cortex Developer Docs Marketplace

  13.3. Content Pack Support Types

##### Note

* Palo Alto Networks is not liable for and does not warrant or support any content pack produced by a third-party publisher. Palo Alto Networks does not support content packs that do not have official available documentation.

  13.4. Cortex XSIAM content

  13.5. Manage content packs

##### Note

* Optional content packs that are already installed are treated like they are required content packs to preserve content integrity.

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

* In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as scripts or integrations.

* Third-party product integrations are developed and tested against a specific product version. For products that are on-prem or cloud-based with specific API versions, the version developed and tested against will be included in the integration's documentation. Newer versions of the product are not always immediately tested, and it is expected that...

##### Caution

* If you want to downgrade, any content that depends on the content pack including any customizations may be deleted if it does not exist in the target content pack version.

* If another content pack is dependent on the content pack you want to delete, it may break the other content pack. You can reinstall the content pack, but you cannot restore detached and customized content.

  13.6. Marketplace FAQs

  13.7. Content changes when upgrading Cortex XSIAM versions

  13.8. Content pack contributions

14. Cortex XSIAM XQL

  14.1. Get started with XQL

  14.1.1. XQL language features

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

##### Navigation

  You submit XQL queries to Cortex XSIAM using the Investigation & Response → Search → Query Builder user interface

  14.1.2. XQL Language Structure

  14.1.2.1. Adding comments in queries

  14.1.3. Supported operators

##### Note

* In some cases, using an IN or NOT IN operator combined with a dataset and filter stage can be a better alternative to using a join stage.

  14.1.4. Datasets and presets

##### Note

* To set up this Cloud Identity Engine (previously called Directory Sync Service (DSS)) dataset, you need to set up a Cloud Identity Engine. Otherwise, you will not have a pan_dss_raw dataset. For more information, see Set up Cloud Identity Engine.

* INFO issues are not included in this dataset. This dataset includes issues from the Security and Health domains. For more information, see Overview of the Issues page.

* The fields contained in this dataset are a subset of the fields in the xdr_data dataset.

* If the vendor and product are not specified in the Winlogbeat profile's configuration file, Cortex XSIAM creates a default dataset called microsoft_windows_raw.

* To ensure GlobalProtect access authentication logs are sent to Cortex XSIAM, verify that your PANW firewall's Log Settings for GlobalProtect has the Cortex Data Lake checkbox selected.

* You must have the Cortex XSIAM Threat Intel Management (TIM) Add-on to use this dataset.

* Prisma Access firewalls do not send configuration logs to the Structured Log Storage (SLS).

* You can query in XQL for this data and build widgets based on the xdr_data dataset or using the preset device_control. To view in an XQL query these events, the Device Configuration of the endpoint profile must be set to Block. Otherwise, the USB events are not captured. The events are also captured when a group of device types are blocked on the...

##### Important

* This dataset will not be updated after June 2024. Use the health_alerts dataset instead.

  14.1.5. About examples

##### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

  14.1.6. JSON functions

##### Important

* JSON field names are case sensitive, so the key to field pairing must be identical in an XQL query for results to be found. For example, if a field value is "TIMESTAMP" and your query is defined to look for "timestamp", no results will be found.

  14.1.7. How to filter for empty values in the results table

  14.1.8. Understanding string manipulation in XQL

  14.2. Build XQL queries

##### Note

* If you have the Cortex Agentic Assistant, you can use natural language prompts to create and run XQL queries within the chat interface. For more information, see Create and run XQL queries with Agentic Assistant chat.Cortex Agentic AssistantCreate and run XQL queries with Agentic Assistant chat

  14.2.1. About the Query Builder

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

  14.2.2. How to build XQL queries

##### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

##### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  14.2.2.1. Get started with XQL queries

##### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

  14.2.2.2. Useful XQL user interface features

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

  14.2.2.3. XQL Query best practices

  14.2.2.4. Expected results when querying fields

  14.2.2.5. Create XQL query

##### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined for the entire query, including queries that are part of the join stage. Yet, this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

  14.2.2.6. Review XQL query results

##### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* Results are received incrementally for the first 100K records, or up to 100MB worth of records, whichever comes first. After that, the next update is when the query has finished running completely.

* Real time query results are available only in the Query Builder and in free text query. Real time results are displayed only for queries run on hot datasets. The Sort option is available only after all the data is retrieved. When you formulate complex queries, the results will be displayed when the query has finished running completely, and not in real...

* In order for Cortex XSIAM to provide a histogram for a field, the field must not contain an array or a JSON object.

  14.2.2.7. Translate to XQL

##### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

  14.2.2.8. Graph query results

##### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

  14.2.3. Query Builder templates

##### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

  14.2.3.1. Get started with Query Builder templates

  14.2.3.2. Considerations for using Query Builder templates

  14.2.3.3. Create a query from a template

##### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

  14.2.3.4. Run a free text query

##### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

  14.2.3.5. Query Builder template examples

##### Navigation

  Investigation & Response → Search → Query Builder

  14.2.4. Overview of the Query Center

##### Note

* Very short queries might not be listed. The default retention period for historic queries is aligned with issue retention.

  14.2.4.1. Edit and run queries in Query Center

##### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

##### Navigation

  Investigation & Response → Search → Query Center → Query History

  14.2.4.1.1. Query Center reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  14.2.5. Manage scheduled queries

##### Navigation

  Investigation & Response → Search → Scheduled Queries

  14.2.5.1. Scheduled Queries reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  14.2.6. Manage your query library

##### Note

* The Query to Library option is only available if your role has the Create Queries capability. For more information, see Manage access to saved queries.Manage access to saved queries

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

##### Important

* The ability to create, edit, or share queries is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to saved queries.Manage access to saved queries

  14.2.7. Federated Search

  14.2.7.1. Federated Search

##### Note

* Federated Search is not enabled by default. To enable it in your tenant, please contact your Customer Support Team.

* Federated search query costs are calculated according to timeframe, complexity, and any cross-cloud egress costs that may apply.

* For optimal results, we recommend the Parquet format.

* The list of supported regions may change in the future.

  14.2.7.2. Federated Search configuration

##### Prerequisite

* Access to Cortex XSIAM communication. For a list of the authorized IP addresses, see Enable access to required PANW resources. An AWS bucket that contains your data sources. Permissions to modify IAM policies in AWS.

* Access to Cortex XSIAM communication. For a list of the authorized IP addresses, see Enable access to required PANW resources. A GCS bucket that contains your data sources. Permissions to modify IAM policies in GCS.

* Access to Cortex XSIAM communication. For a list of the authorized IP addresses, see Enable access to required PANW resources. An Azure Blob Storage blob with your data sources. Permissions to modify IAM policies in Azure Blob Storage.

##### Note

* We highly recommend that you don't change the auto-detected schema. However, if the auto-detected schema is incorrect, you can add, edit or delete fields. You can't delete the ds field, which is used for Hive partitioning. After you save the schema, you can't delete any fields you added during setup.

* You can only configure regions that are in the multi-region of your tenant.

* We highly recommend that you don't change the auto-detected schema. You can't delete the ds field, which is used for Hive partitioning. After you save the schema, you can't delete any fields you added during setup.

* Copy the Directory (tenant) ID, the Application (client) ID, and the Object ID. You will use these in the connection step.

* We highly recommend that you don't change the auto-detected schema. However, you can add, edit or delete fields. You can't delete the ds field, which is used for Hive partitioning. After you save the schema, you can't delete any fields you added during setup.

* When you create, delete, or update an external dataset, the action is recorded in the Management Audit Logs under the type External Datasets.

##### Navigation

  Settings → Configurations → Data Management → Dataset management → External Datasets and click Add External Dataset

  14.2.7.3. Query using Federated Search

##### Note

* The following aren't available in Federated Search and remain exclusive to fully ingested data. Complex, cross-source analytical functions, for example correlations, widgets, dashboards, and APIs search, target and view XQL stages

##### Navigation

  Incident Response → Investigation → Query Builder and select XQL

  14.2.7.4. Manage external datasets

##### Note

* We highly recommend that you don't change the auto-detected schema. However, in the Edit window you can add new fields or delete the new fields you added in the Edit window. You can't delete the fields that were configured during setup.

##### Navigation

  Manage external datasets created for federates searches in Settings → Configurations → Data Management → Dataset management → External Datasets

  14.2.8. Legacy Query Builder

##### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

  14.2.8.1. Create authentication query

##### Navigation

  Investigation & Response → Search → Query Builder

  14.2.8.2. Create event log query

##### Navigation

  Investigation & Response → Search → Query Builder

  14.2.8.3. Create file query

##### Navigation

  Investigation & Response → Search → Query Builder

  14.2.8.4. Create image load query

##### Navigation

  Investigation & Response → Search → Query Builder

  14.2.8.5. Create network connections query

##### Navigation

  Investigation & Response → Search → Query Builder

  14.2.8.6. Create network query

##### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

  14.2.8.7. Create process query

##### Navigation

  Investigation & Response → Search → Query Builder

  14.2.8.8. Create registry query

##### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

  14.2.8.9. Query across all entities

##### Navigation

  Investigation & Response → Search → Query Builder

  14.3. Stages

  14.4. Functions

15. Graph Search

  15.1. What is Graph Search?

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  15.2. Get started with Graph Search queries

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

##### Navigation

  Understand your assets and findings data: Graph Search queries are based on the current data that has been collected for assets and findings from the data sources configured and then sent to the Unified Asset Inventory (UAI), which is displayed in the All Assets page (Inventory → Assets → All Assets

  15.3. How to build Graph Search queries?

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

##### Navigation

  You submit Graph Search queries using the Investigation & Response → Search → Query Builder → Graph Search built-in query interface

  15.4. Understand Graph Search query results

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  15.5. Create Graph Search query

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

##### Note

* For more information about the Query Library, see Manage the Graph Search Query Library.

##### Tip

* After running the query, you can view the complete query by hovering over the last THAT... in the Graph Search query interface, and the query is displayed in a tooltip. If your query doesn't find any results or you want to change your query for any reason, you can always click anywhere in the Graph Search query interface, where your existing query is...

  15.6. Graph Search examples

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  15.7. Manage the Graph Search Query Library

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

##### Navigation

  From Graph Search in the Query Builder Select Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Center

  15.8. Edit and run queries in Query Center

##### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

##### Navigation

  Investigation & Response → Search → Query Center → Query History

  15.8.1. Query Center reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  15.9. Supported assets and findings

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  15.10. FAQ on Graph Search

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

##### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

16. Cortex CLI

##### Note

* The CLI Read Only Role is not supported for CWP as the system does not support offline mode.

  16.1. Connect Cortex CLI

##### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

##### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources & Integrations →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Application Security, refer to Cortex CLI usage for Application Security

##### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source or Integrations page after selecting + Add New.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

  16.2. Cortex CLI common command line reference guide

##### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

  16.3. Cortex CLI for API Security

##### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more informationConnect Cortex CLI Ensure your application exposes APIs and provides a corresponding OpenAPI Specification file Ensure that you have installed Java v 11 and above

  16.3.1. Cortex CLI API Security command line reference guide

  16.4. Cortex CLI for Cloud Workload Protection

##### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more informationConnect Cortex CLI Verify that Java version 11 and above is installed: Run java -version in your terminal. If not, refer to Java SE Development Kit 11.0.25 for information...

* Before you begin, ensure you have sudo privileges to execute the image scan.

* For direct scanning from your Docker daemon, the image must already exist in your local Docker repository. The CLI will not pull a new image if it does not exist locally. To scan an image that exists in your local Docker daemon, simply provide its name: The image scan accepts the following arguments: --api-base-url: Required - true. The public facing API URL. Refer to Connect Cortex CLI for more informationConnect Cortex CLI --api-key: Required - true. Your Cortex Cloud API key. Refer to Connect Cortex CLI for more informationConnect Cortex CLI --api-key-id: Required - true. Your Cortex Cloud API key ID image scan: Required - true. Refers to CWP as the type of scan By default, Cortex XSIAM looks for the Docker socket at unix:///var/run/docker.sock. --docker-host <path> specifies the path to the Docker socket. Use this flag if your Docker socket is located elsewhere, for example unix:///var/snap/docker/common/run/docker.sock. To scan an image from a previously saved archive file (such as a .tar file), use the --archive flag: This example demonstrates how to create an image archive from your Docker or Podman environment, which can then be used for scanning or SBOM generation if you choose not to scan directly from the local daemon. With Docker: docker save -o ubuntu.tar ubuntu With Podman: podman save --format oci-archive -o /tmp/alpine-oci.tar alpine:latest You can generate a Software Bill of Materials (SBOM) for your container images using the Cortex CLI and and save the output to a specified file. This functionality enables you to store the SBOM for further analysis, auditing, and compliance. By default, this will retrieve the SBOM for an image from your local Docker daemon. To get an SBOM for an image from your local Docker daemon: Command: cortexcli image sbom: Exports a Software Bill of Materials (SBOM) document for a container image archive. Usage: cortexcli image sbom [command options] --archive-format value: Specifies the image archive format. Values: docker-archive (default), oci-archive --output-format value: Specifies the SBOM document output format. Values: json (default), xml --output-file value: Specifies the path to the file where the SBOM document will be saved --fields value [--fields value]: Specifies the fields to include in the SBOM document. Multiple fields can be specified including: author, binaries, license, name, purl, sourcePackage, type, version --help, -h: Displays help information for the command To export an SBOM from an image archive file, use the --archive flag: NAME: cortexcli image sbom - Exports an SBOM document for an image from the local Docker daemon or an image archive. USAGE: cortexcli image sbom [command options] [image name or archive file]. Docker socket not reachable: If you encounter errors indicating the Docker socket cannot be reached, ensure the Docker daemon is running and verify the path to your Docker socket. If it's not in the default location (unix:///var/run/docker.sock), use the --docker-host flag to specify the correct path Image not found: If you attempt to scan an image directly from the Docker daemon and receive an error that the image does not exist, confirm that the image is indeed present in your local Docker repository by running docker images. The CLI will not pull images 16.4.1 |Cloud Workload Protection command line reference This reference guide documents the Cloud Workload Protection commands and flags for the Cortex CLI, including the structure of base commands and subcommands. Refer to Cortex CLI common command line reference guide for Cortex CLI commands common to all supported modules. 16.5 |Cortex CLI for Code Security PREREQUISITE: For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

##### Note

* CWP does not support container image secret scanning for systems running on ARM architecture.

* For available CWP commands, refer to Cloud Workload Protection command line reference.

* --archive: When used with image scan, sets the scan source to an archive file. When used with image sbom, indicates the SBOM should be exported from an archive file The --archive flag can also be explicitly set as --archive=true --archive-format <value>: The image archive format (such as docker-archive or oci-archive). Default: docker-archive.

  16.5.1. Cortex CLI usage for Application Security

  16.5.2. Cortex CLI Application Security command line reference

##### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

##### Important

* The Cortex CLI Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id <YOUR_AUTH_ID>...

17. Multi-Tenant

  17.1. What is Cortex XSIAM multi-tenant?

##### Note

* By default, multi-tenant licenses include one child tenant.

  17.1.1. MSSP multi-tenant

  17.1.2. Enterprise multi-tenant

  17.2. Multi-tenant central licensing management

##### Note

* In MSSP or enterprise multi-tenant, the license specifies the maximum number of child tenants that can be created. Once this limit is reached, no additional tenants can be created, even if there remains allocation for endpoints or GBs.

  17.3. Onboard Cortex multi-tenant

  17.3.1. Onboarding checklist for multi-tenant central licensing deployments

  17.3.1.1. Step 1. Activate Cortex XSIAM (main account)

##### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

  17.3.1.2. Step 2. Create a child tenant

##### Note

* The main account is labeled in Cortex Gateway, but child tenants are not labeled. Cortex enables parent-child pairing between tenants located in different geographical regions. To enable this capability, contact your support team. To create a child tenant, ensure that you have Account Admin permissions.

* After activating a child tenant, you can't change the child tenant's name.

* This is a public FQDN, so be careful with sensitive information such as the company name. After activating a child tenant, you can only change the child tenant subdomain once.

* Ensure that you meet the minimum requirements for child tenant allocation.

* If you reach your limit for child tenants, depending on your license, you may be able to create more tenants. You may be charged for additional tenants. Contact Customer Support if you are approaching your authorized limit.

  17.3.2. Onboarding checklist for multi-tenant customer-owned license deployments

  17.3.2.1. Step 1. Activate Cortex Cortex XSIAM (parent and child tenants)

##### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

  17.3.2.2. Step 2. Define access configurations and role permissions

  17.3.2.3. Step 3. Pair a parent tenant with child tenant

##### Note

* This field is not enabled by default. To enable this, contact your support team.

  17.4. Dynamic license allocation

##### Note

* Changing the tenant's allocations might result in a short downtime of your tenant.

* After activating a child tenant, you can't change the child tenant's name.

* This is a public FQDN, so be careful with sensitive information such as the company name. After activating a child tenant, you can only change the child tenant subdomain once.

* Ensure that you meet the minimum requirements for child tenant allocation.

* If you reach your limit for child tenants, depending on your license, you may be able to create more tenants. You may be charged for additional tenants. Contact Customer Support if you are approaching your authorized limit.

* In a multi-tenant central licensing management environment, you cannot unpair a child tenant from the main account. The only way to remove the connection to the main account is to delete the tenant.

  17.5. Child tenant management

  17.5.1. Manage a child tenant

##### Note

* Once a configuration is created Cortex XSIAM resets the child tenant data and synchronizes the security actions configured in the parent tenant.

  17.5.2. Track your tenant management

##### Note

* This field is not enabled by default. To enable this, contact your support team.

##### Navigation

  To view child tenant details, in Cortex XSIAM, select Settings → Configurations → Tenant Management

  17.5.3. Investigate child tenant data

  17.5.4. Create and allocate configurations

##### Note

* You can configure Profiles only as Managed or Unmanaged. All profiles you create are automatically cloned to your child tenants.

  17.5.5. Create a security managed action

##### Note

* Profiles you create are automatically cloned to your child tenants.

  17.6. About managed threat hunting

  17.6.1. Set up Managed Threat Hunting

##### Navigation

  Settings → Configurations → Managed Services

  17.6.2. Investigate Managed Threat Hunting reports

##### Note

* The MTH page is available for users with the Managed Threat Hunting license and have the necessary permission to view and triage alerts and incidents in Cortex XSIAM.

18. Reference

  18.1. Cloud service provider permissions

  18.2. Microsoft Windows security auditing setup

  18.2.1. Enable security auditing event IDs

##### Note

* We recommend you configure security auditing using Group Policy Object (GPO). Using GPO simplifies audit management and ensures that auditing settings are uniformly applied across your network, reducing the risk of misconfigurations on individual machines.

  18.2.1.1. Enable security auditing event IDs with GPO

##### Note

* We recommend that you configure the Group Policy Object (GPO) to apply to all endpoints and not just Domain Controllers. This ensures comprehensive auditing across your entire network.

##### Navigation

  Server Manager → Tools → Group Policy Management

  Computer Configuration → Policies → Windows Settings → Security Settings → Advanced Audit Policy Configuration → Audit Policies

  18.2.1.2. Set up local machine security auditing without GPO

  18.2.1.3. Additional setup for Active Directory Certificate Services (ADCS) events

##### Note

* Enabling auditing for Active Directory Certificate Services (ADCS) restarts (events 4880 and 4881) can significantly slow down the service if you have a large database. To prevent delays: Clean up the database: Remove any unnecessary entries to reduce its size. Skip this audit: If restart speed is critical, consider not enabling auditing for ADCS...

  18.2.1.4. Enable auditing access to AD domain objects - 4662

##### Note

* The Descendant msDS-DelegatedManagedServiceAccount Objects configuration is relevant only for Windows Server 2025.

  18.2.2. Enable additional event logs using Event Viewer

##### Navigation

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → User Profile Service, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → CAPI2, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → DNS Client Events, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → DriverFrameworks-UserMode, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → PowerShell, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → Windows Defender, right click Operational and select Enable Log

  In Event viewer → Application and Services Logs → Microsoft → Windows → TerminalServices-ClientActiveXCore → Microsoft-Windows-TerminalServices-RDPClient, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → Windows Firewall With Advanced Security → Firewall, right click Operational and select Enable Log

  18.2.3. Enable LDAP server events logging (1644)

  18.2.3.1. Enable LDAP server events logging using RegEdit

  18.2.3.2. Enable LDAP server events logging using GPO

##### Navigation

  Computer Configuration → Preferences → Windows Settings → Registry

  18.2.3.3. Validate log collection for LDAP Server events

  18.3. XDM fields for mapping authentication events

##### Note

* For more information on the entire Cortex Data model (XDM) schema, see Cortex XSIAM Data Model Schema.

* Do not map a static string, list, or empty string. You must map this field from the raw log field that best represents the actual source IP used in the authentication attempt. In cases where multiple IP fields are available, such as client_ip, source_ip, and original_client_ip, choose the field that captures the IP address from which the user initially...

* Mapping should be done per event type. The same system could be an IDP in one event and an SP in another.

* For more information on the event outcome constants in the Cortex Data Model, see XDM_CONST.OUTCOME.

* Outcome is based on a conclusive event type reflecting the true end state of the authentication flow.Critical for effectiveness of detection rules. Incorrect derivation can lead to missed detections or false positives.

* These are the most common values, but other logon types also exist. For a complete list, see XDM_CONST.LOGON_TYPE.

* For more information, see XDM_CONST.USER_TYPE.

* For more information, see XDM_CONST.PRIVILEGE_LEVEL.

* For more information, see XDM_CONST.OS_FAMILY.

* While xdm.network.session_id aggregates multiple user actions within a broader session window. xdm.session.context.id is used to correlate events that belong to a single authentication request or transaction.

  18.4. Cortex Network Scanner OSS

  18.5. Fair Usage policy for Cortex XSIAM


## Cortex AgentiX Documentation


---

## 1. Learn about Cortex AgentiX

### 1.1. Get Started with Cortex AgentiX

### 1.2. Understand Cortex AgentiX licenses

#### Note

* **You can purchase additional compute units. *You can extend incident retention by purchasing an add-on. For more information, see Data retention policy. Intel feed quotas are based on the selected Fetches Indicators field in the integration instance settings, not the enabled status. Disabling an integration instance does not affect the intel feed...

### 1.3. Agentic AI in Cortex AgentiX

#### 1.3.1. Manage Cortex AgentiX agents

##### Note

* When users create custom agents, the agents have the same or fewer permissions as the user. For example, if a user has sufficient permissions to isolate an endpoint, the user's agent can also isolate an endpoint. All users have access to all system agents and all public agents, but plan execution is limited by the permissions of the individual user. A...

#### 1.3.2. Cortex AgentiX use cases

#### 1.3.3. Agentic Assistant security

### 1.4. Key components and concepts

#### Note

* Agents are bound by the same rules and robust permissions as a human user. In addition, you can mark actions that make real-world changes in production systems as sensitive, requiring a quick manual review and confirmation, ensuring peace of mind before critical system changes are made.

### 1.5. Data retention policy

### 1.6. Supported ciphers

### 1.7. Supported web browsers

#### Note

* Cortex AgentiX is optimized for best performance using the HTTPv2 protocol. If you are using a non-supported browser version or a network middleware that uses a protocol other than HTTPv2, you may experience slowness in loading and response times between the browser and the Cortex AgentiX service. Consult with your browser or middleware vendor to see...

## 2. Onboard Cortex AgentiX

### 2.1. Plan and prepare your deployment

### 2.2. Onboarding checklist

### 2.3. Activate Cortex AgentiX

#### Prerequisite

* The Cortex AgentiX activation email. A Customer Support Portal (CSP) account. You need to set up your CSP account. For more information, see How to Create Your CSP User Account. When you create a CSP account, you can set up two-factor authentication (2FA) to log into the CSP by using an Email, Okta Verify, or Google Authenticator (non-FedRAMP...

#### Note

* Activation can take about an hour and does not require you to remain on the activation page. Cortex AgentiX sends a notification to your email when the process is complete.

* If you want to change your tenant's name, the subdomain, or activate a development tenant (subject to license), on the right-hand side, click the ellipsis. You can only change the subdomain once, and it cannot be undone. After deleting the subdomain, you can reuse it after 7 days.

#### 2.3.1. Cortex AgentiX supported regions

#### 2.3.2. Enable access to Palo Alto Networks resources

##### Note

* Some of the IP addresses required for access are registered in the United States. As a result, some GeoIP databases do not correctly pinpoint the location from which IP addresses are used. All customer data is stored in your deployment region, regardless of the IP address registration, and data transmission is restricted through any infrastructure to...

* <agentix-tenant> refers to the chosen subdomain of your Cortex AgentiX tenant, and <region> is the region in which your tenant is deployed. The port is 443.

### 2.4. Install and configure content

#### Note

* Cortex AgentiX includes AI system actions, used by system agents. Some system actions are available out-of-the-box with pre-installed content packs, such as Common Scripts and other system AI actions require you to download and install the relevant content pack. To find and install additional content packs that include actions, go to Marketplace and...

* Not all content packs are available to download on the Data Sources page. If you require content packs such as Phishing and Malware, you need to download the pack from Marketplace and configure the integration.

### 2.5. Post-deployment steps

#### 2.5.1. Post-deployment checklist

#### 2.5.2. Set up users and roles

#### 2.5.3. Configure server settings

##### Note

* Keyboard shortcuts, timezone, and timestamp format are not set universally and only apply to the user who sets them.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Requires the TIM add-on.

##### Navigation

  Settings → Configurations → General → Server Settings

#### 2.5.4. Configure security settings

#### 2.5.5. Set up an engine

##### Navigation

  Settings → Configurations → Data Broker → Engines → Create New Engine

#### 2.5.6. Log forwarding

##### 2.5.6.1. Forward logs and data from Cortex AgentiX to external services

###### 2.5.6.1.1. Configure external applications for forwarding

####### Note

* No prior configuration is required to send data or logs to an email distribution list. Only cases and issues can be forwarded to Slack, Amazon S3, Amazon SQS, Splunk, and Webhook. To forward data to Amazon SQS, the following permissions are required: sqs:GetQueueAttributes, sqs:ListQueues, sqs:SendMessage, sqs:SendMessageBatch, tag:GetResources, and...

* Only a user with Account Admin or Instance Admin permissions can configure egress. For more information, see Egress configurations.Egress configurations

* For Amazon SQS or Amazon S3, you need to provide the queue/bucket name. For Webhook or Splunk, you need to provide the domain, including any subdomain.

* You can also configure external applications when you create a new forwarding configuration. After defining the configuration and setting the scope, you can Add Application and follow the instructions below for any of these destinations.

* If egress has not been configured in the Cortex Gateway, verification will fail and a message will display that the endpoint does not match any approved routes.

####### 2.5.6.1.1.1. Integrate a syslog receiver

######## Note

* Up to TLS 1.3 is supported. Verify the self-signed CA includes your public key.

####### 2.5.6.1.1.2. Integrate Slack for outbound notifications

######## Note

* You are directed to the Slack browser to install Cortex AgentiX. You can only use this link to install Cortex AgentiX on Slack. Attempting to install from Slack Marketplace will redirect you to Cortex AgentiX documentation.

###### 2.5.6.1.2. Configure notification forwarding

####### Prerequisite

* Before you can select an external service for notification forwarding, you must integrate the external service with Cortex AgentiX. For more information, see Configure external applications for forwarding. No prior configuration is required to send data to an email distribution list.

####### Note

* Forwarding destinations: Only issues and cases can be forwarded to Slack, Splunk, Amazon SQS, Amazon S3, or Webhook. Notification forwarding by domain: To configure notification forwarding for issues by domain, select Issues and filter the Issues table by Issue Domain. Case IDs in notifications: If case matching completes before the notification is...

* Not all data and log types can be sent to all external services. For more information, see Forward logs and data from Cortex AgentiX to external services.

* The Grouping Timeframe defines the time frame, in minutes, of how often Cortex AgentiX sends notifications. Every 20 issues or 20 events aggregated within this time frame are sent together in one notification, sorted according to severity. To send a notification when one issue or event is generated, set the time frame to 0.

###### 2.5.6.1.3. Monitor administrative activity

##### 2.5.6.2. Data and log notification formats

###### Note

* Issues can be forwarded to email, syslog servers, and Slack in the alert format, if you prefer. The alert format can be selected when you configure your forwarding notification.

###### 2.5.6.2.1. Issue notification format

###### 2.5.6.2.2. Management Audit log notification format

## 3. Cortex AgentiX Configuration

### 3.1. Configure Cortex AgentiX

### 3.2. Content configuration

#### 3.2.1. Configure content using Data Sources

##### 3.2.1.1. Manage instances

##### 3.2.1.2. Add a new data source or instance

###### Note

* If a data source contains multiple integrations, the integration configured as the default integration will used by the Data Onboarder. The default integration of the content pack is indicated in each content pack's documentation. The other integrations are available for configuration in the Data Sources & Integrations page after installing the content...

* If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant page in the system, for example Correlations, Playbooks, or Scripts. If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant...

##### 3.2.1.3. Configure integration permissions

###### Navigation

  Settings → Configurations → Data Collection → Integration Permissions

#### 3.2.2. Marketplace

##### 3.2.2.1. Cortex Marketplace

###### Navigation

  Settings → Configurations → Marketplace) or at Cortex Developer Docs Marketplace

##### 3.2.2.2. Content packs

###### Note

* Cortex AgentiX includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

###### Navigation

  Settings → Configurations → Marketplace) or at Cortex Developer Docs Marketplace

##### 3.2.2.3. Content Pack Support Types

###### Note

* Palo Alto Networks is not liable for and does not warrant or support any content pack produced by a third-party publisher. Palo Alto Networks does not support content packs that do not have official available documentation.

##### 3.2.2.4. Cortex AgentiX content

##### 3.2.2.5. Manage content packs

###### Note

* Optional content packs that are already installed are treated like they are required content packs to preserve content integrity.

* Cortex AgentiX includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

* In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as scripts or integrations.

* Third-party product integrations are developed and tested against a specific product version. For products that are on-prem or cloud-based with specific API versions, the version developed and tested against will be included in the integration's documentation. Newer versions of the product are not always immediately tested, and it is expected that...

###### Caution

* If you want to downgrade, any content that depends on the content pack including any customizations may be deleted if it does not exist in the target content pack version.

* If another content pack is dependent on the content pack you want to delete, it may break the other content pack. You can reinstall the content pack, but you cannot restore detached and customized content.

###### Tip

* You can also find content packs that require updates by going to Settings → Data Sources & Integrations and filtering by Pack Version = Update Available. If you click on an integration in the filtered list, there is a link to the content pack in Marketplace for updates.

##### 3.2.2.6. Marketplace FAQs

##### 3.2.2.7. Content changes when upgrading Cortex AgentiX versions

##### 3.2.2.8. Content pack contributions

#### 3.2.3. Integrations

##### Note

* Some integrations can be downloaded directly without having to initially download a content pack from Marketplace. For more information, see Configure content using Data Sources. In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content...

* If the integration was installed from a content pack, you need to duplicate the integration before editing.

* If the integration was installed from a content pack, you need to duplicate the integration before downloading.

* Integration commands are only available when the integration instance is enabled. Some commands depend on a successful connection between Cortex AgentiX and third-party integrations.

##### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

##### Navigation

  Settings → Configurations → Marketplace

##### 3.2.3.1. Manage API keys

###### Note

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex AgentiX are...

* You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

##### 3.2.3.2. Integration use cases

##### 3.2.3.3. Add an integration instance

###### Note

* This procedure describes how to add an integration instance from the Data Sources & Integration page. Some integration instances can also be configured on the Data Sources page. For more information, see Add a new data source or instance.

* In some integrations, a classifier, an issue type, and mapper fields are included.

##### 3.2.3.4. Fetch issues from an integration instance

###### Note

* In some integrations, the Issue Fetch interval is called Feed Fetch Interval. If the integration instance does not have the Issue Fetch Interval field, you need to add this field by editing the integration settings. If the integration is from a content pack, you need to create a copy of the integration. Any future updates to this integration will not...

* Some content packs include preconfigured correlation rules, but you should review them to see if they suit your use case and duplicate them if required. Go to Threat Management → Detection Rules → Correlations, search for the relevant rule, right-click, and select Preview Rule. For example, the ServiceNow v2 Alerts (automatically generated)...

###### 3.2.3.4.1. Map fields to issue types

####### Note

* In the Classification & Mapping page, the mapping does not indicate for which issue types they are configured. Therefore, when creating a mapper, it is best practice to add to the mapper name, the issue types the mapper is for. For example, Mail Listener - Phishing.

* When mapping a list, we recommend you map to a multi select field. Short text fields do not support lists. If you do need to map a list to a short text field, add a transformer in the relevant playbook task, to split the data back into a list.

####### Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

###### 3.2.3.4.2. Classify events using a classifier for issue types

####### Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

##### 3.2.3.5. Forward Requests to Long-Running Integrations

###### Note

* This integration replaces the External Dynamic list integration, which is deprecated. For more information about how to set up the integration, see Manage external dynamic lists.

* When running on the tenant, you can only use long-running integrations provided by Cortex AgentiX, you cannot create custom ones. Custom long-running integrations are supported only on engines at this time. Configuring custom certificates or private API Keys in the long-running integration instance is supported only on engines, not on the Cortex...

* For the TAXII Server and TAXII2 Server integrations, the xdr string is automatically replaced by crtx. For the Microsoft Teams integration, you can use the microsoft-teams-create-messaging-endpoint command to get the correct messaging endpoint based on the server URL, the server version, and the instance configurations. For more information, see...

##### 3.2.3.6. Manage credentials

###### Navigation

  Settings → Configurations → Integrations → Credentials → New Credential

#### 3.2.4. Troubleshoot Integrations

#### 3.2.5. Measuring data freshness

##### Note

* The max_delay metric is taken from the maximum bucket value with a restricted limit; therefore, metrics show whole numbers. The median and ninetieth_percentile metrics are statistical calculations that give an approximation of the real value; therefore, metrics show decimal numbers. Time slots with a zero log count or zero byte count display records...

#### 3.2.6. Overview of data ingestion metrics

##### Prerequisite

* For Cortex AgentiX to monitor data ingestion health and create health issues, you must enable Cortex - Analytics. Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics.Enable the Analytics Engine and Identity Analytics

#### 3.2.7. Verify collector connectivity

##### Note

* If an issue is triggered, the investigation options in the right-click menu of the Health Issues pages are context-specific. Make sure that you specify the relevant issue category.

#### 3.2.8. Creating correlation rules to monitor data ingestion health

### 3.3. Configure the Cortex Agentic Assistant

#### 3.3.1. Agentic Assistant components and concepts

##### Note

* Agents are bound by the same rules and robust permissions as a human user. In addition, you can mark actions that make real-world changes in production systems as sensitive, requiring a quick manual review and confirmation, ensuring peace of mind before critical system changes are made.

#### 3.3.2. Agents Hub

##### Note

* To manage agents in the Agents Hub, you must have the proper permissions. For more information, see Agentic Assistant role-based access control.

##### 3.3.2.1. Manage actions

###### Note

* To manage actions in the Agents Hub, you must have the correct permissions. For more information, see Agentic Assistant role-based access control.

##### 3.3.2.2. Register actions

###### Note

* To register actions, ensure you have the correct permissions. For more information, see Agentic Assistant role-based access control.

* Mandatory arguments cannot be deselected.

###### Important

* A single content item can be registered as different actions, with each action using different inputs and outputs from the same script. Only register the same script, command, or AI prompt as a new action if it is required for your use case, as providing an agent with many actions with overlapping abilities can reduce the ability of the agent to choose...

##### 3.3.2.3. Manage agents

###### Note

* In some cases, an agent may include actions with content items that are not relevant for all licenses. If that occurs, the grey circle appears, but you are not able to install the related content.

##### 3.3.2.4. Build agents

###### Note

* To build agents in the Agents Hub, you must have view/edit permissions. For more information, see Agentic Assistant role-based access control.

* If you clear the checkbox for a role, all actions associated with that role are also cleared. The exception is if another role is also selected, which is associated with the same actions. If you clear the checkbox for an action, all roles associated with that action are cleared. For example, if you select the Investigator role, and Send Mail and Tavily...

##### 3.3.2.5. Expand agent capabilities with MCP integrations

###### Note

* If you are using OAuth-based authentication, the Test button returns an error containing the command to run in the playground in order to test the connection.

* If an MCP tool is removed from the MCP server, the action will be unavailable due to missing content. If the tool is restored on the MCP server, the action is automatically reenabled. If you have a development and a production tenant, you can push actions created from MCP tools from development to production.

###### Navigation

  Settings → Configurations → Data Collection → Integration Permissions

#### 3.3.3. Agentic Assistant role-based access control

### 3.4. Cortex MCP server

#### 3.4.1. Cortex MCP server overview

##### Note

* This feature is in Beta.

* The Cortex MCP Server empowers you to integrate AI into your security workflows using natural language. When using LLM-based suggestions, always review and approve actions suggested by the AI before they're executed. We recommend deploying the Cortex MCP server in a secure environment where access is limited to authorized users.

##### 3.4.1.1. Install the Cortex MCP server

###### Prerequisite

* If you are running the Cortex MCP server in a Poetry virtual environment, you must have Python 3.13 or higher. If you plan to run the Cortex MCP server in a Docker container, you must have Docker installed.

###### Note

* The MCP Server uses public APIs to communicate and is limited by the license quotas available in your tenant. This is particularly relevant when running XQL queries. For more information on running XQL query APIs, see Run XQL query APIs.

* It is critical to avoid assigning excessive permissions when creating an API key for the Cortex MCP Server. Since the key has both read and write capabilities, overly broad permissions can lead to unintended actions and potentially compromise your environment. Ensure the key follows the principle of least privilege and is granted only the minimum...

* When using Docker, we recommend using an .env file to set the Cortex API credentials as environment variables. While the credentials can be provided in the MCP client configuration settings, the .env file provides safer handling of API credentials and makes your configuration easily reproducible.

* By default, stdio (standard input/output) is used. You can also configure Streamable HTTP, to send requests directly to the tenant instead of through the MCP client. Streamable HTTP can be useful for testing in the browser without a MCP client and to bypass limits that may be in place for your MCP client. For Docker, you can include the Streamable HTTP...

###### Important

* To configure the Cortex MCP Server, you need the Cortex API URL, Cortex API key, and Cortex API key ID. You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

##### 3.4.1.2. Configure the MCP client

###### Navigation

  Settings → Developer → Edit Config

##### 3.4.1.3. Use the Cortex MCP server

###### Note

* The built-in tools retrieve information, but do not write to the tenant. You can create your own tools that include write actions. The examples below include both.

##### 3.4.1.4. Create custom Cortex MCP server tools

###### Note

* Any new or updated components provided by Cortex are automatically downloaded into the remote_components folder.  During each update, the folder is fully replaced and all existing contents are recreated. Do not add custom tools to this directory, as it is managed entirely by Cortex and is overwritten at every update.

### 3.5. Users and Roles Management

#### 3.5.1. Users and roles in Cortex AgentiX

##### Note

* You can only set dataset access permission for a user role in the tenant. These settings are disabled in Cortex Gateway

#### 3.5.2. Roles management

##### Note

* The user who activated the Cortex product is assigned the Account Admin role. Only users with the Account Admin role can add or remove another Account Admin user role.

* By default, users do not have roles assigned. If no direct or user group role has been assigned, users don't have permission to view or edit data in the Cortex tenant.

##### 3.5.2.1. Role-based permissions in Cortex AgentiX

###### Note

* You can only create, edit, copy, or delete a role if you have administrator (Instance/Account Admin) permissions. You cannot change the permissions of predefined roles, such as Instance Administrator.

* Users can't edit a predefined dashboard, but they can create a new one based on a dashboard template. Custom dashboards can only be viewed and edited by the dashboard creator.

* Users can't edit the Data Ingestion dashboard.

* If SBAC is set to Restrictive mode, users who don't have all the tags shouldn't be able to read or edit the parent case (fields or context). For more information on setting restrictive mode, see Configure server settings. However, if users are assigned all the tags on the child issue and have View/Edit permissions on Cases and Issues, users can trigger...

* Editing Correlation Rules requires View/Edit permissions for both the Query Center and Rules in the Threat Management section (under Detections (see below).

* You can also add, change, and remove roles from a playbook by clicking the settings wheel on the Playbook Starts task and adding a role in the General tab.

* You can't edit out-of-the-box scripts, but you can create a new one based on the script.

* Editing Correlation Rules requires View/Edit permissions for Query Center (see above) and Rules.

* If you select None, the user role can still use the API, but they cannot view API keys in the UI.

###### Navigation

  In the Cortex AgentiX tenant, you can set permission levels for each role by going to Settings → Configurations → Access Management → Roles and then editing or creating a new role

##### 3.5.2.2. Manage roles in the Cortex AgentiX tenant

###### Tip

* For analysts, we recommend limiting specific permissions, such as: Removing the ability to install, delete, Marketplace/Data Sources, which should be reserved for engineers and administrators. We recommend setting these permissions for analysts to None or View. Removing access to API keys. Under CONFIGURATIONS , set the Public API access to None or...

* We recommend making a copy of out-of-the-box roles and editing the copies, rather than creating new roles, to avoid missing any important permissions.

#### 3.5.3. User group management

##### Note

* You can create user groups in the tenant or Cortex Gateway. User groups created in Cortex Gateway cannot be mapped to SAML groups. Only user groups created in the tenant support SAML group mapping and scoring. We recommend creating user groups in the Cortex tenant because: User groups are available for all tenants, and you may want different user...

* If users have been created in the CSP, but you want them to access the tenant through SSO only, skip this field and add only SAML group mapping after SSO is set up, otherwise, users can access the tenant through both the CSP and SSO. If you have not yet created any users, skip this field and add them later. See Set up authentication .

* When using Azure AD for SSO, the SAML group mapping needs to be provided using the group object ID (GUID) and not the group name.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

##### Important

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex AgentiX are...

#### 3.5.4. User management

##### Note

* If a user does not have a direct role or user group assigned, the user is revoked and is not saved in the Cortex Gateway.

##### 3.5.4.1. Manage users in the Cortex AgentiX tenant

###### Note

* To remove users that were added to your CSP account, you need to do this in the CSP and not in the tenant or Cortex Gateway.

* To update the permissions attributable to each role, change them in the Roles tab or Cortex Gateway. If users have been created in the CSP, but you want them to access the tenant through SSO only, you should not assign a direct role. If you sign a direct role, users can access the tenant through both the CSP and SSO.

* You cannot deactivate a user who has an Account Admin role. If you want to deactivate users from all tenants, deactivate them in Cortex Gateway. The user will be deactivated in the tenant, but may still be active in other tenants. If you want to deactivate the tenant for multiple tenants, deactivate the user in Cortex Gateway.

* When you remove a role, the role associated with the API keys is deleted. If more than one role was associated with the API key, a yellow warning symbol appears next to the API key in the API key table. When you hover over the symbol, a message indicates that some of the roles associated with the API key have been deleted. If all roles associated with...

##### 3.5.4.2. Manage user scope

###### Prerequisite

* Configuring user scopes in Cortex AgentiX Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.Set up users and roles By default, Enable Scope...

###### Note

* This configuration can impact the visibility of the related Security domain in the Cases and Issues scope area, but with not affect asset visibility.

* XQL-based dashboard widgets may require a few hours to initially reflect changes to the list or definitions of asset groups used for scoping. To view the most current data immediately, refresh the dashboard or its XQL widgets.

* For Cases and Issues domains, a workaround is to create a Dataset View for each required combination of domains, and allow the relevant entity access only to this Dataset View, not to the underlying cases and issues datasets.

* Make sure to assign the required default granular scoping for users. This depends on the structure and divisions within your organization and the particular purpose of each organizational unit to which scoped users belong.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Some areas and features in Cortex AgentiX do not respect SBAC. In these cases, use RBAC permissions to restrict access.

* Action Required: Recent security enhancements enforce stricter default permissions for cases and issues that lack specific asset or endpoint references. This notice explains how to include access to these items if your users' visibility has been impacted.

* Before configuring, ensure that you review the Understand scoping section.

#### 3.5.5. Manage access to objects

##### 3.5.5.1. Manage access to custom dashboards

###### Prerequisite

* Configure tenant-level settings: An administrator must first establish the sharing framework under Settings → Configurations → Access Management → Objects. The configuration of these settings defines the authorized sharing workflows for custom dashboards:    Enable "Owners can Share objects they created": Grants owners the ability to share...

###### Note

* If you're designated as an Editor, you can always duplicate the widget and make your changes on the copy.

* Only Account Administrators and Instance Administrators have the authority to change the owner of an object.

##### 3.5.5.2. Manage access to saved queries

###### Prerequisite

* Configure tenant-level settings: An administrator must first establish the sharing framework under Settings → Configurations → Access Management → Objects. The configuration of these settings defines the authorized sharing workflows for saved queries in the Query Library, including the options that appear to users when clicking the three dot,...

###### Note

* If the role of a user is set to Edit Public Queries but not Create Queries, they can update existing public queries, but the Save as drop-down menu will be hidden, preventing them from creating new Query Library entries.

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

#### 3.5.6. Set up authentication

##### Tip

* You should have at least one user in the Customer Support Portal for backup, in case of any authentication issues with your IdP provider.

##### 3.5.6.1. Authenticate users through the Customer Support Portal

###### Note

* You must be assigned the Super User role in the Customer Support Portal to add users in the Customer Support Portal. The first Super User who logs into Cortex Gateway is automatically assigned the Account Admin role and has access to the tenant. The user who activates the Cortex AgentiX tenant will also be assigned the Account Admin role (if there is...

* After users are added to the Customer Support Portal and they accept the invitation, you can manage them in Cortex Gateway or the Cortex AgentiX tenant.

##### 3.5.6.2. Authenticate users using SSO

###### Note

* To set up SSO authentication in the tenant, you must be assigned an Instance Administrator or Account Admin role. SAML 2.0 users must log in to Cortex AgentiX using the FQDN (full URL) of the tenant. To allow login directly from the IdP to , you must set the relay state on the IdP to the FQDN of the tenant. If you have multiple tenants, you must set up...

* The first SSO cannot be deleted, it can only be deactivated by toggling SSO Enabled to off. The Domain parameter is predefined for the first SSO. If you add additional SSO providers, you must provide the email Domain in the SSO Integration settings for all providers except the first. Cortex AgentiX uses this domain to determine to which identity...

* Cortex AgentiX requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex AgentiX. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a...

##### 3.5.6.3. Set up Okta as the Identity Provider Using SAML 2.0

###### Note

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

##### 3.5.6.4. Set up Azure AD as the Identity Provider Using SAML 2.0

###### Note

* The default attributes shown on the main single sign-on page in Azure AD are not the values you need. You must click Edit next to Attributes and Claims to view and copy the actual values.

* The attribute claim name must exactly match the value sent by your IdP. In some cases, this may be the full attribute name/namespace, depending on the configuration of our IdP

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Important

* When copying the Single Sign-On URL value, remove idp/saml and leave the trailing /. For example, if the Single Sign-On URL is https://clientname.panproduct.region.paloaltonetworks.com/idp/saml, just copy https://clientname.panproduct.region.paloaltonetworks.com/.

### 3.6. Engines

#### 3.6.1. What is an engine?

##### Note

* You cannot share a multiple-engine installation with a single-engine installation.

* When you add an engine to a load-balancing group, you cannot use that engine separately. The engine does not appear in the engines menu when configuring an integration instance, but you can choose the load-balancing group.

#### 3.6.2. Engine requirements

##### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

* If you have configured a range of Approved IP Ranges under Allowed Sessions on the Security Settings page, the engine must communicate through one of the approved IPs.

#### 3.6.3. Install an engine

##### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex AgentiX engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

##### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

##### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

##### 3.6.3.1. Docker

###### Note

* This section is relevant when installing an engine.

* Docker images can be downloaded together with their relevant content packs for offline installation.

###### 3.6.3.1.1. Install Docker

####### Note

* For Red Hat's Docker distribution, you need Mirantis Container Runtime (formerly Docker Engine - Enterprise) to run specific Docker-dependent integrations and scripts. For more information, see Install Docker distribution for Red Hat on an engine server. To use the Mirantis Container Runtime (formerly Docker Engine - Enterprise) follow the deployment...

####### 3.6.3.1.1.1. Install Docker distribution for Red Hat on an engine server

######## Note

* If running RHEL v8 or higher, the engine installs Podman packages and configures the operating system to enable Podman in rootless mode.

####### 3.6.3.1.1.2. Docker image security

####### 3.6.3.1.1.3. Docker FAQs

####### 3.6.3.1.1.4. Troubleshoot Docker issues

####### 3.6.3.1.1.5. Configure Docker pull rate limit

####### 3.6.3.1.1.6. Change the Docker installation folder

###### 3.6.3.1.2. Docker hardening guide

####### Note

* The settings below can also be applied to Podman, with the exception of limiting available memory, limiting available CPU, and limiting PIDS.

* If you do not want to apply Docker memory limitations, you should explicitly set the advanced parameter: limit.docker.memory to false.

####### Tip

* We recommend reviewing Docker network hardening below before changing any parameters in the configuration file. To securely run Docker containers, we recommend using the latest Docker version.

##### 3.6.3.2. Podman

###### Note

* When upgrading an engine, the engine keeps the previously used container management type (regardless of distribution version).

###### 3.6.3.2.1. Change the container storage directory

####### Note

* Alternatively, the runroot setting may be set to some temporary directory that is accessible by the user demisto. If you choose to set the runroot, it must be a directory that is mounted as tmpfs (temporary filesystem), unlike the graphroot.

####### Warning

* Do not use NAS storage or a temporary (tmpfs) directory for the graphroot setting. The graphroot needs to be a local, non-temporary directory for Podman to work. For more information, see https://en.wikipedia.org/wiki/Network-attached_storage.

####### Tip

* We recommend reserving 150 GB for container storage, either in the /home partition or a different storage directory that you have set using the graphroot key.

###### 3.6.3.2.2. Install Podman

####### Note

* This procedure is intended for RHEL 8 or later. It may not work for other operating system types. Do not use NAS storage for the $HOME directory. The directory needs to be a local directory for Podman to work.

* If you edit the file with the root user, make sure to set the demisto user as file owner by running chown demisto:demisto /home/demisto/.config/containers/registries.conf

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

###### 3.6.3.2.3. Migrate From Docker to Podman

###### 3.6.3.2.4. Troubleshoot Podman

####### Note

* This step removes all Podman images, including any custom images you may have created.

* $(id -u demisto) is used to get the demisto user ID, which is part of the directory name. For example, /tmp/podman-run-993 Not all the directories above may be present.

* When you run podman container cleanup --rm -a, you might see a message such as running or paused containers cannot be moved without force. The message can be safely ignored, as it only pertains to current running containers, which are not removed.

* To change to the demisto OS user, run the following command: sudo su - -s /bin/bash demisto

* You must switch to user demisto before running the "system migrate" (running it as root will have no effect).

* The "system migrate" must be done by the user demisto.

####### Important

* The runroot must be located under the tmpfs file system type. This is required to clean Podman's run state on reboot and for performance reasons.

####### Caution

* Unlike the runroot, the graphroot must NOT be located under the tmpfs file system type. Using tmpfs for the graphroot might corrupt container images, causing command executions to fail. It also degrades performance by forcing Podman to needlessly re-pull images.

#### 3.6.4. Manage engines

##### Navigation

  You can manage your engines and load-balancing groups by going to Settings → Configurations → Engines

#### 3.6.5. Upgrade an engine

#### 3.6.6. Remove an engine

#### 3.6.7. Configure engines

##### Note

* A day is defined as 24 hours and may not exactly correspond to calendar days due to daylight savings, leap seconds, etc.

* In addition, to support engine upgrades from the UI, edit the /usr/local/demisto/upgrade.conf file on the engine to include the SERVER_URLS setting with the new tenant's address. Include only the host, without https:// or any additional path at the end of the host name. For example: SERVER_URLS="api-example.us.paloaltonetworks.com"

* If the engine loses communication for longer than this time, it will disconnect and you need to restart the service.

##### 3.6.7.1. Configure the engine to use a web proxy

###### Note

* You need to configure Docker to use a proxy. When using a BlueCoat proxy, ensure you encode the values correctly.

* In an environment with a single engine, go to /usr/local/demisto/upgrade.conf. In an environment with multiple engines, go to /usr/local/demisto/<engine-name>/upgrade.conf, replacing <engine-name> with the name of the engine. Note that the key is in the upgrade.conf file and must be https_proxy, even if your proxy address starts with http://.

##### 3.6.7.2. Configure the engine to call the server without using a proxy

###### 3.6.7.2.1. Use NGINX as a reverse proxy

####### Note

* For multi-tenant deployments, replace location ~ ^/(websocket|d1ws|d2ws) { with location ~ ^/(acc_\S+/)?(websocket|d1ws|d2ws)

##### 3.6.7.3. Configure an engine to use custom certificates

#### 3.6.8. Use an engine in an integration

##### Note

* Long-running integrations should not run on load-balancing groups.

#### 3.6.9. Run a script using an engine

##### Navigation

  Investigation & Response → Automation → Scripts

#### 3.6.10. Troubleshoot engines

##### Note

* Ensure that pop-ups are not blocked by your browser.

* If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom path. --keep - Extracts the installer files into the current working directory (without cleaning at the end). If using installer...

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl status d1_<Engine _name>

* Any changes made to variables in the upgrade_engine.sh file are reset after each upgrade. We recommend instead using the upgrade.conf file to set variables.

* You can ignore the following error: Cannot create folder '/var/lib/demisto'

##### Navigation

  When troubleshooting engines, access the logs from Settings → Configurations → Engines and select the engine from which you want to download the logs

#### 3.6.11. Troubleshoot integrations running on engines

##### Note

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

* Docker CE installations typically run Docker, while Docker EE installations typically run dockerroot.

### 3.7. Cases and issues configuration

#### 3.7.1. Case and issue lifecycle

#### 3.7.2. Customize your cases

##### 3.7.2.1. External integrations

##### 3.7.2.2. Create a case domain

###### Note

* Adding custom domains requires a View/Edit RBAC permission for Case Properties (under Object Setup). Once created, a custom case domain cannot be deleted or renamed.

###### Warning

* Before you add a custom domain, please review the built-in options. For more information, see Case and issue domains. We recommend using the built-in domains where possible. Custom domains might not be supported by all content. In addition, custom domains affect Cortex AgentiX's ability to learn, correctly identify, and score future cases. Smart...

###### Navigation

  You can see all domains under Configurations → Object Setup → Cases → Domains

  Settings → Configurations → Object Setup → Cases → Domains

  Settings → Configurations → Access Management → User Groups

  Settings → Configurations → Access Management → Users

  To enable access to the domain for an API key, got to Settings → Configurations → Integrations → API Keys

##### 3.7.2.3. Create a starring configuration

###### Tip

* Right-click an issue field to add it as match criteria.

##### 3.7.2.4. Create custom case statuses and resolution reasons

###### Note

* Before you create a custom status, please review the built-in options. For more information, see Resolution reasons for cases and issues. We recommend using the built-in statuses and resolution reasons where possible. Custom statuses and resolution reasons might not be supported by all content, and status syncing can take time. In addition, custom...

* After creation, custom statuses and resolution reasons cannot be deleted or modified.

###### Navigation

  Configurations → Object Setup → Cases → Properties

#### 3.7.3. Customize issue fields and layouts

##### 3.7.3.1. Issue fields

###### Warning

* Deleting an issue field or uninstalling a content pack containing an issue field may affect detection and other capabilities based on the deleted field. For example, correlation, layouts, case scoring, starring rules, and playbook triggers.

###### 3.7.3.1.1. Issue field types

####### Note

* You cannot set filters, starring rules, automation rules, layout rules, or issue exclusions based on the values in custom timestamp fields.

* When grid field is shown in the Issues table, if there are values in the field, they do not display in the table. Instead, the column shows Data Available.

* When an HTML field is shown in the Issues table, if there is a value in the field, it does not display in the Issues table. Instead, the column shows Data Available. The following HTML tags are not permitted: blockquote, del, dd, div, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, iframe, ins, li, math, noscript, ol, pre, p, script, style, table,...

* When a Markdown field is shown in the Issues table, if there is a value in the field, it does not display in the table. Instead, the column shows Data Available.

###### 3.7.3.1.2. Create custom issue fields

####### Navigation

  Settings → Configurations → Object Setup → Issues → Fields → New Field

####### 3.7.3.1.2.1. Create a grid field for an issue

######## Navigation

  Settings → Configurations → Object Setup → Issues → Fields → New Field

####### 3.7.3.1.2.2. Issue field triggered scripts

######## Note

* Fields that can hold a list, such as multi-select custom fields, return the delta in an array as a new argument. For example, if a multi-select field value has changed from ["a"] to ["a", "b"], the new argument of the script gets a value of ["b"].

* Issue field-triggered scripts must have the field-change-triggered tag to appear in the list. Issue field trigger scripts are not supported for all system fields. The following fields are not supported for issue field trigger scripts and may result in failing to populate the issue layout: Cases: Case ID, Cases IDs Asset Fields: Asset IDs, Asset Names,...

* When creating the script, add the field-change-triggered tag in the script settings.

* Verify that User can add rows is selected.

######## Caution

* This feature assumes fair and intended usage of field-triggered scripts. In cases of excessive or abusive usage, execution may be restricted or disabled. If script execution is restricted or disabled, fields are still updated, but without the results of the assigned script.

####### 3.7.3.1.2.3. Issue timer fields

######## Navigation

  Settings → Configurations → General → Server Settings → Issues and Enable Timer Field

######## 3.7.3.1.2.3.1. Configure issue timer fields

######## 3.7.3.1.2.3.2. Configure a playbook to run timers

######## 3.7.3.1.2.3.3. Automate changes to issue fields using timer scripts

######## 3.7.3.1.2.3.4. Use issue timer field commands manually in the CLI

##### 3.7.3.2. Issue layouts

###### 3.7.3.2.1. Create custom issue layouts

####### Note

* The script that runs when an action button is clicked accepts only mandatory arguments through the pop up window and does not provide an option for any non-mandatory arguments to be filled in when the button is clicked. We recommend using a wrapper script to collect and validate arguments in scenarios where there can be a combination of mandatory and...

####### Tip

* Limit the number of issue fields to 50 in each section. You can create additional sections as needed.

###### 3.7.3.2.2. Add a custom widget to an issue layout

####### Navigation

  Investigation & Response → Automation → Scripts and upload the following script: Expand script commonfields: id: ee3b9604-324b-4ab5-8164-15ddf6e428ab version: 49 name: IndicatorWidgetBar script: |- # Constants HIGH = 3 SUSPICIOUS = 2 LOW = 1 NONE = 0 indicators = [] scores = {HIGH: 0, SUSPICIOUS: 0, LOW: 0, NONE: 0} incident_id = demisto

  Investigation & Response → Automation → Scripts and upload the following script

  Settings → Configurations → Object Setup → Issues → Layouts

###### 3.7.3.2.3. Create rules for issue layouts

####### Navigation

  Settings → Configurations → Object Setup → Issues → Layout Rules → New Rule

#### 3.7.4. Customize case fields and layouts

##### 3.7.4.1. Case fields

###### Warning

* Deleting a case field or uninstalling a content pack containing a case field may affect capabilities based on the deleted field and layouts.

###### 3.7.4.1.1. Case field types

####### Note

* You cannot set filters, starring rules, automation rules, layout rules, or issue exclusions based on the values in custom timestamp fields.

* When grid field is shown in the Cases table, if there are values in the field, they do not display in the Cases table. Instead, the column shows Data Available.

* When an HTML field is shown in the Issues table, if there is a value in the field, it does not display in the Cases table. Instead, the column shows Data Available.

* When a Markdown field is shown in the Cases table, if there is a value in the field, it does not display in the Cases table. Instead, the column shows Data Available.

* If you make changes to case fields you can update the context data by running a playbook, script, or command. For more information, see Update case fields. To update dynamic custom case fields, such as SLA and Timer fields, see Update case timer and SLA fields.

###### 3.7.4.1.2. Create custom case fields

####### Navigation

  Settings → Configurations → Object Setup → Cases → Fields → New Field

####### 3.7.4.1.2.1. Create a grid field for a case

######## Navigation

  Settings → Configurations → Object Setup → Cases → Fields → New Field

####### 3.7.4.1.2.2. Update case fields

######## Note

* Ensure that you have the required RBAC permission to write scripts.

###### 3.7.4.1.3. Create case timers and SLAs

####### Prerequisite

* Before you can create a case SLA, you must first create a timer field. A timer field can be associated with a single case SLA.

####### Note

* If you edit this filter after creation, the timer and associated SLA will be removed from any case that no longer qualifies, even if the timer is already running.

####### Navigation

  Settings → Configurations → Object Setup → Cases and open the Fields tab

###### 3.7.4.1.4. Update case timer and SLA fields

##### 3.7.4.2. Case layouts

###### 3.7.4.2.1. Create custom case layouts

####### Note

* The script that runs when an action button is clicked accepts only mandatory arguments through the pop up window and does not provide an option for any non-mandatory arguments to be filled in when the button is clicked. We recommend using a wrapper script to collect and validate arguments in scenarios where there can be a combination of mandatory and...

####### Tip

* Limit the number of case fields to 50 in each section. You can create additional sections as needed.

###### 3.7.4.2.2. Create rules for case layouts

####### Note

* Layout rules support SBAC (scoped based access control). The following parameters are considered for editing access. If Scope-Based Access Control (SBAC) is enabled and Endpoint Scoping Mode is set to restrictive mode, you can edit a rule if you are scoped to all tags in the rule. If Scope-Based Access Control (SBAC) is enabled and Endpoint Scoping...

####### Navigation

  Settings → Configurations → Object Setup → Cases → Layout Rules → New Rule

#### 3.7.5. Issue syncing

##### Prerequisite

* You must set up an integration before you can sync issues. For more information, see Set up an integration for mirroring issues.

##### Note

* Multiple tickets can be linked to an issue with outbound syncing. Issues with inbound syncing can be linked to a single ticket only.

* Using issue fields as variables is not currently supported.

* You can only define a single inbound profile. If you change the inbound sync profile the current profile is overwritten. You can define multiple outbound profiles; one issue can update multiple tickets.

* The inbound syncing flow runs every two minutes, and the outbound syncing flow runs every five minutes. In a bi-directional set-up, if the same field is updated in both tickets, the most recently updated value is used. In the external ticket, the logged history shows updates to the ticket. The user name that is logged with the history reflects the user...

* After an issue is resolved, ticket syncing remains active for up-to seven days. Therefore, you still update, change, or reopen the issue or external ticket and the tickets will continue to sync.

* If you change the selected inbound sync profile, the original sync profile is immediately overwritten.

##### Warning

* If you leave this field blank, all configured instances will be used.

##### Tip

* You can find a sync profile ID under Settings → Configurations → Object Setup → Issues → Sync Profiles. By default the ID field is not displayed in the table. Click the three dot menu and add it to the table layout.

##### Navigation

  Settings → Configurations → Marketplace

##### 3.7.5.1. Create a sync profile

###### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

#### 3.7.6. What's a correlation rule?

##### Navigation

  After you configure your correlation rules, you can manage them in Threat Management → Detection Rules → Correlations, and view and analyze the generated issues in Cases and the Issues Table

##### 3.7.6.1. Correlation rule details

###### Note

* Only an administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex AgentiX .

* For more information on troubleshooting server errors in scheduled correlation rules, Troubleshoot server errors in scheduled correlation rules.Troubleshoot server errors in scheduled correlation rules

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

###### Navigation

  If you are assigned a role that enables Investigation → Rules privileges, you can manage all user-defined Correlation Rules from Threat Management → Detection Rules → Correlations

##### 3.7.6.2. Create a correlation rule

###### Prerequisite

* To enable pivots from issues to a third-party source system, ensure that you know the dataset field name that contains the URL of the source system. Some vendors already provide this URL as part of their API, and you can find it in the third-party product dataset. If there is no URL, you cannot enable this feature.

###### Note

* When creating a Real Time Correlation Rule, you can only generate an issue as the resulting action for the Correlation Rule. All other options are disabled. To ensure your Correlation rules generate issues efficiently and do not overcrowd your Issues table, Cortex AgentiX automatically disables Correlation rules that reach 5000 or more hits over a...

* When you open the New Correlation Rule editor from XQL Search, this XQL Search field is already populated with the XQL query that you defined. An administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex AgentiX . All other users can only create and view queries built with an existing dataset.

* The XQL features for call, top, and wildcards in datasets (dataset in (<dataset prefix>_*)) are currently not supported in Correlation Rules. If you add them to the XQL definition, you will not be able to Create or Save the Correlation Rule. The XQL features for transaction in datasets (dataset in (<dataset prefix>_*)) are currently not supported in...

* The incident that contains the issues will also be assigned to the selected domain. For more information, see Case and issue domains. If you want to generate a health issue, choose the Health domain. For more information about health issues, see About health issues.

* If a generated issue has severity Medium or above, a case is automatically opened. Low severity issues generated by correlation rules are not grouped into cases.

* There is no validation or auto complete for these parameters and the values can be null or empty. In these scenarios, Cortex AgentiX does not display the null or empty values, but adds the text NULL or EMPTY in the descriptions.

* When more than one XDM field is listed, Cortex AgentiX looks for the field value according to the order of the fields listed.

* When Use the Cortex AgentiX default incident enrichment is not selected and you have not mapped any issue fields, the issue is dispatched into a new incident.

###### Important

* The maximum size of a lookup dataset is 50 MB. If the data exceeds this limit, the add to lookup action fails.

###### Tip

* When creating your correlation rule, you can use predefined values for different fields in the editor, such as Alert Name, Alert Description, and Drill-Down Query. For more information, see Field replacement syntax in correlation rules.Field replacement syntax in correlation rules

###### Navigation

  You can create a new correlation rule from either the Threat Management → Detection Rules → Correlation Rules page or when building a query in XQL Search

##### 3.7.6.3. Manage correlation rules

###### Note

* Execute Rule is not available for real time correlation rules.

#### 3.7.7. Manage external dynamic lists

##### Note

* To configure an EDL, you must have a role that includes EDL permissions, such as Instance Admin or Account Admin. Configuring custom certificates or private API Keys in the EDL integration instance is supported only on engines, not on the Cortex AgentiX server. For EDL integrations on the server, you must set a username and password. For long-running...

* The legacy external dynamic list PAN-OS integration is deprecated. Configure the EDL integration on the Data Sources & Integrations page (by clicking the Automation & Feed Integration link.

* If the EDL integration runs on the Cortex AgentiX server, you do not need to enter a Listen Port in the instance settings. The system auto-selects an unused port for the EDL integration when the instance is saved. If you enter a value for Listen Port, it will be overwritten by the port auto-selected by the system

##### Important

* The EDL URL must always be prefixed by ext-.

### 3.8. Automations

#### 3.8.1. Automation in Cortex AgentiX

##### Note

* You can build end-to-end automation workflows from within the playbook editor, including creating automation rules, configuring integration instances, and creating and editing tasks. For more information, see Playbooks.

#### 3.8.2. Quick Actions

##### Note

* Quick Actions appear as War Room entries, but do not appear in the Work Plan.

#### 3.8.3. Automation Exclusion Center

##### Note

* By default, all users have read and edit permissions to lists. When creating a list of critical assets, we recommend limiting the read and edit permissions to specific roles.

##### 3.8.3.1. Manage automation exclusion policies

###### Note

* For the IAM User Hard Remediation and User Soft Remediation policies, we recommend including username, email, and ID for each user you want to exclude. Example: username1, user@example.com, userID112.

* You can also right click on a policy from the main Automation Exclusion Center page to disable or enable the policy. If you click on a list name in the Exclude column, that list opens in the Lists page.

#### 3.8.4. Playbooks

##### 3.8.4.1. Playbooks overview

##### 3.8.4.2. Playbook development checklist

##### 3.8.4.3. Plan your playbook

##### 3.8.4.4. Manage playbooks

###### Note

* The library by default shows only playbooks that are not adopted. Click the Show Adopted checkbox to show the adopted playbooks, indicated by an Adopted mark. The library shows the most updated playbook version. Adopting an older version than shown should be done through Marketplace. Adopting a playbook does not make it run. Some content packs include...

##### 3.8.4.5. Build your playbook

###### 3.8.4.5.1. Task 1. Choose from existing playbooks or create your own

####### Note

* When a task inside of a sub-playbook is not configured, the alert is propagated to the main playbook. If multiple sub-playbooks are nested, and any of the sub-playbooks have non-configured components, the alert appears in the main playbook as well as in the sub-playbooks. Alerts also appear for the individual non-configured tasks within the...

####### Tip

* If there are additional relevant playbooks in Marketplace that are not in your Org repository, you can click Explore them now to see them in the Playbook Catalog and choose to adopt.

* To open multiple playbooks at the same time, edit the first playbook and then click New next to the playbook name to create a new tab. You can either create a new playbook, or add an existing one. You can view recently modified or deleted playbooks by clicking version history for all playbooks .

####### Navigation

  the Investigation & Response → Automation → Playbooks page to find an existing playbook, customize it, or create a playbook

###### 3.8.4.5.2. Task 2. Configure playbook settings

####### Note

* If the playbook has inputs and outputs, the Playbook Starts task will show back and forth arrows. Clicking them opens the Playbook Settings pane Inputs/Outputs tab.

* This rule will trigger the playbook to run if no other Automation Rule triggers the playbook first. You can view and edit the order the rules run in the Automation Rules page.

* If you do not add any fields, the group will be deleted when you click Save.

###### 3.8.4.5.3. Task 3. Add objects from the Task Library

####### 3.8.4.5.3.1. Add Quick Actions, commands, and scripts

######## Note

* If the Quick Action requires an integration instance and it is not yet configured, you have the option to create an integration instance from within the playbook editor.

* If you want to add a script that is not yet adopted, Cortex AgentiX automatically installs the content pack containing the script. If the script requires an integration instance, you are prompted to configure one.

* The output value is dynamic and is derived from the context at the time that the task is processed. As a result, parallel tasks that are based on the same output may return inconsistent results.

######## Tip

* If your needs require a custom script, use the Agentic Assistant with the Automation Engineer agent to leverage the Cortex AgentiX built-in LLM to quickly and efficiently generate functional Python scripts from natural language prompts. For more information, see Create a script.

####### 3.8.4.5.3.2. Add sub-playbooks

######## Tip

* Balance between the number of iterations and the interval so you do not overload the server.

####### 3.8.4.5.3.3. Add AI prompt tasks

######## Note

* Selecting Local AI Prompt creates a local version of the task within your playbook. Any future updates made to the Prompts Library will not sync to this specific task. Choose Local AI Prompt if you need to customize the logic for a specific workflow and want to ensure its behavior remains unchanged, even if the Prompts Library is updated with...

####### 3.8.4.5.3.4. Add manual tasks and blank tasks

######## 3.8.4.5.3.4.1. Create a standard task

######## 3.8.4.5.3.4.2. Create a conditional task

######## 3.8.4.5.3.4.3. Create a communication task

####### 3.8.4.5.3.5. Create a section header

####### 3.8.4.5.3.6. Configure script error handling in a playbook

######## Note

* Use the GetErrorsFromEntry script (part of the Common Scripts Pack) to check whether the given entry returns an error and returns an error message. For example, when using the script in a playbook, you can fetch the error message from a given task, such as a runtime error. You can then add a step in the playbook flow to send those error messages to the...

* You can set up script error handling only when running a script in a Standard task or a Conditional task. For more information about error handling settings for these tasks, see Create a standard task or Create a conditional task. Built-in, Manual, and Ask Conditional tasks have On Error settings for number of retries and retry interval, but not Error...

###### 3.8.4.5.4. Task 4. Add custom playbook features

###### 3.8.4.5.5. Task 5. Test and debug the playbook

###### 3.8.4.5.6. Task 6. Manage playbook content

##### 3.8.4.6. Customize your playbook

###### 3.8.4.6.1. Configure a sub-playbook loop

####### Note

* Consider the following when adding a loop: The maximum number of loops (default is 100). A high number of loops or a high wait time combined with a large number of issues may affect performance. Periodically check looping conditions to ensure they are still valid for the data set. If you want a sub playbook task to loop over an array passed into its...

####### Tip

* Balance between the number of iterations and the interval so you do not overload the server.

###### 3.8.4.6.2. Filter and transform data

####### Caution

* You can change the context data root to filter, but it is not recommended to select a different root, as it affects the filter results. The drop-down list displays the filter root for backward compatibility.

####### Navigation

  Investigation & Response → Automation → Scripts → New Script

####### 3.8.4.6.2.1. Filter considerations, categories, and built-in filters

######## Note

* Is defined considers false and empty strings and lists to be defined values. If you don't want those to be included as defined, use Is not empty.

* Not defined considers false and empty strings and lists to be defined values. If you don't want those to be included as defined, use Is empty.

####### 3.8.4.6.2.2. Transformer considerations, categories, and built-in transformers

######## Note

* To make regex case non-sensitive, use the (?i) prefix (for example (?i)yourRegexText.

###### 3.8.4.6.3. Extract indicators

####### Note

* This configuration may delay playbook execution (issue creation). While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

###### 3.8.4.6.4. Extend context

###### 3.8.4.6.5. Update issue fields with playbook tasks

####### Note

* The setIssue script includes all available fields; use the scroll bar to see all the fields. The name field has a limit of 600 characters. If there are more than 600 characters, you can shorten the name field to under 600 characters and then include the full information in a long text field such as the description field. There are many fields already...

###### 3.8.4.6.6. Playbook polling

####### Note

* You need to use the GenericPolling playbook as a sub-playbook in a main playbook, such as Detonate File - JoeSecurity. The main playbook should follow this structure: Start Command: The task contains a command that fetches the initial state of the process and saves it to context. This command starts the process that should be polled. For...

##### 3.8.4.7. Test your playbook

###### Note

* The debugger does not support using parentIncidentFields.

* Using an existing issue in the debugger does not affect the original issue or change the original context data.

###### 3.8.4.7.1. Troubleshoot playbook performance

##### 3.8.4.8. Manage playbook content

###### Note

* Opening a playbook does not immediately lock it. A playbook is considered to be in edit mode only when a user makes a modification that causes the Save button to become available.

###### Important

* Manually unlocking a playbook may cause version conflicts. This turns off concurrent editing protection, and if the original user is still editing, their changes might be lost or overwritten.

###### Navigation

  Investigation & Response → Automations → Playbooks

##### 3.8.4.9. Best practices

###### Note

* If you reattach a detached playbook, any customizations you have made to the playbook will be overwritten when the playbook updates to the current version.

* Retries are not supported for data collection tasks that have errors sending emails (indicated by a server timeout). This is because retries only work on automation execution failures, not on email delivery issues.

#### 3.8.5. Create an automation rule

##### Note

* You can also define the conditions that trigger a specific playbook in the playbook editor. For more information, see Task 2. Configure playbook settings

* Quick Actions, by default, run using all available integration instances that contain the command. When selecting a Quick Action for an automation rule, you can instead choose one specific integration instance to use.

##### Important

* Rules are evaluated in order, and only the first rule that matches the trigger conditions is executed.

#### 3.8.6. AI Prompts

##### Navigation

  On the AI Prompts page (Investigation → Response → Automation → AI Prompts), you can view, edit, and manually create prompts

##### 3.8.6.1. AI prompts role-based access control

##### 3.8.6.2. Use existing prompts

###### Navigation

  Investigation & Response → Automation → AI Prompts and in the Prompts Library search for the prompt you want to use

##### 3.8.6.3. Create a prompt

###### Navigation

  Investigation & Response → Automation → AI Prompts and click + New Prompt

#### 3.8.7. Scripts

##### Prerequisite

* To provide scripts access, ensure the Scripts RBAC permission is set to View or View/Edit. To completely restrict scripts access, first set Playbooks and Playground RBAC permissions to None and then set the Scripts permission to None. Conversely, to provide access to playbooks or the Playground, the Scripts permission must first be set to View or...

##### Navigation

  On the Scripts page (Investigation → Response → Automation → Scripts), you can view, edit, and create scripts in JavaScript, Python, or PowerShell

##### 3.8.7.1. Use existing scripts

###### Navigation

  Investigation & Response → Automation → Scripts and in the Scripts Library search for the script you want to use

##### 3.8.7.2. Create a script

###### Note

* You can enable/disable a script in the Settings without having to duplicate the script. You can view recently modified or deleted scripts by clicking the version history for all scripts .

###### Important

* If you choose Python, from the Agentic Assistant you can use the Automation Engineer agent.

###### Tip

* If there is an error, you can copy the error message from the test result into the Agentic Assistant prompt and ask the Automation Engineer agent to correct the error.

##### 3.8.7.3. Use the Automation Engineer agent to accelerate script development and deployment

###### Note

* The Automation Engineer agent is available for users with script editing permissions.

* If you make manual edits in the script and don't save the changes and you then modify the script with the Automation Engineer agent, you are prompted to confirm overwriting the manual edits.

###### Tip

* Use detailed prompts, for example, Get failed logins from last 24 hours and return as a table. Clearly define argument names, types, and default values. Mention if you expect the output in a specific format, such as a table, JSON, or plain text.

* If there is an error, you can copy the error message from the test result into the Agentic Assistant prompt and ask the Automation Engineer agent to correct the error.

##### 3.8.7.4. Change the Docker image in an integration or script

###### Note

* You can access publicly available Docker images from the Cortex AgentiX tenant even if there is no external connection to the Demisto registry, for example, if due to firewall constraints, your engine cannot access the Demisto registry.

#### 3.8.8. Context data

##### 3.8.8.1. Issue context data

##### 3.8.8.2. Case context data

##### 3.8.8.3. Search context data

##### 3.8.8.4. Add context data to an issue

##### 3.8.8.5. Add context data to a case

###### Note

* If you run the command in the issue War Room, the data is added to the following places: The case context data. The issue context data under the case tab. If you run the command in the Case War Room, the data is added to the case context data only.

##### 3.8.8.6. Delete context data from a case

##### 3.8.8.7. Use context data in a playbook

###### Caution

* Users with Trigger Playbook permissions on a given issue may still be able to modify the parent case via commands and scripts, even without full access to the case.

### 3.9. Jobs

#### 3.9.1. Manage jobs

##### Note

* Only Account Admins and Instance Administrator roles can create jobs and view/edit job runs. If the owner of a job has been removed from Cortex AgentiX, the job will fail to run. In this case, you must change the owner to a current user.

#### 3.9.2. Create a time triggered job

##### Note

* To view a human readable description of a cron schedule for an existing job, click  and select Job Schedule from the available columns.

##### Important

* We recommend to avoid triggering a job while a previous run of the job is active by configuring the playbook a job triggers to close the investigation before running a new instance of the job.

#### 3.9.3. Create a job triggered by a delta in a feed

##### Note

* A job triggered by a delta in a feed runs only if there is a change in the feed, and does not run on a feed's initial fetch. For the initial fetch, you can run the playbook manually and then set up an event triggered job for subsequent fetches. If you want to trigger a job after a feed completes a fetch operation and the feed does not change...

##### Navigation

  Investigation & Response → Automation → Jobs → New Job

### 3.10. Lists

#### Note

* The maximum size of a list is 209715 characters.

#### 3.10.1. Create a list

##### Note

* If you intend to use the list as part of an Automation Exclusion Policy, we recommend choosing specific roles for read and edit access. For more information on using lists in exclusion policies, see Manage automation exclusion policies.

* If you want to edit a list from a content pack, you need to duplicate or detach a list. Detached lists do not receive updated content in subsequent Cortex AgentiX content releases. To retain an updated list, reattach it.

#### 3.10.2. List commands

#### 3.10.3. Use cases: JSON lists

##### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

  Investigation & Response → Automation → Playbooks → New Playbook

#### 3.10.4. Transform a list into an array

##### Navigation

  Investigation & Response → Automation → Playbooks and create or edit a playbook

### 3.11. Data management

#### 3.11.1. Dataset management

##### License Type

  Managing Roles requires an Account Admin or Instance Administrator role.

##### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

##### Note

* Cold storage, in addition to a cold storage license, requires compute units (CU) to run cold storage queries. For more information on CU, see Manage compute units.Manage compute units

* Only datasets that are already handled as part of the GB license are supported for this license. In addition, the retention configuration is only available in Cortex AgentiX, as opposed to the public APIs.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default. Datasets include dataset permission enforcements in the Cortex Query Language(XQL), Query Center, and XQL Widgets. For example, to view or access any of the endpoints and host_inventory datasets, you need role-based access control (RBAC)...

* You'll only be able to save the dataset view if the query contains no errors; otherwise, the Save button is disabled.

##### Important

* Cortex AgentiX enforces retention on all log-type datasets, excluding metrics and users.

* This column is updated once a day. Therefore, if the dataset was created or updated by the target or lookup flows, it's possible that the Last Updated value is a day behind when the queries or reports were run as it was before this column was updated.

##### 3.11.1.1. What are datasets?

###### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

###### Note

* For more information on tasks specific to lookup datasets, see Lookup datasets.

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

###### Important

* By default, forensic datasets are not included in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

##### 3.11.1.2. Lookup datasets

###### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

###### Note

* A lookup dataset can only be deleted if there are no other dependencies. For example, if a Correlation Rule is based on a lookup dataset, you wouldn't be able to delete the lookup dataset until you removed the dataset from the XQL query of the Correlation Rule.

###### Important

* When you create or add data to a lookup dataset using the target stage, the _time field won't be included by default unless you explicitly add it with the fields stage.

###### 3.11.1.2.1. Import a lookup dataset

####### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

* When uploading a CSV, TSV, or JSON file, ensure that the file meets the following requirements: The maximum size for the total data to be imported into a lookup dataset is 30 MB from the Dataset Management page. Otherwise, the limit is 50 MB using Cortex Query Language (XQL) or APIs. Field names can contain characters from different languages, special...

####### Important

* The name of a dataset created from a TSV file must always include the extension. For example, if the original file name is mrkdptusrsnov23.tsv, you can save the dataset with the name marketing_dept_users_Nov_2023.tsv.

###### 3.11.1.2.2. Download JSON file of lookup dataset

####### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

####### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

###### 3.11.1.2.3. Set time to live for lookup datasets

####### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

####### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

##### 3.11.1.3. Monitor datasets and dataset views activity

###### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 3.11.2. What are Data Model Rules?

##### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

##### 3.11.2.1. Data Model Rules editor views

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

##### 3.11.2.2. Data Model Rules file structure and syntax

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

###### Note

* For more information on XQL syntax, see the XQL Language Reference Guide.

* You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

##### 3.11.2.3. MODEL

###### Note

* The Settings → Configurations → XQL Configuration → Case Sensitivity (case_sensitive) setting can overwrite this case_sensitive configuration for all fields in the application except for BIOCs, which will remain case insensitive no matter what this setting is set to. For more information on this setting, see XQL Configuration.Set up your...

* We recommend that you do not configure the same data source in both Marketplace and using a Cortex AgentiX data collector. Yet, if you do, the following will happen:External data ingestion For network data, all relevant logs from the different data sources are stitched to the same network story. For authentication data, all relevant logs from the...

##### 3.11.2.4. RULE

###### Note

* For more information on the XQL syntax, see the XQL Language Reference Guide.

##### 3.11.2.5. Field structure

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

###### Note

* For more information on these data model fields, see Cortex XSIAM Data Model Schema.

##### 3.11.2.6. How to map authentication story events?

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

* Familiarize yourself with the Cortex Data model (XDM) schema for field definitions and naming conventions, see Cortex XSIAM Data Model Schema.

###### Important

* This Feature focuses on authentication events related to SSO (Single Sign-On) and SaaS (Software-as-a-Service) application authentications. It does not cover internal authentication mechanisms such as Kerberos, NTLM, or traditional domain logon events generated by on-premise infrastructure.

* To maximize the variety of issues that are retrieved based on the XDM authentication stories, we recommend that the following additional fields are populated: xdm.target.resource_name, xdm.logon.type, xdm.source.user_agent, and xdm.source.host.device_category. Should you decide to change the default XDM mappings, ensure that both the mandatory and...

##### 3.11.2.7. Create Data Model Rules

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

###### Navigation

  In Cortex AgentiX, select Settings → Configurations → Data Management → Data Model Rules

##### 3.11.2.8. Troubleshooting Data Model Rules

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

###### Note

* Since this dataset also contains Parsing Rules errors, some of the fields are irrelevant for Data Model Rules and aren't included in the table.

###### Tip

* To ensure you and your colleagues stay informed about Data Model Rules activity, you can also Configure notification forwarding to forward your Data Model Rules audit logs to an email distribution list or Syslog server. For more information about the Data Model Rules audit logs, see Monitor Data Model Rules activity.

##### 3.11.2.9. Using data enrichment

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

###### Note

* For a complete list of auto-enriched fields, see the Cortex Data Model Schema Guide.

###### Important

* When manually mapping ASN fields that are enriched, such as xdm.source.asn.as_number, with other ISP and domain fields that are not enriched, such as xdm.source.asn.isp and xdm.source.asn.domain, it's possible to receive incorrect XDM query results due to the misalignment between the overridden enrichement and system enrichment fields.

##### 3.11.2.10. Data Model Rules notifications

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

##### 3.11.2.11. Monitor Data Model Rules activity

###### Prerequisite

* Data Model Rules requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Dataset Management, Parsing Rules, and Event Forwarding.

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 3.11.3. Manage Event Forwarding

##### Prerequisite

* Event Forwarding requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Dataset Management.

##### Note

* After exporting logs, you can download them from GCP for up to 14 days. The Pub/Sub subscription messages are available for 7 days.

* Requires the Endpoints Event Forwarding add-on.

* Requires the GB Event Forwarding add-on

##### Important

* Since data is aggregated and compressed, it may take up to two hours until the data is available in the forwarding bucket.

##### Navigation

  Under Settings → Configurations → Data Management → Event Forwarding, activate one or more of the following: Enable GB Event Forwarding

  Under Settings → Configurations → Data Management → Event Forwarding, activate one or more of the following

### 3.12. Dashboards and Reports

#### 3.12.1. About dashboards

##### Note

* Dashboards that are based on custom infrastructure cannot be exported. When importing a dashboard that already exists in the system, the imported dashboard overwrites the existing dashboard. To avoid overwriting the existing dashboard, duplicate and rename the existing dashboard before importing the new dashboard.

##### Important

* The ability to create, edit, or share custom dashboards is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to custom dashboards.

##### 3.12.1.1. Command Center dashboards

###### Note

* Access to these dashboards requires RBAC permissions under Dashboards & Reports. The Dashboards component must be Enabled in your role and requires View permissions for Command Center Dashboards. If certain options are unavailable, contact your administrator. For more information, Manage access to custom dashboards. The dashboards are available in dark...

###### 3.12.1.1.1. AgentiX Command Center

####### Note

* Access to the dashboard requires RBAC View permissions for Dashboards & Reports and Command Center Dashboards. Non-admin users who have these permissions can view shared system and custom agents as well as their own agents, listed under Other Agents. They cannot see other users' agents. The dashboards are available in dark mode only. They are not...

##### 3.12.1.2. Predefined dashboards

###### License Type

  Requires the Cortex XSIAM Premium license or any other XSIAM license with the Threat Intel Management (TIM) add-on to use this feature.

#### 3.12.2. Reports

##### 3.12.2.1. Report templates

##### 3.12.2.2. Run or schedule reports

###### Note

* Report templates that are based on custom infrastructure cannot be exported. If you import a report template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template. You can also...

* The report name and description will be displayed in the report header and are not editable during customization.

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

* To send reports to Slack, Slack must be configured as an external application in Cortex AgentiX. For more information, see Integrate Slack for outbound notifications

###### Navigation

  Under Settings → Configurations → General → Notifications, click + Add Forwarding Configuration

#### 3.12.3. Build custom dashboards and reports

##### 3.12.3.1. Build a custom dashboard

###### Note

* For case-related widgets, you can refine the displayed data to only show results from cases that match a case starring configuration. A purple star indicates that the widget is displaying only starred cases. For more information, see Case starring.

##### 3.12.3.2. Manage your Widget Library

###### Note

* Unlike dashboards, individual widgets cannot be shared with other users directly from the Widget Library. Yet, if you add a Restricted widget to a dashboard and then share that dashboard, other users who have access to the dashboard will also be able to see that specific widget.

* Any dashboards or reports that include the widget are affected by the changes.

#### 3.12.4. Fine-tune dashboards and reports

##### 3.12.4.1. Create a custom widget using a script

###### Note

* If you have added arguments to the script, these appear when creating a widget.

* Available options are Pie, Column, Line, and Single Value. To display the result of the script as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### 3.12.4.1.1. Script-based widget examples

####### Note

* Add the widget tag in the script settings to make the script available for use in script-based widgets. For more information, see Create a script.

* If your script returns a time duration, configure the widget with the graph type Single Value and enable Show as Time..

##### 3.12.4.2. Create a text widget

###### Note

* From the Dashboard Manager, you can right-click an existing dashboard and choose Save as report template. You can also add text-based widgets directly to new or existing report templates, as described below.

##### 3.12.4.3. Create custom XQL widgets

###### Note

* Cortex Query Language (XQL) queries generated from the Widget Library do not appear in the Query Center. The results are used only for creating the custom widget.

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### Tip

* You can create a generic dashboard for multiple views of the same dataset by using an asterisk (*) when defining the dataset in the XQL widget as dataset = <dataset_name>*. The placement of the asterisk in the dataset name ensures that any view containing this prefix text is displayed in the results. The dataset in a query is defined as: If there are...

###### 3.12.4.3.1. Configure filters and inputs for custom XQL widgets

####### Prerequisite

* Fixed filters are based on parameters that are defined in custom XQL widgets. Before you can configure fixed filters, take the following steps: Create custom XQL widgets with parameters. For more information, see Create custom XQL widgets. Add the widgets to a custom dashboard. For more information, see Build a custom dashboard.

####### Note

* This option only appears if the dashboard contains custom XQL widgets with defined parameters.

* You can define up to four parameter filters on a single dashboard or report.

* If you specify more than one field, only the first field value is used.

####### Tip

* After the initial setup, when you access your dashboard the filters and inputs might need further refinement. You can make changes to the configured parameters in the XQL widgets, and update the Filters & Inputs on your dashboard until you are satisfied with the results.

##### 3.12.4.4. Configure dashboard drilldowns

###### Prerequisite

* To configure drilldowns your dashboard must contain custom XQL widgets. In addition, if you want to configure in-dashboard drilldowns your custom XQL widget must contain one or more parameters. For more information about configuring parameters in custom XQL widgets, see Create custom XQL widgets.

###### Note

* If the selected parameter is configured in other XQL widgets on the dashboard, these widgets are also affected by the drilldown.

###### 3.12.4.4.1. Variables in drilldowns

## 4. Investigation and Response

### 4.1. Overview of cases

#### 4.1.1. What are cases?

#### 4.1.2. Resolving cases with AI

#### 4.1.3. Case lifecycle

#### 4.1.4. Case thresholds

#### 4.1.5. Case scope and impact

#### 4.1.6. Case and issue domains

### 4.2. Case concepts

#### 4.2.1. Issues, findings, and events

##### 4.2.1.1. Issues

##### 4.2.1.2. Findings and events

#### 4.2.2. Case grouping

#### 4.2.3. Case scoring

#### 4.2.4. Case starring

##### Navigation

  You can manage all starring configurations under Case & Issues → Case Configuration → Starred Issues

#### 4.2.5. SLAs and tracking

### 4.3. Analyze and resolve cases

#### 4.3.1. Review all cases

##### Note

* The legacy view is also available for users who prefer this format. From the Actions menu select Switch to legacy view.

#### 4.3.2. Start case analysis

##### 4.3.2.1. Agentic Assistant- Case Investigation agent

#### 4.3.3. Establish case context

##### 4.3.3.1. AI-generated case summaries

###### Note

* The AI-generated title and description is a calculated value that is regenerated each time you open a case. This value is not a saved static description, therefore it is not reflected in the saved case names in the list of cases in the Split view , or in the Case Name and Case Description columns in the Table view.

###### Navigation

  Configurations → General → Server Settings → AI Configuration and enable the following settings

##### 4.3.3.2. Assess case severity and score

##### 4.3.3.3. Update case attributes

###### Note

* The defined values are shown in the Case Name and Case Description columns in the Table view, and saved to the cases dataset. The case title is also shown the list of cases in the Split view. These values do not replace the AI-generated case title and summary. If the Summarize with AI toggle is enabled, AI-generated case summaries are automatically...

#### 4.3.4. Analyze case details

##### Note

* If you prefer a tabular or legacy layout, switch the case card to the Detailed view. This view preserves the legacy tab based format and custom layouts, ensuring full backward compatibility. You can switch between the new case experience and the legacy view based on personal workflow preferences. For more information, see Detailed View.

##### 4.3.4.1. Grouping graph

###### Note

* Similar issues are displayed as individual entities rather than in a parent/child hierarchy.

##### 4.3.4.2. Evidence

##### 4.3.4.3. Issue feed

##### 4.3.4.4. Associated assets and artifacts

###### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

##### 4.3.4.5. MITRE ATT&CK tactics and techniques

###### Note

* This component is available for cases associated with the Security domain or custom domains.

##### 4.3.4.6. Detailed View

###### Note

* When an issue is resolved, it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

* Cloud-related issues are displayed in the User Name grouping. Prisma Cloud Compute issues are displayed in the Host Name grouping.

#### 4.3.5. Resolve the case

##### 4.3.5.1. Resolution Center

###### Note

* Tasks that are already In Progress but still require your input will appear in both the Pending and In Progress tabs.

##### 4.3.5.2. Collaborative notes and comments

##### 4.3.5.3. Resolve a case

###### Note

* If a case is resolved with the status Resolved - Auto Resolved, Cortex AgentiX can reopen the case for up-to six hours if a new issue is triggered that matches the case. The six-hour period is defined by the timestamp of the last issue that was grouped into the case. After the six-hour period, any new issues are linked to a new case for a new...

##### 4.3.5.4. Resolution reasons for cases and issues

###### Note

* The displayed resolution reasons are domain-specific. You can see the resolution reasons that are defined for a domain under Configurations → Object Setup → Cases → Domains.

* Cases and issues resolved as True Positive and False Positive help Cortex AgentiX to identify real threats in your environment by comparing future cases and associated issues to the resolved cases. Therefore, the handling and scoring of future cases is affected by these resolutions.

#### 4.3.6. Use Cortex Agentic Assistant chat in an investigation

##### Note

* The Cortex Agentic Assistant is currently available in limited regions. For more information see Cortex Agentic Assistant If your tenant is not within one of those regions, you have access to the Cortex Assistant.Cortex Agentic AssistantCortex Assistant To enable the Cortex Agentic Assistant, go to Settings → Configurations → General → Server...

* An agent's proposed plans and results may contain inaccuracies or errors. Always review the results carefully to ensure you fully understand the proposed action before proceeding.

##### Tip

* If you need to quickly access various product pages within Cortex AgentiX, type / in the prompt.

#### 4.3.7. Create a case

##### Note

* To create a case manually, you must have View/Edit permission for Cases and Issues selected under Settings → Configurations → Access Management → Roles → Components → Cases & Issues.

* You can assign a case to a single domain only, and you cannot change the assigned domain. For more information, see Case and issue domains.

* This option is only relevant for certain domains.

* You can't attach files to manually created cases.

##### Tip

* The issues that you link to a case can be linked to multiple cases, and the issue domains do not need to match the case domain.

### 4.4. Investigate issues

#### 4.4.1. Overview of the Issues page

##### Note

* Every 12 hours, the system enforces a cleanup policy to remove the oldest issues once the maximum limit is exceeded. The default issue retention period in Cortex AgentiX is 186 days.

#### 4.4.2. Issue card

##### License Type

  Requires the TIM add-on.

##### Note

* This section is context-specific and shows data according to the issue context.

#### 4.4.3. Link or unlink issues from a case

#### 4.4.4. Run an automation on an issue

##### Note

* In addition to automation, some playbooks contain manual tasks that prompt the analyst for input. This enables you to enhance an automation workflow with analyst input.

* You can also manually select a playbook to run from the Issue Work Plan tab.

#### 4.4.5. Use the War Room in an investigation

##### Note

* The case War Room is usually used for communication capabilities, but unlike the issue War Room, it does not include playbook specific entries. The case War Room enables you to investigate an entire case, not just an issue.

* Cortex AgentiX does not index notes and chats.

##### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

* You can use the up/down arrow buttons in the CLI to do a reverse history search for previous commands with the same prefix.

##### Navigation

  Investigation & Response → Automation → Playground

#### 4.4.6. Use the Work Plan in an investigation

##### Important

* A playbook will not continue its execution path if a prior task has failed; you must resolve the failed task before subsequent tasks can run.

#### 4.4.7. Manage synced tickets in issues

##### Prerequisite

* An integration must be configured before you can sync issues. For more information, see Set up an integration for mirroring issues.Issue syncing with an external integration

##### Note

* Multiple tickets can be linked to an issue with outbound syncing. Issues with inbound syncing can be linked to a single ticket only.

* Using issue fields as variables is not currently supported.

* You can only define a single inbound profile. If you change the inbound sync profile the current profile is overwritten. You can define multiple outbound profiles; one issue can update multiple tickets.

* If you change the selected inbound sync profile, the original sync profile is immediately overwritten.

##### Warning

* If you leave this field blank, all configured instances will be used.

##### Tip

* You can find a sync profile ID under Settings → Configurations → Object Setup → Issues → Sync Profiles. By default, the ID field is not displayed in the table. Click the three-dot menu and add it to the layout.

#### 4.4.8. Issue investigation actions

##### 4.4.8.1. Copy issues

##### 4.4.8.2. Investigate contributing events

##### 4.4.8.3. Export issue details to a file

##### 4.4.8.4. Exclude an issue

##### 4.4.8.5. Query case and issue data

###### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

##### 4.4.8.6. Run indicator extraction in the CLI

###### Note

* Triggering enrichment on a substantial amount of indicators can take time (since it's activating all enrichment integrations per indicator) and can result in performance degradation.

##### 4.4.8.7. Update issue fields

###### Note

* You must create a custom status before you can select it.

###### Tip

* You can create custom issue statuses and resolution reasons, and use the setIssueStatus command to set these custom statuses for issues. For example, when a user starts investigating an issue, the issue status is automatically changed from New to Under Investigation. In some cases, it is useful to create an interim status, such as Triage. After you...

##### 4.4.8.8. Use issue timer field commands manually in the CLI

###### Note

* When defining the values for the slaField use the machine name for the field, which is lowercase and without spaces. You can check the machine name by editing the issue field.

* Timer fields are not started automatically when an issue is created unless run in a playbook.

* After a timer field is stopped, before you can start the timer again you must reset the timer using the resetTimer command. Timers are automatically stopped when an issue is closed.

* When running commands in the CLI, you can specify the alertID to change the timer for a different issue.

##### 4.4.8.9. Close an issue

###### Note

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

### 4.5. Investigate artifacts and assets

#### 4.5.1. Investigate an IP address

##### Note

* Requires a license key. Select Settings → Configurations → Integrations  → Threat Intelligence.

#### 4.5.2. Investigate a file and process hash

##### Note

* Requires a license key. Go to Settings → Configurations → Integrations  → Threat Intelligence.

## 5. Threat Intel Management

### 5.1. Get started with Threat Intel Management

#### 5.1.1. What is Threat Intel Management?

#### 5.1.2. Threat Intel Management use cases

#### 5.1.3. Roles and responsibilities in Threat Intel Management

#### 5.1.4. Indicator concepts

##### Note

* You can store up to 100,000,000 indicators.

#### 5.1.5. Indicator lifecycle

##### Note

* To run enhancement scripts and reputation commands, you must configure a relevant enrichment integration, such as VirusTotal, IPinfo v2, etc.

##### Tip

* We recommend defining your policy for handling expired indicators.

### 5.2. Indicator configuration

#### 5.2.1. Customize indicator fields and types

##### 5.2.1.1. Create an indicator type

###### Note

* If you miss mapping any field, you can create additional new indicator fields and either relate them to all indicator types, or relate them only to the new indicator type (recommended).

###### Navigation

  Settings → Configurations → Object Setup → Indicators → Types

###### 5.2.1.1.1. Indicator type profile

####### Note

* Indicator cache expiration rules only apply to standard enrichment (for example, running the enrichIndicators command). If you run a reputation command, such as !ip, the commands executes even if the cache has not expired.

####### Tip

* To control which integrations run when explicitly executing a command (and not during enrichment), add the using-brand argument to specify only the integrations you want to use. For example: !url url="https://www.google.com" using-brand="AutoFocus V2,VirusTotal"

###### 5.2.1.1.2. File indicators

####### Note

* A new File indicator only affects new indicators ingested to the Cortex AgentiX platform. Indicators that were already in Cortex AgentiX continue to appear as their respective hash-related indicators.

####### Navigation

  Settings → Configurations → Object Setup → Indicators → Types

###### 5.2.1.1.3. Formatting scripts

####### Note

* Formatting scripts must have the indicator-format tag to appear in the list.

* Formatting scripts for out-of-the-box indicator types are system-level, which means that the formatting scripts for these indicator types are not configurable. To create a formatting script for an out-of-the-box indicator type, you need to disable the existing indicator type and create a new (custom) indicator type. If you configured a formatting...

###### 5.2.1.1.4. Enhancement scripts

####### Note

* Enhancement scripts are different from reputation commands. A reputation command runs every integration that has that command within it, to enrich the indicator. The reputation command ip , for example, runs every IP integration command in your enabled integrations, to collect data from multiple sources. An enhancement script is manually run after the...

* Enhancement scripts must have the enhancement tag applied to appear in the list.

###### 5.2.1.1.5. Reputation scripts

####### Note

* Reputation scripts must have the reputation tag applied to appear in the list.

###### 5.2.1.1.6. Reputation commands

####### Note

* Running a reputation command directly (such as !ip) might not apply the result to an indicator, nor does it use the enrichment cache. To ensure an indicator is enriched, and to take advantage of caching, use the enrichIndicators command or the Enrich button in the UI. This runs the appropriate reputation command/script based on the indicator type...

###### 5.2.1.1.7. Map custom indicator fields

####### Note

* Some integrations have indicator mappers and classifiers, such as AWS. If you want to use an integration mapper or classifier, see Indicator classification and mapping.

####### Navigation

  Settings → Configurations → Object Setup → Indicators → Types

##### 5.2.1.2. Create an indicator field

###### Note

* Cortex AgentiX IOC fields are based on the STIX 2.1 specifications. For more information, see Indicator field structure.

* The following HTML tags are not permitted: blockquote, del, dd, div, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, iframe, ins, li, math, noscript, ol, pre, p, script, style, table, ul, address, article, aside, canvas, details, dialog, figcaption, figure, footer, header, hgroup, main, nav, output, progress, section, video. The following CSS tags...

###### Navigation

  Settings → Configurations → Object Setup → Indicators → Fields → New Field

###### 5.2.1.2.1. Indicator field structure

###### 5.2.1.2.2. Indicator field trigger scripts

####### Note

* Indicator field trigger scripts must have the field-change-triggered-indicator tag to appear in the list.

#### 5.2.2. Indicator classification and mapping

##### Note

* When creating a new indicator type, you classify and map the indicator fields in the indicator type settings. For more details, see Map custom indicator fields.

* You can optionally skip importing data. Click the pencil on the right of each indicator type on the right pane to enter the value manually.

* In the Classification & Mapping page, the mapping does not indicate for which indicator types they are configured. When creating a mapper, it is best practice to add to the mapper name and the indicator type the mapper is for. For example, Mail Listener - Phishing. When mapping a list, we recommend you map to a multi-select field. Short text fields do...

#### 5.2.3. Indicator extraction

##### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex AgentiX 2.x to Cortex AgentiX 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Reputation commands, such as !ip and !domain, can only be used after you configure and enable a reputation integration instance, such as VirusTotal and Whois.

* The inline configuration may delay playbook execution.

* While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks. All indicators are automatically extracted and enriched before a playbook is run. For an on-field change, extraction occurs before the next playbook tasks run.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

##### 5.2.3.1. Set the indicator extraction mode for a playbook task

##### 5.2.3.2. Disable indicator extraction for scripts or integrations

#### 5.2.4. Configure indicator expiration

##### Note

* You need to run CLI commands in the Case or Issue War Room.

* If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its expiration method reverts to that of the indicator type (time-based). Time-based expiration is set according to feed reliability. If the same indicator appears on multiple feeds, the...

#### 5.2.5. Configure Threat Intelligence feed integrations

##### Note

* Some third-party services (such as Whois and VirusTotal) enforce strict rate limits based on the source IP address. If you encounter quota management issues, we recommend running them on an engine. This routes the traffic through your own private network, ensuring the external service sees a unique, dedicated IP address exclusive to your organization.

* Some feeds only provide information about new indicators and do not specify when indicators are removed. Indicators from these feeds cannot be automatically expired on removal. If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its...

#### 5.2.6. Exclude indicators from enrichment

#### 5.2.7. Generate issues from indicator rules

##### Note

* Indicators should be present in the Threat Intelligence database (Threat Management → Threat Intelligence → Indicators) before creating detection rules.

* You can't change the Detectable = True and Status = Active filters, which comply with the requirements of the supported indicator type for detection.

* The Issue source is Threat Intelligence.

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

#### 5.2.8. Export indicators

##### Caution

* You should not run a query on a field that you might change in the playbook flow. For example, you shouldn't have a playbook with query Verdict:Malicious and then change the indicator verdict as a part of the playbook.

### 5.3. Indicator management

### 5.4. Indicator investigation

#### 5.4.1. Indicator verdict

#### 5.4.2. Extract and enrich an indicator

##### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex AgentiX 2.x to Cortex AgentiX 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Triggering enrichment on a substantial number of indicators can take time (because it's activating all enrichment integrations per indicator) and can result in performance degradation.

* Reputation commands, such as !ip, !domain can only be used when you configure and enable a reputation integration instance, such as VirusTotal and WHOIS.

#### 5.4.3. Expire an indicator

##### Note

* You need to run these commands in the Case or Issue War Room.

#### 5.4.4. Manage indicator relationships

##### Note

* You can also add an indicator relationship from the Quick View when selecting an indicator from an issue.

#### 5.4.5. Delete and exclude indicators

##### Caution

* Ensure you are using the correct syntax when defining the values for your exclusion lists.

## 6. Cortex AgentiX XQL

### 6.1. Get started with XQL

#### 6.1.1. XQL language features

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

##### Navigation

  You submit XQL queries to Cortex AgentiX using the Investigation & Response → Search → Query Builder user interface

#### 6.1.2. XQL Language Structure

##### 6.1.2.1. Adding comments in queries

#### 6.1.3. Supported operators

##### Note

* In some cases, using an IN or NOT IN operator combined with a dataset and filter stage can be a better alternative to using a join stage.

#### 6.1.4. Datasets and presets

##### Note

* INFO issues are not included in this dataset. This dataset includes issues from the Security and Health domains. For more information, see Overview of the Issues page.

* The fields contained in this dataset are a subset of the fields in the xdr_data dataset.

* If the vendor and product are not specified in the Winlogbeat profile's configuration file, Cortex AgentiX creates a default dataset called microsoft_windows_raw.

* To ensure GlobalProtect access authentication logs are sent to Cortex AgentiX, verify that your PANW firewall's Log Settings for GlobalProtect has the Cortex Data Lake checkbox selected.

* Prisma Access firewalls do not send configuration logs to the Structured Log Storage (SLS).

* You can query in XQL for this data and build widgets based on the xdr_data dataset or using the preset device_control. To view in an XQL query these events, the Device Configuration of the endpoint profile must be set to Block. Otherwise, the USB events are not captured. The events are also captured when a group of device types are blocked on the...

##### Important

* This dataset will not be updated after June 2024. Use the health_alerts dataset instead.

#### 6.1.5. About examples

##### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

#### 6.1.6. JSON functions

##### Important

* JSON field names are case sensitive, so the key to field pairing must be identical in an XQL query for results to be found. For example, if a field value is "TIMESTAMP" and your query is defined to look for "timestamp", no results will be found.

#### 6.1.7. How to filter for empty values in the results table

#### 6.1.8. Understanding string manipulation in XQL

### 6.2. Build XQL queries

#### 6.2.1. About the Query Builder

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

#### 6.2.2. How to build XQL queries

##### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex AgentiX. All other users can only create and view queries built with an existing dataset. When you have...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

##### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

##### 6.2.2.1. Get started with XQL queries

###### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

##### 6.2.2.2. Useful XQL user interface features

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

##### 6.2.2.3. XQL Query best practices

##### 6.2.2.4. Expected results when querying fields

##### 6.2.2.5. Create XQL query

###### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined for the entire query, including queries that are part of the join stage. Yet, this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

##### 6.2.2.6. Review XQL query results

###### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* Results are received incrementally for the first 100K records, or up to 100MB worth of records, whichever comes first. After that, the next update is when the query has finished running completely.

* Real time query results are available only in the Query Builder and in free text query. Real time results are displayed only for queries run on hot datasets. The Sort option is available only after all the data is retrieved. When you formulate complex queries, the results will be displayed when the query has finished running completely, and not in real...

* In order for Cortex AgentiX to provide a histogram for a field, the field must not contain an array or a JSON object.

##### 6.2.2.7. Translate to XQL

###### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

##### 6.2.2.8. Graph query results

###### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

#### 6.2.3. Query Builder templates

##### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

##### 6.2.3.1. Get started with Query Builder templates

##### 6.2.3.2. Considerations for using Query Builder templates

##### 6.2.3.3. Create a query from a template

###### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

##### 6.2.3.4. Run a free text query

###### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

##### 6.2.3.5. Query Builder template examples

###### Navigation

  Investigation & Response → Search → Query Builder

#### 6.2.4. Overview of the Query Center

##### Note

* Very short queries might not be listed. You cannot cancel correlation queries. The default retention period for historic queries is aligned with issue retention.

##### 6.2.4.1. Edit and run queries in Query Center

###### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

###### Navigation

  Investigation & Response → Search → Query Center → Query History

###### 6.2.4.1.1. Query Center reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 6.2.5. Manage scheduled queries

##### Navigation

  Investigation & Response → Search → Scheduled Queries

##### 6.2.5.1. Scheduled Queries reference information

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 6.2.6. Manage your personal query library

##### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

#### 6.2.7. Legacy Query Builder

##### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

##### 6.2.7.1. Create authentication query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.2.7.2. Create event log query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.2.7.3. Create file query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.2.7.4. Create image load query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.2.7.5. Create network connections query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.2.7.6. Create network query

###### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

##### 6.2.7.7. Create process query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.2.7.8. Create registry query

###### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

##### 6.2.7.9. Query across all entities

###### Navigation

  Investigation & Response → Search → Query Builder

### 6.3. Stages

### 6.4. Functions

## 7. Troubleshoot

### 7.1. About health issues

#### Prerequisite

* For Cortex AgentiX to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics.Enable the Analytics Engine and Identity Analytics

#### Note

* The Health Issues page displays issues that were triggered after July 2024. To see health issues that were triggered before this date, click Legacy Health Issues.

* Cortex AgentiX enforces the dedup logic to health issues. This logic reduces the likelihood of identical health issues from flooding the issues dataset.

#### 7.1.1. Monitor data ingestion health

#### 7.1.2. Monitor correlation rules

##### Note

* In the dataset, the Query start time and Query end time indicate the timeframe of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

#### 7.1.3. Investigate and resolve health issues

### 7.2. Log forwarding

#### 7.2.1. Forward logs from Cortex AgentiX to external services

##### 7.2.1.1. Configure external applications for forwarding

###### Note

* No prior configuration is required to send data or logs to an email distribution list. Only cases and issues can be forwarded to Slack, Amazon S3, Amazon SQS, Splunk, and Webhook. To forward data to Amazon SQS, the following permissions are required: sqs:GetQueueAttributes, sqs:ListQueues, sqs:SendMessage, sqs:SendMessageBatch, tag:GetResources, and...

* Only a user with Account Admin or Instance Admin permissions can configure egress. For more information, see Egress configurations.Egress configurations

* For Amazon SQS or Amazon S3, you need to provide the queue/bucket name. For Webhook or Splunk, you need to provide the domain, including any subdomain.

* You can also configure external applications when you create a new forwarding configuration. After defining the configuration and setting the scope, you can Add Application and follow the instructions below for any of these destinations.

* If egress has not been configured in the Cortex Gateway, verification will fail and a message will display that the endpoint does not match any approved routes.

###### 7.2.1.1.1. Integrate a syslog receiver

####### Note

* Up to TLS 1.3 is supported. Verify the self-signed CA includes your public key.

###### 7.2.1.1.2. Integrate Slack for outbound notifications

####### Note

* You are directed to the Slack browser to install Cortex AgentiX. You can only use this link to install Cortex AgentiX on Slack. Attempting to install from Slack Marketplace will redirect you to Cortex AgentiX documentation.

##### 7.2.1.2. Configure notification forwarding

###### Prerequisite

* Before you can select a syslog receiver or a Slack channel, you must integrate these external services with Cortex AgentiX. For more information, see: Integrate a syslog receiver Integrate Slack for outbound notifications

###### Note

* Notification Forwarding by Domain: To configure notification forwarding for issues by domain, select Log Type = Issues and filter the Issues table by Issue Domain. Case IDs in Notifications: If case matching completes before the notification is sent, the Case ID is included. If matching takes longer than the notification trigger, the notification is...

* This option will be deprecated in the next release. Configure issues with the filter Issue Domain = Health instead.

##### 7.2.1.3. Monitor administrative activity

#### 7.2.2. Data and log notification formats

##### Note

* Issues can be forwarded to email, syslog servers, and Slack in the alert format, if you prefer. The alert format can be selected when you configure your forwarding notification.

##### 7.2.2.1. Issue notification format

##### 7.2.2.2. Management Audit log notification format

### 7.3. In-product support case creation

#### Note

* When opening a support case through the Customer Support Portal, you need to manually select Cortex AgentiX as the product. While there may be discrepancies between the categories in this wizard and the Customer Support Portal process, that's because this wizard is designed specifically to focus on options relevant to Cortex AgentiX.

* Selecting an endpoint from the endpoint table and retrieving TSF requires full Retrieve Endpoint Data permissions under Endpoint Administration.

* Console recordings cannot exceed 10 minutes. The current recording time is displayed at the top of the window.

## 8. Reference

### 8.1. Cortex AgentiX API

#### Caution

* You can't view the API Key again after you complete this step so ensure that you copy it before closing the notification.

#### Navigation

  Settings → Configurations → Integrations → API Keys

### 8.2. XDM fields for mapping authentication events

#### Note

* For more information on the entire Cortex Data model (XDM) schema, see Cortex XSIAM Data Model Schema.

* Do not map a static string, list, or empty string. You must map this field from the raw log field that best represents the actual source IP used in the authentication attempt. In cases where multiple IP fields are available, such as client_ip, source_ip, and original_client_ip, choose the field that captures the IP address from which the user initially...

* Mapping should be done per event type. The same system could be an IDP in one event and an SP in another.

* For more information on the event outcome constants in the Cortex Data Model, see XDM_CONST.OUTCOME.

* Outcome is based on a conclusive event type reflecting the true end state of the authentication flow.Critical for effectiveness of detection rules. Incorrect derivation can lead to missed detections or false positives.

* These are the most common values, but other logon types also exist. For a complete list, see XDM_CONST.LOGON_TYPE.

* For more information, see XDM_CONST.USER_TYPE.

* For more information, see XDM_CONST.PRIVILEGE_LEVEL.

* For more information, see XDM_CONST.OS_FAMILY.

* While xdm.network.session_id aggregates multiple user actions within a broader session window. xdm.session.context.id is used to correlate events that belong to a single authentication request or transaction.

### 8.3. Fair Usage policy for Cortex AgentiX


## Cortex AppSec Documentation


---

## 1. Cortex Cloud Application Security

## 2. Onboard Data Sources

### 2.1. Onboard version control systems

#### 2.1.1. AWS CodeCommit

#### 2.1.2. Azure DevOps

##### 2.1.2.1. Azure DevOps onboarding system architecture

#### 2.1.3. Bitbucket Cloud

#### 2.1.4. Bitbucket Data Center

#### 2.1.5. GitHub Cloud

#### 2.1.6. GitHub Enterprise (On-Prem)

#### 2.1.7. GitLab SaaS

#### 2.1.8. GitLab Self Managed (On-Prem)

### 2.2. Onboard CI/CD systems

#### 2.2.1. Onboard CircleCI for CI/CD pipeline scans

#### 2.2.2. Onboard Jenkins for CI/CD pipeline scans

### 2.3. Integrate CI tools

#### 2.3.1. AWS CodeBuild

#### 2.3.2. Onboard CircleCI for code scans

#### 2.3.3. Connect Cortex CLI

#### 2.3.4. GitHub Actions

#### 2.3.5. Onboard Jenkins for code scans

#### 2.3.6. Onboard Terraform Cloud (Run Tasks)

#### 2.3.7. Onboard Terraform Enterprise (Run Tasks)

### 2.4. CLI pipeline code snippets

### 2.5. Onboard private package registries

#### 2.5.1. JFrog Artifactory

#### 2.5.2. Onboard JFrog Artifactory

### 2.6. Supported third-party data sources

#### 2.6.1. Ingest Semgrep data

#### 2.6.2. Ingest Snyk data

#### 2.6.3. Ingest SonarQube SAST data

#### 2.6.4. Ingest Veracode SAST data

#### 2.6.5. Generic 3rd Party AppSec Collector

##### 2.6.5.1. Onboard the 3rd Party AppSec Collector

### 2.7. Manage data source integrations

### 2.8. Transporter over Broker VM

#### 2.8.1. Set up a Transporter applet on Broker VM

#### 2.8.2. Set up a Transporter on your VCS

## 3. Cortex Cloud Application Security dashboard

## 4. Application Security Posture Management (ASPM)

### 4.1. ASPM use cases

### 4.2. ASPM key features

### 4.3. ASPM user roles and permissions

### 4.4. Code to Cloud

#### 4.4.1. Supported integrations

#### 4.4.2. Code to Cloud visibility

#### 4.4.3. Code to Cloud troubleshooting

### 4.5. ASPM Command Center

#### 4.5.1. ASPM Command Center workflow

### 4.6. Coverage

#### 4.6.1. Coverage in the user interface

### 4.7. Compliance for Cortex Cloud Application Security

#### 4.7.1. Infrastructure-as-Code (IaC) compliance

#### 4.7.2. Manage IaC compliance

#### 4.7.3. CI/CD Compliance

##### 4.7.3.1. Create CI/CD compliance reports

### 4.8. Urgency

#### 4.8.1. Urgency metrics

### 4.9. Backlog baseline

#### 4.9.1. Backlog use cases

#### 4.9.2. Issue/Finding classification by scanner

#### 4.9.3. Using Backlog

### 4.10. Service Lead Agreements (SLA)

#### 4.10.1. Configure and monitor Cortex Cloud Application Security SLAs

### 4.11. Applications

#### 4.11.1. Defining Business Applications

##### 4.11.1.1. Defining business applications by Criteria

##### 4.11.1.2. Define applications by VCS criteria

##### 4.11.1.3. Manage application criteria

##### 4.11.1.4. Define applications by cloud tag-based criteria

##### 4.11.1.5. How to manually build an application

#### 4.11.2. Application management and visibility

#### 4.11.3. Business application assets

##### 4.11.3.1. Business application expanded asset details

##### 4.11.3.2. Export business application data

#### 4.11.4. Scope user access to applications (Application SBAC)

##### 4.11.4.1. Enable SBAC in the Cortex Cloud tenant

##### 4.11.4.2. Create an application-based Asset Group

##### 4.11.4.3. Scope user access to an application

##### 4.11.4.4. Create application-scoped policies

### 4.12. Repositories as assets

#### 4.12.1. Explore repository assets

#### 4.12.2. In-depth repository asset information

#### 4.12.3. Manage Repository assets

#### 4.12.4. Export Software Bill of Materials (SBOM)

#### 4.12.5. Manage issues detected in repositories

### 4.13. Manage 3rd party findings and generated issues

### 4.14. Manage code weaknesses

#### 4.14.1. Code weaknesses issue inventory

#### 4.14.2. Detailed code weakness issue information

#### 4.14.3. Code weakness findings

## 5. CI/CD Security

### 5.1. CI/CD Security user roles and permissions

### 5.2. CI/CD Assets

#### 5.2.1. CI/CD Instances as assets

##### 5.2.1.1. Explore CI/CD Instance assets

##### 5.2.1.2. In-depth CI/CD pipeline instance asset information

##### 5.2.1.3. Manage CI/CD pipeline instances

#### 5.2.2. CI/CD Pipelines as assets

##### 5.2.2.1. Explore CI/CD Pipeline assets

##### 5.2.2.2. In-depth CI/CD pipeline asset information

##### 5.2.2.3. Manage CI/CD pipeline assets

#### 5.2.3. Version Control System (VCS) Organizations as assets

##### 5.2.3.1. Explore VCS Organization assets

##### 5.2.3.2. In-depth VCS Organization asset information

##### 5.2.3.3. Manage VCS organization assets

#### 5.2.4. VCS Collaborators-as-assets

##### 5.2.4.1. In-depth Collaborator asset information

##### 5.2.4.2. Manage Collaborator assets

### 5.3. Supply Chain Inventories

#### 5.3.1. Supply Chain Tools

##### 5.3.1.1. Supply Chain Tools

##### 5.3.1.2. Expanded Supply Chain tool information

#### 5.3.2. Supply Chain Catalog

### 5.4. CI/CD Risks

#### 5.4.1. CI/CD pipeline issues

#### 5.4.2. Expanded CI/CD risks issue information

#### 5.4.3. VCS and CI/CD pipeline risk findings

### 5.5. CI/CD Rules

#### 5.5.1. CI/CD rules roles and permissions

#### 5.5.2. CI/CD rules inventory

### 5.6. CI/CD Policies

#### 5.6.1. CI/CD policies user roles and permissions

#### 5.6.2. CI/CD policies inventory

#### 5.6.3. Create custom CI/CD policies

#### 5.6.4. Manage CI/CD policies

## 6. Code Security

### 6.1. Code Security user roles and permissions

### 6.2. Code Security assets

### 6.3. Software packages as assets

#### 6.3.1. Explore software package assets

#### 6.3.2. In-depth software package asset information

### 6.4. Infrastructure-as-Code (IaC) resources as assets

#### 6.4.1. Explore IaC assets

#### 6.4.2. In-depth IaC resource asset information

### 6.5. Code Security scanners

### 6.6. Secrets scanners

#### 6.6.1. Secrets issues

#### 6.6.2. Secrets issues inventory

#### 6.6.3. Detailed Secrets issue information

#### 6.6.4. Secrets findings

#### 6.6.5. Manage Secrets issues

### 6.7. Infrastructure as Code (IaC) misconfiguration scanner

#### 6.7.1. Supported frameworks and languages

#### 6.7.2. IaC misconfiguration issues

#### 6.7.3. IaC misconfiguration issues inventory

#### 6.7.4. Detailed IaC misconfiguration issue information

#### 6.7.5. IaC misconfiguration findings

#### 6.7.6. Manage IaC misconfiguration issues

### 6.8. IaC Drift Detection scans

#### 6.8.1. IaC Drift Detection issues

#### 6.8.2. IaC Drift Detection issue inventory

#### 6.8.3. Detailed IaC drift detection issue information

#### 6.8.4. IaC Drift Detection findings

### 6.9. Software Composition Analysis (SCA ) scanners

#### 6.9.1. Supported Software Composition Analysis (SCA) frameworks and languages

#### 6.9.2. Software Composition Analysis (SCA) vulnerability issues

##### 6.9.2.1. Vulnerability issues inventory

##### 6.9.2.2. Detailed vulnerability issue information

##### 6.9.2.3. CVE vulnerabilities findings

##### 6.9.2.4. Manage SCA CVE vulnerability issues

#### 6.9.3. License miscompliance issues

##### 6.9.3.1. License miscompliance issues inventory

##### 6.9.3.2. Expanded License miscompliance issues information

##### 6.9.3.3. License miscompliance findings

##### 6.9.3.4. Open-source software license categories

##### 6.9.3.5. Manage license miscompliance issues

#### 6.9.4. Package Integrity

##### 6.9.4.1. Package Integrity inventory

##### 6.9.4.2. Expanded Package Integrity issues inventory information

##### 6.9.4.3. Package Integrity findings

##### 6.9.4.4. Manage Package Integrity issues

### 6.10. Application Security scans management

#### 6.10.1. Overview

#### 6.10.2. Branch periodic scans

#### 6.10.3. Pull Request scans

#### 6.10.4. CI scans

#### 6.10.5. Manage repository scan configurations

#### 6.10.6. Monitor data source instances health

### 6.11. Application Security Policies

#### 6.11.1. User roles and permissions

#### 6.11.2. Policies inventory

#### 6.11.3. AI-recommended guardrails

##### 6.11.3.1. Manage AI-recommended guardrails

#### 6.11.4. Create Cortex Cloud Application Security policies

##### 6.11.4.1. Create code security policies

###### 6.11.4.1.1. Cortex Cloud Application Security code policy Condition attributes

##### 6.11.4.2. Create IaC Drift Detection policies

##### 6.11.4.3. Manage Cortex Cloud Application Security policies

### 6.12. Application Security Rules

#### 6.12.1. Roles and permissions

#### 6.12.2. Rules inventory

#### 6.12.3. Create custom Cortex Cloud Application Security rules

#### 6.12.4. Manage Cortex Cloud Application Security custom rules

#### 6.12.5. Configure YAML file properties

### 6.13. Application Security CLI

#### 6.13.1. Connect Cortex CLI

#### 6.13.2. Cortex CLI usage for Cortex Cloud Application Security

#### 6.13.3. CLI pipeline code snippets

#### 6.13.4. Cortex CLI Cortex Cloud Application Security command line reference

#### 6.13.5. Cortex CLI common command line reference guide

#### 6.13.6. Git Hooks

##### 6.13.6.1. Cortex CLI pre-commit hooks

###### 6.13.6.1.1. Pre-commit hook usage

##### 6.13.6.2. Cortex CLI pre-receive hooks

###### 6.13.6.2.1. Pre-receive hook usage

### 6.14. IDE

#### 6.14.1. System requirements

#### 6.14.2. Visual Studio (VS) Code and VS Code compatible IDEs

##### 6.14.2.1. How to use the Cortex Cloud extension in VS Code

#### 6.14.3. JetBrains

##### 6.14.3.1. How to use the JetBrains Cortex Cloud extension

### 6.15. Developer Suppressions

## 7. API documentation


## Cortex KSPM Documentation


---

## 1. Kubernetes Security Posture Management (KSPM)

## 2. KSPM dashboard

## 3. Kubernetes Clusters

## 4. Kubernetes Resources Inventory

## 5. Onboard the Kubernetes Connector

## 6. Kubernetes connectivity management

## 7. Manage Kubernetes Connector instances

## 8. Cloud Workload Policies and Rules

### 8.1. How policies and rules work together

### 8.2. Cloud Workload Policies

#### 8.2.1. Types of Cloud Workload Policies

##### 8.2.1.1. Trusted image cloud workload policies

#### 8.2.2. Cloud Workload Policies page

##### 8.2.2.1. Widgets panel

###### 8.2.2.1.1. Show or hide the widget panel

##### 8.2.2.2. Change the layout of the policies table

##### 8.2.2.3. Policy Details Panel

#### 8.2.3. Enable or disable a Cloud Workload Policy

#### 8.2.4. Create a Cloud Workload Policy

#### 8.2.5. Use an existing policy to create a new Cloud Workload policy

#### 8.2.6. Edit a Cloud Workload Policy

#### 8.2.7. Delete a Cloud Workload Policy

#### 8.2.8. Cloud Workload Preventive Action

### 8.3. Cloud Workload Rules

#### 8.3.1. Default (pre-defined) Rules

#### 8.3.2. Custom (user-defined) Rules

#### 8.3.3. Cloud Workload Rules page

##### 8.3.3.1. Filter page results

##### 8.3.3.2. Change the layout of the rules table

##### 8.3.3.3. Rule details panel

#### 8.3.4. Create a new Custom Detection Rule

#### 8.3.5. Use an existing rule to create a new Custom Detection Rule

#### 8.3.6. Edit a Custom Detection Rule

#### 8.3.7. Delete a Custom Detection Rule

## 9. Create prevent policy for Kubernetes clusters

10. What's new in Kubernetes Connector?

11. Supported Kubernetes distributions


## Cortex APIs Documentation


---

## 1. Cortex Cloud APIs

### 1.1. Understand Cortex Cloud licenses

### 1.2. Get started with Cortex Cloud APIs

### 1.3. Create a new API key

### 1.4. Get your Cortex API key ID

### 1.5. Get your FQDN

### 1.6. Make your first API call

### 1.7. Run XQL query APIs

#### Note

* To execute a XQL API, you need to run a series of APIs. Each API requires a response value from the previous API to continue. This allows you to track the number of XQL queries you want to run, which in turn helps you manage your daily quota. Queries called without enough quota will fail. To ensure you don't surpass your quota, Cortex Cloud allows you to run up to four API queries in parallel. Run the following APIs to call an XQL query: Start an XQL Query—Run an XQL query. Response returns a unique execution ID used to retrieve the results by the Get XQL Query Results API. Get XQL Query Results—Retrieve XQL query results. API displays up to 1,000 results. If query generated more than 1,000 results, the response returns a unique stream ID used to retrieve additional results by the Get XQL Query Results Stream API. Get XQL Query Results Stream—Retrieve XQL query with more than 1,000 results. 1.8 |Whats-new-in-this-release Cortex Cloud version 1.3 includes the following new APIs. What's changed with version 1.3 Cortex Cloud version 1.3 includes the following updates. 2 |APIs You can export the OpenAPI specs in the Cortex Stoplight instance. Using the Cortex Platform APIs, you can configure and manage authentication settings, datasets, cases, issues, and script executions. Additionally, the APIs allow you to run XQL queries and perform various other operations across the platform. The license requirements for each API are listed individually. 2.1 |Cortex Cloud Platform APIs You can export the OpenAPI specs in the Cortex Stoplight instance. Using the Cortex Platform APIs, you can configure and manage authentication settings, datasets, cases, issues, and script executions. Additionally, the APIs allow you to run XQL queries and perform various other operations across the platform. The license requirements for each API are listed individually. 2.1.1 |Preface You can export the OpenAPI specs in the Cortex Stoplight instance. Using the Cortex Platform APIs, you can configure and manage authentication settings, datasets, cases, issues, and script executions. Additionally, the APIs allow you to run XQL queries and perform various other operations across the platform. The license requirements for each API are listed individually. 2.1.1.1 |Servers 2.1.2 |Cortex CLI APIs for managing the Cortex CLI 2.1.2.1 |Get the latest version of the Cortex CLI Get the latest version of Cortex CLI Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Cortex CLI version Service had unexpected internal error 2.1.3 |XQL query Run XQL queries on your data sources using a series of APIs. 2.1.3.1 |Start an XQL query Execute an XQL query. For more information on how to run XQL queries, see Running XQL query APIs. To ensure you don't surpass your quota, Cortex Cloud allows you to run up to four API queries in parallel. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management String of the XQL query. Note: This is only used when querying tenants managed by Managed Security Services Providers (MSSP). List of strings used for running APIs on local and Managed Security tenants. Valid values: For single tenant (local tenant) query, enter a single-item list with your tenant_id. Additional valid values are, empty list ([]) or null (default). For multi-tenant investigations (Managed Security parent who investigate children and/or local), enter multi-item list with the required tenant_id. List of IDs can contain the parent, children, or both parent and children. Integer in timestamp epoch milliseconds. Valid values include: Absolute Unix timestamp representing a date period: {"from" : 1598907600000, "to" : 1599080399000} = date period: 31/08/20 09:00:00 PM UTC - 02/09/20 8:59:59 PM UTC Relative Unix timestamp representing the last 24 hours: {"relativeTime": 86400000} = (24 * 60 * 60 * 1000 = 86400000). Use for an absolute timeframe in Unix timestamp. Use for a relative Unix timestamp. Successful response Bad Request. Invalid JSON. The number of daily active queries. The number of daily queries rejected due to too many concurrent XQL queries being run through the API. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.3.2 |Get XQL query results Retrieve results of an executed XQL query API. Note: This endpoint only works on XQL queries initiated by /public_api/v1/xql/start_xql_query/. Maximum result set size is 1000. The API does not support pagination, therefore, you can set values to determine the result size limitation and how to wait for the results. To view response with greater than 1000 results you must call Get XQL query results Stream. For more information on how to run XQL queries, see Running XQL query APIs. To ensure you don't surpass your quota, Cortex Cloud allows you to run up to four API queries in parallel. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management String representing the unique execution ID generated by the response to Start an XQL query API. You can also enter the execution ID of a query generated in Cortex XDR and listed in the Query Center table. Boolean flag indicating whether the API call should operate in synchronous/blocking mode, or in asynchronous/non-blocking mode. Valid Values: True (default): The call returns immediately with one of the following options: PENDING status indicating query hasn't yet completed or results are not yet ready to be returned. Need to execute the API call again. SUCCESS/FAIL status False: The API will block until query completes and results are ready to be returned. Integer representing the maximum number of results to return. If the 'limit' is not specified or if 'limit' is greater than 1000 and the query yields more than 1000 valid results, a stream id will be generated for use in the Get XQL query results Stream* API. In the context of multi-tenant investigations, when you specify the parameter value (x), it will return x results across all tenants combined, rather than x results for each individual tenant. For example, if there are y tenants participating in the investigation, the maximum number of results returned can be x*y (up to the limit of 1,000,000). The type of response output. Successful response Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.3.3 |Get XQL query Quota Retrieve the amount of query quota available and used. Note: This endpoint only works on XQL queries initiated by /public_api/v1/xql/start_xql_query/. For more information on how to run XQL queries, see Running XQL query APIs. To ensure you don't surpass your quota, Cortex Cloud allows you to run up to four API queries in parallel. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Successful response The number of daily active queries. This value is reset nightly. The number of daily queries rejected due to too many concurrent XQL queries being run through the API. This value is reset nightly. Currently running XQL queries with their current duration. The number of active queries currently running. The maximum number of queries that ran concurrently today on this tenant. This value is reset nightly. Bad Request. Got an invalid JSON. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.3.4 |Get XQL query results Stream Retrieve XQL query results with more than 1000 results. Note: This endpoint only works on XQL queries initiated by /public_api/v1/xql/start_xql_query/. Response is returned as chunked (Transfer-Encoding: chunked). To retrieve a compressed gzipped response (Content-Encoding: gzip), in your header add Accept-Encoding: gzip. For more information on how to run XQL queries, see Running XQL query APIs. To ensure you don't surpass your quota, Cortex Cloud allows you to run up to four API queries in parallel. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management For retrieving a compressed gzipped response String representing the unique ID generate by the response to Get XQL query results API. Successful response Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.4 |Endpoint Management APIs for managing endpoints 2.1.4.1 |Get Distribution version Get a list of all the agent versions to use for creating a distribution list. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Successful response List of Windows agent versions. List of Linux agent versions. List of Mac agent versions. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.4.2 |Get all Endpoints Gets a list of all of your endpoints. The response is concatenated using AND condition (OR is not supported). Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. Successful response Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.4.3 |Get Policy Get the policy name for a specific endpoint. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. Successful response Name of the policy allocated with the endpoint. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.4.4 |Delete Endpoints Delete selected endpoints in Cortex Cloud. You can delete up to 1000 endpoints. Note: Endpoints are deleted from Cortex Cloud UI, however they still exist in the database. When filtering by multiple fields: Response is concatenated using AND condition (OR is not supported). Maximum result set size is 1000. Offset is the zero-based number of cases from the start of the result set. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. Array of filter fields. String that identifies a list the filters match. Filters are based on the following keywords: endpoint_id_list: List of endpoint IDs. String that identifies the comparison operator you want to use for this filter. Valid keywords and values are: in endpoint_id_list: List of strings Value that this filter must match. Valid keywords: Successful response Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.4.5 |Create distributions Create an installation package. This is an async call that returns the distribution ID; it does not mean that the creation succeeded. To confirm the package has been created, check the status of the distribution by running the Get Distribution Status API. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. The name of the installation package. The installation platform. A string representing the type of package to create. Each JSON object must contain one of the following keywords: standalone: Installation for a new agent. When using this, you must include the platform field with one of the following values: windows, linux, macos, android, kubernetes, helm. upgrade: Upgrade of an agent from ESM. When using this, you must include the agent_version field with one of the following values: windows_version, linux_version, or macos_version. Use agent_version when creating a standalone installer. The value should be the agent version number. Use windows_version when creating an upgrade package. The value is the relevant version number. Use linux_version when creating an upgrade package. The value is the relevant version number. Use macos_version when creating an upgrade package. The value is the relevant version number. When the package_type is kubernetes or helm, use the deployment_platform to indicate the type of platform. Valid values include: The default namespace The node selector in the following format: `"node_selector": {"key": "val"}' Whether or not to run on the master node. Whether or not to run on all nodes. Successful response Installation package ID. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.4.6 |Get Violations Gets a list of device control violations filtered by selected fields. You can retrieve up to 100 violations. When filtering by multiple fields: Response is concatenated using AND condition (OR is not supported). Maximum result set size is 100. Offset is the zero-based number of cases from the start of the result set. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. An empty object returns all results. Provides an array of filter fields. String that identifies the violation field the filter is matching. Filters are based on the following keywords: endpoint_id_list: List of endpoint IDs. type: Type of violation. timestamp: Timestamp of the violation. ip_list: List of IP addresses. vendor: Name of vendor. vendor_id: Vendor ID. product: Name of product. product_id: Product ID. serial: Serial number. hostname: Hostname. violation_id_list: List of violation IDs. username: Username. String that identifies the comparison operator you want to use for this filter. Valid keywords are: in — Permitted for all fields except timestamp. gte / lte — Permitted only for timestamp. Value that this filter must match. The contents of this field will differ depending on the violation field that you specified for this filter: timestamp: Integer, in UTC timezone epoch milliseconds violation_id_list: List of integers ip_list: Must contain an IP string type: Must be either cd-rom, disk drive, floppy disk, portable device All other fields need to be list of strings. Integer representing the starting offset within the query result set from which you want violations returned. Violations are returned as a zero-based list. Any violation indexed less than this value is not returned in the final result set and defaults to zero. An integer representing the end of offset within the result set after which you do not want violations returned. Violations in the violation list that are indexed higher than this value are not returned in the final results set. Defaults to zero, which returns all alerts to the end of the list. Identifies the sort order for the result set. The field you want to sort by. Can be either asc (ascending) or desc (descending). Successful response Number of total results of this filter without paging. Number of alerts actually returned as a result. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.4.7 |Get Distribution status Check the status of the installation package. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. The installation package ID. Successful response The status of the installation package. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.4.8 |Get Distribution URL Get the distribution URL for downloading the installation package. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. Installation package ID. A string representing the type of installation package. Select one of the following valid keywords and values: upgrade Package type should match the distribution type or platform: sh: x86_64 Linux SH installer rpm: x86_64 Linux RPM installer deb: x86_64 Linux DEB installer aarch64_sh: aarch64 Linux SH installer aarch64_rpm: aarch64 Linux RPM installer aarch64_deb: aarch64 Linux DEB installer Successful response URL for downloading the installation package. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.4.9 |Set an Endpoint Alias Set or modify an Alias field for your endpoints. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. An array of filter fields. String that identifies the field the filter is matching. Filters are based on the following keywords: endpoint_id_list: List of endpoint IDs. endpoint_status: Status of the endpoint ID. dist_name: Distribution / Installation Package name. ip_list: List of IP addresses. group_name: Group name the agent belongs to. platform: Platform name. alias: Alias name. isolate: If the endpoint was isolated. hostname: Hostname. String that identifies the comparison operator you want to use for this filter. Valid keywords and values are: in endpoint_id_list, dist_name, group_name, alias, hostname, username: List of strings. endpoint_status: Permitted values are connected or disconnected ip_list: List of strings, for example 192.168.5.12. platform: Permitted values are windows, linux, macos, or android isolate: Permitted values are isolated or unisolated. scan_status: Permitted values are none, pending, in_progress, canceled, aborted, pending_cancellation, success, or error. gte / lte first_seen and last_seen: Integer in timestamp epoch milliseconds. Value that this filter must match. The contents of this field will differ depending on the endpoint field that you specified for this filter: endpoint_id_list, dist_name, hostname, alias, group_name: List of strings. endpoint_status: Must contain only the following valid values: connected or disconnected ip_list: String list of IP addresses. platform: Must contain only the following valid values: windows, linux, macos, or android. isolate: Must contain only the following valid values: isolated or unisolated. The alias name you want to set or modify. Note: If you send an empty field, the current alias name is deleted. Successful response true=The alias name was set or modified successfully. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.4.10 |Assign Tags Assign one or more tags to one or more endpoints. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. An array of filter fields. String that identifies the field the filter is matching. Filters are based on the following keywords: endpoint_id_list: List of endpoint IDs. last_seen: When an endpoint was last seen. first_seen: When an endpoint was first seen. dist_name: Distribution / Installation Package name. ip_list: List of IP addresses. platform: Platform name. alias: Alias name. hostname: Hostname. isolate: If the endpoint was isolated. username: Name of user. scan_status: Status of the scan. group_name: Group name the agent belongs to. endpoint_status: Status of the endpoint ID. operational_status: Operational status. public_ip_list: List of public IP addresses. String that identifies the comparison operator you want to use for this filter. Valid keywords and values are: in endpoint_id_list, dist_name, group_name, alias, hostname, username, operational_status: List of strings. endpoint_status: Permitted values are connected, lost, disconnected, uninstalled. ip_list, public_ip_list: List of strings, for example "192.168.5.12". platform: Permitted values are windows, linux, macos, android, ios. isolate: Permitted values are isolated or unisolated. scan_status: Permitted values are none, pending, in_progress, canceled, aborted, pending_cancellation, success, or error. operational_status: Permitted values are protected, partially_protected, unprotected. gte / lte first_seen and last_seen: Integer in timestamp epoch milliseconds. Value that this filter must match. The contents of this field will differ depending on the endpoint field that you specified for this filter: endpoint_status: Must contain only the following valid values: connected, disconnected, lost, or uninstalled. operational_status: Must contain only the following valid values: protected, partially_protected, unprotected. ip_list, public_ip_list: String list of IP addresses. platform: Must contain only the following valid values: windows, linux, macos, android, or ios. isolate: Must contain only the following valid values: isolated or unisolated. scan_status: Must contain only the following valid values: none, pending, in_progress, canceled, aborted, pending_cancellation, success, or error. The tag you want to assign. Successful response true=The tag name was assigned successfully. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. x Internal server error. A unified status for API communication type errors. 2.1.4.11 |Remove Tags Remove one or more tags from one or more endpoints. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. A dictionary containing the following API request fields. Array of filter fields. String that identifies the field the filter is matching. Filters are based on the following keywords: endpoint_id_list: List of endpoint IDs. endpoint_status: Status of the endpoint ID. dist_name: Distribution / Installation Package name. ip_list: List of IP addresses. group_name: Group name the agent belongs to. platform: Platform name. alias: Alias name. isolate: If the endpoint was isolated. hostname: Hostname. String that identifies the comparison operator you want to use for this filter. Valid keywords and values are: in endpoint_id_list, dist_name, group_name, alias, hostname, username: List of strings. endpoint_status: Permitted values are connected or disconnected. ip_list: List of strings, for example 192.168.5.12. platform: Permitted values are windows, linux, macos, or android. isolate: Permitted values are isolated or unisolated. scan_status: Permitted values are none, pending, in_progress, canceled, aborted, pending_cancellation, success, or error. gte / lte first_seen and last_seen: Integer in timestamp epoch milliseconds. Value that this filter must match. The contents of this field will differ depending on the endpoint field that you specified for this filter: endpoint_id_list, distribution_name, hostname, alias, group_name: List of strings. endpoint_status: Must contain only the following valid values: connected or disconnected ip_list: String list of IP addresses. platform: Must contain only the following valid values: windows, linux, macos, or android. isolate: Must contain only the following valid values: isolated or unisolated. The tag you want to remove. Successful response true=tag name removed successfully. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Internal server error. A unified status for API communication type errors. 2.1.4.12 |Get Endpoint Gets a list of filtered endpoints. The response is concatenated using AND condition (OR is not supported). The maximum result set size is 100. Offset is the zero-based number of endpoints from the start of the result set. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. A dictionary containing the API request fields. An empty dictionary returns all results. Array of filter fields. Identifies the field the filter is matching. Filters are based on the following keywords: endpoint_id_list: List of endpoint IDs. endpoint_status: Status of the endpoint ID. dist_name: Distribution / Installation Package name. first_seen: When the agent was first seen. last_seen: When the agent was last seen. ip_list: List of IP addresses. group_name: Group name the agent belongs to. platform: Platform name. alias: Alias name. isolate: If the endpoint was isolated. hostname: Host name. public_ip_list: Public IP addresses that correlate to the last IPv4 address from which the XDR agent connected (know as Last Origin IP). Identifies the comparison operator you want to use for this filter. Valid keywords and values are: in endpoint_id_list, dist_name, group_name, alias, hostname, username, public_ip_list: List of strings. endpoint_status: Permitted values are: connected, disconnected, lost, or uninstalled ip_list: List of strings. For example: "192.168.5.12". platform: Permitted values are: windows, linux, macos, android. isolate: Permitted values are: isolated or unisolated. scan_status: Permitted values are: none, pending, in_progress, canceled, aborted, pending_cancellation, success, or error. gte / lte first_seen and last_seen: Timestamp epoch milliseconds. Value that this filter must match. Valid keywords: endpoint_status: String. Permitted values are: connected, disconnected, lost, or uninstalled ip_list: List of strings. platform: String. Permitted values are: windows, linux, macos, android. isolate: String. Permitted values are: isolated or unisolated. scan_status: String. Permitted values are: none, pending, in_progress, canceled, aborted, pending_cancellation, success, or error. first_seen and last_seen: Integer. Timestamp epoch milliseconds. Represents the start offset within the query result set from which you want endpoints returned. Endpoints are returned as a zero-based list. Any endpoint indexed less than this value is not returned in the final result set and defaults to zero. Represents the end offset within the result set after which you do not want endpoints returned. Endpoint in the endpoint list that is indexed higher than this value is not returned in the final results set. Defaults to 100, which returns all endpoints to the end of the list. Identifies the sort order for the result set. Identifies the field you want to sort by. Case-sensitive. Whether you want to sort in ascending (ASC) or descending (DESC) order. Case-sensitive. JSON object containing the query result. Number of total results of this filter without paging. Number of endpoints actually returned as result. A list of endpoints. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.4.13 |Initiate Forensics Triage Initiate forensics triage for the specified agents. Maximum of 10 concurrent triage actions at a time. Specified agents must have Forensics License enabled. Specified agents must be the same OS, Windows or macOS, but not a mixture of both. Specified configuration must have type "Online = True". Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. List of agents to run forensics triage on. UUID of the triage configuration. If none is specified, the default configuration is used for this action. Unique ID for triage action. List of agent IDs that successfully received the triage action. List of agent IDs that did not successfully receive the triage action. Payment Required Internal Server Error 2.1.5 |Response Action APIs for response actions 2.1.5.1 |Restore File Restore a quarantined file on a requested endpoints. When filtering by multiple fields: Response is concatenated using AND condition (OR is not supported). Maximum result set size is 100. Offset is the zero-based number of cases from the start of the result set. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. A dictionary containing the API request fields. String that represents the file in hash. Hash must be a valid SHA256. String that represents the endpoint ID. Note: if it is not specified, the request will run restore on all endpoints which relate to the quarantined file you defined. String representing the case ID. When included in the request, the Restore File action will appear in the Cortex Cloud Case View Timeline tab. Successful response Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.5.2 |File Retrieval Details View the API required to call in order to download the file retrieved by the Retrieve File API request according to the action ID. The response contains a file hash you need to download and then unzip to view: Download the file. Unzip the file: unzip /tmp/file.zip Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. A dictionary containing the API request fields. The action ID of the Retrieve File API response. Successful response API required to call in order to download the retrieved result. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.5.3 |Allow List Files Add files which do not exist in the allow or block lists to an allow list. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. A dictionary containing the API request fields. A list of hashed files you want to add to the allow list. Hash must be a valid SH256. Additional information regarding the action. The case ID related to the hash. When included in the request, the Allow List action will appear in the Cortex Cloud Case View Timeline tab. Successful response true=File successfully added to the allow list. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.5.4 |Get Quarantine Status Retrieve the quarantine status for specified files. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. Array of endpoint IDs, filepaths, and file hash. File hash. Must be a valid SHA256. Successful response The file's status. True: The file is quarantined. False: The file is not quarantined. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.5.5 |Quarantine Files Quarantine file on selected endpoints. You can select up to 1000 endpoints. Note: A success response means that the request reached the defined endpoints, however if the file was not found there, no quarantine action will take place. To ensure if the file has been quarantined, check the Cortex XDR Action Center. When filtering by multiple fields: Response is concatenated using AND condition (OR is not supported). Maximum result set size is 1000. Offset is the zero-based number of cases from the start of the result set. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. A dictionary containing the API request fields. An array of filter fields. String that identifies a list the filters match. Filters are based on the following keywords: endpoint_id_list: List of endpoint IDs. String that identifies the comparison operator you want to use for this filter. Valid keywords and values are: in endpoint_id_list: List of strings Value that this filter must match. Valid keywords: endpoint_id_list: Array of strings The path of the file you want to quarantine. You must enter a proper path and not symbolic links. Case ID. When included in the request, the Quarantine File action will appear in the Cortex Cloud Case View Timeline tab. Successful response JSON object containing the query result. ID of action to quarantine selected endpoints. Response only indicates the request was successfully sent to the endpoint. To track if the file quarantine succeeded either: In Cortex XDR console, navigate to Response > Action Center and search for the action ID. Make sure the Action ID field is selected in the table Layout settings. Send a Get Action Status API request. Integer representing whether the action: Number of endpoints included in the request. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.5.6 |Block List Files Add files which do not exist in the allow or block lists to a block list. You can view the block list in the UI at Investigation & Response > Response > Action Center > Block List. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. A dictionary containing the API request fields. A list of hashed files you want add to a block list. Hash must be a valid SH256. Additional information regarding the action. The case ID related to the hash. When included in the request, the Block List action appears in the Cortex Cloud Case View Timeline tab. Successful response true=File successfully added to block list. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.5.7 |Unisolate Endpoints Reverse the isolation of one or more endpoints in single request. Note: You can only send a request with either endpoint_id to unisolate one endpoint or with filters to unisolate more than one endpoint. An error is raised if you try to use both endpoint_id and the filters. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. A dictionary containing the API request fields. An array of filter fields for unisolating a number of endpoints at once. Note: This field is only required if unisolating more than one endpoint. String that identifies a list the filters match. Filters are based on the following keywords: endpoint_id_list: List of endpoint IDs. String that identifies the comparison operator you want to use for this filter. Valid keywords and values are: in endpoint_id_list: List of strings Value that this filter must match. Valid keywords: The ID of the endpoint to unisolate. Note: this field is only required if unisolating one endpoint. Case ID. When included in the request, the Unisolate Endpoints action will appear in the Cortex Cloud Case View Timeline tab. Successful response JSON object containing the query result. ID of the action to unisolate selected endpoints. Response only indicates the request was successfully sent to the endpoint. To track if the endpoint was restored either: In the Cortex XDR console, navigate to Response > Action Center > Isolation and search for the action ID. Make sure the Action ID field is selected in the table Layout settings. Send a Get Action Status API request. Number of endpoints included in the request. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.5.8 |Cancel Scan Endpoints Cancel the scan of selected endpoints. A scan can only be aborted if the selected endpoints are in Pending or in Progress status. When filtering by multiple fields: Response is concatenated using AND condition (OR is not supported). Offset is the zero-based number of endpoints from the start of the result set. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. A dictionary containing the API request fields. An array of filter fields to filter which endpoints to cancel scanning. To cancel scan of all endpoints, use the value "all". String that identifies a list the filters match. Filters are based on the following keywords: endpoint_id_list: List of endpoint IDs. dist_name: Name of the distribution list. first_seen: When an endpoint was first seen. last_seen: When an endpoint was last seen. ip_list: List of IP addresses. group_name: Name of endpoint group. platform: Type of operating system. alias: Endpoint alias name. isolate: If an endpoint has been isolated. hostname: Name of host. username: Name of user. String that identifies the comparison operator you want to use for this filter. Valid keywords and values are: in endpoint_id_list, dist_name, group_name, alias, hostname, username: List of strings ip_list: List of strings, for example 192.168.5.12 platform: Permitted values are windows, linux, macos, android isolate: Permitted values are isolated or unisolated scan_status: Permitted values are none, pending, in_progress, canceled, aborted, pending_cancellation, success, or error gte / lte first_seen and last_seen: Integer in timestamp epoch milliseconds. Value that this filter must match. Valid keywords: first_seen, last_seen: Integer in timestamp epoch milliseconds, UTC timezone endpoint_id_list, dist_name, hostname, alias, group_name: List of strings isolate: Permitted values are isolated or unisolated. platform: Permitted values are windows, linux, macos, or android. Case ID. When included in the request, the Cancel Scan Endpoints action will appear in the Cortex Cloud Case View Timeline tab. Successful response JSON object containing the query result. ID of action to cancel scan selected endpoints. Response only indicates the request was successfully sent to the endpoint. To track if the scan succeeded either: In Cortex XDR console, navigate to Response > Action Center and search for the action ID. Make sure the Action ID field is selected in the table Layout settings. Send a Get Action Status API request. Number of endpoints included in the request. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.5.9 |Scan Endpoints Run a scan on selected endpoints. Response is concatenated using AND condition (OR is not supported). Offset is the zero-based number of cases from the start of the result set. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. A dictionary containing the API request fields. An array of filter fields. To scan all endpoints, use the value all. Case ID. When included in the request, the Scan Endpoints action will appear in the Cortex Cloud Case View Timeline tab. Successful response JSON object containing the query result. ID of action to scan selected endpoints. Response only indicates the request was successfully sent to the endpoint. To track if the scan was successful either: In Cortex XDR console, navigate to Response > Action Center > All Actions and search for the action ID. Make sure the Action ID field is selected in the table Layout settings. Send a Get Action Status API request. Number of endpoints included in the request. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.5.10 |Get Action Status Retrieve the status of the requested actions according to the action ID. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. A dictionary containing the API request fields. Action ID of the selected request. Successful response JSON object containing the query result. Bad Request. Got an invalid JSON. Returns all error messages the agent returns to allow for easier analysis. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.5.11 |Retrieve File Retrieve files from selected endpoints. You can retrieve up to 20 files, from no more than 10 endpoints. Response is concatenated using AND condition (OR is not supported). Offset is the zero-based number of cases from the start of the result set. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. A dictionary containing the API request fields. An array of filter fields. Identifies the field the filter must match: endpoint_id_list Identifies the comparison operator you want to use for this filter. Valid keywords and values are: in 'endpoint_id_list' Value that this filter must match. Valid keywords: 'endpoint_id_list': List of strings. One of the operating system types must be included. Case ID. When included in the request, the Retrieve File action will appear in the Cortex Cloud Case View Timeline tab. JSON object containing the query result. ID of action to retrieve files from selected endpoints. Response only indicates the request was successfully sent to the endpoint. To track if the file was retrieved successfully either: in the Cortex XDR console, navigate to Response > Action Center > Isolation and search for the action ID. Make sure the Action ID field is selected in the table Layout settings by selecting the three vertical dots. To view the file, send a File Retrieval Details request. Number of endpoints included in the request. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.5.12 |Isolate Endpoints Isolate one or more endpoints in a single request. Request is limited to 1000 endpoints. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Security, you need the Cortex Cloud Runtime Security add-on. A dictionary containing the API request fields. Array of filtered fields for isolating a number of endpoints at once. Note: Only required if isolating more than one endpoint. Identifies a list the filters match. Filters are based on the following keywords: endpoint_id_list: List of endpoint IDs. Identifies the comparison operator you want to use for this filter. Valid keywords and values are: in endpoint_id_list —List of strings Value that this filter must match. Valid keywords: endpoint_id_list: List of strings Identifies the endpoint to isolate. Note: Only required if isolating one endpoint. The case ID. When included in the request, the Isolate Endpoints action will appear in the Cortex Cloud Case View Timeline tab. JSON object containing the query result. Action ID to scan selected endpoints. The response only indicates the request was successfully sent to the endpoint. To track if the isolation succeeded either: In the Cortex XDR console, navigate to Response > Action Center > Isolation and search for the action ID. Make sure the Action ID field is selected in the table Layout settings by selecting the vertical ellipses. Send a Get Action Status request. Number of endpoints included in the request. Bad Request. Got an invalid JSON. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, ID, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.5.13 |Get triage presets Get all triage preset information including triage name, platform, description, created by, and triage type. Required license: In Cortex Cloud Runtime Security, requires the Forensics add-on. Not supported in Cortex Cloud Posture Management. Preset/configuration UUID Triage operating system/platform: Windows or macOS Triage was created by Triage type: Online, Offline, Online/Offline 2.1.6 |Script execution APIs executing script 2.1.6.1 |Run Snippet Code Script Initiate a new endpoint script execution action using provided snippet code. Cortex XDR supports sending your request in Base64. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. An array of filter fields for running the script on a number of endpoints at once. String that identifies a list the filters match. Filters are based on the following keywords: endpoint_id_list: List of endpoint IDs. String that identifies the comparison operator you want to use for this filter. Valid keywords and values are: in endpoint_id_list: List of strings Value that this filter must match. The timeout in seconds for this execution. Default value is 600. Section of a script you want to initiate on an endpoint. Case ID. When included in the request, the Run Snippet Code Script action will appear in the Cortex Cloud Case View Timeline tab. Successful response JSON object containing the query result. ID of the action initiated. ID will be used as a reference to track in the action center. Number of endpoints the action was initiated on. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.6.2 |Run Script Initiate a new endpoint script execution action using a script from the script library. The script can be run on up to 1000 endpoints. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. Array of filter fields for running the script on a number of endpoints at once. String that identifies a list the filters match. Filters are based on the following keywords: endpoint_id_list: List of endpoint IDs. String that identifies the comparison operator you want to use for this filter. Valid keywords and values are: in endpoint_id_list: List of strings Value that this filter must match. GUID, unique identifier of the script, returned by the Get Scripts API per script. Dictionary containing the parameter name, key, and its value for this execution, value. You can obtain these values by running Get Script Metadata API. Timeout in seconds for this execution. Default value is 600. Case ID. When included in the request, the Run Script action will appear in the Cortex Cloud Case View Timeline tab. Successful response JSON object containing the query result. ID of the action initiated. ID will be used as a reference to track in the action center. Number of endpoints the action was initiated on. Integer representing whether the action: Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.6.3 |Get Script Metadata Get the full definitions of a specific script in the scripts library. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. Unique identifier of the script, returned by the Get Scripts API per script. Successful response JSON object containing the query result. Description of script. Timestamp of when the script was last modified. Name of the user who created the script. Whether the script has a high-risk outcome. Whether the script can be executed on Windows OS. Whether the script can be executed on Linux OS. Whether the script can be executed on macOS. GUID, global ID of the script, used toidentify the script when executing. name of the entry point selected for the script defined as run. When the script_output_type is a dictionary an array with friendly_name, name, and type for each output is returned. The field is empty in all other cases. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.6.4 |Get Script Execution Status Retrieve the status of a script execution action. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. Identifier of the action, can be found in Cortex XDR console Response > Action Center > Action ID field. Successful response JSON object containing the query result. General status of the action, considering the status of all the endpoints. Number of endpoints in pending status. Number of endpoints in 'canceled' status. Number of endpoints in 'in progress' status. Number of endpoints in 'timeout' status. Number of endpoints in 'failed' status. Number of endpoints in 'completed successfully' status. Number of endpoints in 'pending abort' status. Number of endpoints in 'aborted' status. Number of endpoints in 'expired' status. Error message regarding permissions for running APIs or stating that the action doesn't exist. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.6.5 |Get Scripts Get a list of scripts available in the scripts library. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. An empty dictionary returns all results. An array of filter fields. Identifies a list the filters match. Filters are based on the following keywords: name: String of the script name. description: String of the script description. created_by: String of the user name of who created the script. script_uid: GUID, global ID of the script, used to identify the script when executing. modification_date: Timestamp of when the script was last modified. windows_supported: Whether the script can be executed on Windows operating system. linux_supported: Whether the script can be executed on Linux operating system. macos_supported: Whether the script can be executed on Mac operating system. is_high_risk: Whether the script has a high-risk outcome. String that identifies the comparison operator you want to use for this filter. Valid keywords and values are: in name, description, created_by, script_uid, windows_supported, linux_supported, macos_supported, is_high_risk: List of strings. gte / lte modification_date: Integer in timestamp epoch milliseconds. Value that this filter must match. Successful response JSON object containing the query result. Number of total results of this filter without paging. Number of scripts returned as result. An array of scripts. Description of script. Timestamp of when the script was last modified. Name of the user who created the script. Whether the script has a high-risk outcome. Whether the script can be executed on Windows OS. Whether the script can be executed on Linux OS. Whether the script can be executed on macOS. GUID, global ID of the script, used to identify the script when executing. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.6.6 |Get Script Execution Results Retrieve the results of a script execution action. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. Action ID. This can be found in the Cortex XDR console Response > Action Center > Action ID field. Successful response JSON object containing the query result. Name of the script executed. Description of the script executed. For each input parameter used in this execution, an array of name and value. Timestamp in which the action was initiated. Number of endpoints included in this action according to the filter used to select them. Error message regarding permissions for running APIs. For each endpoint Cortex XDR displays any returned value by the script. The number of the results and their name are dynamic per script. Endpoint IP address. Endpoint status. Domain to which the endpoint belongs. Execution status of this endpoint. The STDOUT + STDERR logged by the script during this execution. Number of successfully retrieved files. Number of files failed to retrieve. Timestamp of when the retrieved files will be deleted from the server. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.6.7 |Get Script Execution Result Files Get the files retrieved from a specific endpoint during a script execution. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. Identifier of the action, can be found in Cortex XDR console Response > Action Center > Action ID field. Successful response JSON object containing the query result. A signed public link to a zip file containing the retrieved files. Link expires after 10 minutes. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.6.8 |Get Script Code Get the code of a specific script in the script library. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. Unique identifier of the script, returned by the Get Scripts API per script. Successful response JSON object containing the query result. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.7 |Audit log APIs for audit logs 2.1.7.1 |Get Audit Management Log Get audit management logs. Response is concatenated using AND condition (OR is not supported). Maximum result set size is 100. Offset is the zero-based number of cases from the start of the result set. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. An empty dictionary returns all results. Array of filter fields. Filter is based on the following keywords: email: User's email address. type: Type of audit log. sub_type: Subtype of audit log. result: Result type. timestamp: Log timestamp. Identifies the comparison operator you want to use for this filter. Valid keywords and values are: in email, type, sub_type, result: List of strings gte / lte timestamp: Integer in timestamp epoch milliseconds Value that this filter must match. timestamp: Integer representing the number of milliseconds after the Unix epoch, UTC timezone. All other fields require a string value. In the case of in operator, the value is an array. An integer representing the starting offset within the query result set from which you want management logs returned. Management logs are returned as a zero-based list. Any log indexed less than this value is not returned in the final result set and defaults to zero. An integer representing the end offset within the result set after which you do not want management logs returned. Logs in the management log list that are indexed higher than this value are not returned in the final results set. Defaults to 100, which returns all logs to the end of the list. Identifies the sort order for the result set. By default the sort is defined as creation-time and desc. The field you want to sort by. Whether to sort in ascending or descending order. Successful response JSON object containing the query result. Number of total results of this filter without paging. Number of returned items. List of audit items. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.7.2 |Get Audit Agent Report Get agent event reports. Response is concatenated using AND condition (OR is not supported). Maximum result set size is 100. Offset is the zero-based number of cases from the start of the result set. A dictionary containing the API request fields. An empty dictionary returns all results. An array of filter fields. Identifies a list. Filters are based on the following keywords: endpoint_id: The endpoint ID. endpoint_name: The endpoint name. type: Type of report. sub_type: Subtype of report. result: Result type. timestamp: Report timestamp. domain: Domain of the agent. xdr_version: XDR version. category: Type of event category. timestamp: Integer in timestamp epoch milliseconds identifies the comparison operator you want to use for this filter. Valid keywords and values are: in endpoint_id, endpoint_name, type, sub_type, result, domain, xdr_version, category: List of strings gte / lte Value that this filter must match: timestamp: Integer representing the number of milliseconds after the Unix epoch, UTC timezone. All other fields require a string value. In the case of in operator, the value is a list of possible values enclosed in square brackets. category: Permitted values are: status, monitoring, or audit. An integer representing the starting offset within the query result set from which you want agent reports returned. Reports are returned as a zero-based list. Any report indexed less than this value is not returned in the final result set and defaults to zero. An integer representing the end offset within the result set after which you do not want agent reports returned. Reports in the agent report list that are indexed higher than this value are not returned in the final results set. Defaults to 100, which returns all reports to the end of the list. Identifies the sort order for the result set. The field you want to sort by. Whether to sort in ascending or descending order. JSON object containing the query result. Number of total results of this filter without paging. Number of returned items. List of audit items. Epoch time in milliseconds, UTC timezone. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, ID, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.8 |System management APIs for system management 2.1.8.1 |System Health Check Perform a health check of your Cortex Cloud environment. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The condition of your Cortex environment. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.8.2 |Get Tenant Info Get your tenant license information. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management List of available licenses, number of devices, and purchased add-ons on your tenant. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal Server Error 2.1.8.3 |Get Users Retrieve a list of the current users in your environment. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management JSON object containing the query result. Email address of the user. First name of the user. Last name of the user. Role name associated with the user. Timestamp of when the user last logged in. Name of user groups associated with the user, if applicable. Name of scope associated with the user, if applicable. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.8.4 |Get Roles Retrieve information about one or more roles created in your environment. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. List of one or more role names in your environment for which you want detailed information. JSON object containing the query result. Name of the role as it appears in the Management Console. List of permissions associated with this role. Timestamp of when the Role was created. Timestamp of when the Role was last updated. Email of the user who created the Role. Description of the Role, if available. Group names associated with the Role. Email addresses of users associated with the Role. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.8.5 |Get User Groups Retrieve a list of the current user emails associated with one or more user groups in your environment. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. List of one or more user group names for which you want the associated users. JSON object containing the query result. Name of the User Group. Description of the User Group, if available. Name of the User Group as it appears in the Management Console. Timestamp of when the User Group was created. Timestamp of when the User Group was last updated. List of email addresses belonging to the users associated with the User Group. Type of User Group. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.8.6 |Set a User Role Add or remove one or more users from a role. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. List of one or more user emails of users you want to add to or remove from a role. Name of the role you want to add a user to. Send an empty field to remove the user. JSON object containing the query result. Number of updated users. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal Server Error 2.1.8.7 |Get Risk Score Retrieve the risk score of a specific user or endpoint in your environment, along with the reason for the score. A dictionary containing the API request fields. Unique ID of a specific user or endpoint. User ID should be in the following format: netBIOS/samAccount Endpoint ID is the Cortex Agent ID. You can only request one ID at a time. JSON object containing the query result. Form of identification element. Identification value of the type field. The score assigned to the type. Normalization of the risk score. Details describing when and which case name affected the score. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.8.8 |Get Risky Users Retrieve a list of users with the highest risk score in your environment along with the reason affecting each score. JSON object containing the query result. Form of identification element. Identification value of the type field. The score assigned to the user. Normalization of the risk score. Details describing when and which case name affected the user score. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.8.9 |Get Risky Hosts Retrieve a list of endpoints with the highest risk score in your environment along with the reason for each score. JSON object containing the query result. Form of identification element. Identification value of the type field. The score assigned to the endpoint. Normalization of the risk score. Details describing when and which case name affected the endpoint score. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.9 |API keys APIs for managing API keys 2.1.9.1 |Get existing API keys Get a list of API keys filtered by expiration date, role, or ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management timestamp in milliseconds 64 byte random string An array of filter fields. Identifies the API key field the filter is matching. Filters are based on the following keywords: expiration: Time the API key expires in epoch milliseconds. roles: The role assigned to the API key at creation. Identifies the comparison operator you want to use for this filter. Valid keywords are: gte / lte operator is used with expiration field (Integer in timestamp epoch milliseconds). contains operator is used with roles field (Array of strings). in operator is used with id field (Array of integers). Value that this filter must match. The contents of this field will differ depending on the API key field that you specified for this filter: expiration: Integer representing the number of milliseconds after the Unix epoch, UTC timezone. roles: Array of strings representing the roles in the Cortex XSOAR system. id: Array of integers representing the API key IDs. Note: The total_count value contains all API Keys, including ones that have expired. 2.1.9.2 |Generate an API key Generate a new API key and define the roles assigned to it and whether the security level is standard or advanced. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management timestamp in milliseconds 64 byte random string A list of roles to be assigned to the API key. The security level of the API key. API keys with advanced security are hashed with a nonce and timestamp, which is useful for proprietary scripts and are intended to prevent replay attacks. Standard security API keys can be used as-is and are suitable for curl. Integer in timestamp epoch milliseconds. Default value is one week from the time of the API call. Maximum expiration date is six months from the time of the API call. 2.1.9.3 |Delete API keys Delete API keys by ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management timestamp in milliseconds 64 byte random string An array of filter fields. Identifies the API key field the filter is matching. Filters are based on the following keyword: id: The API key ID. Identifies the comparison operator you want to use for this filter. Valid keyword is: in id: Integer representing the API key ID. Array of API key IDs. The number of API keys deleted. 2.1.10 |Attack surface management APIs for attack surface management 2.1.10.1 |Get External Service Get service details according to the service ID. You can send up to 20 IDs. A dictionary containing the API request fields. Represents the service ID you want to get details for. JSON object containing the query result. Service details according to the service ID. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.10.2 |Get All Services Get a complete or filtered list of all your external services. The maximum result limit is 500. An array of filter fields. String that identifies the service field the filter is matching. Filters are based on the following case-sensitive keywords: active_classifications business_units_list externally_detected_providers externally_inferred_cves inactive_classifications service_type_list String that identifies the comparison operator you want to use for this filter. Valid keywords and values are: contains / not_contains— use with externally_detected_providers, domain, externally_inferred_cves, active_classifications, inactive_classifications, service_name, service_type, protocol eq / neq— use with service_name, service_type, protocol, ip_address in — use with is_active, discovery_type, business_units_list, tags Value that this filter must match. The contents of this field will differ depending on the services field that you specified for this filter: active_classifications — String business_units_list — String or list of strings in the format "BU name" or "BU:BU name", for example '''Acme & Co, Inc.'' or '''BU:Acme & Co, Inc.'' discovery_type — String. Values are: colocated_on_ip, directly_discovered, unknown. externally_detected_providers — String externally_inferred_cves — String inactive_classifications — String ip_address — String ipv6_address— String is_active — String. Values are:yes, no protocol — string service_name — String service_type — String service_type_list — String tags — List of strings indicating the tags to filter on in the format "tag-family:tag-name", for example "AR:registered to you". Use this field with the value true to get vulnerability test results for the last 14 days for each service. Using this field will slow down the endpoint. An integer representing the start offset index of results. An integer representing the start offset index of results. Use this field to specify the number of results on a page when using page token pagination. Identifies the sort order for the result set. Can be either ASC (ascending order) or DESC (descending order). Default is ASC. Values are case sensitive. last_observed By default, case-sensitive, sort is defined as service_name. Bad Request. Got invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.10.3 |Get vulnerability tests Get a complete or filtered list of vulnerability tests. Results include details about each test, including the number of services confirmed vulnerable. An array of filter fields. Identifies the field the filter will match on. Identifies the comparison operator to use for this filter. The following list shows which operator can be used for each filter field: name: contains, eq, neq vulnerability_ids: contains, not_contains description: contains affected_software: contains, not_contains cwe_ids: contains, not_contains vendor_names: contains, not_contains severity_score: eq, neq, gte, lte epss_score: eq, neq, gte, lte count_vulnerable_services: eq, neq, gte, lte Value depends on the filter field used. name: string e.g. apache status: Enabled, Disabled vulnerability_ids: strings in the form of CVE IDs, such as CVE-1, CVE-2 description: string e.g. apache affected_software: strings cwe_ids: strings in the form of CWE IDs such as CWE-20 vendor_names: strings such as Cisco, Siemens severity_score: numbers, such as 2, 3.5 epss_score: numbers, such as 2, 3.5 count_vulnerable_services: integers, such as 1,2,5 2.1.10.4 |Bulk Update Vulnerability Tests Enable or disable vulnerability tests. To view vulnerability test results, use the Get All Services or Get Service Details endpoints. Names of tests, for example ["test1", "test2", "test3"] 2.1.11 |XQL user datasets APIs for managing XQL user datasets. 2.1.11.1 |Define an XQL user dataset Define an XQL user dataset based on an existing BigQuery table created by the user. Note: BigQuery table must be an existing table under public_access_user. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management These APIs are only applicable from within the XSIAM Notebook environment. An existing BigQuery table name that was created by the user. 2.1.11.2 |Get created XQL user datasets Retrieve a list of all XQL user datasets created using the Cortex SDK. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management These APIs are only applicable from within the XSIAM Notebook environment. A list of created datasets. 2.1.11.3 |Delete an XQL user dataset Delete an XQL user dataset that was created by the Cortex SDK. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management These APIs are only applicable from within the XSIAM Notebook environment. The dataset name to be deleted. Define whether or not to delete the BigQuery table related to the dataset. 2.1.12 |Dataset Management APIs for managing datasets 2.1.12.1 |Add Dataset Add a dataset of type lookup with the specified name and schema. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The designated name of the dataset. Dataset type. Currently only lookup is supported. The schema of the dataset in a comma-separated list of JSON pairs where the key is the field name and the value is the field type. Name of the dataset added. 2.1.12.2 |Delete a dataset Delete a dataset with the specified name. The following dataset types can be deleted: Lookup, Raw, User, Snapshot, and Correlation. You can only delete a dataset with dependencies by setting force to TRUE. Note: The System dataset and other protected datasets cannot be deleted. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The name of the dataset to be deleted. Warning: Setting this to True forces deletion even when there are dependencies. 2.1.12.3 |Get all datasets Retrieve a list of all the datasets and their properties. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Dataset type. Can be one of the following: System, Lookup, Raw, User, Snapshot, Correlation, System Audit. Log update type. Can be one of the following: Logs (event logs are updated continuously), State (the current state is updated periodically). Integer in timestamp epoch milliseconds. When the data in the dataset was last updated. Number of dats the data is stored in the tenant, which is comprised of hot_range + cold_range. The time period of the hot storage from the start date to the end date. Integer in timestamp epoch milliseconds. The time period of the cold storage from the start date to the end date. Actual size of the data (in bytes) that is stored in the tenant. This number is dependent on the events stored in the hot storage. For the xdr_data dataset, where the first 31 days of storage are included with your license, the first 31 days are not included in the total_size_stored number. Average daily amount stored (in bytes) in the tenant. This number is dependent on the events stored in the hot storage. Number of total events/logs that are stored in the tenant. This number is dependent on the events stored in the hot storage. Average size (in bytes) of a single event in the dataset (total_size_stored divided by the total_events). This number is dependent on the events stored in the hot storage. Time to live. Defines when lookup entries expire and are removed automatically from the lookup dataset. whether the dataset is configured to use as your default query target in XQL Search, so when you write your queries you do not need to define a dataset. Can be one of the following: True, False. 2.1.13 |Lookup Datasets APIs for lookup datasets 2.1.13.1 |Add or update data in a lookup dataset Add or update data in a lookup dataset. When updating data, any field not specified in the data field, but specified on at least one of the rows, will be set to None. The /public_api/xql/lookups/add_data/ endpoint does not support concurrent edits. Sending concurrent calls to this endpoint can cause data to be unintentionally overwritten or deleted. To allow sufficient time for each API call to complete its operation before initiating another one, assume that 1000 entries can be added per API every 10 seconds. The maximum size of a lookup dataset is 50 MB. Attempting to exceed this limit will fail. Requests time out after three minutes. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Unique dataset name The fields used to identify existing records. If there is not an exact match to the key_fields specified, a new row is created. When you specify key_fields, these fields are mandatory in data entries. When key_fields are not specified, existing data entries are not updated, and new entries are added with the specified data. Key-value pairs of data entries. 2.1.13.2 |Remove data from a lookup dataset Remove data from a dataset based on the specified parameters. If any one of the filter sets are not found, the API does not delete any data. The /public_api/xql/lookups/remove_data/ endpoint does not support concurrent edits. Sending concurrent calls to this endpoint can cause data to be unintentionally overwritten or deleted. To allow sufficient time for each API call to complete its operation before initiating another one, assume that 1000 entries can be added per API every 10 seconds. All lookup entries matching any of the filter blocks are deleted. To match a filter block, a lookup entry must match all the specified fields as if there were an AND operator between them. Requests time out after three minutes. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The name of the dataset to delete. Key-value pairs of fields to query in datasets. A lookup entry must match all the specified fields as if there were an AND operator between them. You can use one or more fields, up to the number of fields in the schema. Number of entries deleted successfully. 2.1.13.3 |Get data from a lookup dataset Get data from a lookup dataset according to the specified filter fields. All lookup entries matching any of the filter blocks are returned. To match a filter block, a lookup entry must match all the specified fields as if there were an AND operator between them. If no filters are specified, return all lookup entries. The maximum number of entries returned is 10,000. Requests time out after three minutes. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Name of the dataset to query. Key-value pairs of fields to query in a dataset. A lookup entry must match all the specified fields as if there were an AND operator between them. You can use one or more fields, up to the number of fields in the schema. The maximum number of results to return. If this is not specified, return all lookup entries that match the filter criteria. Number of entries that match the filter. Total number of entries. 2.1.14 |Authentication settings APIs for authentication settings, such as IdP and SSO 2.1.14.1 |Create authentication settings for IdP SSO or metadata URL Create authentication settings for IdP SSO or metadata URL. You must include either the metadata_url field or all of the following fields: idp_sso_url, idp_issuer, and idp_certificate. You must have Instance Administrator permissions to run this endpoint. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The name of the SSO integration. The default role automatically assigned to every user who authenticates to Cortex using SAML. This is an inherited role and is not the same as a direct role assigned to the user. If a role with the same name exists on both Cortex Gateway and the tenant, the role will mapped to the role from the tenant. If you want to use specifically the role from Cortex Gateway, use the is_account_role parameter set to true. Whether the role was created in Cortex Gateway or in the tenant. When the value is true, the role was created in Cortex Gateway. When configuring the first SSO, this parameter should be included as empty because it is the default SSO and has a fixed, read-only value. For additional SSOs, specify this IdP with an email domain (user@). When logging in, users are redirected to the IdP associated with their email domain or to the default IdP if no association exists. These IdP attribute mappings are dependent on your organization's IdP. The IdP attribute mapped to the user's email address in the Syslog server. The IdP attribute mapped to the user's first name. The IdP attribute mapped to the user's last name. The IdP attribute mapped to the user's group membership for authorization. Note: Cortex requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a comma-separated list), by default, you must configure IdP to send the Group CN (Common Name) instead. The advanced settings are optional to configure and some are specific for a particular IdP. The URL for a specific page that you want users to be directed to after they've been authenticated by your organization's IdP and log in to Cortex. The URL of the IdP's Single Logout endpoint. This ensures that when a user initiates a logout from Cortex, the identity provider logs the user out of all applications in the current identity provider login session. The Syslog server's public X.509 certificate in PEM format for IdP validation. The Syslog server's private key in PEM format for signing SAML responses. (This is mostly required for ADFS) Whether to remove the RequestedAuthnContext parameter from SAML requests. If true, allows users to log in by using additional authentication methods. Whether to force users to reauthenticate to access the Cortex tenant if requested by the IdP, even if they already authenticated to access other applications. The login URL of your IdP and should be copied from your SAML integration configuration on the IdP. For example: Okta: https://cortex-test.okta.com/app/cortex-test/eacbt6b2jj08CasdUQ7sdf15d7/sso/SAML Microsoft Azure: https://login.microsoftonline.com/6a5a9780-96a4-41ef-bf45-0535d8a70025/saml2 The Idp's public X.509 digital certificate in PEM format for verification, which is copied from your organization's IdP. The unique identifier of the IdP issuing SAML assertions, which is copied from your organization's IdP. The metadata URL provides information about hte IdP's capabilities, endpoints, keys, and more. For example: Okta: https://cortex-test.okta.com/app/exkbuuzw77Bh04V6M6b8/sso/saml/metadata Microsoft Azure: https://login.microsoftonline.com/6a5a9780-96a4-41ef-bf45-0535d8a70025/saml2/metadata Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.14.2 |Update authentication settings Update existing authentication settings. To update the default domain, include empty value for both current_domain_value and new_domain_value. You must have Instance Administrator permissions to run this endpoint. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The name of the SSO integration. The default role automatically assigned to every user who authenticates to Cortex using SAML. This is an inherited role and is not the same as a direct role assigned to the user. If a role with the same name exists on both Cortex Gateway and the tenant, the role will mapped to the role from the tenant. If you want to use specifically the role from Cortex Gateway, use the is_account_role parameter set to true. Whether the role was created in Cortex Gateway or in the tenant. When the value is true, the role was created in Cortex Gateway. The domain whose authentication settings you want to update. If you want to update the domain value, include a new unique domain. These IdP attribute mappings are dependent on your organization's IdP. The IdP attribute mapped to the user's email address in the Syslog server. The IdP attribute mapped to the user's first name. The IdP attribute mapped to the user's last name. The IdP attribute mapped to the user's group membership for authorization. Note: Cortex requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a comma-separated list), by default, you must configure IdP to send the Group CN (Common Name) instead. The advanced settings are optional to configure and some are specific for a particular IdP. The URL for a specific page that you want users to be directed to after they've been authenticated by your organization's IdP and log in to Cortex. The URL of the IdP's Single Logout endpoint. This ensures that when a user initiates a logout from Cortex, the identity provider logs the user out of all applications in the current identity provider login session. The Syslog server's public X.509 certificate in PEM format for IdP validation. The Syslog server's private key in PEM format for signing SAML responses. (This is mostly required for ADFS) Whether to remove the RequestedAuthnContext parameter from SAML requests. If true, allows users to log in by using additional authentication methods. Whether to force users to reauthenticate to access the Cortex tenant if requested by the IdP, even if they already authenticated to access other applications. The URL of your IdP's SSO, which is a fixed, read-only value based on your tenant's URL. If you are using this parameter, you must also specify: idp_certificate and idp_issuer. The Idp's public X.509 digital certificate in PEM format for verification, which is copied from your organization's IdP. The unique identifier of the IdP issuing SAML assertions, which is copied from your organization's IdP. Specify your IdP SSO URL, which is a fixed, read-only value based on your tenant's URL. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.14.3 |Delete authentication settings by domain Delete all authentication settings for the specified domain. **Note: ** The first configuration on the tenant is the default configuration and cannot be deleted. You must have Instance Administrator permissions to run this endpoint. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The domain whose authentication settings you want to delete. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.14.4 |Get authentication settings for all configured domains Get all the authentication settings for every configured domain in the tenant. You must have Instance Administrator permissions to run this endpoint. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.14.5 |Get IdP metadata Get the metadata for all IdPs. You must have Instance Administrator permissions to run this endpoint. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.15 |Syslog servers APIs for managing syslog servers 2.1.15.1 |Create a syslog integration Create a new syslog integration. You must have View/Edit Alert Notification permissions to run this endpoint. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. Unique name for the syslog server integration. IP address or fully qualified domain name (FQDN) of the syslog server. The port number on which the syslog server listens for messages. Select a method of communication: TCP: No validation is made on the connection with the syslog server. However, if an error occurred with the domain used to make the connection, the Test connection will fail. UDP: No error checking, error correction, or acknowledgment. No validation is done for the connection or when sending data. TLS: Cortex validates the syslog server certificate and uses the certificate signature and public key to encrypt the data sent over the connection. Choose one of the syslog standard values. The value maps to how your syslog server uses the facility field to manage messages. For details on the facility field, see RFC 5424. The security_info parameters are necessary only when protocol is TLS. When using TLS for communication between Cortex and the syslog server, Cortex validates that the syslog receiver has a certificate. Specify the certificate name here. Whether to ignore certificate errors. For security reasons, this is not recommended. If you set this to true, logs will be forwarded even if the certificate contains errors. Binary string of the certificate. The query result upon error. HTTP response code. Additional information describing the error. Payment Required Internal Server Error 2.1.15.2 |Get all or filtered syslog servers Get a complete or filtered list of syslog servers. You must have View Alert Notification permissions to run this endpoint. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. An empty dictionary returns all results. Array of filter fields. Each JSON object must contain a field, operator, and value. String that identifies the syslog server field the filter is matching. Filters are based on the following case-sensitive keywords: String that identifies the comparison operator you want to use for this filter. Valid operator keywords and corresponding filter fields are: eq - used with name, id, address, and status Value that the filter must match. The contents of this field will differ depending on the website field that you specified for this filter: The number of syslog servers that are returned. The syslog server details. Syslog server integration name. IP address or fully qualified domain name (FQDN) of the syslog server. The port number on which the syslog server listens for messages. The communication protocol: TCP: No validation is made on the connection with the syslog server. However, if an error occurred with the domain used to make the connection, the Test connection will fail. UDP: No error checking, error correction, or acknowledgment. No validation is done for the connection or when sending data. TLS: Cortex validates the syslog server certificate and uses the certificate signature and public key to encrypt the data sent over the connection. The query result upon error. HTTP response code. Additional information describing the error. Payment Required Internal Server Error 2.1.15.3 |Update a syslog integration Update the details of the specified syslog integration. You must have View/Edit Alert Notification permissions to run this endpoint. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. ID of the syslog server Unique name for the syslog server integration. IP address or fully qualified domain name (FQDN) of the syslog server. The port number on which the syslog server listens for messages. Select a method of communication: TCP: No validation is made on the connection with the syslog server. However, if an error occurred with the domain used to make the connection, the Test connection will fail. UDP: No error checking, error correction, or acknowledgment. No validation is done for the connection or when sending data. TLS: Cortex validates the syslog server certificate and uses the certificate signature and public key to encrypt the data sent over the connection. Choose one of the syslog standard values. The value maps to how your syslog server uses the facility field to manage messages. For details on the facility field, see RFC 5424. The security_info parameters are relevant only when protocol is TLS. When using TLS for communication between Cortex and the syslog server, Cortex validates that the syslog receiver has a certificate. Specify the certificate name here. Whether to ignore certificate errors. For security reasons, this is not recommended. If you set this to true, logs will be forwarded even if the certificate contains errors. Binary string of the certificate. Whether the update was successful. The query result upon error. HTTP response code. Additional information describing the error. Payment Required Internal Server Error 2.1.15.4 |Delete all or filtered syslog integrations Delete all the syslog integrations or the ones who match the filter criteria. You must have View/Edit Alert Notification permissions to run this endpoint. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. An empty dictionary deletes all syslog servers. Array of filter fields. Each JSON object must contain a field, operator, and value. String that identifies the syslog server field the filter is matching. Filters are based on the following case-sensitive keywords: String that identifies the comparison operator you want to use for this filter. Valid operator keywords and corresponding filter fields are: eq - used with name Value that the filter must match. The contents of this field will differ depending on the website field that you specified for this filter: The query result upon error. HTTP response code. Additional information describing the error. Payment Required Internal Server Error 2.1.15.5 |Test syslog integration Tests a syslog integration's validity. You must have View Alert Notification permissions to run this endpoint. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A dictionary containing the API request fields. If you include the syslog_id of an existing syslog integration, it will try to load the certificate data from the database to test the existing syslog integration. Unique name for the syslog server integration. IP address or fully qualified domain name (FQDN) of the syslog server. The port number on which the syslog server listens for messages. Select a method of communication: TCP: No validation is made on the connection with the syslog server. However, if an error occurred with the domain used to make the connection, the Test connection will fail. UDP: No error checking, error correction, or acknowledgment. No validation is done for the connection or when sending data. TLS: Cortex validates the syslog server certificate and uses the certificate signature and public key to encrypt the data sent over the connection. Choose one of the syslog standard values. The value maps to how your syslog server uses the facility field to manage messages. For details on the facility field, see RFC 5424. The security_info parameters are relevant only when protocol is TLS. When using TLS for communication between Cortex and the syslog server, Cortex validates that the syslog receiver has a certificate. Specify the certificate name here. Whether to ignore certificate errors. For security reasons, this is not recommended. If you set this to true, logs will be forwarded even if the certificate contains errors. Binary string of the certificate. The query result upon error. HTTP response code. Additional information describing the error. Payment Required Internal Server Error 2.1.16 |Scheduled Queries APIs for managing scheduled queries 2.1.16.1 |Get scheduled queries Return a list of scheduled queries. You can return all scheduled queries or filter results. You can also return extended results with all details included. You must have Instance Administrator permissions to run this endpoint. An array of filter fields. Identifies the query field the filter is matching. Filters are based on the following keywords: Display the extended view of the queries, which includes additional fields. If this is false, the response does not include total_count or result_count. Extended fields may change in future versions. List of scheduled query IDs to retrieve. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.16.2 |Insert or update scheduled queries Insert new scheduled queries or update existing scheduled queries. You must have Instance Administrator permissions to run this endpoint. Note: You should use a unique query_definition_name for each scheduled query on each tenant. Upon successful insert or update, the reply returns each individual query_id with the query definitions. If the insert or update failed, the reply will include the scheduled query name and the error message. The query_id of the scheduled query that was inserted or updated. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.16.3 |Delete a scheduled query Delete scheduled queries. You must have Instance Administrator permissions to run this endpoint. Each JSON pair in the response is the scheduled query ID and the results of the deletion request. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.17 |Query Library APIs for managing XQL query libraries 2.1.17.1 |Get XQL Queries Retrieve a detailed list of XQL query libraries. You can filter by list of query names or by list of query tags. You must have Instance Administrator permissions to run this endpoint. Whether to retrieve the detailed information on each XQL query. An array of XQL query names to search for. Note: If searching by xql_query_names, you cannot search by xql_query_tags in the same call. An array of XQL tag names to search for. Note: If searching by xql_query_tags, you cannot search by xql_query_names in the same call. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.17.2 |Insert or update XQL queries Insert new XQL queries or update existing XQL queries. Note: You should use unique xql_query_name for each XQL query on a given tenant. You must have Instance Administrator permissions to run this endpoint. When the xql_query_name already exists on the tenant, this field defines whether or not to overwrite the existing XQL query with the new content. When true, the query will be overwritten. When false, the query will not be updated and an error will be returned. XQL query name should be unique. XQL query tags are optional List of XQL queries that were added. List of XQL queries that were updated. List of errors received from additions/updates. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.17.3 |Delete XQL Queries Delete XQL queries. You can filter by list of query names or by list of query tags. You must have Instance Administrator permissions to run this endpoint. List of XQL query names to delete. Note: If searching by xql_query_names, you cannot search by xql_query_tags in the same call. List of XQL query tags. Note: If searching by xql_query_tags, you cannot search by xql_query_names in the same call. Bad Request. Got an invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.18 |IOCs APIs for managing IOCs 2.1.18.1 |Get Indicators (IOCs) Get a list of IOCs. You can return all IOCs or filter results. You can also return extended results with all details included. The response is concatenated using AND condition (OR is not supported). The maximum result set size is >100. Offset is the zero-based number of incidents from the start of the result set. You must have Instance Administrator permissions to run this endpoint. An array of filter fields. Identifies the IOC field the filter is matching. Filters are based on the following keywords: indicator: Indicator. type: Indicator type. severity: Indicator severity. expiration_date: Expiration date in epoch milliseconds. default_expiration_enabled: Whether the default expiration is enabled. comment: Comment. reputation: Reputation level. reliability: Reliability level. Identifies the comparison operator you want to use for this filter. Valid keywords are: gte / lte expiration_date: Integer in timestamp epoch milliseconds EQ / NEQ indicator: String severity: String default_expiration_enabled: Boolean reputation: String reliability: String Value that this filter must match. The contents of this field will differ depending on the IOC field that you specified for this filter: indicator, comment: String. type: String, can be one of the following: hash, ip, path, domain_name, filename, mixed. severity: String, can be one of the following: SEV_010_INFO, SEV_020_LOW, SEV_030_MEDIUM, SEV_040_HIGH expiration_date: Integer representing the number of milliseconds after the Unix epoch, UTC timezone. default_expiration_enabled: Boolean value: true or false. comment: String. reputation: String, can be one of the following: good, bad, suspicious, unknown, no_reputation. reliability: String, can be one of the following: A, B, C, D, E, F, G. Integer representing the starting offset within the query result set from which you want indicators returned. Indicators are returned as a zero-based list. Any indicator indexed less than this value is not returned in the final result set and defaults to zero. Integer representing the end offset within the result set after which you do not want indicators returned. Indicators in the indicator list that are indexed higher than this value are not returned in the final results set. Defaults to >100, which returns all indicators to the end of the list. Bad Request. Got invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.18.2 |Insert or update IOCs Insert new IOCs or update existing IOCs. Note: The IOC rule_id is tenant specific and can't be used across tenants. Inserting IOCs with the same rule_id as an existing IOC on that tenant will overwrite the existing IOC. You must have Instance Administrator permissions to run this endpoint. List of IOC objects added. List of IOC objects updated. List of errors, if any. Bad Request. Got invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.18.3 |Delete Indicators (IOCs) Delete IOCs selected by filter. You must have Instance Administrator permissions to run this endpoint. An array of filter fields. Identifies the IOC field the filter is matching. Filters are based on the following keywords: indicator: Indicator. type: Indicator type. severity: Indicator severity. expiration_date: Expiration date in epoch milliseconds. default_expiration_enabled: Whether the default expiration is enabled. comment: Comment. reputation: Reputation level. reliability: Reliability level. Identifies the comparison operator you want to use for this filter. Valid keywords are: gte / lte expiration_date: Integer in timestamp epoch milliseconds EQ / NEQ indicator: String severity: String default_expiration_enabled: Boolean reputation: String reliability: String Value that this filter must match. The contents of this field will differ depending on the IOC field that you specified for this filter: indicator, comment: String. type: String, can be one of the following: hash, ip, path, domain_name, filename, mixed. severity: String, can be one of the following: SEV_010_INFO, SEV_020_LOW, SEV_030_MEDIUM, SEV_040_HIGH expiration_date: Integer representing the number of milliseconds after the Unix epoch, UTC timezone. default_expiration_enabled: Boolean value: true or false. comment: String. reputation: String, can be one of the following: good, bad, suspicious, unknown, no_reputation. reliability: String, can be one of the following: A, B, C, D, E, F, G. Bad Request. Got invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.19 |BIOCs APIs for managing BIOCs 2.1.19.1 |Get BIOCs Return a list of BIOCs. You can return all BIOCs or filter results. You can also return extended results with all details included.- The response is concatenated using AND condition (OR is not supported). The maximum result set size is >100. Offset is the zero-based number of incidents from the start of the result set. You must have Instance Administrator permissions to run this endpoint. An array of filter fields. Identifies the BIOC field the filter is matching. Filters are based on the following keywords: name: BIOC name. severity: BIOC severity level. type: BIOC type. is_xql: Whether or not the BIOC is XQL. comment: Comment. status: BIOC status. indicator: Indicator. mitre_technique_id_and_name: MITRE technique ID and name. mitre_tactic_id_and_name: MITRE tactic ID and name. Identifies the comparison operator you want to use for this filter. Valid keywords are: EQ / NEQ severity: String indicator: String IN mitre_technique_id_and_name: List of strings mitre_tactic_id_and_name: List of strings Value that this filter must match. The contents of this field will differ depending on the IOC field that you specified for this filter: name, comment: String. severity: String, can be one of the following: SEV_010_INFO, SEV_020_LOW, SEV_030_MEDIUM, SEV_040_HIGH type: String, can be one of the following: other, persistence, evasion, tampering, file_type_obfuscation, privilege_escalation, credential_access, lateral_movement, execution, collection, exfiltration, infiltration, dropper, file_privilege_manipulation, reconnaissance, discovery. is_xql: Boolean: true or false. status: String, can be one of the following: enabled, disabled. indicator: String or dictionary in the format you wrote it. mitre_technique_id_and_name: List of strings. mitre_tactic_id_and_name: List of strings. Integer representing the starting offset within the query result set from which you want BIOCs returned. BIOCs are returned as a zero-based list. Any BIOC indexed less than this value is not returned in the final result set and defaults to zero. Integer representing the end offset within the result set after which you do not want BIOCs returned. BIOCs in the BIOC list that are indexed higher than this value are not returned in the final results set. Defaults to >100, which returns all BIOCs to the end of the list. Bad Request. Got invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.19.2 |Insert or update BIOCs Insert new BIOCs or update existing BIOCs. Note: The BIOC rule_id is tenant specific and can't be used across tenants. Inserting BIOCs with the same rule_id as an existing BIOC on that tenant will overwrite the existing BIOC. You must have Instance Administrator permissions to run this endpoint. List of BIOC objects added. List of BIOC objects updated. A list of errors. Bad Request. Got invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.19.3 |Delete BIOCs Delete BIOCs selected by filter. You must have Instance Administrator permissions to run this endpoint. An array of filter fields. Identifies the BIOC field the filter is matching. Filters are based on the following keywords: name: BIOC name. severity: BIOC severity level. type: BIOC type. is_xql: Whether or not the BIOC is XQL. comment: Comment. status: BIOC status. indicator: Indicator. mitre_technique_id_and_name: MITRE technique ID and name. mitre_tactic_id_and_name: MITRE tactic ID and name. Identifies the comparison operator you want to use for this filter. Valid keywords are: EQ / NEQ severity: String indicator: String IN mitre_technique_id_and_name: List of strings mitre_tactic_id_and_name: List of strings Value that this filter must match. The contents of this field will differ depending on the IOC field that you specified for this filter: name, comment: String. severity: String, can be one of the following: SEV_010_INFO, SEV_020_LOW, SEV_030_MEDIUM, SEV_040_HIGH type: String, can be one of the following: other, persistence, evasion, tampering, file_type_obfuscation, privilege_escalation, credential_access, lateral_movement, execution, collection, exfiltration, infiltration, dropper, file_privilege_manipulation, reconnaissance, discovery. is_xql: Boolean: true or false. status: String, can be one of the following: enabled, disabled. indicator: String or dictionary in the format you wrote it. mitre_technique_id_and_name: List of strings. mitre_tactic_id_and_name: List of strings. Number of BIOC objects deleted. Bad Request. Got invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.20 |Correlation Rules APIs for managing Correlation Rules 2.1.20.1 |Get Correlation Rules Return a list of correlation rules. You can return all correlation rules or filter results. You can also return extended results with all details included. The response is concatenated using AND condition (OR is not supported). The maximum result set size is >100. Offset is the zero-based number of incidents from the start of the result set. You must have Instance Administrator permissions to run this endpoint. An array of filter fields. Identifies the correlation rule field the filter is matching. Filters are based on the following keywords: name: Correlation rule name. severity: Correlation rule severity. xql_query: Correlation rule XQL query. is_enabled: Whether the correlation rule is enabled or disabled. description: Correlation rule description. alert_name: Alert name. alert_category: Alert category. alert_description: Alert description. alert_fields: Alert fields. execution_mode: Whether execution mode is scheduled or real time. search_window: Amount of time for search window. simple_schedule: Correlation rule schedule. timezone: Correlation rule timezone. crontab: Linux scheduling for correlation rule. suppression_enabled: Whether suppression is enabled for correlation rule. suppression_duration: Duration of correlation rule suppression. suppression_fields: Suppression fields. dataset: Correlation rule dataset. user_defined_severity: User-defined severity. user_defined_category: User-defined category. mitre_defs: MITRE definitions. investigation_query_link: Investigation query link. drilldown_query_timeframe: Whether the drilldown query timeframe is query or alert. mapping_strategy: Whether the mapping strategy is auto or custom. alert_domain: Alert domain. Identifies the comparison operator you want to use for this filter. Valid keywords are: EQ / NEQ severity: String xql_query: String is_enabled: Boolean description: String alert_name: String alert_category: String alert_description: String alert_fields: String or dictionary execution_mode: String search_window: String simple_schedule: String timezone: String suppression_enabled: Boolean suppression_duration: String user_defined_severity: String user_defined_category: String investigation_query_link: String drilldown_query_timeframe: String mapping_strategy: String alert_domain: String IN suppression_fields: List of strings mitre_defs: List of strings Value that this filter must match. The contents of this field will differ depending on the correlation rule field that you specified for this filter: name, xql_query, description, alert_name, alert_description, alert_fields, suppression_duration, dataset, user_defined_severity, user_defined_category, investigation_query_link: String. severity: String, can be one of the following: SEV_010_INFO, SEV_020_LOW, SEV_030_MEDIUM, SEV_040_HIGH is_enabled: String, can be one of the following: enabled or disabled. alert_category: String, can be one of the following: other, persistence, evasion, tampering, file_type_obfuscation, privilege_escalation, credential_access, lateral_movement, execution, collection, exfiltration, infiltration, dropper, file_privilege_manipulation, reconnaissance, discovery. alert_fields: Dictionary. execution_mode: String, can be one of the following: scheduled or real_time. search_window: String, for example: "2 hours". simple_schedule: String, for example: "5 minutes". timezone: String, for example: "Asia/Jerusalem". crontab: String, for example: "*/10 * * * *". suppression_enabled: Boolean: true or false. suppression_fields: List of strings. mitre_defs: List of strings or dictionary. drilldown_query_timeframe: String, can be one of the following: query or alert. mapping_strategy: String, can be one of the following: auto or custom. alert_domain: String, can be one of the following: domain_security, domain_it, domain_hunting. Integer representing the starting offset within the query result set from which you want correlation rules returned. Correlation rules are returned as a zero-based list. Any correlation rule indexed less than this value is not returned in the final result set and defaults to zero. Integer representing the end offset within the result set after which you do not want BIOCs returned. BIOCs in the BIOC list that are indexed higher than this value are not returned in the final results set. Defaults to >100, which returns all BIOCs to the end of the list. Bad Request. Got invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.20.2 |Insert or update Correlation Rules Insert new Correlation Rules or update existing Correlation Rules. Note: The Correlation Rule id is tenant specific and can't be used across tenants. Inserting Correlation Rules with the same id as an existing Correlation Rule on that tenant will overwrite the existing Correlation Rule. You must have Instance Administrator permissions to run this endpoint. Correlation rule name. Correlation rule severity. Correlation rule XQL query. Whether the correlation rule is enabled or disabled. Correlation rule description. Alert description. Correlation rule execution mode. Correlation rule simple schedule. Correlation rule timezone. Linux scheduling for correlation rule. List of Correlation Rule objects added. List of Correlation Rule objects updated. List of error messages, if there are any. Bad Request. Got invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.20.3 |Delete Correlation Rules Delete correlation rules selected by filter. You must have Instance Administrator permissions to run this endpoint. An array of filter fields. Identifies the correlation rule field the filter is matching. Filters are based on the following keywords: name: Correlation rule name. severity: Correlation rule severity. xql_query: Correlation rule XQL query. is_enabled: Whether the correlation rule is enabled or disabled. description: Correlation rule description. alert_name: Alert name. alert_category: Alert category. alert_description: Alert description. alert_fields: Alert fields. execution_mode: Whether execution mode is scheduled or real time. search_window: Amount of time for search window. simple_schedule: Correlation rule schedule. timezone: Correlation rule timezone. crontab: Linux scheduling for correlation rule. suppression_enabled: Whether suppression is enabled for correlation rule. suppression_duration: Duration of correlation rule suppression. suppression_fields: Suppression fields. dataset: Correlation rule dataset. user_defined_severity: User-defined severity. user_defined_category: User-defined category. mitre_defs: MITRE definitions. investigation_query_link: Investigation query link. drilldown_query_timeframe: Whether the drilldown query timeframe is query or alert. mapping_strategy: Whether the mapping strategy is auto or custom. alert_domain: Alert domain. Identifies the comparison operator you want to use for this filter. Valid keywords are: EQ severity: String xql_query: String is_enabled: Boolean description: String alert_name: String alert_category: String alert_description: String alert_fields: String or dictionary execution_mode: String search_window: String simple_schedule: String timezone: String suppression_enabled: Boolean suppression_duration: String user_defined_severity: String user_defined_category: String investigation_query_link: String drilldown_query_timeframe: String mapping_strategy: String alert_domain: String IN suppression_fields: List of strings mitre_defs: List of strings Value that this filter must match. The contents of this field will differ depending on the correlation rule field that you specified for this filter: name, xql_query, description, alert_name, alert_description, alert_fields, suppression_duration, dataset, user_defined_severity, user_defined_category, investigation_query_link: String. severity: String, can be one of the following: SEV_010_INFO, SEV_020_LOW, SEV_030_MEDIUM, SEV_040_HIGH is_enabled: String, can be one of the following: enabled or disabled. alert_category: String, can be one of the following: other, persistence, evasion, tampering, file_type_obfuscation, privilege_escalation, credential_access, lateral_movement, execution, collection, exfiltration, infiltration, dropper, file_privilege_manipulation, reconnaissance, discovery. alert_fields: Dictionary. execution_mode: String, can be one of the following: scheduled or real_time. search_window: String, for example: "2 hours". simple_schedule: String, for example: "5 minutes". timezone: String, for example: "Asia/Jerusalem". crontab: String, for example: "*/10 * * * *". suppression_enabled: Boolean: true or false. suppression_fields: List of strings. mitre_defs: List of strings or dictionary. drilldown_query_timeframe: String, can be one of the following: query or alert. mapping_strategy: String, can be one of the following: auto or custom. alert_domain: String, can be one of the following: domain_security, domain_it, domain_hunting. Bad Request. Got invalid JSON. The query result upon error. HTTP response code. Additional information describing the error. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.1.21 |Playbooks APIs for managing playbooks 2.1.21.1 |Get a playbook Get a playbook by filtering based on its name or ID. The playbook's YAML is returned in a ZIP file. You must have Instance Administrator permissions to run this endpoint. Identifies the playbook field the filter is matching. Filters are based on the following keywords: name: Playbook name Value that this filter must match. 2.1.21.2 |Insert or update playbooks Add or update a playbook by passing the YAML in a ZIP file. You must have Instance Administrator permissions to run this endpoint. The number of playbooks identified and attempted to be added. This field in the response indicates that the playbook IDs listed failed to be added. Playbook ID of the playbook that failed to be added. 2.1.21.3 |Delete a playbook Delete a playbook by filtering based on its name or ID. You must have Instance Administrator permissions to run this endpoint. Identifies the playbook field the filter is matching. Filters are based on the following keywords: name: Playbook name Value that this filter must match. The number of playbooks identified and attempted to be deleted. This field in the response indicates that the playbook IDs listed failed to be deleted. Playbook ID of the playbook that failed to be deleted. This field in the response indicates that the playbook IDs listed were successfully deleted. Playbook ID of the playbook that was successfully deleted. 2.1.22 |Scripts APIs for managing scripts 2.1.22.1 |Get a script Get a script by filtering based on its name or ID. The script's YAML is returned in a ZIP file. You must have Instance Administrator permissions to run this endpoint. Identifies the script field the filter is matching. Filters are based on the following keywords: name: Script name Value that this filter must match. 2.1.22.2 |Insert or update a script Update or add a script by passing the YAML in a ZIP file. You must have Instance Administrator permissions to run this endpoint. The script in YAML in a zipped file. The number of scripts identified and attempted to be added. This field in the response indicates that the script IDs listed failed to be added. Script ID of the script that failed to be added. 2.1.22.3 |Delete a script Delete a script by filtering based on its name or ID. You must have Instance Administrator permissions to run this endpoint. Identifies the playbook field the filter is matching. Filters are based on the following keywords: name: Playbook name Value that this filter must match. The number of scripts identified and attempted to be deleted. This field in the response indicates that the script IDs listed failed to be deleted. Script ID of the script that failed to be deleted. This field in the response indicates that the script IDs listed were successfully deleted. Script ID of the script that was successfully deleted. 2.1.23 |Dashboards APIs for managing Dashboards 2.1.23.1 |Get dashboards Get dashboard details by filtering based on the dashboard name, dashboard ID, time the dashboard was generated, or dashboard source. You must have Instance Administrator permissions to run this endpoint. An array of filter fields. Identifies the dashboard field the filter is matching. Filters are based on the following keywords: dashboard_id: Dashboard ID. name: Dashboard name. time_generated: Time the dashboard was generated in epoch milliseconds. source: Dashboard source. Identifies the comparison operator you want to use for this filter. Valid keywords are: EQ / NEQ dashboard_id: Integer dashboard_id: List of integers name: List of strings source: List of strings time_generated: Integer representing the time the dashboard was generated in epoch milliseconds. dashboard_id: Integer representing the dashboard ID Value that this filter must match. The contents of this field will differ depending on the dashboard field that you specified for this filter: name, source: String or list of strings. time_generated: Integer. dashboard_id: Integer or list of integers. Invalid field or operator. The query result upon error. HTTP response code. Additional information describing the error. 2.1.23.2 |Insert or update dashboards Add or update the dashboards retrieved by the Get dashboards API. You must have Instance Administrator permissions to run this endpoint. An array of dashboard details as retrieved by the Get dashboards API. Dashboard description. Dashboard status. Note: If no global ID is added in the request data, there might be errors with the global ID listed as "None". An array of relevant XQL widget details as retrieved by the Get dashboards API. Array listing the the global ID and internal ID of the objects added. Array listing the the global ID and internal ID of the objects updated. List of errors including the global ID and the error message. 2.1.23.3 |Delete dashboards Delete the dashboards retrieved by the Get dashboards API. You must have Instance Administrator permissions to run this endpoint. An array of filter fields. Identifies the dashboard field the filter is matching. Filters are based on the following keywords: dashboard_id: Dashboard ID. name: Dashboard name. time_generated: Time the dashboard was generated in epoch milliseconds. source: Dashboard source. Identifies the comparison operator you want to use for this filter. Valid keywords are: EQ / NEQ dashboard_id: Integer dashboard_id: List of integers name: List of strings source: List of strings time_generated: Integer representing the time the dashboard was generated in epoch milliseconds. dashboard_id': Integer representing the dashboard ID. Value that this filter must match. The contents of this field will differ depending on the dashboard field that you specified for this filter: name, source: String or list of strings. time_generated: Integer. dashboard_id: Integer or list of integers. List of the global ID and internal ID of dashboards successfully deleted. List of global IDs and internal IDs that were not deleted and the error messages explaining why. Invalid field or operator. The query result upon error. HTTP response code. Additional information describing the error. 2.1.24 |Widgets APIs for managing widgets 2.1.24.1 |Get widgets Get widget details by filtering based on the widget title and widget creator. Note: The endpoint only returns XQL widgets and not predefined widgets. You must have Instance Administrator permissions to run this endpoint. An array of filter fields. Identifies the dashboard field the filter is matching. Filters are based on the following keywords: title: Widget title. created_by: Name of the user who created the widget. Identifies the comparison operator you want to use for this filter. Valid keywords are: eq / neq created_by: String created_by: List of strings title: List of strings Value that this filter must match. The contents of this field will differ depending on the widget field that you specified for this filter: title, created_by: String or list of strings. Number of widgets returned. Invalid field or operator. The query result upon error. HTTP response code. Additional information describing the error. 2.1.24.2 |Insert or update widgets Update or add the widgets retrieved by the Get widgets API. You must have Instance Administrator permissions to run this endpoint. An array of widget details as retrieved by the Get widgets API. List of widget keys and titles for all widgets successfully added. List of widget keys and titles for all widgets successfully updated. List of widget keys and error messages for all widgets that failed to be added or updated. 2.1.24.3 |Delete widgets Delete the widgets retrieved by the Get widgets API. You must have Instance Administrator permissions to run this endpoint. An array of filter fields. Identifies the dashboard field the filter is matching. Filters are based on the following keywords: title: Widget title. created_by: Name of the user who created the widget. Identifies the comparison operator you want to use for this filter. Valid keywords are: EQ / NEQ created_by: String created_by: List of strings title: List of strings Value that this filter must match. The contents of this field will differ depending on the widget field that you specified for this filter: title, created_by: String or list of strings. Number of widgets deleted. List of widget IDs of widgets successfully deleted. Invalid field or operator. The query result upon error. HTTP response code. Additional information describing the error. 2.1.25 |Issues APIs for managing issues 2.1.25.1 |Create a new issue This endpoint allows users to create a new issue by providing the necessary details. Users can only create one issue at a time. The request must include the following required fields: name description observation_time domain category observation_time Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Issue created successfully Unauthorized access Internal server error 2.1.25.2 |Retrieve issues based on filters This endpoint retrieves a list of issues that match the specified filter criteria. It supports filtering by issue_id, external_id, detection_method, domain, source, severity, and _insert_time, along with sorting and pagination. request_data: Object containing filter criteria filters: Array of filter objects field: String (enum: 'issue_id', 'external_id', 'detection_method', 'domain', 'severity', '_insert_time', 'status') operator: String (enum: 'in', 'gte', 'lte') value: Array of integers/strings or single integer filters: Array of filter objects field: String (enum: 'issue_id', 'external_id', 'detection_method', 'domain', 'severity', '_insert_time', 'status') operator: String (enum: 'in', 'gte', 'lte') value: Array of integers/strings or single integer field: String (enum: 'issue_id', 'external_id', 'detection_method', 'domain', 'severity', '_insert_time', 'status') operator: String (enum: 'in', 'gte', 'lte') value: Array of integers/strings or single integer search_from: Integer (default: 0) - Starting index for pagination search_to: Integer (default: 100) - Ending index for pagination sort: Object for sorting results field: String (enum: '_insert_time', 'severity', 'issue_id') keyword: String (enum: 'asc', 'desc') - Sort order field: String (enum: '_insert_time', 'severity', 'issue_id') keyword: String (enum: 'asc', 'desc') - Sort order include_fields: Array of strings (enum: 'normalized_fields', 'custom_fields', default: []) - Fields to include in response Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Specifies the field to filter issues by. Comparison operator to use with the filter. Value(s) for filtering the issues. Starting index for pagination. Ending index for pagination. Sort order (ascending or descending). A list of fields to include in the response. normalized_fields: Includes normalized fields in the response. custom_fields: Includes custom user-defined fields in the response. By default these fields will not be part of response payload. Successful response with issues Unauthorized access Internal server error 2.1.25.3 |Update existing issue Update an existing issue in the system. Users can only update one issue at a time. At least one of the following fields is mandatory: severity status Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Numeric ID of the user to get Issues updated successfully Unauthorized access Internal server error 2.1.26 |Cases APIs for managing cases 2.1.26.1 |Retrieve cases based on filters This endpoint retrieves a list of cases that match the specified filter criteria. It supports filtering by case_id, case_domain, status_progress, severity, and creation_time, along with sorting and pagination. request_data: Object containing filter criteria filters: Array of filter objects field: String (enum: 'case_id', 'case_domain', 'severity', 'creation_time', 'status_progress') operator: String (enum: 'in', 'gte', 'lte') value: Array of integers/strings or single integer filters: Array of filter objects field: String (enum: 'case_id', 'case_domain', 'severity', 'creation_time', 'status_progress') operator: String (enum: 'in', 'gte', 'lte') value: Array of integers/strings or single integer field: String (enum: 'case_id', 'case_domain', 'severity', 'creation_time', 'status_progress') operator: String (enum: 'in', 'gte', 'lte') value: Array of integers/strings or single integer search_from: Integer (default: 0) - Starting index for pagination search_to: Integer (default: 100) - Ending index for pagination sort: Object for sorting results field: String (enum: 'creation_time', 'severity', 'case_id') keyword: String (enum: 'asc', 'desc') - Sort order field: String (enum: 'creation_time', 'severity', 'case_id') keyword: String (enum: 'asc', 'desc') - Sort order Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Specifies the field to filter cases by. Comparison operator to use with the filter. Value(s) for filtering the cases. Starting index for pagination. Ending index for pagination. Sort order (ascending or descending). Successful response with cases Unique identifier for the case Timestamp of case creation Owner of the case Domain associated with the case Indicates if the case is auto-resolved Custom fields for additional metadata Timestamp of last modification Score assigned to the case Detailed description of the case Scoring type applied to the case ID of the assigned user Name of the assigned user Indicates if the case is cloud-based Indicates if the case is automated Unauthorized access Internal server error 2.1.26.2 |Update existing case Update an existing case in the system. Users can only update one case at a time. At least one of the following fields is mandatory: case_id Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Numeric ID of the case to update Case updated successfully Unauthorized access Internal server error 2.1.26.3 |Retrieve Case Artifacts by Case Id This endpoint retrieves the artifacts for a given case_id Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Numeric ID of the case Successful response with cases Case ID for which the artifacts are fetched Unique identifier for the artifact File name for the artifact File sha256 for the artifact File signature for the artifact File wildfire verdict for the artifact Indicates if the artifact is malicious Indicates if the artifact is manual Indicates if the artifact is related_to_process Indicates the artifact confidence Type of the artifact Unauthorized access Internal server error 2.1.26.4 |Get War Room entries Get the War Room entries for a specific case or alert. You can filter by timestamp, ID, and tags. You can also choose which type of entries you want to retrieve (notes, chat, attachments...). The response depends on what type of entry you choose to retrieve. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The ID of the case or alert you want to get the War Room entries of. For a case ID, prepend "CASE-" to the case ID. For example, if the case ID is 3, the value of id should be CASE-3. For alert IDs, just put the ID. For example, if the alert ID is 3, the value of id should be 3. Return results starting from the investigation ID in firstID until the last investigation ID. Return results starting from the first investigation ID until the investigation ID in lastID. Filter the results by the number of entries you want returned. "pagesize": 0 returns all the results. RFC3339 timestamp. Filter results from the time the entry is created until the latest entry. The categories you want to filter and the results you want to receive: tags: Tags added to the investigation. chats: Communication between team members in the form of chat messages. notes: Any entries marked as notes. attachments: Any files uploaded to the War Room in a playbook, script, or by the analyst. incidentInfo: The case history. commandAndResults: Command and return the result of the command. playbookTaskResult: Return the task result. playbookTaskStartAndDone: Task and return the task result. playbookErrors: When there are no playbook errors, the response returned is 0. If using the filter category of tags, include the tags you want to filter by. The query result upon error. HTTP response code. Additional information describing the error. Payment Required Internal Server Error 2.1.26.5 |Add War Room entries Add an entry to the cases or alert War Room, including data. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The ID of the case or issue for which you want to add a War Room entry. For a case ID, prepend "CASE-" to the case ID. For example, if the case ID is 3, the value of id should be CASE-3. For alert IDs, just put the ID. For example, if the alert ID is 3, the value of id should be 3. The data you want to add or the command you want to run in the War Room. The query result upon error. HTTP response code. Additional information describing the error. Payment Required Internal Server Error 2.1.27 |Asset inventory APIs for managing assets in the asset inventory 2.1.27.1 |Get all or filtered assets Retrieve detailed information about all assets within your environment, including enterprise, multi-cloud, code, and external surfaces. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The field you want to filter. The operator to apply to the SEARCH_FIELD. It defines how the SEARCH_VALUE will be used to evaluate the SEARCH_FIELD. The value that the SEARCH_FIELD will be compared to, based on the SEARCH_TYPE operator. Valid values include: EQ, IN, NIN, NEQ, IS, IS_NOT, LIKE_ANY, NOT_LIKE_ANY, WILDCARD, WILDCARD_NOT, REGEX, REGEX_NOT, GT, LT, GTE, LTE, RELATIVE_TIMESTAMP, RANGE, CONTAINS, JSON_SEARCH, JSON_OVERLAPS, JSON_OVERLAPS_NOT, NCONTAINS, CONTAINS_IN_LIST, NOT_CONTAINS_IN_LIST, ARRAY_LEN_EQ, ARRAY_LEN_NEQ, ARRAY_CONTAINS, ARRAY_CONTAINS_NUMBERS, ARRAY_NOT_CONTAINS, JSON_EQ, JSON_NEQ, JSON_WILDCARD_NOT, JSON_WILDCARD, JSON_GTE, JSON_LTE, JSON_GT, JSON_LT, JSON_CONTAINS_NOT, JSON_CONTAINS, JSON_ARRAY_CONTAINED_IN, JSON_ARRAY_NOT_CONTAINED_IN, JSON_ARRAY_CONTAINS, JSON_ARRAY_CONTAINS_NOT, JSON_IS_EMPTY, JSON_IS_NOT_EMPTY` The field according to which you want the results to be sorted. Sort order. Valid values include: ASC (ascending order) DESC (descending order) An integer representing the starting offset within the query result set from which you want assets returned. An integer representing the end offset within the result set after which you do not want assets returned. Assets in the asset inventory that are indexed higher than this value are not returned in the final results set. Number of critical issues Number of high issues Number of low issues Number of medium issues Timestamp of when the asset was first observed Region of the cloud asset Timestamp of when the asset was last observed A more detailed grouping within a class. It categorizes assets based on their normalized function or common type, regardless of the provider or implementation. Represents the provider-specific name for a particular asset within a category. Number of critical cases Number of high cases Number of low cases Number of medium cases The highest-level grouping of assets based on their general purpose or domain. It is a broad classification that defines the overall function of the assets List of asset group IDs Number of assets returned Number of total results of this filter without paging Internal Server Error, Invalid Input 2.1.27.2 |Get asset by ID Retrieve detailed information about the asset specified by asset ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Timestamp of when the asset was last observed Region of the cloud asset Timestamp of when the asset was first observed Represents the provider-specific name for a particular asset within a category The highest-level grouping of assets based on their general purpose or domain. It is a broad classification that defines the overall function of the assets. A more detailed grouping within a class. It categorizes assets based on their normalized function or common type, regardless of the provider or implementation. List of asset group IDs Number of critical cases Number of high cases Number of low cases Number of medium cases Number of critical issues Number of high issues Number of low issues Number of medium issues Internal Server Error 2.1.27.3 |Get raw fields of asset by ID Get the raw fields of the asset specified by asset ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Internal Server Error 2.1.27.4 |Get schema of asset inventory Get the schema of the asset inventory, including the field names, pretty field names, and field type for every entry in the data model. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Data model field name Data model pretty field name Internal Server Error 2.1.27.5 |Get enum values of specified field Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Field name - must be of type Enum Internal Server Error 2.1.28 |Asset groups APIs for managing asset groups 2.1.28.1 |Get all or filtered asset groups By grouping assets based on shared attributes, you can address them collectively. Asset groups enable more efficient bulk actions and simplifies both filtering and scoping within the inventory and across the platform. Get all or filtered asset groups. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Internal Server Error, Invalid Input 2.1.28.2 |Create an Asset Group Create a dynamic Asset Group by specifying the filters, or a static group to manually include individual assets. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Asset Group name The type of Asset Group. Valid values include: Dynamic: Assets grouped using filters. Any asset that meets the defined criteria is included. Static: Manually add individual assets to be included in a group. Add an optional description to clarify the purpose of the Asset Group. Define the filter conditions for selecting which assets to be included in a dynamic Asset Group. The field you want to filter. The operator to apply to the SEARCH_FIELD. It defines how the SEARCH_VALUE will be used to evaluate the SEARCH_FIELD. The value that the SEARCH_FIELD will be compared to, based on the SEARCH_TYPE operator. Valid values include: EQ, IN, NIN, NEQ, IS, IS_NOT, LIKE_ANY, NOT_LIKE_ANY, WILDCARD, WILDCARD_NOT, REGEX, REGEX_NOT, GT, LT, GTE, LTE, RELATIVE_TIMESTAMP, RANGE, CONTAINS, JSON_SEARCH, JSON_OVERLAPS, JSON_OVERLAPS_NOT, NCONTAINS, CONTAINS_IN_LIST, NOT_CONTAINS_IN_LIST, ARRAY_LEN_EQ, ARRAY_LEN_NEQ, ARRAY_CONTAINS, ARRAY_CONTAINS_NUMBERS, ARRAY_NOT_CONTAINS, JSON_EQ, JSON_NEQ, JSON_WILDCARD_NOT, JSON_WILDCARD, JSON_GTE, JSON_LTE, JSON_GT, JSON_LT, JSON_CONTAINS_NOT, JSON_CONTAINS, JSON_ARRAY_CONTAINED_IN, JSON_ARRAY_NOT_CONTAINED_IN, JSON_ARRAY_CONTAINS, JSON_ARRAY_CONTAINS_NOT, JSON_IS_EMPTY, JSON_IS_NOT_EMPTY` Whether the Asset Group creation was successful ID of the new Asset Group Internal Server Error, Invalid Input 2.1.28.3 |Update an Asset Group Update the Asset Group specified by Asset Group ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Asset Group name The type of Asset Group. Valid values include: Dynamic: Assets grouped using filters. Any asset that meets the defined criteria is included. Static: Manually add individual assets to be included in a group. Add an optional description to clarify the purpose of the Asset Group. Define the filter conditions for selecting which assets to be included in a dynamic Asset Group. The field you want to filter. The operator to apply to the SEARCH_FIELD. It defines how the SEARCH_VALUE will be used to evaluate the SEARCH_FIELD. The value that the SEARCH_FIELD will be compared to, based on the SEARCH_TYPE operator. Valid values include: EQ, IN, NIN, NEQ, IS, IS_NOT, LIKE_ANY, NOT_LIKE_ANY, WILDCARD, WILDCARD_NOT, REGEX, REGEX_NOT, GT, LT, GTE, LTE, RELATIVE_TIMESTAMP, RANGE, CONTAINS, JSON_SEARCH, JSON_OVERLAPS, JSON_OVERLAPS_NOT, NCONTAINS, CONTAINS_IN_LIST, NOT_CONTAINS_IN_LIST, ARRAY_LEN_EQ, ARRAY_LEN_NEQ, ARRAY_CONTAINS, ARRAY_CONTAINS_NUMBERS, ARRAY_NOT_CONTAINS, JSON_EQ, JSON_NEQ, JSON_WILDCARD_NOT, JSON_WILDCARD, JSON_GTE, JSON_LTE, JSON_GT, JSON_LT, JSON_CONTAINS_NOT, JSON_CONTAINS, JSON_ARRAY_CONTAINED_IN, JSON_ARRAY_NOT_CONTAINED_IN, JSON_ARRAY_CONTAINS, JSON_ARRAY_CONTAINS_NOT, JSON_IS_EMPTY, JSON_IS_NOT_EMPTY` Internal Server Error, Invalid Input 2.1.28.4 |Delete an Asset Group Delete the Asset Group specified by Asset Group ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Internal Server Error, Invalid Input 2.2 |Cortex Platform IAM APIs Identity and Access Management (IAM) APIs for the Cortex platform. These APIs enable programmatic management of roles, user groups, users, API keys, and scope-based access control (SBAC) configurations. With these endpoints, you can create, read, update, and delete IAM entities, manage permissions and access controls, and configure security scopes for users, groups, and API keys. These APIs are intended to be accessed via API keys. Therefore, the key must have the RBAC permission 'access_management_view' for list & read operations and permission 'access_management_action' for create, edit, & delete operations. 2.2.1 |Preface Identity and Access Management (IAM) APIs for the Cortex platform. These APIs enable programmatic management of roles, user groups, users, API keys, and scope-based access control (SBAC) configurations. With these endpoints, you can create, read, update, and delete IAM entities, manage permissions and access controls, and configure security scopes for users, groups, and API keys. These APIs are intended to be accessed via API keys. Therefore, the key must have the RBAC permission 'access_management_view' for list & read operations and permission 'access_management_action' for create, edit, & delete operations. 2.2.1.1 |Servers 2.2.1.2 |Authentication methods Authorized requests to the API should use: x-api-key inside a header with the access token. Authorized requests to the API should use: x-api-key-id inside a header with the access token. 2.2.2 |Roles Operations for managing roles including creation, editing, deletion, and listing roles. 2.2.2.1 |List all roles This endpoint retrieves a list of roles and returns their attributes. This API does not list permissions for said roles. To receive that information, please leverage the existing Get Roles API (https://docs-cortex.paloaltonetworks.com/r/Cortex-Cloud-Platform-APIs/Get-Roles). Note: 'role_id' refers to the immutable role ID, while 'pretty_name' refers to the display name. Successfully retrieved roles The unique identifier for the role The display name for the role A description of the role's purpose and permissions Indicates if the role is a custom role (true) or a predefined system role (false) The user or system that created the role The timestamp when the role was created The timestamp when the role was last updated Metadata for the response Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.2.2.2 |Create a new role To identify all potential permissions that can be entered into the 'component_permissions' field, please utilize the 'GET /platform/iam/v1/role/permission-config' endpoint and utilize the 'view_name' and 'action_name' properties. Note: if you input an 'action' permission, then the relevant 'view' permission will be added for you. There will also be checks done on sub-permissions, ensuring that the main 'action' permissions are present as well. The available datasets can also be found by utilizing the 'GET /platform/iam/v1/role/permission-config' endpoint. Any dataset related permissions are not permissible in the 'component_permissions' field (an error will be thrown). The 'permissions' field in the entry for 'dataset_permissions' refers to dataset names for said dataset category.It is important to note that the 'access_all' field will only grant the role access to all datasets in said category that the API key has access to. Request object for creating a new role The data required to create a new role List of component permissions for the role. Possible values can be found by using the permission configs API and referring to the rbac_permissions field. Optional list of dataset permissions. This must be a list of JSONs. The layout for this JSON can be found under the 'DatasetPermission' schema . Note: possible dataset values can be found by using the permission configs API and referring to the datasetGroups field. Name of the role Optional description of the role Role created successfully Success message indicating the role was created Bad request for role create call Error message describing the issue Additional error details Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.2.2.3 |Delete an existing role Delete an existing Role Full role id of the custom role Role deleted successfully Success message indicating the role was deleted Bad request for role delete call Error message describing the issue Additional error details Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.2.2.4 |List all permission configs Returns the current list of permissions available for the specified tenant. Each permission includes: name: Display name of the permission as shown in the UI. view_name: Permission key for the "View" option, used in role creation APIs. action_name: Permission key for the "View/Edit" option, used in role creation APIs. Intended use: Use this endpoint to identify the correct permission keys corresponding to the display names visible in the UI. Note - The response mirrors how permissions are organized and displayed in the UI (by category and subcategory). Successfully retrieved permission configs Metadata for the response Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.2.3 |User Groups Operations for managing user groups including creation, editing, deletion, and listing user groups. 2.2.3.1 |List all user groups This endpoint retrieves a list of user groups and returns their attributes. For possible 'group_type' values, please refer to the enum documentation for 'GroupType'. Also, 'nested_groups' refers to the list of direct child groups of the given user group. Similarly, 'idp_groups' refers to the identifiers of associated identity provider groups to the given user group. Successfully retrieved user groups Metadata for the response Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.2.3.2 |Create a new user group This endpoint creates a new user group with the specified configuration. You can assign a role, add users, configure nested groups, and link identity provider groups. All fields except 'group_name' are optional. Request object for creating a new user group The data required to create a new user group The unique name for the user group The unique identifier of the role to assign to this group A brief description of the user group's purpose A list of user email addresses to add to the group A list of unique identifiers for groups to be nested within this group A list of identity provider (IdP) group names to associate with this group User Group created successfully Success message indicating the user group was created Bad request for user group create call Error message describing the issue Additional error details Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.2.3.3 |Edit an existing user group This endpoint allows modification of an existing user group by providing the group_id in the path and the update details in the request body. Only specified fields will be updated. Please note that to remove attributes, you must provide either an empty string or empty list as the value of the respective field in the request body. Full user group id Request object for editing an existing user group The data fields to update for the user group The new name for the user group The unique identifier of the new role to assign to this group The updated description for the user group The updated list of user email addresses for the group The updated list of nested group identifiers The updated list of associated identity provider (IdP) group names User Group edited successfully Success message indicating the user group was edited Bad request for user group edit call Error message describing the issue Additional error details Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.2.3.4 |Delete an existing user group Delete an existing user group. Note: upon deletion of a user group, its nested groups are not deleted; the relationships are simply removed. Full user group id User Group deleted successfully Success message indicating the user group was deleted Bad request for user group delete call Error message describing the issue Additional error details Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.2.4 |Scopes Operations for managing Scope-Based Access Control (SBAC) configurations for users, groups, and API keys. 2.2.4.1 |Retrieve an existing scope This API endpoint allows retrieving the scope details for a specific entity type and entity ID. For possible 'mode' and 'entity_type' values, please refer to the enum documentation for 'ModeType' and 'EntityType'. Full name of the entity's type Full id of the entity Successfully retrieved scope Metadata for the response Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.2.4.2 |Edit an existing scope This API endpoint allows editing the scope details for a specific entity type and entity ID. For possible 'mode' and 'entity_type' values, please refer to the enum documentation for 'ModeType' and 'EntityType'. Please note that the 'datasets_rows' field can only be passed in to the request body if the dataset scope config is enabled. Full name of the entity's type Full id of the entity Scope configuration data to update Asset scope configuration for request payloads Access mode for assets. Use 'scope' to limit access to specific asset groups, 'see_all' for full access, or 'no_scope' for no access List of asset group IDs when configuring scope (used in PUT requests) Dataset rows scope configuration for filtering data access Default behavior for datasets not explicitly listed in filters. 'no_scope' means no access to unlisted datasets, 'see_all' means full access to unlisted datasets List of dataset-specific filters to apply row-level access control Name of the dataset to apply the filter to Filter expression to limit data access (e.g., '_collector_name = collector_1') Endpoint scope configuration for request payloads Endpoint groups scope configuration for requests Access mode for endpoint groups List of endpoint group names when configuring scope Endpoint tags scope configuration for requests Access mode for endpoint tags List of endpoint tag names when configuring scope Cases and issues scope configuration for requests Access mode for cases and issues Whether to include cases and issues that have no associated entities/tags List of tag names when configuring scope Scope edited successfully Success message indicating the scope was edited Bad request for scope edit call Error message describing the issue Additional error details Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.2.5 |User Operations for managing users including listing users and editing user configurations. 2.2.5.1 |List all users This endpoint retrieves a list of all users and their respective properties. Note: the 'role_name' field refers to the 'pretty_name' attribute from the Roles APIs and the direct role assigned to the user, not roles inherited through groups. Successfully retrieved users Metadata for the response Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.2.5.2 |Get user This endpoint retrieves a user and its respective properties. Note: the 'role_name' field refers to the 'pretty_name' attribute from the Roles APIs, not the unique role identifier. Full email of the user Successfully retrieved user Metadata for the response Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.2.5.3 |Edit an existing user This endpoint allows updating various user details. Please note that you must pass an empty string for the 'role_id' field if you are attempting to remove a role from a user. For the 'user_groups' field, please pass an empty list to remove user group associations for the provided user. Full email of the user Request object for editing an existing user The data fields to update for the user The user's first name The user's last name The unique identifier of the role to assign to the user. Use an empty string to remove the role. The user's contact phone number The user's account status (e.g., 'Active', 'Disabled') Whether the user should be hidden from certain UI views A list of unique identifiers for the groups the user belongs to. Use an empty list to remove all group associations. User edited successfully Success message indicating the user was edited Bad request for user edit call Error message describing the issue Additional error details Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.2.6 |API Keys Operations for managing API keys including retrieving and editing API key configurations. 2.2.6.1 |Get API Key This endpoint retrieves an API key and its respective properties. Note: the 'roles' field refers to the 'pretty_name' attributes from the Roles APIs, not the unique role identifiers. For possible 'security_level' values, please refer to the enum documentation for 'SecurityLevel'. Successfully retrieved API key Metadata for the response Bad request for api key get call Error message describing the issue Additional error details Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.2.6.2 |Edit an API key This endpoint allows for the editing of an existing API key. For possible 'security_level' values, please refer to the enum documentation for 'SecurityLevel'. Request object for editing an existing API key The data fields to update for the API key A list of unique role identifiers to assign to the API key The security level for the API key (e.g., 'standard', 'advanced') An optional comment or description for the API key API key edited successfully Success message indicating the API key was edited Bad request for api key edit call Error message describing the issue Additional error details Unauthorized access Unauthorized access due to lack of sufficient permissions Internal server error. A unified status for API communication type errors. 2.3 |Cortex Cloud Alert Notification Rules REST APIs This OpenAPI Specification provides documentation about new Alert Notification Rules APIs for Cortex Cloud. With these endpoints, you can create, read, update, disable, and delete alert notification rules. These APIs are intended to be accessed via API keys. Therefore, the key must have the RBAC permission alert_notifications for list & read operations and permission alert_notifications_action for create, edit, enable/disable, & delete operations. 2.3.1 |Preface This OpenAPI Specification provides documentation about new Alert Notification Rules APIs for Cortex Cloud. With these endpoints, you can create, read, update, disable, and delete alert notification rules. These APIs are intended to be accessed via API keys. Therefore, the key must have the RBAC permission alert_notifications for list & read operations and permission alert_notifications_action for create, edit, enable/disable, & delete operations. 2.3.1.1 |Servers 2.3.2 |Alert Notification Rules Operations for managing rules including creation, editing, enabling/disabling, deletion, and listing rules. 2.3.2.1 |List all rules This endpoint retrieves a list of alert notification rules and returns their attributes. The meaning behind all attributes in this response could be found in the Rule schema. Please note that the field legacy_mail_format is set to False for all rules that were not created in legacy Xpanse environments. Successfully retrieved rules Name of the rule The unique identifier of the rule Optional description of the rule A required value from the LogForwardType Enum. An object containing the various attributes of the filter that will be applied to the given alert notification rule. Please refer to the BaseFilterExample and ComplexFilterExample schemas to gather further information on this field. A user can also derive a filter by utilizing the JSON export functionality when defining a rule via the UI. This JSON object provides the user with the ability to specify configurations for Email, Slack, and Syslog outputs. An object containing all the information that configures email output for the given notification rule. List of valid email addresses that will receive notifications forwarded by the given rule. An integer that is between 0 and 1440 (in minutes). This string value allows the user to customize the mail subject of the event forwarded by the given rule. This boolean value signifies whether the legacy mail format is being utilized (applicable only for legacy Xpanse tenant) An object containing all the information that configures Slack output for the given notification rule. List of valid Slack channels that will receive notifications forwarded by the given rule. An object containing all the information that configures Syslog output for the given notification rule. This string value that specifies the Syslog integration that will be associated with the given notification rule. List of valid application IDs (AWS SQS, AWS S3, Splunk, and webhook integrations). These can be found by utilizing the List External Applications API. This string indicates which time zone the rule will be associated with. If the field is not passed in, the default value will be UTC. The following are valid time zone options: Africa/Abidjan, Africa/Accra, Africa/Addis_Ababa, Africa/Algiers, Africa/Asmara, Africa/Asmera, Africa/Bamako, Africa/Bangui, Africa/Banjul, Africa/Bissau, Africa/Blantyre, Africa/Brazzaville, Africa/Bujumbura, Africa/Cairo, Africa/Casablanca, Africa/Ceuta, Africa/Conakry, Africa/Dakar, Africa/Dar_es_Salaam, Africa/Djibouti, Africa/Douala, Africa/El_Aaiun, Africa/Freetown, Africa/Gaborone, Africa/Harare, Africa/Johannesburg, Africa/Juba, Africa/Kampala, Africa/Khartoum, Africa/Kigali, Africa/Kinshasa, Africa/Lagos, Africa/Libreville, Africa/Lome, Africa/Luanda, Africa/Lubumbashi, Africa/Lusaka, Africa/Malabo, Africa/Maputo, Africa/Maseru, Africa/Mbabane, Africa/Mogadishu, Africa/Monrovia, Africa/Nairobi, Africa/Ndjamena, Africa/Niamey, Africa/Nouakchott, Africa/Ouagadougou, Africa/Porto-Novo, Africa/Sao_Tome, Africa/Timbuktu, Africa/Tripoli, Africa/Tunis, Africa/Windhoek, America/Adak, America/Anchorage, America/Anguilla, America/Antigua, America/Araguaina, America/Argentina/Buenos_Aires, America/Argentina/Catamarca, America/Argentina/ComodRivadavia, America/Argentina/Cordoba, America/Argentina/Jujuy, America/Argentina/La_Rioja, America/Argentina/Mendoza, America/Argentina/Rio_Gallegos, America/Argentina/Salta, America/Argentina/San_Juan, America/Argentina/San_Luis, America/Argentina/Tucuman, America/Argentina/Ushuaia, America/Aruba, America/Asuncion, America/Atikokan, America/Atka, America/Bahia, America/Bahia_Banderas, America/Barbados, America/Belem, America/Belize, America/Blanc-Sablon, America/Boa_Vista, America/Bogota, America/Boise, America/Buenos_Aires, America/Cambridge_Bay, America/Campo_Grande, America/Cancun, America/Caracas, America/Catamarca, America/Cayenne, America/Cayman, America/Chicago, America/Chihuahua, America/Ciudad_Juarez, America/Coral_Harbour, America/Cordoba, America/Costa_Rica, America/Coyhaique, America/Creston, America/Cuiaba, America/Curacao, America/Danmarkshavn, America/Dawson, America/Dawson_Creek, America/Denver, America/Detroit, America/Dominica, America/Edmonton, America/Eirunepe, America/El_Salvador, America/Ensenada, America/Fort_Nelson, America/Fort_Wayne, America/Fortaleza, America/Glace_Bay, America/Godthab, America/Goose_Bay, America/Grand_Turk, America/Grenada, America/Guadeloupe, America/Guatemala, America/Guayaquil, America/Guyana, America/Halifax, America/Havana, America/Hermosillo, America/Indiana/Indianapolis, America/Indiana/Knox, America/Indiana/Marengo, America/Indiana/Petersburg, America/Indiana/Tell_City, America/Indiana/Vevay, America/Indiana/Vincennes, America/Indiana/Winamac, America/Indianapolis, America/Inuvik, America/Iqaluit, America/Jamaica, America/Jujuy, America/Juneau, America/Kentucky/Louisville, America/Kentucky/Monticello, America/Knox_IN, America/Kralendijk, America/La_Paz, America/Lima, America/Los_Angeles, America/Louisville, America/Lower_Princes, America/Maceio, America/Managua, America/Manaus, America/Marigot, America/Martinique, America/Matamoros, America/Mazatlan, America/Mendoza, America/Menominee, America/Merida, America/Metlakatla, America/Mexico_City, America/Miquelon, America/Moncton, America/Monterrey, America/Montevideo, America/Montreal, America/Montserrat, America/Nassau, America/New_York, America/Nipigon, America/Nome, America/Noronha, America/North_Dakota/Beulah, America/North_Dakota/Center, America/North_Dakota/New_Salem, America/Nuuk, America/Ojinaga, America/Panama, America/Pangnirtung, America/Paramaribo, America/Phoenix, America/Port-au-Prince, America/Port_of_Spain, America/Porto_Acre, America/Porto_Velho, America/Puerto_Rico, America/Punta_Arenas, America/Rainy_River, America/Rankin_Inlet, America/Recife, America/Regina, America/Resolute, America/Rio_Branco, America/Rosario, America/Santa_Isabel, America/Santarem, America/Santiago, America/Santo_Domingo, America/Sao_Paulo, America/Scoresbysund, America/Shiprock, America/Sitka, America/St_Barthelemy, America/St_Johns, America/St_Kitts, America/St_Lucia, America/St_Thomas, America/St_Vincent, America/Swift_Current, America/Tegucigalpa, America/Thule, America/Thunder_Bay, America/Tijuana, America/Toronto, America/Tortola, America/Vancouver, America/Virgin, America/Whitehorse, America/Winnipeg, America/Yakutat, America/Yellowknife, Antarctica/Casey, Antarctica/Davis, Antarctica/DumontDUrville, Antarctica/Macquarie, Antarctica/Mawson, Antarctica/McMurdo, Antarctica/Palmer, Antarctica/Rothera, Antarctica/South_Pole, Antarctica/Syowa, Antarctica/Troll, Antarctica/Vostok, Arctic/Longyearbyen, Asia/Aden, Asia/Almaty, Asia/Amman, Asia/Anadyr, Asia/Aqtau, Asia/Aqtobe, Asia/Ashgabat, Asia/Ashkhabad, Asia/Atyrau, Asia/Baghdad, Asia/Bahrain, Asia/Baku, Asia/Bangkok, Asia/Barnaul, Asia/Beirut, Asia/Bishkek, Asia/Brunei, Asia/Calcutta, Asia/Chita, Asia/Choibalsan, Asia/Chongqing, Asia/Chungking, Asia/Colombo, Asia/Dacca, Asia/Damascus, Asia/Dhaka, Asia/Dili, Asia/Dubai, Asia/Dushanbe, Asia/Famagusta, Asia/Gaza, Asia/Harbin, Asia/Hebron, Asia/Ho_Chi_Minh, Asia/Hong_Kong, Asia/Hovd, Asia/Irkutsk, Asia/Istanbul, Asia/Jakarta, Asia/Jayapura, Asia/Jerusalem, Asia/Kabul, Asia/Kamchatka, Asia/Karachi, Asia/Kashgar, Asia/Kathmandu, Asia/Katmandu, Asia/Khandyga, Asia/Kolkata, Asia/Krasnoyarsk, Asia/Kuala_Lumpur, Asia/Kuching, Asia/Kuwait, Asia/Macao, Asia/Macau, Asia/Magadan, Asia/Makassar, Asia/Manila, Asia/Muscat, Asia/Nicosia, Asia/Novokuznetsk, Asia/Novosibirsk, Asia/Omsk, Asia/Oral, Asia/Phnom_Penh, Asia/Pontianak, Asia/Pyongyang, Asia/Qatar, Asia/Qostanay, Asia/Qyzylorda, Asia/Rangoon, Asia/Riyadh, Asia/Saigon, Asia/Sakhalin, Asia/Samarkand, Asia/Seoul, Asia/Shanghai, Asia/Singapore, Asia/Srednekolymsk, Asia/Taipei, Asia/Tashkent, Asia/Tbilisi, Asia/Tehran, Asia/Tel_Aviv, Asia/Thimbu, Asia/Thimphu, Asia/Tokyo, Asia/Tomsk, Asia/Ujung_Pandang, Asia/Ulaanbaatar, Asia/Ulan_Bator, Asia/Urumqi, Asia/Ust-Nera, Asia/Vientiane, Asia/Vladivostok, Asia/Yakutsk, Asia/Yangon, Asia/Yekaterinburg, Asia/Yerevan, Atlantic/Azores, Atlantic/Bermuda, Atlantic/Canary, Atlantic/Cape_Verde, Atlantic/Faeroe, Atlantic/Faroe, Atlantic/Jan_Mayen, Atlantic/Madeira, Atlantic/Reykjavik, Atlantic/South_Georgia, Atlantic/St_Helena, Atlantic/Stanley, Australia/ACT, Australia/Adelaide, Australia/Brisbane, Australia/Broken_Hill, Australia/Canberra, Australia/Currie, Australia/Darwin, Australia/Eucla, Australia/Hobart, Australia/LHI, Australia/Lindeman, Australia/Lord_Howe, Australia/Melbourne, Australia/NSW, Australia/North, Australia/Perth, Australia/Queensland, Australia/South, Australia/Sydney, Australia/Tasmania, Australia/Victoria, Australia/West, Australia/Yancowinna, Brazil/Acre, Brazil/DeNoronha, Brazil/East, Brazil/West, CET, CST6CDT, Canada/Atlantic, Canada/Central, Canada/Eastern, Canada/Mountain, Canada/Newfoundland, Canada/Pacific, Canada/Saskatchewan, Canada/Yukon, Chile/Continental, Chile/EasterIsland, Cuba, EET, EST, EST5EDT, Egypt, Eire, Etc/GMT, Etc/GMT+0, Etc/GMT+1, Etc/GMT+10, Etc/GMT+11, Etc/GMT+12, Etc/GMT+2, Etc/GMT+3, Etc/GMT+4, Etc/GMT+5, Etc/GMT+6, Etc/GMT+7, Etc/GMT+8, Etc/GMT+9, Etc/GMT-0, Etc/GMT-1, Etc/GMT-10, Etc/GMT-11, Etc/GMT-12, Etc/GMT-13, Etc/GMT-14, Etc/GMT-2, Etc/GMT-3, Etc/GMT-4, Etc/GMT-5, Etc/GMT-6, Etc/GMT-7, Etc/GMT-8, Etc/GMT-9, Etc/GMT0, Etc/Greenwich, Etc/UCT, Etc/UTC, Etc/Universal, Etc/Zulu, Europe/Amsterdam, Europe/Andorra, Europe/Astrakhan, Europe/Athens, Europe/Belfast, Europe/Belgrade, Europe/Berlin, Europe/Bratislava, Europe/Brussels, Europe/Bucharest, Europe/Budapest, Europe/Busingen, Europe/Chisinau, Europe/Copenhagen, Europe/Dublin, Europe/Gibraltar, Europe/Guernsey, Europe/Helsinki, Europe/Isle_of_Man, Europe/Istanbul, Europe/Jersey, Europe/Kaliningrad, Europe/Kiev, Europe/Kirov, Europe/Kyiv, Europe/Lisbon, Europe/Ljubljana, Europe/London, Europe/Luxembourg, Europe/Madrid, Europe/Malta, Europe/Mariehamn, Europe/Minsk, Europe/Monaco, Europe/Moscow, Europe/Nicosia, Europe/Oslo, Europe/Paris, Europe/Podgorica, Europe/Prague, Europe/Riga, Europe/Rome, Europe/Samara, Europe/San_Marino, Europe/Sarajevo, Europe/Saratov, Europe/Simferopol, Europe/Skopje, Europe/Sofia, Europe/Stockholm, Europe/Tallinn, Europe/Tirane, Europe/Tiraspol, Europe/Ulyanovsk, Europe/Uzhgorod, Europe/Vaduz, Europe/Vatican, Europe/Vienna, Europe/Vilnius, Europe/Volgograd, Europe/Warsaw, Europe/Zagreb, Europe/Zaporozhye, Europe/Zurich, GB, GB-Eire, GMT, GMT+0, GMT-0, GMT0, Greenwich, HST, Hongkong, Iceland, Indian/Antananarivo, Indian/Chagos, Indian/Christmas, Indian/Cocos, Indian/Comoro, Indian/Kerguelen, Indian/Mahe, Indian/Maldives, Indian/Mauritius, Indian/Mayotte, Indian/Reunion, Iran, Israel, Jamaica, Japan, Kwajalein, Libya, MET, MST, MST7MDT, Mexico/BajaNorte, Mexico/BajaSur, Mexico/General, NZ, NZ-CHAT, Navajo, PRC, PST8PDT, Pacific/Apia, Pacific/Auckland, Pacific/Bougainville, Pacific/Chatham, Pacific/Chuuk, Pacific/Easter, Pacific/Efate, Pacific/Enderbury, Pacific/Fakaofo, Pacific/Fiji, Pacific/Funafuti, Pacific/Galapagos, Pacific/Gambier, Pacific/Guadalcanal, Pacific/Guam, Pacific/Honolulu, Pacific/Johnston, Pacific/Kanton, Pacific/Kiritimati, Pacific/Kosrae, Pacific/Kwajalein, Pacific/Majuro, Pacific/Marquesas, Pacific/Midway, Pacific/Nauru, Pacific/Niue, Pacific/Norfolk, Pacific/Noumea, Pacific/Pago_Pago, Pacific/Palau, Pacific/Pitcairn, Pacific/Pohnpei, Pacific/Ponape, Pacific/Port_Moresby, Pacific/Rarotonga, Pacific/Saipan, Pacific/Samoa, Pacific/Tahiti, Pacific/Tarawa, Pacific/Tongatapu, Pacific/Truk, Pacific/Wake, Pacific/Wallis, Pacific/Yap, Poland, Portugal, ROC, ROK, Singapore, Turkey, UCT, US/Alaska, US/Aleutian, US/Arizona, US/Central, US/East-Indiana, US/Eastern, US/Hawaii, US/Indiana-Starke, US/Michigan, US/Mountain, US/Pacific, US/Samoa, UTC, Universal, W-SU, WET, Zulu This string indicates whether the rule will use the issue, standard_alert, or legacy_alert format for mail integration. This string is strictly to be used with the alert log forwarding type. It is not applicable for other log forwarding types. The value fields are analogous to those visible on the UI. This string indicates whether the rule will use the issue, standard_alert, or legacy_alert format for Syslog integration. This string is strictly to be used with the alert log forwarding type. It is not applicable for other log forwarding types. The value fields are analogous to those visible on the UI. This string indicates whether the rule will use the issue or standard_alert format for Slack integration. This string is strictly to be used with the alert log forwarding type. It is not applicable for other log forwarding types. The value fields are analogous to those visible on the UI. Note: the legacy_alert format is not permissible for Slack. This string indicates the user or api-key responsible for creating the notification rule. This value represents the timestamp when the notification rule was created. This value represents the timestamp when the notification rule was last modified. A flag indicating whether the notification rule is currently active and enabled. Metadata for the response 2.3.2.2 |Create a new rule This endpoint allows the user to create a new alert notification rule and specify its attributes. To see the possible forward_type values, please check the relevant enum named LogForwardType for additional information. The forward_source attribute is where a user would define email, Slack, and Syslog configurations; the required formats for these fields are documented in the RuleCreateRequest schema. The applications attribute is a list of external applications application IDs (webhook, AWS S3, AWS SQS, and Splunk). The mail_format, syslog_format, and slack_format attributes represent whether the user would like the notifications for these integrations to be issues or alerts formats; more information is provided in the RuleCreateRequest schema. Enumerates the rule creation request schema for Alert Notifications Name of the rule Optional description of the rule A required value from the LogForwardType Enum. An object containing the various attributes of the filter that will be applied to the given alert notification rule. Please refer to the BaseFilterExample and ComplexFilterExample schemas to gather further information on this field. A user can also derive a filter by utilizing the JSON export functionality when defining a rule via the UI. This JSON object provides the user with the ability to specify configurations for Email, Slack, and Syslog outputs. An object containing all the information that configures email output for the given notification rule. List of valid email addresses that will receive notifications forwarded by the given rule. An integer that is between 0 and 1440 (in minutes). This string value allows the user to customize the mail subject of the event forwarded by the given rule. An object containing all the information that configures Slack output for the given notification rule. List of valid Slack channels that will receive notifications forwarded by the given rule. An object containing all the information that configures Syslog output for the given notification rule. This string value that specifies the Syslog integration that will be associated with the given notification rule. List of valid application IDs (AWS SQS, AWS S3, Splunk, and webhook integrations). These can be found by utilizing the List External Applications API. This string indicates which time zone the rule will be associated with. If the field is not passed in, the default value will be UTC. The following are valid time zone options: Africa/Abidjan, Africa/Accra, Africa/Addis_Ababa, Africa/Algiers, Africa/Asmara, Africa/Asmera, Africa/Bamako, Africa/Bangui, Africa/Banjul, Africa/Bissau, Africa/Blantyre, Africa/Brazzaville, Africa/Bujumbura, Africa/Cairo, Africa/Casablanca, Africa/Ceuta, Africa/Conakry, Africa/Dakar, Africa/Dar_es_Salaam, Africa/Djibouti, Africa/Douala, Africa/El_Aaiun, Africa/Freetown, Africa/Gaborone, Africa/Harare, Africa/Johannesburg, Africa/Juba, Africa/Kampala, Africa/Khartoum, Africa/Kigali, Africa/Kinshasa, Africa/Lagos, Africa/Libreville, Africa/Lome, Africa/Luanda, Africa/Lubumbashi, Africa/Lusaka, Africa/Malabo, Africa/Maputo, Africa/Maseru, Africa/Mbabane, Africa/Mogadishu, Africa/Monrovia, Africa/Nairobi, Africa/Ndjamena, Africa/Niamey, Africa/Nouakchott, Africa/Ouagadougou, Africa/Porto-Novo, Africa/Sao_Tome, Africa/Timbuktu, Africa/Tripoli, Africa/Tunis, Africa/Windhoek, America/Adak, America/Anchorage, America/Anguilla, America/Antigua, America/Araguaina, America/Argentina/Buenos_Aires, America/Argentina/Catamarca, America/Argentina/ComodRivadavia, America/Argentina/Cordoba, America/Argentina/Jujuy, America/Argentina/La_Rioja, America/Argentina/Mendoza, America/Argentina/Rio_Gallegos, America/Argentina/Salta, America/Argentina/San_Juan, America/Argentina/San_Luis, America/Argentina/Tucuman, America/Argentina/Ushuaia, America/Aruba, America/Asuncion, America/Atikokan, America/Atka, America/Bahia, America/Bahia_Banderas, America/Barbados, America/Belem, America/Belize, America/Blanc-Sablon, America/Boa_Vista, America/Bogota, America/Boise, America/Buenos_Aires, America/Cambridge_Bay, America/Campo_Grande, America/Cancun, America/Caracas, America/Catamarca, America/Cayenne, America/Cayman, America/Chicago, America/Chihuahua, America/Ciudad_Juarez, America/Coral_Harbour, America/Cordoba, America/Costa_Rica, America/Coyhaique, America/Creston, America/Cuiaba, America/Curacao, America/Danmarkshavn, America/Dawson, America/Dawson_Creek, America/Denver, America/Detroit, America/Dominica, America/Edmonton, America/Eirunepe, America/El_Salvador, America/Ensenada, America/Fort_Nelson, America/Fort_Wayne, America/Fortaleza, America/Glace_Bay, America/Godthab, America/Goose_Bay, America/Grand_Turk, America/Grenada, America/Guadeloupe, America/Guatemala, America/Guayaquil, America/Guyana, America/Halifax, America/Havana, America/Hermosillo, America/Indiana/Indianapolis, America/Indiana/Knox, America/Indiana/Marengo, America/Indiana/Petersburg, America/Indiana/Tell_City, America/Indiana/Vevay, America/Indiana/Vincennes, America/Indiana/Winamac, America/Indianapolis, America/Inuvik, America/Iqaluit, America/Jamaica, America/Jujuy, America/Juneau, America/Kentucky/Louisville, America/Kentucky/Monticello, America/Knox_IN, America/Kralendijk, America/La_Paz, America/Lima, America/Los_Angeles, America/Louisville, America/Lower_Princes, America/Maceio, America/Managua, America/Manaus, America/Marigot, America/Martinique, America/Matamoros, America/Mazatlan, America/Mendoza, America/Menominee, America/Merida, America/Metlakatla, America/Mexico_City, America/Miquelon, America/Moncton, America/Monterrey, America/Montevideo, America/Montreal, America/Montserrat, America/Nassau, America/New_York, America/Nipigon, America/Nome, America/Noronha, America/North_Dakota/Beulah, America/North_Dakota/Center, America/North_Dakota/New_Salem, America/Nuuk, America/Ojinaga, America/Panama, America/Pangnirtung, America/Paramaribo, America/Phoenix, America/Port-au-Prince, America/Port_of_Spain, America/Porto_Acre, America/Porto_Velho, America/Puerto_Rico, America/Punta_Arenas, America/Rainy_River, America/Rankin_Inlet, America/Recife, America/Regina, America/Resolute, America/Rio_Branco, America/Rosario, America/Santa_Isabel, America/Santarem, America/Santiago, America/Santo_Domingo, America/Sao_Paulo, America/Scoresbysund, America/Shiprock, America/Sitka, America/St_Barthelemy, America/St_Johns, America/St_Kitts, America/St_Lucia, America/St_Thomas, America/St_Vincent, America/Swift_Current, America/Tegucigalpa, America/Thule, America/Thunder_Bay, America/Tijuana, America/Toronto, America/Tortola, America/Vancouver, America/Virgin, America/Whitehorse, America/Winnipeg, America/Yakutat, America/Yellowknife, Antarctica/Casey, Antarctica/Davis, Antarctica/DumontDUrville, Antarctica/Macquarie, Antarctica/Mawson, Antarctica/McMurdo, Antarctica/Palmer, Antarctica/Rothera, Antarctica/South_Pole, Antarctica/Syowa, Antarctica/Troll, Antarctica/Vostok, Arctic/Longyearbyen, Asia/Aden, Asia/Almaty, Asia/Amman, Asia/Anadyr, Asia/Aqtau, Asia/Aqtobe, Asia/Ashgabat, Asia/Ashkhabad, Asia/Atyrau, Asia/Baghdad, Asia/Bahrain, Asia/Baku, Asia/Bangkok, Asia/Barnaul, Asia/Beirut, Asia/Bishkek, Asia/Brunei, Asia/Calcutta, Asia/Chita, Asia/Choibalsan, Asia/Chongqing, Asia/Chungking, Asia/Colombo, Asia/Dacca, Asia/Damascus, Asia/Dhaka, Asia/Dili, Asia/Dubai, Asia/Dushanbe, Asia/Famagusta, Asia/Gaza, Asia/Harbin, Asia/Hebron, Asia/Ho_Chi_Minh, Asia/Hong_Kong, Asia/Hovd, Asia/Irkutsk, Asia/Istanbul, Asia/Jakarta, Asia/Jayapura, Asia/Jerusalem, Asia/Kabul, Asia/Kamchatka, Asia/Karachi, Asia/Kashgar, Asia/Kathmandu, Asia/Katmandu, Asia/Khandyga, Asia/Kolkata, Asia/Krasnoyarsk, Asia/Kuala_Lumpur, Asia/Kuching, Asia/Kuwait, Asia/Macao, Asia/Macau, Asia/Magadan, Asia/Makassar, Asia/Manila, Asia/Muscat, Asia/Nicosia, Asia/Novokuznetsk, Asia/Novosibirsk, Asia/Omsk, Asia/Oral, Asia/Phnom_Penh, Asia/Pontianak, Asia/Pyongyang, Asia/Qatar, Asia/Qostanay, Asia/Qyzylorda, Asia/Rangoon, Asia/Riyadh, Asia/Saigon, Asia/Sakhalin, Asia/Samarkand, Asia/Seoul, Asia/Shanghai, Asia/Singapore, Asia/Srednekolymsk, Asia/Taipei, Asia/Tashkent, Asia/Tbilisi, Asia/Tehran, Asia/Tel_Aviv, Asia/Thimbu, Asia/Thimphu, Asia/Tokyo, Asia/Tomsk, Asia/Ujung_Pandang, Asia/Ulaanbaatar, Asia/Ulan_Bator, Asia/Urumqi, Asia/Ust-Nera, Asia/Vientiane, Asia/Vladivostok, Asia/Yakutsk, Asia/Yangon, Asia/Yekaterinburg, Asia/Yerevan, Atlantic/Azores, Atlantic/Bermuda, Atlantic/Canary, Atlantic/Cape_Verde, Atlantic/Faeroe, Atlantic/Faroe, Atlantic/Jan_Mayen, Atlantic/Madeira, Atlantic/Reykjavik, Atlantic/South_Georgia, Atlantic/St_Helena, Atlantic/Stanley, Australia/ACT, Australia/Adelaide, Australia/Brisbane, Australia/Broken_Hill, Australia/Canberra, Australia/Currie, Australia/Darwin, Australia/Eucla, Australia/Hobart, Australia/LHI, Australia/Lindeman, Australia/Lord_Howe, Australia/Melbourne, Australia/NSW, Australia/North, Australia/Perth, Australia/Queensland, Australia/South, Australia/Sydney, Australia/Tasmania, Australia/Victoria, Australia/West, Australia/Yancowinna, Brazil/Acre, Brazil/DeNoronha, Brazil/East, Brazil/West, CET, CST6CDT, Canada/Atlantic, Canada/Central, Canada/Eastern, Canada/Mountain, Canada/Newfoundland, Canada/Pacific, Canada/Saskatchewan, Canada/Yukon, Chile/Continental, Chile/EasterIsland, Cuba, EET, EST, EST5EDT, Egypt, Eire, Etc/GMT, Etc/GMT+0, Etc/GMT+1, Etc/GMT+10, Etc/GMT+11, Etc/GMT+12, Etc/GMT+2, Etc/GMT+3, Etc/GMT+4, Etc/GMT+5, Etc/GMT+6, Etc/GMT+7, Etc/GMT+8, Etc/GMT+9, Etc/GMT-0, Etc/GMT-1, Etc/GMT-10, Etc/GMT-11, Etc/GMT-12, Etc/GMT-13, Etc/GMT-14, Etc/GMT-2, Etc/GMT-3, Etc/GMT-4, Etc/GMT-5, Etc/GMT-6, Etc/GMT-7, Etc/GMT-8, Etc/GMT-9, Etc/GMT0, Etc/Greenwich, Etc/UCT, Etc/UTC, Etc/Universal, Etc/Zulu, Europe/Amsterdam, Europe/Andorra, Europe/Astrakhan, Europe/Athens, Europe/Belfast, Europe/Belgrade, Europe/Berlin, Europe/Bratislava, Europe/Brussels, Europe/Bucharest, Europe/Budapest, Europe/Busingen, Europe/Chisinau, Europe/Copenhagen, Europe/Dublin, Europe/Gibraltar, Europe/Guernsey, Europe/Helsinki, Europe/Isle_of_Man, Europe/Istanbul, Europe/Jersey, Europe/Kaliningrad, Europe/Kiev, Europe/Kirov, Europe/Kyiv, Europe/Lisbon, Europe/Ljubljana, Europe/London, Europe/Luxembourg, Europe/Madrid, Europe/Malta, Europe/Mariehamn, Europe/Minsk, Europe/Monaco, Europe/Moscow, Europe/Nicosia, Europe/Oslo, Europe/Paris, Europe/Podgorica, Europe/Prague, Europe/Riga, Europe/Rome, Europe/Samara, Europe/San_Marino, Europe/Sarajevo, Europe/Saratov, Europe/Simferopol, Europe/Skopje, Europe/Sofia, Europe/Stockholm, Europe/Tallinn, Europe/Tirane, Europe/Tiraspol, Europe/Ulyanovsk, Europe/Uzhgorod, Europe/Vaduz, Europe/Vatican, Europe/Vienna, Europe/Vilnius, Europe/Volgograd, Europe/Warsaw, Europe/Zagreb, Europe/Zaporozhye, Europe/Zurich, GB, GB-Eire, GMT, GMT+0, GMT-0, GMT0, Greenwich, HST, Hongkong, Iceland, Indian/Antananarivo, Indian/Chagos, Indian/Christmas, Indian/Cocos, Indian/Comoro, Indian/Kerguelen, Indian/Mahe, Indian/Maldives, Indian/Mauritius, Indian/Mayotte, Indian/Reunion, Iran, Israel, Jamaica, Japan, Kwajalein, Libya, MET, MST, MST7MDT, Mexico/BajaNorte, Mexico/BajaSur, Mexico/General, NZ, NZ-CHAT, Navajo, PRC, PST8PDT, Pacific/Apia, Pacific/Auckland, Pacific/Bougainville, Pacific/Chatham, Pacific/Chuuk, Pacific/Easter, Pacific/Efate, Pacific/Enderbury, Pacific/Fakaofo, Pacific/Fiji, Pacific/Funafuti, Pacific/Galapagos, Pacific/Gambier, Pacific/Guadalcanal, Pacific/Guam, Pacific/Honolulu, Pacific/Johnston, Pacific/Kanton, Pacific/Kiritimati, Pacific/Kosrae, Pacific/Kwajalein, Pacific/Majuro, Pacific/Marquesas, Pacific/Midway, Pacific/Nauru, Pacific/Niue, Pacific/Norfolk, Pacific/Noumea, Pacific/Pago_Pago, Pacific/Palau, Pacific/Pitcairn, Pacific/Pohnpei, Pacific/Ponape, Pacific/Port_Moresby, Pacific/Rarotonga, Pacific/Saipan, Pacific/Samoa, Pacific/Tahiti, Pacific/Tarawa, Pacific/Tongatapu, Pacific/Truk, Pacific/Wake, Pacific/Wallis, Pacific/Yap, Poland, Portugal, ROC, ROK, Singapore, Turkey, UCT, US/Alaska, US/Aleutian, US/Arizona, US/Central, US/East-Indiana, US/Eastern, US/Hawaii, US/Indiana-Starke, US/Michigan, US/Mountain, US/Pacific, US/Samoa, UTC, Universal, W-SU, WET, Zulu This string indicates whether the rule will use the issue, standard_alert, or legacy_alert format for mail integration. This string is strictly to be used with the alert log forwarding type. It is not applicable for other log forwarding types. The value fields are analogous to those visible on the UI. This string indicates whether the rule will use the issue, standard_alert, or legacy_alert format for Syslog integration. This string is strictly to be used with the alert log forwarding type. It is not applicable for other log forwarding types. The value fields are analogous to those visible on the UI. This string indicates whether the rule will use the issue or standard_alert format for Slack integration. This string is strictly to be used with the alert log forwarding type. It is not applicable for other log forwarding types. The value fields are analogous to those visible on the UI.Not: the legacy_alert format is not permissible for Slack. The unique identifier of the rule This boolean value signifies whether the legacy mail format is being utilized (applicable only for legacy Xpanse tenant) This string indicates whether the rule will use the issue or standard_alert format for Slack integration. This string is strictly to be used with the alert log forwarding type. It is not applicable for other log forwarding types. The value fields are analogous to those visible on the UI. Note: the legacy_alert format is not permissible for Slack. This string indicates the user or api-key responsible for creating the notification rule. This value represents the timestamp when the notification rule was created. This value represents the timestamp when the notification rule was last modified. A flag indicating whether the notification rule is currently active and enabled. Error message describing the issue Additional error details 2.3.2.3 |Retrieve a specific alert notification rule This endpoint retrieves an alert notification rule and returns its attributes. The meaning behind all attributes in this response could be found in the Rule schema. Please note that the field legacy_mail_format is set to False for all rules that were not created in legacy Xpanse environments. Full rule uuid of the Alert Notification Rule Successfully retrieved rule Enumerates the various attributes of an alert notification rule that is returned via numerous flows. Name of the rule The unique identifier of the rule Optional description of the rule A required value from the LogForwardType Enum. An object containing the various attributes of the filter that will be applied to the given alert notification rule. Please refer to the BaseFilterExample and ComplexFilterExample schemas to gather further information on this field. A user can also derive a filter by utilizing the JSON export functionality when defining a rule via the UI. This JSON object provides the user with the ability to specify configurations for Email, Slack, and Syslog outputs. An object containing all the information that configures email output for the given notification rule. List of valid email addresses that will receive notifications forwarded by the given rule. An integer that is between 0 and 1440 (in minutes). This string value allows the user to customize the mail subject of the event forwarded by the given rule. This boolean value signifies whether the legacy mail format is being utilized (applicable only for legacy Xpanse tenant) An object containing all the information that configures Slack output for the given notification rule. List of valid Slack channels that will receive notifications forwarded by the given rule. An object containing all the information that configures Syslog output for the given notification rule. This string value that specifies the Syslog integration that will be associated with the given notification rule. List of valid application IDs (AWS SQS, AWS S3, Splunk, and webhook integrations). These can be found by utilizing the List External Applications API. This string indicates which time zone the rule will be associated with. If the field is not passed in, the default value will be UTC. The following are valid time zone options: Africa/Abidjan, Africa/Accra, Africa/Addis_Ababa, Africa/Algiers, Africa/Asmara, Africa/Asmera, Africa/Bamako, Africa/Bangui, Africa/Banjul, Africa/Bissau, Africa/Blantyre, Africa/Brazzaville, Africa/Bujumbura, Africa/Cairo, Africa/Casablanca, Africa/Ceuta, Africa/Conakry, Africa/Dakar, Africa/Dar_es_Salaam, Africa/Djibouti, Africa/Douala, Africa/El_Aaiun, Africa/Freetown, Africa/Gaborone, Africa/Harare, Africa/Johannesburg, Africa/Juba, Africa/Kampala, Africa/Khartoum, Africa/Kigali, Africa/Kinshasa, Africa/Lagos, Africa/Libreville, Africa/Lome, Africa/Luanda, Africa/Lubumbashi, Africa/Lusaka, Africa/Malabo, Africa/Maputo, Africa/Maseru, Africa/Mbabane, Africa/Mogadishu, Africa/Monrovia, Africa/Nairobi, Africa/Ndjamena, Africa/Niamey, Africa/Nouakchott, Africa/Ouagadougou, Africa/Porto-Novo, Africa/Sao_Tome, Africa/Timbuktu, Africa/Tripoli, Africa/Tunis, Africa/Windhoek, America/Adak, America/Anchorage, America/Anguilla, America/Antigua, America/Araguaina, America/Argentina/Buenos_Aires, America/Argentina/Catamarca, America/Argentina/ComodRivadavia, America/Argentina/Cordoba, America/Argentina/Jujuy, America/Argentina/La_Rioja, America/Argentina/Mendoza, America/Argentina/Rio_Gallegos, America/Argentina/Salta, America/Argentina/San_Juan, America/Argentina/San_Luis, America/Argentina/Tucuman, America/Argentina/Ushuaia, America/Aruba, America/Asuncion, America/Atikokan, America/Atka, America/Bahia, America/Bahia_Banderas, America/Barbados, America/Belem, America/Belize, America/Blanc-Sablon, America/Boa_Vista, America/Bogota, America/Boise, America/Buenos_Aires, America/Cambridge_Bay, America/Campo_Grande, America/Cancun, America/Caracas, America/Catamarca, America/Cayenne, America/Cayman, America/Chicago, America/Chihuahua, America/Ciudad_Juarez, America/Coral_Harbour, America/Cordoba, America/Costa_Rica, America/Coyhaique, America/Creston, America/Cuiaba, America/Curacao, America/Danmarkshavn, America/Dawson, America/Dawson_Creek, America/Denver, America/Detroit, America/Dominica, America/Edmonton, America/Eirunepe, America/El_Salvador, America/Ensenada, America/Fort_Nelson, America/Fort_Wayne, America/Fortaleza, America/Glace_Bay, America/Godthab, America/Goose_Bay, America/Grand_Turk, America/Grenada, America/Guadeloupe, America/Guatemala, America/Guayaquil, America/Guyana, America/Halifax, America/Havana, America/Hermosillo, America/Indiana/Indianapolis, America/Indiana/Knox, America/Indiana/Marengo, America/Indiana/Petersburg, America/Indiana/Tell_City, America/Indiana/Vevay, America/Indiana/Vincennes, America/Indiana/Winamac, America/Indianapolis, America/Inuvik, America/Iqaluit, America/Jamaica, America/Jujuy, America/Juneau, America/Kentucky/Louisville, America/Kentucky/Monticello, America/Knox_IN, America/Kralendijk, America/La_Paz, America/Lima, America/Los_Angeles, America/Louisville, America/Lower_Princes, America/Maceio, America/Managua, America/Manaus, America/Marigot, America/Martinique, America/Matamoros, America/Mazatlan, America/Mendoza, America/Menominee, America/Merida, America/Metlakatla, America/Mexico_City, America/Miquelon, America/Moncton, America/Monterrey, America/Montevideo, America/Montreal, America/Montserrat, America/Nassau, America/New_York, America/Nipigon, America/Nome, America/Noronha, America/North_Dakota/Beulah, America/North_Dakota/Center, America/North_Dakota/New_Salem, America/Nuuk, America/Ojinaga, America/Panama, America/Pangnirtung, America/Paramaribo, America/Phoenix, America/Port-au-Prince, America/Port_of_Spain, America/Porto_Acre, America/Porto_Velho, America/Puerto_Rico, America/Punta_Arenas, America/Rainy_River, America/Rankin_Inlet, America/Recife, America/Regina, America/Resolute, America/Rio_Branco, America/Rosario, America/Santa_Isabel, America/Santarem, America/Santiago, America/Santo_Domingo, America/Sao_Paulo, America/Scoresbysund, America/Shiprock, America/Sitka, America/St_Barthelemy, America/St_Johns, America/St_Kitts, America/St_Lucia, America/St_Thomas, America/St_Vincent, America/Swift_Current, America/Tegucigalpa, America/Thule, America/Thunder_Bay, America/Tijuana, America/Toronto, America/Tortola, America/Vancouver, America/Virgin, America/Whitehorse, America/Winnipeg, America/Yakutat, America/Yellowknife, Antarctica/Casey, Antarctica/Davis, Antarctica/DumontDUrville, Antarctica/Macquarie, Antarctica/Mawson, Antarctica/McMurdo, Antarctica/Palmer, Antarctica/Rothera, Antarctica/South_Pole, Antarctica/Syowa, Antarctica/Troll, Antarctica/Vostok, Arctic/Longyearbyen, Asia/Aden, Asia/Almaty, Asia/Amman, Asia/Anadyr, Asia/Aqtau, Asia/Aqtobe, Asia/Ashgabat, Asia/Ashkhabad, Asia/Atyrau, Asia/Baghdad, Asia/Bahrain, Asia/Baku, Asia/Bangkok, Asia/Barnaul, Asia/Beirut, Asia/Bishkek, Asia/Brunei, Asia/Calcutta, Asia/Chita, Asia/Choibalsan, Asia/Chongqing, Asia/Chungking, Asia/Colombo, Asia/Dacca, Asia/Damascus, Asia/Dhaka, Asia/Dili, Asia/Dubai, Asia/Dushanbe, Asia/Famagusta, Asia/Gaza, Asia/Harbin, Asia/Hebron, Asia/Ho_Chi_Minh, Asia/Hong_Kong, Asia/Hovd, Asia/Irkutsk, Asia/Istanbul, Asia/Jakarta, Asia/Jayapura, Asia/Jerusalem, Asia/Kabul, Asia/Kamchatka, Asia/Karachi, Asia/Kashgar, Asia/Kathmandu, Asia/Katmandu, Asia/Khandyga, Asia/Kolkata, Asia/Krasnoyarsk, Asia/Kuala_Lumpur, Asia/Kuching, Asia/Kuwait, Asia/Macao, Asia/Macau, Asia/Magadan, Asia/Makassar, Asia/Manila, Asia/Muscat, Asia/Nicosia, Asia/Novokuznetsk, Asia/Novosibirsk, Asia/Omsk, Asia/Oral, Asia/Phnom_Penh, Asia/Pontianak, Asia/Pyongyang, Asia/Qatar, Asia/Qostanay, Asia/Qyzylorda, Asia/Rangoon, Asia/Riyadh, Asia/Saigon, Asia/Sakhalin, Asia/Samarkand, Asia/Seoul, Asia/Shanghai, Asia/Singapore, Asia/Srednekolymsk, Asia/Taipei, Asia/Tashkent, Asia/Tbilisi, Asia/Tehran, Asia/Tel_Aviv, Asia/Thimbu, Asia/Thimphu, Asia/Tokyo, Asia/Tomsk, Asia/Ujung_Pandang, Asia/Ulaanbaatar, Asia/Ulan_Bator, Asia/Urumqi, Asia/Ust-Nera, Asia/Vientiane, Asia/Vladivostok, Asia/Yakutsk, Asia/Yangon, Asia/Yekaterinburg, Asia/Yerevan, Atlantic/Azores, Atlantic/Bermuda, Atlantic/Canary, Atlantic/Cape_Verde, Atlantic/Faeroe, Atlantic/Faroe, Atlantic/Jan_Mayen, Atlantic/Madeira, Atlantic/Reykjavik, Atlantic/South_Georgia, Atlantic/St_Helena, Atlantic/Stanley, Australia/ACT, Australia/Adelaide, Australia/Brisbane, Australia/Broken_Hill, Australia/Canberra, Australia/Currie, Australia/Darwin, Australia/Eucla, Australia/Hobart, Australia/LHI, Australia/Lindeman, Australia/Lord_Howe, Australia/Melbourne, Australia/NSW, Australia/North, Australia/Perth, Australia/Queensland, Australia/South, Australia/Sydney, Australia/Tasmania, Australia/Victoria, Australia/West, Australia/Yancowinna, Brazil/Acre, Brazil/DeNoronha, Brazil/East, Brazil/West, CET, CST6CDT, Canada/Atlantic, Canada/Central, Canada/Eastern, Canada/Mountain, Canada/Newfoundland, Canada/Pacific, Canada/Saskatchewan, Canada/Yukon, Chile/Continental, Chile/EasterIsland, Cuba, EET, EST, EST5EDT, Egypt, Eire, Etc/GMT, Etc/GMT+0, Etc/GMT+1, Etc/GMT+10, Etc/GMT+11, Etc/GMT+12, Etc/GMT+2, Etc/GMT+3, Etc/GMT+4, Etc/GMT+5, Etc/GMT+6, Etc/GMT+7, Etc/GMT+8, Etc/GMT+9, Etc/GMT-0, Etc/GMT-1, Etc/GMT-10, Etc/GMT-11, Etc/GMT-12, Etc/GMT-13, Etc/GMT-14, Etc/GMT-2, Etc/GMT-3, Etc/GMT-4, Etc/GMT-5, Etc/GMT-6, Etc/GMT-7, Etc/GMT-8, Etc/GMT-9, Etc/GMT0, Etc/Greenwich, Etc/UCT, Etc/UTC, Etc/Universal, Etc/Zulu, Europe/Amsterdam, Europe/Andorra, Europe/Astrakhan, Europe/Athens, Europe/Belfast, Europe/Belgrade, Europe/Berlin, Europe/Bratislava, Europe/Brussels, Europe/Bucharest, Europe/Budapest, Europe/Busingen, Europe/Chisinau, Europe/Copenhagen, Europe/Dublin, Europe/Gibraltar, Europe/Guernsey, Europe/Helsinki, Europe/Isle_of_Man, Europe/Istanbul, Europe/Jersey, Europe/Kaliningrad, Europe/Kiev, Europe/Kirov, Europe/Kyiv, Europe/Lisbon, Europe/Ljubljana, Europe/London, Europe/Luxembourg, Europe/Madrid, Europe/Malta, Europe/Mariehamn, Europe/Minsk, Europe/Monaco, Europe/Moscow, Europe/Nicosia, Europe/Oslo, Europe/Paris, Europe/Podgorica, Europe/Prague, Europe/Riga, Europe/Rome, Europe/Samara, Europe/San_Marino, Europe/Sarajevo, Europe/Saratov, Europe/Simferopol, Europe/Skopje, Europe/Sofia, Europe/Stockholm, Europe/Tallinn, Europe/Tirane, Europe/Tiraspol, Europe/Ulyanovsk, Europe/Uzhgorod, Europe/Vaduz, Europe/Vatican, Europe/Vienna, Europe/Vilnius, Europe/Volgograd, Europe/Warsaw, Europe/Zagreb, Europe/Zaporozhye, Europe/Zurich, GB, GB-Eire, GMT, GMT+0, GMT-0, GMT0, Greenwich, HST, Hongkong, Iceland, Indian/Antananarivo, Indian/Chagos, Indian/Christmas, Indian/Cocos, Indian/Comoro, Indian/Kerguelen, Indian/Mahe, Indian/Maldives, Indian/Mauritius, Indian/Mayotte, Indian/Reunion, Iran, Israel, Jamaica, Japan, Kwajalein, Libya, MET, MST, MST7MDT, Mexico/BajaNorte, Mexico/BajaSur, Mexico/General, NZ, NZ-CHAT, Navajo, PRC, PST8PDT, Pacific/Apia, Pacific/Auckland, Pacific/Bougainville, Pacific/Chatham, Pacific/Chuuk, Pacific/Easter, Pacific/Efate, Pacific/Enderbury, Pacific/Fakaofo, Pacific/Fiji, Pacific/Funafuti, Pacific/Galapagos, Pacific/Gambier, Pacific/Guadalcanal, Pacific/Guam, Pacific/Honolulu, Pacific/Johnston, Pacific/Kanton, Pacific/Kiritimati, Pacific/Kosrae, Pacific/Kwajalein, Pacific/Majuro, Pacific/Marquesas, Pacific/Midway, Pacific/Nauru, Pacific/Niue, Pacific/Norfolk, Pacific/Noumea, Pacific/Pago_Pago, Pacific/Palau, Pacific/Pitcairn, Pacific/Pohnpei, Pacific/Ponape, Pacific/Port_Moresby, Pacific/Rarotonga, Pacific/Saipan, Pacific/Samoa, Pacific/Tahiti, Pacific/Tarawa, Pacific/Tongatapu, Pacific/Truk, Pacific/Wake, Pacific/Wallis, Pacific/Yap, Poland, Portugal, ROC, ROK, Singapore, Turkey, UCT, US/Alaska, US/Aleutian, US/Arizona, US/Central, US/East-Indiana, US/Eastern, US/Hawaii, US/Indiana-Starke, US/Michigan, US/Mountain, US/Pacific, US/Samoa, UTC, Universal, W-SU, WET, Zulu This string indicates whether the rule will use the issue, standard_alert, or legacy_alert format for mail integration. This string is strictly to be used with the alert log forwarding type. It is not applicable for other log forwarding types. The value fields are analogous to those visible on the UI. This string indicates whether the rule will use the issue, standard_alert, or legacy_alert format for Syslog integration. This string is strictly to be used with the alert log forwarding type. It is not applicable for other log forwarding types. The value fields are analogous to those visible on the UI. This string indicates whether the rule will use the issue or standard_alert format for Slack integration. This string is strictly to be used with the alert log forwarding type. It is not applicable for other log forwarding types. The value fields are analogous to those visible on the UI. Note: the legacy_alert format is not permissible for Slack. This string indicates the user or api-key responsible for creating the notification rule. This value represents the timestamp when the notification rule was created. This value represents the timestamp when the notification rule was last modified. A flag indicating whether the notification rule is currently active and enabled. Error message describing the issue Additional error details 2.3.2.4 |Delete an existing Alert Notification Rule Allows the user to delete an existing Alert Notification Rule by its unique identifier. Full rule uuid of the Alert Notification Rule Error message describing the issue Additional error details 2.3.2.5 |Edit an existing Alert Notification Rule This endpoint allows the user to edit an alert notification rule and specify its new attributes. To see the possible forward_type values, please check the relevant enum schema named LogForwardType. The forward_source attribute is where a user would define email, Slack, and Syslog configurations; the required formats are specified in the RuleEditRequestschema. The applications attribute is a list of external applications application IDs (webhook, AWS S3, AWS SQS, and Splunk). The mail_format, syslog_format, and slack_format attributes represent whether the user would like the notifications for these integrations to be issues or alerts formats; more information is provided in the RuleEditRequest schema. Please note that you can only edit a rule that is in an Enabled state. Full rule uuid of the Alert Notification Rule Enumerates the various attributes required for editing an existing notification rule Name of the rule Optional description of the rule A required value from the LogForwardType Enum. It must be the same as its current forward_type as this field is not mutable during edits. An object containing the various attributes of the filter that will be applied to the given alert notification rule. Please refer to the BaseFilterExample and ComplexFilterExample schemas to gather further information on this field. A user can also derive a filter by utilizing the JSON export functionality when defining a rule via the UI. This JSON object provides the user with the ability to specify configurations for Email, Slack, and Syslog outputs. An object containing all the information that configures email output for the given notification rule. List of valid email addresses that will receive notifications forwarded by the given rule. An integer that is between 0 and 1440 (in minutes). The default is 10 minutes. This string value allows the user to customize the mail subject of the event forwarded by the given rule. An object containing all the information that configures Slack output for the given notification rule. List of valid Slack channels that will receive notifications forwarded by the given rule. An object containing all the information that configures Syslog output for the given notification rule. This string value that specifies the Syslog integration that will be associated with the given notification rule. List of valid application IDs (AWS SQS, AWS S3, Splunk, and webhook integrations). These can be found by utilizing the List External Applications API. This string indicates which time zone the rule will be associated with. If the field is not passed in, the default value will be UTC. The following are valid time zone options: Africa/Abidjan, Africa/Accra, Africa/Addis_Ababa, Africa/Algiers, Africa/Asmara, Africa/Asmera, Africa/Bamako, Africa/Bangui, Africa/Banjul, Africa/Bissau, Africa/Blantyre, Africa/Brazzaville, Africa/Bujumbura, Africa/Cairo, Africa/Casablanca, Africa/Ceuta, Africa/Conakry, Africa/Dakar, Africa/Dar_es_Salaam, Africa/Djibouti, Africa/Douala, Africa/El_Aaiun, Africa/Freetown, Africa/Gaborone, Africa/Harare, Africa/Johannesburg, Africa/Juba, Africa/Kampala, Africa/Khartoum, Africa/Kigali, Africa/Kinshasa, Africa/Lagos, Africa/Libreville, Africa/Lome, Africa/Luanda, Africa/Lubumbashi, Africa/Lusaka, Africa/Malabo, Africa/Maputo, Africa/Maseru, Africa/Mbabane, Africa/Mogadishu, Africa/Monrovia, Africa/Nairobi, Africa/Ndjamena, Africa/Niamey, Africa/Nouakchott, Africa/Ouagadougou, Africa/Porto-Novo, Africa/Sao_Tome, Africa/Timbuktu, Africa/Tripoli, Africa/Tunis, Africa/Windhoek, America/Adak, America/Anchorage, America/Anguilla, America/Antigua, America/Araguaina, America/Argentina/Buenos_Aires, America/Argentina/Catamarca, America/Argentina/ComodRivadavia, America/Argentina/Cordoba, America/Argentina/Jujuy, America/Argentina/La_Rioja, America/Argentina/Mendoza, America/Argentina/Rio_Gallegos, America/Argentina/Salta, America/Argentina/San_Juan, America/Argentina/San_Luis, America/Argentina/Tucuman, America/Argentina/Ushuaia, America/Aruba, America/Asuncion, America/Atikokan, America/Atka, America/Bahia, America/Bahia_Banderas, America/Barbados, America/Belem, America/Belize, America/Blanc-Sablon, America/Boa_Vista, America/Bogota, America/Boise, America/Buenos_Aires, America/Cambridge_Bay, America/Campo_Grande, America/Cancun, America/Caracas, America/Catamarca, America/Cayenne, America/Cayman, America/Chicago, America/Chihuahua, America/Ciudad_Juarez, America/Coral_Harbour, America/Cordoba, America/Costa_Rica, America/Coyhaique, America/Creston, America/Cuiaba, America/Curacao, America/Danmarkshavn, America/Dawson, America/Dawson_Creek, America/Denver, America/Detroit, America/Dominica, America/Edmonton, America/Eirunepe, America/El_Salvador, America/Ensenada, America/Fort_Nelson, America/Fort_Wayne, America/Fortaleza, America/Glace_Bay, America/Godthab, America/Goose_Bay, America/Grand_Turk, America/Grenada, America/Guadeloupe, America/Guatemala, America/Guayaquil, America/Guyana, America/Halifax, America/Havana, America/Hermosillo, America/Indiana/Indianapolis, America/Indiana/Knox, America/Indiana/Marengo, America/Indiana/Petersburg, America/Indiana/Tell_City, America/Indiana/Vevay, America/Indiana/Vincennes, America/Indiana/Winamac, America/Indianapolis, America/Inuvik, America/Iqaluit, America/Jamaica, America/Jujuy, America/Juneau, America/Kentucky/Louisville, America/Kentucky/Monticello, America/Knox_IN, America/Kralendijk, America/La_Paz, America/Lima, America/Los_Angeles, America/Louisville, America/Lower_Princes, America/Maceio, America/Managua, America/Manaus, America/Marigot, America/Martinique, America/Matamoros, America/Mazatlan, America/Mendoza, America/Menominee, America/Merida, America/Metlakatla, America/Mexico_City, America/Miquelon, America/Moncton, America/Monterrey, America/Montevideo, America/Montreal, America/Montserrat, America/Nassau, America/New_York, America/Nipigon, America/Nome, America/Noronha, America/North_Dakota/Beulah, America/North_Dakota/Center, America/North_Dakota/New_Salem, America/Nuuk, America/Ojinaga, America/Panama, America/Pangnirtung, America/Paramaribo, America/Phoenix, America/Port-au-Prince, America/Port_of_Spain, America/Porto_Acre, America/Porto_Velho, America/Puerto_Rico, America/Punta_Arenas, America/Rainy_River, America/Rankin_Inlet, America/Recife, America/Regina, America/Resolute, America/Rio_Branco, America/Rosario, America/Santa_Isabel, America/Santarem, America/Santiago, America/Santo_Domingo, America/Sao_Paulo, America/Scoresbysund, America/Shiprock, America/Sitka, America/St_Barthelemy, America/St_Johns, America/St_Kitts, America/St_Lucia, America/St_Thomas, America/St_Vincent, America/Swift_Current, America/Tegucigalpa, America/Thule, America/Thunder_Bay, America/Tijuana, America/Toronto, America/Tortola, America/Vancouver, America/Virgin, America/Whitehorse, America/Winnipeg, America/Yakutat, America/Yellowknife, Antarctica/Casey, Antarctica/Davis, Antarctica/DumontDUrville, Antarctica/Macquarie, Antarctica/Mawson, Antarctica/McMurdo, Antarctica/Palmer, Antarctica/Rothera, Antarctica/South_Pole, Antarctica/Syowa, Antarctica/Troll, Antarctica/Vostok, Arctic/Longyearbyen, Asia/Aden, Asia/Almaty, Asia/Amman, Asia/Anadyr, Asia/Aqtau, Asia/Aqtobe, Asia/Ashgabat, Asia/Ashkhabad, Asia/Atyrau, Asia/Baghdad, Asia/Bahrain, Asia/Baku, Asia/Bangkok, Asia/Barnaul, Asia/Beirut, Asia/Bishkek, Asia/Brunei, Asia/Calcutta, Asia/Chita, Asia/Choibalsan, Asia/Chongqing, Asia/Chungking, Asia/Colombo, Asia/Dacca, Asia/Damascus, Asia/Dhaka, Asia/Dili, Asia/Dubai, Asia/Dushanbe, Asia/Famagusta, Asia/Gaza, Asia/Harbin, Asia/Hebron, Asia/Ho_Chi_Minh, Asia/Hong_Kong, Asia/Hovd, Asia/Irkutsk, Asia/Istanbul, Asia/Jakarta, Asia/Jayapura, Asia/Jerusalem, Asia/Kabul, Asia/Kamchatka, Asia/Karachi, Asia/Kashgar, Asia/Kathmandu, Asia/Katmandu, Asia/Khandyga, Asia/Kolkata, Asia/Krasnoyarsk, Asia/Kuala_Lumpur, Asia/Kuching, Asia/Kuwait, Asia/Macao, Asia/Macau, Asia/Magadan, Asia/Makassar, Asia/Manila, Asia/Muscat, Asia/Nicosia, Asia/Novokuznetsk, Asia/Novosibirsk, Asia/Omsk, Asia/Oral, Asia/Phnom_Penh, Asia/Pontianak, Asia/Pyongyang, Asia/Qatar, Asia/Qostanay, Asia/Qyzylorda, Asia/Rangoon, Asia/Riyadh, Asia/Saigon, Asia/Sakhalin, Asia/Samarkand, Asia/Seoul, Asia/Shanghai, Asia/Singapore, Asia/Srednekolymsk, Asia/Taipei, Asia/Tashkent, Asia/Tbilisi, Asia/Tehran, Asia/Tel_Aviv, Asia/Thimbu, Asia/Thimphu, Asia/Tokyo, Asia/Tomsk, Asia/Ujung_Pandang, Asia/Ulaanbaatar, Asia/Ulan_Bator, Asia/Urumqi, Asia/Ust-Nera, Asia/Vientiane, Asia/Vladivostok, Asia/Yakutsk, Asia/Yangon, Asia/Yekaterinburg, Asia/Yerevan, Atlantic/Azores, Atlantic/Bermuda, Atlantic/Canary, Atlantic/Cape_Verde, Atlantic/Faeroe, Atlantic/Faroe, Atlantic/Jan_Mayen, Atlantic/Madeira, Atlantic/Reykjavik, Atlantic/South_Georgia, Atlantic/St_Helena, Atlantic/Stanley, Australia/ACT, Australia/Adelaide, Australia/Brisbane, Australia/Broken_Hill, Australia/Canberra, Australia/Currie, Australia/Darwin, Australia/Eucla, Australia/Hobart, Australia/LHI, Australia/Lindeman, Australia/Lord_Howe, Australia/Melbourne, Australia/NSW, Australia/North, Australia/Perth, Australia/Queensland, Australia/South, Australia/Sydney, Australia/Tasmania, Australia/Victoria, Australia/West, Australia/Yancowinna, Brazil/Acre, Brazil/DeNoronha, Brazil/East, Brazil/West, CET, CST6CDT, Canada/Atlantic, Canada/Central, Canada/Eastern, Canada/Mountain, Canada/Newfoundland, Canada/Pacific, Canada/Saskatchewan, Canada/Yukon, Chile/Continental, Chile/EasterIsland, Cuba, EET, EST, EST5EDT, Egypt, Eire, Etc/GMT, Etc/GMT+0, Etc/GMT+1, Etc/GMT+10, Etc/GMT+11, Etc/GMT+12, Etc/GMT+2, Etc/GMT+3, Etc/GMT+4, Etc/GMT+5, Etc/GMT+6, Etc/GMT+7, Etc/GMT+8, Etc/GMT+9, Etc/GMT-0, Etc/GMT-1, Etc/GMT-10, Etc/GMT-11, Etc/GMT-12, Etc/GMT-13, Etc/GMT-14, Etc/GMT-2, Etc/GMT-3, Etc/GMT-4, Etc/GMT-5, Etc/GMT-6, Etc/GMT-7, Etc/GMT-8, Etc/GMT-9, Etc/GMT0, Etc/Greenwich, Etc/UCT, Etc/UTC, Etc/Universal, Etc/Zulu, Europe/Amsterdam, Europe/Andorra, Europe/Astrakhan, Europe/Athens, Europe/Belfast, Europe/Belgrade, Europe/Berlin, Europe/Bratislava, Europe/Brussels, Europe/Bucharest, Europe/Budapest, Europe/Busingen, Europe/Chisinau, Europe/Copenhagen, Europe/Dublin, Europe/Gibraltar, Europe/Guernsey, Europe/Helsinki, Europe/Isle_of_Man, Europe/Istanbul, Europe/Jersey, Europe/Kaliningrad, Europe/Kiev, Europe/Kirov, Europe/Kyiv, Europe/Lisbon, Europe/Ljubljana, Europe/London, Europe/Luxembourg, Europe/Madrid, Europe/Malta, Europe/Mariehamn, Europe/Minsk, Europe/Monaco, Europe/Moscow, Europe/Nicosia, Europe/Oslo, Europe/Paris, Europe/Podgorica, Europe/Prague, Europe/Riga, Europe/Rome, Europe/Samara, Europe/San_Marino, Europe/Sarajevo, Europe/Saratov, Europe/Simferopol, Europe/Skopje, Europe/Sofia, Europe/Stockholm, Europe/Tallinn, Europe/Tirane, Europe/Tiraspol, Europe/Ulyanovsk, Europe/Uzhgorod, Europe/Vaduz, Europe/Vatican, Europe/Vienna, Europe/Vilnius, Europe/Volgograd, Europe/Warsaw, Europe/Zagreb, Europe/Zaporozhye, Europe/Zurich, GB, GB-Eire, GMT, GMT+0, GMT-0, GMT0, Greenwich, HST, Hongkong, Iceland, Indian/Antananarivo, Indian/Chagos, Indian/Christmas, Indian/Cocos, Indian/Comoro, Indian/Kerguelen, Indian/Mahe, Indian/Maldives, Indian/Mauritius, Indian/Mayotte, Indian/Reunion, Iran, Israel, Jamaica, Japan, Kwajalein, Libya, MET, MST, MST7MDT, Mexico/BajaNorte, Mexico/BajaSur, Mexico/General, NZ, NZ-CHAT, Navajo, PRC, PST8PDT, Pacific/Apia, Pacific/Auckland, Pacific/Bougainville, Pacific/Chatham, Pacific/Chuuk, Pacific/Easter, Pacific/Efate, Pacific/Enderbury, Pacific/Fakaofo, Pacific/Fiji, Pacific/Funafuti, Pacific/Galapagos, Pacific/Gambier, Pacific/Guadalcanal, Pacific/Guam, Pacific/Honolulu, Pacific/Johnston, Pacific/Kanton, Pacific/Kiritimati, Pacific/Kosrae, Pacific/Kwajalein, Pacific/Majuro, Pacific/Marquesas, Pacific/Midway, Pacific/Nauru, Pacific/Niue, Pacific/Norfolk, Pacific/Noumea, Pacific/Pago_Pago, Pacific/Palau, Pacific/Pitcairn, Pacific/Pohnpei, Pacific/Ponape, Pacific/Port_Moresby, Pacific/Rarotonga, Pacific/Saipan, Pacific/Samoa, Pacific/Tahiti, Pacific/Tarawa, Pacific/Tongatapu, Pacific/Truk, Pacific/Wake, Pacific/Wallis, Pacific/Yap, Poland, Portugal, ROC, ROK, Singapore, Turkey, UCT, US/Alaska, US/Aleutian, US/Arizona, US/Central, US/East-Indiana, US/Eastern, US/Hawaii, US/Indiana-Starke, US/Michigan, US/Mountain, US/Pacific, US/Samoa, UTC, Universal, W-SU, WET, Zulu This string indicates whether the rule will use the issue, standard_alert, or legacy_alert format for Syslog integration. This string is strictly to be used with the alert log forwarding type. It is not applicable for other log forwarding types. The value fields are analogous to those visible on the UI. This string indicates whether the rule will use the issue or standard_alert format for Slack integration. This string is strictly to be used with the alert log forwarding type. It is not applicable for other log forwarding types. The value fields are analogous to those visible on the UI.Not: the legacy_alert format is not permissible for Slack. The unique identifier of the rule A required value from the LogForwardType Enum. An integer that is between 0 and 1440 (in minutes). This boolean value signifies whether the legacy mail format is being utilized (applicable only for legacy Xpanse tenant) This string indicates whether the rule will use the issue, standard_alert, or legacy_alert format for mail integration. This string is strictly to be used with the alert log forwarding type. It is not applicable for other log forwarding types. The value fields are analogous to those visible on the UI. This string indicates whether the rule will use the issue or standard_alert format for Slack integration. This string is strictly to be used with the alert log forwarding type. It is not applicable for other log forwarding types. The value fields are analogous to those visible on the UI. Note: the legacy_alert format is not permissible for Slack. This string indicates the user or api-key responsible for creating the notification rule. This value represents the timestamp when the notification rule was created. This value represents the timestamp when the notification rule was last modified. A flag indicating whether the notification rule is currently active and enabled. Error message describing the issue Additional error details 2.3.2.6 |Edit the status of an existing Alert Notification Rule This endpoint allows a user to modify a rule's status without requiring a full update. A user can either enable or disable an Alert Notification Rule. Full rule uuid of the Alert Notification Rule Enumerates the various para meters required for updating the status of a rule Value of updated status {enable|disable} Error message describing the issue Additional error details 2.4 |Cortex Cloud External Application Management API This OpenAPI Specification provides documentation about External Applications Public APIs for Cortex Cloud. With these endpoints, you can create, read, update, and delete external applications including webhook, Splunk, AWS SQS, AWS S3, and Syslog integrations. These APIs are intended to be accessed via API keys. Therefore, the key must have the RBAC permission alert_notifications for list & read operations and permission alert_notifications_action for create, edit, enable/disable, & delete operations. 2.4.1 |Preface This OpenAPI Specification provides documentation about External Applications Public APIs for Cortex Cloud. With these endpoints, you can create, read, update, and delete external applications including webhook, Splunk, AWS SQS, AWS S3, and Syslog integrations. These APIs are intended to be accessed via API keys. Therefore, the key must have the RBAC permission alert_notifications for list & read operations and permission alert_notifications_action for create, edit, enable/disable, & delete operations. 2.4.1.1 |Servers 2.4.1.2 |Authentication methods JWT token for authentication Authorized requests to the API should use a header with the access token "TOKEN": Authorization: Bearer TOKEN, The Bearer token is typically represented in the following format: JWT 2.4.2 |External Applications Operations for managing external applications including creating, editing, deleting, and listing external applications. 2.4.2.1 |Create a new application Allows the user to create a new external application integration and specify its attributes. To see the possible application_type values, please check the relevant enum in the ExternalApplication schema for additional information. The connection_config attribute is where a user would define AWS SQS, AWS S3, Splunk, Syslog, and webhook configurations; the required formats for these fields are documented in the respective schemas that are linked to the base ConnectionConfig schema. Please ensure that you have setup the proper egress configurations on the Cortex Gateway; this API verifies the new connection against the egress configurations specified for the given tenant. If assistance is required, please utilize the cue on the UI menu for creating a new external application configuration. Name of the application. Description of the application. The type of application instance. Connection configuration based on application_type. Custom HTTP headers to include. Splunk HTTP Event Collector (HEC) endpoint. HEC authentication token. The SQS queue destination URL. Amazon S3 bucket URI AWS region where the S3 bucket resides Role ARN associated with the IAM role for S3 access Roll-up interval for metrics or data aggregation (in minutes) Choose one of the syslog standard values. The value maps to how your syslog server uses the facility field to manage messages. For details on the facility field, see RFC 5424. IP address or fully qualified domain name (FQDN) of the syslog server. When using TLS for communication between Cortex and the syslog server, Cortex validates that the syslog receiver has a certificate. Specify the certificate name here. Whether to ignore certificate errors. For security reasons, this is not recommended. If you set this to true, logs will be forwarded even if the certificate contains errors. Binary string of the certificate. Omitted on insert Must be supplied on insert, but not readOnly. Application successfully created. Enumerates the various attributes of an external application response object Unique identifier Current status of the application. Timestamp when the application was created. Identifier of the user who created the app. Description summarizing that last known error for the given external application. Timestamp of the last error. Timestamp of the last modification. Error message describing the issue Additional error details 2.4.2.2 |List all applications Retrieves a list of external applications (AWS SQS, AWS S3, Syslog, Splunk, and webhook) and their attributes. The meaning behind all attributes in this response could be found in the ExternalApplication schema. Please note that the field connection_config is retrieved with masked attributes for security purposes; examples are provided in the sample response shown for this endpoint. Please note that the last_modified_by, last_error, and last_error_at attributes are not populated for Syslog integrations. A list of applications. Unique identifier Name of the application. Description of the application. Current status of the application. Timestamp when the application was created. Identifier of the user who created the app. Description summarizing that last known error for the given external application. Timestamp of the last error. Timestamp of the last modification. The type of application instance. Connection configuration based on application_type. Custom HTTP headers to include. Splunk HTTP Event Collector (HEC) endpoint. HEC authentication token. The SQS queue destination URL. Amazon S3 bucket URI AWS region where the S3 bucket resides Role ARN associated with the IAM role for S3 access Roll-up interval for metrics or data aggregation (in minutes) Choose one of the syslog standard values. The value maps to how your syslog server uses the facility field to manage messages. For details on the facility field, see RFC 5424. IP address or fully qualified domain name (FQDN) of the syslog server. When using TLS for communication between Cortex and the syslog server, Cortex validates that the syslog receiver has a certificate. Specify the certificate name here. Whether to ignore certificate errors. For security reasons, this is not recommended. If you set this to true, logs will be forwarded even if the certificate contains errors. Binary string of the certificate. Metadata for the response 2.4.2.3 |Update an existing application (full replacement) Allows the user to edit an external application and specify its new attributes. To see the possible application_type values, please check the relevant enum in the ExternalApplication schema for additional information. The connection_config attribute is where a user would define AWS SQS, AWS S3, Splunk, Syslog, and webhook configurations; the required formats for these fields are documented in the respective schemas that are linked to the base ConnectionConfig schema. Please ensure that you have setup the proper egress configurations on the Cortex Gateway; this API verifies the new connection against the egress configurations specified for the given tenant. If assistance is required, please utilize the cue on the UI menu for creating a new external application configuration. The unique identifier of the application. Enumerates the parameters for an external application request object Name of the application. Description of the application. The type of application instance. Connection configuration based on application_type. Custom HTTP headers to include. Splunk HTTP Event Collector (HEC) endpoint. HEC authentication token. The SQS queue destination URL. Amazon S3 bucket URI AWS region where the S3 bucket resides Role ARN associated with the IAM role for S3 access Roll-up interval for metrics or data aggregation (in minutes) Choose one of the syslog standard values. The value maps to how your syslog server uses the facility field to manage messages. For details on the facility field, see RFC 5424. IP address or fully qualified domain name (FQDN) of the syslog server. When using TLS for communication between Cortex and the syslog server, Cortex validates that the syslog receiver has a certificate. Specify the certificate name here. Whether to ignore certificate errors. For security reasons, this is not recommended. If you set this to true, logs will be forwarded even if the certificate contains errors. Binary string of the certificate. Application updated successfully. Enumerates the various attributes of an external application response object Unique identifier Current status of the application. Timestamp when the application was created. Identifier of the user who created the app. Description summarizing that last known error for the given external application. Timestamp of the last error. Timestamp of the last modification. Error message describing the issue Additional error details 2.4.2.4 |Delete an application Allows the user to delete an external application. Deletion is not permitted if the application is associated with an active notification rule. The unique identifier of the application. The application type of the specified application Error message describing the issue Additional error details 2.4.2.5 |Get External Application details by ID Retrieves an external application and returns its attributes. The meaning behind all attributes in this response could be found in the ExternalApplication schema. The unique identifier of the application. The application type of the specified application Application details retrieved successfully. Enumerates the various attributes of an external application response object Unique identifier Name of the application. Description of the application. Current status of the application. Timestamp when the application was created. Identifier of the user who created the app. Description summarizing that last known error for the given external application. Timestamp of the last error. Timestamp of the last modification. The type of application instance. Connection configuration based on application_type. Custom HTTP headers to include. Splunk HTTP Event Collector (HEC) endpoint. HEC authentication token. The SQS queue destination URL. Amazon S3 bucket URI AWS region where the S3 bucket resides Role ARN associated with the IAM role for S3 access Roll-up interval for metrics or data aggregation (in minutes) Choose one of the syslog standard values. The value maps to how your syslog server uses the facility field to manage messages. For details on the facility field, see RFC 5424. IP address or fully qualified domain name (FQDN) of the syslog server. When using TLS for communication between Cortex and the syslog server, Cortex validates that the syslog receiver has a certificate. Specify the certificate name here. Whether to ignore certificate errors. For security reasons, this is not recommended. If you set this to true, logs will be forwarded even if the certificate contains errors. Binary string of the certificate. Error message describing the issue Additional error details 2.5 |Cloud Onboarding APIs You can export the OpenAPI specs in the Cortex Stoplight instance. Public APIs for cloud onboarding and instance management. The following API categories are included: Cloud integration instance management: These APIs enable you to create an integration instance in pending state and provide a link to download the authentication template to be executed in your CSP. You can get details on the integration instances currently in Cortex Cloud and you can enable, disable, or delete them. You can also edit the integration instance configuration. Cloud account management: The cloud account APIs allow you to manage accounts within a specific integration instance. You can have multiple cloud accounts within one integration instance. Use these APIs to get the cloud accounts in the specified integration instance and to enable or disable cloud accounts. Outpost management: Use these APIs to create or edit templates for onboarding outposts. General: These APIs are for general management. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security. 2.5.1 |Preface You can export the OpenAPI specs in the Cortex Stoplight instance. Public APIs for cloud onboarding and instance management. The following API categories are included: Cloud integration instance management: These APIs enable you to create an integration instance in pending state and provide a link to download the authentication template to be executed in your CSP. You can get details on the integration instances currently in Cortex Cloud and you can enable, disable, or delete them. You can also edit the integration instance configuration. Cloud account management: The cloud account APIs allow you to manage accounts within a specific integration instance. You can have multiple cloud accounts within one integration instance. Use these APIs to get the cloud accounts in the specified integration instance and to enable or disable cloud accounts. Outpost management: Use these APIs to create or edit templates for onboarding outposts. General: These APIs are for general management. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security. 2.5.1.1 |Servers 2.5.1.2 |Authentication methods Authorized requests to the API should use: x-api-key inside a header with the access token. Authorized requests to the API should use: x-api-key-id inside a header with the access token. 2.5.2 |Cloud integration instance management APIs for managing cloud integration instances 2.5.2.1 |Create a cloud onboarding integration template Create a template to facilitate the seamless setup of CSP data in Cortex. Define the scope and specify the scan mode. For full control of the setup, you can use the advanced settings. Based on the onboarding settings, Cortex generates an authentication template to establish trust to the CSP and grant permissions to Cortex. Cortex Cloud creates an instance in pending state. The API returns a link to download the template from the Cortex tenant. Note: If the template execution in the CSP fails, there is currently no manual execution of the template by API. You must perform manual execution in the UI. For scope modifications, the parameters are CSP-specific. For AWS, use accounts, for GCP, use projects, and for Azure, use subscriptions. Required license: Cortex Cloud Posture Management Define the scope for this integration instance. Valid values include: ORGANIZATION: Use this to indicate an AWS organization, GCP organization, or Azure tenant. ACCOUNT_GROUP: Use this to indicate an AWS account group, GCP folder, or Azure management group. ACCOUNT: Use this to indicate an AWS account, GCP project, or Azure subscription. Define the scan mode. Valid values include: MANAGED: (Recommended) Security scanning is performed in the Cortex cloud environment. OUTPOST: Security scanning is performed on infrastructure deployed to a cloud account owned by you. **Note: ** Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs. When the scan mode is OUTPOST, you must include the scan_env_id field with the outpost ID as the value. To obtain the outpost ID, call /public_api/v1/cloud_onboarding/get_outposts. The value of outpost_id in the response is the outpost ID. account_details is required for onboarding Azure and is not used for onboarding AWS or GCP. The cloud service provider. Valid values include: The key of the custom resource tag. The value of the custom resource tag. To maximize security coverage, include collection of logs. This may require additional cloud service provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Whether to enable audit log collection. If this is false, then the other fields in this object should not be used. Indicates whether to use automated or custom log collection. Note: collection_method is only relevant for AWS or OCI. For OCI, the value of collection_method must be CUSTOM and you must include custom_collectors with the details of the existing buckets. In AWS, if collection_method is CUSTOM, you need to update the bucket information when you manually upload the template to AWS CloudFormation. The data_events field is only relevant when cloud_provider is AWS and collection_method is AUTOMATED. Currently supports AWS Lambda and Amazon S3. A list of OCI bucket configurations for collecting logs. Note: This is only relevant for OCI when collection_method is CUSTOM. The geographic region where the collection bucket is located. The name of the storage bucket where the log collection data will be collected and stored. The unique OCID (Oracle Cloud Identifier) of the compartment that owns the specified bucket. Whether to enable (true) or disable (false) this scope modification. Define whether the account IDs/project IDs/subscription IDs specified should be included in the scope or excluded from the scope. Valid values include: The list of account IDs to include or exclude (for AWS). The list of account IDs to include or exclude (for GCP). The list of account IDs to include or exclude (for Azure). Flag to enable or disable region configuration Type of region configuration (e.g., INCLUDE, EXCLUDE) List of regions to include or exclude Define which security capabilities you want to benefit from. Note: Adding security capability typically requires additional cloud provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Whether to enable XSIAM analytics to analyze your endpoint data to develop a baseline and raise Analytics and Analytics BIOC alerts when anomalies and malicious behaviors are detected. Whether to enable data security posture management, an agentless data security scanner that discovers, classifies, protects, and governs sensitive data. Whether to enable registry scanning, a container registry scanner that scans registry images for vulnerabilities, malware, and secrets. Type of registry scanning. Whether to enable serverless scanning to detect and remediate vulnerabilities within serverless functions during the development lifecycle. Seamless integration into CI/CD pipelines enables automated security scans for a continuously secure pre-production environment. Whether to enable agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Whether the CSP environment is COMMERCIAL or GOV: COMMERCIAL: (Default) Standard cloud deployment typically used for private and public sector organizations that do not require isolated government-specific infrastructure. GOV: Government cloud environments for compatibility with FedRAMP-certified tenants. Successful Response The main payload of the response, containing instance information data. It includes a link to download the template file from your tenant. If you use automated upload (only for AWS), the link will take you directly to AWS CloudFormation to create the stack. Otherwise, download the template and upload it in your CSP and follow the instructions to manually upload the template: Invalid Client Request Error Extra information about the error Internal Server Error 2.5.2.2 |Get cloud instance details Get the configuration details of the specified cloud instance. Required license: Cortex Cloud Posture Management The ID of the integration instance of which you want to get the details. Successful Response The main payload of the response, containing integration instance details. Invalid Client Request Error Extra information about the error Internal Server Error 2.5.2.3 |Get all or filtered integration instances Get the configuration details of all or filtered integration instances. This does not include instances in pending state. Required license: Cortex Cloud Posture Management Valid values for the sort field FIELD the filter field SEARCH_FIELD include: AUTHENTICATION_METHOD Sorting criteria for the results The field to sort by. Whether to sort in ascending (ASC) order or descending (DESC) order. The starting index for pagination. The ending index for pagination. Filter criteria for the results. A list of filter criteria to be combined with AND logic Specifies the field to filter by. Comparison operator to use with the filter. The value to filter by. A list of filter criteria to be combined with OR logic Successful Response The main payload of the response, containing integration instance details. Invalid Client Request Error Extra information about the error Internal Server Error 2.5.2.4 |Edit an integration instance Edit the configuration settings of the specified integration instance. After editing, there is a notice in the UI that there are pending changes. The changes are applied after you execute the template in the CSP after editing. Required license: Cortex Cloud Posture Management Integration instance ID. When the scan mode is OUTPOST, you must include the scan_env_id field with the outpost ID as the value. To obtain the outpost ID, call /public_api/v1/cloud_onboarding/get_outposts. The value of outpost_id in the response is the outpost ID. Integration instance name. Define which security capabilities you want to benefit from. Note: Adding security capability typically requires additional cloud provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Whether to enable XSIAM analytics to analyze your endpoint data to develop a baseline and raise Analytics and Analytics BIOC alerts when anomalies and malicious behaviors are detected. Whether to enable data security posture management, an agentless data security scanner that discovers, classifies, protects, and governs sensitive data. Whether to enable registry scanning, a container registry scanner that scans registry images for vulnerabilities, malware, and secrets. Type of registry scanning. Whether to enable serverless scanning to detect and remediate vulnerabilities within serverless functions during the development lifecycle. Seamless integration into CI/CD pipelines enables automated security scans for a continuously secure pre-production environment. Whether to enable agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. The cloud service provider. Valid values include: Whether the CSP environment is COMMERCIAL or GOV: COMMERCIAL: (Default) Standard cloud deployment typically used for private and public sector organizations that do not require isolated government-specific infrastructure. GOV: Government cloud environments for compatibility with FedRAMP-certified tenants. Note: You must use the same value that was used when the cloud instance was created. The key of the custom resource tag. The value of the custom resource tag. To maximize security coverage, include collection of logs. This may require additional cloud service provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Whether to enable audit log collection. If this is false, then the other fields in this object should not be used. Indicates whether to use automated or custom log collection. Note: collection_method is only relevant for AWS or OCI. For OCI, the value of collection_method must be CUSTOM and you must include custom_collectors with the details of the existing buckets. In AWS, if collection_method is CUSTOM, you need to update the bucket information when you manually upload the template to AWS CloudFormation. The data_events field is only relevant when cloud_provider is AWS and collection_method is AUTOMATED. Currently supports AWS Lambda and Amazon S3. A list of OCI bucket configurations for collecting logs. Note: This is only relevant for OCI when collection_method is CUSTOM. The geographic region where the collection bucket is located. The name of the storage bucket where the log collection data will be collected and stored. The unique OCID (Oracle Cloud Identifier) of the compartment that owns the specified bucket. Whether to enable (true) or disable (false) this scope modification. Define whether the account IDs/project IDs/subscription IDs specified should be included in the scope or excluded from the scope. Valid values include: The list of account IDs to include or exclude (for AWS). The list of account IDs to include or exclude (for GCP). The list of account IDs to include or exclude (for Azure). Flag to enable or disable region configuration Type of region configuration (e.g., INCLUDE, EXCLUDE) List of regions to include or exclude Successful Response The main payload of the response, containing instance detail after edit. It includes a link to download the template file from your tenant. Invalid Client Request Error Extra information about the error Internal Server Error 2.5.2.5 |Enable or disable cloud integration instances Enable or disable the cloud integration instances specified by their instance IDs. To obtain the instance IDs, use /public_api/v1/cloud_onboarding/get_instances/. Required license: Cortex Cloud Posture Management List of integration instance IDs to enable/disable/ Whether to enable the integration instances (true) or disable (false). Successful Response The main payload of the response, containing operation-specific data. Invalid Client Request Error Extra information about the error Internal Server Error 2.5.2.6 |Delete the specified integration instances Delete the specified integration instances. Required license: Cortex Cloud Posture Management List of integration instance IDs to delete. Successful Response The main payload of the response, containing operation-specific data. Invalid Client Request Error Extra information about the error Internal Server Error 2.5.2.7 |Get identifier roles for integration instance List all of the identifiers roles for the cloud instance. In the UI, these details are listed under Authorization details of the cloud instance. Required license: In Cortex XSIAM Premium, Cortex XSIAM Enterprise, or Cortex XSIAM NG SIEM, requires the Cortex Cloud Posture Management add-on. In Cortex XSIAM Enterprise Plus, requires the Data Collection add-on. The cloud instance ID for which you want to list the authorization details. The cloud service provider for which you want to list the authorization details. Successful Response The Cortex discovery role identifier The Cortex scan platform role identifier The Cortex log collection role identifier The Cortex outpost role identifier Extra information about the error Internal Server Error 2.5.3 |Cloud account management APIs for managing cloud accounts per instance 2.5.3.1 |Get accounts in the specified integration instances List accounts and their details for the specified integration instance. Required license: Cortex Cloud Posture Management Valid values for the filter field SEARCH_FIELD include: CLOUD_ACCOUNT_ID Sorting criteria for the results The field to sort by. Whether to sort in ascending (ASC) order or descending (DESC) order. The starting index for pagination. The ending index for pagination. Filter criteria for the results. A list of filter criteria to be combined with AND logic Specifies the field to filter by. Comparison operator to use with the filter. The value to filter by. A list of filter criteria to be combined with OR logic Successful Response The main payload of the response, containing a list of account details. Invalid Client Request Error Extra information about the error Internal Server Error 2.5.3.2 |Enable or disable cloud accounts Enable or disable the specified cloud accounts within a specific integration instance. Required license: Cortex Cloud Posture Management List of account IDs to enable or disable. The integration instance ID where the cloud accounts should be disabled. Whether to enable (true) or disable (false) to specified accounts. Successful Response Invalid Client Request Error Extra information about the error Internal Server Error 2.5.4 |Outpost management APIs for managing outposts 2.5.4.1 |Create an outpost template Create a template to onboard an outpost. Define the custom resource tags you want associated with the outpost and Cortex generates an authentication template to establish trust to the CSP and grant permissions to Cortex. Required license: Cortex Cloud Posture Management The cloud service provider. Valid values include: Whether the CSP environment is COMMERCIAL or GOV: COMMERCIAL: (Default) Standard cloud deployment typically used for private and public sector organizations that do not require isolated government-specific infrastructure. GOV: Government cloud environments for compatibility with FedRAMP-certified tenants. The key of the custom resource tag. The value of the custom resource tag. Successful Response The main payload of the response, containing a link to download the outpost template Invalid Client Request Error Extra information about the error Internal Server Error 2.5.4.2 |Edit an outpost Edit the custom resource tags of the specified outpost. The template must be applied in the CSP after editing. Required license: Cortex Cloud Posture Management The main payload of the response, containing a link to download the edited outpost template Successful Response The main payload of the response, containing operation-specific data. Invalid Client Request Error Extra information about the error Internal Server Error 2.5.4.3 |Get all or filtered outposts Get a list of all or filtered outposts. Required license: Cortex Cloud Posture Management 2.5.5 |General APIs for general tasks 2.5.5.1 |Get available regions for a CSP Get a list of all available regions for the specified cloud service provider. Required license: Cortex Cloud Posture Management The cloud service provider for which you want to list the regions. Whether the CSP environment is COMMERCIAL or GOV: COMMERCIAL: (Default) Standard cloud deployment typically used for private and public sector organizations that do not require isolated government-specific infrastructure. GOV: Government cloud environments for compatibility with FedRAMP-certified tenants. Successful Response Name of the CSP region. Invalid Client Request Error Extra information about the error Internal Server Error 2.5.5.2 |Get approved Azure tenants In order to onboard an Azure tenant to Cortex, Cortex must first be added as an enterprise-approved application on the tenant. Get a list of all the Azure tenants that are already enterprise-approved. Required license: Cortex Cloud Posture Management Whether the CSP environment is COMMERCIAL or GOV: COMMERCIAL: (Default) Standard cloud deployment typically used for private and public sector organizations that do not require isolated government-specific infrastructure. GOV: Government cloud environments for compatibility with FedRAMP-certified tenants. Successful Response The main payload of the response, containing the Azure tenant ID and whether the tenant is approved. Internal Server Error Extra information about the error 2.6 |Disable Prevention Rule Public APIs Public APIs to manage Disable Prevention rules in Cortex Cloud. You can only apply a Disable Prevention Rule to endpoints running Cortex XDR agents version 7.9 and later. You can export the OpenAPI specs in the Cortex Stoplight instance. 2.6.1 |Preface Public APIs to manage Disable Prevention rules in Cortex Cloud. You can only apply a Disable Prevention Rule to endpoints running Cortex XDR agents version 7.9 and later. You can export the OpenAPI specs in the Cortex Stoplight instance. 2.6.1.1 |Servers 2.6.2 |Default 2.6.2.1 |Get Disable Prevention Rules Returns a list of Disable Prevention rules based on filters, sorting, and pagination. Zero-based index of the first Disable Prevention rule to return. Used for pagination. Index number of Disable Prevention rules to return starting from search_from. Rule attribute to apply the filter on. For example: rule_id, status, modification_time, platform). Determines the sort order. Comparison operator used for filtering. For example, (eq, neq, gte, lte, contains or not_contains) The value to compare against the specified field. The expected data type and format depend on the field being filtered and the operator used. If the field is status, the value can be enabled or disabled. If the field is modification_time, the value should be a Unix timestamp in milliseconds (for example, 1762870187000). If the field is platform, the value can be a string such as windows, macos, or linux The unique identifier of the Disable Prevention rule. Name of the Disable Prevention rule. Description explaining the purpose and behavior of the rule. Indicates the operating system to which the rule applies. For example, windows, linux, or macos A combination of parameters configured during rule creation. Path to the required files or folders Command line argument Certificate thumbprint A list of module ids associated with the rule. A list of profile ids to which the rule is applied. Specifies the scope of the rule, such as global (All endpoints) or profile (Exception profiles). Current state of the rule (for example, enabled or disabled). Name of the user who created the rule. Email address of the user associated with the creation or last modification of the rule. Timestamp when the rule was last modified. The number of rules returned in the current response after applying filters. The total number of rules available that match the filter criteria, regardless of pagination. 2.6.2.2 |Get Disable Prevention Modules Returns a list of available modules for a specific platform. Indicates the operating system to which the rule applies. For example, windows, linux, or macos. Module ID associated with the rule. Name of the security module. Description of the disable prevention rule. Type of security profile. A combination of parameters configured during rule creation. Path to the required files or folders Command line argument Certificate thumbprint 2.6.2.3 |Add Disable Prevention Rule Creates a new Disable Prevention rule. Name of the disable prevention rule. Description explaining the purpose and behavior of the rule. Indicates the operating system to which the rule applies. For example, windows, linux, or macos A list of module ids associated with the rule. A combination of parameters configured during rule creation. Path to the required files or folders Command line argument Certificate thumbprint A list of profile ids to which the rule is applied. Status of the rule (for example, enabled or disabled). Specifies the scope of the rule, such as global (All endpoints) or profile (Exception profiles). Returns the Disable Prevention Rule ID. 2.6.2.4 |Edit Disable Prevention Rule Updates an existing Disable Prevention rule. Name of the disable prevention rule. Description explaining the purpose and behavior of the rule. Indicates the operating system to which the rule applies. For example, windows, linux, or macos A list of module ids associated with the rule. A combination of parameters configured during rule creation. Path to the required files or folders Command line argument Certificate thumbprint A list of profile ids to which the rule is applied. Status of the rule (for example, enabled or disabled). Specifies the scope of the rule, such as global (All endpoints) or profile (Exception profiles). The unique identifier of the Disable Prevention rule. Returns the Disable Prevention Rule ID. 2.6.2.5 |Delete Disable Prevention Rules Deletes one or more Disable Prevention rules based on the provided rule ID. The unique identifier of the Disable Prevention rule. Describes the result of the API operation. 2.7 |ASPM, CICD and Application Security APIs You can export the OpenAPI specs in the Cortex Stoplight instance. Enhance your security operations and automation capabilities using the ASPM, CICD and Application Security APIs to optimize the management of applications, repositories, data sources, rules, policies, and scans. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.7.1 |Preface You can export the OpenAPI specs in the Cortex Stoplight instance. Enhance your security operations and automation capabilities using the ASPM, CICD and Application Security APIs to optimize the management of applications, repositories, data sources, rules, policies, and scans. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.7.1.1 |Servers 2.7.1.2 |Authentication methods API Key ID for authentication Authorized requests to the API should use: x-xdr-auth-id inside a header with the access token. API Key for authentication Authorized requests to the API should use: Authorization inside a header with the access token. 2.7.1.2.1 |Default authentication XDRAuth=[], XDRAuthToken 2.7.2 |Applications APIs for managing applications 2.7.2.1 |Get an application configuration Retrieves the application configuration settings. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security with Application Security add-on. Indicates if the system is configured to automatically and periodically refresh the application's metadata and asset data. Indicates if findings from Software Bill of Materials (SBOM) scans are treated as brand-new issues for tracking and compliance purposes. Contains the Service Level Agreement (SLA) configurations, defining the resolution timeframes for various severity levels. Defines the SLA target days for issues classified as CRITICAL severity. The number of calendar days set as the target for resolving issues of this specific severity level. A value of 0 indicates the SLA is waived or not enforced. Defines the SLA target days for issues classified as HIGH severity. Defines the SLA target days for issues classified as MEDIUM severity. Defines the SLA target days for issues classified as LOW severity. Defines the early warning threshold that triggers notifications before an SLA is officially breached. The number of calendar days set as the target for defining the 'approaching' window. 2.7.2.2 |Create an application Creates a new application asset based on the provided details, such as name, criticality, and asset selection. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security with Application Security add-on. A unique name for the application asset. The operational importance of the asset. Business unit responsible for the asset. Defines how the application asset is created. A brief description of the asset's purpose. The compliance status or requirement category for an asset. A list of stakeholders responsible for the asset from the business side. A list of primary developers or engineering leads responsible for the code. A list of SRE or DevOps engineers managing the infrastructure. A list of product managers responsible for overseeing the application asset. Define the logic for how specific technical assets must be linked to this application. Method to select application assets. Identifies the functional section to which the asset selection applies. Defines filter criteria to dynamically select application assets. This field supports one of the supported application asset selection filter types. If the filterType is REPOSITORY, enter the repository ID as the value. If the filterType is ORGANIZATION, enter the organization URL of the provider. Build system or CI provider used for the asset. Allowed values: CIRCLE_CI JENKINS GITLAB_CI AZURE_PIPELINES GITHUB_ACTIONS Source code management (SCM) or code hosting provider. Allowed values: GITLAB, GITHUB, BITBUCKET, AZURE_REPOS, AWS_CODE_COMMIT Runtime or execution environment provider for the application or asset. Allowed Values: GCP, AWS, AZURE Deployment platform or system used to deploy the application or asset. Allowed values: ACR ECR GAR JFrog Docker The asset attribute used to filter assets from the selected provider. Specifies the available values for the code type filter. Specifies the available values for the run type filter. Container for filter values used to match application assets. Organization URL used to filter assets belonging to a specific organization. Unique identifier of the repository used to filter assets. Project URL used to filter assets belonging to a specific project. Defines unification rules applied at the organization level. Name of the organization used for asset unification. Defines unification rules applied at the project level. Name of the project used for asset unification. Defines unification rules applied at the repository level. Name of the repository used for asset unification. A list of unique identifiers representing the assets to be included. Displays the status of the application. Displays the Asset ID of the application. Displays the error code. Displays the error message. Conflict. Occurs when an application with the specified name already exists. Provide a unique name for the application. Internal Server Error. Occurs when the server encounters an unexpected condition that prevents it from fulfilling the request. This is a server-side issue. No action is required from you. If the problem persists, try again later. 2.7.2.3 |Get applications Retrieves a list of all application assets using pagination. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security with Application Security add-on. Page number of the results to retrieve for pagination. Number of records returned per page. A unique identifier of the criteria. Name of the criteria. Calculated risk score associated with the criteria or asset. Unique identifier of the resource. Globally unique, immutable identifier for the resource. Name of the application asset. Description providing additional details about the asset. Represents the level of coverage applied to the asset. The operational importance of the asset. Business unit responsible for the asset. Defines how the application asset is created. Business owners responsible for the asset. Development owners responsible for building and maintaining the asset. DevOps owners responsible for deployment and operations. Product managers responsible for the asset. Type of data governance applied to the asset. The compliance status or requirement category for an asset. Environment in which the asset is deployed (for example, development, staging, or production). Total number of assets included in the response. Configuration settings associated with the application. Date and time when the application data was last refreshed. Define the logic for how specific technical assets must be linked to this application. Method to select application assets. Identifies the functional section to which the asset selection applies. Defines filter criteria to dynamically select application assets. This field supports one of the supported application asset selection filter types. If the filterType is REPOSITORY, enter the repository ID as the value. If the filterType is ORGANIZATION, enter the organization URL of the provider. Build system or CI provider used for the asset. Allowed values: CIRCLE_CI JENKINS GITLAB_CI AZURE_PIPELINES GITHUB_ACTIONS Source code management (SCM) or code hosting provider. Allowed values: GITLAB, GITHUB, BITBUCKET, AZURE_REPOS, AWS_CODE_COMMIT Runtime or execution environment provider for the application or asset. Allowed Values: GCP, AWS, AZURE Deployment platform or system used to deploy the application or asset. Allowed values: ACR ECR GAR JFrog Docker The asset attribute used to filter assets from the selected provider. Specifies the available values for the code type filter. Specifies the available values for the run type filter. Container for filter values used to match application assets. Organization URL used to filter assets belonging to a specific organization. Unique identifier of the repository used to filter assets. Project URL used to filter assets belonging to a specific project. Defines unification rules applied at the organization level. Name of the organization used for asset unification. Defines unification rules applied at the project level. Name of the project used for asset unification. Defines unification rules applied at the repository level. Name of the repository used for asset unification. A list of unique identifiers representing the assets to be included. Date and time when the configuration was last updated. Date and time when the configuration was deleted. Indicates whether asset enrichment is currently in progress. If multiple applications share the same name at the chosen group-by level (org, project, or repository), they are merged across providers to form a single unified application. Repositories with the same name at the selected group-by level (org, project, or repository) are consolidated into a single application within the selected provider. Indicates whether additional results are available beyond the current page. 2.7.2.4 |Get an application Retrieves detailed information for a specific application asset using its unique ID. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security with Application Security Add-on. Exposure attributes associated with the asset. A unique identifier of the criteria. Name of the criteria. Calculated risk score associated with the criteria or asset. Unique identifier of the resource. Globally unique, immutable identifier for the resource. Name of the application asset. Description providing additional details about the asset. Represents the level of coverage applied to the asset. The operational importance of the asset. Business unit responsible for the asset. Defines how the application asset is created. Business owners responsible for the asset. Development owners responsible for building and maintaining the asset. DevOps owners responsible for deployment and operations. Product managers responsible for the asset. Type of data governance applied to the asset. The compliance status or requirement category for an asset. Environment in which the asset is deployed (for example, development, staging, or production). Total number of assets included in the response. Configuration settings associated with the application. Date and time when the application data was last refreshed. Define the logic for how specific technical assets must be linked to this application. Method to select application assets. Identifies the functional section to which the asset selection applies. Defines filter criteria to dynamically select application assets. This field supports one of the supported application asset selection filter types. If the filterType is REPOSITORY, enter the repository ID as the value. If the filterType is ORGANIZATION, enter the organization URL of the provider. Build system or CI provider used for the asset. Allowed values: CIRCLE_CI JENKINS GITLAB_CI AZURE_PIPELINES GITHUB_ACTIONS Source code management (SCM) or code hosting provider. Allowed values: GITLAB, GITHUB, BITBUCKET, AZURE_REPOS, AWS_CODE_COMMIT Runtime or execution environment provider for the application or asset. Allowed Values: GCP, AWS, AZURE Deployment platform or system used to deploy the application or asset. Allowed values: ACR ECR GAR JFrog Docker The asset attribute used to filter assets from the selected provider. Specifies the available values for the code type filter. Specifies the available values for the run type filter. Container for filter values used to match application assets. Organization URL used to filter assets belonging to a specific organization. Unique identifier of the repository used to filter assets. Project URL used to filter assets belonging to a specific project. Defines unification rules applied at the organization level. Name of the organization used for asset unification. Defines unification rules applied at the project level. Name of the project used for asset unification. Defines unification rules applied at the repository level. Name of the repository used for asset unification. A list of unique identifiers representing the assets to be included. Date and time when the configuration was last updated. Date and time when the configuration was deleted. Indicates whether asset enrichment is currently in progress. If multiple applications share the same name at the chosen group-by level (org, project, or repository), they are merged across providers to form a single unified application. Repositories with the same name at the selected group-by level (org, project, or repository) are consolidated into a single application within the selected provider. 2.7.2.5 |Update an application Updates the attributes of an existing application asset identified by its unique ID. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security with Application Security Add-on. The operational importance of the asset. How the asset was created. Business unit responsible for the asset. Description providing additional details about the asset. The compliance status or requirement category for an asset. Business owners responsible for the asset. Development owners responsible for building and maintaining the asset. DevOps owners responsible for deployment and operations. Product managers responsible for the asset. Displays the status of the application. Displays the Asset ID of the application. 2.7.2.6 |Delete an application Deletes a specific application asset identified by its unique ID. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security with Application Security Add-on. 2.7.3 |Policies APIs for managing policies 2.7.3.1 |Create an AppSec policy An Application Security policy defines how a system should respond to application security threats. It includes conditions that trigger the policy, the scope of its application, and the actions to be taken when these conditions are met. When a policy detects a threat, it generates an issue for remediation. 2.7.3.1.1 |Create an Application Security policy. 2.7.3.1.1.1 |How to access Application Security policies in the UI: Go to Modules, then select Application Security > AppSec policies under Policy management. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security. 2.7.3.1.1.2 |Limitations Be aware of the following limitations when creating policies: 2.7.3.1.1.2.1 |Trigger and Action Constraints by Finding Type 2.7.3.1.1.2.2 |General Policy Constraints 2.7.3.2 |List AppSec policies 2.7.3.2.1 |List all or filtered Application Security policies. 2.7.3.2.1.1 |How to access Application Security policies in the UI: Go to Modules, then select Application Security > Policy Management > AppSec Policies. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security. Types of findings the policy applies to Indicates if the policy is a custom policy or a system-provided policy Unique identifier for the policy Name of the AppSec policy Description of the policy Indicates whether the policy is currently enabled or disabled. Defines when the AppSec policy should be evaluated. At least one of the options must be true. If true, the AppSec policy is evaluated periodically (for example, daily or weekly). Enables the periodic trigger for the AppSec policy. Actions to take when the policy detects its target risk and the policy is triggered. Indicates if triggering the policy should create an issue in the connected system. Set the severity of the issue (and override the system severity). If not used, system severity is kept. If true, the AppSec policy is evaluated on Pull Request (PR) events Enables the pr trigger for the AppSec policy. Indicates if triggering the policy should block the pull request. Ensure that the pr trigger is selected. Indicates if triggering the policy should create comments on the pull request. Ensure that the pr trigger is selected. If true, the AppSec policy is evaluated on CI/CD pipeline events. Enables the cicd trigger for the AppSec policy. Indicates if triggering the policy should block the CI/CD pipeline. Ensure that the cicd trigger is selected. Indicates if triggering the policy should soft fail the CI/CD pipeline in the platform. Ensure that the cicd trigger is selected. Indicates if the policy is cloneable Indicates if the policy is editable Indicates if the policy is a Code Scanner policy or a CI/CD Configuration Scanner policy. Defines the specific criteria that trigger the policy and defines the type of assets to be evaluated by the policy (the scope). You can combine multiple conditions to create complex rules for when the policy should be applied. When used in AND, all conditions within this array must be met. When used in OR, at least one condition within this array must be met. Defines the field the condition filter should match. Defines the comparison operator you want to use for this filter. Value that the condition filter must match. The type of this field will differ depending on the SEARCH_FIELD that you specified. List of related detection rules The date and time when the policy was created The user or system that created the policy The date and time when the policy was last modified The user or system that last modified the policy The user or system that deleted the policy The date and time when the policy was deleted The date and time when the policy was last triggered The version of the policy - goes up by one every policy update List of asset groups to which the policy applies. If the array is empty, the policy applies to all asset groups. 2.7.3.3 |Get an AppSec policy A Cortex Cloud Application Security policy defines how a system should respond to application security threats. 2.7.3.3.1 |Get the details of the Application Security policy specified by its policy ID. 2.7.3.3.1.1 |How to access Application Security policies in the UI: Go to Modules, then select Application Security > Policy Management > AppSec Policies. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security. Unique identifier for the policy Name of the AppSec policy Description of the policy Indicates whether the policy is currently enabled or disabled. Indicates if the policy is a custom policy or a system-provided policy Defines when the AppSec policy should be evaluated. At least one of the options must be true. If true, the AppSec policy is evaluated periodically (for example, daily or weekly). Enables the periodic trigger for the AppSec policy. Actions to take when the policy detects its target risk and the policy is triggered. Indicates if triggering the policy should create an issue in the connected system. Set the severity of the issue (and override the system severity). If not used, system severity is kept. If true, the AppSec policy is evaluated on Pull Request (PR) events Enables the pr trigger for the AppSec policy. Indicates if triggering the policy should block the pull request. Ensure that the pr trigger is selected. Indicates if triggering the policy should create comments on the pull request. Ensure that the pr trigger is selected. If true, the AppSec policy is evaluated on CI/CD pipeline events. Enables the cicd trigger for the AppSec policy. Indicates if triggering the policy should block the CI/CD pipeline. Ensure that the cicd trigger is selected. Indicates if triggering the policy should soft fail the CI/CD pipeline in the platform. Ensure that the cicd trigger is selected. Indicates if the policy is cloneable Indicates if the policy is editable Indicates if the policy is a Code Scanner policy or a CI/CD Configuration Scanner policy. Defines the specific criteria that trigger the policy and defines the type of assets to be evaluated by the policy (the scope). You can combine multiple conditions to create complex rules for when the policy should be applied. When used in AND, all conditions within this array must be met. When used in OR, at least one condition within this array must be met. Defines the field the condition filter should match. Defines the comparison operator you want to use for this filter. Value that the condition filter must match. The type of this field will differ depending on the SEARCH_FIELD that you specified. List of related detection rules The date and time when the policy was created The user or system that created the policy The date and time when the policy was last modified The user or system that last modified the policy The user or system that deleted the policy The date and time when the policy was deleted The date and time when the policy was last triggered The version of the policy - goes up by one every policy update List of asset groups to which the policy applies. If the array is empty, the policy applies to all asset groups. 2.7.3.4 |Delete an AppSec policy A Cortex Cloud Application Security policy defines how a system should respond to application security threats. 2.7.3.4.1 |Delete an Application Security policy by specifying its policy ID. 2.7.3.4.1.1 |How to access Application Security policies in the UI: Go to Modules > Application Security > Policy Management > AppSec Policies. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security. 2.7.3.5 |Update an AppSec policy A Cortex Cloud Application Security policy defines how a system should respond to application security threats. 2.7.3.5.1 |Update the details of the Application Security policy specified by its policy ID. 2.7.3.5.1.1 |How to access Application Security policies in the UI: Go to Modules, then select Application Security > Policy Management > AppSec Policies. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security. Make all properties in T optional A unique name for the AppSec policy. A brief description of the AppSec policy's purpose. Defines the specific criteria (conditions) that will trigger the policy. You can combine multiple conditions to create complex rules for when the policy should be applied. If you combine multiple Finding Type values using OR, only the common fields across those types will be valid. When used in AND, all conditions within this array must be met. When used in OR, at least one condition within this array must be met. Selecting Finding Type determines which condition fields you can configure. Each Finding Type supports a specific set of condition fields. To see which fields are allowed for each type, see the Supported Condition Fields table. 2.7.3.6 |Supported Condition Fields This table defines the available fields for building policy conditions when you select Finding Type option. Defines the field the condition filter should match. To see which fields are allowed for each type, see the Supported Condition Fields table. Defines the comparison operator you want to use for this filter. Value that the condition filter must match. The type of this field will differ depending on the SEARCH_FIELD that you specified. Defines the field the condition filter should match. Defines the type of assets to be evaluated by the policy (the scope). You can combine multiple conditions to create complex rules for when the policy should be applied. When used in AND, all conditions within this array must be met. When used in OR, at least one condition within this array must be met. Cannot be used if assetGroupIds are set. 2.7.3.7 |Supported Scope Fields This table defines the available fields for building policy scopes that target specific assets. Defines the field the matching criteria filter should match. To see which fields are allowed for each type, see the Supported Scope Fields table. Defines the comparison operator you want to use for this filter. Value that the condition filter must match. The type of this field will differ depending on the SEARCH_FIELD that you specified. Defines the field the condition filter should match. A list of asset group IDs that the policy should apply to. If the list is empty, the policy applies globally, unless other scope conditions are defined. Note : Cannot be used with the scope parameter. Defines when the AppSec policy should be evaluated. At least one of the options must be true. If true, the AppSec policy is evaluated periodically (for example, daily or weekly). Enables the periodic trigger for the AppSec policy. Actions to take when the policy detects its target risk and the policy is triggered. Indicates if triggering the policy should create an issue in the connected system. Set the severity of the issue (and override the system severity). If not used, system severity is kept. If true, the AppSec policy is evaluated on Pull Request (PR) events Enables the pr trigger for the AppSec policy. Indicates if triggering the policy should block the pull request. Ensure that the pr trigger is selected. Indicates if triggering the policy should create comments on the pull request. Ensure that the pr trigger is selected. If true, the AppSec policy is evaluated on CI/CD pipeline events. Enables the cicd trigger for the AppSec policy. Indicates if triggering the policy should block the CI/CD pipeline. Ensure that the cicd trigger is selected. Indicates if triggering the policy should soft fail the CI/CD pipeline in the platform. Ensure that the cicd trigger is selected. You will receive Bad Request error when the server cannot process the request due to client-side errors in the request body. The error is returned when: Required fields are missing Field values are invalid (for example, incorrect SEARCH_TYPE for the given SEARCH_FIELD) The JSON request body is not structured properly (invalid payload structure) Example response: All required fields are included Field values follow the expected format and constraints The JSON request body is properly structured You will receive Conflict error if a policy with the specified name already exists. Provide a unique name for the new policy. You will receive Internal Server Error when the server encounters an unexpected condition that prevents it from fulfilling the request. This is a server-side issue. No action is required from you. If the problem persists, try again later. 2.7.3.8 |Supported Condition Fields This table defines the available fields for building policy conditions when you select Finding Type option. Defines the field the condition filter should match. To see which fields are allowed for each type, see the Supported Condition Fields table. Defines the comparison operator you want to use for this filter. Value that the condition filter must match. The type of this field will differ depending on the SEARCH_FIELD that you specified. Defines the field the condition filter should match. Defines the type of assets to be evaluated by the policy (the scope). You can combine multiple conditions to create complex rules for when the policy should be applied. When used in AND, all conditions within this array must be met. When used in OR, at least one condition within this array must be met. Cannot be used if assetGroupIds are set. 2.7.3.9 |Supported Scope Fields This table defines the available fields for building policy scopes that target specific assets. Defines the field the matching criteria filter should match. To see which fields are allowed for each type, see the Supported Scope Fields table. Defines the comparison operator you want to use for this filter. Value that the condition filter must match. The type of this field will differ depending on the SEARCH_FIELD that you specified. Defines the field the condition filter should match. List of asset groups to which the policy applies. If the array is empty, the policy applies to all asset groups. Defines when the AppSec policy should be evaluated. At least one of the options must be true. If true, the AppSec policy is evaluated periodically (for example, daily or weekly). Enables the periodic trigger for the AppSec policy. Actions to take when the policy detects its target risk and the policy is triggered. Indicates if triggering the policy should create an issue in the connected system. Set the severity of the issue (and override the system severity). If not used, system severity is kept. If true, the AppSec policy is evaluated on Pull Request (PR) events Enables the pr trigger for the AppSec policy. Indicates if triggering the policy should block the pull request. Ensure that the pr trigger is selected. Indicates if triggering the policy should create comments on the pull request. Ensure that the pr trigger is selected. If true, the AppSec policy is evaluated on CI/CD pipeline events. Enables the cicd trigger for the AppSec policy. Indicates if triggering the policy should block the CI/CD pipeline. Ensure that the cicd trigger is selected. Indicates if triggering the policy should soft fail the CI/CD pipeline in the platform. Ensure that the cicd trigger is selected. 2.7.4 |Rules APIs for managing rules 2.7.4.1 |Get AppSec rules Application Security rules are designed to detect security threats within your application security environment. Application Security rules identify and flag issues based on predefined criteria. Get a list of all the Application Security rules. We recommend you use the parameters to filter the rules since there are many of them. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Whether the rule is enabled Type of security scanner used to detect findings of this rule The priority level assigned to findings identified by the rule The framework or language that the Application Security rule applies to (for example, GitHub, Terraform, JavaScript) Labels assigned to the rule Custom rule IaC category. The timestamp when the AppSec rule was created. The rule description. security scanner used to detect findings of this rule. A link to the Cortex documentation. The domain associated with the rule. The finding type ID. The rule definition. http link to the definition documentation. Name of the configured frameworks. The remediation steps that will appear on the Appsec rule's findings. The IDs of related remediation resources. The resource types associated with the rule. Indicates whether the rule is custom. Indicates whether the rule is enabled. Labels assigned to the rule. Name of the Appsec rule. Owner of the rule. Custom rule subcategory. The timestamp when the AppSec rule was updated. The associated MITRE ATT&CK tactics. The associated MITRE ATT&CK techniques. 2.7.4.2 |Create an AppSec rule Application Security rules are designed to detect security threats within your application security environment. Application Security rules identify and flag issues based on predefined criteria. 2.7.4.2.1 |Create an Application Security Rule Rules can only be created for IaC Security and Secrets Security; creating rules for CI/CD Security is not supported. Required license Cortex Cloud Posture Management or Cortex Cloud Runtime Security with Application Security add-on. Define the Application Security custom rule. The category option should match your selection for scanner. A unique name for the Appsec rule. Description of the rule Labels to be assigned to the rule The type of security scanner used to detect findings of this rule. Choose any one of the scanners. Allowed Values: IAC or SECRETS. Name of the configured frameworks. Custom rule IaC category Custom rule subcategory The rule definition http link to the definition documentation. The remediation steps that will appear on the Appsec rule's findings. Custom rule secret category http link to the documentation. Details of the Application Security rule Custom rule IaC category. The timestamp when the AppSec rule was created. The rule description. security scanner used to detect findings of this rule. A link to the Cortex documentation. The domain associated with the rule. The finding type ID. The rule definition. The IDs of related remediation resources. The resource types associated with the rule. Indicates whether the rule is custom. Indicates whether the rule is enabled. Labels assigned to the rule. Name of the Appsec rule. Owner of the rule. Custom rule subcategory. The timestamp when the AppSec rule was updated. The associated MITRE ATT&CK tactics. The associated MITRE ATT&CK techniques. 2.7.4.3 |Get an AppSec rule Get the details of the specified Application Security rule. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Custom rule IaC category. The timestamp when the AppSec rule was created. The rule description. security scanner used to detect findings of this rule. A link to the Cortex documentation. The domain associated with the rule. The finding type ID. The rule definition. http link to the definition documentation. Name of the configured frameworks. The remediation steps that will appear on the Appsec rule's findings. The IDs of related remediation resources. The resource types associated with the rule. Indicates whether the rule is custom. Indicates whether the rule is enabled. Labels assigned to the rule. Name of the Appsec rule. Owner of the rule. Custom rule subcategory. The timestamp when the AppSec rule was updated. The associated MITRE ATT&CK tactics. The associated MITRE ATT&CK techniques. 2.7.4.4 |Modify an AppSec rule Modify an existing Application Security rule. If it's an out-of-the-box rule, the only modification you can make is to add labels. For custom rules, you can modify all of the fields. Note: To customize an out-of-the-box rule, you can create a custom rule by cloning the existing one. This allows you to make changes to the original rule according to your requirements. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management List of rule labels A unique name for the Appsec rule. Description of the rule Labels to be assigned to the rule The type of security scanner used to detect findings of this rule. Choose any one of the scanners. Allowed Values: IAC or SECRETS. Name of the configured frameworks. Custom rule IaC category Custom rule subcategory The rule definition http link to the definition documentation. The remediation steps that will appear on the Appsec rule's findings. Custom rule secret category http link to the documentation. Updated details of the modified Application Security rule Details of the Application Security rule Custom rule IaC category. The timestamp when the AppSec rule was created. The rule description. security scanner used to detect findings of this rule. A link to the Cortex documentation. The domain associated with the rule. The finding type ID. The rule definition. The IDs of related remediation resources. The resource types associated with the rule. Indicates whether the rule is custom. Indicates whether the rule is enabled. Labels assigned to the rule. Name of the Appsec rule. Owner of the rule. Custom rule subcategory. The timestamp when the AppSec rule was updated. The associated MITRE ATT&CK tactics. The associated MITRE ATT&CK techniques. 2.7.4.5 |Delete an AppSec rule Delete the specified Application Security rule. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.7.4.6 |Get AppSec rule labels Get a list of all of the Application Security rule labels. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management A list of labels 2.7.4.7 |Create an AppSec rule validation Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Name of the configured frameworks. 2.7.5 |Repositories APIs for managing repository assets 2.7.5.1 |Get repositories Get details on all repositories integrated with Cortex Cloud Application Security, providing detailed information and insights into repository artifacts, configurations, and dependencies. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The name of the repository in the version control system (VCS) Description describing the repository Whether the repository is archived Whether the repository is billable Whether the repository is forked Whether the repository is public Whether the repository is selected The date the repository was last updated Repository owner The configuration of an Application Security code scanner Pull Request (PR) scans are initiated by events triggered by version control systems such as GitHub, GitLab, Bitbucket and Azure Repos, or via webhooks. The scan results are based on default enforcement thresholds. Indicates whether the PR scan is enabled Details on each type of scanner: Branch periodic scans, CI scans, IaC scans, Secrets scans Scanner configuration Indicates whether this scanner is enabled Timestamp of the first scan performed Indicates whether or not the branch is the primary branch Timestamp of the last scan execution URL of the repository 2.7.5.2 |Get a repository Get details on the Application Security repository specified by its asset ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The name of the repository in the version control system (VCS) Description describing the repository Whether the repository is archived Whether the repository is billable Whether the repository is forked Whether the repository is public Whether the repository is selected The date the repository was last updated Repository owner The configuration of an Application Security code scanner Pull Request (PR) scans are initiated by events triggered by version control systems such as GitHub, GitLab, Bitbucket and Azure Repos, or via webhooks. The scan results are based on default enforcement thresholds. Indicates whether the PR scan is enabled Details on each type of scanner: Branch periodic scans, CI scans, IaC scans, Secrets scans Scanner configuration Indicates whether this scanner is enabled Timestamp of the first scan performed Indicates whether or not the branch is the primary branch Timestamp of the last scan execution URL of the repository 2.7.5.3 |Get a repository scan configuration Get the details of an Application Security scan configuration. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The configuration of an Application Security code scanner Pull Request (PR) scans are initiated by events triggered by version control systems such as GitHub, GitLab, Bitbucket and Azure Repos, or via webhooks. The scan results are based on default enforcement thresholds. Indicates whether the PR scan is enabled Details on each type of scanner: Branch periodic scans, CI scans, IaC scans, Secrets scans Scanner configuration Indicates whether this scanner is enabled 2.7.5.4 |Update a repository scan configuration Update the configuration of an Application Security scan. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Pull Request (PR) scans are initiated by events triggered by version control systems such as GitHub, GitLab, Bitbucket and Azure Repos, or via webhooks. The scan results are based on default enforcement thresholds. Indicates whether the PR scan is enabled Make all properties in T optional From T, pick a set of properties whose keys are in the union K The configuration of an Application Security code scanner Details on each type of scanner: Branch periodic scans, CI scans, IaC scans, Secrets scans Scanner configuration Indicates whether this scanner is enabled Timestamp of the first scan performed Indicates whether or not the branch is the primary branch Timestamp of the last scan execution 2.7.5.5 |Get AppSec repository branches Get the details of the Application Security repository branches. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Timestamp of the first scan performed Indicates whether or not the branch is the primary branch Timestamp of the last scan execution 2.7.5.6 |Update an AppSec repository branch Update the Application Security repository branch by indicating the primary branch. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.7.6 |Data Sources APIs for managing integrations 2.7.6.1 |Get Data Sources Application Security capabilities support a wide range of Cloud DevSecOps systems integrations. Get details on the Application Security integrations in your Cortex environment. You can filter the type and category of integrations you want to list. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Integration type Integration category Date the integration was created Integration hostname and protocol Integration hostname Integration protocol Integration instance version Date the integration was last updated Self-signed certificate Integration state The status of the integration Unique identifier of the integration 2.7.6.2 |Get an AppSec Data Source Get the details of the Application Security integration specified by its ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Integration details Date the integration was created Integration hostname and protocol Integration hostname Integration protocol Integration instance version Date the integration was last updated Self-signed certificate Integration state The status of the integration Unique identifier of the integration 2.7.6.3 |Update an AppSec Data Source Update some of the Application Security integration details. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Define the integration details To update the integration for specific repositories, specify them here in the following format: "state":"["org1"/"repo_name1", "org2"/"repo_name2"] Name of the branch Name of the external branch External project ID Integration details Date the integration was created Integration hostname and protocol Integration hostname Integration protocol Integration instance version Date the integration was last updated Self-signed certificate Integration state The status of the integration Unique identifier of the integration 2.7.6.4 |Delete an AppSec Data Source Delete the specified Application Security integration. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.7.7 |Scan management APIs for managing scans 2.7.7.1 |Get unscanned AppSec scan management repositories Get a list of Application Security repositories that have not been scanned. You can optionally filter by specifying the number of days past during which the repositories were not scanned. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Define the time period in days previous to now Name of the repository ID of the repository 2.7.7.2 |Get AppSec branch periodic scans Branch periodic scans are automated checks that assess the security posture of applications and infrastructure. Get the details of branch periodic scans. How to access branch periodic scans in the UI: Under Modules select Application Security > Branch Periodic Scanning (under Scans). Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management ID of the scanned repository The health of the scan. Valid values include: ERROR: Indicates an error with the scan PARTIALLY_COMPLETED: Indicates that the scan executed partially with some scan modules succeeded and others failing IN_PROGRESS: The scan is in progress COMPLETED: Indicates that the scan is complete Timestamp of the last scan execution The branch analyzed during the scan The organization owning the repository Name of the scanned repository 2.7.7.3 |Get AppSec Pull Request scans Pull Request (PR) scans are initiated by events triggered by version control systems such as GitHub, GitLab, Bitbucket and Azure Repos, or via webhooks. These scans are run on default or non-default branches containing open PRs or Merge Requests (MR) from your integrated repositories. Get the details of PR scans. How to access Pull Request scans in the UI: Under Modules select Application Security Pull Request Scans (under Scans). Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management ID of the scanned repository The health of the scan. Valid values include: ERROR: Indicates an error with the scan PARTIALLY_COMPLETED: Indicates that the scan executed partially with some scan modules succeeded and others failing IN_PROGRESS: The scan is in progress COMPLETED: Indicates that the scan is complete The timestamp of the last scan execution The commit included in the PR Status of the PR scan. Valid values include: PASSED_WITH_ISSUES The ID of the PR Name of the branch analyzed during the scan Specifies the organization owning the repository 2.7.7.4 |Get AppSec CI scans CI scans detect exposed secrets, misconfigurations in your infrastructure-as-code (IaC) files, vulnerabilities in your software composition analysis (SCA) packages, and license non-compliance in your CI pipelines. Get the details of CI scans. How to access CI scans in the UI: Under Modules select Application Security > CI Scans (under Scans). Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management ID of the scanned repository Status of the PR scan. Valid values include: PASSED_WITH_ISSUES The health of the scan. Valid values include: ERROR: Indicates an error with the scan PARTIALLY_COMPLETED: Indicates that the scan executed partially with some scan modules succeeded and others failing IN_PROGRESS: The scan is in progress COMPLETED: Indicates that the scan is complete The timestamp of the last scan execution The name of the branch analyzed during the scan Name of the organization owning the repository Name of the scanned repository 2.7.7.5 |List AppSec scan issues Get a list of the issues discovered in the scan specified by scan ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.7.7.6 |List AppSec scan findings Get a list of the findings discovered in the scan specified by scan ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.7.7.7 |Rerun a repository scan Create a repository scan by specifying the branch name. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.7.8 |SBOM management APIs for managing SBOMs 2.7.8.1 |Get an SBOM for the specified repository Get an SBOM (Software Bill of Materials) report for the specified repository. Only the following combinations are supported: format: cyclonedx fileType: json or xml version: 1.4or1.5or1.6` format: spdx fileType: json or txt version: 2.3` Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Branch name for which you want to export the SBOM. Define the file type you want to export. For cyclonedx, either json or xml. For spdx, either json or txt. For cyclonedx, version can be 1.4, 1.5, or 1.6. For spdx, version is 2.3. Define the SBOM format. 2.7.8.2 |Get all SBOMs for the specified organization Get SBOM (Software Bill of Materials) reports for all repositories in the specified organization. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Define the file type you want to export. For cyclonedx, either json or xml. For spdx, either json or txt. For cyclonedx, version can be 1.4, 1.5, or 1.6. For spdx, version is 2.3. Define the SBOM format. 2.7.9 |Remediations APIs for managing Remediation 2.7.9.1 |Get Fix Suggestion Retrieves a comprehensive fix suggestion for a specified application security issue. Use optional query parameters to include data such as the original code block, remediation instructions, or the suggested code fix. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security with Application Security add-on. The unique identifier for the specific application security issue. Specifies whether to include the original code block in the response. Specifies whether to include manual remediation instructions in the response. Specifies whether to include the automated code fix in the response. Fix Suggestion Response Unique identifier for the issue. Name of the security issue. Original vulnerable code. Manual remediation instructions. Automated fix suggestions. 2.7.9.2 |Trigger Fix Pull Request Create automated pull requests to fix multiple security issues in a single bulk operation. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security with Application Security add-on. The branch name for the fix pull request. If not specified, a custom branch will be used. The title for the fix pull request. If not specified, a default message will be used. A list of unique identifiers for the issues to be fixed. Maximum 10 IDs per request. Error message if the process fails. Status of each issue. A unique identifier for issue. PR status. Possible values: -triggered: If the PR is in triggered state. -automated_fix_not_available: If the PR is in automated_fix_not_available state. Overall process status. Unique identifier to track the remediation process Error details if the process fails. 2.7.9.3 |Get Fix Status Retrieves the fix status of remediation processes using the remediation ID. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security with Application Security add-on. Indicates whether all remediation processes are complete. Remediation results grouped by repository. URL of the created pull request. Error details if the process failed. Internal repository identifier. 2.7.10 |Criteria APIs for managing Criteria 2.7.10.1 |Get all criteria Retrieves a paginated list of all criteria. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security with Application Security Add-on. Current page number in the paginated response. Total number of items in the current page. Unique Id of the criteria. Unique name of the criteria. Criteria description. Creation method for the criteria. Possible values: -manual: For the criteria created manually. -automatic: Criteria that are automatically created. Owner of the criteria. Timestamp when the criteria was created. Timestamp when the criteria was updated. Timestamp when the criteria was deleted. Additional metadata for the criteria. The number of associated applications. The number of associated assets. The current refresh status. Indicates whether the resource has been deleted from UAI. Repositories with the same name at the selected group-by level (org, project, or repository) are consolidated into a single application within the selected provider. If multiple applications share the same name at the chosen group-by level (org, project, or repository), they are merged across providers to form a single unified application. Source code management (SCM) or code hosting provider. Allowed values: GITLAB, GITHUB, BITBUCKET, AZURE_REPOS, AWS_CODE_COMMIT Runtime or execution environment provider for the application or asset. Allowed Values: GCP, AWS, AZURE A human-readable name for the criteria. Tags associated with the criteria name. The metadata of the business owner. The operational importance of the asset. Whether the asset is exposed to the internet. Criteria Type. Allowed values - cloud. Identifies the application name. If multiple values are found, the three most frequent ones are concatenated (for example, infra_bank_pay). If matching tag is not found, the application name is automatically generated by the system. Maps the business criticality level (Critical, High, Medium, or Low). If multiple values are present, the highest severity level is applied. The default value is Medium. Maps the tag key to the Business Unit. If multiple values are available, a comma-separated string containing the top five most frequent values is shown. Total number of pages for the paginated response. Number of entries in each page. Total number of items in the response. 2.7.10.2 |Get a Criteria by ID Retrieves detailed information for a specific criteria using its unique Id. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security with Application Security Add-on. Unique identifier for the criteria Unique Id of the criteria. Unique name of the criteria. Criteria description. Creation method for the criteria. Possible values: -manual: For the criteria created manually. -automatic: Criteria that are automatically created. Owner of the criteria. Timestamp when the criteria was created. Timestamp when the criteria was updated. Timestamp when the criteria was deleted. Additional metadata for the criteria. The number of associated applications. The number of associated assets. The current refresh status. Indicates whether the resource has been deleted from UAI. Repositories with the same name at the selected group-by level (org, project, or repository) are consolidated into a single application within the selected provider. If multiple applications share the same name at the chosen group-by level (org, project, or repository), they are merged across providers to form a single unified application. Source code management (SCM) or code hosting provider. Allowed values: GITLAB, GITHUB, BITBUCKET, AZURE_REPOS, AWS_CODE_COMMIT Runtime or execution environment provider for the application or asset. Allowed Values: GCP, AWS, AZURE A human-readable name for the criteria. Tags associated with the criteria name. The metadata of the business owner. The operational importance of the asset. Whether the asset is exposed to the internet. Criteria Type. Allowed values - cloud. Identifies the application name. If multiple values are found, the three most frequent ones are concatenated (for example, infra_bank_pay). If matching tag is not found, the application name is automatically generated by the system. Maps the business criticality level (Critical, High, Medium, or Low). If multiple values are present, the highest severity level is applied. The default value is Medium. Maps the tag key to the Business Unit. If multiple values are available, a comma-separated string containing the top five most frequent values is shown. 2.7.10.3 |Delete a Criteria Deletes a specific criteria identified by its unique Id. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security with Application Security Add-on. Unique identifier for the criteria 2.7.10.4 |Create a Criteria Creates a Criteria based on the provided details. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security with Application Security Add-on. Creates a new criteria object. Unique name for the criteria. Optional description for the criteria. Criteria Type. Allowed values - cloud. Repositories with the same name at the selected group-by level (org, project, or repository) are consolidated into a single application within the selected provider. If multiple applications share the same name at the chosen group-by level (org, project, or repository), they are merged across providers to form a single unified application. Source code management (SCM) or code hosting provider. Allowed values: GITLAB, GITHUB, BITBUCKET, AZURE_REPOS, AWS_CODE_COMMIT Runtime or execution environment provider for the application or asset. Allowed Values: GCP, AWS, AZURE A human-readable name for the criteria. Tags associated with the criteria name. The metadata of the business owner. The operational importance of the asset. Whether the asset is exposed to the internet. Identifies the application name. If multiple values are found, the three most frequent ones are concatenated (for example, infra_bank_pay). If matching tag is not found, the application name is automatically generated by the system. Maps the business criticality level (Critical, High, Medium, or Low). If multiple values are present, the highest severity level is applied. The default value is Medium. Maps the tag key to the Business Unit. If multiple values are available, a comma-separated string containing the top five most frequent values is shown. Unique Id of the criteria. Unique name of the criteria. 2.8 |Vulnerability Intelligence public APIs You can export the OpenAPI specs in the Cortex Stoplight instance. Vulnerability Intelligence is a real-time feed that contains vulnerability data and threat intelligence from a variety of certified upstream sources. This feed continuously pulls data from known vulnerability databases, official vendor feeds and commercial providers to provide the most accurate vulnerability detection results. In addition to the information collected from official feeds, Vulnerability Intelligence is enriched with data curated by a dedicated research team. Our security researchers monitor cloud and open-source projects to identify security issues through automated and manual means. As a result, we can detect new vulnerabilities that were only recently disclosed, and even vulnerabilities that were quietly patched. Use these public APIs to obtain details on vulnerabilities and affected software. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.8.1 |Preface You can export the OpenAPI specs in the Cortex Stoplight instance. Vulnerability Intelligence is a real-time feed that contains vulnerability data and threat intelligence from a variety of certified upstream sources. This feed continuously pulls data from known vulnerability databases, official vendor feeds and commercial providers to provide the most accurate vulnerability detection results. In addition to the information collected from official feeds, Vulnerability Intelligence is enriched with data curated by a dedicated research team. Our security researchers monitor cloud and open-source projects to identify security issues through automated and manual means. As a result, we can detect new vulnerabilities that were only recently disclosed, and even vulnerabilities that were quietly patched. Use these public APIs to obtain details on vulnerabilities and affected software. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.8.1.1 |Servers 2.8.1.2 |Authentication methods Authorized requests to the API should use: x-api-key inside a header with the access token. Authorized requests to the API should use: x-api-key-id inside a header with the access token. 2.8.2 |Vulnerabilities APIs for managing vulnerabilities 2.8.2.1 |Get list of vulnerabilities Get a list of vulnerabilities that match the filter fields. The list includes key information about each vulnerability. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management An array of filter fields Identifies the field the filter is matching. Identifies the comparison operator you want to use for this filter. Allowed values depend on the filter used. contains/not_contains: use with attack_vector, cvss_score_source, cvss_severity_source, cvss_version , distribution_and_releases, package_names, reported_exploited_by, vendors, vulnerability_id eq/neq: use with attack_vector, cisa_kev, cvss_score, cvss_score_source, cvss_severity_source, cvss_version, epss_score, vulnerability_id gte/lte: use with cvss_score, epss score, first_published, last_modified range: use with first_published, last_modified relative_timestamp: use with first_published, last_modified Values for filtering the results. array[string]: use with affected_cpu_archs, distribution_and_releases, package_names, reported_exploited_by boolean: cisa_kev string: use with attack_vector, cvss_score, cvss_severity, cvss_score_source, cvss_severity_source, cvss_version, vulnerability_id integer: use with first_published, last_modified number: use with cvss_score, epss_score Sort on any filter field except fields that take an array as their value. An integer representing the start offset index of results Default value - 0 An integer representing the start offset index of results. Use this field to specify the number of results on a page when using page token pagination. Default value - 500 Use "use_page_token":true in the initial request to paginate the response data. If "use_page_token":true was included in the initial request, the response for that request will include a page token. Use "next_page_token":"string" to pass that page token into the next request to paginate the next set of data. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Internal server error. A unified status for API communication type errors. 2.8.2.2 |Get vulnerability details Get detailed information about a specific vulnerability. For example, the following request retrieves detailed information about CVE-2021-28799: https://api-{{fqdn}}/public_api/uvem/v1/vulnerabilities?vulnerabilityId=CVE-2021-28799 Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Vulnerability ID 2.8.3 |Affected software APIs for managing affected software 2.8.3.1 |Get affected software Get a filtered list of the software affected by one or more vulnerabilities. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The field to use for filtering results. Comparison operator to use with the filter. Allowed values depend on the filters field. contains/not_contains: use with affected_cpu_archs, affected_versions, cvss_severity, distro, package_name, release, vulnerability_id eq/neq: use with distro, cvss_severity, cvss_score, package_name, release, vulnerability_id gte/lte: use with cvss_score, last_modified range: use with last_modified relative_timestamp: use with last_modified Values for filtering the results. array[string]: use with affected_cpu_archs, affected_versions string: use with cvss_score, distro, release, package_name, vulnerability_id integer: use with last_modified number: use with cvss_score An integer representing the start offset index of results Default value - 0 An integer representing the start offset index of results. Use this field to specify the number of results on a page when using page token pagination. Default value - 500 Use "use_page_token":true in the initial request to paginate the response data. If "use_page_token":true was included in the initial request, the response for that request will include a page token. Use "next_page_token":"string" to pass that page token into the next request to paginate the next set of data. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Internal server error. A unified status for API communication type errors. 2.9 |Vulnerability Management APIs You can export the OpenAPI specs in the Cortex Stoplight instance. Managing vulnerabilities effectively is crucial to proactively maintaining the security, integrity, and availability of IT infrastructure. Cortex Cloud provides a comprehensive vulnerability management platform, helping you identify, assess, prioritize, and remediate security vulnerabilities across your entire IT infrastructure including endpoints, code, and cloud. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.9.1 |Preface You can export the OpenAPI specs in the Cortex Stoplight instance. Managing vulnerabilities effectively is crucial to proactively maintaining the security, integrity, and availability of IT infrastructure. Cortex Cloud provides a comprehensive vulnerability management platform, helping you identify, assess, prioritize, and remediate security vulnerabilities across your entire IT infrastructure including endpoints, code, and cloud. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.9.1.1 |Servers 2.9.2 |Vulnerability Management Public APIs for vulnerability policy management 2.9.2.1 |Get Policies List Retrieve a paginated list of vulnerability management policies with optional filtering and sorting capabilities. This endpoint allows you to search through policies based on various criteria such as name, status, priority, and other attributes. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Filter passed in from the application that is not intended to be modified by the user. Be aware that this field is not guaranteed to not be modified by the user. Successful Response Validation Error 2.9.2.2 |Create Policy Public Create a new vulnerability management policy for issue creation, kubernetes runtime protection, or prevention actions. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Successful Response Validation Error 2.9.2.3 |Update Policy Update an existing vulnerability management policy by providing its unique identifier. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Successful Response Validation Error 2.9.2.4 |Get Policy By ID Retrieve a specific vulnerability management policy by its unique identifier. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Successful Response Validation Error 2.9.2.5 |Delete Policy Delete an existing vulnerability management policy using a policy ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Successful Response Validation Error 2.9.2.6 |Trigger Scan for an AssetId Trigger On demand Scan based on AssetId on one of CORTEX_NETWORK_SCANNER, CORTEX_XDR_AGENT, CORTEX_XDR_AGENTLESS scanners. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Request model for triggering a vulnerability scan The unique identifier of the asset to scan The type of scanner to use for the scan Type of vulnerability scanner CVE identifier (e.g., 'CVE-2024-1234'). Required when scanner_type is CORTEX_NETWORK_SCANNER, optional for other scanner types. Scan Target (e.g., 'CONTAINER' or 'HOST' or 'IMAGE'). Required when scanner_type is CORTEX_XDR_AGENT and its Linux endpoint, optional for other scanner types. Successful Response Response model for scan trigger operation Validation Error 2.10 |Cloud Infrastructure Entitlement Management APIs You can export the OpenAPI specs in the Cortex Stoplight instancehttps://cortex-panw.stoplight.io/docs/cortex-cloud/iul4tcqnj800b-cloud-infrastructure-entitlement-management-ap-is). API for searching and retrieving access information within the Cloud Infrastructure Entitlement Management(CIEM) module. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.10.1 |Preface You can export the OpenAPI specs in the Cortex Stoplight instancehttps://cortex-panw.stoplight.io/docs/cortex-cloud/iul4tcqnj800b-cloud-infrastructure-entitlement-management-ap-is). API for searching and retrieving access information within the Cloud Infrastructure Entitlement Management(CIEM) module. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.10.1.1 |Servers 2.10.2 |CIEM access Search CIEM access 2.10.2.1 |Search CIEM Access Retrieves a list of access entries based on specified filters, sorting, and pagination. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Specifies the request body format. Optional filters to apply to the search results. A list of filter conditions. Currently only supports AND logic. Identifies the field to filter. Identifies the comparison operator you want to use for this filter. Valid values are: Value that this filter must match. Optional sorting criteria for the search results. The field to sort by. Optional metadata for pagination. A token provided by a previous response to fetch the next page of results. Successful response with CIEM access data. An array of access entries. Access levels granted Transformed account access details Destination account ID Name of the destination cloud account Destination region Destination resource ID Name of the destination resource Type of the destination resource Destination resource UAI Name of the destination cloud service Category of the destination entity. Valid values include: Human: All cloud, identity provider (IdP), and platform users. Non-human: Machine identities that can assume permissions and perform cloud Identity and Access Management (IAM) actions such as VMs and functions. Cloud Service Account: A category unifying AWS roles, Microsoft Azure service accounts and managed identities, and GCP service accounts. IAM Group: IAM group, which is a collection of IAM users. IAM Policy: Permission documents, such as AWS policies, Azure roles, and GCP roles. Labels describing access to data Number of excessive policies Granted by cloud entity ID Name of the cloud entity that granted access Type of the cloud entity that granted access Granted by cloud entity UAI Category of the granter entity Indicates if last access is supported Timestamp of when access was last used Scope of the permission Source account ID Indicates if the source account is a known vendor Name of the source cloud account Source resource ID Name of the source resource Type of the source resource Source resource UAI Name of the source cloud service Category of the source entity. Valid values include: Name of the source vendor Number of unused actions Metadata for pagination. A token to retrieve the next page of results, if available. The number of results after applying filters. The total number of available results, ignoring pagination. Bad Request. Invalid JSON. Unauthorized access. An issue occurred during authentication. This can indicate an incorrect key, id, or other invalid authentication parameters. Unauthorized access. User does not have the required license type to run this API. Forbidden access. The provided API Key does not have the required RBAC permissions to run this API. Internal server error. A unified status for API communication type errors. 2.11 |Compliance Controls API You can export the OpenAPI specs in the Cortex Stoplight instance. API for managing compliance controls, rules and retrieving compliance results. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.11.1 |Preface You can export the OpenAPI specs in the Cortex Stoplight instance. API for managing compliance controls, rules and retrieving compliance results. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.11.1.1 |Servers 2.11.1.2 |Authentication methods API Key ID for authentication Authorized requests to the API should use: x-xdr-auth-id inside a header with the access token. API Key for authentication Authorized requests to the API should use: Authorization inside a header with the access token. 2.11.1.2.1 |Default authentication XDRAuth=[], XDRAuthToken 2.11.2 |Assessment profiles Operations for managing assessment profiles 2.11.2.1 |Get assessment profiles An assessment profile uses a standard to run scans on an asset group to check whether the assets adhere to the standard. Retrieve compliance assessment profiles with optional filtering, sorting and pagination. The response is concatenated using AND condition (OR is not supported) The maximum result set size is >100 Offset is the zero-based number of assessment profiles from the start of the result set Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Identifies the assessment profile field the filter should match. Filters are based on the following keywords: name: Assessment profile name standard_name : Standard name description: Assessment profile description asset_group_name: Asset Group name created_by: Creator of the assessment profile modified_by: Modifier of the assessment profile id: Assessment profile ID report_type: Report type standard_id: Standard ID creation_time: Assessment profile's creation time modification_time: Assessment profile's modification time enabled: Whether the assessment profile is enabled asset_group_id: Asset Group ID Identifies the comparison operator you want to use for this filter. Valid keywords are: eq / neq / contains / not_contains name, standard_name, description, asset_group_name, created_by, modified_by, id, report_type, standard_id: String gte, lte, range, relative_timestamp creation_time, modification_time: Integer in timestamp epoch milliseconds enabled: valid values are yes or no asset_group_id: String Value that this filter must match. The contents of this field will differ depending on the assessment profile field that you specified for this filter When the field value is one of the following, the value is type string: name, standard_name, description, asset_group_name, created_by, modified_by, id, report_type, standard_id, asset_group_id When the field value is one of the following, the value is type integer: creation_time, modification_time Sort according to this field Sort in ascending (asc) or descending (desc) order Integer representing the starting offset within the query result set from which you want assessment profiles returned. Assessment profiles are returned as a zero-based list. Any assessment profile indexed less than this value is not returned in the final result set and defaults to zero. Integer representing the end offset within the result set after which you do not want assessment profiles returned. Assessment profiles in the assessment profile list that are indexed higher than this value are not returned in the final results set. Defaults to >100, which returns all assessment profiles to the end of the list. Successfully retrieved assessment profiles Total number of records Number of records matching the filter + paging Assessment profile ID Assessment profile name Description of the assessment profile Whether the assessment profile is enabled Asset Group name Assessment profile creation time Assessment profile modification time Assessment profile creator Assessment profile modified by Bad request - invalid input parameters Additional error details Authentication required Error message describing what went wrong Access denied - insufficient permissions Internal server error 2.11.2.2 |Get assessment profile by ID An assessment profile uses a standard to run scans on an asset group to check whether the assets adhere to the standard. Get details of the assessment profile specified by its ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Assessment profile ID Successfully retrieved assessment profile Assessment profile name Description of the assessment profile Whether the assessment profile is enabled Asset Group name Assessment profile creation time Assessment profile modification time Assessment profile creator Assessment profile modified by Bad request - invalid input parameters Additional error details Authentication required Error message describing what went wrong Access denied - insufficient permissions Resource not found Internal server error 2.11.2.3 |Add assessment profile Create a custom compliance assessment profile that is tailored to your own business needs and organizational policies. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Name of the assessment profile Description of the assessment profile Assessment profile targets Assessment profile report type. Valid values include: Assessment report evaluation frequency Successfully created assessment profile Whether the assessment profile creation succeeded Bad request - invalid input parameters Additional error details Authentication required Error message describing what went wrong Access denied - insufficient permissions Conflict - duplicate resource Internal server error 2.11.2.4 |Edit assessment profile Edit an existing compliance custom assessment profile. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Assessment profile ID Enable or disable the assessment profile Whether the assessment profile is enabled. Valid values are: Whether the assessment profile is enabled Name of the assessment profile Description of the assessment profile List of email addresses for reports Type of reporting. Valid values include: Cron expression for assessment report evaluation frequency Compliance standard ID Successfully updated assessment profile Bad request - invalid input parameters Additional error details Authentication required Error message describing what went wrong Access denied - insufficient permissions Resource not found Conflict - duplicate resource Internal server error 2.11.2.5 |Delete assessment profile Delete an assessment profile specified by its ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Assessment profile ID Successfully deleted assessment profile Whether the assessment profile deletion succeeded Bad request - invalid input parameters Additional error details Authentication required Error message describing what went wrong Access denied - insufficient permissions Resource not found Internal server error 2.11.3 |Assessment results Operations for managing assessment results 2.11.3.1 |Get assessment profile results Retrieve assessment profile results with optional filtering based on the last successful evaluation. Filtering Support: Field (labels): contains, not_contains Note: This API does not support sorting or pagination. Sorting will not take effect even if it is specified in the payload. The results will not return the results based on sorting' Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Array of filter objects Field to filter on (only 'labels' is supported) Filter operator to apply. Valid values include: Value to filter by Successfully retrieved assessment profile results Total number of assessment results available Number of assessment results matching the applied filters Count from standard filter processing Total count from standard processing Array of assessment profile results Bad request - invalid input parameters Additional error details Authentication required Error message describing what went wrong Access denied - insufficient permissions Internal server error 2.11.4 |Controls Operations for managing compliance controls 2.11.4.1 |Get compliance controls Compliance controls are measures related to the standard that ensure compliance and mitigate risks. Controls are built from one or more rules, the specific checks that run on an asset. Controls can be grouped into categories, for example RBAC and Pod security. Retrieve compliance control details with optional filtering, sorting and pagination. The response is concatenated using AND condition (OR is not supported) The maximum result set size is >100 Offset is the zero-based number of assessment profiles from the start of the result set Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Identifies the compliance control field the filter should match. Filters are based on the following keywords: name: Compliance control name category : Compliance control category subcategory: Compliance control subcategory description: Compliance control description created_by: Creator of the compliance control modified_by: Modifier of the compliance control id: Compliance control ID creation_time: Compliance control's creation time modification_time: Compliance control's modification time is_custom: Whether the compliance control is custom Identifies the comparison operator you want to use for this filter. Valid keywords are: eq / neq / contains / not_contains: name, category, subcategory, created_by, modified_by, id, description: String gte, lte, range, relative_timestamp: creation_time, modification_time: Integer in timestamp epoch milliseconds is_custom: valid values are yes or no Value that this filter must match. The contents of this field will differ depending on the assessment profile field that you specified for this filter. When the field value is one of the following, the value is type string: name, category, subcategory, created_by, modified_by, id, description When the field value is one of the following, the value is type integer: creation_time, modification_time Sort according to this field Sort in ascending (asc) or descending (desc) order Integer representing the starting offset within the query result set from which you want compliance controls returned. Compliance controls are returned as a zero-based list. Any compliance control indexed less than this value is not returned in the final result set and defaults to zero. Integer representing the end offset within the result set after which you do not want compliance controls returned. Compliance controls in the compliance control list that are indexed higher than this value are not returned in the final results set. Defaults to >100, which returns all compliance controls to the end of the list. Successfully retrieved controls Total number of controls Number of controls matching filters + paging Compliance control ID Compliance control name Description of the compliance control Compliance control category Compliance control subcategory Creation timestamp Last modification timestamp User who created the control User who last modified the control Whether this is a custom control Bad request - invalid input parameters Additional error details Internal server error 2.11.4.2 |Get compliance control by ID Get details of the compliance control specified by its ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Compliance control ID Successfully retrieved control Bad request - invalid input parameters Additional error details Resource not found Internal server error 2.11.4.3 |Add new control Create a custom compliance control. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Name of the compliance control Description of the compliance control Compliance control category Compliance control subcategory Control added successfully Whether the compliance control creation was successful Bad request - invalid input parameters Additional error details Internal server error 2.11.4.4 |Edit existing control Edit an existing compliance custom compliance control. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Compliance control ID Name of the compliance control Description of the compliance control Compliance control category Compliance control subcategory Control updated successfully Whether the custom compliance control was edited successfully Bad request - invalid input parameters Additional error details Resource not found Internal server error 2.11.4.5 |Delete control Delete a compliance control specified by its ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Compliance control ID Control deleted successfully Whether the compliance control was successfully deleted Bad request - invalid input parameters Additional error details Resource not found Internal server error 2.11.4.6 |Get control by revision Get details of the compliance control specified by its revision ID, including inactive controls. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Control revision ID Successfully retrieved control Compliance control ID Compliance control name Description of the compliance control Compliance control category Compliance control subcategory Creation timestamp Last modification timestamp User who created the control User who last modified the control Whether this is a custom control Bad request - invalid input parameters Additional error details Resource not found Internal server error 2.11.5 |Rules Operations for managing compliance rules 2.11.5.1 |Add compliance rules to a compliance control Add compliance rules to the specific compliance control. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Compliance control ID Description of the rule Logical identifier for the rule Rule severity level List of scannable asset types Steps to remediate violations Whether to generate findings for this rule Whether to generate issues for this rule Whether to generate scan logs for this rule Rules added successfully Whether the rules were added successfully Bad request - invalid input parameters Additional error details Internal server error 2.11.5.2 |Delete rules from control Remove specific rules from the specified compliance control. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Compliance control ID List of rule IDs to delete Rules deleted successfully Whether the rules were successfully deleted from the compliance control Bad request - invalid input parameters Additional error details Internal server error 2.11.6 |Categories Operations for retrieving categories and subcategories 2.11.6.1 |Get categories and subcategories Retrieve available compliance control categories and subcategories. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Successfully retrieved categories and subcategories Available control categories Available control subcategories Internal server error Additional error details 2.11.7 |Results Operations for retrieving compliance results and findings 2.11.7.1 |Get control failed results Get the failed findings and issues for a specific compliance control. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Compliance control revision ID Assessment profile revision ID Last evaluation timestamp (epoch time in milliseconds) Successfully retrieved failed results The number of issues with this level of severity List of issue IDs with this level of severity Bad request - invalid input parameters Additional error details Internal server error 2.11.7.2 |Get rule failed results Get the failed findings and issues for a specific rule. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Compliance control revision ID Assessment profile revision ID Last evaluation timestamp (epoch time in milliseconds) Successfully retrieved rule failed results The number of issues with this level of severity List of issue IDs with this level of severity Bad request - invalid input parameters Additional error details Internal server error 2.11.8 |Reports Operations for managing reports 2.11.8.1 |Get compliance reports Retrieve archived compliance assessment reports with optional filtering, sorting and pagination. The response is concatenated using AND condition (OR is not supported) The maximum result set size is >100 Offset is the zero-based number of assessment profiles from the start of the result set Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Optional filters to apply to the reports Identifies the compliance report field the filter should match. Filters are based on the following keywords: standard_name: Standard name assessment_profile_name: Assessment profile name asset_group_name: Asset Group name score: Compliance score evaluation_time: Evaluation time Identifies the comparison operator you want to use for this filter. Valid keywords are: eq / neq / contains / not_contains: standard_name, assessment_profile_name, asset_group_name: String gte / lte / range / relative_timestamp: `evaluation_time``: Integer in timestamp epoch milliseconds gte / lte / eq / neq: Value that this filter must match. The contents of this field will differ depending on the assessment profile field that you specified for this filter. When the field value is one of the following, the value is type string: standard_name, assessment_profile_name, asset_group_name When the field value is one of the following, the value is type integer: evaluation_time, score Sorting configuration Field to sort by Starting index for pagination Ending index for pagination Successfully retrieved compliance reports Total number of reports in the archive Number of reports returned in this response (filter + paging) Number of reports matching the filter criteria List of compliance reports Bad request - invalid input parameters for reports Additional error details Internal server error 2.11.9 |Standards Operations for managing standards 2.11.9.1 |Get compliance standards Retrieve compliance standards with optional filtering, sorting and pagination. The response is concatenated using AND condition (OR is not supported) The maximum result set size is >100 Offset is the zero-based number of assessment profiles from the start of the result set Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Array of filter conditions Identifies the compliance standard field the filter should match. Filters are based on the following keywords: name: Compliance standard name id: Compliance standard ID publisher: Compliance standard publisher created_by: User who created the compliance standard insertion_time: When the compliance standard was created is_custom: Whether the compliance standard is custom labels: Compliance standard labels Identifies the comparison operator you want to use for this filter. Valid keywords are: eq / neq / contains / not_contains: name, id, publisher, created_by: String gte / lte / range / relative_timestamp: `insertion_time``: Integer in timestamp epoch milliseconds is_custom: Enum with possible values of yes or no contains / not_contains: labels: Array of strings Value that this filter must match. The contents of this field will differ depending on the assessment profile field that you specified for this filter. When the field value is one of the following, the value is type string: name, id, publisher, created_by When the field value is one of the following, the value is type integer: insertion_time Field to sort by Number of records to skip Maximum number of records to return Successfully retrieved standards Total number of standards in the system Number of standards matching the filter criteria + paging Description of the standard Standard publisher/organization List of labels for categorization Creation timestamp (epoch) User who created the standard Whether this is a custom standard Number of associated controls List of associated control IDs Bad request - invalid input parameters Additional error details Internal server error 2.11.9.2 |Get single standard by ID Retrieve details of the compliance standard specified by its ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Compliance standard ID Successfully retrieved standard Description of the standard Standard publisher/organization List of labels for categorization Creation timestamp (epoch) User who created the standard Whether this is a custom standard Number of associated controls List of associated control IDs Bad request - invalid input parameters Additional error details Resource not found Internal server error 2.11.9.3 |Add new standard Create a new compliance standard. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Name of the compliance standard Description of the standard List of labels for categorization List of control IDs to associate with this standard. Only custom controls can be included. Standard added successfully Operation success status Bad request - invalid input parameters Additional error details Internal server error 2.11.9.4 |Edit existing standard Edit an existing compliance standard specified by its ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Compliance standard ID Name of the standard Description of the standard List of labels for categorization List of control IDs to associate with this standard. Only custom controls can be included. Standard updated successfully Operation success status Bad request - invalid input parameters Additional error details Resource not found Internal server error 2.11.9.5 |Delete standard Delete a the compliance standard specified by its ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Compliance standard ID Standard deleted successfully Operation success status Bad request - invalid input parameters Additional error details Resource not found Internal server error 2.11.10 |Compliance Assets Operations for retrieving compliance assets 2.11.10.1 |Get compliance assets Retrieve compliance assets with required assessment profile revision and last evaluation time, with optional filtering, sorting and pagination. Filtering Support: String fields (asset_name, rule_name, control): eq, neq, contains, not_contains Status fields (asset_type, status, severity, rule_type): eq, neq Status valid values: [FAILED, PASSED, NOT_ASSESSED] Severity valid values: [low, medium, high, critical] Sorting Support: Available fields: asset_name, asset_type, status, rule_name, control, severity Sort orders: asc, desc Default: asset_name in ascending order Pagination: (max number of elements is 100) Assessment profile revision identifier Last evaluation timestamp in epoch format Array of filter objects for filtering assets Field to filter on Filter operator to apply Value to filter by Field to sort by Starting index for pagination Ending index for pagination Successfully retrieved compliance assets Total number of assets available Number of assets matching the applied filters + paging Number of assets matching the applied filters Array of compliance assets Identifier for the asset Name of the asset Type of the asset Compliance status of the asset Name of the compliance rule Associated compliance control Identifier for the compliance rule Identifier for the associated compliance control Severity level of the compliance issue Type of the compliance rule Geographic region Realm identifier Organization identifier Strong identifier for the asset Bad request - invalid input parameters Additional error details Authentication required Error message describing what went wrong Access denied - insufficient permissions Internal server error 2.12 |Cloud Workload Protection APIs You can export the OpenAPI specs in the Cortex Stoplight instance. Cloud Workload Policies and Rules ensure security compliance, prevent misconfigurations, and mitigate risks across cloud environments. Cloud Workload Policies leverage actionable findings or enforce preventive measures at defined stages of the Software Development Life Cycle (SDLC). Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.12.1 |Preface You can export the OpenAPI specs in the Cortex Stoplight instance. Cloud Workload Policies and Rules ensure security compliance, prevent misconfigurations, and mitigate risks across cloud environments. Cloud Workload Policies leverage actionable findings or enforce preventive measures at defined stages of the Software Development Life Cycle (SDLC). Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.12.1.1 |Servers 2.12.1.2 |Authentication methods Authorized requests to the API should use: x-api-key inside a header with the access token. Authorized requests to the API should use: x-api-key-id inside a header with the access token. 2.12.2 |SBOM APIs for managing SBOMs 2.12.2.1 |Get the SBOM of the specified asset Get an SBOM (Software Bill of Materials) report for the specified asset. You can specify the format and version of the SBOM, as well as which attribute you would like included. Required license: Cortex Cloud Runtime Security. In Cortex Cloud Posture Management, requires the Cortex Cloud Runtime Security add-on. ID of the asset of which you want to export the SBOM The format in which the SBOM is to be exported. The version of the SBOM format to be used. The list of attributes to be included in the SBOM. If not specified, all fields are included except Type and Name, which are always included. OK. The request was successful, and the SBOM data is returned in the specified format. Bad Request. The request was malformed, missing the required parameters, or the Asset ID provided does not support SBOM Export. HTTP response code. Additional information describing the error. The API key provided is invalid or missing. Forbidden. The API key does not have the necessary permissions to access the requested resource. The specified asset was not found. An error occurred on the server while processing the request. 2.12.3 |Policies APIs for managing Cloud Workload Policies 2.12.3.1 |Get CWP policies Cloud Workload Policies help you prevent and manage security violations in your cloud runtime instances. They enable you to apply detection logic to specific asset groups at the desired SDLC stage, and define what action needs to be taken if the conditions are met. Get all CWP policies of the given type. Default behavior is all. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The response you get when calling the get policies path One of the supported policy types One of the supported evaluation stages The UUIDs of the rules that define the condition The rulesIds field is only required for non-compliance policies. The condition field is only required for non-compliance policies. One of the supported policy actions One of the supported policy severities The error message Details for the PublicAPIError A short, programmatically safe string indicating the error code reported Service had unexpected internal error 2.12.3.2 |Add CWP policies Add CWP policy instances. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The schema of a policy One of the supported policy types One of the supported evaluation stages The UUIDs of the rules that define the condition The rulesIds field is only required for non-compliance policies. The condition field is only required for non-compliance policies. One of the supported policy actions One of the supported policy severities The error message Details for the PublicAPIError A short, programmatically safe string indicating the error code reported Service had unexpected internal error 2.12.3.3 |Get a CWP policy by ID Get a CWP policy by its ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The schema of a policy One of the supported policy types One of the supported evaluation stages The UUIDs of the rules that define the condition The rulesIds field is only required for non-compliance policies. The condition field is only required for non-compliance policies. One of the supported policy actions One of the supported policy severities Policy ID not found The error message Details for the PublicAPIError A short, programmatically safe string indicating the error code reported Service had unexpected internal error 2.12.3.4 |Delete a CWP policy by ID Delete a CWP policy by its ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The policy ID to delete If set, will trigger issue closing of issues opened by the deleted policy The error message Details for the PublicAPIError A short, programmatically safe string indicating the error code reported Policy ID not found Service had unexpected internal error 2.12.3.5 |Update a CWP policy by ID Update a CWP policy by its ID. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management The policy ID to delete The schema of a policy One of the supported policy types One of the supported evaluation stages The UUIDs of the rules that define the condition The rulesIds field is only required for non-compliance policies. The condition field is only required for non-compliance policies. One of the supported policy actions One of the supported policy severities The error message Details for the PublicAPIError A short, programmatically safe string indicating the error code reported Policy ID not found Service had unexpected internal error 2.13 |CWP Registry Connector APIs Public APIs to onboard third-party registry connectors (such as Docker Hub, GitLab, Harbor, JFrog, and OpenShift) and managing their instances. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security. 2.13.1 |Preface Public APIs to onboard third-party registry connectors (such as Docker Hub, GitLab, Harbor, JFrog, and OpenShift) and managing their instances. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security. 2.13.1.1 |Servers 2.13.2 |Default 2.13.2.1 |Create a registry connector Creates a new registry connector for based on the provided details. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security. The connector ID. Name of the registry vendor. Name of the registry connector. Indicates whether the connector is enabled. The URL of the registry. The username for authentication. The password for authentication. Token to authenticate the request. The scanning mode used by the connector Specifies the cloud provider for the Cortex environment to use for registry scanning. Specifies the region to use for registry scanning. As a best practice, choose the region closest to your registry deployment to achieve the best scanning throughput and potentially reduce cloud costs. When set to true, allows image pulls from insecure registries. Optional. The CA certificate used for authentication. Optional. The repository used for image discovery. Specifies the initial scan configuration mode. ALL — Scans all container images, including every tag, in all discovered repositories. LATEST_TAG — Scans only images tagged as latest in all discovered repositories. TAGS_MODIFIED_DAYS — Scans images in each repository modified within the last X days, where X is set via an argument. You can select a range of up to 90 days for the scan. Number of days for the scan mode lastNDays Optional. Indicates whether static IP addresses are allowed. Optional. The identifier associated with the IP address. Defines the type of assets to be filtered (the scope). You can combine multiple conditions to create complex rules for when the asset filter should be applied. Defines the Field to be searched. Defines the comparison operator to use for this filter. Defines the value to be searched. The type of registry. Indicates the Broker VM type used by the Outpost. Controls whether asset_scope_filters act as an inclusion or exclusion filter. Vendor specific configuration options for scanning. Optional. The group IDs to scan. Optional. The project IDs to scan. Optional. The API domain name to use for the scan. Optional. The Docker Hub repository to scan. The unique identifier of the OpenShift cluster. The name of the OpenShift cluster. The asset ID associated with the cluster. The asset type ID of the cluster. The realm or environment in which the cluster resides. Connector details have been stored successfully. The error message Details for the PublicAPIError A short, programmatically safe string indicating the error code reported Service had unexpected internal error 2.13.2.2 |Get a registry connector Retrieves a registry connector details using its unique ID. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security. The unique identifier for the connector. Connector details retrieved successfully. The connector ID. Name of the registry vendor. The name of the registry connector. Indicates whether the connector is enabled. The URL of the registry. The username for authentication. The password for authentication. Authentication token used to authorize requests to the API. The scanning mode used by the connector Specifies the cloud provider for the Cortex environment to use for registry scanning. The region of the connector. When set to true, allows image pulls from insecure registries. Optional. The CA certificate used for authentication. Optional. The repository used for image discovery. Specifies the initial scan configuration mode. ALL — Scans all container images, including every tag, in all discovered repositories. LATEST_TAG — Scans only images tagged as latest in all discovered repositories. TAGS_MODIFIED_DAYS — Scans images in each repository modified within the last X days, where X is set via an argument. You can select a range of up to 90 days for the scan. Number of days for the scan mode lastNDays Optional. Indicates whether static IP addresses are allowed. Optional. The identifier associated with the IP address. Defines the type of assets to be filtered (the scope). You can combine multiple conditions to create complex rules for when the asset filter should be applied. Defines the Field to be searched. Defines the comparison operator to use for this filter. Defines the value to be searched. The type of registry. Indicates the Broker VM type used by the Outpost. Controls whether asset_scope_filters act as an inclusion or exclusion filter. Vendor specific configuration options for scanning. Optional. The group IDs to scan. Optional. The project IDs to scan. Optional. The API domain name to use for the scan. Optional. The Docker Hub repository to scan. The unique identifier of the OpenShift cluster. The name of the OpenShift cluster. The asset ID associated with the cluster. The asset type ID of the cluster. The realm or environment in which the cluster resides. Connector not found. The error message Details for the PublicAPIError A short, programmatically safe string indicating the error code reported Service had unexpected internal error. 2.13.2.3 |Update a registry connector Updates the attributes of an existing registry connector identified by its unique ID. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security. The unique identifier for the connector. The connector ID. Name of the registry vendor. Name of the registry connector. Indicates whether the connector is enabled. The URL of the registry. The username for authentication. The password for authentication. Token to authenticate the request. The scanning mode used by the connector Specifies the cloud provider for the Cortex environment to use for registry scanning. Specifies the region to use for registry scanning. As a best practice, choose the region closest to your registry deployment to achieve the best scanning throughput and potentially reduce cloud costs. When set to true, allows image pulls from insecure registries. Optional. The CA certificate used for authentication. Optional. The repository used for image discovery. Specifies the initial scan configuration mode. ALL — Scans all container images, including every tag, in all discovered repositories. LATEST_TAG — Scans only images tagged as latest in all discovered repositories. TAGS_MODIFIED_DAYS — Scans images in each repository modified within the last X days, where X is set via an argument. You can select a range of up to 90 days for the scan. Number of days for the scan mode lastNDays Optional. Indicates whether static IP addresses are allowed. Optional. The identifier associated with the IP address. Defines the type of assets to be filtered (the scope). You can combine multiple conditions to create complex rules for when the asset filter should be applied. Defines the Field to be searched. Defines the comparison operator to use for this filter. Defines the value to be searched. The type of registry. Indicates the Broker VM type used by the Outpost. Controls whether asset_scope_filters act as an inclusion or exclusion filter. Vendor specific configuration options for scanning. Optional. The group IDs to scan. Optional. The project IDs to scan. Optional. The API domain name to use for the scan. Optional. The Docker Hub repository to scan. The unique identifier of the OpenShift cluster. The name of the OpenShift cluster. The asset ID associated with the cluster. The asset type ID of the cluster. The realm or environment in which the cluster resides. Connector details have been updated successfully. The error message Details for the PublicAPIError A short, programmatically safe string indicating the error code reported Connector ID not found Service had unexpected internal error 2.13.2.4 |Delete a registry connector Deletes a specific registry connector identified by its unique ID. Required license: Cortex Cloud Posture Management or Cortex Cloud Runtime Security. The unique identifier for the connector. Connector deleted successfully. Connector not found. The error message Details for the PublicAPIError A short, programmatically safe string indicating the error code reported Service had unexpected internal error. 2.14 |Data Security Posture Management APIs You can export the OpenAPI specs in the Cortex Stoplight instance. The Cortex Cloud Data Security solution is an agentless multi-cloud data security platform that discovers, classifies, protects, and governs sensitive data. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.14.1 |Preface You can export the OpenAPI specs in the Cortex Stoplight instance. The Cortex Cloud Data Security solution is an agentless multi-cloud data security platform that discovers, classifies, protects, and governs sensitive data. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.14.1.1 |Servers 2.14.2 |Inventory Inventory Management 2.14.2.1 |Get data pattern inventory Get all data patterns found in the environment, including high-level aggregations for each of them. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Internal Server Error 2.14.2.2 |Get field inventory details Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Internal Server Error 2.14.2.3 |Get file inventory details Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management Internal Server Error 2.15 |Detection Rules Management API API for managing detection rules including CRUD operations for security policies, compliance metadata, and rule configurations. 2.15.1 |Preface API for managing detection rules including CRUD operations for security policies, compliance metadata, and rule configurations. 2.15.1.1 |Servers 2.15.1.2 |Authentication methods API key authentication using x-xdr-auth-id header Authorized requests to the API should use: x-xdr-auth-id inside a header with the access token. 2.15.2 |Detection Rules Manage detection rules for cloud security posture. Detection rules define XQL queries that identify misconfigurations, compliance violations, and security risks across cloud resources. 2.15.2.1 |Create Detection Rule Creates a new detection rule with the specified configuration including name, severity, query, and compliance metadata. The rule will be validated and persisted if all required fields are provided correctly. api_key_id authentication identifier Request body for creating a detection rule Unique rule name Detailed rule description Rule class - Must be 'config' (CSPM) Rule type - Must be 'DETECTION' (can be inferred if not provided) Array with single asset type identifier (exactly one required) Rule severity (low, medium, high, critical, informational) Query object containing XQL Valid XQL query string Metadata containing issue information Issue information Remediation steps List of compliance metadata with control IDs Compliance control identifier Custom labels (max 50, each max 100 chars) Rule enabled status (default: true) Rule successfully created Response for rule operations Unique rule identifier Rule description Cloud providers (derived from asset_types) Array of asset type identifiers XQL query string Array of compliance metadata objects with full standard and control information Full name of the compliance standard Full name of the compliance control Rule enabled status System default rule indicator Creator identifier Creation timestamp (epoch milliseconds) Last modification timestamp (epoch milliseconds) Deletion timestamp (epoch milliseconds) User who deleted the rule Bad Request - Invalid parameters Conflict - Rule with same name already exists Too Many Requests Internal Server Error Service Unavailable 2.15.2.2 |Get Detection Rules Searches for detection rules based on filter criteria with support for pagination and sorting. Returns a list of rules matching the specified filters. api_key_id authentication identifier Request body for querying detection rules Filter criteria for searching rules Array of filter criteria to be combined with AND logic Array of filter criteria to be combined with OR logic Field name to search on Search operation type (EQ, NEQ, CONTAINS, NCONTAINS) Value to search for Starting index for pagination Ending index for pagination Field name to sort by Sort order (ASC or DESC) Response containing a list of detection rules with metadata List of detection rules matching the filter criteria Array of asset type identifiers Array of compliance metadata objects with full standard and control information Full name of the compliance standard Compliance control identifier Full name of the compliance control List of compliance standards associated with the rule User who created the rule Timestamp when the rule was created (milliseconds since epoch) Detailed description of the rule Whether the rule is enabled Unique identifier of the rule Custom labels associated with the rule User who last modified the rule Timestamp when the rule was last modified (milliseconds since epoch) Module the rule belongs to Name of the rule Severity level of the rule Whether this is a system default rule Type of the rule Metadata about the response including counts Number of rules matching the filter criteria Total number of rules available Too many requests Internal Server Error Service Unavailable 2.15.2.3 |Get Rule By Id Retrieves a specific detection rule by its unique identifier. Returns the complete rule configuration including query, compliance metadata, and labels. Unique identifier of the detection rule to retrieve api_key_id authentication identifier Rule successfully retrieved Response for rule operations Unique rule identifier Rule description Cloud providers (derived from asset_types) Array of asset type identifiers XQL query string Metadata containing issue information Issue information Remediation steps Array of compliance metadata objects with full standard and control information Full name of the compliance standard Compliance control identifier Full name of the compliance control Rule enabled status System default rule indicator Creator identifier Creation timestamp (epoch milliseconds) Last modification timestamp (epoch milliseconds) Deletion timestamp (epoch milliseconds) User who deleted the rule Bad Request - Invalid ID format Not Found - Rule does not exist Too Many Requests Internal Server Error Service Unavailable 2.15.2.4 |Update Detection Rule Updates an existing detection rule with the provided fields. Only the fields included in the request body will be updated. The rule_class field is required for validation. Unique identifier of the detection rule to update api_key_id authentication identifier Request body for updating a detection rule Rule name (must be unique if changed) Rule description Rule class - Must be 'config' (CSPM) Rule type - Must be 'DETECTION' Array with single asset type identifier (exactly one if provided) Rule severity (low, medium, high, critical, informational) Query object containing XQL (only editable for custom config rules with XQL) XQL query string (only editable for custom config rules with XQL) Metadata containing issue information Issue information Remediation steps List of compliance metadata with control IDs Compliance control identifier Custom labels (max 50, each max 100 chars) Rule enabled status Rule successfully updated Response for rule operations Unique rule identifier Cloud providers (derived from asset_types) Array of asset type identifiers XQL query string Array of compliance metadata objects with full standard and control information Full name of the compliance standard Full name of the compliance control System default rule indicator Creator identifier Creation timestamp (epoch milliseconds) Last modification timestamp (epoch milliseconds) Deletion timestamp (epoch milliseconds) User who deleted the rule Bad Request - Invalid parameters Not Found - Rule does not exist Conflict - Name already exists Too Many Requests Internal Server Error Service Unavailable 2.15.2.5 |Delete Detection Rule Permanently deletes a detection rule by its unique identifier. This action cannot be undone. Only custom rules can be deleted; system default rules cannot be removed. Unique identifier of the detection rule to delete api_key_id authentication identifier Rule successfully deleted (no content) Bad Request - Invalid ID format Not Found - Rule does not exist Too Many Requests Internal Server Error Service Unavailable 2.16 |Trusted Images APIs You can export the OpenAPI specs in the Cortex Stoplight instance. Trusted images is a security control that lets you declare, by policy, which registries, repositories, and images you trust. These policies also help you define the actions you wish to take when untrusted images are initiated in your environment.This microservice provides a CRUD model for managing rules in the Cloud Workload Protection module. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.16.1 |Preface You can export the OpenAPI specs in the Cortex Stoplight instance. Trusted images is a security control that lets you declare, by policy, which registries, repositories, and images you trust. These policies also help you define the actions you wish to take when untrusted images are initiated in your environment.This microservice provides a CRUD model for managing rules in the Cloud Workload Protection module. Required license: Cortex Cloud Runtime Security or Cortex Cloud Posture Management 2.16.1.1 |Servers 2.16.2 |Rules Management Service Manages Cortex Cloud security detection rules 2.16.2.1 |Delete Policies Delete policies/rule instances from the rules management service. If set, will trigger issue closing of issues opened by the deleted policies Indicates a forbidden access response Service had unexpected internal error 2.16.2.2 |Get Policies Get all latest policies/rule instances from a list of given policy types. Default behavior is all. Lists policy types to fetch. This flag bypasses calling the platform for asset groups data when fetching policies. Note that this means asset groups will not be updated when fetching policies. The response you get when calling the get policies path One of the supported policy actions Lists supported evaluation stages The UUIDs of the rules that define the condition One of the supported policy severities One of the supported policy types Service had unexpected internal error 2.16.2.3 |Add Policies Adds policies and rule instances to the rules management service. One of the supported policy actions Lists supported evaluation stages The UUIDs of the rules that define the condition One of the supported policy severities One of the supported policy types Indicates a forbidden access response Service encountered unexpected internal error 2.16.2.4 |Update Policies Updates policies and rule instances in the rules management service. One of the supported policy actions Lists supported evaluation stages The UUIDs of the rules that define the condition One of the supported policy severities One of the supported policy types Indicates a forbidden access response Service encountered unexpected internal error 2.16.2.5 |Disable Policies Disable policies/rule instances. Indicates a forbidden access response Service encountered unexpected internal error 2.16.2.6 |Enable Policies Enable policies/rule instances. Indicates a forbidden access response Service encountered unexpected internal error 2.16.2.7 |Get a Policy by ID Get a policy instance by its ID. Flag to bypass calling platform for asset groups data when fetching policy. Note that this means asset groups will not be updated upon fetching policy. The schema of a returned policy One of the supported policy actions Lists supported evaluation stages The UUIDs of the rules that define the condition One of the supported policy severities One of the supported policy types Bad request error Policy not found Service had unexpected internal error 2.16.2.8 |Add (custom) Compliance rules Adds a custom compliance rule to the rules management service. A list of the available actions Lists rule standards Lists UAI assets relevant to the rule Supported rule severities Indicates a forbidden access response Service encountered an unexpected internal error 2.16.2.9 |Delete (custom) CWP Rules Delete custom CWP Rules instances from the rules management service. Indicates a forbidden access response Service encountered an unexpected internal error 2.16.2.10 |Get rules by IDs Get rules by a list of IDs. If a rule is not found for a specific ID, an error is returned. Success. Returns a list of rule objects. A list of the available actions Lists rule standards Lists UAI assets relevant to the rule Supported rule severities Bad request error. Service encountered an unexpected internal error. 2.16.2.11 |Get the Compliance Rules Get all Compliance rules (system and custom).This API supports pagination. Fetches rules from offset location, default is 0. The maximum number of rules to fetch in a single page request, if not specified. default is set to fetch all. The policy rule definitions types to fetch. The platform to which the rules should be applied. The scanner source type for the rule. Returns a compliance rules page The maximum rules to fetch in a single page request, if not provided default is to fetch all. The offset from where the rules fetched Lists available actions Lists rule standards Lists UAI assets relevant to the rule Supported rule severities Total filtered count of rules Service encountered an unexpected internal error 2.16.2.12 |Get a rule by ID Get a rule instance by its ID. The schema of a rule definition A list of the available actions Lists rule standards Lists UAI assets relevant to the rule Supported rule severities Bad request error Service encountered an unexpected internal error 2.16.2.13 |rego script linter lint the content of the rego script Invalid script syntax Service encountered an unexpected internal error 2.16.2.14 |Update (custom) Compliance rules Update (custom) Compliance rules in the rules management service. A list of the available actions Lists rule standards Lists UAI assets relevant to the rule Supported rule severities Indicates a forbidden access response Service encountered an unexpected internal error 2.16.2.15 |Get Policies Gets all policy instances from a list of given policy types. Default behavior is all. Policy types to fetch Flag to bypass calling platform for asset groups data when fetching policies. Note that this means asset groups will not be updated when fetching policies. The response you get when calling the get policies V2 path One of the supported policy actions Lists supported evaluation stages Array of policy_rule objects related to the policy One of the supported policy severities Additional remediation guidance that can be added to the rule's predefined guidance. One of the supported policy types Service encountered an unexpected internal error 2.16.2.16 |Add Policies Adds policies and rule instances to the rules management service. One of the supported policy actions Lists supported evaluation stages Array of policy_rule objects related to the policy One of the supported policy severities One of the supported policy types Indicates a forbidden access response Service encountered an unexpected internal error 2.16.2.17 |Update Policies Update policies/rule instances in the rules management service. One of the supported policy actions Lists supported evaluation stages Array of policy_rule objects related to the policy One of the supported policy severities One of the supported policy types Indicates a forbidden access response Service had unexpected internal error 2.16.2.18 |Get a Policy by ID Get a policy instance by its ID. Flag to bypass calling platform for asset groups data when fetching policy. Note that this means asset groups will not be updated when fetching policy. The schema of a returned policy One of the supported policy actions Lists supported evaluation stages Array of policy_rule objects related to the policy One of the supported policy severities Additional remediation guidance that can be added to the rule's predefined guidance. One of the supported policy types Bad request error Policy not found Service encountered an unexpected internal error 2.16.2.19 |Get Policies. Get all policy instances of a given type. Default behavior is all. The policies type The response you get when calling the get policies path One of the supported policy actions Lists supported evaluation stages The UUIDs of the rules that define the condition One of the supported policy severities One of the supported policy types The error message Details for the PublicAPIError Reported error code Service encountered an unexpected internal error 2.16.2.20 |Add Policy. Add policy instances. The schema of a returned policy One of the supported policy actions Lists supported evaluation stages The UUIDs of the rules that define the condition One of the supported policy severities One of the supported policy types The error message Details for the PublicAPIError Reported error code Service encountered an unexpected internal error 2.16.2.21 |Delete a Policy by ID Delete a policy instance by its ID. Policy ID to delete If set, will trigger closing of issues opened by the deleted policy. The error message Details for the PublicAPIError Reported error code Policy ID not found Service had unexpected internal error 2.16.2.22 |Get a Policy by ID. Get a policy instance by its ID. The schema of a returned policy One of the supported policy actions Lists supported evaluation stages The UUIDs of the rules that define the condition One of the supported policy severities One of the supported policy types Policy ID not found The error message Details for the PublicAPIError Reported error code Service had unexpected internal error 2.16.2.23 |Update a Policy by ID. Update a policy instance by its ID Policy ID to delete The schema of a returned policy One of the supported policy actions Lists supported evaluation stages The UUIDs of the rules that define the condition One of the supported policy severities One of the supported policy types The error message Details for the PublicAPIError Reported error code Policy ID not found Service had unexpected internal error


## Cortex Gateway Documentation


---

## 1. Cortex Gateway

### 1.1. Activate a tenant

#### 1.1.1. Activate Cortex XDR tenant

##### Prerequisite

* Before you begin, make sure you have the following: Cortex XDR activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XDR tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support Portal...

#### 1.1.2. Activate Cortex XSIAM tenant

##### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

##### Note

* When you activate, a production tenant is first activated. After activation, you can set up a development tenant (subject to your license).

#### 1.1.3. Activate Cortex XSOAR tenant

##### Note

* When you activate, a production tenant is first activated. After activation, you can set up a development tenant (subject to your license).

* Activation can take about an hour and does not require that you remain on the activation page. Cortex XSOAR sends a notification to your email when the process is complete.

* If you want to change your tenant's name, the subdomain, or activate a development tenant (subject to license), on the right-hand side, click the ellipsis.

### 1.2. Users and roles in Cortex

#### Note

* All users must have at least one role or belong to at least one user group to be saved in the Cortex Gateway.

### 1.3. User management

#### Note

* If you have migrated local users from Cortex XSOAR 6 to Cortex XSOAR 8 and these users are in the Customer Support Portal, these users are designated the PANW IDP user type. For more information, see Migrating users and roles.

* If a user does not have a direct role or user group assigned, the user is revoked and is not saved in the Cortex Gateway.

* You must have an Account Admin role to manage users in Cortex Gateway.

* You must have an Account Admin or Instance Administrator role.

* Users without an assigned role or user group are not saved in the Cortex Gateway. However, there is an exception for users who did not have an assigned role or user group and who were hidden before the following product releases: Cortex XSIAM 2.7 (legacy) Cortex XSIAM 3.2 (platform) Cortex XSOAR 8.11 Cortex XDR 3.15 (legacy) Cortex XDR 4.2...

#### 1.3.1. Manage users in Cortex Gateway

##### Note

* To remove users added to your CSP account, you must do so in the CSP, not in Cortex Gateway.

* To update the permissions associated with each role, you need to change them in the tenant or the Roles tab in Cortex Gateway. If users have been created in the CSP, but you want them to access the tenant through SSO only, you should not assign a direct role. If you sign a direct role, users can access the tenant through both the CSP and SSO. If no...

* If you are updating multiple tenants at one time, you can only add predefined roles or roles created in Cortex Gateway (not custom roles created in the tenant).

* You cannot deactivate a user who has an Account Admin role or who is not assigned access to a tenant. If you want to deactivate an Account Admin user role, right-click the user and select Remove User Permissions. You can then deactivate the user.

* Users without an assigned role or user group are not saved in the Cortex Gateway. However, there is an exception for users who did not have an assigned role or user group and who were hidden before the following product releases: Cortex XSIAM 2.7 (legacy) Cortex XSIAM 3.2 (platform) Cortex XSOAR 8.11 Cortex XDR 3.15 (legacy) Cortex XDR 4.2...

### 1.4. Roles management

#### 1.4.1. Predefined roles in Cortex Gateway

##### Note

* The user who activated the Cortex product is assigned the Account Admin role. You can add the role to a user in Cortex Gateway or the tenant. If you need to remove the Account Admin role from a user, this can only be done in Cortex Gateway. Only users with the Account Admin role can add or remove another Account Admin user role.

* By default, users do not have roles assigned. If no direct or user group role has been assigned, users have no permission to view or edit data in the Cortex tenant.

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role.

* The user who activated the Cortex product is assigned the Account Admin role. You cannot create additional Account Admin roles in the Cortex XDR/XSIAM tenant. If you do not want the user to have Account Admin permission, you need to remove the Account Admin role in Cortex Gateway.

* The user who activated the Cortex product is assigned the Account Admin role. You cannot create additional Account Admin roles in the Cortex tenant. If you do not want the user to have Account Admin permission, you need to remove the Account Admin role in Cortex Gateway.

#### 1.4.2. Manage roles in Cortex Gateway

##### Note

* You must have an Account Admin role to manage tenants, users, roles, and user groups in Cortex Gateway.

* You must have an Account Admin role to create or edit a role. You cannot define advanced settings such as managing shifts or setting default dashboards in Cortex Gateway, as these are exclusive to the Cortex XSOAR tenant. We recommend copying and modifying out-of-the-box roles.

* In Cortex XDR/XSIAM, the Datasets tab is disabled in the Cortex Gateway as you can only set dataset access permissions in Cortex XDR/XSIAM Access Management. For more information in Cortex XSIAM, see Manage user roles. For more information in Cortex XDR, see Manage use roles.

### 1.5. User group management

#### Note

* You can create user groups in the tenant or Cortex Gateway. User groups created in Cortex Gateway cannot be mapped to SAML groups. Only user groups that are created in the tenant support SAML group mapping. We recommend creating user groups in the Cortex tenant because user groups are available for all tenants and you may want different user groups in...

* If users have been created in the CSP, but you want them to access the tenant through SSO only, skip this field and add only SAML group mapping after SSO is set up, otherwise, users can access the tenant through both the CSP and SSO. If you have not yet created any users, skip this field and add them later. See Set up authentication .

* When using Azure AD for SSO, the SAML group mapping needs to be provided using the group object ID (GUID) and not the group name.

### 1.6. Egress configurations

#### Important

* Only Account Admin and Instance Admin can submit a request on behalf of a user. Only users with these roles can view the Egress Configurations option in the Gateway. The Account Admin can view all the tenants from the account where requests have been submitted, and the Instance Admin can view all the requests that have been submitted for their tenant.


## Cortex CLI Documentation


---

## 1. Get started with Cortex Cloud

### 1.1. What is Cortex Cloud?

#### 1.1.1. Key features

### 1.2. What is Cortex Cloud Posture Management?

### 1.3. Agentic AI in Cortex Cloud

#### 1.3.1. Cortex Agentic Assistant

##### Note

* By default, you have access to the Cortex Assistant, which includes a natural language interface for entity investigation and provides a list of recommended responses such as running a playbook, performing a scan, or collecting support files. If you enable the Cortex Agentic Assistant, it replaces the Cortex Assistant interface entirely. For more...

##### Tip

* The system Help Center Agent provides fast access to documentation. You can ask natural language questions, such as "How do I create a dashboard?" or "Where can I review my data retention policies?" and the agent retrieves concise, relevant information from the official documentation site.

##### Navigation

  Settings → Configurations → General → Server Settings → Agentic Assistant

##### 1.3.1.1. Agentic Assistant use cases

##### 1.3.1.2. Agentic Assistant security

### 1.4. Use the interface

### 1.5. In-product support case creation

#### Note

* When opening a support case through the Customer Support Portal, you need to manually select Cortex Cloud as the product. While there may be discrepancies between the categories in this wizard and the Customer Support Portal process, that's because this wizard is designed specifically to focus on options relevant to Cortex Cloud.

* Console recordings cannot exceed 10 minutes. The current recording time is displayed at the top of the window.

### 1.6. Understand your user persona

### 1.7. Fair Usage policy for Cortex Cloud

### 1.8. Understand license plans

#### Note

* A Cloud Runtime license includes both Posture Scanning and Runtime Protection on the same asset. Usage, including any overflow, is tracked automatically to ensure accurate reporting across both licenses without duplicate counting.

#### 1.8.1. Data retention

##### Note

* Case data is retained according to the Last Updated date. Issue data is retained according to the Observation Time. Data collected within these dates is kept and displayed for 186 days. To ensure the accuracy of issues, Cortex Cloud provides a grace period of up to 31 days for issues displayed in the Issues View, Issues table, and Cases View.

* Requires the Forensics add-on.

## 2. Onboard and configure Cortex Cloud

### 2.1. Plan and prepare

### 2.2. Deployment steps and checklist

#### 2.2.1. Activate Cortex Cloud

##### Prerequisite

* The Cortex Cloud activation email. A Customer Support Portal (CSP) account. You need to set up your CSP account. For more information, see How to Create Your CSP User Account. When you create a CSP account, you can set up two-factor authentication (2FA) to log into the CSP by using an Email, Okta Verify, or Google Authenticator (non-FedRAMP accounts)....

##### Note

* Activation can take about an hour and does not require you to remain on the activation page. Cortex Cloud sends a notification to your email when the process is complete.

* You can only change the subdomain once, and it cannot be undone. After deleting the subdomain, you can reuse it after 7 days.

##### 2.2.1.1. Cortex Cloud supported regions

##### 2.2.1.2. Enable access to required PANW resources

###### Note

* <tenant-name> refers to the selected subdomain of your Cortex Cloud tenant, and <region> is the region in which your tenant is deployed. For more information, see Cortex Cloud supported regions.

###### Navigation

  SSL decryption: If you use SSL decryption and experience difficulty connecting the Cortex XDR agent to the server, we recommend that you add the FQDNs required for access to your SSL Decryption Exclusion list in Device → Certificate Management → SSL Decryption Exclusion

#### 2.2.2. Upgrade from Prisma Cloud to Cortex Cloud

##### 2.2.2.1. About the Upgrade Helper

###### Note

* Your Prisma Cloud tenant remains available and fully operational during the agreed upgrade period.

##### 2.2.2.2. Link Cortex Cloud to Prisma Cloud

###### Navigation

  Settings → Configurations → Upgrade Helper

##### 2.2.2.3. Copy content

###### Navigation

  Settings → Configurations → Upgrade Helper

###### 2.2.2.3.1. Copy Global configurations

####### Note

* Keep the following caveats in mind: Scope-Based Access Control (SBAC) configurations, such as resources or account lists are not copied. You can manually assign scope-based access to the relevant users or groups. When migrating permission groups and roles, the total count of items successfully copied may be lower than the initial number selected. This...

####### Navigation

  Settings → Configurations → Access Management

###### 2.2.2.3.2. Copy CSPM configurations

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

  Posture Management → Rules & Policies → Policies → Cloud Security

  Investigation & Response → Automation → Automation Rules

  Posture Management → Compliance → Standards

###### 2.2.2.3.3. Copy CWP configurations

####### Navigation

  Posture Management → Rules & Policies → Cloud Workload

###### 2.2.2.3.4. Copy Cortex Cloud Application Security configurations

####### Important

* If labels are imported into Cortex Cloud less than three hours after they were last added or modified in Prisma Cloud, they may not be included in the import.

##### 2.2.2.4. Migrate Cortex CLI

###### Prerequisite

* Before you begin, ensure you have the following: Cortex Cloud API key: An active API key for your Cortex Cloud tenant with associated CLI role permissions. Refer to Manage API keys for more information Install the Cortex CLI. You can find the installation instructions here

#### 2.2.3. Set up users and roles

##### Note

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* The user who activated the Cortex product is assigned the Account Admin role. You cannot create additional Account Admin roles in the Cortex Cloud tenant. If you do not want the user to have Account Admin permission, you must remove the Account Admin role in Cortex Gateway.

##### 2.2.3.1. User group management

###### Note

* You can create user groups in the tenant or Cortex Gateway. User groups created in Cortex Gateway cannot be mapped to SAML groups. Only user groups created in the tenant support SAML group mapping and scoring. We recommend creating user groups in the Cortex tenant because: User groups are available for all tenants, and you may want different user...

* If users have been created in the CSP, but you want them to access the tenant through SSO only, skip this field and add only SAML group mapping after SSO is set up, otherwise, users can access the tenant through both the CSP and SSO. If you have not yet created any users, skip this field and add them later. See Set up authentication .

* When using Azure AD for SSO, the SAML group mapping needs to be provided using the group object ID (GUID) and not the group name.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

##### 2.2.3.2. Assign user roles and groups

###### Note

* If an existing user in the Cortex Gateway no longer has a role or a user group assigned, the user is revoked. Any roles, user groups, or egress configurations created by that user are shown as created by Revoked user instead of the user's email address.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Setting Cortex Query Language (XQL) dataset access permissions for a user role can only be performed from Cortex Cloud Access Management. For more information, see Manage user roles.

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit Users Permissions.

#### 2.2.4. Manage API keys

##### Note

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

##### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

* You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

#### 2.2.5. Set up authentication

##### Tip

* You should have at least one user in the Customer Support Portal for backup, in case of any authentication issues with your IdP provider.

##### 2.2.5.1. Authenticate users through the Customer Support Portal

###### Note

* You must be assigned the Super User role in the Customer Support Portal to add users in the Customer Support Portal. The first Super User who logs into Cortex Gateway is automatically assigned the Account Admin role and has access to the tenant. The user who activates the Cortex Cloud tenant will also be assigned the Account Admin role (if there is no...

* After users are added to the Customer Support Portal and they accept the invitation, you can manage them in Cortex Gateway or the Cortex Cloud tenant.

##### 2.2.5.2. Authenticate users using SSO

###### Note

* To set up SSO authentication in the tenant, you must be assigned an Instance Administrator or Account Admin role. SAML 2.0 users must log in to Cortex Cloud using the FQDN (full URL) of the tenant. To allow login directly from the IdP to , you must set the relay state on the IdP to the FQDN of the tenant. If you have multiple tenants, you must set up...

* The first SSO cannot be deleted, it can only be deactivated by toggling SSO Enabled to off. The Domain parameter is predefined for the first SSO. If you add additional SSO providers, you must provide the email Domain in the SSO Integration settings for all providers except the first. Cortex Cloud uses this domain to determine to which identity provider...

* Cortex Cloud requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex Cloud. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a...

##### 2.2.5.3. Set up Okta as the Identity Provider Using SAML 2.0

###### Note

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

##### 2.2.5.4. Set up Azure AD as the Identity Provider Using SAML 2.0

###### Note

* The default attributes shown on the main single sign-on page in Azure AD are not the values you need. You must click Edit next to Attributes and Claims to view and copy the actual values.

* The attribute claim name must exactly match the value sent by your IdP. In some cases, this may be the full attribute name/namespace, depending on the configuration of our IdP

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Important

* When copying the Single Sign-On URL value, remove idp/saml and leave the trailing /. For example, if the Single Sign-On URL is https://clientname.panproduct.region.paloaltonetworks.com/idp/saml, just copy https://clientname.panproduct.region.paloaltonetworks.com/.

#### 2.2.6. Cloud service provider (CSP) onboarding

##### 2.2.6.1. Ingest cloud assets

###### Note

* The cloud accounts being onboarded must be owned by the customer performing the onboarding process.

##### 2.2.6.2. Onboard Amazon Web Services

###### Prerequisite

* Ensure you have access to AWS Management Console. Ensure you have the Required AWS permissions.

###### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* When onboarding an AWS organization or organizational unit (OU), Cortex Cloud creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

###### 2.2.6.2.1. Manually upload template to AWS

####### Prerequisite

* Before you begin, ensure you have: An AWS account Access to AWS Management Console Permission to create a stack and its resources in AWS CloudFormation

####### Note

* You must ensure that the KMS key region and the SNS topic region are the exact same as the AWS region where you are deploying the CloudFormation stack.

###### 2.2.6.2.2. Configure AWS integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

##### 2.2.6.3. Onboard Google Cloud Platform

###### Prerequisite

* Ensure you have cccess to Google Cloud Console. Ensure you have an admin user with the required admin GCP permissions. Ensure you have the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled)   If you plan on enabling Automation as...

###### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* If you want to connect to your GCP Workspace, you must first complete onboarding with the option disabled. Once the GCP cloud instance is created, perform the steps detailed in Connect Google Workspace with your GCP cloud instance.

###### 2.2.6.3.1. Manually upload template to GCP

####### Prerequisite

* Before you begin, ensure you have: A GCP account. Permission to create the required resources in Google Cloud Deployment Manager. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool. Reviewed the...

####### Note

* The directory you create must be a subdirectory of the home directory.

####### Important

* You must not delete or move the Terraform files from this folder. It will prevent you from being able to edit your cloud instance in the future.

###### 2.2.6.3.2. Connect Google Workspace with your GCP cloud instance

####### Prerequisite

* Ensure you have the Super Admin role in Google Workspace.

* Ensure you have the organization ID of the Google Workspace you want to connect:    Log in to your Google Admin Console. and navigate to Account → Account settings → Profile. Next to Customer ID is your organization ID. Ensure you have the organization ID of the Google Workspace you want to connect: Log in to your Google Admin Console. and navigate...

###### 2.2.6.3.3. Configure GCP integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

###### 2.2.6.3.4. Monitor GCP resources inside service perimeters

####### Note

* Each GCP cloud instance is assigned a scope within GCP. If the scope, whether it be organization, folder, or project, includes any projects with a service perimeter, this procedure must be performed for that cloud instance to authorize Cortex Cloud to scan the resources in the perimeter.

##### 2.2.6.4. Onboard Microsoft Azure

###### Prerequisite

* Ensure you have a Microsoft Azure subscription. Ensure you have the admin permissions required to onboard Microsoft Azure or the built-in Security Administrator role. Obtain the tenant ID and subscription ID. You can view these in the Microsoft Azure Portal in Management groups.

###### 2.2.6.4.1. Finalize Microsoft Azure onboarding by executing the authentication template

####### Prerequisite

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the relevant scope (subscription, management group, tenant). We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed Terraform on your local machine. You can...

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the relevant scope (subscription, management group, tenant). We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed the Azure CLI tool. Authorization to create...

####### Important

* Do not delete or move the Terraform files from this folder. It will prevent you from being able to edit your cloud instance in the future.

###### 2.2.6.4.2. Configure Azure integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

##### 2.2.6.5. Onboard Oracle Cloud Infrastructure

###### Prerequisite

* Ensure you have access to the Oracle Cloud Infrastructure console Permissions for all of the following are required:    Creation of identity groups (for more information, refer to Managing Groups)   Policies (for more information, refer to How Policies Work)   Tag namespaces in the root compartment (for more information, refer to Tags and Tag Namespace...

###### Note

* Excluded compartments are not visible in Cortex Cloud. Additional Security Capabilities: Enable additional Cortex Cloud security add-ons, if available. This may require additional cloud provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. The additional security capabilities you can enable include: Data security posture management: An agentless multi-cloud data security solution that discovers, classifies, protects, and governs sensitive data. Serverless functions scanning (Gen 1 only): Implement serverless scanning to detect and remediate vulnerabilities within serverless functions during the development lifecycle. Seamless integration into CI/CD pipelines enables automated security scans for a continuously secure pre-production environment. Registry scanning: Scan container registry images for vulnerabilities. malware, and secrets. You can configure your initial preference for scanning your registry. Any newly discovered registry, repository, or image in the account will be scanned by default. For more details, see Configure registry scanning for cloud accountsConfigure registry scanning for cloud accounts Agentless disk scanning: (Recommended) Implement agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Additional Security Capabilities: Enable additional Cortex Cloud security add-ons, if available. This may require additional cloud provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. The additional security capabilities you can enable include: Data security posture management: An agentless multi-cloud data security solution that discovers, classifies, protects, and governs sensitive data. Serverless functions scanning (Gen 1 only): Implement serverless scanning to detect and remediate vulnerabilities within serverless functions during the development lifecycle. Seamless integration into CI/CD pipelines enables automated security scans for a continuously secure pre-production environment. Registry scanning: Scan container registry images for vulnerabilities. malware, and secrets. You can configure your initial preference for scanning your registry. Any newly discovered registry, repository, or image in the account will be scanned by default. For more details, see Configure registry scanning for cloud accountsConfigure registry scanning for cloud accounts Agentless disk scanning: (Recommended) Implement agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Cloud Tags: Define tags and tag values to be added to any new resource created by Cortex Cloud in the cloud environment. Note: The managed_by = paloaltonetworks tag is automatically added to all resources. This tag is mandatory. You cannot edit or remove this tag. Log Collection Configuration: To maximize security coverage, enable the collection of audit logs. This may require additional cloud service provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Enter the following details for each preexisting OCI storage bucket that you intend to use for log collection: Region: The geographic OCI region where the bucket is located. For example, "us-phoenix-1". Bucket Name: The name of the OCI storage bucket. Compartment OCID: The Oracle Cloud Identifier (OCID) of the compartment that contains the bucket. Log Collection Configuration: To maximize security coverage, enable the collection of audit logs. This may require additional cloud service provider permissions. For detailed information on the permissions required, see Cloud service provider permissions. Enter the following details for each preexisting OCI storage bucket that you intend to use for log collection: Region: The geographic OCI region where the bucket is located. For example, "us-phoenix-1". Bucket Name: The name of the OCI storage bucket. Compartment OCID: The Oracle Cloud Identifier (OCID) of the compartment that contains the bucket. Download the OCI authentication template by clicking Download Terraform. The Terraform authentication template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The Terraform authentication template is valid for seven days from when it was created. Download the OCI authentication template by clicking Download Terraform. The Terraform authentication template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The Terraform authentication template is valid for seven days from when it was created. Cortex Cloud generates a Terraform authentication template based on the settings you configured in the OCI onboarding wizard. Next step: Apply the Terraform authentication template in OCI. 2.2.6.5.1 |Manually upload template to OCI PREREQUISITE: Before you begin, ensure you have: An Oracle Cloud Infrastructure account and the tenancy OCID. Permission to deploy a custom template and create its resources in OCI. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed...

###### 2.2.6.5.2. Configure the OCI connector for log collection

##### 2.2.6.6. Manually connect a cloud instance

##### 2.2.6.7. Edit your onboarded CSP configuration

###### Important

* When using Terraform authentication templates, you must execute the updated Terraform template from the same folder where the original Terraform template was executed.

##### 2.2.6.8. Outposts

###### Important

* Outpost scan is an alternative to the recommended standard cloud scan. Cloud scan is recommended because it is fully managed by Palo Alto Networks and incurs no compute costs for your organization. Outpost scan is an advanced deployment model reserved for specific data residency or architectural requirements.

###### 2.2.6.8.1. Outpost fundamentals and planning

####### Note

* Before you create your outpost, verify that your internet connection is active. An active internet connection is necessary for the notification to be sent to Cortex Cloud to create the new outpost.

####### Important

* While outposts provide maximum control over the scanning environment, cloud scan mode is the recommended default for most organizations.

####### Navigation

  Before onboarding your Cortex Cloud with the cloud service provider (CSP) onboarding wizard, create an outpost by navigating to Settings → Data Sources & Integrations → Outposts

  Settings → Data Sources & Integrations → Add New

  View and manage existing outposts by navigating to Settings → Data Sources & Integrations → Outposts

###### 2.2.6.8.2. Create an outpost

####### Prerequisite

* Before you begin, ensure you have: An AWS account Permission to create a stack and its resources in AWS Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the AWS CLI tool and configured your profile with the aws...

* Before you begin, ensure you have: A GCP account Permission to create the required resources in Google Cloud Deployment Manager Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool

* Before you begin, ensure you have: An active Azure subscription. Installed the Azure CLI tool. Permission to deploy a custom template and create its resources in Microsoft Azure ("Owner" or "Contributor" on the designated outpost subscription scope, and Active Directory "Cloud Application Administrator" or "Application Administrator" privileged...

####### Note

* Verify that your internet connection is active. An active internet connection is necessary for notifications to be sent to Cortex Cloud for creating the new outpost. If you are unable to establish an internet connection, contact customer support for a manual workaround.

* When creating an outpost for a specific Azure subscription, the outpost account must be in the same Azure organization as the monitored subscriptions.

####### Important

* While outposts provide maximum control over the scanning environment, cloud scan mode is the recommended default for most organizations. For details, see When to choose outpost scan.

####### Navigation

  Start the outpost creation wizard by navigating to Settings → Data Sources & Integrations → Outposts and clicking New Outpost

  A new outpost is created in pending status and can be viewed in the Outpost page at Settings → Data Sources & Integrations → Outposts

##### 2.2.6.9. Introduction to Terraform for Cloud service provider (CSP) onboarding

###### Important

* Always run these commands in the same folder where the original .tf files and .terraform folder live—this is where the state is stored.

* This .tfstate state file is critical because it is needed by the terraform destroy command to clean up created resources. It is critical that you never delete this file.

##### 2.2.6.10. Container Registry Scanning

###### 2.2.6.10.1. Overview of container registry scanning

####### 2.2.6.10.1.1. Registry Components

####### 2.2.6.10.1.2. How Container Registry Scanning Works

###### 2.2.6.10.2. Configure registry scanning for cloud accounts

####### Prerequisite

* Ensure that you have performed the all steps till Additional Security Capabilities as listed in the onboarding wizard for the required CSP: Onboard Amazon Web ServicesOnboard Amazon Web Services Onboard Google Cloud PlatformOnboard Google Cloud Platform Onboard Microsoft AzureOnboard Microsoft Azure Onboard Oracle Cloud InfrastructureOnboard Oracle...

###### 2.2.6.10.3. Modify the container registry scanning scope

###### 2.2.6.10.4. Scan re-evaluation process

###### 2.2.6.10.5. Connect Docker Hub registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.5.1. Manage a Docker Hub connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.6. Connect Docker V2 compliant container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.6.1. Manage a Docker V2 connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.7. Connect GitLab container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

####### Note

* When both the group ID and project ID are provided, the system retrieves container images from all projects within the specified group as well as from the specified project. If neither the group ID nor the project ID is provided, the system retrieves container images from all registries (across all groups and projects) accessible to the authenticated...

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.7.1. Manage a Gitlab Container Registry connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.8. Connect Harbor registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.8.1. Manage a Harbor connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.9. Connect JFrog container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.9.1. Manage a JFrog connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.10.10. Connect Sonatype Nexus registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

####### Note

* If you are using a CA certificate, enter the server IP address instead of the registry url.

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* If you are using a CA certificate, enter the server IP address instead of the registry URL.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.10.10.1. Manage a Sonatype connector

######## Note

* If you had selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

##### 2.2.6.11. Cloud service provider permissions

###### 2.2.6.11.1. Amazon Web Services provider permissions

###### 2.2.6.11.2. Google Cloud Platform provider permissions

###### 2.2.6.11.3. Microsoft Azure provider permissions

###### 2.2.6.11.4. Oracle Cloud Infrastructure provider permissions

#### 2.2.7. Onboard the Kubernetes Connector

##### Note

* This option is not supported for Fargate.

* For Fargate, you must provide the cluster resource identifier. The format of the identifier is arn:aws:eks:<region>:<account-id>:cluster/<cluster-name>.

* Basic authentication is only supported in Posture Management. If deploying Realtime Protection, select None .

##### 2.2.7.1. What's new in Kubernetes Connector?

##### 2.2.7.2. Supported Kubernetes distributions

###### Note

* In Google Container-Optimized OS release 100 and earlier, where the FANOTIFY EXEC flag is not supported, the Kernel configuration may be partial for the user mode agent to properly function. In such cases, the agent will fallback to asynchronous mode. In RHCOS version 4.12 and earlier, the Kernel configuration may be partial for the user mode agent to...

### 2.3. Post-deployment steps

#### 2.3.1. Set up your environment

##### 2.3.1.1. Configure server settings

###### Note

* Keyboard shortcuts, timezone, and timestamp format are not set universally and only apply to the user who sets them.

* The Cortex Agentic Assistant and AI case summarization are currently available for users in limited regions. For more information, see Cortex Agentic Assistant.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

###### Navigation

  Settings → Configurations → General → Server Settings

##### 2.3.1.2. Configure security settings

##### 2.3.1.3. Data and log forwarding

###### 2.3.1.3.1. Forward logs and data from Cortex Cloud to external services

####### 2.3.1.3.1.1. Configure external applications for forwarding

######## Note

* No prior configuration is required to send data or logs to an email distribution list. Only cases and issues can be forwarded to Slack, Amazon S3, Amazon SQS, Splunk, and Webhook. To forward data to Amazon SQS, the following permissions are required: sqs:GetQueueAttributes, sqs:ListQueues, sqs:SendMessage, sqs:SendMessageBatch, tag:GetResources, and...

* Only a user with Account Admin or Instance Admin permissions can configure egress. For more information, see Egress configurations.Egress configurations

* For Amazon SQS or Amazon S3, you need to provide the queue/bucket name. For Webhook or Splunk, you need to provide the domain, including any subdomain.

* You can also configure external applications when you create a new forwarding configuration. After defining the configuration and setting the scope, you can Add Application and follow the instructions below for any of these destinations.

* If egress has not been configured in the Cortex Gateway, verification will fail and a message will display that the endpoint does not match any approved routes.

####### 2.3.1.3.1.2. Configure notification forwarding

######## Prerequisite

* Before you can select an external service for notification forwarding, you must integrate the external service with Cortex Cloud. For more information, see Configure external applications for forwarding. No prior configuration is required to send data to an email distribution list.

######## Note

* Forwarding destinations: Only issues and cases can be forwarded to Slack, Splunk, Amazon SQS, Amazon S3, or Webhook. Notification forwarding by domain: To configure notification forwarding for issues by domain, select Issues and filter the Issues table by Issue Domain. Case IDs in notifications: If case matching completes before the notification is...

* Not all data and log types can be sent to all external services. For more information, see Forward logs and data from Cortex Cloud to external services.Forward logs and data from Cortex Cloud to external services

* The Grouping Timeframe defines the time frame, in minutes, of how often Cortex Cloud sends notifications. Every 20 issues or 20 events aggregated within this time frame are sent together in one notification, sorted according to severity. To send a notification when one issue or event is generated, set the time frame to 0.

####### 2.3.1.3.1.3. Monitor administrative activity

###### 2.3.1.3.2. Data and log notification formats

####### Note

* Issues can be forwarded to email, syslog servers, and Slack in the alert format, if you prefer. The alert format can be selected when you configure your forwarding notification.

####### 2.3.1.3.2.1. Management audit log messages

####### 2.3.1.3.2.2. Issue notification format

####### 2.3.1.3.2.3. Management Audit log notification format

####### 2.3.1.3.2.4. Log format for IOC and BIOC issues

####### 2.3.1.3.2.5. Analytics log format

#### 2.3.2. Cortex MCP server

##### 2.3.2.1. Cortex MCP server overview

###### Note

* This feature is in Beta.

* The Cortex MCP Server empowers you to integrate AI into your security workflows using natural language. When using LLM-based suggestions, always review and approve actions suggested by the AI before they're executed. We recommend deploying the Cortex MCP server in a secure environment where access is limited to authorized users.

###### 2.3.2.1.1. Install the Cortex MCP server

####### Prerequisite

* If you are running the Cortex MCP server in a Poetry virtual environment, you must have Python 3.13 or higher. If you plan to run the Cortex MCP server in a Docker container, you must have Docker installed.

####### Note

* The MCP Server uses public APIs to communicate and is limited by the license quotas available in your tenant. This is particularly relevant when running XQL queries. For more information on running XQL query APIs, see Run XQL query APIs.

* It is critical to avoid assigning excessive permissions when creating an API key for the Cortex MCP Server. Since the key has both read and write capabilities, overly broad permissions can lead to unintended actions and potentially compromise your environment. Ensure the key follows the principle of least privilege and is granted only the minimum...

* When using Docker, we recommend using an .env file to set the Cortex API credentials as environment variables. While the credentials can be provided in the MCP client configuration settings, the .env file provides safer handling of API credentials and makes your configuration easily reproducible.

* By default, stdio (standard input/output) is used. You can also configure Streamable HTTP, to send requests directly to the tenant instead of through the MCP client. Streamable HTTP can be useful for testing in the browser without a MCP client and to bypass limits that may be in place for your MCP client. For Docker, you can include the Streamable HTTP...

####### Important

* To configure the Cortex MCP Server, you need the Cortex API URL, Cortex API key, and Cortex API key ID. You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

###### 2.3.2.1.2. Configure the MCP client

####### Navigation

  Settings → Developer → Edit Config

###### 2.3.2.1.3. Use the Cortex MCP server

####### Note

* The built-in tools retrieve information, but do not write to the tenant. You can create your own tools that include write actions. The examples below include both.

###### 2.3.2.1.4. Create custom Cortex MCP server tools

####### Note

* Any new or updated components provided by Cortex are automatically downloaded into the remote_components folder.  During each update, the folder is fully replaced and all existing contents are recreated. Do not add custom tools to this directory, as it is managed entirely by Cortex and is overwritten at every update.

#### 2.3.3. Manage user roles and access management

##### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

##### Note

* For more information on assigning user roles when generating an API key, see Manage API keys.

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* For features where scoping is not applicable, Role-Based Access Control (RBAC) is used and can be configured when managing user roles. For more information, see Manage user roles.

##### 2.3.3.1. Manage user roles

###### Prerequisite

* Managing user roles in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Navigation

  Settings → Configurations → Access Management → Roles

##### 2.3.3.2. Manage user access

###### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Note

* You can only reduce the permissions of an Account Admin user via Cortex Gateway.

* User permissions for components and datasets are based on the access permissions set in the user role. For more information on editing these user role permissions, see Manage user roles.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit User Permissions.

###### Navigation

  Settings → Configurations → Access Management → Users

###### 2.3.3.2.1. User access reference information

##### 2.3.3.3. Manage user scope

###### Prerequisite

* Configuring user scopes in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles. By default, Enable Scope Based Access Control is...

###### Note

* This configuration can impact the visibility of the related Security domain in the Cases and Issues scope area, but with not affect asset visibility.

* XQL-based dashboard widgets may require a few hours to initially reflect changes to the list or definitions of asset groups used for scoping. To view the most current data immediately, refresh the dashboard or its XQL widgets.

* For Cases and Issues domains, a workaround is to create a Dataset View for each required combination of domains, and allow the relevant entity access only to this Dataset View, not to the underlying cases and issues datasets.

* Make sure to assign the required default granular scoping for users. This depends on the structure and divisions within your organization and the particular purpose of each organizational unit to which scoped users belong.

* Visibility of Security domain Issues that refer to assets with agents is controlled by the Endpoints scoping configuration.

###### Important

* Some areas and features in Cortex Cloud do not respect SBAC. In these cases, use RBAC permissions to restrict access.

* Action Required: Recent security enhancements enforce stricter default permissions for cases and issues that lack specific asset or endpoint references. This notice explains how to include access to these items if your users' visibility has been impacted.

* Before configuring, ensure that you review the Understand scoping section.

##### 2.3.3.4. Manage access to objects

###### 2.3.3.4.1. Manage access to custom dashboards

####### Prerequisite

* Configure tenant-level settings: An administrator must first establish the sharing framework under Settings → Configurations → Access Management → Objects. The configuration of these settings defines the authorized sharing workflows for custom dashboards:    Enable "Owners can Share objects they created": Grants owners the ability to share...

####### Note

* If you're designated as an Editor, you can always duplicate the widget and make your changes on the copy.

* Only Account Administrators and Instance Administrators have the authority to change the owner of an object.

###### 2.3.3.4.2. Manage access to saved queries

####### Prerequisite

* Configure tenant-level settings: An administrator must first establish the sharing framework under Settings → Configurations → Access Management → Objects. The configuration of these settings defines the authorized sharing workflows for saved queries in the Query Library, including the options that appear to users when clicking the three dot,...

####### Note

* If the role of a user is set to Edit Public Queries but not Create Queries, they can update existing public queries, but the Save as drop-down menu will be hidden, preventing them from creating new Query Library entries.

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

#### 2.3.4. Configure the Cortex Agentic Assistant

##### 2.3.4.1. Agentic Assistant components and concepts

###### Note

* Agents are bound by the same rules and robust permissions as a human user. In addition, you can mark actions that make real-world changes in production systems as sensitive, requiring a quick manual review and confirmation, ensuring peace of mind before critical system changes are made.

##### 2.3.4.2. Agents Hub

###### Note

* To manage agents in the Agents Hub, you must have the proper permissions. For more information, see Agentic Assistant role-based access control.

###### 2.3.4.2.1. Manage actions

####### Note

* To manage actions in the Agents Hub, you must have the correct permissions. For more information, see Agentic Assistant role-based access control.

###### 2.3.4.2.2. Register actions

####### Note

* To register actions, ensure you have the correct permissions. For more information, see Agentic Assistant role-based access control.

* Mandatory arguments cannot be deselected.

####### Important

* A single content item can be registered as different actions, with each action using different inputs and outputs from the same script. Only register the same script, command, or AI prompt as a new action if it is required for your use case, as providing an agent with many actions with overlapping abilities can reduce the ability of the agent to choose...

###### 2.3.4.2.3. Manage agents

####### Note

* In some cases, an agent may include actions with content items that are not relevant for all licenses. If that occurs, the grey circle appears, but you are not able to install the related content.

###### 2.3.4.2.4. Build agents

####### Note

* To build agents in the Agents Hub, you must have view/edit permissions. For more information, see Agentic Assistant role-based access control.

* If you clear the checkbox for a role, all actions associated with that role are also cleared. The exception is if another role is also selected, which is associated with the same actions. If you clear the checkbox for an action, all roles associated with that action are cleared. For example, if you select the Investigator role, and Send Mail and Tavily...

###### 2.3.4.2.5. Expand agent capabilities with MCP integrations

####### Note

* If you are using OAuth-based authentication, the Test button returns an error containing the command to run in the playground in order to test the connection.

* If an MCP tool is removed from the MCP server, the action will be unavailable due to missing content. If the tool is restored on the MCP server, the action is automatically reenabled.

####### Navigation

  Settings → Configurations → Data Collection → Integration Permissions

##### 2.3.4.3. Agentic Assistant role-based access control

#### 2.3.5. XQL query management

##### Prerequisite

* Setting query limits requires View/Edit permissions for Configurations → Query Management.

##### Note

* A scheduled query or report is run on behalf of the user that originally created it, even if it is edited and run by another user.

* Queries run by correlation rules are not restricted by the query limit. Very short queries do not count towards concurrent queries.

* To ensure optimal system performance, all queries (user-generated and otherwise) adhere to a default timeout limit of 60 minutes that is defined by Palo Alto that takes priority over the administrator defined value. Therefore, regardless of the value specified in this field, queries will be stopped after 60 minutes. You can override the default timeout...

* Query visibility is subject to Role-Based Access Control (RBAC); users can't see queries for datasets they do not have permission to access.

##### Navigation

  You can find Query Management options under Settings → Configurations → General → Query Management

#### 2.3.6. Customize cases and issues

##### 2.3.6.1. Customize cases and issues

###### 2.3.6.1.1. Set up case scoring

####### Note

* For scoped users, a small lock icon indicates that you don't have permissions to edit a rule.

####### Tip

* Right-click an issue field to add it as match criteria.

###### 2.3.6.1.2. Create a starring configuration

####### Tip

* Right-click an issue field to add it as match criteria.

###### 2.3.6.1.3. Create custom case statuses and resolution reasons

####### Note

* Before you create a custom status, please review the built-in options. For more information, see Resolution reasons for cases and issues. We recommend using the built-in statuses and resolution reasons where possible. Custom statuses and resolution reasons might not be supported by all content, and status syncing can take time. In addition, custom...

* After creation, custom statuses and resolution reasons cannot be deleted or modified.

####### Navigation

  Configurations → Object Setup → Cases → Properties

###### 2.3.6.1.4. Create a sync profile

####### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

#### 2.3.7. Dashboards and reports

## 3. Review inventory and explore your cloud environment

### 3.1. Inventory management

#### 3.1.1. Asset management

##### 3.1.1.1. All Assets

###### Note

* When working with the Asset Inventory page, consider the following: To maintain an accurate and clutter-free asset inventory, an automated cleanup process periodically removes outdated assets in the background.

* The options available are dependent on your license.

###### 3.1.1.1.1. Container Images

####### Navigation

  All Assets → Compute → Container Images

###### 3.1.1.1.2. Kubernetes Cluster

####### Note

* The Vulnerabilities tab is only available if the cluster you wish to analyze has a K8s connector.

####### Navigation

  Inventory → All Assets → Compute → Kubernetes Cluster for a Kubernetes Clusters assets overview

###### 3.1.1.1.3. External Surface assets

####### Note

* Cloud ASM data must be enabled before the External Surface asset inventory will populate. See Enable Cloud ASM.

##### 3.1.1.2. Serverless function assets

###### 3.1.1.2.1. Overview

####### Navigation

  To access serverless function assets, under Inventory, select All Assets → Compute → Serverless Functions

###### 3.1.1.2.2. Explore the serverless functions inventory

###### 3.1.1.2.3. Expanded serverless function asset information

####### Note

* For details of all serverless function issues generated by Cortex Cloud from vulnerability findings, refer to Serverless function usage.

##### 3.1.1.3. Network configuration

###### 3.1.1.3.1. Configure your network parameters

####### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

####### Navigation

  In Cortex Cloud , select Assets → Network Configuration → Internal Domain Suffixes

##### 3.1.1.4. Asset Groups

###### Note

* When you create or edit an Asset Group, the changes are applied immediately to new assets and to existing assets that have been updated. However, it may take a few hours for the changes to appear on existing assets that have not been updated.

###### Navigation

  Inventory → Assets → Groups → Add Group

##### 3.1.1.5. Vulnerability Assessment

###### Prerequisite

* The following are prerequisites for Cortex Cloud to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex Cloud lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex Cloud...

* The following are prerequisites for Cortex Cloud to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex Cloud collects all the information about the operating system and the installed...

###### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex Cloud Application Inventory.

###### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

###### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

## 4. Review and prioritize posture issues

### 4.1. Cases and issues

#### 4.1.1. Overview of cases

##### 4.1.1.1. What are cases?

##### 4.1.1.2. Resolving cases with AI

##### 4.1.1.3. Case lifecycle

##### 4.1.1.4. Case thresholds

##### 4.1.1.5. Case scope and impact

##### 4.1.1.6. Case and issue domains

#### 4.1.2. Case concepts

##### 4.1.2.1. Issues, findings, and events

###### 4.1.2.1.1. Issues

###### 4.1.2.1.2. Findings and events

##### 4.1.2.2. Case grouping

##### 4.1.2.3. Case scoring

##### 4.1.2.4. Case starring

###### Navigation

  You can manage all starring configurations under Case & Issues → Case Configuration → Starred Issues

##### 4.1.2.5. What is Causality?

###### Note

* There are no CGOs in the Cloud Causality View, when investigating cloud Cortex Cloud alerts and Cloud Audit Logs, or SaaS Causality View, when investigating SaaS-related alerts for 501 audit events, such as Office 365 audit logs and normalized logs.

#### 4.1.3. Analyze and resolve cases

##### 4.1.3.1. Review all cases

###### Note

* The legacy view is also available for users who prefer this format. From the Actions menu select Switch to legacy view.

##### 4.1.3.2. Start case analysis

###### 4.1.3.2.1. Agentic Assistant- Case Investigation agent

##### 4.1.3.3. Establish case context

###### 4.1.3.3.1. AI-generated case summaries

####### Note

* The AI-generated title and description is a calculated value that is regenerated each time you open a case. This value is not a saved static description, therefore it is not reflected in the saved case names in the list of cases in the Split view , or in the Case Name and Case Description columns in the Table view.

####### Navigation

  Configurations → General → Server Settings → AI Configuration and enable the following settings

###### 4.1.3.3.2. Assess case severity and score

###### 4.1.3.3.3. Update case attributes

####### Note

* The defined values are shown in the Case Name and Case Description columns in the Table view, and saved to the cases dataset. The case title is also shown the list of cases in the Split view. These values do not replace the AI-generated case title and summary. If the Summarize with AI toggle is enabled, AI-generated case summaries are automatically...

##### 4.1.3.4. Analyze case details

###### Note

* If you prefer a tabular or legacy layout, switch the case card to the Detailed view. This view preserves the legacy tab based format and custom layouts, ensuring full backward compatibility. You can switch between the new case experience and the legacy view based on personal workflow preferences. For more information, see Detailed View.

###### 4.1.3.4.1. Grouping graph

####### Note

* Similar issues are displayed as individual entities rather than in a parent/child hierarchy.

###### 4.1.3.4.2. Evidence

###### 4.1.3.4.3. Issue feed

###### 4.1.3.4.4. Associated assets and artifacts

####### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

###### 4.1.3.4.5. MITRE ATT&CK tactics and techniques

####### Note

* This component is available for cases associated with the Security domain or custom domains.

###### 4.1.3.4.6. Detailed View

####### Note

* When an issue is resolved, it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

###### 4.1.3.4.7. Issue card

####### Note

* This section is context-specific and shows data according to the issue context.

##### 4.1.3.5. Resolve the case

###### 4.1.3.5.1. Resolution Center

####### Note

* Tasks that are already In Progress but still require your input will appear in both the Pending and In Progress tabs.

###### 4.1.3.5.2. Collaborative notes and comments

###### 4.1.3.5.3. Resolve a case

####### Note

* If a case is resolved with the status Resolved - Auto Resolved, Cortex Cloud can reopen the case for up-to six hours if a new issue is triggered that matches the case. The six-hour period is defined by the timestamp of the last issue that was grouped into the case. After the six-hour period, any new issues are linked to a new case for a new...

###### 4.1.3.5.4. Resolution reasons for cases and issues

####### Note

* Cases and issues resolved as True Positive and False Positive help Cortex Cloud to identify real threats in your environment by comparing future cases and associated issues to the resolved cases. Therefore, the handling and scoring of future cases is affected by these resolutions.

##### 4.1.3.6. Additional case actions

###### 4.1.3.6.1. Create a case

####### Note

* To create a case manually, you must have View/Edit permission for Cases and Issues selected under Settings → Configurations → Access Management → Roles → Components → Cases & Issues.

* This option is only relevant for certain domains.

* You can't attach files to manually created cases.

####### Tip

* The issues that you link to a case can be linked to multiple cases, and the issue domains do not need to match the case domain.

###### 4.1.3.6.2. Merge a case

### 4.2. Investigation and response

#### 4.2.1. Investigate issues

##### 4.2.1.1. Overview of the Issues page

###### Note

* Every 12 hours, the system enforces a cleanup policy to remove the oldest issues once the maximum limit is exceeded. The default issue retention period in Cortex Cloud is 186 days.

##### 4.2.1.2. Link or unlink issues from a case

##### 4.2.1.3. Run an automation on an issue

###### Note

* In addition to automation, some playbooks contain manual tasks that prompt the analyst for input. This enables you to enhance an automation workflow with analyst input.

* You can also manually select a playbook to run from the Issue Work Plan tab.

##### 4.2.1.4. Use the War Room in an investigation

###### Note

* The case War Room is usually used for communication capabilities, but unlike the issue War Room, it does not include playbook specific entries. The case War Room enables you to investigate an entire case, not just an issue.

* Cortex Cloud does not index notes and chats.

###### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

* You can use the up/down arrow buttons in the CLI to do a reverse history search for previous commands with the same prefix.

###### Navigation

  Investigation & Response → Automation → Playground

##### 4.2.1.5. Use the Work Plan in an investigation

###### Important

* A playbook will not continue its execution path if a prior task has failed; you must resolve the failed task before subsequent tasks can run.

##### 4.2.1.6. Issue syncing

###### Prerequisite

* You must set up an integration before you can sync issues. For more information, see Set up an integration for mirroring issues.

###### Note

* Multiple tickets can be linked to an issue with outbound syncing. Issues with inbound syncing can be linked to a single ticket only.

* Using issue fields as variables is not currently supported.

* You can only define a single inbound profile. If you change the inbound sync profile the current profile is overwritten. You can define multiple outbound profiles; one issue can update multiple tickets.

* The inbound syncing flow runs every two minutes, and the outbound syncing flow runs every five minutes. In a bi-directional set-up, if the same field is updated in both tickets, the most recently updated value is used. In the external ticket, the logged history shows updates to the ticket. The user name that is logged with the history reflects the user...

* After an issue is resolved, ticket syncing remains active for up-to seven days. Therefore, you still update, change, or reopen the issue or external ticket and the tickets will continue to sync.

* If you change the selected inbound sync profile, the original sync profile is immediately overwritten.

###### Warning

* If you leave this field blank, all configured instances will be used.

###### Tip

* You can find a sync profile ID under Settings → Configurations → Object Setup → Issues → Sync Profiles. By default the ID field is not displayed in the table. Click the three dot menu and add it to the table layout.

###### Navigation

  Settings → Configurations → Marketplace

##### 4.2.1.7. Issue investigation actions

###### 4.2.1.7.1. Copy issues

###### 4.2.1.7.2. Update issue fields

####### Note

* You must create a custom status before you can select it.

####### Tip

* You can create custom issue statuses and resolution reasons, and use the setIssueStatus command to set these custom statuses for issues. For example, when a user starts investigating an issue, the issue status is automatically changed from New to Under Investigation. In some cases, it is useful to create an interim status, such as Triage. After you...

###### 4.2.1.7.3. Export issue details to a file

###### 4.2.1.7.4. Exclude an issue

###### 4.2.1.7.5. Query case and issue data

####### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

#### 4.2.2. Review findings

##### 4.2.2.1. Findings card

###### Note

* The information in this card is context specific, therefore some sections are not available for all findings.

#### 4.2.3. Investigate artifacts and assets

##### 4.2.3.1. Investigate an IP address

###### Note

* Requires a license key. Select Settings → Configurations → Integrations  → Threat Intelligence.

##### 4.2.3.2. Investigate an asset

###### Note

* The Asset view is available for hosts with a Cortex XDR agent installed.

##### 4.2.3.3. Investigate a file and process hash

###### Note

* Requires a license key. Go to Settings → Configurations → Integrations  → Threat Intelligence.

##### 4.2.3.4. Investigate a user

###### Note

* Cortex Cloud normalizes and displays case and issue times in your time zone. If you're in a half-hour time zone, the activity in the Issues & Insights Heatmap is displayed in the whole-hour time slot preceding it. For example, if you're in a UTC +4.5 time zone, the time displayed for the activity will be UTC +4.5, however, the visualization in the...

###### Tip

* You can also see a list of all users under Inventory → Assets → Asset Scores.

#### 4.2.4. Cortex Assistant

##### Note

* If you are in an eligible region and have enabled the Cortex Agentic Assistant, the Cortex Agentic Assistant replaces the Cortex Assistant. The Cortex Assistant is available if you do not have access to the Cortex Agentic Assistant based on the tenant region or you have not enabled it. For more information, see Cortex Agentic Assistant.

##### Navigation

  To increase usability, you can create a personalized keyboard shortcut: Settings → Configurations → Server Settings → Keyboard Shortcuts and choose the shortcut you want to use

##### 4.2.4.1. Cortex Assistant layout

##### 4.2.4.2. Cortex Assistant capabilities

###### Note

* When you choose an option from the Respond column, Cortex Assistant will always prompt you to approve the action before executing.

#### 4.2.5. Automation

##### 4.2.5.1. Automation in Cortex Cloud

###### Note

* You can build end-to-end automation workflows from within the playbook editor, including creating automation rules, configuring integration instances, and creating and editing tasks. For more information, see Playbooks.

##### 4.2.5.2. Quick Actions

###### Note

* Quick Actions appear as War Room entries, but do not appear in the Work Plan.

##### 4.2.5.3. Automation Exclusion Center

###### Note

* By default, all users have read and edit permissions to lists. When creating a list of critical assets, we recommend limiting the read and edit permissions to specific roles.

###### 4.2.5.3.1. Manage automation exclusion policies

####### Note

* For the IAM User Hard Remediation and User Soft Remediation policies, we recommend including username, email, and ID for each user you want to exclude. Example: username1, user@example.com, userID112.

* You can also right click on a policy from the main Automation Exclusion Center page to disable or enable the policy. If you click on a list name in the Exclude column, that list opens in the Lists page.

##### 4.2.5.4. Playbooks

###### Prerequisite

* To provide playbook access, ensure the Playbooks RBAC permission is set to View or View/Edit. To completely restrict playbook access, first set the Cases & Issues RBAC permission to None and then set the Playbooks permission to None. Conversely, to provide access to cases and issues, first set the Playbooks permission to View or View/Edit (and then set...

###### 4.2.5.4.1. Playbooks overview

###### 4.2.5.4.2. Playbook development checklist

###### 4.2.5.4.3. Plan your playbook

###### 4.2.5.4.4. Manage playbooks

####### Note

* The library by default shows only playbooks that are not adopted. Click the Show Adopted checkbox to show the adopted playbooks, indicated by an Adopted mark. The library shows the most updated playbook version. Adopting an older version than shown should be done through Marketplace. Adopting a playbook does not make it run. Some content packs include...

###### 4.2.5.4.5. Build your playbook

####### 4.2.5.4.5.1. Task 1. Choose from existing playbooks or create your own

######## Note

* When a task inside of a sub-playbook is not configured, the alert is propagated to the main playbook. If multiple sub-playbooks are nested, and any of the sub-playbooks have non-configured components, the alert appears in the main playbook as well as in the sub-playbooks. Alerts also appear for the individual non-configured tasks within the...

######## Tip

* If there are additional relevant playbooks in Marketplace that are not in your Org repository, you can click Explore them now to see them in the Playbook Catalog and choose to adopt.

* To open multiple playbooks at the same time, edit the first playbook and then click New next to the playbook name to create a new tab. You can either create a new playbook, or add an existing one. You can view recently modified or deleted playbooks by clicking version history for all playbooks .

######## Navigation

  the Investigation & Response → Automation → Playbooks page to find an existing playbook, customize it, or create a playbook

####### 4.2.5.4.5.2. Task 2. Configure playbook settings

######## Note

* If the playbook has inputs and outputs, the Playbook Starts task will show back and forth arrows. Clicking them opens the Playbook Settings pane Inputs/Outputs tab.

* This rule will trigger the playbook to run if no other Automation Rule triggers the playbook first. You can view and edit the order the rules run in the Automation Rules page.

* If you do not add any fields, the group will be deleted when you click Save.

####### 4.2.5.4.5.3. Task 3. Add objects from the Task Library

####### 4.2.5.4.5.4. Task 4. Add custom playbook features

####### 4.2.5.4.5.5. Task 5. Test and debug the playbook

####### 4.2.5.4.5.6. Task 6. Manage playbook content

###### 4.2.5.4.6. Customize your playbook

####### 4.2.5.4.6.1. Configure a sub-playbook loop

######## Note

* Consider the following when adding a loop: The maximum number of loops (default is 100). A high number of loops or a high wait time combined with a large number of issues may affect performance. Periodically check looping conditions to ensure they are still valid for the data set. If you want a sub playbook task to loop over an array passed into its...

######## Tip

* Balance between the number of iterations and the interval so you do not overload the server.

####### 4.2.5.4.6.2. Filter and transform data

######## Caution

* You can change the context data root to filter, but it is not recommended to select a different root, as it affects the filter results. The drop-down list displays the filter root for backward compatibility.

######## Navigation

  Investigation & Response → Automation → Scripts → New Script

####### 4.2.5.4.6.3. Extend context

####### 4.2.5.4.6.4. Extract indicators

######## Note

* This configuration may delay playbook execution (issue creation). While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

####### 4.2.5.4.6.5. Update issue fields with playbook tasks

######## Note

* The setIssue script includes all available fields; use the scroll bar to see all the fields. The name field has a limit of 600 characters. If there are more than 600 characters, you can shorten the name field to under 600 characters and then include the full information in a long text field such as the description field.

###### 4.2.5.4.7. Test your playbook

####### Note

* The debugger does not support using parentIncidentFields.

* Using an existing issue in the debugger does not affect the original issue or change the original context data.

####### 4.2.5.4.7.1. Troubleshoot playbook performance

###### 4.2.5.4.8. Manage playbook content

####### Note

* Opening a playbook does not immediately lock it. A playbook is considered to be in edit mode only when a user makes a modification that causes the Save button to become available.

####### Important

* Manually unlocking a playbook may cause version conflicts. This turns off concurrent editing protection, and if the original user is still editing, their changes might be lost or overwritten.

####### Navigation

  Investigation & Response → Automations → Playbooks

###### 4.2.5.4.9. Best practices

####### Note

* If you reattach a detached playbook, any customizations you have made to the playbook will be overwritten when the playbook updates to the current version.

* Retries are not supported for data collection tasks that have errors sending emails (indicated by a server timeout). This is because retries only work on automation execution failures, not on email delivery issues.

##### 4.2.5.5. AI Prompts

###### Navigation

  On the AI Prompts page (Investigation → Response → Automation → AI Prompts), you can view, edit, and manually create prompts

###### 4.2.5.5.1. AI prompts role-based access control

###### 4.2.5.5.2. Use existing prompts

####### Navigation

  Investigation & Response → Automation → AI Prompts and in the Prompts Library search for the prompt you want to use

###### 4.2.5.5.3. Create a prompt

####### Navigation

  Investigation & Response → Automation → AI Prompts and click + New Prompt

##### 4.2.5.6. Create an automation rule

###### Note

* You can also define the conditions that trigger a specific playbook in the playbook editor. For more information, see Task 2. Configure playbook settings

* Quick Actions, by default, run using all available integration instances that contain the command. When selecting a Quick Action for an automation rule, you can instead choose one specific integration instance to use.

###### Important

* Automation rules apply to Medium and higher severity issues. They also apply to Low severity Analytic issues and Low severity ABIOC issues that are tagged with Identity or Cloud. Rules are evaluated in order, and only the first rule that matches the trigger conditions is executed.

##### 4.2.5.7. Scripts

###### 4.2.5.7.1. Use existing scripts

####### Navigation

  Investigation & Response → Automation → Scripts and in the Scripts Library search for the script you want to use

###### 4.2.5.7.2. Create a script

####### Note

* You can enable/disable a script in the Settings without having to duplicate the script. You can view recently modified or deleted scripts by clicking the version history for all scripts .

####### Important

* If you choose Python, from the Agentic Assistant you can use the Automation Engineer agent.

####### Tip

* If there is an error, you can copy the error message from the test result into the Agentic Assistant prompt and ask the Automation Engineer agent to correct the error.

###### 4.2.5.7.3. Use the Automation Engineer agent to accelerate script development and deployment

####### Note

* The Automation Engineer agent is available with the Cortex Agentic Assistant, for users with script editing permissions. For more information, see Cortex Agentic Assistant and Agentic Assistant role-based access control.

* If you make manual edits in the script and don't save the changes and you then modify the script with the Automation Engineer agent, you are prompted to confirm overwriting the manual edits.

####### Tip

* Use detailed prompts, for example, Get failed logins from last 24 hours and return as a table. Clearly define argument names, types, and default values. Mention if you expect the output in a specific format, such as a table, JSON, or plain text.

* If there is an error, you can copy the error message from the test result into the Agentic Assistant prompt and ask the Automation Engineer agent to correct the error.

###### 4.2.5.7.4. Change the Docker image in a script

####### 4.2.5.7.4.1. Connect an engine to an image registry

######## Note

* This procedure uses the --username and --password command line options to pass the username and password directly. For environments where command history or logs are visible to others, consider more secure methods like Docker configuration files for handling authentication in production or CI/CD environments. For more details, see docker login or...

##### 4.2.5.8. Context data

###### 4.2.5.8.1. Issue context data

###### 4.2.5.8.2. Case context data

###### 4.2.5.8.3. Search context data

###### 4.2.5.8.4. Add context data to an issue

###### 4.2.5.8.5. Add context data to a case

####### Note

* If you run the command in the issue War Room, the data is added to the following places: The case context data. The issue context data under the case tab. If you run the command in the Case War Room, the data is added to the case context data only.

###### 4.2.5.8.6. Delete context data from a case

###### 4.2.5.8.7. Use context data in a playbook

####### Caution

* Users with Trigger Playbook permissions on a given issue may still be able to modify the parent case via commands and scripts, even without full access to the case.

##### 4.2.5.9. Lists

###### Note

* The maximum size of a list is 209715 characters.

###### 4.2.5.9.1. Create a list

####### Note

* If you intend to use the list as part of an Automation Exclusion Policy, we recommend choosing specific roles for read and edit access. For more information on using lists in exclusion policies, see Manage automation exclusion policies.Manage automation exclusion policies

* If you want to edit a list from a content pack, you need to duplicate or detach a list. Detached lists do not receive updated content in subsequent Cortex Cloud content releases. To retain an updated list, reattach it.

###### 4.2.5.9.2. List commands

###### 4.2.5.9.3. Use cases: JSON lists

####### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

  Investigation & Response → Automation → Playbooks → New Playbook

###### 4.2.5.9.4. Transform a list into an array

####### Navigation

  Investigation & Response → Automation → Playbooks and create or edit a playbook

##### 4.2.5.10. Integrations

###### 4.2.5.10.1. Integrations in Cortex Cloud

###### 4.2.5.10.2. Add an integration instance

###### 4.2.5.10.3. Use integration commands in the CLI

####### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

###### 4.2.5.10.4. Troubleshoot Integrations

###### 4.2.5.10.5. Manage credentials

####### Navigation

  Settings → Configurations → Integrations → Credentials → New Credential

##### 4.2.5.11. Engines

###### 4.2.5.11.1. What is an engine?

####### Note

* You cannot share a multiple-engine installation with a single-engine installation.

* When you add an engine to a load-balancing group, you cannot use that engine separately. The engine does not appear in the engines menu when configuring an integration instance, but you can choose the load-balancing group.

###### 4.2.5.11.2. Engine requirements

####### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

* If you have configured a range of Approved IP Ranges under Allowed Sessions on the Security Settings page, the engine must communicate through one of the approved IPs.

###### 4.2.5.11.3. Install an engine

####### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex Cloud engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

####### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

####### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

####### 4.2.5.11.3.1. Docker

######## Note

* This section is relevant when installing an engine.

* Docker images can be downloaded together with their relevant content packs for offline installation.

####### 4.2.5.11.3.2. Podman

######## Note

* When upgrading an engine, the engine keeps the previously used container management type (regardless of distribution version).

###### 4.2.5.11.4. Manage engines

###### 4.2.5.11.5. Upgrade an engine

###### 4.2.5.11.6. Remove an engine

###### 4.2.5.11.7. Configure engines

####### Note

* A day is defined as 24 hours and may not exactly correspond to calendar days due to daylight savings, leap seconds, etc.

* In addition, to support engine upgrades from the UI, edit the /usr/local/demisto/upgrade.conf file on the engine to include the SERVER_URLS setting with the new tenant's address. Include only the host, without https:// or any additional path at the end of the host name. For example: SERVER_URLS="api-example.us.paloaltonetworks.com"

* If the engine loses communication for longer than this time, it will disconnect and you need to restart the service.

####### 4.2.5.11.7.1. Configure the engine to use a web proxy

######## Note

* You need to configure Docker to use a proxy. When using a BlueCoat proxy, ensure you encode the values correctly.

* In an environment with a single engine, go to /usr/local/demisto/upgrade.conf. In an environment with multiple engines, go to /usr/local/demisto/<engine-name>/upgrade.conf, replacing <engine-name> with the name of the engine. Note that the key is in the upgrade.conf file and must be https_proxy, even if your proxy address starts with http://.

####### 4.2.5.11.7.2. Configure the engine to call the server without using a proxy

####### 4.2.5.11.7.3. Configure an engine to use custom certificates

###### 4.2.5.11.8. Use an engine in an integration

####### Note

* Long-running integrations should not run on load-balancing groups.

###### 4.2.5.11.9. Run a script using an engine

####### Navigation

  Investigation & Response → Automation → Scripts

###### 4.2.5.11.10. Troubleshoot engines

####### Note

* Ensure that pop-ups are not blocked by your browser.

* If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom path. --keep - Extracts the installer files into the current working directory (without cleaning at the end). If using installer...

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl status d1_<Engine _name>

* Any changes made to variables in the upgrade_engine.sh file are reset after each upgrade. We recommend instead using the upgrade.conf file to set variables.

* You can ignore the following error: Cannot create folder '/var/lib/demisto'

###### 4.2.5.11.11. Troubleshoot integrations running on engines

####### Note

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

* Docker CE installations typically run Docker, while Docker EE installations typically run dockerroot.

#### 4.2.6. Build XQL queries

##### Note

* If you have the Cortex Agentic Assistant, you can use natural language prompts to create and run XQL queries within the chat interface. For more information, see Create and run XQL queries with Agentic Assistant chat.

##### 4.2.6.1. About the Query Builder

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

##### 4.2.6.2. How to build XQL queries

###### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex Cloud. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

###### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

###### 4.2.6.2.1. Get started with XQL queries

###### 4.2.6.2.2. Useful XQL user interface features

####### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

###### 4.2.6.2.3. XQL Query best practices

###### 4.2.6.2.4. Expected results when querying fields

###### 4.2.6.2.5. Create XQL query

####### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined for the entire query, including queries that are part of the join stage. Yet, this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker...

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

###### 4.2.6.2.6. Review XQL query results

####### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* Results are received incrementally for the first 100K records, or up to 100MB worth of records, whichever comes first. After that, the next update is when the query has finished running completely.

* Real time query results are available only in the Query Builder and in free text query. Real time results are displayed only for queries run on hot datasets. The Sort option is available only after all the data is retrieved. When you formulate complex queries, the results will be displayed when the query has finished running completely, and not in real...

* In order for Cortex Cloud to provide a histogram for a field, the field must not contain an array or a JSON object.

###### 4.2.6.2.7. Translate to XQL

####### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

###### 4.2.6.2.8. Graph query results

####### License Type

  Building Cortex Query Language (XQL) queries in the Query Builder requires a Data Collection add-on.

####### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### 4.2.6.3. XQL query entities

###### 4.2.6.3.1. Create authentication query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.2. Create event log query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.3. Create file query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.4. Create image load query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.5. Create network connections query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.6. Create network query

####### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

###### 4.2.6.3.7. Create process query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.8. Create registry query

####### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

###### 4.2.6.3.9. Query across all entities

####### Navigation

  Investigation & Response → Search → Query Builder

##### 4.2.6.4. Overview of the Query Center

###### Note

* Very short queries might not be listed. You cannot cancel correlation queries. The default retention period for historic queries is aligned with issue retention.

###### 4.2.6.4.1. Edit and run queries in Query Center

####### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

####### Navigation

  Investigation & Response → Search → Query Center → Query History

####### 4.2.6.4.1.1. Query Center reference information

######## Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 4.2.6.5. Manage scheduled queries

###### Navigation

  Investigation & Response → Search → Scheduled Queries

###### 4.2.6.5.1. Scheduled Queries reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 4.2.6.6. Manage your query library

###### Note

* The Query to Library option is only available if your role has the Create Queries capability. For more information, see Manage access to saved queries.

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

###### Important

* The ability to create, edit, or share queries is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to saved queries.

#### 4.2.7. Quick Launcher

##### Note

* For hosts, Cortex Cloud displays results for exact matches but supports the use of wildcard (*) which changes the search to return matches that contain the specified text. For example, a search of compy-7* will return any hosts beginning with compy-7 such as compy-7000, compy-7abc, and so forth.

### 4.3. Customize cases and issues

#### 4.3.1. Customize cases and issues

##### 4.3.1.1. Set up case scoring

###### Note

* For scoped users, a small lock icon indicates that you don't have permissions to edit a rule.

###### Tip

* Right-click an issue field to add it as match criteria.

##### 4.3.1.2. Create a starring configuration

###### Tip

* Right-click an issue field to add it as match criteria.

##### 4.3.1.3. Create custom case statuses and resolution reasons

###### Note

* Before you create a custom status, please review the built-in options. For more information, see Resolution reasons for cases and issues. We recommend using the built-in statuses and resolution reasons where possible. Custom statuses and resolution reasons might not be supported by all content, and status syncing can take time. In addition, custom...

* After creation, custom statuses and resolution reasons cannot be deleted or modified.

###### Navigation

  Configurations → Object Setup → Cases → Properties

##### 4.3.1.4. Create a sync profile

###### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

## 5. Agentic Assistant chat

### 5.1. Get started with Agentic Assistant chat

#### Note

* The Cortex Agentic Assistant is currently available in limited regions. For more information see Cortex Agentic Assistant If your tenant is not within one of those regions, you have access to the Cortex Assistant. To enable the Cortex Agentic Assistant, go to Settings → Configurations → General → Server Settings → AI Configuration.

### 5.2. Choose an Agentic Assistant agent

#### Note

* Requires the Exposure Management add-on.

### 5.3. Chat with an Agentic Assistant agent

#### Note

* Case data is only loaded when you send your first message. Opening the chat interface without sending a prompt does not provide the agent with the case context.

* An agent's proposed plans and results may contain inaccuracies or errors. Always review the results carefully to ensure you fully understand the proposed action before proceeding.

#### Tip

* You can quickly jump to different product pages within Cortex Cloud by typing / in the prompt area. This shortcut is a built-in navigation feature that is available even if the Cortex Agentic Assistant is disabled.

### 5.4. Create and run XQL queries with Agentic Assistant chat

#### Note

* The TextToXQL action is a hidden system action and does not appear in the Agents Hub.

* If you are in a non-supported region and ask an agent to create an XQL query, it may attempt to generate the query using general logic. We do not recommend this, as it may result in inaccurate syntax and unreliable results.

* Running XQL queries manually through agent does not consume compute units. This includes scenarios where you prompt the agent to create and execute a multi-step plan.

### 5.5. Manage chat history

## 6. Review and report your security posture and progress

### 6.1. Monitor dashboards and reports

#### 6.1.1. About dashboards

##### Note

* Dashboards that are based on custom infrastructure cannot be exported. When importing a dashboard that already exists in the system, the imported dashboard overwrites the existing dashboard. To avoid overwriting the existing dashboard, duplicate and rename the existing dashboard before importing the new dashboard.

##### Important

* The ability to create, edit, or share custom dashboards is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to custom dashboards.

##### 6.1.1.1. Command Center dashboards

###### Note

* Access to these dashboards requires RBAC permissions under Dashboards & Reports. The Dashboards component must be Enabled in your role and requires View permissions for Command Center Dashboards. If certain options are unavailable, contact your administrator. For more information, Manage access to custom dashboards. The dashboards are available in dark...

###### 6.1.1.1.1. Cortex Agentic Assistant dashboard

####### Prerequisite

* The Cortex Agentic Assistant is only available after it is enabled, and for tenants in certain regions. For more information, see Cortex Agentic Assistant.

####### Note

* Access to this dashboard requires RBAC permissions under Dashboards & Reports. The Dashboards component must be Enabled in your role and requires View permissions for Command Center Dashboards. If certain options are unavailable, contact your administrator. For more information, see Manage access to custom dashboards.

###### 6.1.1.1.2. Cloud Security Operations

####### 6.1.1.1.2.1. Cloud Security Operations

######## Note

* Command Center data may not match the counts on the Issues page, and you may observe inconsistencies. This is because dashboard data is a snapshot of issues identified, whereas the Issues page provides the most up-to-date view of risks across your cloud assets. In addition, the Issues pages do not support all the currently available filters on the...

###### 6.1.1.1.3. Cortex Cloud Command Center

##### 6.1.1.2. Predefined dashboards

###### Note

* Users can access all information on the dashboard when their user access is scoped to view All assets or assigned to the Instance Administrator role. Otherwise, users with granular scoping set to No assets or Select asset groups will have limited access to the dashboard. For more information on Scope-Based Access Control (SBAC), see Manage user...

##### 6.1.1.3. Reports

###### 6.1.1.3.1. Report templates

#### 6.1.2. Build custom dashboards and reports

##### 6.1.2.1. Build a custom dashboard

###### Note

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For case-related widgets, you can refine the displayed data to only show results from cases that match a...

##### 6.1.2.2. Manage your Widget Library

###### Note

* Unlike dashboards, individual widgets cannot be shared with other users directly from the Widget Library. Yet, if you add a Restricted widget to a dashboard and then share that dashboard, other users who have access to the dashboard will also be able to see that specific widget.

* Any dashboards or reports that include the widget are affected by the changes.

#### 6.1.3. Fine-tune dashboards and reports

##### 6.1.3.1. Create a custom widget using a script

###### Note

* If you have added arguments to the script, these appear when creating a widget.

* Available options are Pie, Column, Line, and Single Value. To display the result of the script as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### 6.1.3.1.1. Script-based widget examples

####### Note

* Add the widget tag in the script settings to make the script available for use in script-based widgets. For more information, see Create a script.

* If your script returns a time duration, configure the widget with the graph type Single Value and enable Show as Time..

##### 6.1.3.2. Create custom XQL widgets

###### Note

* Cortex Query Language (XQL) queries generated from the Widget Library do not appear in the Query Center. The results are used only for creating the custom widget.

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### Tip

* You can create a generic dashboard for multiple views of the same dataset by using an asterisk (*) when defining the dataset in the XQL widget as dataset = <dataset_name>*. The placement of the asterisk in the dataset name ensures that any view containing this prefix text is displayed in the results. The dataset in a query is defined as: If there are...

###### 6.1.3.2.1. Configure filters and inputs for custom XQL widgets

####### Prerequisite

* Fixed filters are based on parameters that are defined in custom XQL widgets. Before you can configure fixed filters, take the following steps: Create custom XQL widgets with parameters. For more information, see Create custom XQL widgets. Add the widgets to a custom dashboard. For more information, see Build a custom dashboard.

####### Note

* This option only appears if the dashboard contains custom XQL widgets with defined parameters.

* You can define up to four parameter filters on a single dashboard or report.

* If you specify more than one field, only the first field value is used.

####### Tip

* After the initial setup, when you access your dashboard the filters and inputs might need further refinement. You can make changes to the configured parameters in the XQL widgets, and update the Filters & Inputs on your dashboard until you are satisfied with the results.

###### 6.1.3.2.2. Configure dashboard drilldowns

####### Prerequisite

* To configure drilldowns your dashboard must contain custom XQL widgets. In addition, if you want to configure in-dashboard drilldowns your custom XQL widget must contain one or more parameters. For more information about configuring parameters in custom XQL widgets, see Create custom XQL widgets.

####### Note

* If the selected parameter is configured in other XQL widgets on the dashboard, these widgets are also affected by the drilldown.

####### 6.1.3.2.2.1. Variables in drilldowns

#### 6.1.4. Run or schedule reports

##### Note

* Report templates that are based on custom infrastructure cannot be exported. If you import a report template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template. You can also...

* The report name and description will be displayed in the report header and are not editable during customization.

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

* To send reports to Slack, Slack must be configured as an external application in Cortex Cloud. For more information, see Integrate Slack for outbound notifications

##### Navigation

  Under Settings → Configurations → General → Notifications, click + Add Forwarding Configuration

## 7. Monitor and track compliance adherence

### 7.1. Cortex compliance flow

### 7.2. Choose compliance standards from the compliance catalog

#### Navigation

  Cortex provides lists of available standards and controls in the Standards and Controls catalogs under Posture Management → Compliance → Catalogs

#### 7.2.1. Standards Catalog

##### 7.2.1.1. Use a built-in or custom standard

#### 7.2.2. Controls catalog

##### 7.2.2.1. Use a built-in or custom control

###### 7.2.2.1.1. Add a custom detection rule to a custom control

####### Note

* Only custom detection rules (not built-in) can be assigned to custom controls.

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

###### 7.2.2.1.2. Create a new Custom Detection Rule

####### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

####### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

### 7.3. Use an assessment profile to run compliance checks on your assets

#### Navigation

  Under Posture Management → Compliance → Assessment Profiles, click Create New Assessment

### 7.4. View and manage compliance assessments and reports

#### Note

* Compliance assessment results may take up to six hours to be generated.

#### 7.4.1. Assessments

##### Note

* If there are no rules associated with the control, the control will be assigned a severity of low.

#### 7.4.2. Reports

##### Navigation

  The Posture Management → Compliance → Results → Reports page shows a table listing compliance assessment report files

### 7.5. View the compliance assessment of an individual asset

## 8. Discovery Engine

### 8.1. What is the Discovery Engine?

## 9. Cortex Cloud AI Security

### 9.1. What is Cortex Cloud AI Security?

### 9.2. Supported services in Cortex Cloud AI Security

### 9.3. Cortex Cloud AI Security concepts

### 9.4. Cortex Cloud AI Security use cases

### 9.5. How to perform advanced AI Security investigations using XQL

#### Note

* For more information, see Build XQL queries.

10. Cortex Cloud Application Security

  10.1. Onboard Data Sources

  10.1.1. Onboard version control systems

#### Note

* Cortex Cloud Application Security (which includes IaC and Secrets scanning), is an add-on to a license (such as Posture Security) that must be purchased separately.

* Disclaimer: When onboarding with third-party data sources, we outline the required steps for setup, but we do not monitor these external resources, and they may change over time. Always refer to the relevant third-party documentation for the most current integration steps.

#### Tip

* Navigate to Settings → Data Sources & Integrations → + Add New →  and enter your VCS data source in the search bar.

  10.1.1.1. AWS CodeCommit

#### Prerequisite

* Before you begin, ensure the following: Cortex Cloud user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) AWS user permissions: To onboard CodeCommit, the user logged into the AWS Console must have permissions to deploy the CloudFormation stack and authorize the...

#### Tip

* The instance ID is identical to the stack ID on the AWS platform.

#### Navigation

  Modules → Application Security → Periodic scans

  10.1.1.2. Azure DevOps

#### Prerequisite

* Before you begin: Cortex Cloud user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) Azure DevOps permissions: Ensure the user performing the integration holds one of the following roles in Azure DevOps:    Project Administrator: This permission is required to subscribe...

#### Note

* This forces Azure to bypass browser cookies and issue a token for the correct directory.

* PATs are static. To onboard a different tenant, you must log in to that specific environment to generate a new token.

#### Important

* When redirected to the Microsoft login screen, do not immediately enter your email.

#### Navigation

  Settings → Data Sources & Integrations → + Add New

  User Settings → Personal access tokens → + New Token

  10.1.1.2.1. Azure DevOps onboarding system architecture

#### Note

* Microsoft has announced the deprecation of legacy OAuth methods by 2026, making Entra ID the required standard for long-term support.

  10.1.1.3. Bitbucket Cloud

#### Prerequisite

* Before you begin: Cortex Cloud user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Bitbucket, grant the user performing the Cortex application authorization the following permissions. The level of access required depends on the modules you intend to use:    For code...

#### Note

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Cloud instance: Hover over the Bitbucket Cloud card in the catalog and click Connect Another.

  10.1.1.4. Bitbucket Data Center

#### Prerequisite

* Before you begin: Cortex Cloud user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Bitbucket, grant the user performing the Cortex application authorization the following permissions:    Administrator permissions for projects   Administrator permissions for...

#### Note

* By default, the permissions of the access token are set according to your current access level. It is essential to define two levels of permissions, Project and Repository permissions. The Repository permissions inherit from Project permissions, requiring Repository permissions to match or exceed Project permissions Providing read and write permissions...

* For additional security, it is recommended to set an expiry automatically. The expiry date of a token cannot be changed after it is created. You can see the expiry dates for all your tokens on Profile picture → Manage account → Personal access tokens.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Data Center instance: Hover over the Bitbucket Data Center card in the catalog and click Connect Another.

#### Important

* Always refer to the Bitbucket documentation for information relating to creating a PAT.

  10.1.1.5. GitHub Cloud

#### Prerequisite

* Before you begin: Cortex Cloud user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In GitHub, grant the user performing the Cortex application authorization the following permissions:    Organization Owner: Only an Organization Owner can directly authorize and install...

#### Note

* To create an additional GitHub SaaS instance: Hover over the GitHub SaaS card in the catalog and click Connect Another.

#### Navigation

  Settings → Data Sources & Integrations → + Add New

  Verify integration: On Data Sources, select Code Providers → GitHub SaaS → View more and confirm that the status of your integrated GitHub instance is 'Connected

  10.1.1.6. GitHub Enterprise (On-Prem)

#### Prerequisite

* Before you begin: Cortex Cloud user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In GitHub, you must have Organization Owner permissions to install the Cortex application. Users with only repository-level admin permissions cannot complete the installation unless the...

#### Note

* The domain is the hostname associated with your GitHub Enterprise (On-Prem) instance.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitHub Enterprise (On-Prem) instance: Hover over the GitHub Enterprise (On-Prem) card in the catalog and click Connect Another.

  10.1.1.7. GitLab SaaS

#### Prerequisite

* Before you begin: Cortex Cloud user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Gitlab, the following permissions are required to integrate the application:    Maintainer (Project-level). Grants sufficient permissions to configure external integrations, manage...

#### Note

* A repository can only be integrated with a single instance. The first instance that connects with the repository will be the one that the repository is assigned to. This means that if multiple integrations attempt to connect to the same repository, only the first integration to establish the connection will be associated with that repository.

* To create an additional GitLab SaaS instance: Hover over the GitLab SaaS card and click in the catalog and Connect Another.

  10.1.1.8. GitLab Self Managed (On-Prem)

#### Prerequisite

* Authorize the user integrating Cortex Cloud Application Security with your GitLab Self Managed (On-Prem) instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including...

#### Note

* The domain is the hostname associated with your GitLab Self Managed (On-Prem) instance.

* For more information about the Transporter, including setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitLab Self Managed (On-Prem) instance: Hover over the GitLab Self Managed (On-Prem) card in the catalog and click Connect Another.

  10.1.2. Onboard CI/CD systems

  10.1.2.1. Onboard CircleCI for CI/CD pipeline scans

#### Prerequisite

* Before you begin: Cortex Cloud user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) CircleCI user requirements:    Permissions: To enable Cortex Cloud visibility for all CircleCI projects, a version control system (VCS) user with integration permissions must be...

#### Note

* This integration utilizes a Personal Access Token (PAT) for authentication CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate...

* Select Add Another Instance if the data source instance has already been configured.

* To add an additional CircleCI instance, navigate to Settings → Data Sources & Integrations → , select the connected CircleCI integration, click  → Add Instance, and repeat the onboarding steps above.

  10.1.2.2. Onboard Jenkins for CI/CD pipeline scans

#### Prerequisite

* Cortex Cloud user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) In Jenkins:    To install and configure the Cortex plugin in Jenkins, you must be a Jenkins Administrator with Overall/Administer permissions   Ensure the build server allows outbound HTTPS (Port 443...

#### Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for code scans, refer to Onboard...

* Select Add Another Instance if the data source instance has already been configured.

* The integration is added on the console but integration is pending, and will only be completed after completing step 5 below. You can view the pending integration on the Jenkins Instances page: Select Data Sources →  Jenkins → View Details. The type of integration is Pipeline Risks

* Always refer to the official Jenkins documentation when installing plugins on Jenkins servers.

* To add an additional Jenkins instance, navigate to Settings → Data Sources → select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps above.

  10.1.3. Integrate CI tools

#### Navigation

  Settings → Data Sources & Integrations → hover over a CI tool → View Details

  Delete an instance: Right-click on an instance of the CI tool → Delete instance → Delete

  10.1.3.1. AWS CodeBuild

#### Prerequisite

* Before you begin:

#### Note

* Select Add Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional AWS CodeBuild instance, navigate to the Settings → Data Sources & Integrations →  page, select the connected AWS CodeBuild integration, click → Add Instance, and repeat the onboarding steps above.

  10.1.3.2. Onboard CircleCI for code scans

#### Prerequisite

* Before you begin:

#### Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for CI/CD scans, refer to...

* Select Add Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* To add an additional CircleCI instance, navigate to Settings → Data Sources & Integrations → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

#### Important

* The cortex-secrets naming convention for the context is mandatory to ensure functionality and must not be changed.

  10.1.3.3. Connect Cortex CLI

#### Prerequisite

* System requirements (OS-specific): The following operating system dependencies are required to run the Cortex Cloud CLI binary on specific architectures.    macOS (Intel Core i7, such as Sequoia):    To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew. Use this command: brew install vectorscan      RHEL...

#### Note

* Select Add Another Instance if a CLI instance is already onboarded.

* In the command above, {version} refers to the CLI version you wish to install (such as latest or a specific number), and {platform} refers to your operating system (such as, linux, darwin, windows).

#### Warning

* Using With upload results permissions may incur additional costs as per your license agreement.

  10.1.3.4. GitHub Actions

#### Prerequisite

* Before you begin:

#### Note

* Select Add Another Instance if the data source instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional GitHub Actions instance, navigate to Settings → Data Sources & Integrations → select the menu for your connected GitHub Actions instance → + New Instance, and repeat the onboarding steps above.

  10.1.3.5. Onboard Jenkins for code scans

#### Prerequisite

* Grant Administrator permissions to the user integrating Cortex Cloud Application Security with Jenkins Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

* For Cortex Cloud Application Security CI tools, you must store secrets in Jenkins Credentials for use in your Jenkins pipelines using either of these methods:    Plain text storage: Store secrets directly as plain text in Jenkins Credentials. Access them in your pipeline using the credentials function, which retrieves the secret directly as plain...

#### Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for CI/CD scans, refer to Onboard...

* Select Add Another Instance if the data source instance has already been configured.

* This step is only required for new pipelines For private repositories, ensure the necessary credentials are configured in Jenkins Credentials

* This ensures your build runs within a Docker environment. If a node without Docker is used, the build will fail.

* To add an additional Jenkins instance, navigate to Settings → Data Sources & Integrations →  select the Jenkins integration, click  → Add Instance, and repeat the onboarding steps.

  10.1.3.6. Onboard Terraform Cloud (Run Tasks)

#### Prerequisite

* Before you begin: Procure a Terraform cloud license that is either a trial license or a TF Cloud license at the TEAM & GOVERNANCE level Terraform permissions: Grant the user or team the following permissions, depending on integration:    Manage Workspaces permissions at the organization level. These permissions are required to attach and manage the run...

#### Note

* Skip this step if you plan on using an existing token.

* Select Add Another Instance if the data source instance has already been configured.

* Cortex Cloud Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Cloud (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected your Terraform Cloud (Run Tasks) instance → + New Instance, and repeat the onboarding steps.

  10.1.3.7. Onboard Terraform Enterprise (Run Tasks)

#### Prerequisite

* Before you begin: Ensure access to a Terraform Enterprise console to enable you to provide a user or team token that authorizes Cortex Cloud Application Security to access workspaces and helps regulate run configurations Terraform Enterprise version compatibility: Ensure Run Tasks for workspaces on is compatible with version 1.1.9 and above Terraform...

#### Note

* For container image vulnerabilities, Cortex Cloud Application Security performs 'Image Referencer' scans within Terraform Enterprise (Run Tasks), as full SCA scans are not currently supported.

* Skip this step if you plan on using an existing token.

* Select Add Another Instance if the data source instance has already been configured.

* Cortex Cloud Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Enterprise (Run Tasks) instance, navigate to Settings → Data Sources & Integrations →  page, select the Terraform Enterprise (Run Tasks) integration, click  → Add Instance, and repeat the onboarding steps above.

  10.1.4. CLI pipeline code snippets

#### Prerequisite

* User permissions: Ensure the user performing the integration has permissions to edit pipeline configurations (such as YAML files).

  10.1.5. Onboard private package registries

  10.1.5.1. JFrog Artifactory

  10.1.5.2. Onboard JFrog Artifactory

#### Prerequisite

* Cortex Cloud user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) JFrog permissions:    The permissions associated with the user configured during the onboarding process determine the scope of scan results. Only repositories and artifacts the user can access are...

#### Note

* To authorize the scanner to connect through your firewall, select Enable access by IPs, and copy the displayed source IPs to your organization's allowlist.

* For Maven:    Select Mirror Registry if this repository mirrors an external repository   Use the Mirror Of value to define the duplication scope:    * mirrors all requests   Type a request [value]: Mirrors only specific requests (such as central). For Maven: Select Mirror Registry if this repository mirrors an external repository Use the Mirror Of...

  10.1.6. Supported third-party data sources

#### Note

* Only onboarded and scanned repositories can be mapped.

  10.1.6.1. Ingest Semgrep data

#### Prerequisite

* Cortex Cloud user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator) Ensure that you have a connected version control system (VCS) and repositories Create a Semgrep API token  Note    To create a Semgrep API token, in Semgrep, navigate to Settings → Tokens → API...

#### Note

* Select Add Another Instance if the data source instance has already been configured.

* Mapping establishes relationships between Semgrep projects and Cortex Cloud code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects are ingested

  10.1.6.2. Ingest Snyk data

#### Prerequisite

* Permissions: The following user permissions are required:     Cortex Cloud user permissions: Ensure you have View/Edit permissions for Data Sources and Integrations (RBAC: AppSec Admin or Instance Administrator)    Ensure that you have a connected version control system (VCS) and repositories   Snyk API token:    Recommended. Generate an API token from...

#### Note

* Select Add Another Instance if the data source instance has already been configured.

* Mapping establishes relationships between Snyk applications and Cortex Cloud code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped applications are ingested

#### Navigation

  Modules → Application Security → Vulnerabilities (under Issues

  10.1.6.3. Ingest SonarQube SAST data

#### Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Generate and copy a SonarQube API token. Ensure to assign Web API scope to the API token. Refer...

#### Note

* Mapping establishes relationships between SonarQube Applications and Cortex Cloud Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

  10.1.6.4. Ingest Veracode SAST data

#### Prerequisite

* Permissions: The following user permissions are required:    Cortex Cloud: Instance Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions   Veracode: At minimum, Reviewer permissions are required Permissions: The following user permissions are required: Cortex...

#### Note

* Only mapped applications will be ingested.

* This is the recommended option to ensure complete coverage and successful operation of all features.

* Mapping establishes relationships between Veracode projects and Cortex Cloud Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

  10.1.6.5. Generic 3rd Party AppSec Collector

#### Important

* File uploads are limited to a maximum size of 10 MB.

  10.1.6.5.1. Onboard the 3rd Party AppSec Collector

#### Prerequisite

* Permissions: The following Cortex Cloud user roles or RBAC permissions are required:    User roles: CortexCortex Cloud Cloud Instance Admin, AppSec Admin   RBAC: View/Edit permissions for Data Sources configurations are required when not using a dedicated user role    For more information about user permissions and groups, refer to Assign user roles...

#### Note

* We recommend using the tool.driver.name from the SARIF file.

* This is the newly created generic collector API URL endpoint.

* Only the validity of the format is tested. No findings will be generated from the test file.

#### Warning

* The API key ID and API secret cannot be retrieved once the wizard is closed.

  10.1.7. Manage data source integrations

#### Tip

* To quickly find your data source integration, use the search bar.

  10.1.8. Transporter over Broker VM

#### Prerequisite

* Ensure you have the necessary permissions and have already set up your Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex Cloud resources. The IP addresses for the Transporter are in the Broker VM Resources section of the Enable access to required PANW resources document Open port 4052 (inbound), which...

#### Note

* The broker enables multiple connections, allowing a single Transporter applet to connect to various VCS instances Multiple Transporter applets cannot be created on a single Broker VM. Each Broker VM is limited to a single Transporter applet instance

#### Warning

* The Transporter applet is not supported for FedRAMP customers.

  10.1.8.1. Set up a Transporter applet on Broker VM

#### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator)

#### Note

* You cannot add a Transporter applet through Clusters.

#### Navigation

  your AppSec Transporter under the App column → Configure → Add Connection (on the redirected AppSec Transporter setup page

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

  10.1.8.2. Set up a Transporter on your VCS

#### Prerequisite

* Ensure you have user permissions to onboard data sources.  Note The dedicated AppSec Admin role includes the required permissions. Ensure you have user permissions to onboard data sources. Before you begin you must setup a Transporter applet on your Broker VM. Refer to Set up a Transporter applet on Broker VM for more information

#### Note

* GitLab Enterprise webhook internal IP restriction: GitLab Enterprise's security policies prevent webhook subscriptions to internal IP addresses (such as broker addresses). These subscriptions can only be enabled through specific instance configuration. For more information, refer to https://docs.gitlab.com/security/webhooks/.

#### Navigation

  Settings → Data Sources & Integrations → + Add New → , and search for your VCS on-premises data source

  10.2. Cortex Cloud Application Security dashboard

#### Navigation

  Modules → Application Security → AppSec Dashboard

  10.3. Application Security Posture Management (ASPM)

  10.3.1. ASPM use cases

  10.3.2. ASPM key features

  10.3.3. ASPM user roles and permissions

#### Navigation

  You can view AppSec Admin permissions in the tenant by navigating to Settings → Configurations → Roles → AppSec Admin

  10.3.4. Code to Cloud

#### Navigation

  Full Code to Cloud (C2C) coverage is achieved when Cortex Cloud can resolve the following chain: Repository → Pipeline → Image → (optional Registry) → Runtime resources (including VMs, VM images, and IaC-defined infrastructure

  10.3.4.1. Supported integrations

  10.3.4.2. Code to Cloud visibility

#### Navigation

  Topology graph: Located in the Business Applications side card, this tab visualizes the entire path to production (Code → Build → Deploy → Run), allowing you

  10.3.4.3. Code to Cloud troubleshooting

#### Note

* Empty state messages and troubleshooting guidance for missing lineage are only visible to users with an active license.

  10.3.5. ASPM Command Center

  10.3.5.1. ASPM Command Center workflow

#### Note

* Breakdown by type: Issues are further broken down by type (such as IAC or Secrets).

  10.3.6. Coverage

  10.3.6.1. Coverage in the user interface

#### Navigation

  Modules, → Application Security → AppSec Coverage

  10.3.7. Compliance for Cortex Cloud Application Security

  10.3.7.1. Infrastructure-as-Code (IaC) compliance

  10.3.7.2. Manage IaC compliance

#### Prerequisite

* Add these properties to the IaC Rules table through the Table Settings Menu, as they are not exposed by default.

#### Navigation

  Modules → Application Security → AppSec Polices → Add Policy

  10.3.7.3. CI/CD Compliance

#### Navigation

  To access Compliance, select Posture Management → Compliance → Reports or Assessment

  10.3.7.3.1. Create CI/CD compliance reports

#### Note

* The CI/CD module supports GitHub and GitLab provider types.

* For more information about about Asset Groups, refer to Asset Groups.

* CIS GitLab Benchmark, CIS GitHub Benchmark, and the OWASP Top 10 CI/CD Risks standards are supported.

* For more information about assessment profiles, refer to Use an assessment profile to run compliance checks on your assets.

#### Navigation

  Posture Management → Compliance → Reports

  10.3.8. Urgency

  10.3.8.1. Urgency metrics

  10.3.9. Backlog baseline

  10.3.9.1. Backlog use cases

  10.3.9.2. Issue/Finding classification by scanner

#### Note

* In some cases/vendors, this is not accurate as findings are deleted every time new findings are uploaded. In such cases, the feature may not be accurate or supported For SAST, the vendor does not support policy in pull requests

* Scanner updates and new detections: When a security scanner is updated to support new languages, detection rules, or capabilities, any issues discovered by these new features for existing code are classified as part of the backlog.

  10.3.9.3. Using Backlog

  10.3.10. Service Lead Agreements (SLA)

  10.3.10.1. Configure and monitor Cortex Cloud Application Security SLAs

#### Navigation

  Settings → Configurations → Application Configuration (under Application Security

  10.3.11. Applications

  10.3.11.1. Defining Business Applications

  10.3.11.1.1. Defining business applications by Criteria

  10.3.11.1.2. Define applications by VCS criteria

#### Prerequisite

* Data source: Your Version Control System (e.g., GitHub, GitLab) must already be onboarded as a Data Source Permissions: You must have View/Edit permissions for Access Management SBAC: You can only create applications from VCS entities (Organizations, Projects, or Repositories) that are already included in your SBAC Asset Groups

#### Note

* This workflow allows you to unify assets across disparate providers (such as grouping a GitHub repository and a Bitbucket repository into one application) if they share naming conventions

  10.3.11.1.3. Manage application criteria

  10.3.11.1.4. Define applications by cloud tag-based criteria

#### Prerequisite

* Permissions: You must have View/Edit permissions for Access Management, or a role that includes these permissions.

#### Note

* You can only create applications based on the entities from onboarded Cloud accounts listed in the Cloud card.

* Kubernetes (K8S) labels: K8S labels are supported as tags for asset grouping only when they originate from a supported cloud provider; AWS, GCP, Azure, or OCI.

  10.3.11.1.5. How to manually build an application

#### Prerequisite

* Before you begin, ensure you have connected the necessary data sources. Refer to How to onboard data sources for more information.How to onboard data sources

#### Note

* These filters are represented by icons displayed on the Code pane after selecting a VCS.

* To edit application assets, click the Clear All icon before clicking Finish. This clears all application data, allowing you to restart the application building process from the beginning.

  10.3.11.2. Application management and visibility

#### Navigation

  Inventory → All Assets → Business Applications (under Application

  10.3.11.3. Business application assets

  10.3.11.3.1. Business application expanded asset details

#### Note

* The topology graph is available only when all application components (code, pipeline, build and deploy), are configured.

  10.3.11.3.2. Export business application data

#### Navigation

  Inventory → All Assets → Business Applications

  10.3.11.4. Scope user access to applications (Application SBAC)

#### Navigation

  Configure user scopes in Cortex Cloud by navigating to Settings → Configurations → Access Management

  10.3.11.4.1. Enable SBAC in the Cortex Cloud tenant

#### Prerequisite

* RBAC permissions: To configure user scopes you must have Administrator or View/Edit RBAC permissions for Access Management (under Configurations).

#### Note

* Exclusions (roles not governed by SBAC): Certain roles cannot have SBAC applied. For these roles, access and permissions are managed through Role-Based Access Control (RBAC). You must manually ensure that these roles have all necessary base permissions (for example Edit/View permissions to assets), because SBAC is bypassed and does not impose its usual...

#### Navigation

  Settings → Configurations → General → Server Settings → Enable Scope Based Access Control

  10.3.11.4.2. Create an application-based Asset Group

#### Note

* You cannot create SBAC based on static groups.

  10.3.11.4.3. Scope user access to an application

#### Note

* For more information about User Groups, refer to User group management.

#### Navigation

  Settings → Configurations → User Groups (under Access Management

  Right-click on a group in the table → Edit Group → select the Scope tab

  Assets → Select asset groups → select an Asset Group associated with applications

  Settings → Configurations → Users (under Access Management

  the chevron icon (>) in the Assets field → Select Asset groups → select the user group scoped to the application (see above

  10.3.11.4.4. Create application-scoped policies

#### Note

* Application-scoped policies apply to both code and CI/CD configuration policies.

#### Navigation

  Modules → Application Security → AppSec Polices (under Policy Management) → Add Policy

  Add Filter → Business Application Names → enter the required application name

  10.3.12. Repositories as assets

  10.3.12.1. Explore repository assets

  10.3.12.2. In-depth repository asset information

  10.3.12.3. Manage Repository assets

  10.3.12.4. Export Software Bill of Materials (SBOM)

  10.3.12.5. Manage issues detected in repositories

#### Note

* You can also find the repository issues in the general issue inventory table, and in the dedicated inventory of issues for each scanner type (see step 4 above for details).

  10.3.13. Manage 3rd party findings and generated issues

  10.3.14. Manage code weaknesses

#### Note

* You can customize policies to define which findings are categorized as issues.

#### Tip

* In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Code Weaknesses tab under the Repositories asset inventory. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from the table → Code Weaknesses In code Asset inventories, navigate to Inventory →...

#### Navigation

  To access SAST code violation issues, under Modules, select Application Security → Issues → Code Weaknesses

  10.3.14.1. Code weaknesses issue inventory

  10.3.14.2. Detailed code weakness issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  10.3.14.3. Code weakness findings

#### Note

* Findings on the Cortex platform are not intended for direct action; but rather represent data collected by the platform. They must be promoted to issues to enable mitigation efforts to secure your codebase.

  10.4. CI/CD Security

  10.4.1. CI/CD Security user roles and permissions

  10.4.2. CI/CD Assets

  10.4.2.1. CI/CD Instances as assets

  10.4.2.1.1. Explore CI/CD Instance assets

#### Navigation

  To access CI/CD pipeline instances, under Inventory, select All Assets → Code → Category → CI/CD Instances

  10.4.2.1.2. In-depth CI/CD pipeline instance asset information

  10.4.2.1.3. Manage CI/CD pipeline instances

  10.4.2.2. CI/CD Pipelines as assets

  10.4.2.2.1. Explore CI/CD Pipeline assets

#### Navigation

  To access CI/CD pipelines assets, under Inventory, select All Assets → Code → CI/CD Pipelines

  10.4.2.2.2. In-depth CI/CD pipeline asset information

#### Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

  10.4.2.2.3. Manage CI/CD pipeline assets

  10.4.2.3. Version Control System (VCS) Organizations as assets

  10.4.2.3.1. Explore VCS Organization assets

#### Navigation

  To access VCS Organization assets, under Inventory, select All Assets → Code → VCS Organizations

  10.4.2.3.2. In-depth VCS Organization asset information

#### Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

  10.4.2.3.3. Manage VCS organization assets

  10.4.2.4. VCS Collaborators-as-assets

  10.4.2.4.1. In-depth Collaborator asset information

  10.4.2.4.2. Manage Collaborator assets

  10.4.3. Supply Chain Inventories

#### Note

* Although attributes are identical across inventories, their values for the same tool can differ, most commonly in Risk Factors and Type. This is because the inventory reflects your live environment, which may include different versions or configurations than the catalog—for example, a package may not have been upgraded or may be deployed differently.

#### Navigation

  In the inventory table, right-click on a tool → Change Status → select a status

  10.4.3.1. Supply Chain Tools

  10.4.3.1.1. Supply Chain Tools

#### Navigation

  To access Supply Chain Tools, select Modules → Application Security → Supply Chain Tools (under 3rd Party Tools

  10.4.3.1.2. Expanded Supply Chain tool information

#### Note

* AppSec Admin user permissions are required to perform these actions.

  10.4.3.2. Supply Chain Catalog

#### Navigation

  To access the Supply Chain Catalog, select Modules → Application Security → Supply Chain Catalog (under 3rd party tools

  10.4.4. CI/CD Risks

#### Note

* Cortex Cloud Application Security CI/CD pipeline scans create a comprehensive inventory of all CI/CD pipelines in your environment. For more information refer to CI/CD Pipelines as assets.

  10.4.4.1. CI/CD pipeline issues

#### Navigation

  To access CI/CD pipeline risks issues, under Modules, select Application Security → Issues → CI/CD Risks

  10.4.4.2. Expanded CI/CD risks issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  10.4.4.3. VCS and CI/CD pipeline risk findings

  10.4.5. CI/CD Rules

#### Note

* Out-of-the-box rules cannot be modified Custom CI/CD rules are not supported

  10.4.5.1. CI/CD rules roles and permissions

  10.4.5.2. CI/CD rules inventory

  10.4.6. CI/CD Policies

#### Tip

* For Cortex Cloud Code policies, refer to Application Security Policies.

  10.4.6.1. CI/CD policies user roles and permissions

  10.4.6.2. CI/CD policies inventory

#### Note

* To view all out-of-the-box (OOTB) policies, filter by Policy Owner = System.

  10.4.6.3. Create custom CI/CD policies

#### Note

* PR Scan and CI Scan triggers are automatically disabled and unchecked. They can only be enabled if other scan types (that is non-CI/CD risk scans such as Secrets) are also selected, and will only run on non-CI/CD risks types of scans

* You can combine multiple conditions to create complex rules for when the policy should apply. Create conditions that apply to a CI/CD policy which detects high severity CI/CD risks on GitHub: Select Add Filter → Finding Type → CI/CD Risks → AND → Provider → [VCS/CI/CD system] → AND → Severity: → High.

* SBAC scope limitations do not apply to Matching Criteria For CI/CD policies, you can filter Matching Criteria by VCS Organization Name, CI/CD Pipeline [Name/ID], CI/CD Instance [Name/ID] or Collaborator [Name/Email/MFA Enabled/Last Observed]

  10.4.6.4. Manage CI/CD policies

#### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

  10.5. Code Security

  10.5.1. Code Security user roles and permissions

  10.5.2. Code Security assets

  10.5.3. Software packages as assets

  10.5.3.1. Explore software package assets

  10.5.3.2. In-depth software package asset information

  10.5.4. Infrastructure-as-Code (IaC) resources as assets

  10.5.4.1. Explore IaC assets

#### Navigation

  To access IaC assets, under Inventory, select All Assets → Code → IaC Resources

  10.5.4.2. In-depth IaC resource asset information

  10.5.5. Code Security scanners

  10.5.6. Secrets scanners

  10.5.6.1. Secrets issues

#### Navigation

  Under Modules, select Application Security → Issues → Secrets

  Inventory → All Assets → Code: On the Secrets tab under Repositories

  Inventory → All Assets → Code

  Inventory → All Assets → Application → select an option from the Application menu → select an item from the inventory → Secrets

  10.5.6.2. Secrets issues inventory

  10.5.6.3. Detailed Secrets issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  10.5.6.4. Secrets findings

#### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

#### Navigation

  The Cortex Cloud Application Security Secrets Findings table is a pre-filtered view of the comprehensive Findings inventory (located at Cases & Issues → Issues → Findings Table tab

  To access Secrets findings, select Application Security → Issues → Secrets → click the Findings tab

  10.5.6.5. Manage Secrets issues

  10.5.7. Infrastructure as Code (IaC) misconfiguration scanner

  10.5.7.1. Supported frameworks and languages

  10.5.7.2. IaC misconfiguration issues

#### Tip

* You can also view IaC misconfiguration issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Configuration tab under Repository assets. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from...

#### Navigation

  To access IaC misconfiguration issues, under Modules, select Application Security → Issues → IaC misconfiguration

  10.5.7.3. IaC misconfiguration issues inventory

  10.5.7.4. Detailed IaC misconfiguration issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  10.5.7.5. IaC misconfiguration findings

#### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

#### Navigation

  To access IaC misconfiguration findings, under Modules, select Application Security → Issues → IaC Misconfigurations → click the Findings tab

  10.5.7.6. Manage IaC misconfiguration issues

  10.5.8. IaC Drift Detection scans

  10.5.8.1. IaC Drift Detection issues

#### Navigation

  Modules → Application Security → IaC Drifts

  10.5.8.2. IaC Drift Detection issue inventory

  10.5.8.3. Detailed IaC drift detection issue information

  10.5.8.4. IaC Drift Detection findings

#### Navigation

  Modules → Application Security → IaC Drifts (under Issues) → click the Findings tab

  10.5.9. Software Composition Analysis (SCA ) scanners

  10.5.9.1. Supported Software Composition Analysis (SCA) frameworks and languages

  10.5.9.2. Software Composition Analysis (SCA) vulnerability issues

#### Tip

* In Asset inventories, navigate to Inventory → All Assets → Code:    On the Vulnerabilities tab under Repositories. Refer to In-depth repository asset information for more information Under the All Code inventory: Select an asset from the table → Vulnerabilities In Asset inventories, navigate to Inventory → All Assets → Code: On the...

#### Navigation

  To access CVE vulnerability issues, under Modules, select Application Security → Issues → Vulnerabilities

  10.5.9.2.1. Vulnerability issues inventory

  10.5.9.2.2. Detailed vulnerability issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  10.5.9.2.3. CVE vulnerabilities findings

#### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

#### Navigation

  The Cortex Cloud Application Security Vulnerabilities Findings table is a pre-filtered view of the comprehensive Findings inventory (located at Cases & Issues → Issues → Findings Table tab

  To access CVE findings, under Modules, select Application Security → Issues → Vulnerabilities → click the Findings tab

  10.5.9.2.4. Manage SCA CVE vulnerability issues

  10.5.9.3. License miscompliance issues

#### Tip

* You can also view license miscompliance issues in dedicated tabs under other sections when available: In Application asset inventories: navigate to Inventory → All Assets →  Application → select an option from the Application menu → select an item from the inventory → Package Integrity In Asset inventories, navigate to Inventory → All...

#### Navigation

  To access license miscompliance issues, under Modules, select Application Security → Issues → Licenses

  10.5.9.3.1. License miscompliance issues inventory

  10.5.9.3.2. Expanded License miscompliance issues information

  10.5.9.3.3. License miscompliance findings

#### Navigation

  To access license miscompliance findings, under Modules, select Application Security → Issues → Licenses → click the Findings tab

  10.5.9.3.4. Open-source software license categories

  10.5.9.3.5. Manage license miscompliance issues

  10.5.9.4. Package Integrity

  10.5.9.4.1. Package Integrity inventory

#### Note

* You can modify the severity level from the severity field menu.

  10.5.9.4.2. Expanded Package Integrity issues inventory information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  10.5.9.4.3. Package Integrity findings

#### Note

* Findings cannot be mitigated. They must be promoted to issues to enable remediation efforts to secure your software packages.

  10.5.9.4.4. Manage Package Integrity issues

  10.5.10. Application Security scans management

  10.5.10.1. Overview

#### Note

* While scans provide a comprehensive inventory of all issues detected during a scan, dedicated inventories are also maintained for specific scan types for more granular management. For more information, refer to Infrastructure as Code (IaC) misconfiguration scanner, Secrets scanners and Software Composition Analysis (SCA ) scanners.

  10.5.10.2. Branch periodic scans

#### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

  10.5.10.3. Pull Request scans

#### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

  10.5.10.4. CI scans

#### Note

* The inventory table displays scan issues for visibility only; remediation is not available in scan management. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

  10.5.10.5. Manage repository scan configurations

  10.5.10.6. Monitor data source instances health

  10.5.11. Application Security Policies

  10.5.11.1. User roles and permissions

  10.5.11.2. Policies inventory

#### Note

* To view all out-of-the-box (OOTB) policies, filter by Policy Owner = System.

  10.5.11.3. AI-recommended guardrails

  10.5.11.3.1. Manage AI-recommended guardrails

#### Note

* Recommended guardrails are generated based exclusively on findings from the Cortex Cloud Application Security Software Composition Analysis (SCA) scanner. They do not support SCA data ingested from third-party scanners, nor do they currently support other finding categories, such as Secrets or Infrastructure as Code (IaC).

* The total amount of available recommended guardrails is displayed on the AI Recommendations button.

* The AI-Recommended tag is only assigned to recommendations applied as-is, that is, without modifications. Edited recommendations generate policies without this label.

  10.5.11.4. Create Cortex Cloud Application Security policies

#### Note

* When an issue is created, only the first policy ID that triggered the issue is associated with it.

  10.5.11.4.1. Create code security policies

#### Note

* For a detailed list of all available attributes and their values by scanner type, refer to Cortex Cloud Application Security code policy Condition attributes .

* SBAC scope-based limitations do not apply to Asset Types

* When selecting Asset Groups, the code policy is evaluated only on the application and repository assets included in the group.

* For each application that matches the criteria, the policy is evaluated only on the repositories associated with that application.

* If you select only Code Weaknesses as the Finding Type in the condition step (indicating a third-party scanner), the PR and CI triggers are disabled, leaving only Periodic Scan enabled.

  10.5.11.4.1.1. Cortex Cloud Application Security code policy Condition attributes

  10.5.11.4.2. Create IaC Drift Detection policies

#### Navigation

  Modules → Application Security → AppSec Policies → Add Policies

  10.5.11.4.3. Manage Cortex Cloud Application Security policies

#### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

  10.5.12. Application Security Rules

#### Note

* Out-of-the-box rules cannot be modified directly. However, you can create a custom rule by cloning the existing one. This allows you to make changes to the original rule according to your requirements. Refer to Manage Cortex Cloud Application Security custom rules for more information.

  10.5.12.1. Roles and permissions

  10.5.12.2. Rules inventory

#### Navigation

  To filter rules relating to Secrets, select filter icon → Scanner (from the Select field) → Secrets (from the Value field

  10.5.12.3. Create custom Cortex Cloud Application Security rules

#### Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

  10.5.12.4. Manage Cortex Cloud Application Security custom rules

  10.5.12.5. Configure YAML file properties

  10.5.13. Application Security CLI

#### Prerequisite

* These requirements apply specifically to the Application Security CLI. For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of...

#### Note

* For detailed information about the Cortex Cloud CLI, refer to Cortex CLI.

  10.5.13.1. Connect Cortex CLI

#### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

#### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources & Integrations →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Cortex Cloud Application Security, refer to Cortex CLI usage for Cortex Cloud Application Security

#### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source or Integrations page after selecting + Add New.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

  10.5.13.2. Cortex CLI usage for Cortex Cloud Application Security

  10.5.13.3. CLI pipeline code snippets

#### Prerequisite

* User permissions: Ensure the user performing the integration has permissions to edit pipeline configurations (such as YAML files).

  10.5.13.4. Cortex CLI Cortex Cloud Application Security command line reference

#### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

#### Important

* The Cortex CLI Cortex Cloud Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id...

  10.5.13.5. Cortex CLI common command line reference guide

#### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

  10.5.13.6. Git Hooks

  10.5.13.6.1. Cortex CLI pre-commit hooks

#### Prerequisite

* These common prerequisites are required for all types of installation (both local and global) of the Cortex CLI pre-commit hook. Ensure you have a license for Cortex Cloud Application Security Install the Cortex Cloud CLI binary locally. Refer to Connect Cortex CLI for information about onboarding the CLIConnect Cortex CLI Obtain Cortex Cloud API...

* For local installation: Install the pre-commit framework version 3.2.0 or greater. Refer to https://pre-commit.com/ for installation instructions.

#### Note

* It is recommended you configure credentials for the Cortex CLI using a configuration file.

* The pre-commit framework is not required for global mode.

  10.5.13.6.1.1. Pre-commit hook usage

  10.5.13.6.2. Cortex CLI pre-receive hooks

#### Prerequisite

* Before you begin, ensure you have: Administrator access to the VCS server and console A valid license for Cortex Cloud Application Security The Cortex Cloud CLI binary or Docker image installed on the server (requires GLIBC (GNU C library) version 2.35 or greater). Refer to Connect Cortex CLI for information about onboarding the CLIConnect Cortex...

#### Note

* Make sure to create the directory under the home directory of the Linux user that runs the Git hooks. This user is typically not the root user.

  10.5.13.6.2.1. Pre-receive hook usage

  10.5.14. IDE

#### Note

* Not all remediation options are available for all findings or all type of scan category.

  10.5.14.1. System requirements

  10.5.14.2. Visual Studio (VS) Code and VS Code compatible IDEs

#### Prerequisite

* Before you begin (These prerequisites apply to both VS Code and VS Code compatibles): Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

#### Note

* Enforcement rules and CA certificates are not applicable to the open-source project.

#### Tip

* You can access Extensions using the keyboard shortcuts Ctrl+Shift+X (Windows) or Cmd+Shift+X (macOS).

#### Navigation

  Install through VS Code IDE Access the Activity bar → Extensions → Cortex Cloud → Install

  Access the Activity bar → Extensions → Cortex Cloud → Install

  10.5.14.2.1. How to use the Cortex Cloud extension in VS Code

#### Note

* Not all remediation options are available for all issues.

* The suppression is scoped to the file.

  10.5.14.3. JetBrains

#### Prerequisite

* Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install Node.js version 22 and...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

#### Note

* The Cortex AppSec code security plugin supports all JetBrains products.

#### Navigation

  Settings → Plugins → select the Marketplace tab → search for Prisma Cloud → Install → OK

  Settings → Tools → Cortex Cloud

  10.5.14.3.1. How to use the JetBrains Cortex Cloud extension

#### Note

* After selecting Fix Available, the number of issues displayed in the issue categories (such as IaC) reflect the number of fixable issues for that type.

* The corresponding file simultaneously opens in the Code editor, highlighting the issue within its exact code context. See below for more information.

* Not all types of remediation are available for all issue categories. For example, fixes are not available for License issues.

* Secrets and Licenses category issues are typically mitigated by following the guidance in the Documentation.

  10.5.15. Developer Suppressions

#### Note

* The check IDs and rule names are placeholders for illustration purposes and do not correspond to actual checks.

  10.6. API documentation

11. Cortex Cloud Data Classification

  11.1. What is Cortex Cloud Data Classification?

#### Navigation

  To access Data Classification management, click Settings → Configurations → Data Classification

  11.2. How to create and validate a custom data pattern

#### Note

* Once a custom data pattern is saved, it runs on all data in the same way as any out-of-the-box (OOTB) pattern, becoming globally applicable for all modules using Cortex Cloud Data Classification.

* For more information, see How to disable and enable data patterns in Data Classification.How to disable and enable data patterns in Data Classification

  11.3. How to disable and enable data patterns in Data Classification

#### Note

* Disabling data patterns can cause changes in your data profile results and stop detection of these data patterns.

* For more information about data patterns in data classification, see What is Cortex Cloud Data Classification?.

#### Navigation

  In the lower left part of the screen, click Settings → Configurations → Data Classification → Data Patterns

  11.4. How to create and validate a custom data profile

#### Note

* If you choose two data locations, only the filters they have in common will be included in the possible filter options.

* For more information, see How to disable and enable data profiles in Cortex Cloud Data Classification.

#### Important

* Deleting a data profile deletes all past data associated with it in all modules using Cortex Cloud Data Classification after a warning notification is displayed.

* Enabling and disabling a data profile removes or re-adds the data profile results to the data objects; that is, files and tables.

  11.5. How to disable and enable data profiles in Cortex Cloud Data Classification

#### Note

* Existing results on past scans are updated in the Asset and Object inventories within two hours after being disabled or enabled.

* For more information about data profiles in Cortex Cloud Data Classification, see What is Cortex Cloud Data Classification?.What is Cortex Cloud Data Classification?

#### Navigation

  In the lower left part of the screen, click Settings → Configurations → Data Classification → Data Profiles

  11.6. How to report a false positive in Cortex Cloud Data Classification

#### Note

* Alternatively, in Cortex Command Center, click Help → Submit a Support Case.

12. Cortex Cloud Data Security

  12.1. What is Cortex Cloud Data Security?

  12.2. Supported assets in Cortex Cloud Data Security

#### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### Note

* CMK (customer-managed key) in SQL Server is only supported in outpost mode.

* The list above refers to only data classification; however, Cortex Cloud Data Security discovers and monitors all cloud assets and services for usage and misconfigurations.

* For information about configuring data classification asset types, see How to configure the scanning settings for supported services.

  12.3. Cortex Cloud Data Security concepts

  12.4. Cortex Cloud Data Security use cases

  12.5. Data Inventory

#### Note

* To clear the filter in the filter panel, click Delete.

#### Navigation

  When you select Inventory → All Assets → Data → All Data Assets, a list of all data assets appears

  12.6. How to review errors in Cortex Cloud Data Security

  12.7. How to configure the scanning settings for supported services

#### Note

* If you do not select a scanning cadence, the default setting is applied. For more information, contact your Customer Support team.

  12.8. How to perform advanced Data Security investigations using XQL

#### Note

* For more information, see Build XQL queries.

  12.9. How to onboard Databricks

#### Note

* If you turn on this feature, both the cloud and region will be used for scanning, possibly incurring cost and requiring adherence to certain compliance policies.

  12.10. How to onboard Microsoft 365

#### Prerequisite

* You have generated a Globally Unique Identifier (GUID), also known as a Universally Unique Identifier (UUID). You will need this ID for the tenant you want to use for the Microsoft 365 instance. In order to use Microsoft 365, you must be registered with Microsoft Azure.

  12.11. How to onboard on-premise file shares to Cortex Cloud Data Security

#### Note

* Your data is scanned on the Broker VM itself, and only the metadata and classification results are transmitted from the on-premise environment to Cortex Cloud.

* For information about activating the DSPM Fileshare applet, see Activate DSPM Fileshare.

  12.12. How to onboard Snowflake

#### Prerequisite

* In order to use Snowflake, you must be registered with one of these cloud providers: Amazon AWS, Microsoft Azure, or Google Cloud Platform (GCP). Ensure you have the necessary account permissions to onboard. It is recommended to use Account Admin as the role for the onboarding.

#### Note

* The account identifier can be found using the user information at the bottom left. Hover over the account you wish to onboard and select the copy option at the top right. The account identifier is usually of the format: (organization).[account]

  12.13. How to use information protection labels in Cortex Cloud Data Security

#### Note

* Only If you have connected a Microsoft 365 instance to Cortex Cloud, the information protection labels appear. See How to onboard Microsoft 365.

13. Cortex Cloud Identity Security

  13.1. What is Cortex Cloud Identity Security?

  13.2. Review and improve your Identity Security posture

#### Tip

* Reducing the number of nonhuman entities that are either dormant or have administrative privileges is the most effective way to improve your security score.

  13.3. How does Effective Permission Calculation work?

  13.4. Cortex Cloud Identity Security functionality

#### Note

* Access to the Weak/Compromised Password widget and column requires the ITDR add-on.

* For more information about Effective Permission Calculation, see How does Effective Permission Calculation work?.

* When a policy is analyzed and categorized as excessive, a relevant finding and highlight is attached to that policy and the various identities being granted excessive permissions.

* Each action must be defined as either being administrative or not. The administrative tag is an additional tag for administrative actions, along with one of the other access level types. For example, the AWS action iam:CreateGroup is categorized as config and has the administrative tag as well.

#### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

  13.5. Achieve the principle of least privilege access

#### Note

* In the case of Amazon AWS, Cortex Cloud Identity Security also uses AWS Identity and Access Management (IAM) Access Advisor insights to expand the coverage of supported actions.

#### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

  13.6. Explore permissions using the simple and advanced access tables

  13.7. Create a custom detection rule in Cortex Cloud Identity Security

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

  13.8. Perform advanced Identity Security investigations using XQL

#### Note

* For more information, see Build XQL queries.

  13.9. Enable inactive human identity logs on Azure in Cortex Cloud Identity Security

#### Note

* For more information, see Ingest logs from Microsoft Azure Event Hub.Ingest logs from Microsoft Azure Event Hub

  13.10. Manage RBAC and SBAC in Cortex Cloud Identity Security

#### Important

* You can use the Cortex Cloud Identity Security RBAC roles to define access to the various sections and functionalities of Cortex Cloud Identity Security, but these roles do not directly control the specific data a user sees within those sections. Data visibility is further refined and limited by scope-based access control (SBAC) capabilities.

14. Cloud ASM

  14.1. What is Cloud ASM?

  14.2. Cloud ASM concepts

  14.2.1. Scanning

  14.2.1.1. Scanning cadences

  14.2.1.2. Scanning ports and protocols

#### Note

* The following lists are not exhaustive. For current and complete lists, contact your customer success team.

  14.2.1.3. Scanning activity

  14.2.2. Network mapping

  14.3. Enable Cloud ASM

#### Note

* Discovered services will increase workload consumption. ASM data will begin to appear in your tenant and be included in your licensing workload meter within 72 hours.

#### Navigation

  Settings → Configurations → Attack Surface → Data Management

  14.4. Attack Surface Management detections

  14.4.1. Attack surface rules

#### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

  14.4.2. Externally inferred CVEs

#### Note

* An externally inferred CVE might impact your service or asset, but additional investigation is required to confirm that the CVE is actually present.

  14.5. Attack surface assets

#### Navigation

  The internet-facing assets that were discovered in an attack surface management (ASM) scan and attributed to your organization are available in the inventory on the Inventory → Assets → All Assets → External Surface pages

  14.6. Review your unmanaged cloud services

#### Navigation

  Inventory → Assets → All Assets → External Surface → Services

  14.7. Review unmanaged cloud issues

  14.8. Attack Surface Management FedRAMP support

15. Network exposure detection

  15.1. What is Cloud Network Analyzer?

  15.2. Internet exposure detection

#### Note

* Currently, CNA supports only an isolated architecture with an AWS Gateway Load Balancer (GWLB) within a single VPC. Other more centralized topologies including one security VPC that forwards traffic to other workload VPCs are currently not supported.

  15.3. Outbound exposure detection

  15.4. East-west exposure detection

  15.5. Investigate an internet exposure

#### Note

* The Network tab is currently only available for virtual machines.

* The Network tab is only displayed when you have access to the main asset and associated ones, such as security groups, VPCs and subnets. For more information on Scope-Based Access Control (SBAC) for configuring granular scoping, see Manage user scope.Manage user scope

16. Vulnerability management

  16.1. Vulnerability management in Cortex Cloud

#### License Type

  Requires the Cortex Cloud Posture Security, Cortex Cloud Runtime Security, Exposure Management, or ASM add-on.

#### Note

* Cortex Cloud vulnerability management provides the ability to identify and assess runtime vulnerabilities in every asset across traditional IT and cloud environments. For vulnerabilities detected in your software development lifecycle through application security scans, refer to the Cortex Cloud Application Security documentation.

  16.1.1. Cortex Cloud vulnerability concepts

#### Note

* CVE is an acronym for Common Vulnerabilities and Exposures, which is a list of publicly disclosed security threats. We often use the term "CVE" to refer to a vulnerability that has been a assigned a CVE ID. Cortex Cloud identifies CVEs and non-CVE vulnerabilities.

  16.1.2. Vulnerability Management dashboard

  16.2. Cortex Vulnerability Risk Score

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

  16.3. Vulnerability policies

  16.3.1. Create a vulnerability policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

  16.3.2. Update the Ignored CVEs, Asset Groups, and Assets policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

  16.3.3. Modify a vulnerability policy

#### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

  16.3.4. Configure a block grace period

#### Navigation

  Posture Management → Rules & Policies → Vulnerability Management → Vulnerability Policies - Prevention

  16.3.5. Enable or disable a vulnerability policy

#### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

  16.4. Investigate and remediate vulnerabilities

  16.4.1. View all Vulnerabilities

#### Navigation

  Posture Management → Vulnerability Management → Vulnerabilities

  16.4.2. View vulnerability issues

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

  16.4.3. View All Vulnerability Findings

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues and click the All Vulnerability Findings button

  16.4.4. View vulnerable assets

#### Navigation

  Posture Management → Vulnerability Management → Vulnerable Assets

  16.5. Vulnerability Intelligence

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

  16.6. Recast CVSS scores and CVSS severities

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

17. Cloud Security Rules and Policies

  17.1. Overview

  17.2. Cloud Security Rules

  17.3. Cloud Security Policies

#### Note

* If you have the following Scope Based Access Control (SBAC) settings in place, User Settings > Cases and Issues Scope > Select domains > Posture, you may encounter a Case mismatch in Issues/Cases/Findings counts. This is because the Case count on the Rules page captures Cases belonging to the Posture domain. Whereas Platform pages, capture Issues...

* 17.3.1 |Issues Issues are artifacts of the policy and represent actionable items that you need to address. They have several characteristics, such as: Lifecycle '–' Open, Dismiss, In-progress, Close Workflows '–' Assigned to different user personas for remediation Severity '–' Critical, High, Medium, Low, Info NOTE: A key distinction between Findings and Issues is that Findings are not actionable, while you can take an action on Issues. The Cloud Security Policies page allows you to manage policies that define security and compliance actions for cloud posture. You can create, edit, filter, and manage policies through a structured table and widget panel. The Policies page displays all the configured policies with the following fields. 17.4 |Create Rules You can create your own custom rules for Configuration (Config), Data, and Network Exposure. View all the Cloud Posture Security Rules on the Posture Management > Rules & Policies > Rules > Cloud Security page. 17.4.1 |Create a configuration rule Configuration (config) rules monitor your resource configurations for potential policy violations or misconfigurations. Perform this task to create a custom configuration rule that you can use in a cloud security policy. Navigate to Posture Management → Rules & Policies → Rules → Cloud Security. Select Create Rule > Config. Complete the Overview step: Enter a Rule Name and Description. Select a Severity. This will be the severity of any issues created with this rule. Add Labels (optional). These rules can be used find rules when creating custom policies. Enable Remediation using the toggle (optional). In a later step, you'll enter the remediation instructions. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. Click Next. Complete the Overview step: Enter a Rule Name and Description. Select a Severity. This will be the severity of any issues created with this rule. Add Labels (optional). These rules can be used find rules when creating custom policies. Enable Remediation using the toggle (optional). In a later step, you'll enter the remediation instructions. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. (Optional) Associate this rule with a Compliance Control. Click Add, select one or more custom compliance controls from the list, and then click Assign. Custom configuration rules can only be associated with custom compliance controls. Complete the Rule Logic step to define what the rule is looking for. Select one of the following modes: Simple Mode: Presents a guided interface in which you can define basic conditions and address most common rule use cases. Advanced Mode: Presents a free-form XQL editor that allows you to build complex and flexible queries across unrestricted datasets. Supports advanced and custom use cases. Complete the Rule Logic step to define what the rule is looking for. Select one of the following modes: Simple Mode: Presents a guided interface in which you can define basic conditions and address most common rule use cases. Advanced Mode: Presents a free-form XQL editor that allows you to build complex and flexible queries across unrestricted datasets. Supports advanced and custom use cases. If you selected Simple Mode, complete the following steps: Select options from the dropdown menus to define the logic for your config rule, such as '''Find EC2 instances where accessKeys are allowed'', and then click Search to view all matching results. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Simple Mode, complete the following steps: Select options from the dropdown menus to define the logic for your config rule, such as '''Find EC2 instances where accessKeys are allowed'', and then click Search to view all matching results. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Advanced Mode, complete the following steps: Define an XQL query for the rule, following the guidelines in Guidelines for creating cloud security rules. For detailed information about how use XQL, see Get started with XQL. Click Test to determine if the query is valid. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Check the list of query results to verify that the query is working as intended. Click Next to define Remediation instructions (if you had turned on Enable Remediation in the Overview step) or click Done. If you selected Advanced Mode, complete the following steps: Define an XQL query for the rule, following the guidelines in Guidelines for creating cloud security rules. For detailed information about how use XQL, see Get started with XQL. Click Test to determine if the query is valid. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Select the Affected Asset Type. Generated issues will be linked to assets identified by the selected field. Check the list of query results to verify that the query is working as intended. (Optional) In the text field, define remediation actions or provide other information that will be included on issues created by this rule. Click Done to save your config rule. 17.4.1.1 |Guidelines for creating cloud security rules NOTE: XQL queries are supported for cloud security configuration rules only. XQL queries are not yet supported for other types of cloud security rules.

  17.4.1.2. Cloud security rule status for custom configuration rules

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

  17.4.2. Create a Data Rule

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

  17.4.3. Create a Network Exposure Rule

  17.4.4. Edit a Rule

  17.5. Create Policies

#### Note

* When creating Policies, note that Rules with the Informational severity level are excluded.

  17.5.1. Edit a Policy

  17.5.2. Use an Existing Policy to Create a New One

18. Cloud Workload Policies and Rules

#### Prerequisite

* Users need View/Edit RBAC permissions (under Policies → Compute Policies) or the Instance Administrator role to view, edit, and modify Cloud Workload Policies policies.

#### Important

* Users with SBAC granular scoping (in addition to the RBAC permissions required for Cloud Workload Policies) can only view Cloud Workload Policies, when their access is scoped to any of the available options: All assets, No assets, or Select asset groups. For more information on granular scoping, see Manage user scope. When no SBAC restriction is...

  18.1. How policies and rules work together

  18.2. Cloud Workload Policies

#### Note

* Issues are automatically resolved when the finding is no longer applicable to the asset or when the affected asset is removed from the inventory. For more details on Prevent and create issues, see Cloud Workload Preventive Action.

  18.2.1. Types of Cloud Workload Policies

  18.2.1.1. Trusted image cloud workload policies

#### Note

* Registry scanning is for finding problems that are objectively issues regardless of context, organization, or scope. Trust, however, is subjective. Depending on the scope and other factors, an issue may or may not be problematic, and can change over time depending on the context.

* Trusted image policies do not override other policies and their rules, such as malware policies, misconfiguration policies, and secrets policies.

#### Caution

* The default behavior for the prevent action when trust criteria are unavailable is Create an Issue. Be aware that changing this default will mean an incomplete deployment file can block a workload.

  18.2.2. Cloud Workload Policies page

#### Note

* Keep the following caveats in my mind when working with Policies: Instance Administrators are able to view all facets of policies without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be...

  18.2.2.1. Widgets panel

  18.2.2.1.1. Show or hide the widget panel

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.2.2. Change the layout of the policies table

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.2.3. Policy Details Panel

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.3. Enable or disable a Cloud Workload Policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.4. Create a Cloud Workload Policy

#### Note

* The Evaluation stage for Misconfiguration policies is supported only in the Runtime SDLC stage and is enforceable through the Kubernetes Admission Controller for clusters on-boarded using the Posture Management (KSPM) Connector.

* Use Create a new Custom Detection Rule to define and add new custom rules as required.

* Each rule may support different actions. While some include both Create an Issue and Prevent and Create an Issue, others provide only the Create an Issue option.

* All non-relevant (non-compute) assets are automatically excluded from the included asset list.

* See Cloud Workload Preventive Action, to learn more about the Prevent action behavior and prerequisites. If the Prevent and create an issue action is selected, the preventive actions in the CI pipeline will trigger a Fail Pipeline by returning an exit code of 2 in the CI tool.

* Choosing this option results in the automatic selection of all other asset scopes in the list.

* See Cloud Workload Preventive Action, to learn more about the Prevent action behavior and prerequisites.

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.5. Use an existing policy to create a new Cloud Workload policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.6. Edit a Cloud Workload Policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.7. Delete a Cloud Workload Policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  18.2.8. Cloud Workload Preventive Action

  18.3. Cloud Workload Rules

  18.3.1. Default (pre-defined) Rules

  18.3.2. Custom (user-defined) Rules

  18.3.3. Cloud Workload Rules page

#### Note

* Keep the following caveats in my mind when working with Rules: Instance Administrators are able to view all facets of Rules without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be able...

  18.3.3.1. Filter page results

  18.3.3.2. Change the layout of the rules table

  18.3.3.3. Rule details panel

  18.3.4. Create a new Custom Detection Rule

#### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

#### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

  18.3.5. Use an existing rule to create a new Custom Detection Rule

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

  18.3.6. Edit a Custom Detection Rule

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

  18.3.7. Delete a Custom Detection Rule

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

19. Serverless function posture security

  19.1. Onboard cloud providers for serverless functions

#### Note

* When scanning serverless functions with layers, those layers need to be from the same cloud account.

* Only functions containing zip files are supported.

#### Important

* Cortex supports Google Cloud Functions: 1st gen and 2nd gen Cloud Functions API.

  19.2. Serverless function posture policies

  19.2.1. Manage serverless function policies

#### Note

* You can select multiple types to view all your serverless function rules across your cloud providers.

* Refer to Create serverless function policies for more information on how to define the steps of a policy in the wizard.

  19.2.2. Create serverless function policies

#### Note

* You can select multiple options.

* For more information about rules, refer to Manage serverless function rules.

  19.3. Serverless function posture rules

  19.3.1. Manage serverless function rules

#### Note

* You can select multiple types to view all your serverless function policies across your cloud providers.

* Refer to Create serverless function rules for more information on how to define the steps of a rule in the wizard.

  19.3.2. Create serverless function rules

  19.3.3. Create an attack path rule for serverless functions

#### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  in as the operator → enter the CVE ID → Search

  > or >= as the operator → Severity level (such as High, Low) → Search

  > or >= as the operator → enter a score → Search

  19.3.4. Create a configuration rule for serverless functions

#### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  19.3.5. Create a network exposure rule for serverless functions

#### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  19.4. Serverless function usage

#### Navigation

  To access serverless function assets, under Inventory, select All Assets → Compute → Serverless Functions

  Posture Management → Vulnerability Management) → Vulnerability Issues

  Add Filters → Asset Category → Serverless Function

  Posture Management → Vulnerability Management) → Vulnerable Assets

  Add Filters → Asset Category → Serverless Functions

20. Data management

  20.1. Broker VM

  20.1.1. What is the Broker VM?

  20.1.2. Set up and configure Broker VM

#### Note

* The Broker VM comes with a 512 GB disk. Therefore, deploy the Broker VM with thin provisioning, meaning the hard disk can grow up to 512 GB but will do so only if needed.

* When DHCP is not enabled in your network and there isn't an IP address for your Broker VM, configure the Broker VM with a static IP using the serial console menu.

* When configuring a Local Agent Settings applet with installer and content caching, you need to configure an SSL certificate for the Broker VM as explained in the task below. For more information on specific requirements for the Local Agent Settings applet, see Activate Local Agent Settings.Activate Local Agent Settings Keep in mind that several Broker...

* When a Broker VM is disconnected for more than 30 days, it will have to go through a re-registration process.

* You can configure another Broker VM as a proxy server for this Broker VM by selecting the HTTP type. When selecting HTTP to route Broker VM communication, you need to add the IP Address and Port number (set when activating the Agent Proxy) for another Broker VM registered in your tenant. This designates the other Broker VM as a proxy for this Broker VM.

* The Palo Alto Networks Broker VM supports only strong cipher SHA256-based certificates. MD5/SHA1-based certificates are not supported.

* If adding a CA certificate to the Broker VM is not possible, ensure that you've added the Broker Service FQDNs to the SSL Decryption Exclusion list on your firewalls. See Enable Access to Cortex XDR.

#### Important

* There can be instances in which the Broker VM requires up to 50% of the incoming bandwidth as outgoing. Such instances can be, network instability between the Broker VM and Cortex Cloud, or data that is being collected, but not well compressed.

* The internal network for the Broker VM must be unique and reserved. Other devices should not use the same IP as the Broker VM internal network as it can lead to communication issues with the Broker VM.

* If you use SSL decryption in your firewalls and proxies, see the Understanding CA certificate functionality in Broker VM deployments section below. In addition, verify that the proxies used support HTTP/2, gRPC-specific headers, and HTTP/2 trailers, and the inspection policies support gRPC traffic. Any devices that you use with this configuration...

* When configuring more than one network interface, ensure that only one Default Gateway is defined. The rest must be set to 0.0.0.0, which configures them as undefined. In addition, we recommend assigning each network interface to a different subnet, as oppose to configuring two interfaces on the same subnet which can potentially cause unexpected...

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and earlier, Cortex Cloud will only accept 172.17.0.0/16.

* We strongly recommend disabling SSH connectivity when it's not being used. Therefore, activate SSH connectivity when it's needed and disable it right afterwards. When generating a new SSH key ensure to avoid embedding the domain-style username, by not using any backslashes (\) in the comment field, to ensure the SSH key passes validation.

  20.1.2.1. Broker VM image installations

  20.1.2.1.1. Set up Broker VM on Microsoft Azure

#### Prerequisite

* Download a Cortex Cloud Broker VM VHD (Azure) image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

#### Note

* Extraction can take up to a few hours.

* Upload can take up to a few hours.

* For more information, see the Azure Documentation.

* Creating the VM can take up to 15 minutes. The Broker VM Web UI is not accessible during this time.

* For more information on creating a rule in an Azure VM, see Create a Security Rule in the Azure Documentation.

  20.1.2.1.2. Set up Broker VM on Alibaba Cloud

#### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

#### Note

* For Linux and Windows uploads, you can use Alibaba Cloud's graphical management tool called ossbrowser.

* The Object Storage Service must be created in the same Region as the image of the virtual machine.

#### Navigation

  Hamburger menu → Elastic Compute Service → Instances & Images → Instances

  20.1.2.1.3. Set up Broker VM on Amazon Web Services

#### Prerequisite

* Download a Cortex Cloud Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. You need to set up an AWS VM Import role (vmimport) before you continue with the steps to convert the image as it is required for the import-image CLI command. You can use a different role, if the...

#### Note

* Creating an AMI image can take up to 60 minutes to complete.

* Assigning security groups can take up to 15 minutes.

#### Important

* A t2.medium (4GB RAM) is the lowest machine type that can be used as an instance type. Usually, the lowest machine type is sufficient with the Local Agent Settings applet. Yet, when enabling more applets, 8 GB is required.

#### Navigation

  Log in to the AWS IAM Console, and in the navigation pane, select Access Management → Users → Add Users

  Obtain a registration token from the Cortex Cloud Web Console by selecting Settings → Configurations → Data Broker → Broker VMs → Add Broker → Generate Token

  20.1.2.1.4. Set up Broker VM on Google Cloud Platform (GCP)

#### Prerequisite

* Download a Cortex Cloud Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. To complete the set up, you must have G Cloud installed and have an authenticated user account.

* Before importing a GCP image using the gcloud CLI, ensure that you update the Google Cloud components to version 371.0.0 and above using the following command:

#### Note

* The import tool uses Cloud Build API, which must be enabled in your project. For the import to work, Cloud Build service account must have compute.admin and iam.serviceAccountUser roles. When using the Google Cloud console to import the image, you will be prompted to add these permissions automatically.

  20.1.2.1.5. Set up Broker VM on KVM using Ubuntu

#### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  20.1.2.1.6. Set up Broker VM on Microsoft Azure

#### Prerequisite

* Download a Cortex Cloud Broker VM VHD (Azure) image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

#### Note

* Extraction can take up to a few hours.

* Upload can take up to a few hours.

* For more information, see the Azure Documentation.

* Creating the VM can take up to 15 minutes. The Broker VM Web UI is not accessible during this time.

* For more information on creating a rule in an Azure VM, see Create a Security Rule in the Azure Documentation.

  20.1.2.1.7. Set up Broker VM on Nutanix Hypervisor

#### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

#### Note

* Saving the image to Nutanix hypervisor can take time as it's a large file. We recommend verifying periodically that the connection is alive for the upload process to finish successfully.

* Creating the VM can take up to 15 minutes. The Broker VM Web user interface is not accessible during this time.

  20.1.2.1.8. Set up Broker VM on VMware ESXi using vSphere Client

#### Prerequisite

* Ensure you have a virtualization platform installed that is compatible with an OVA image, and have an authenticated user account. Download a Cortex Cloud Broker VM OVA image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  20.1.2.2. Broker VM data collector applets

  20.1.2.2.1. Activate DSPM Fileshare

#### Prerequisite

* Set up and configure Broker VM Know the complete path to the files and folders that you want Cortex Cloud to monitor. Necessary user permissions to access the network shares. For the SMB connection type, you need the user name and password.

#### Note

* The applet list displays only the applets for which you have permissions.

* By default, all configured connections are saved.

* For details regarding the connection fields, see the table above under File Share Connection.

* You can add multiple connections under a single instance of the DSPM Fileshare applet by returning to the File Share Connection screen and clicking Add Connection. Each new connection can be of either the NFS or SMB connection type.

  20.1.2.2.2. Activate Registry Scanner

#### Prerequisite

* To initialize registry scanning on your Broker VM, you must first add the necessary data connectors. For details, see:    Connect Docker Hub registry   Connect Docker V2 compliant container registry   Connect GitLab container registry   Connect Harbor registry   Connect JFrog container registry   Connect Sonatype Nexus registry To initialize registry...

#### Note

* You cannot activate the Registry Scanner directly on a new or existing Broker VM. You can only activate or deactivate existing Registry Scanner applets. To activate or deactivate existing applets, see Step 4 under Verify Registry Scanner connection section.

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  20.1.2.2.3. Activate Transporter

#### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator) Set up and configure Broker VMSet up and configure Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex Cloud resources. The IP addresses...

#### Warning

* The Transporter applet is not supported for FedRAMP customers.

#### Navigation

  Settings → Configurations → Broker VMs (under Data Broker

  the Brokers tab → locate your Broker VM → hover and click + Add under the Apps column → AppSec Transporter

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

  20.1.3. Manage Broker VM

#### Note

* For more information on troubleshooting errors and warnings for these broker applets, see Troubleshoot Broker VM applet errors.Troubleshoot Broker VM applet errors

* Certain fields are also exposed in the Clusters tab, when a Broker VM node is added to a High Availability (HA) cluster, and each cluster node is expanded to view the Broker VM nodes table. An asterisk (*) is beside every field that is also included in the Broker VM nodes table for each HA cluster.

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  20.1.3.1. Edit Broker VM Configuration

#### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and lower, Cortex Cloud accepts only 172.17.0.0/16.

* Make sure you save the password before closing the window. The only way to re-generate a password is to disable ssh and re-enable.

  20.1.3.2. Increase Broker VM storage allocated for data caching

#### Note

* Follow your hypervisor documentation to understand how to add a persistent disk storage to your VM.

* If your disk is not listed and you didn't shutdown your Broker VM in your hypervisor before manually adding a disk to the VM, you'll need to reboot the Broker VM before the disk details are detected by the Broker VM. This can be performed either in the hypervisor or directly in the Broker VMs page.

#### Warning

* This operation is irreversible, and will make the disk become an integral part of the broker, where disconnecting the disk will result in errors and data loss.

  20.1.3.3. Monitor Broker VM using Prometheus

#### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* For more information on Docker, see the Docker website.

  20.1.3.4. Collect Broker VM Logs

#### Note

* The Download Logs (<TIMESTAMP>) is only displayed when you've downloaded your logs previously using Generate New Logs.

  20.1.3.5. Upgrade Broker VM

#### Important

* After a Broker VM upgrade, your broker may require a reboot to finish installing important updates. A notification about this will be sent to your Cortex Cloud console Notification Center.

  20.1.3.6. Import Broker VM Configuration

#### Important

* This option can only be used on Broker VMs with version 20.0 and later, and is only suitable for importing a configuration of brokers in the same version, or from a broker in an older version to a broker in a newer version.

* If your source Broker VM configuration includes a WEC applet, you'll need to ensure that you update the DNS record of this Broker VM's FQDN to point to the target Broker VM IP address.

  20.1.3.7. Open Live Terminal

#### Note

* You can either restart_routes or reboot the Broker VM for the changes in the /etc/network/routes file to take affect.

  20.1.3.8. Add Broker VM to cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  20.1.3.9. Switchover Primary Node in Cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  20.1.3.10. Remove from Cluster

#### Note

* If you've enabled a Load Balancer Health-Check on the cluster, you need to exclude this Broker VM from your Load Balancer settings.

  20.1.4. Broker VM High Availability Cluster

#### Note

* For Load Balancing, you must install a Load Balancer in your network, which will distribute the incoming data between the nodes.

* The following applets aren't supported when configuring Broker VMs in HA clusters: Cortex Network Scanner and Transporter.

  20.1.4.1. Configure High Availability Cluster

#### Prerequisite

* Be sure you do the following task before creating a cluster from an existing Broker VM: If the Broker VM is explicitly specified in some Agent Settings profile, which means Cortex Cloud agents retrieve release upgrades and content updates from this Broker VM, you must change the Broker VM's current designated role. To do this, you need to modify the...

#### Important

* You can only create a new cluster from an existing Broker VM, when the Broker VM version is 19.0 and later, and the STATUS is Connected. The Create a Cluster from this Broker option is only listed if the Broker VM is not already added to a cluster.

* When the Protocol is set to HTTPS, you may need to perform a few follow-up steps to establish a validated secure SSL connection with the Broker VM. If you're using your own Certificate Authority (CA) to sign the certificates, you'll need to place the CA in the client, such as the Load Balancer, and upload the certificates to the Broker VM. If you're...

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  20.1.4.2. Manage Broker VM clusters

#### Navigation

  After you've configured a cluster, you can manage all your Broker VM clusters from the Clusters tab on the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs → Clusters

  20.1.4.2.1. View cluster details

#### Note

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.Troubleshoot Broker VM applet errors

#### Navigation

  The Clusters tab of the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs) enables you

  20.1.4.2.2. Edit cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs, and select the Clusters tab

  20.1.4.2.3. Add applet to cluster

#### Note

* With Cortex XDR Prevent, it's only relevant to configure a HA cluster with a Local Agent Settings applet as this is the only applet supported for this product license. The other applets are collector applets, which are only available in Cortex XDR Pro or Cortex XSIAM.

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.Troubleshoot Broker VM applet errors

  20.1.4.2.4. Add Broker VM to cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  20.1.4.2.5. Remove cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  20.1.5. Broker VM notifications

  20.1.6. Monitor Broker VM activity

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  20.2. Dataset management

#### License Type

  Managing Roles requires an Account Admin or Instance Administrator role. For more information, see Predefined user roles.

#### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

#### Note

* Cold storage, in addition to a cold storage license, requires compute units (CU) to run cold storage queries. For more information on CU, see Manage compute units.

* Only datasets that are already handled as part of the GB license are supported for this license. In addition, the retention configuration is only available in Cortex Cloud, as opposed to the public APIs.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default. Datasets include dataset permission enforcements in the Cortex Query Language(XQL), Query Center, and XQL Widgets. For example, to view or access any of the endpoints and host_inventory datasets, you need role-based access control (RBAC)...

* You'll only be able to save the dataset view if the query contains no errors; otherwise, the Save button is disabled.

* For more information on user roles, see Manage user roles.

#### Important

* Cortex Cloud enforces retention on all log-type datasets excluding Host Inventory, Vulnerability Assessment, Metrics, and Users.

* This column is updated once a day. Therefore, if the dataset was created or updated by the target or lookup flows, it's possible that the Last Updated value is a day behind when the queries or reports were run as it was before this column was updated.

  20.2.1. What are datasets?

#### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

#### Note

* For more information on tasks specific to lookup datasets, see Lookup datasets.

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

#### Important

* By default, forensic datasets are not included in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  20.2.2. Lookup datasets

#### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

#### Note

* A lookup dataset can only be deleted if there are no other dependencies. For example, if a Correlation Rule is based on a lookup dataset, you wouldn't be able to delete the lookup dataset until you removed the dataset from the XQL query of the Correlation Rule.

#### Important

* When you create or add data to a lookup dataset using the target stage, the _time field won't be included by default unless you explicitly add it with the fields stage.

  20.2.2.1. Import a lookup dataset

#### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

* When uploading a CSV, TSV, or JSON file, ensure that the file meets the following requirements: The maximum size for the total data to be imported into a lookup dataset is 30 MB from the Dataset Management page. Otherwise, the limit is 50 MB using Cortex Query Language (XQL) or APIs. Field names can contain characters from different languages, special...

#### Important

* The name of a dataset created from a TSV file must always include the extension. For example, if the original file name is mrkdptusrsnov23.tsv, you can save the dataset with the name marketing_dept_users_Nov_2023.tsv.

  20.2.2.2. Download JSON file of lookup dataset

#### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

#### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  20.2.2.3. Set time to live for lookup datasets

#### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

#### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  20.2.3. Monitor datasets and dataset views activity

#### Prerequisite

* Dataset Management requires View/Edit RBAC permissions for Data Management (under Configurations → Data Management), which are the same permissions required for Parsing Rules, Data Model Rules, and Event Forwarding.

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  20.3. Manage compute units

#### Note

* For more information, see Import historical data into cold storage.Import historical data into cold storage

* The CU consumption of cold storage queries is based on the number of days in the query time frame. For example, when querying 1 hour of a specific day, the CU of querying this entire day is consumed. When querying 1 hour that extends past 2 days, such as from 23:50 to 00:50 of the following day, the CU of querying these two days is consumed.

  20.3.1. Compute units usage

#### Note

* To enable the add-on, select Settings  → Configurations → Cortex Cloud License → Addons tile, and select the Compute Unit tile and Enable.

#### Navigation

  Settings → Configurations → Data Management → Compute Unit Usage

  20.4. Manage instances

  20.4.1. Add a new data source or instance

#### Note

* If a data source contains multiple integrations, the integration configured as the default integration will used by the Data Onboarder. The default integration of the content pack is indicated in each content pack's documentation. The other integrations are available for configuration in the Data Sources & Integrations page after installing the content...

* If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant page in the system, for example Correlations, Playbooks, or Scripts. If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant...

  20.4.2. Manage cloud instances

#### Note

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  20.4.3. Update cloud permissions after Cortex release updates

#### Prerequisite

* Ensure that the user account used to modify permissions has the necessary privileges within both the Cortex platform and your cloud environment, for example, AWS or Azure. You received a notification regarding a new version available that requires permission updates, or viewed a Needs Update status in the Data Sources & Integrations page.

#### Note

* Instances requiring updates will not change their connection status, for example, Connected, Warning, Error, Disabled, due to the pending permission update.

  20.4.4. Pending cloud instances

  20.4.5. Manage Kubernetes Connector instances

#### Note

* After uninstalling the Kubernetes connector, the connector status updates to Not connected 48 hours after the uninstall process is initiated.

#### Navigation

  You can also manage the Kubernetes Connector instances from Inventory → Assets → Kubernetes Clusters

  20.4.6. Troubleshoot errors on cloud instances

#### Note

* Errors related to collection of audit logs in the cloud instance are recorded in the collection_auditing dataset. For more information, see Audit logs fields and query examples.

  20.4.7. Monitor serverless function scan health and status

  20.5. About health issues

#### Prerequisite

* For Cortex Cloud to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics.Enable the Analytics Engine and Identity Analytics

#### Note

* The Health Issues page displays issues that were triggered after July 2024. To see health issues that were triggered before this date, click Legacy Health Issues.

* Cortex Cloud enforces the dedup logic to health issues. This logic reduces the likelihood of identical health issues from flooding the issues dataset.

  20.5.1. Investigate and resolve health issues

21. Marketplace

  21.1. Cortex Marketplace

#### Navigation

  Settings → Configurations → Marketplace) or at Cortex Developer Docs Marketplace

  21.2. Content Pack Support Types

#### Note

* Palo Alto Networks is not liable for and does not warrant or support any content pack produced by a third-party publisher. Palo Alto Networks does not support content packs that do not have official available documentation.

  21.3. Cortex Cloud content

  21.4. Manage content packs

#### Note

* Optional content packs that are already installed are treated like they are required content packs to preserve content integrity.

* Cortex Cloud includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

* In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as scripts or integrations.

* Third-party product integrations are developed and tested against a specific product version. For products that are on-prem or cloud-based with specific API versions, the version developed and tested against will be included in the integration's documentation. Newer versions of the product are not always immediately tested, and it is expected that...

#### Caution

* If you want to downgrade, any content that depends on the content pack including any customizations may be deleted if it does not exist in the target content pack version.

* If another content pack is dependent on the content pack you want to delete, it may break the other content pack. You can reinstall the content pack, but you cannot restore detached and customized content.

#### Tip

* You can also find content packs that require updates by going to Settings → Data Sources & Integrations and filtering by Pack Version = Update Available. If you click on an integration in the filtered list, there is a link to the content pack in Marketplace for updates.

  21.5. Marketplace FAQs

  21.6. Content changes when upgrading Cortex Cloud versions

22. Cortex CLI

#### Note

* The CLI Read Only Role is not supported for CWP as the system does not support offline mode.

  22.1. Connect Cortex CLI

#### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

#### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources & Integrations →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Cortex Cloud Application Security, refer to Cortex CLI usage for Cortex Cloud Application Security

#### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source or Integrations page after selecting + Add New.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

  22.2. Cortex CLI common command line reference guide

#### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

  22.3. Cortex CLI for API Security

#### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more informationConnect Cortex CLI Ensure your application exposes APIs and provides a corresponding OpenAPI Specification file Ensure that you have installed Java v 11 and above

  22.3.1. Cortex CLI API Security command line reference guide

  22.4. Cortex CLI for Cloud Workload Protection

#### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more informationConnect Cortex CLI Verify that Java version 11 and above is installed: Run java -version in your terminal. If not, refer to Java SE Development Kit 11.0.25 for information...

* Before you begin, ensure you have sudo privileges to execute the image scan.

* For direct scanning from your Docker daemon, the image must already exist in your local Docker repository. The CLI will not pull a new image if it does not exist locally. To scan an image that exists in your local Docker daemon, simply provide its name: The image scan accepts the following arguments: --api-base-url: Required - true. The public facing API URL. Refer to Connect Cortex CLI for more informationConnect Cortex CLI --api-key: Required - true. Your Cortex Cloud API key. Refer to Connect Cortex CLI for more informationConnect Cortex CLI --api-key-id: Required - true. Your Cortex Cloud API key ID image scan: Required - true. Refers to CWP as the type of scan By default, Cortex Cloud looks for the Docker socket at unix:///var/run/docker.sock. --docker-host <path> specifies the path to the Docker socket. Use this flag if your Docker socket is located elsewhere, for example unix:///var/snap/docker/common/run/docker.sock. To scan an image from a previously saved archive file (such as a .tar file), use the --archive flag: This example demonstrates how to create an image archive from your Docker or Podman environment, which can then be used for scanning or SBOM generation if you choose not to scan directly from the local daemon. With Docker: docker save -o ubuntu.tar ubuntu With Podman: podman save --format oci-archive -o /tmp/alpine-oci.tar alpine:latest You can generate a Software Bill of Materials (SBOM) for your container images using the Cortex CLI and and save the output to a specified file. This functionality enables you to store the SBOM for further analysis, auditing, and compliance. By default, this will retrieve the SBOM for an image from your local Docker daemon. To get an SBOM for an image from your local Docker daemon: Command: cortexcli image sbom: Exports a Software Bill of Materials (SBOM) document for a container image archive. Usage: cortexcli image sbom [command options] --archive-format value: Specifies the image archive format. Values: docker-archive (default), oci-archive --output-format value: Specifies the SBOM document output format. Values: json (default), xml --output-file value: Specifies the path to the file where the SBOM document will be saved --fields value [--fields value]: Specifies the fields to include in the SBOM document. Multiple fields can be specified including: author, binaries, license, name, purl, sourcePackage, type, version --help, -h: Displays help information for the command To export an SBOM from an image archive file, use the --archive flag: NAME: cortexcli image sbom - Exports an SBOM document for an image from the local Docker daemon or an image archive. USAGE: cortexcli image sbom [command options] [image name or archive file]. Docker socket not reachable: If you encounter errors indicating the Docker socket cannot be reached, ensure the Docker daemon is running and verify the path to your Docker socket. If it's not in the default location (unix:///var/run/docker.sock), use the --docker-host flag to specify the correct path Image not found: If you attempt to scan an image directly from the Docker daemon and receive an error that the image does not exist, confirm that the image is indeed present in your local Docker repository by running docker images. The CLI will not pull images 22.4.1 |Cloud Workload Protection command line reference This reference guide documents the Cloud Workload Protection commands and flags for the Cortex CLI, including the structure of base commands and subcommands. Refer to Cortex CLI common command line reference guide for Cortex CLI commands common to all supported modules. 22.5 |Cortex CLI for Code Security PREREQUISITE: For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

#### Note

* CWP does not support container image secret scanning for systems running on ARM architecture.

* For available CWP commands, refer to Cloud Workload Protection command line reference.

* --archive: When used with image scan, sets the scan source to an archive file. When used with image sbom, indicates the SBOM should be exported from an archive file The --archive flag can also be explicitly set as --archive=true --archive-format <value>: The image archive format (such as docker-archive or oci-archive). Default: docker-archive.

  22.5.1. Cortex CLI usage for Cortex Cloud Application Security

  22.5.2. Cortex CLI Cortex Cloud Application Security command line reference

#### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

#### Important

* The Cortex CLI Cortex Cloud Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id...

23. Cortex Cloud XQL

  23.1. Get started with XQL

  23.1.1. XQL language features

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

#### Navigation

  You submit XQL queries to Cortex Cloud using the Investigation & Response → Search → Query Builder user interface

  23.1.2. XQL Language Structure

#### Note

* Specifying a dataset is not required because Cortex Cloud uses xdr_data as the default dataset. If you have more than one dataset or lookup, you can change your default dataset by navigating to Settings → Configurations → Data Management → Dataset Management, right-click on the appropriate dataset, and select Set as default.

* You can also build a query that investigates data in both a cold dataset and hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide. For more information on hot and cold storage, see Dataset management.

  23.1.2.1. Adding comments in queries

  23.1.3. Supported operators

#### Note

* In some cases, using an IN or NOT IN operator combined with a dataset and filterfilter stage can be a better alternative to using a join stage.

  23.1.4. Datasets and presets

#### Note

* To set up this Cloud Identity Engine (previously called Directory Sync Service (DSS)) dataset, you need to set up a Cloud Identity Engine. Otherwise, you will not have a pan_dss_raw dataset. For more information, see Set up Cloud Identity Engine.Set up Cloud Identity Engine

* INFO issues are not included in this dataset. The issue fields included in this dataset are limited to certain fields available in the API. For the full list, see Get Alerts Multi-Events v2 API.

* The fields contained in this dataset are a subset of the fields in the xdr_data dataset.

* If the vendor and product are not specified in the Winlogbeat profile's configuration file, Cortex Cloud creates a default dataset called microsoft_windows_raw.

* To ensure GlobalProtect access authentication logs are sent to Cortex Cloud, verify that your PANW firewall's Log Settings for GlobalProtect has the Cortex Data Lake checkbox selected.

* Prisma Access firewalls do not send configuration logs to the Structured Log Storage (SLS).

* You can query in XQL for this data and build widgets based on the xdr_data dataset or using the preset device_control. To view in an XQL query these events, the Device Configuration of the endpoint profile must be set to Block. Otherwise, the USB events are not captured. The events are also captured when a group of device types are blocked on the...

  23.1.5. About examples

#### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

  23.1.6. JSON functions

#### Important

* JSON field names are case sensitive, so the key to field pairing must be identical in an XQL query for results to be found. For example, if a field value is "TIMESTAMP" and your query is defined to look for "timestamp", no results will be found.

  23.1.7. How to filter for empty values in the results table

  23.1.8. Understanding string manipulation in XQL

  23.2. Build XQL queries

#### Note

* If you have the Cortex Agentic Assistant, you can use natural language prompts to create and run XQL queries within the chat interface. For more information, see Create and run XQL queries with Agentic Assistant chat.

  23.2.1. About the Query Builder

#### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

  23.2.2. How to build XQL queries

#### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex Cloud. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

#### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  23.2.2.1. Get started with XQL queries

  23.2.2.2. Useful XQL user interface features

#### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

  23.2.2.3. XQL Query best practices

  23.2.2.4. Expected results when querying fields

  23.2.2.5. Create XQL query

#### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined for the entire query, including queries that are part of the join stage. Yet, this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker...

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

  23.2.2.6. Review XQL query results

#### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* Results are received incrementally for the first 100K records, or up to 100MB worth of records, whichever comes first. After that, the next update is when the query has finished running completely.

* Real time query results are available only in the Query Builder and in free text query. Real time results are displayed only for queries run on hot datasets. The Sort option is available only after all the data is retrieved. When you formulate complex queries, the results will be displayed when the query has finished running completely, and not in real...

* In order for Cortex Cloud to provide a histogram for a field, the field must not contain an array or a JSON object.

  23.2.2.7. Translate to XQL

#### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

  23.2.2.8. Graph query results

#### License Type

  Building Cortex Query Language (XQL) queries in the Query Builder requires a Data Collection add-on.

#### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

  23.2.3. XQL query entities

  23.2.3.1. Create authentication query

#### Navigation

  Investigation & Response → Search → Query Builder

  23.2.3.2. Create event log query

#### Navigation

  Investigation & Response → Search → Query Builder

  23.2.3.3. Create file query

#### Navigation

  Investigation & Response → Search → Query Builder

  23.2.3.4. Create image load query

#### Navigation

  Investigation & Response → Search → Query Builder

  23.2.3.5. Create network connections query

#### Navigation

  Investigation & Response → Search → Query Builder

  23.2.3.6. Create network query

#### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

  23.2.3.7. Create process query

#### Navigation

  Investigation & Response → Search → Query Builder

  23.2.3.8. Create registry query

#### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

  23.2.3.9. Query across all entities

#### Navigation

  Investigation & Response → Search → Query Builder

  23.2.4. Overview of the Query Center

#### Note

* Very short queries might not be listed. You cannot cancel correlation queries. The default retention period for historic queries is aligned with issue retention.

  23.2.4.1. Edit and run queries in Query Center

#### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

#### Navigation

  Investigation & Response → Search → Query Center → Query History

  23.2.4.1.1. Query Center reference information

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  23.2.5. Manage scheduled queries

#### Navigation

  Investigation & Response → Search → Scheduled Queries

  23.2.5.1. Scheduled Queries reference information

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  23.2.6. Manage your query library

#### Note

* The Query to Library option is only available if your role has the Create Queries capability. For more information, see Manage access to saved queries.

* When the tenant-level setting Owners and editors can change the general access is unselected, the drop-down is disabled and only an administrator can configure this option.

#### Important

* The ability to create, edit, or share queries is governed by access management. If certain options are unavailable, contact your administrator. For more information, see Manage access to saved queries.

  23.3. Stages

  23.4. Functions

24. Graph Search

  24.1. What is Graph Search?

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  24.2. Get started with Graph Search queries

#### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

#### Navigation

  Understand your assets and findings data: Graph Search queries are based on the current data that has been collected for assets and findings from the data sources configured and then sent to the Unified Asset Inventory (UAI), which is displayed in the All Assets page (Inventory → Assets → All Assets

  24.3. How to build Graph Search queries?

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

#### Navigation

  You submit Graph Search queries using the Investigation & Response → Search → Query Builder → Graph Search built-in query interface

  24.4. Understand Graph Search query results

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  24.5. Create Graph Search query

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

#### Note

* For more information about the Query Library, see Manage the Graph Search Query Library.

#### Tip

* After running the query, you can view the complete query by hovering over the last THAT... in the Graph Search query interface, and the query is displayed in a tooltip. If your query doesn't find any results or you want to change your query for any reason, you can always click anywhere in the Graph Search query interface, where your existing query is...

  24.6. Graph Search examples

#### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Posture Security or Cloud Runtime Security add-on.

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  24.7. Manage the Graph Search Query Library

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

#### Navigation

  From Graph Search in the Query Builder Select Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Center

  24.8. Edit and run queries in Query Center

#### Note

* If query limits are applied to your tenant, the number of concurrent running queries is limited per user. If query usage is reaching the defined limit, a system message warns you that a high query load is impacting performance. If you exceed the limit, new queries are blocked until query usage drops. You can view all active queries under Query Center...

* You can cancel your own queries. To cancel queries run by other users, you must have View/Edit permissions for Configurations → Query Management. By default, Instance administrators have View/Edit permission.

* Cancelled queries show a Canceled status. You can see details of all canceled queries in the Query History tab. You cannot cancel correlation rule queries. If you cancel a scheduled query, only the current query is cancelled. Future recurrences of the scheduled query are not affected.

#### Navigation

  Investigation & Response → Search → Query Center → Query History

  24.8.1. Query Center reference information

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  24.9. Supported assets and findings

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

  24.10. FAQ on Graph Search

#### Prerequisite

* Graph Search requires View or View/Edit RBAC permissions for Graph Search under Investigation & Response → Search.

25. API specification inventory

#### Note

* Even if you have already imported the specification, you can edit the API specification in Cortex Cloud and add or update the server list.

  25.1. Import API specification

#### Note

* Even if you already imported the file, you can edit the API asset and add or update the server list.
