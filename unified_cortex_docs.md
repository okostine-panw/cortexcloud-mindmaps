# Unified Cortex Cloud Documentation


## Cortex Cloud Posture Management Documentation


---

## 1. Get started with Cortex Cloud

### 1.1. What is Cortex Cloud?

#### 1.1.1. Key features

### 1.2. What is Cortex Cloud Posture Management?

### 1.3. Use the interface

### 1.4. Understand your user persona

### 1.5. Understand license plans

#### 1.5.1. Data retention

### 1.6. Fair Usage policy for Cortex Cloud

## 2. Onboard and configure Cortex Cloud

### 2.1. Plan and prepare

### 2.2. Deployment steps and checklist

#### 2.2.1. Activate Cortex Cloud

##### Prerequisite

* The Cortex Cloud activation email. A Customer Support Portal (CSP) account. You need to set up your CSP account. For more information, see How to Create Your CSP User Account. When you create a CSP account, you can set up two-factor authentication (2FA) to log into the CSP by using an Email, Okta Verify, or Google Authenticator (non-FedRAMP accounts)....

##### Note

* Activation can take about an hour and does not require you to remain on the activation page. Cortex Cloud sends a notification to your email when the process is complete.

* You can only change the subdomain once, and it cannot be undone. After deleting the subdomain, you can reuse it after 7 days.

##### 2.2.1.1. Bring your own keys

###### Prerequisite

* Access to BYOK (Bring Your Own Keys) functionality is restricted to tenants that were initially activated with BYOK.

* To disable your encryption keys and deactivate a tenant, you must have an Account Admin role.

###### Note

* To enable the feature in your tenant, contact your account representative.

* The new keys you import will serve as primary encryption keys for newly generated data.

* At any stage, you can select Continue Later to pause the process. To resume the process, in the Cortex gateway, select Continue Setup next to the tenant, and follow the wizard instructions from the point you left off, as detailed below. If you don't use either of your wrapping keys within three days, they expire and you'll have to restart the process.

* BYOK requires a 32-byte, symmetric, unencoded key in binary format.

###### Caution

* Disabling all encryption keys and deactivating the tenant renders the tenant inaccessible and non-operational. Disabling the keys affects the communication with the agents, may prevent the agents from receiving updates to policies, configurations, and crucial information, and may result in loss of data. To secure your tenant data and to prevent...

##### 2.2.1.2. Cortex Cloud supported regions

##### 2.2.1.3. Enable access to required PANW resources

###### Note

* <tenant-name> refers to the selected subdomain of your Cortex Cloud tenant, and <region> is the region in which your tenant is deployed. For more information, see Cortex Cloud supported regions.

#### 2.2.2. Upgrade from Prisma Cloud to Cortex Cloud

##### 2.2.2.1. Overview

###### Note

* Your Prisma Cloud tenant remains available and fully operational during the agreed upgrade period.

##### 2.2.2.2. Link Cortex Cloud to Prisma Cloud

###### Navigation

  Settings → Configurations → Upgrade Helper

##### 2.2.2.3. Copy content

###### Navigation

  Settings → Configurations → Upgrade Helper

###### 2.2.2.3.1. Copy Global configurations

####### Note

* Scope-Based Access Control (SBAC) configurations, such as resources or account lists are not copied. You can manually assign scope-based access to the relevant users or groups.

####### Navigation

  Settings → Configurations → Access Management

###### 2.2.2.3.2. Copy CSPM configurations

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

  Posture Management → Rules & Policies → Policies → Cloud Security

  Investigation & Response → Automation → Automation Rules

  Posture Management → Compliance → Standards

###### 2.2.2.3.3. Copy CWP configurations

####### Navigation

  Posture Management → Rules & Policies → Cloud Workload

##### 2.2.2.4. Migrate Cortex CLI

###### Prerequisite

* Before you begin, ensure you have the following: Ensure you have an active API key for your Cortex Cloud tenant with associated CLI role permissions. Refer to Manage API keys for more information Install the Cortex CLI. You can find the installation instructions here

#### 2.2.3. Set up users and roles

##### Note

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* The user who activated the Cortex product is assigned the Account Admin role. You cannot create additional Account Admin roles in the Cortex Cloud tenant. If you do not want the user to have Account Admin permission, you must remove the Account Admin role in Cortex Gateway.

##### 2.2.3.1. User group management

###### Note

* You can create user groups in the tenant or Cortex Gateway. User groups created in Cortex Gateway cannot be mapped to SAML groups. Only user groups created in the tenant support SAML group mapping and scoring. We recommend creating user groups in the Cortex tenant because: User groups are available for all tenants, and you may want different user...

* If users have been created in the CSP, but you want them to access the tenant through SSO only, skip this field and add only SAML group mapping after SSO is set up, otherwise, users can access the tenant through both the CSP and SSO. If you have not yet created any users, skip this field and add them later. See Set up authentication .

* When using Azure AD for SSO, the SAML group mapping needs to be provided using the group object ID (GUID) and not the group name.

###### Important

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

##### 2.2.3.2. Assign user roles and groups

###### Note

* If an existing user in the Cortex Gateway no longer has a role or a user group assigned, the user is revoked. Any roles, user groups, or egress configurations created by that user are shown as created by Revoked user instead of the user's email address.

###### Important

* Setting Cortex Query Language (XQL) dataset access permissions for a user role can only be performed from Cortex Cloud Access Management. For more information, see Manage user roles.

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit Users Permissions.

#### 2.2.4. Manage API keys

##### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

* You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

#### 2.2.5. Set up authentication

##### Tip

* You should have at least one user in the Customer Support Portal for backup, in case of any authentication issues with your IdP provider.

##### 2.2.5.1. Authenticate users through the Customer Support Portal

###### Note

* You must be assigned the Super User role in the Customer Support Portal to add users in the Customer Support Portal. The first Super User who logs into Cortex Gateway is automatically assigned the Account Admin role and has access to the tenant. The user who activates the Cortex Cloud tenant will also be assigned the Account Admin role (if there is no...

* After users are added to the Customer Support Portal and they accept the invitation, you can manage them in Cortex Gateway or the Cortex Cloud tenant.

##### 2.2.5.2. Authenticate users using SSO

###### Note

* To set up SSO authentication in the tenant, you must be assigned an Instance Administrator or Account Admin role. SAML 2.0 users must log in to Cortex Cloud using the FQDN (full URL) of the tenant. To allow login directly from the IdP to , you must set the relay state on the IdP to the FQDN of the tenant. If you have multiple tenants, you must set up...

* The first SSO cannot be deleted, it can only be deactivated by toggling SSO Enabled to off. The Domain parameter is predefined for the first SSO. If you add additional SSO providers, you must provide the email Domain in the SSO Integration settings for all providers except the first. Cortex Cloud uses this domain to determine to which identity provider...

* Cortex Cloud requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex Cloud. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a...

##### 2.2.5.3. Set up Okta as the Identity Provider Using SAML 2.0

###### Note

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

##### 2.2.5.4. Set up Azure AD as the Identity Provider Using SAML 2.0

###### Note

* The default attributes shown on the main single sign-on page in Azure AD are not the values you need. You must click Edit next to Attributes and Claims to view and copy the actual values.

* The attribute claim name must exactly match the value sent by your IdP. In some cases, this may be the full attribute name/namespace, depending on the configuration of our IdP

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Important

* When copying the Single Sign-On URL value, remove idp/saml and leave the trailing /. For example, if the Single Sign-On URL is https://clientname.panproduct.region.paloaltonetworks.com/idp/saml, just copy https://clientname.panproduct.region.paloaltonetworks.com/.

#### 2.2.6. Ingest cloud assets

##### Note

* The cloud accounts being onboarded must be owned by the customer performing the onboarding process.

##### 2.2.6.1. Onboard Google Cloud Platform

###### Prerequisite

* Before you begin, ensure you have: Access to Google Cloud Console Admin user with required admin GCP permissions Enabled the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled) Enabled the following APIs in the GCP project you are...

###### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only modify the instance from the Data Sources page.

###### 2.2.6.1.1. Manually upload template to GCP

####### Prerequisite

* Before you begin, ensure you have: A GCP account. Permission to create the required resources in Google Cloud Deployment Manager. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool.

####### Note

* The directory you create must be a subdirectory of the home directory.

###### 2.2.6.1.2. Configure GCP integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

###### 2.2.6.1.3. Monitor GCP resources inside service perimeters

####### Note

* Each GCP cloud instance is assigned a scope within GCP. If the scope, whether it be organization, folder, or project, includes any projects with a service perimeter, this procedure must be performed for that cloud instance to authorize Cortex Cloud to scan the resources in the perimeter.

##### 2.2.6.2. Onboard Amazon Web Services

###### Prerequisite

* Before you begin, ensure you have: Access to AWS Management Console Required AWS permissions

###### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* When onboarding an AWS organization or organizational unit (OU), Cortex Cloud creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

* See the prerequisites above for specific permissions required for serverless functions.

* If you select Automated, you must already be logged in to AWS.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only edit the instance from the Data Sources page. (AWS only) instances that were previously created in the Automation...

###### 2.2.6.2.1. Manually upload template to AWS

####### Prerequisite

* Before you begin, ensure you have: An AWS account Access to AWS Management Console Permission to create a stack and its resources in AWS CloudFormation

###### 2.2.6.2.2. Configure AWS integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

##### 2.2.6.3. Onboard Microsoft Azure

###### Prerequisite

* Before you begin, ensure you have: An Azure subscription Admin permissions required to onboard Azure or the built-in Security Administrator role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups.

###### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only modify the instance from the Data Sources page.

###### 2.2.6.3.1. Manually upload template to Microsoft Azure Resource Manager using the CLI

####### Prerequisite

* Ensure the Azure CLI tool is installed and you are authorized to create management group policies.

###### 2.2.6.3.2. Manually upload template for Microsoft Azure subscriptions

####### Prerequisite

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the subscription scope. We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed Terraform on your local machine. You can download Terraform from the official...

* Ensure the Azure CLI tool is installed and you are authorized to create management group policies.

###### 2.2.6.3.3. Configure Azure integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

##### 2.2.6.4. Onboard Oracle Cloud Infrastructure

###### Prerequisite

* Before you begin, ensure you have: Access to Oracle Cloud Infrastructure console Permissions for all of the following are required:    Creation of identity groups (for more information, refer to Managing Groups)   Policies (for more information, refer to How Policies Work)   Tag namespaces in the root compartment (for more information, refer to Tags...

###### Note

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only; you can only modify the instance from the Data Sources page.

###### 2.2.6.4.1. Manually upload template to OCI

####### Prerequisite

* Before you begin, ensure you have: An Oracle Cloud Infrastructure account and the tenancy OCID. Permission to deploy a custom template and create its resources in OCI. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed...

##### 2.2.6.5. Manually connect a cloud instance

##### 2.2.6.6. Outposts

###### Prerequisite

* Before you begin, ensure you have: An AWS account Permission to create a stack and its resources in AWS Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the AWS CLI tool and configured your profile with the aws...

* Before you begin, ensure you have: A GCP account Permission to create the required resources in Google Cloud Deployment Manager Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool

* Before you begin, ensure you have: An active Azure subscription. Installed the Azure CLI tool. Permission to deploy a custom template and create its resources in Microsoft Azure ("Owner" or "Contributor" on the designated outpost subscription scope, and Active Directory "Cloud Application Administrator" or "Application Administrator" privileged...

###### Note

* We recommend you use a dedicated account for the outpost, free from other resources. You can only onboard one outpost for each account.

* When creating an outpost for a specific Azure subscription, the outpost account must be in the same Azure organization as the monitored subscriptions.

###### Navigation

  Settings → Data Collection → Outposts

  You can create a new outpost by navigating to Settings → Data Collection → Outposts and clicking New Outpost

##### 2.2.6.7. Onboard the Kubernetes Connector

###### Note

* For GKE or EKS clusters with the metadata service disabled and for AKS clusters with non-default nodes managed resource group, the cluster resource identifier must be specified.

###### 2.2.6.7.1. What's new in Kubernetes Connector?

##### 2.2.6.8. Container Registry Scanning

###### 2.2.6.8.1. Overview of container registry scanning

####### 2.2.6.8.1.1. Registry Components

####### 2.2.6.8.1.2. How Container Registry Scanning Works

###### 2.2.6.8.2. Configure registry scanning

####### Prerequisite

* Ensure that you have performed the all steps till Additional Security Capabilities as listed in the onboarding wizard for the required CSP: Onboard Amazon Web Services Onboard Google Cloud Platform Onboard Microsoft Azure

###### 2.2.6.8.3. Modify the container registry scanning scope

###### 2.2.6.8.4. Scan re-evaluation process

###### 2.2.6.8.5. Connect Docker V2 compliant container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

####### Note

* Scanning is supported only for private repositories on Docker Hub.

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* FedRAMP is not supported for this mode.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.8.5.1. Manage a Docker V2 connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.8.6. Connect JFrog container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.8.6.1. Manage a JFrog connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

##### 2.2.6.9. Cloud service provider permissions

###### 2.2.6.9.1. Amazon Web Services provider permissions

###### 2.2.6.9.2. Google Cloud Platform provider permissions

###### 2.2.6.9.3. Microsoft Azure provider permissions

###### 2.2.6.9.4. Oracle Cloud Infrastructure provider permissions

### 2.3. Post-deployment steps

#### 2.3.1. Set up your environment

##### 2.3.1.1. Configure server settings

###### Note

* Keyboard shortcuts, timezone, and timestamp format are not set universally and only apply to the user who sets them.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

###### Navigation

  Settings → Configurations → General → Server Settings

##### 2.3.1.2. Configure security settings

##### 2.3.1.3. Log forwarding

###### 2.3.1.3.1. Forward logs from Cortex Cloud to external services

####### 2.3.1.3.1.1. Integrate a syslog receiver

######## Note

* Up to TLS 1.3 is supported. Make sure the self-signed CA includes your public key.

####### 2.3.1.3.1.2. Integrate Slack for outbound notifications

######## Note

* You are directed to the Slack browser to install Cortex Cloud. You can only use this link to install Cortex Cloud on Slack. Attempting to install from Slack Marketplace will redirect you to Cortex Cloud documentation.

####### 2.3.1.3.1.3. Configure notification forwarding

######## Prerequisite

* Before you can select a syslog receiver or a Slack channel, you must integrate these external services with Cortex Cloud. For more information, see: Integrate a syslog receiver Integrate Slack for outbound notifications

######## Note

* To configure notification forwarding for issues by domain, select Log Type = Issues and filter the Issues table by Issue Domain.

* When a notification is sent for each configured format.

####### 2.3.1.3.1.4. Monitor administrative activity

###### 2.3.1.3.2. Log notification formats

####### 2.3.1.3.2.1. Management audit log messages

####### 2.3.1.3.2.2. Issue notification format

####### 2.3.1.3.2.3. Agent Audit log notification format

####### 2.3.1.3.2.4. Management Audit log notification format

####### 2.3.1.3.2.5. Log format for IOC and BIOC issues

####### 2.3.1.3.2.6. Analytics log format

####### 2.3.1.3.2.7. Log formats

######## Note

* The FUTURE_USE tag applies to fields that Cortex Cloud does not currently implement.

#### 2.3.2. Manage user roles and access management

##### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

##### Note

* For more information on assigning user roles when generating an API key, see Manage API keys.

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* For features where scoping is not applicable, Role-Based Access Control (RBAC) is used and can be configured when managing user roles. For more information, see Manage user roles.

##### 2.3.2.1. Manage user access

###### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Note

* You can only reduce the permissions of an Account Admin user via Cortex Gateway.

* User permissions for components and datasets are based on the access permissions set in the user role. For more information on editing these user role permissions, see Manage user roles.

###### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit User Permissions.

###### Navigation

  Settings → Configurations → Access Management → Users

###### 2.3.2.1.1. User access reference information

##### 2.3.2.2. Manage user roles

###### Prerequisite

* Managing user roles in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Navigation

  Settings → Configurations → Access Management → Roles

##### 2.3.2.3. Manage user scope

###### Prerequisite

* Configuring user scopes in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles. By default, Enable Scope Based Access Control is...

###### Note

* This configuration can impact the visibility of the related Security domain in the Cases and Issues scope area, but with not affect asset visibility.

* For Cases and Issues domains, a workaround is to create a Dataset View for each required combination of domains, and allow the relevant entity access only to this Dataset View, not to the underlying cases and issues datasets.

* Make sure to assign the required default granular scoping for users. This depends on the structure and divisions within your organization and the particular purpose of each organizational unit to which scoped users belong.

###### Important

* Some areas and features in Cortex Cloud do not respect SBAC. In these cases, use RBAC permissions to restrict access.

* Before configuring, ensure that you review the Understand scoping section.

#### 2.3.3. Dashboards and reports

## 3. Review inventory and explore your cloud environment

### 3.1. Inventory management

#### 3.1.1. Asset management

##### 3.1.1.1. All Assets

###### Note

* Keep the following caveats in my mind when working with the Asset Inventory page: Instance Administrators are able to view all Inventory views without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope SBAC is not currently available for custom roles with View/Edit permissions on the...

* The options available are dependent on your license.

###### 3.1.1.1.1. Container Images

####### Navigation

  All Assets → Compute → Container Images

###### 3.1.1.1.2. Kubernetes Cluster

####### Navigation

  Inventory → All Assets → Compute → Kubernetes Cluster for a Kubernetes clusters assets overview

###### 3.1.1.1.3. External Surface assets

####### Note

* Cloud ASM data must be enabled before the External Surface asset inventory will populate. See Enable Cloud ASM.

###### 3.1.1.1.4. API specification inventory

####### Note

* Even if you have already imported the specification, you can edit the API specification in Cortex Cloud and add or update the server list.

####### 3.1.1.1.4.1. Import API specification

######## Note

* Even if you already imported the file, you can edit the API asset and add or update the server list.

##### 3.1.1.2. Serverless function assets

###### 3.1.1.2.1. Overview

####### Navigation

  To access serverless function assets, under Inventory, select All Assets → Compute → Serverless Functions

###### 3.1.1.2.2. Explore the serverless functions inventory

###### 3.1.1.2.3. Expanded serverless function asset information

####### Note

* For details of all serverless function issues generated by Cortex Cloud from vulnerability findings, refer to Serverless function usage.

##### 3.1.1.3. Network configuration

###### 3.1.1.3.1. Configure your network parameters

####### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

####### Navigation

  In Cortex Cloud , select Assets → Network Configuration → Internal Domain Suffixes

##### 3.1.1.4. Asset Groups

###### Note

* When you create or edit an Asset Group, the changes are applied immediately to new assets and to existing assets that have been updated. However, it may take a few hours for the changes to appear on existing assets that have not been updated.

###### Navigation

  Inventory → Assets → Groups → Add Group

##### 3.1.1.5. Vulnerability Assessment

###### Prerequisite

* The following are prerequisites for Cortex Cloud to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex Cloud lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex Cloud...

* The following are prerequisites for Cortex Cloud to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex Cloud collects all the information about the operating system and the installed...

###### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex Cloud Application Inventory.

###### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

###### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

## 4. Review and prioritize posture issues

### 4.1. Cases and issues

#### 4.1.1. What are cases?

##### 4.1.1.1. Issues

##### 4.1.1.2. Findings and events

#### 4.1.2. Case and issue domains

#### 4.1.3. Manage your cases

##### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

##### 4.1.3.1. Assign a case

##### 4.1.3.2. Case thresholds

##### 4.1.3.3. Link or unlink issues from a case

##### 4.1.3.4. Resolve a case

###### 4.1.3.4.1. Resolution reasons for cases and issues

####### Note

* Cases and issues resolved as True Positive and False Positive help Cortex Cloud to identify real threats in your environment by comparing future cases and associated issues to the resolved cases. Therefore, the handling and scoring of future cases is affected by these resolutions.

##### 4.1.3.5. Create a case

###### Note

* To create a case manually, you must have View/Edit permission for Cases and Issues selected under Settings → Configurations → Access Management → Roles → Components → Cases & Issues.

* This option is only relevant for certain domains.

* You can't attach files to manually created cases.

###### Tip

* The issues that you link to a case can be linked to multiple cases, and the issue domains do not need to match the case domain.

##### 4.1.3.6. Issue syncing

###### Prerequisite

* You must set up an integration before you can sync issues. For more information, see Set up an integration for mirroring issues.

###### Note

* Multiple tickets can be linked to an issue with outbound syncing. Issues with inbound syncing can be linked to a single ticket only.

* Using issue fields as variables is not currently supported.

* You can only define a single inbound profile. If you change the inbound sync profile the current profile is overwritten. You can define multiple outbound profiles; one issue can update multiple tickets.

* The inbound syncing flow runs every two minutes, and the outbound syncing flow runs every five minutes. In a bi-directional set-up, if the same field is updated in both tickets, the most recently updated value is used. In the external ticket, the logged history shows updates to the ticket. The user name that is logged with the history reflects the user...

* After an issue is resolved, ticket syncing remains active for up-to seven days. Therefore, you still update, change, or reopen the issue or external ticket and the tickets will continue to sync.

* If you change the selected inbound sync profile, the original sync profile is immediately overwritten.

###### Warning

* If you leave this field blank, all configured instances will be used.

###### Tip

* You can find a sync profile ID under Settings → Configurations → Object Setup → Issues → Sync Profiles. By default the ID field is not displayed in the table. Click the three dot menu and add it to the table layout.

###### Navigation

  Settings → Configurations → Data Sources and click Add Data Source

  Settings → Configurations → Data Collection → Automation & Feed Integrations

###### 4.1.3.6.1. Create a sync profile

####### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

#### 4.1.4. Prioritize cases with starring and scoring

##### 4.1.4.1. Case starring

###### Navigation

  Cases & Issues → Case Configuration → Starred Issues

##### 4.1.4.2. Case scoring

###### 4.1.4.2.1. Set up case scoring

####### Note

* For scoped users, a small lock icon indicates that you don't have permissions to edit a rule.

### 4.2. Investigation and response

#### 4.2.1. Investigate cases

##### 4.2.1.1. Overview of the Cases page

###### Note

* When an issue is resolved, it remains linked to a case and appears in this section. Once all of the issues in a case are resolved, the case is automatically closed.

###### Tip

* Set a default tab in the details pane by selecting the pin icon next to a tab.

###### 4.2.1.1.1. Saved table views

##### 4.2.1.2. Review and investigate a case

###### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

* In some cases, the number of issues associated with the techniques will not be aligned with the number of the parent tactic because of missing tags or in case an issue belongs to several techniques.

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

#### 4.2.2. Investigate issues

##### 4.2.2.1. Overview of the Issues page

###### Note

* Every 12 hours, the system enforces a cleanup policy to remove the oldest issues once the maximum limit is exceeded. The default issue retention period in Cortex Cloud is 186 days.

##### 4.2.2.2. Issue card

###### Note

* This section is context specific and shows data according to the issue context.

###### 4.2.2.2.1. Use the War Room in an investigation

####### Note

* The case War Room is usually used for communication capabilities, but unlike the issue War Room, it does not include playbook specific entries. The case War Room enables you to investigate an entire case, not just an issue.

* Cortex Cloud does not index notes and chats.

####### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

* You can use the up/down arrow buttons in the CLI to do a reverse history search for previous commands with the same prefix.

####### Navigation

  Investigation & Response → Automation → Playground

###### 4.2.2.2.2. Use the Work Plan in an investigation

##### 4.2.2.3. Triage and investigate issues

###### 4.2.2.3.1. Copy issues

###### 4.2.2.3.2. Run an automation on an issue

####### Note

* In addition to automation, some playbooks contain manual tasks that prompt the analyst for input. This enables you to enhance an automation workflow with analyst input.

* You can also manually select a playbook to run from the Issue Work Plan tab.

###### 4.2.2.3.3. Export issue details to a file

###### 4.2.2.3.4. Exclude an issue

###### 4.2.2.3.5. Query case and issue data

####### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

###### 4.2.2.3.6. Update issue fields

####### Note

* You must create a custom status before you can select it.

####### Tip

* You can create custom issue statuses and resolution reasons, and use the setIssueStatus command to set these custom statuses for issues. For example, when a user starts investigating an issue, the issue status is automatically changed from New to Under Investigation. In some cases, it is useful to create an interim status, such as Triage. After you...

#### 4.2.3. Investigate findings

##### 4.2.3.1. Findings card

###### Note

* The information in this card is context specific, therefore some sections are not available for all findings.

#### 4.2.4. Investigate artifacts and assets

##### 4.2.4.1. Investigate an IP address

###### Note

* Requires a license key. Select Settings → Configurations → Integrations  → Threat Intelligence.

##### 4.2.4.2. Investigate an asset

###### Note

* The Asset view is available for hosts with a Cortex XDR agent installed.

##### 4.2.4.3. Investigate a file and process hash

###### Note

* Requires a license key. Go to Settings → Configurations → Integrations  → Threat Intelligence.

##### 4.2.4.4. Investigate a user

###### Note

* Cortex Cloud normalizes and displays case and issue times in your time zone. If you're in a half-hour time zone, the activity in the Normal Activity and the Actual Activity charts is displayed in the whole-hour time slot preceding it. For example, if you're in a UTC +4.5 time zone, the time displayed for the activity will be UTC +4.5, however, the...

###### Tip

* You can also see a list of all users under Assets → Asset Scores.

#### 4.2.5. Automation

##### 4.2.5.1. Automation in Cortex Cloud

###### Note

* You can build end-to-end automation workflows from within the playbook editor, including creating automation rules, configuring integration instances, and creating and editing tasks. For more information, see Playbooks.

##### 4.2.5.2. Quick Actions

###### Note

* When investigating an issue, in the Issues table, you can right-click to Run an Automation on one or more issues. For more information, see Manually run a playbook or Quick Action on one or more issues.

##### 4.2.5.3. Manage automation exclusion policies

###### Note

* For the IAM User Hard Remediation and User Soft Remediation policies, we recommend including username, email, and ID for each user you want to exclude. Example: username1, user@example.com, userID112.

* You can also right click on a policy from the main Automation Exclusion Center page to disable or enable the policy. If you click on a list name in the Exclude column, that list opens in the Lists page.

##### 4.2.5.4. Playbooks

###### 4.2.5.4.1. Playbooks overview

###### 4.2.5.4.2. Playbook development checklist

###### 4.2.5.4.3. Plan your playbook

###### 4.2.5.4.4. Manage playbooks

####### Note

* The library by default shows only playbooks that are not adopted. Click the Show Adopted checkbox to show the adopted playbooks, indicated by an Adopted mark. The library shows the most updated playbook version. Adopting an older version than shown should be done through Marketplace. Adopting a playbook does not make it run. Some content packs include...

###### 4.2.5.4.5. Build your playbook

####### 4.2.5.4.5.1. Task 1. Choose from existing playbooks or create your own

######## Tip

* If there are additional relevant playbooks in Marketplace that are not in your Org repository, you can click Explore them now to see them in the Playbook Catalog and choose to adopt.

* To open multiple playbooks at the same time, edit the first playbook and then click New next to the playbook name to create a new tab. You can either create a new playbook, or add an existing one. You can view recently modified or deleted playbooks by clicking version history for all playbooks .

######## Navigation

  the Investigation & Response → Automation → Playbooks page to customize or create a playbook

####### 4.2.5.4.5.2. Task 2. Configure playbook settings

######## Note

* If the playbook has inputs and outputs, the Playbook Starts task will show back and forth arrows. Clicking them opens the Playbook Settings pane Inputs/Outputs tab.

* This rule will trigger the playbook to run if no other Automation Rule triggers the playbook first. You can view and edit the order the rules run in the Automation Rules page.

* If you do not add any fields, the group will be deleted when you click Save.

####### 4.2.5.4.5.3. Task 3. Add objects from the Task Library

####### 4.2.5.4.5.4. Task 4. Add custom playbook features

####### 4.2.5.4.5.5. Task 5. Test and debug the playbook

####### 4.2.5.4.5.6. Task 6. Manage playbook content

###### 4.2.5.4.6. Test your playbook

####### Note

* The debugger does not support using parentIncidentFields.

* Using an existing issue in the debugger does not affect the original issue or change the original context data.

####### 4.2.5.4.6.1. Troubleshoot playbook performance

###### 4.2.5.4.7. Manage playbook content

###### 4.2.5.4.8. Best practices

####### Note

* If you reattach a detached playbook, any customizations you have made to the playbook will be overwritten when the playbook updates to the current version.

* Retries are not supported for data collection tasks that have errors sending emails (indicated by a server timeout). This is because retries only work on automation execution failures, not on email delivery issues.

##### 4.2.5.5. Create an automation rule

###### Note

* You can also define the conditions that trigger a specific playbook in the playbook editor. For more information, see Task 2. Configure playbook settings

###### Important

* Automation rules apply to Medium and higher severity issues. They also apply to Low severity Analytic issues and Low severity ABIOC issues that are tagged with Identity or Cloud. Rules are evaluated in order, and only the first rule that matches the trigger conditions is executed.

##### 4.2.5.6. Scripts

###### 4.2.5.6.1. Use existing scripts

####### Navigation

  Investigation & Response → Automation → Scripts and in the Scripts Library search for the script you want to use

###### 4.2.5.6.2. Create a script

####### Note

* You can enable/disable a script in the Settings, without having to duplicate the script. You can view recently modified or deleted scripts by clicking the version history for all scripts .

####### Navigation

  Investigation & Response → Automation → Scripts and click New Script

###### 4.2.5.6.3. Change the Docker image in a script

####### 4.2.5.6.3.1. Connect an engine to an image registry

######## Note

* This procedure uses the --username and --password command line options to pass the username and password directly. For environments where command history or logs are visible to others, consider more secure methods like Docker configuration files for handling authentication in production or CI/CD environments. For more details, see docker login or...

##### 4.2.5.7. Context data

###### 4.2.5.7.1. Issue context data

###### 4.2.5.7.2. Case context data

###### 4.2.5.7.3. Search context data

###### 4.2.5.7.4. Add context data to an issue

###### 4.2.5.7.5. Add context data to a case

####### Note

* If you run the command in the issue War Room, the data is added to the following places: The case context data. The issue context data under the case tab. If you run the command in the Case War Room, the data is added to the case context data only.

###### 4.2.5.7.6. Delete context data from a case

###### 4.2.5.7.7. Use context data in a playbook

####### Caution

* Users with Trigger Playbook permissions on a given issue may still be able to modify the parent case via commands and scripts, even without full access to the case.

##### 4.2.5.8. Lists

###### Note

* The maximum list size is 209,715 characters (approximately 200 KB).

###### 4.2.5.8.1. Create a list

####### Note

* If you want to edit a list from a content pack, you need to duplicate or detach a list. Detached lists do not receive updated content in subsequent Cortex Cloud content releases. To retain an updated list, reattach it.

####### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

###### 4.2.5.8.2. List commands

###### 4.2.5.8.3. Use cases: JSON lists

####### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

  Investigation & Response → Automation → Playbooks → New Playbook

###### 4.2.5.8.4. Transform a list into an array

####### Navigation

  Investigation & Response → Automation → Playbooks and create or edit a playbook

##### 4.2.5.9. Integrations

###### 4.2.5.9.1. Integrations in Cortex Cloud

###### 4.2.5.9.2. Add an integration instance

####### Navigation

  Settings → Configurations → Data Collection → Automation & Feed Integrations and search for the integration

###### 4.2.5.9.3. Use integration commands in the CLI

####### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

###### 4.2.5.9.4. Troubleshoot Integrations

###### 4.2.5.9.5. Manage credentials

####### Navigation

  Settings → Configurations → Integrations → Credentials → New Credential

  Settings → Configurations → Data Collection → Automation & Feed Integrations and select the integration instance

##### 4.2.5.10. Engines

###### 4.2.5.10.1. What is an engine?

####### Note

* You cannot share a multiple-engine installation with a single-engine installation.

* When you add an engine to a load-balancing group, you cannot use that engine separately. The engine does not appear in the engines menu when configuring an integration instance, but you can choose the load-balancing group.

###### 4.2.5.10.2. Engine requirements

####### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

###### 4.2.5.10.3. Install an engine

####### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex Cloud engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

####### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

####### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

####### 4.2.5.10.3.1. Docker

######## Note

* This section is relevant when installing an engine.

* Docker images can be downloaded together with their relevant content packs for offline installation.

####### 4.2.5.10.3.2. Podman

######## Note

* When upgrading an engine, the engine keeps the previously used container management type (regardless of distribution version).

###### 4.2.5.10.4. Manage engines

###### 4.2.5.10.5. Upgrade an engine

###### 4.2.5.10.6. Remove an engine

###### 4.2.5.10.7. Configure engines

####### Note

* A day is defined as 24 hours and may not exactly correspond to calendar days due to daylight savings, leap seconds, etc.

* In addition, to support engine upgrades from the UI, edit the /usr/local/demisto/upgrade.conf file on the engine to include the SERVER_URLS setting with the new tenant's address. Include only the host, without https:// or any additional path at the end of the host name. For example: SERVER_URLS="api-example.us.paloaltonetworks.com"

* If the engine loses communication for longer than this time, it will disconnect and you need to restart the service.

####### 4.2.5.10.7.1. Configure the engine to use a web proxy

######## Note

* You need to configure Docker to use a proxy. When using a BlueCoat proxy, ensure you encode the values correctly.

* In an environment with a single engine, go to /usr/local/demisto/upgrade.conf. In an environment with multiple engines, go to /usr/local/demisto/<engine-name>/upgrade.conf, replacing <engine-name> with the name of the engine. Note that the key is in the upgrade.conf file and must be https_proxy, even if your proxy address starts with http://.

####### 4.2.5.10.7.2. Configure the engine to call the server without using a proxy

####### 4.2.5.10.7.3. Configure an engine to use custom certificates

###### 4.2.5.10.8. Use an engine in an integration

####### Note

* Long-running integrations should not run on load-balancing groups.

###### 4.2.5.10.9. Run a script using an engine

####### Navigation

  Investigation & Response → Automation → Scripts

###### 4.2.5.10.10. Troubleshoot engines

####### Note

* Ensure that pop-ups are not blocked by your browser.

* If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom path. --keep - Extracts the installer files into the current working directory (without cleaning at the end). If using installer...

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl status d1_<Engine _name>

* Any changes made to variables in the upgrade_engine.sh file are reset after each upgrade. We recommend instead using the upgrade.conf file to set variables.

* You can ignore the following error: Cannot create folder '/var/lib/demisto'

###### 4.2.5.10.11. Troubleshoot integrations running on engines

####### Note

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

* Docker CE installations typically run Docker, while Docker EE installations typically run dockerroot.

#### 4.2.6. Build XQL queries

##### 4.2.6.1. About the Query Builder

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

##### 4.2.6.2. How to build XQL queries

###### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex Cloud. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

###### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

###### 4.2.6.2.1. Get started with XQL queries

###### 4.2.6.2.2. Useful XQL user interface features

####### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

###### 4.2.6.2.3. XQL Query best practices

###### 4.2.6.2.4. Expected results when querying fields

###### 4.2.6.2.5. Create XQL query

####### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

###### 4.2.6.2.6. Review XQL query results

####### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* In order for Cortex Cloud to provide a histogram for a field, the field must not contain an array or a JSON object.

###### 4.2.6.2.7. Translate to XQL

####### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

###### 4.2.6.2.8. Graph query results

####### License Type

  Building Cortex Query Language (XQL) queries in the Query Builder requires a Data Collection add-on.

####### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### 4.2.6.3. XQL query entities

###### 4.2.6.3.1. Create authentication query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.2. Create event log query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.3. Create file query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.4. Create image load query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.5. Create network connections query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.6. Create network query

####### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

###### 4.2.6.3.7. Create process query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 4.2.6.3.8. Create registry query

####### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

###### 4.2.6.3.9. Query across all entities

####### Navigation

  Investigation & Response → Search → Query Builder

##### 4.2.6.4. Edit and run queries in Query Center

###### Navigation

  Investigation & Response → Search → Query Center

###### 4.2.6.4.1. Query Center reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 4.2.6.5. Manage scheduled queries

###### Navigation

  Investigation & Response → Search → Scheduled Queries

###### 4.2.6.5.1. Scheduled Queries reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 4.2.6.6. Manage your personal query library

###### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

#### 4.2.7. Quick Launcher

##### Note

* For hosts, Cortex Cloud displays results for exact matches but supports the use of wildcard (*) which changes the search to return matches that contain the specified text. For example, a search of compy-7* will return any hosts beginning with compy-7 such as compy-7000, compy-7abc, and so forth.

## 5. Review and report your security posture and progress

### 5.1. Monitor dashboards and reports

#### 5.1.1. About dashboards

##### Note

* You cannot edit the predefined dashboards but you can create a new dashboard that is based on a dashboard template. In addition, private dashboards can only be viewed, edited, and deleted by the dashboard creator.

* Dashboards that are based on custom infrastructure cannot be exported. If you import a dashboard template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

##### 5.1.1.1. Command Center dashboards

###### Note

* Access to the dashboards requires RBAC View permissions for Dashboards & Reports and Command Center Dashboards. The dashboards are available in dark mode only. They are not editable, and you can't create dashboard templates or reports from them. Some of the dashboard's animations are not fully supported by the Safari web browser. We recommend that...

###### 5.1.1.1.1. Cloud Security Command Center

####### 5.1.1.1.1.1. Cloud Security Command Center

######## Note

* The Cloud Security Command Center dashboard is currently only available by default to users with the Instance Administrator and Viewer roles. Custom roles, which include the Cloud Security Command Center View/Edit role permissions, also have access.

###### 5.1.1.1.2. Cloud Security Operations

####### 5.1.1.1.2.1. Cloud Security Operations

######## Note

* Command Center data may not match the counts on the Issues page and you may observe inconsistencies. This is because dashboard data is a snapshot of issues identified, whereas the Issues page provides the most up to date view of risks across your cloud assets. In addition, the Issues pages does not support all the currently available filters on the...

##### 5.1.1.2. Predefined dashboards

###### Note

* Users can access all information on the dashboard when their user access is scoped to view All assets or assigned to the Instance Administrator role. Otherwise, users with granular scoping set to No assets or Select asset groups will have limited access to the dashboard. For more information on Scope-Based Access Control (SBAC), see Manage user...

##### 5.1.1.3. Reports

###### 5.1.1.3.1. Report templates

#### 5.1.2. Build custom dashboards and reports

##### 5.1.2.1. Build a custom dashboard

###### Note

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

##### 5.1.2.2. Manage your Widget Library

###### Note

* Any dashboards or reports that include the widget are affected by the changes.

#### 5.1.3. Fine-tune dashboards and reports

##### 5.1.3.1. Create a custom widget using a script

###### Note

* If you have added arguments to the script, these appear when creating a widget.

* Available options are Pie, Column, Line, and Single Value. To display the result of the script as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### 5.1.3.1.1. Script-based widget examples

####### Note

* Add the widget tag in the script settings to make the script available for use in script-based widgets. For more information, see Create a script.

* If your script returns a time duration, configure the widget with the graph type Single Value and enable Show as Time..

##### 5.1.3.2. Create custom XQL widgets

###### Note

* Cortex Query Language (XQL) queries generated from the Widget Library do not appear in the Query Center. The results are used only for creating the custom widget.

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### Tip

* You can create a generic dashboard for multiple views of the same dataset by defining the dataset in the XQL widget as dataset = <dataset_name>*. The placement of the asterisk (*) in the dataset name ensures that any view containing this prefix text is displayed in the results. The dataset in a query is defined as: If there are multiple datasets that...

###### Navigation

  All of your predefined and custom XQL widgets are available in the Widget Library under Dashboards & Reports → Customize → Widget Library

###### 5.1.3.2.1. Configure filters and inputs for custom XQL widgets

####### Prerequisite

* Fixed filters are based on parameters that are defined in custom XQL widgets. Before you can configure fixed filters, take the following steps: Create custom XQL widgets with parameters. For more information, see Create custom XQL widgets. Add the widgets to a Custom dashboard. For more information, see Build a custom dashboard.

####### Note

* If you specify more than one field, only the first field value is used.

####### Tip

* After the initial setup, when you access your dashboard the filters and inputs might need further refinement. You can make changes to the configured parameters in the XQL widgets, and update the Filters & Inputs on your dashboard until you are satisfied with the results.

###### 5.1.3.2.2. Configure dashboard drilldowns

####### Prerequisite

* To configure drilldowns your dashboard must contain custom XQL widgets. In addition, if you want to configure in-dashboard drilldowns your custom XQL widget must contain one or more parameters. For more information about configuring parameters in custom XQL widgets, see Create custom XQL widgets.

####### Note

* If the selected parameter is configured in other XQL widgets on the dashboard, these widgets are also affected by the drilldown.

####### 5.1.3.2.2.1. Variables in drilldowns

#### 5.1.4. Run or schedule reports

##### Note

* Report templates that are based on custom infrastructure cannot be exported. If you import a report template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

* The report name and description will be displayed in the report header and are not editable during customization.

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

##### Navigation

  Dashboards & Reports → Customize → Report Templates

  Dashboards & Reports → Customize → Dashboards Manager

  Under Settings → Configurations → General → Notifications, click + Add Forwarding Configuration

## 6. Monitor and track compliance adherence

### 6.1. Cortex compliance flow

### 6.2. Choose compliance standards from the compliance Catalog

#### Navigation

  Cortex provides lists of available standards and controls in the Standards and Controls catalogs under Posture Management → Compliance → Catalogs

#### 6.2.1. Standards Catalog

##### 6.2.1.1. Use a built-in or custom standard

#### 6.2.2. Controls catalog

##### 6.2.2.1. Use a built-in or custom control

###### 6.2.2.1.1. Add a custom detection rule to a custom control

####### Note

* Only custom detection rules (not built-in) can be assigned to custom controls.

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

###### 6.2.2.1.2. Create a new Custom Detection Rule

####### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

####### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

### 6.3. Use assessment profiles to run compliance checks on your assets

#### Note

* You can view the list of built-in asset groups under Inventory → Assets → Groups, where the MODIFIED BY column shows Palo Alto Networks. While you can edit or delete these asset groups, we do not recommend it. Doing so may cause inaccurate or inconsistent assessment results.

### 6.4. View and manage compliance assessments and reports

#### Note

* Compliance assessment results may take up to six hours to be generated.

#### 6.4.1. Assessments

##### Note

* If there are no rules associated with the control, the control will be assigned a severity of low.

#### 6.4.2. Reports

##### Navigation

  The Posture Management → Compliance → Results → Reports page shows a table listing compliance assessment report files

## 7. Discovery Engine

### 7.1. What is the Discovery Engine?

## 8. Cortex Cloud AI Security

### 8.1. What is Cortex Cloud AI Security?

### 8.2. Supported services in Cortex Cloud AI Security

### 8.3. Cortex Cloud AI Security concepts

### 8.4. Cortex Cloud AI Security use cases

### 8.5. How to perform advanced AI Security investigations using XQL

#### Note

* For more information, see Build XQL queries.

## 9. Cortex Cloud Application Security

### 9.1. Application Security Posture Management (ASPM)

#### 9.1.1. ASPM use cases

#### 9.1.2. ASPM key features

#### 9.1.3. ASPM user roles and permissions

##### Navigation

  You can view AppSec Admin permissions in the tenant by navigating to Settings → Configurations → Roles → AppSec Admin

#### 9.1.4. ASPM Command Center

##### 9.1.4.1. ASPM Command Center workflow

###### Note

* Breakdown by type: Issues are further broken down by type (such as IAC or Secrets).

#### 9.1.5. Coverage

##### 9.1.5.1. Coverage in the user interface

###### Navigation

  Modules, → Application Security → AppSec Coverage

#### 9.1.6. Backlog baseline

##### 9.1.6.1. Backlog use cases

##### 9.1.6.2. Issue/Finding classification by scanner

###### Note

* In some cases/vendors, this is not accurate as findings are deleted every time new findings are uploaded. In such cases, the feature may not be accurate or supported For SAST, the vendor does not support policy in pull requests

* Scanner updates and new detections: When a security scanner is updated to support new languages, detection rules, or capabilities, any issues discovered by these new features for existing code are classified as part of the backlog.

##### 9.1.6.3. Using Backlog

#### 9.1.7. Applications

##### 9.1.7.1. How to build an application

###### Prerequisite

* Before you begin, ensure you have connected the necessary data sources. Refer to Onboard data sources for more information.

###### Note

* These filters are represented by icons displayed on the Code pane after selecting a VCS.

* To edit application assets, click the Clear All icon before clicking Finish. This clears all application data, allowing you to restart the application building process from the beginning.

##### 9.1.7.2. Application management and visibility

##### 9.1.7.3. Business application assets

###### 9.1.7.3.1. Business application expanded asset details

####### Note

* The topology graph is available only when all application components (code, pipeline, build and deploy), are configured.

#### 9.1.8. Repositories as assets

##### 9.1.8.1. Explore repository assets

##### 9.1.8.2. In-depth repository asset information

##### 9.1.8.3. Manage Repository assets

##### 9.1.8.4. Export Software Bill of Materials (SBOM)

##### 9.1.8.5. Manage issues detected in repositories

###### Note

* You can also find the repository issues in the general issue inventory table, and in the dedicated inventory of issues for each scanner type (see step 4 above for details).

#### 9.1.9. Onboard data sources

##### 9.1.9.1. Onboard version control systems

###### Note

* Cortex Cloud Application Security (which includes IaC and Secrets scanning), is an add-on to a license (such as Posture Security) that must be purchased separately.

* Disclaimer: When onboarding with third-party data sources, we outline the required steps for setup, but we do not monitor these external resources, and they may change over time. Always refer to the relevant third-party documentation for the most current integration steps.

###### Tip

* Navigate to Settings → Data Sources (under Data Collections) → + Data Source → enter your VCS data source in the search bar.

###### 9.1.9.1.1. AWS CodeCommit

####### Prerequisite

* Before you begin: Authorize the user integrating Cortex Cloud Application Security with your AWS CodeCommit instances with the following permissions:       Read more...        codecommit:GitPull: Allows users to pull Git repository changes   codecommit:ListBranches: Grants the ability to list branches within a repository   codecommit:GetBranch:...

####### Note

* Select Connect Another Instance if an instance has already been configured.

* The Resource Name Prefix and ExternalID fields are pre-populated. You can modify the Resource Name Prefix, but DO NOT change the ExternalID!

* To create an additional AWS CodeCommit instance: Hover over the AWS CodeCommit card in the catalog and click Connect Another.

###### 9.1.9.1.2. Azure Repos

####### Prerequisite

* Before you begin: Authorize the user integrating Cortex Cloud Application Security with your Azure Repos instances with the following permissions and scopes.      Permission   Description       Project Administrator   This permission is required to subscribe to webhooks. For more information, refer to the Microsoft Integrate with service...

####### Note

* Select Connect Another Instance if an instance has already been configured.

* For information on Cortex Cloud Application Security access to all organizations associated with your user token, refer to the Azure Third party application access via OAuth documentation.

* To create an additional Azure Repos instance: Hover over the Azure Repos card in the catalog and click Connect Another.

####### Caution

* Do not limit authorization scope.

###### 9.1.9.1.3. Bitbucket Cloud

####### Prerequisite

* Before you begin: Authorize the user with the following required permissions and scopes to integrate Cortex Cloud Application Security with your Bitbucket Cloud instances.  Note For write access, go to Bitbucket > Repository Settings and grant the user write access to the relevant repositories.     Permissions    Repository Administrator: To scan pull...

####### Note

* Select Connect Another Instance if an instance has already been configured.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Cloud instance: Hover over the Bitbucket Cloud card in the catalog and click Connect Another.

###### 9.1.9.1.4. Bitbucket Data Center

####### Prerequisite

* Before you begin: Authorize the user integrating Cortex Cloud Application Security with your Bitbucket Data Center instances with the following permissions:    Member of Project Collection Administrators: Required to subscribe to the build.complete event and download the permissions report for CI/CD scans. As Organization owners are automatically part...

####### Note

* By default, the permissions of the access token are set according to your current access level. It is essential to define two levels of permissions, Project and Repository permissions. The Repository permissions inherit from Project permissions, requiring Repository permissions to match or exceed Project permissions Providing read and write permissions...

* For additional security, it is recommended to set an expiry automatically. The expiry date of a token cannot be changed after it is created. You can see the expiry dates for all your tokens on Profile picture → Manage account → Personal access tokens.

* Select Connect Another Instance if an instance has already been configured.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Data Center instance: Hover over the Bitbucket Data Center card in the catalog and click Connect Another.

####### Important

* Always refer to the Bitbucket documentation for information relating to creating a PAT.

###### 9.1.9.1.5. GitHub Cloud

####### Prerequisite

* Before you begin: Authorize the user integrating Cortex Cloud Application Security with your GitHub SaaS instances with the following permissions:    Read  access to Dependabot alerts, actions, actions variables, administration, deployments, discussions, metadata, packages, repository hooks, secret scanning alerts, secrets, and security events   Read...

####### Note

* Select Connect Another Instance if an instance has already been configured.

* To create an additional GitHub SaaS instance: Hover over the GitHub SaaS card in the catalog and click Connect Another.

###### 9.1.9.1.6. GitHub Server

####### Prerequisite

* Before you begin: Authorize the user integrating Cortex Cloud Application Security with your GitHub Server instances with the following permissions and scopes:    Permissions    Organization owner permissions   Administrator repository permissions: In order to scan pull requests (PRs), the user performing the integration must have administrative...

####### Note

* Select Connect Another Instance if an instance has already been configured.

* The domain is the hostname associated with your GitHub Server instance.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitHub Server instance: Hover over the GitHub Server card in the catalog and click Connect Another.

###### 9.1.9.1.7. GitLab SaaS

####### Prerequisite

* Before you begin: Authorize the user integrating Cortex Cloud Application Security with your GitLab SaaS instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including...

####### Note

* Select Connect Another Instance if an instance has already been configured.

* A repository can only be integrated with a single instance. The first instance that connects with the repository will be the one that the repository is assigned to. This means that if multiple integrations attempt to connect to the same repository, only the first integration to establish the connection will be associated with that repository.

* To create an additional GitLab SaaS instance: Hover over the GitLab SaaS card and click in the catalog and Connect Another.

###### 9.1.9.1.8. GitLab self-managed

####### Prerequisite

* Authorize the user integrating Cortex Cloud Application Security with your GitLab self-managed instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including all...

####### Note

* Select Connect Another Instance if an instance has already been configured.

* The domain is the hostname associated with your GitLab self-managed instance.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitLab self-managed instance: Hover over the GitLab self-managed card in the catalog and click Connect Another.

##### 9.1.9.2. Onboard CI/CD systems

###### 9.1.9.2.1. Onboard CircleCI for CI/CD pipeline scans

####### Prerequisite

* Before you begin: User requirements:    Permissions: To enable Cortex Cloud visibility for all CircleCI projects, a version control system (VCS) user with integration permissions must be authorized. This is because CircleCI's user base integrates with the VCS, inheriting its user permissions. For example, if a GitHub user has access to specific...

####### Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for code scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* To add an additional CircleCI instance, navigate to Settings → Data Sources → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

###### 9.1.9.2.2. Onboard Jenkins for CI/CD pipeline scans

####### Prerequisite

* Permissions Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

####### Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for code scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* The integration is added on the console but integration is pending, and will only be completed after completing step 5 below. You can view the pending integration on the Jenkins Instances page: Select Data Sources →  Jenkins → View Details. The type of integration is Pipeline Risks

* Always refer to the official Jenkins documentation when installing plugins on Jenkins servers.

* To add an additional Jenkins instance, navigate to Settings → Data Sources → select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps above.

##### 9.1.9.3. Integrate CI tools

###### Note

* For CircleCI CI/CD pipeline scans, refer to CI/CD .

* For Jenkins CI/CD pipeline scans, refer to CI/CD .

###### Navigation

  Settings → Data Sources → hover over a CI tool and click View Details

  Delete an instance: Right-click on an instance of the CI tool → Delete instance → Delete

###### 9.1.9.3.1. AWS CodeBuild

####### Prerequisite

* Before you begin: Grant Administrator  permissions to the user integrating AWS CodeBuild with Cortex Cloud Application Security Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress...

####### Note

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional AWS CodeBuild instance, navigate to Settings → Data Sources → select the menu for your connected AWS CodeBuild instance → + New Instance, and repeat the onboarding steps above.

###### 9.1.9.3.2. Onboard CircleCI for code scans

####### Prerequisite

* Before you begin: Grant Administrator permissions to the user integrating Cortex Cloud Application Security with CircleCI Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress...

####### Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for CI/CD scans, refer to...

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* To add an additional CircleCI instance, navigate to Settings → Data Sources → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

####### Important

* The cortex-secrets naming convention for the context is mandatory to ensure functionality and must not be changed.

###### 9.1.9.3.3. Connect Cortex CLI

####### Prerequisite

* Permissions: Grant the user installing the CLI required permissions. For more information refer to OverviewOverview Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress...

####### Note

* You can view the latest version of the selected OS.

* Recommended: Select With upload results permissions before generating the API key. This option grants the key permission to not only access data but also to upload or send data back. In the API Keys page, the role associated with these permissions is CLI. If you choose to upload without results permissions, the associated role is CLI Read Only Warning:...

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

####### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter 'CLI' in the search bar to locate the Cortex CLI tool.

###### 9.1.9.3.4. GitHub Actions

####### Prerequisite

* Before you begin: Grant Administrator  permissions to the user integrating GitHub Actions with Cortex Cloud Application Security Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress...

####### Note

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional GitHub Actions instance, navigate to Settings → Data Sources → select the menu for your connected GitHub Actions instance → + New Instance, and repeat the onboarding steps above.

###### 9.1.9.3.5. Onboard Jenkins for code scans

####### Prerequisite

* Grant Administrator permissions to the user integrating Cortex Cloud Application Security with Jenkins Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

* For Cortex Cloud Application Security CI tools, you must store secrets in Jenkins Credentials for use in your Jenkins pipelines using either of these methods:    Plain text storage: Store secrets directly as plain text in Jenkins Credentials. Access them in your pipeline using the credentials function, which retrieves the secret directly as plain...

####### Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for CI/CD scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* This step is only required for new pipelines For private repositories, ensure the necessary credentials are configured in Jenkins Credentials

* This ensures your build runs within a Docker environment. If a node without Docker is used, the build will fail.

* To add an additional Jenkins instance, navigate to Settings → Data Sources →  select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps.

###### 9.1.9.3.6. Onboard Terraform Cloud (Run Tasks)

####### Prerequisite

* Before you begin: Procure a Terraform cloud license that is either a trial license or a TF Cloud license at the TEAM & GOVERNANCE level Grant the user or team the following permissions, depending on integration:    Manage Workspaces permissions at the organization level. These permissions are required to attach and manage the run task on workspaces...

####### Note

* * Cortex Cloud Application Security performs Image Referencer scans for container image vulnerabilities, as full SCA scans are not supported for Terraform Enterprise (Run Tasks).

* Skip this step if you plan on using an existing token.

* Select Connect Another Instance if an instance has already been configured.

* Cortex Cloud Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Cloud (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected your Terraform Cloud (Run Tasks) instance → + New Instance, and repeat the onboarding steps.

###### 9.1.9.3.7. Onboard Terraform Enterprise (Run Tasks)

####### Prerequisite

* Before you begin: Ensure access to a Terraform Enterprise console to enable you to provide a user or team token that authorizes Cortex Cloud Application Security to access workspaces and helps regulate run configurations Terraform Enterprise version compatibility: Ensure Run Tasks for workspaces on is compatible with version 1.1.9 and above Terraform...

####### Note

* * For container image vulnerabilities, Cortex Cloud Application Security performs 'Image Referencer' scans within Terraform Enterprise (Run Tasks), as full SCA scans are not currently supported.

* Skip this step if you plan on using an existing token.

* Select Connect Another Instance if an instance has already been configured.

* Cortex Cloud Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Enterprise (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected Terraform Enterprise (Run Tasks) instance → + New Instance, and repeat the onboarding steps above.

##### 9.1.9.4. CLI pipeline code snippets

##### 9.1.9.5. Ingest third-party data

###### Note

* Only onboarded and scanned repositories can be mapped.

###### 9.1.9.5.1. Ingest Veracode SAST data

####### Prerequisite

* Permissions: The following user permissions are required:    Cortex Cloud: Instance Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions   Veracode: At minimum, Reviewer permissions are required Permissions: The following user permissions are required: Cortex...

####### Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between Veracode projects and Cortex Cloud Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped applications are ingested

###### 9.1.9.5.2. Ingest SonarQube SAST data

####### Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Generate and copy a SonarQube API token. Ensure to assign Web API scope to the API token. Refer...

####### Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between SonarQube Applications and Cortex Cloud Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

###### 9.1.9.5.3. Ingest Semgrep data

####### Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Create a Semgrep API token  Note To create a Semgrep API token, in Semgrep, navigate to Settings...

####### Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between Semgrep Projects Applications and Cortex Cloud code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

###### 9.1.9.5.4. Generic 3rd Party AppSec Collector

####### Important

* File uploads are limited to a maximum size of 10 MB.

####### 9.1.9.5.4.1. Onboard the 3rd Party AppSec Collector

######## Prerequisite

* Permissions: The following Cortex Cloud user roles or RBAC permissions are required:    User roles: CortexCortex Cloud Cloud Instance Admin, AppSec Admin   RBAC: View/Edit permissions for Data Sources configurations are required when not using a dedicated user role    For more information about user permissions and groups, refer to Assign user roles...

######## Note

* We recommend using the tool.driver.name from the SARIF file

* This is the newly created generic collector API URL endpoint.

* Only the validity of the format is tested. No findings will be generated from the test file.

######## Warning

* The API key ID and API secret cannot be retrieved once the wizard is closed.

##### 9.1.9.6. Manage data source integrations

###### Navigation

  Settings → Data Sources → use the search bar to locate the required data source

#### 9.1.10. Transporter over Broker VM

##### Prerequisite

* Ensure you have the necessary permissions and have already set up your Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex Cloud resources. The IP addresses for the Transporter are in the Broker VM Resources section of the Enable access to required PANW resources document Open port 4052 (inbound), which...

##### Note

* The broker enables multiple connections, allowing a single Transporter applet to connect to various VCS instances Multiple Transporter applets cannot be created on a single Broker VM. Each Broker VM is limited to a single Transporter applet instance

##### Warning

* The Transporter applet is not supported for FedRAMP customers.

##### 9.1.10.1. Setup a Transporter applet on Broker VM

###### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator)

###### Note

* You cannot add a Transporter applet through Clusters.

###### Navigation

  your AppSec Transporter under the App column → Configure → Add Connection (on the redirected AppSec Transporter setup page

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

##### 9.1.10.2. Setup a Transporter on your VCS

###### Prerequisite

* Ensure you have user permissions to onboard data sources  Note The dedicated AppSec Admin role includes the required permissions. Ensure you have user permissions to onboard data sources Before you begin you must setup a Transporter applet on your Broker VM. Refer to Setup a Transporter applet on Broker VM for more information

###### Note

* GitLab Enterprise webhook internal IP restriction: GitLab Enterprise's security policies prevent webhook subscriptions to internal IP addresses (such as broker addresses). These subscriptions can only be enabled through specific instance configuration. For more information, refer to https://docs.gitlab.com/security/webhooks/.

###### Navigation

  Settings → Data Sources → + Add Data Source → select your VCS on-premises data source

#### 9.1.11. Manage 3rd party findings and generated issues

#### 9.1.12. Manage code weaknesses

##### Note

* You can customize policies to define which findings are categorized as issues.

##### Tip

* You can also view SAST CWE issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Code Weaknesses tab under the Repositories asset inventory. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset...

##### Navigation

  To access SAST code violation issues, under Modules, select Application Security → Issues → Code Weaknesses

##### 9.1.12.1. Code weaknesses issue inventory

##### 9.1.12.2. Expanded code weaknesses issue information

###### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

##### 9.1.12.3. SAST code weakness findings

###### Note

* Findings on the Cortex Cloud platform are not intended for direct action; but rather represent data collected by the platform. They must be promoted to issues to enable mitigation efforts to secure your codebase.

### 9.2. CI/CD Security

#### 9.2.1. CI/CD Security user roles and permissions

#### 9.2.2. CI/CD Assets

##### 9.2.2.1. CI/CD Instances as assets

###### 9.2.2.1.1. Explore CI/CD Instance assets

####### Navigation

  To access CI/CD pipeline instances, under Inventory, select All Assets → Code → Category → CI/CD Instances

###### 9.2.2.1.2. In-depth CI/CD pipeline instance asset information

###### 9.2.2.1.3. Manage CI/CD pipeline instances

##### 9.2.2.2. CI/CD Pipelines as assets

###### 9.2.2.2.1. Explore CI/CD Pipeline assets

####### Navigation

  To access CI/CD pipelines assets, under Inventory, select All Assets → Code → CI/CD Pipelines

###### 9.2.2.2.2. In-depth CI/CD pipeline asset information

####### Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

###### 9.2.2.2.3. Manage CI/CD pipeline assets

##### 9.2.2.3. Version Control System (VCS) Organizations as assets

###### 9.2.2.3.1. Explore VCS Organization assets

####### Navigation

  To access VCS Organization assets, under Inventory, select All Assets → Code → VCS Organizations

###### 9.2.2.3.2. In-depth VCS Organization asset information

####### Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

###### 9.2.2.3.3. Manage VCS organization assets

##### 9.2.2.4. VCS Collaborators-as-assets

###### 9.2.2.4.1. In-depth Collaborator asset information

###### 9.2.2.4.2. Manage Collaborator assets

#### 9.2.3. Supply Chain tools

##### Note

* Rejected does not mean the tool is not in use. It allows application security practitioners to search for and remove these tools as needed For information about changing the tool status, refer to Overview

##### 9.2.3.1. Supply Chain use cases

###### Navigation

  To access Supply Chain Tools, select Modules → Application Security → Supply Chain Tools (under 3rd Party Tools

##### 9.2.3.2. Explore Supply Chain tools

##### 9.2.3.3. Expanded Supply Chain tool information

###### Note

* AppSec Admin user permissions are required to perform these actions.

#### 9.2.4. CI/CD Risks

##### Note

* Cortex Cloud Application Security CI/CD pipeline scans create a comprehensive inventory of all CI/CD pipelines in your environment. For more information refer to CI/CD Pipelines as assets.

##### 9.2.4.1. CI/CD pipeline issues

###### Navigation

  To access CI/CD pipeline risks issues, under Modules, select Application Security → Issues → CI/CD Risks

##### 9.2.4.2. Expanded CI/CD risks issue information

###### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

##### 9.2.4.3. VCS and CI/CD pipeline risk findings

#### 9.2.5. CI/CD Rules

##### Note

* Out-of-the-box rules cannot be modified Custom CI/CD rules are not supported

##### 9.2.5.1. CI/CD rules roles and permissions

##### 9.2.5.2. CI/CD rules inventory

###### Navigation

  In the Filter panel, select Category → Scanner → CI/CD Security

##### 9.2.5.3. Create custom CI/CD rules

###### Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

##### 9.2.5.4. Manage CI/CD rules

#### 9.2.6. CI/CD Policies

##### 9.2.6.1. CI/CD policies user roles and permissions

##### 9.2.6.2. CI/CD policies inventory

##### 9.2.6.3. Create custom CI/CD policies

###### Note

* PR Scan and CI Scan triggers are automatically disabled and unchecked. They can only be enabled if other scan types (that is non-CI/CD risk scans such as Secrets) are also selected, and will only run on non-CI/CD risks types of scans

* You can combine multiple conditions to create complex rules for when the policy should apply. Create conditions that apply to a CI/CD policy which detects high severity CI/CD risks on GitHub: Select Add Filter → Finding Type → CI/CD Risks → AND → Provider → [VCS/CI/CD system] → AND → Severity: → High.

* SBAC scope limitations do not apply to Matching Criteria For CI/CD policies, you can filter Matching Criteria by VCS Organization Name, CI/CD Pipeline [Name/ID], CI/CD Instance [Name/ID] or Collaborator [Name/Email/MFA Enabled/Last Observed]

##### 9.2.6.4. Manage CI/CD policies

###### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

#### 9.2.7. CI/CD Compliance

##### Navigation

  To access Compliance, select Posture Management → Compliance → Reports or Assessment

##### 9.2.7.1. Create CI/CD compliance reports

###### Note

* The CI/CD module supports GitHub and GitLab providers.

* For more information about about Asset Groups, refer to Asset Groups.

* CIS GitLab Benchmark, CIS GitHub Benchmark, and the OWASP Top 10 CI/CD Risks standards are supported.

* For more information about assessment profiles, refer to Use an assessment profile to run compliance checks on your assets.Use an assessment profile to run compliance checks on your assets

###### Navigation

  Posture Management → Compliance → Assessment or Reports

### 9.3. Code Security

#### 9.3.1. Code Security user roles and permissions

#### 9.3.2. Code Security assets

#### 9.3.3. Software packages as assets

##### 9.3.3.1. In-depth software package asset information

#### 9.3.4. Infrastructure-as-Code (IaC) resources as assets

##### 9.3.4.1. Explore IaC assets

###### Navigation

  To access IaC assets, under Inventory, select All Assets → Code → IaC Resources

##### 9.3.4.2. In-depth IaC resource asset information

#### 9.3.5. Code Security scanners

#### 9.3.6. Software Composition Analysis (SCA ) scanners

##### 9.3.6.1. Supported Software Composition Analysis (SCA) frameworks and languages

##### 9.3.6.2. Software Composition Analysis (SCA) CVE vulnerability issues

###### Tip

* You can also view SCA vulnerabilities in dedicated tabs under other sections when available: In Asset inventories, navigate to Inventory → All Assets → Code:    On the Vulnerabilities tab under Repositories. Refer to In-depth repository asset information for more information Under the All Code inventory: Select an asset from the table →...

###### Navigation

  To access CVE vulnerability issues, under Modules, select Application Security → Issues → Vulnerabilities

###### 9.3.6.2.1. SCA CVE vulnerabilities inventory

###### 9.3.6.2.2. Expanded CVE vulnerabilities issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 9.3.6.2.3. CVE vulnerabilities findings

####### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

####### Navigation

  To access CVE findings, under Modules, select Application Security → Issues → Vulnerabilities → click the Findings tab

###### 9.3.6.2.4. Manage SCA CVE vulnerability issues

##### 9.3.6.3. License miscompliance issues

###### Tip

* You can also view license miscompliance issues in dedicated tabs under other sections when available: In Application asset inventories: navigate to Inventory → All Assets →  Application → select an option from the Application menu → select an item from the inventory → Package Integrity In Asset inventories, navigate to Inventory → All...

###### Navigation

  To access license miscompliance issues, under Modules, select Application Security → Issues → Licenses

###### 9.3.6.3.1. License miscompliance issues inventory

###### 9.3.6.3.2. Expanded License miscompliance issues information

###### 9.3.6.3.3. License miscompliance findings

####### Navigation

  To access license miscompliance findings, under Modules, select Application Security → Issues → Licenses → click the Findings tab

###### 9.3.6.3.4. Open-source software license categories

###### 9.3.6.3.5. Manage license miscompliance issues

##### 9.3.6.4. Package Integrity

###### 9.3.6.4.1. Package Integrity issues inventory

####### Navigation

  Modules → Application Security → Package Integrity (under Issues

###### 9.3.6.4.2. Expanded Package Integrity issues inventory information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 9.3.6.4.3. Package Integrity findings

####### Note

* Findings cannot be mitigated. They must be promoted to issues to enable remediation efforts to secure your software packages.

####### Navigation

  navigate to Modules → Application Security → Package Integrity (under Issues) → click the Findings tab

###### 9.3.6.4.4. Manage Package Integrity issues

#### 9.3.7. Secrets scanners

##### 9.3.7.1. Secrets issues

###### Tip

* You can also view Secrets issues in dedicated tabs under other sections when available: In Code asset inventories: navigate to Inventory → All Assets → Code:    On the Secrets tab under Repositories. Refer to In-depth repository asset informationfor more information   Under the All Code inventory: Select an asset from the table → Secrets In Code...

###### Navigation

  Under Modules, select Application Security → Issues → Secrets

##### 9.3.7.2. Secrets issues inventory

##### 9.3.7.3. Expanded Secrets issue information

###### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

##### 9.3.7.4. Secrets findings

###### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

###### Navigation

  To access Secrets findings, select Application Security → Issues → Secrets → click the Findings tab

##### 9.3.7.5. Manage Secrets issues

#### 9.3.8. Infrastructure as Code (IaC) scanners

##### 9.3.8.1. Supported frameworks and languages

##### 9.3.8.2. IaC misconfiguration issues

###### Tip

* You can also view IaC misconfiguration issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Configuration tab under Repository assets. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from...

###### Navigation

  To access IaC misconfiguration issues, under Modules, select Application Security → Issues → IaC misconfiguration

##### 9.3.8.3. IaC misconfiguration issues inventory

##### 9.3.8.4. Expanded IaC misconfiguration issue information

###### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

##### 9.3.8.5. IaC misconfiguration findings

###### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

###### Navigation

  To access IaC misconfiguration findings, under Modules, select Application Security → Issues → IaC Misconfigurations → click the Findings tab

##### 9.3.8.6. Manage IaC misconfiguration issues

#### 9.3.9. Application Security scans management

##### 9.3.9.1. How to access Cortex Cloud Application Security scan management

###### Note

* While scans provide a comprehensive inventory of all issues detected during a scan, dedicated inventories are also maintained for specific scan types for more granular management. For more information, refer to Infrastructure as Code (IaC) scanners, Secrets scanners and Software Composition Analysis (SCA ) scanners.

##### 9.3.9.2. Branch periodic scans

###### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

##### 9.3.9.3. Pull Request scans

###### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

##### 9.3.9.4. CI scans

###### Note

* The inventory table displays scan issues for visibility only; remediation is not available in scan management. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

##### 9.3.9.5. Manage repository scan configurations

###### Note

* For Secrets scans you configure these additional settings: Git history scan: scans Git history to detect secrets deleted from files but still present in past commits, notifying you of these exposures. This helps mitigate the risk of compromised credentials that may be found in the repository's history Secret validation: validates detected secrets...

###### Navigation

  Settings → Data Sources → hover over a connected data source from the catalog → click View Details

##### 9.3.9.6. Monitor data source instances health

#### 9.3.10. Application Security Policies

##### 9.3.10.1. User roles and permissions

##### 9.3.10.2. Create Cortex Cloud Application Security policies

###### Note

* Add additional condition attributes for a single finding type by using the OR operator When selecting multiple finding types, only filters common to all types are available

* If you select the Applications asset type, the policy evaluates all repositories for matching applications SBAC scope limitations do not apply to Asset Types

###### 9.3.10.2.1. Cortex Cloud Application Security policy condition attributes

####### Note

* The Severity, AppSec Rule, AppSec Rule Label and Backlog Status attributes are not dependent on the Finding Type attribute For more information about Backlog Status, refer to Backlog baseline

* For CI/CD Risks as the finding type, refer to CI/CD policies user roles and permissions.

##### 9.3.10.3. Manage Cortex Cloud Application Security policies

###### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

#### 9.3.11. Application Security Rules

##### Note

* Out-of-the-box rules cannot be modified directly. However, you can create a custom rule by cloning the existing one. This allows you to make changes to the original rule according to your requirements. Refer to Manage Cortex Cloud Application Security custom rules for more information.

##### 9.3.11.1. Roles and permissions

##### 9.3.11.2. Rules inventory

###### Navigation

  To filter rules relating to Secrets, select filter icon → Scanner (from the Select field) → Secrets (from the Value field

##### 9.3.11.3. Create custom Cortex Cloud Application Security rules

###### Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

##### 9.3.11.4. Manage Cortex Cloud Application Security custom rules

##### 9.3.11.5. Configure YAML file properties

#### 9.3.12. Application Security CLI

##### Prerequisite

* For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

##### Note

* For detailed information about the Cortex Cloud CLI, refer to Cortex CLI.

##### 9.3.12.1. Connect Cortex CLI

###### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

###### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Cortex Cloud Application Security, refer to Cortex CLI usage for Cortex Cloud Application Security

###### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

##### 9.3.12.2. Cortex CLI usage for Cortex Cloud Application Security

##### 9.3.12.3. Cortex CLI Cortex Cloud Application Security command line reference

###### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

###### Important

* The Cortex CLI Cortex Cloud Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id...

##### 9.3.12.4. Cortex CLI common command line reference guide

###### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

#### 9.3.13. IDE

##### Note

* Not all remediation options are available for all findings or all type of scan category.

##### 9.3.13.1. System requirements

##### 9.3.13.2. Visual Studio (VS) Code

###### Prerequisite

* Before you begin: Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

###### Note

* Enforcement rules and CA certificates are not applicable to the open-source project.

###### Navigation

  Install through VS Code IDE: Access the Activity bar → select Extensions → Cortex Cloud → Install

###### 9.3.13.2.1. How to use the Cortex Cloud extension in VS Code

####### Note

* Not all remediation options are available for all issues.

* The suppression is scoped to the file.

##### 9.3.13.3. JetBrains

###### Prerequisite

* Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install Node.js version 22 and...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

###### Note

* The Cortex AppSec code security plugin supports all JetBrains products.

###### Navigation

  Settings → Plugins → select the Marketplace tab → search for Prisma Cloud → Install → OK

  Settings → Tools → Cortex Cloud

###### 9.3.13.3.1. How to use the JetBrains Cortex Cloud extension

####### Note

* After selecting Fix Available, the number of issues displayed in the issue categories (such as IaC) reflect the number of fixable issues for that type.

* The corresponding file simultaneously opens in the Code editor, highlighting the issue within its exact code context. See below for more information.

* Not all types of remediation are available for all issue categories. For example, fixes are not available for License issues.

* Secrets and Licenses category issues are typically mitigated by following the guidance in the Documentation.

### 9.4. API documentation

10. Cortex Cloud Data Classification

  10.1. What is Cortex Cloud Data Classification?

  10.2. How to create and validate a custom data pattern

#### Note

* Once a custom data pattern is saved, it runs on all data in the same way as any out-of-the-box (OOTB) pattern, becoming globally applicable for all modules using Cortex Cloud Data Classification.

* For more information, see How to disable and enable data patterns in Data Classification.

  10.3. How to disable and enable data patterns in Data Classification

#### Note

* Disabling data patterns can cause changes in your data profile results and stop detection of these data patterns.

* For more information about data patterns in data classification, see What is Cortex Cloud Data Classification?.

#### Navigation

  In Cortex Command Center, click Settings → Configurations → Data Classification → Data Patterns

  10.4. How to create and validate a custom data profile

#### Note

* If you choose two data locations, only the filters they have in common will be included in the possible filter options.

* For more information, see How to disable and enable data profiles in Cortex Cloud Data Classification.

#### Important

* Deleting a data profile deletes all past data associated with it in all modules using Cortex Cloud Data Classification after a warning notification is displayed.

* Enabling and disabling a data profile removes or re-adds the data profile results to the data objects; that is, files and tables.

  10.5. How to disable and enable data profiles in Cortex Cloud Data Classification

#### Note

* Existing results on past scans are updated in the Asset and Object inventories within two hours after being disabled or enabled.

* For more information about data profiles in Cortex Cloud Data Classification, see What is Cortex Cloud Data Classification?.

#### Navigation

  In Cortex Cloud Security Command Center, click Settings → Configurations → Data Classification → Data Profiles

11. Cortex Cloud Data Security

  11.1. What is Cortex Cloud Data Security?

  11.2. Supported assets in Cortex Cloud Data Security

#### Note

* The list above refers to only data classification; however, Cortex Cloud Data Security discovers and monitors all cloud assets and services for usage and misconfigurations.

* For information about configuring data classification asset types, see How to configure the scanning settings for supported services.

  11.3. Cortex Cloud Data Security concepts

  11.4. Cortex Cloud Data Security use cases

  11.5. Data Inventory

#### Note

* To clear the filters in the filter panel, click Delete.

#### Navigation

  When you select Inventory → All Assets → Data → All Data, a list of all data assets appears

  11.6. How to review errors in Cortex Cloud Data Security

  11.7. How to configure the scanning settings for supported services

#### Note

* All the asset types are selected by default. When you deselect a data asset type, it is not included when the system runs the next scan operation, reducing the total scan time.

  11.8. How to perform advanced Data Security investigations using XQL

#### Note

* For more information, see Build XQL queries.

  11.9. How to onboard Snowflake (Posture)

#### Prerequisite

* In order to use Snowflake (Posture), you must be registered with one of these cloud providers: Amazon AWS, Microsoft Azure, or Google Cloud Platform (GCP). Ensure you have the necessary account permissions to onboard. It is recommended to use account admin as the role for the onboarding.

#### Note

* The account identifier can be found using the user information at the bottom left. Hover over the account you wish to onboard and select the copy option at the top right. The account identifier is usually of the format: (organization).[account]

  11.10. How to onboard Microsoft 365 (Posture)

#### Prerequisite

* You have generated a Globally Unique Identifier (GUID), also known as a Universally Unique Identifier (UUID). You will need this ID for the tenant you want to use for the Microsoft 365 (Posture) instance. In order to use Microsoft 365 (Posture), you must be registered with Microsoft Azure.

  11.11. How to use information protection labels in Cortex Cloud Data Security

#### Note

* Only If you have connected a Microsoft 365 instance to Cortex Cloud, the information protection labels appear. See How to onboard Microsoft 365 (Posture).

12. Cortex Cloud Identity Security

  12.1. What is Cortex Cloud Identity Security?

  12.2. Cortex Cloud Identity Security concepts

#### Note

* Access to the Weak/Compromised Password column requires the ITDR add-on.

* Only ITDR assets can have a risk score.

* When a policy is analyzed and categorized as excessive, a relevant finding and highlight is attached to that policy and the various identities being granted excessive permissions.

* Each action must be defined as either being administrative or not. The administrative tag is an additional tag for administrative actions, along with one of the other access level types. For example, the AWS action iam:CreateGroup is categorized as config and has the administrative tag as well.

#### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

  12.3. Cortex Cloud Identity Security principles

  12.4. Cortex Cloud Identity Security use cases

  12.5. How to manage RBAC and SBAC in Cortex Cloud Identity Security

#### Important

* You can use the Cortex Cloud Identity Security RBAC roles to define access to the various sections and functionalities of Cortex Cloud Identity Security, but these roles do not directly control the specific data a user sees within those sections. Data visibility is further refined and limited by scope-based access control (SBAC) capabilities.

  12.6. How to achieve the principle of least privilege access

#### Note

* In the case of Amazon AWS, Cortex Cloud Identity Security also uses AWS Identity and Access Management (IAM) Access Advisor insights to expand the coverage of supported actions.

#### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

  12.7. How to enable inactive human identity logs on Azure in Cortex Cloud Identity Security

#### Note

* For more information, see Ingest logs from Microsoft Azure Event Hub.Ingest logs from Microsoft Azure Event Hub

  12.8. How to perform advanced Identity Security investigations using XQL

#### Note

* For more information, see Build XQL queries.

13. Cloud ASM

  13.1. What is Cloud ASM?

  13.2. Cloud ASM concepts

  13.2.1. Scanning

  13.2.1.1. Scanning cadences

  13.2.1.2. Scanning ports and protocols

#### Note

* The following lists are not exhaustive. For current and complete lists, contact your customer success team.

  13.2.2. Network mapping

  13.3. Enable Cloud ASM

#### Note

* Discovered services will increase workload consumption. ASM data will begin to appear in your tenant and be included in your licensing workload meter within 72 hours.

#### Navigation

  Settings → Configurations → Attack Surface → Data Management

  13.4. Attack Surface Management detections

  13.4.1. Attack surface rules

#### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

  13.4.2. Externally inferred CVEs

#### Note

* An externally inferred CVE might impact your service or asset, but additional investigation is required to confirm that the CVE is actually present.

  13.5. Attack surface assets

#### Navigation

  The internet-facing assets that were discovered in a attack surface management (ASM) scan and attributed to your organization are available in the inventory on the Inventory → Assets → All Assets → External Surface pages

  13.6. Review your unmanaged cloud services

#### Navigation

  Inventory → Assets → All Assets → External Surface → Services

  13.7. Review unmanaged cloud issues

14. Vulnerability management

  14.1. Vulnerability management in Cortex Cloud

#### Note

* Cortex Cloud vulnerability management provides the ability to identify and assess runtime vulnerabilities in every asset across traditional IT and cloud environments. For vulnerabilities detected in your software development lifecycle through application security scans, refer to the Cortex Cloud Application Securitydocumentation.

  14.1.1. Cortex Cloud vulnerability concepts

#### Note

* CVE is an acronym for Common Vulnerabilities and Exposures, which is a list of publicly disclosed security threats. We often use the term "CVE" to refer to a vulnerability that has been a assigned a CVE ID. Cortex Cloud identifies CVEs and non-CVE vulnerabilities.

  14.1.2. Vulnerability Management dashboard

  14.2. Vulnerability policies

  14.2.1. Create a vulnerability policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

  14.2.2. Update the Ignored CVEs, Asset Groups, and Assets policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

  14.2.3. Modify a vulnerability policy

#### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

  14.2.4. Enable or disable a vulnerability policy

#### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

  14.3. Investigate and remediate vulnerabilities

  14.3.1. View all Vulnerabilities

#### Navigation

  Posture Management → Vulnerability Management → Vulnerabilities

  14.3.2. View vulnerability issues

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

  14.3.3. View All Vulnerability Findings

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues and click the All Vulnerability Findings button

  14.3.4. View vulnerable assets

#### Navigation

  Posture Management → Vulnerability Management → Vulnerable Assets

  14.4. Vulnerability Intelligence

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

  14.5. Recast CVSS scores and CVSS severities

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

15. Cloud Security Rules and Policies

  15.1. Overview

  15.2. Cloud Security Rules

  15.3. Cloud Security Policies

#### Note

* If you have the following Scope Based Access Control (SBAC) settings in place, User Settings > Cases and Issues Scope > Select domains > Posture, you may encounter a Case mismatch in Issues/Cases/Findings counts. This is because the Case count on the Rules page captures Cases belonging to the Posture domain. Whereas Platform pages, capture Issues...

* 15.3.1 |Issues Issues are artifacts of the policy and represent actionable items that you need to address. They have several characteristics, such as: Lifecycle '–' Open, Dismiss, In-progress, Close Workflows '–' Assigned to different user personas for remediation Severity '–' Critical, High, Medium, Low, Info NOTE: A key distinction between Findings and Issues is that Findings are not actionable, while you can take an action on Issues. The Cloud Security Policies page allows you to manage policies that define security and compliance actions for cloud posture. You can create, edit, filter, and manage policies through a structured table and widget panel. he Policies page displays all the configured policies with the following fields. 15.4 |Create Rules You can create your own custom rules for Configuration (Config), Attack Paths, and Network Exposure. View all the Cloud Posture Security Rules on the Posture Management > Rules & Policies > Rules > Cloud Security page. 15.4.1 |Create a Data Rule Data rules protect your environment against malware and enable data classification. To create a Data rule: Navigate to Posture Management → Rules & Policies → Rules → Cloud Security . Select Create Rule → Data. Enter Rule Name, Description, select Severity (Critical, High, medium, or Low), and add Labels (optional) and click Next. On the Rule Logic page, you can select options to build your data rule. Click Select next to FIND and choose from the list of supported data assets categories such as, database, disk, bucket. Click WHERE to choose from the attributes of the asset. Depending on the asset category you selected in the above step the list of attributes displayed will vary. For example, you can select FIND Bucket WHERE Type and Select values = S3 bucket. Click WHERE to choose from the attributes of the asset. Depending on the asset category you selected in the above step the list of attributes displayed will vary. For example, you can select FIND Bucket WHERE Type and Select values = S3 bucket. Click + to select the Findings such as, Configuration Finding, Data Finding, Identity Finding and so on. Click WHERE to choose from the attributes of the finding. Depending on the finding you selected in the above step the list of attributes displayed will vary. Select a value and click Search to view the results. If you had selected the Enable How to Fix option in the rule creation Overview step, under How to Fix you can add specific actions to be taken if and when this rule is violated. Click Done to save your Data Rule. You can view the saved rule on the Cloud Posture Security Rules page. Click Done to save your Data Rule. You can view the saved rule on the Cloud Posture Security Rules page. 15.4.2 |Create a Network Exposure Rule Network exposure rules detect your assets that are exposed to the Internet. To create a network exposure rule: Navigate to Posture Management > Rules & Policies. Select Cloud Security under Rules. Select Create Rules > Network Exposure. Enter Rule Name, Description, select Severity (Critical, High, medium, or Low), add Labels (optional), and click Next. On the Rule Logic screen, select Destination Asset Type: VM Instance, Kubernetes, Managed DB, or Serverless Function and Cloud Service Provider: AWS, Azure, or GCP. Depending on the asset type (all asset types are supported) you select the rule creation process differs as well as the attributes that exist in each rule.If you select Kubernetes as your Asset Type, then you can also specify the Ingress Route under Advanced Settings. Click Show Advanced Settings. If you select Use External Probe Validation as Yes, then HTTP Response Code becomes available as an option. Click Done to save your Network Exposure Rule. 15.4.3 |Edit a Rule Navigate to Posture Management > Rules & Policies. Select Cloud Security under Rules. On the Rules page, click the rule you want to edit. On the Details page, click the more options icon ('®) and then select Edit. Make the necessary changes on the policy Details, Rules, and Scope screens. Click Done to save your changes. 15.5 |Create Policies NOTE: When creating Policies, note that Rules with the Informational severity level are excluded.

  15.5.1. Edit a Policy

  15.5.2. Use an Existing Policy to Create a New One

  15.6. Internet Exposure Detection

16. Cloud Workload Policies and Rules

#### Prerequisite

* Users need View/Edit RBAC permissions (under Policies → Compute Policies) or the Instance Administrator role to view, edit, and modify Cloud Workload Policies.

  16.1. How policies and rules work together

  16.2. Cloud Workload Policies

  16.2.1. Types of Cloud Workload Policies

  16.2.2. Cloud Workload Policies page

#### Note

* Keep the following caveats in my mind when working with Policies: Instance Administrators are able to view all facets of Policies without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be...

  16.2.2.1. Widgets panel

  16.2.2.1.1. Show or hide the widget panel

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  16.2.2.2. Filter page results

  16.2.2.3. Change the layout of the policies table

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  16.2.2.4. Policy Details Panel

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  16.2.3. Enable or disable a Cloud Workload Policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  16.2.4. Create a Cloud Workload Policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  16.2.5. Use an existing policy to create a new Cloud Workload policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  16.2.6. Edit a Cloud Workload Policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  16.2.7. Delete a Cloud Workload Policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  16.3. Cloud Workload Rules

  16.3.1. Default (pre-defined) Rules

  16.3.2. Custom (user-defined) Rules

  16.3.3. Cloud Workload Rules page

#### Note

* Keep the following caveats in my mind when working with Rules: Instance Administrators are able to view all facets of Rules without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be able...

  16.3.3.1. Filter page results

  16.3.3.2. Change the layout of the rules table

  16.3.3.3. Rule details panel

  16.3.4. Create a new Custom Detection Rule

#### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

#### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

  16.3.5. Use an existing rule to create a new Custom Detection Rule

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

  16.3.6. Edit a Custom Detection Rule

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

  16.3.7. Delete a Custom Detection Rule

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

17. Serverless function posture security

  17.1. Onboard cloud providers for serverless functions

#### Note

* When scanning serverless functions wtih layers, those layers need to be from the same cloud account.

* Only functions containing zip files are supported.

#### Important

* Cortex supports GCP functions deployed by Cloud Functions (1st gen) and Cloud Functions API (2nd gen).

  17.2. Serverless function posture policies

  17.2.1. Manage serverless function policies

#### Note

* You can select multiple types to view all your serverless function rules across your cloud providers.

* Refer to Create serverless function policies for more information on how to define the steps of a policy in the wizard.

  17.2.2. Create serverless function policies

#### Note

* You can select multiple options.

* For more information about rules, refer to Manage serverless function rules.

  17.3. Serverless function posture rules

  17.3.1. Manage serverless function rules

#### Note

* You can select multiple types to view all your serverless function policies across your cloud providers.

* Refer to Create serverless function rules for more information on how to define the steps of a rule in the wizard.

  17.3.2. Create serverless function rules

  17.3.3. Create an attack path rule for serverless functions

#### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  in as the operator → enter the CVE ID → Search

  > or >= as the operator → Severity level (such as High, Low) → Search

  > or >= as the operator → enter a score → Search

  17.3.4. Create a configuration rule for serverless functions

#### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  17.3.5. Create a network exposure rule for serverless functions

#### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  17.4. Serverless function usage

#### Navigation

  To access serverless function assets, under Inventory, select All Assets → Compute → Serverless Functions

  Posture Management → Vulnerability Management) → Vulnerability Issues

  Add Filters → Asset Category → Serverless Function

  Posture Management → Vulnerability Management) → Vulnerable Assets

  Add Filters → Asset Category → Serverless Functions

18. Data management

  18.1. Broker VM

  18.1.1. What is the Broker VM?

  18.1.2. Set up and configure Broker VM

#### Note

* The Broker VM comes with a 512 GB disk. Therefore, deploy the Broker VM with thin provisioning, meaning the hard disk can grow up to 512 GB but will do so only if needed.

* When DHCP is not enabled in your network and there isn't an IP address for your Broker VM, configure the Broker VM with a static IP using the serial console menu.

* When configuring a Local Agent Settings applet with installer and content caching, you need to configure an SSL certificate for the Broker VM as explained in the task below. For more information on specific requirements for the Local Agent Settings applet, see Activate Local Agent Settings.Activate Local Agent Settings Keep in mind that several Broker...

* You can configure another Broker VM as a proxy server for this Broker VM by selecting the HTTP type. When selecting HTTP to route Broker VM communication, you need to add the IP Address and Port number (set when activating the Agent Proxy) for another Broker VM registered in your tenant. This designates the other Broker VM as a proxy for this Broker VM.

* The Palo Alto Networks Broker VM supports only strong cipher SHA256-based certificates. MD5/SHA1-based certificates are not supported.

* If adding a CA certificate to the Broker VM is not possible, ensure that you've added the Broker Service FQDNs to the SSL Decryption Exclusion list on your firewalls. See Enable Access to Cortex XDR.

#### Important

* There can be instances in which the Broker VM requires up to 50% of the incoming bandwidth as outgoing. Such instances can be, network instability between the Broker VM and Cortex Cloud, or data that is being collected, but not well compressed.

* The internal network for the Broker VM must be unique and reserved. Other devices should not use the same IP as the Broker VM internal network as it can lead to communication issues with the Broker VM.

* If you use SSL decryption in your firewalls and proxies, see the Understanding CA certificate functionality in Broker VM deployments section below. In addition, verify that the proxies used support HTTP/2, gRPC-specific headers, and HTTP/2 trailers, and the inspection policies support gRPC traffic. Any devices that you use with this configuration...

* When configuring more than one network interface, ensure that only one Default Gateway is defined. The rest must be set to 0.0.0.0, which configures them as undefined. In addition, we recommend assigning each network interface to a different subnet, as oppose to configuring two interfaces on the same subnet which can potentially cause unexpected...

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and earlier, Cortex Cloud will only accept 172.17.0.0/16.

* We strongly recommend disabling SSH connectivity when it's not being used. Therefore, activate SSH connectivity when it's needed and disable it right afterwards. When generating a new SSH key ensure to avoid embedding the domain-style username, by not using any backslashes (\) in the comment field, to ensure the SSH key passes validation.

  18.1.2.1. Broker VM image installations

  18.1.2.1.1. Set up Broker VM on Alibaba Cloud

#### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

#### Note

* For Linux and Windows uploads, you can use Alibaba Cloud's graphical management tool called ossbrowser.

* The Object Storage Service must be created in the same Region as the image of the virtual machine.

#### Navigation

  Hamburger menu → Elastic Compute Service → Instances & Images → Instances

  18.1.2.1.2. Set up Broker VM on Amazon Web Services

#### Prerequisite

* Download a Cortex Cloud Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. You need to set up an AWS VM Import role (vmimport) before you continue with the steps to convert the image as it is required for the import-image CLI command. You can use a different role, if the...

#### Note

* Creating an AMI image can take up to 60 minutes to complete.

* Assigning security groups can take up to 15 minutes.

#### Important

* A t2.medium (4GB RAM) is the lowest machine type that can be used as an instance type. Usually, the lowest machine type is sufficient with the Local Agent Settings applet. Yet, when enabling more applets, 8 GB is required.

#### Navigation

  Log in to the AWS IAM Console, and in the navigation pane, select Access Management → Users → Add Users

  Obtain a registration token from the Cortex Cloud Web Console by selecting Settings → Configurations → Data Broker → Broker VMs → Add Broker → Generate Token

  18.1.2.1.3. Set up Broker VM on Google Cloud Platform (GCP)

#### Prerequisite

* Download a Cortex Cloud Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. To complete the set up, you must have G Cloud installed and have an authenticated user account.

* Before importing a GCP image using the gcloud CLI, ensure that you update the Google Cloud components to version 371.0.0 and above using the following command:

#### Note

* The import tool uses Cloud Build API, which must be enabled in your project. For the import to work, Cloud Build service account must have compute.admin and iam.serviceAccountUser roles. When using the Google Cloud console to import the image, you will be prompted to add these permissions automatically.

  18.1.2.1.4. Set up Broker VM on KVM using Ubuntu

#### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  18.1.2.1.5. Set up Broker VM on Microsoft Azure

#### Prerequisite

* Download a Cortex Cloud Broker VM VHD (Azure) image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

#### Note

* Extraction can take up to a few hours.

* Upload can take up to a few hours.

* Creating the VM can take up to 15 minutes. The Broker VM Web UI is not accessible during this time.

* For more information on creating a rule in an Azure VM, see Create a Security Rule in the Azure Documentation.

  18.1.2.1.6. Set up Broker VM on Microsoft Hyper-V

#### Prerequisite

* Download a Cortex Cloud Broker VM VHD image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  18.1.2.1.7. Set up Broker VM on Nutanix Hypervisor

#### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

#### Note

* Saving the image to Nutanix hypervisor can take time as it's a large file.

* Creating the VM can take up to 15 minutes. The Broker VM Web user interface is not accessible during this time.

  18.1.2.1.8. Set up Broker VM on VMware ESXi using vSphere Client

#### Prerequisite

* Ensure you have a virtualization platform installed that is compatible with an OVA image, and have an authenticated user account. Download a Cortex Cloud Broker VM OVA image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  18.1.2.2. Broker VM data collector applets

  18.1.2.2.1. Activate Registry Scanner

#### Prerequisite

* To initialize registry scanning on your Broker VM, you must first add the necessary data connectors. For details, see Connect Docker V2-compliant container registry and Connect JFrog container registry When sizing your Broker VM, consider the following recommendations:    Disk Size: Calculate the required disk space by multiplying the average container...

#### Note

* FedRAMP is currently not supported for this applet. You cannot activate the Registry Scanner directly on a new or existing Broker VM. You can only activate or deactivate existing Registry Scanner applets. To activate or deactivate existing applets, see Step 4 under Verify Registry Scanner connection section.

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  18.1.2.2.2. Activate Transporter

#### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator) Set up and configure Broker VMSet up and configure Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex Cloud resources. The IP addresses...

#### Warning

* The Transporter applet is not supported for FedRAMP customers.

#### Navigation

  Settings → Configurations → Broker VMs (under Data Broker

  the Brokers tab → locate your Broker VM → hover and click + Add under the Apps column → AppSec Transporter

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

  18.1.3. Manage Broker VM

#### Note

* For more information on troubleshooting errors and warnings for these broker applets, see Troubleshoot Broker VM applet errors.Troubleshoot Broker VM applet errors

* Certain fields are also exposed in the Clusters tab, when a Broker VM node is added to a High Availability (HA) cluster, and each cluster node is expanded to view the Broker VM nodes table. An asterisk (*) is beside every field that is also included in the Broker VM nodes table for each HA cluster.

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  18.1.3.1. Edit Broker VM Configuration

#### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and lower, Cortex Cloud accepts only 172.17.0.0/16.

* Make sure you save the password before closing the window. The only way to re-generate a password is to disable ssh and re-enable.

  18.1.3.2. Increase Broker VM storage allocated for data caching

#### Note

* Follow your hypervisor documentation to understand how to add a persistent disk storage to your VM.

* If your disk is not listed and you didn't shutdown your Broker VM in your hypervisor before manually adding a disk to the VM, you'll need to reboot the Broker VM before the disk details are detected by the Broker VM. This can be performed either in the hypervisor or directly in the Broker VMs page.

#### Warning

* This operation is irreversible, and will make the disk become an integral part of the broker, where disconnecting the disk will result in errors and data loss.

  18.1.3.3. Monitor Broker VM using Prometheus

#### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* For more information on Docker, see the Docker website.

  18.1.3.4. Collect Broker VM Logs

#### Note

* The Download Logs (<TIMESTAMP>) is only displayed when you've downloaded your logs previously using Generate New Logs.

  18.1.3.5. Upgrade Broker VM

#### Important

* After a Broker VM upgrade, your broker may require a reboot to finish installing important updates. A notification about this will be sent to your Cortex Cloud console Notification Center.

  18.1.3.6. Import Broker VM Configuration

#### Important

* This option can only be used on Broker VMs with version 20.0 and later, and is only suitable for importing a configuration of brokers in the same version, or from a broker in an older version to a broker in a newer version.

* If your source Broker VM configuration includes a WEC applet, you'll need to ensure that you update the DNS record of this Broker VM's FQDN to point to the target Broker VM IP address.

  18.1.3.7. Open Live Terminal

#### Note

* You can either restart_routes or reboot the Broker VM for the changes in the /etc/network/routes file to take affect.

  18.1.3.8. Add Broker VM to cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  18.1.3.9. Switchover Primary Node in Cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  18.1.3.10. Remove from Cluster

#### Note

* If you've enabled a Load Balancer Health-Check on the cluster, you need to exclude this Broker VM from your Load Balancer settings.

  18.1.4. Broker VM High Availability Cluster

#### Note

* For Load Balancing, you must install a Load Balancer in your network which will distribute the incoming data between the nodes.

* The Pathfinder applet isn't supported when configuring Broker VMs in HA clusters.

  18.1.4.1. Configure High Availability Cluster

#### Prerequisite

* Be sure you do the following tasks before creating a cluster from an existing Broker VM: Since the Pathfinder applet isn't supported when configuring HA clusters, you must ensure Pathfinder is deactivated on the Broker VM. If the Broker VM is explicitly specified in some Agent Settings profile, which mean Cortex Cloud agents retrieve release upgrades...

#### Important

* You can only create a new cluster from an existing Broker VM, when the Broker VM version is 19.0 and later, and the STATUS is Connected. The Create a Cluster from this Broker option is only listed if the Broker VM is not already added to a cluster.

* When the Protocol is set to HTTPS, you may need to perform a few follow-up steps to establish a validated secure SSL connection with the Broker VM. If you're using your own Certificate Authority (CA) to sign the certificates, you'll need to place the CA in the client, such as the Load Balancer, and upload the certificates to the Broker VM. If you're...

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  18.1.4.2. Manage Broker VM clusters

#### Navigation

  After you've configured a cluster, you can manage all your Broker VM clusters from the Clusters tab on the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs → Clusters

  18.1.4.2.1. View cluster details

#### Note

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.Troubleshoot Broker VM applet errors

#### Navigation

  The Clusters tab of the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs) enables you

  18.1.4.2.2. Edit cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs, and select the Clusters tab

  18.1.4.2.3. Add applet to cluster

#### Note

* With Cortex XDR Prevent, it's only relevant to configure a HA cluster with a Local Agent Settings applet as this is the only applet supported for this product license. The other applets are collector applets, which are only available in Cortex XDR Pro or Cortex XSIAM.

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.Troubleshoot Broker VM applet errors

  18.1.4.2.4. Add Broker VM to cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  18.1.4.2.5. Remove cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  18.1.5. Broker VM notifications

  18.1.6. Monitor Broker VM activity

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  18.2. Dataset management

#### License Type

  Managing Roles requires an Account Admin or Instance Administrator role. For more information, see Predefined user roles.

#### Note

* Cold storage, in addition to a cold storage license, requires compute units (CU) to run cold storage queries. For more information on CU, see Manage compute units.

* Only datasets that are already handled as part of the GB license are supported for this license. In addition, the retention configuration is only available in Cortex Cloud, as opposed to the public APIs.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default. Datasets include dataset permission enforcements in the Cortex Query Language(XQL), Query Center, and XQL Widgets. For example, to view or access any of the endpoints and host_inventory datasets, you need role-based access control (RBAC)...

* You'll only be able to save the dataset view if the query contains no errors; otherwise, the Save button is disabled.

* For more information on user roles, see Manage user roles.

#### Important

* Cortex Cloud enforces retention on all log-type datasets excluding Host Inventory, Vulnerability Assessment, Metrics, and Users.

* This column is updated once a day. Therefore, if the dataset was created or updated by the target or lookup flows, it's possible that the Last Updated value is a day behind when the queries or reports were run as it was before this column was updated.

  18.2.1. What are datasets?

#### Note

* For more information on tasks specific to lookup datasets, see Lookup datasets.

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

#### Important

* By default, forensic datasets are not included in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  18.2.2. Lookup datasets

#### Note

* A lookup dataset can only be deleted if there are no other dependencies. For example, if a Correlation Rule is based on a lookup dataset, you wouldn't be able to delete the lookup dataset until you removed the dataset from the XQL query of the Correlation Rule.

  18.2.2.1. Import a lookup dataset

#### Prerequisite

* When uploading a CSV, TSV, or JSON file, ensure that the file meets the following requirements: The maximum size for the total data to be imported into a lookup dataset is 30 MB from the Dataset Management page. Otherwise, the limit is 50 MB using Cortex Query Language (XQL) or APIs. Field names can contain characters from different languages, special...

#### Important

* The name of a dataset created from a TSV file must always include the extension. For example, if the original file name is mrkdptusrsnov23.tsv, you can save the dataset with the name marketing_dept_users_Nov_2023.tsv.

  18.2.2.2. Download JSON file of lookup dataset

#### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  18.2.2.3. Set time to live for lookup datasets

#### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  18.2.3. Monitor datasets and dataset views activity

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  18.3. Manage compute units

#### Note

* For more information, see Import historical data into cold storage.Import historical data into cold storage

* The CU consumption of cold storage queries is based on the number of days in the query time frame. For example, when querying 1 hour of a specific day, the CU of querying this entire day is consumed. When querying 1 hour that extends past 2 days, such as from 23:50 to 00:50 of the following day, the CU of querying these two days is consumed.

  18.3.1. Compute units usage

#### Note

* To enable the add-on, select Settings  → Configurations → Cortex Cloud License → Addons tile, and select the Compute Unit tile and Enable.

#### Navigation

  Settings → Configurations → Data Management → Compute Unit Usage

  18.4. Manage instances

  18.4.1. Add a new data source or instance

#### Note

* If a data source contains multiple integrations, the integration configured as the default integration will used by the Data Onboarder. The default integration of the content pack is indicated in each content pack's documentation. The other integrations are available for configuration in the Automation and Feed Integrations page after installing the...

* If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant page in the system, for example Correlations, Playbooks, or Scripts. If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant...

  18.4.2. Manage instances

  18.4.3. Manage cloud instances

#### Note

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  18.4.4. Update cloud permissions after Cortex release updates

#### Prerequisite

* Ensure that the user account used to modify permissions has the necessary privileges within both the Cortex platform and your cloud environment, for example, AWS or Azure. You received a notification regarding a new version available that requires permission updates, or viewed a Needs Update status in the Data Sources page.

#### Note

* Instances requiring updates will not change their connection status, for example, Connected, Warning, Error, Disabled, due to the pending permission update.

  18.4.5. Pending cloud instances

  18.4.6. Manage Kubernetes Connector instances

  18.4.7. Troubleshoot errors on cloud instances

#### Note

* Errors related to collection of audit logs in the cloud instance are recorded in the collection_auditing dataset. For more information, see Audit logs fields and query examples.

  18.4.8. Monitor serverless function scan health and status

  18.5. About health issues

#### Prerequisite

* For Cortex Cloud to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics.Enable the Analytics Engine and Identity Analytics Data Ingestion...

#### Note

* Only certain type of health issues are supported in Cortex Cloud, including DSPM, ADS, CIEM, and Registry.

* Cortex Cloud enforces the dedup logic to health issues. This logic reduces the likelihood of identical health issues from flooding the issues dataset.

19. Marketplace

  19.1. Cortex Marketplace

  19.2. Cortex Cloud content

  19.3. Manage content packs

#### Note

* Pre-installed core content packs are automatically upgraded.

* Optional content packs that are already installed are treated like they are required content packs to preserve content integrity.

* Third party product Integrations are developed and tested against a specific product version. For products which are on-prem or cloud based with specific API versions, the version developed and tested against will be included in the integration's documentation. Newer versions of the product are not always immediately tested and it is expected that...

#### Caution

* If you want to downgrade, any content that depends on the content pack including any customizations may be deleted if it does not exist in the target content pack version.

* If another content pack is dependent on the content pack you want to delete, it may break the other content pack. You can reinstall the content pack, but you cannot restore detached and customized content.

  19.4. Marketplace FAQs

20. Cortex CLI

#### Note

* The CLI Read Only Role is not supported for CWP as the system does not support offline mode.

  20.1. Connect Cortex CLI

#### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

#### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Cortex Cloud Application Security, refer to Cortex CLI usage for Cortex Cloud Application Security

#### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

  20.2. Cortex CLI common command line reference guide

#### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

  20.3. Cortex CLI for Cloud Workload Protection

#### Prerequisite

* Ensure you have the required user permissions. Refer to Cortex CLI for more information Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more information Verify that Java version 11 and above is installed: Run java -version in your terminal. If not, refer to Java SE Development Kit 11.0.25 for information about installing Java

* Before you begin, ensure you have sudo privileges to execute the image scan.

#### Note

* The output contains the number of created issues for malware, secrets, and vulnerabilities, organized by severity, based on the current policy configuration.

  20.3.1. Cloud Workload Protection command line reference

  20.4. Cortex CLI for API Security

#### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more information Ensure your application exposes APIs and provides a corresponding OpenAPI Specification file Ensure that you have installed Java v 11 and above

  20.4.1. Cortex CLI API Security command line reference guide

  20.5. Cortex CLI for Cortex Cloud Application Security

#### Prerequisite

* For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

  20.5.1. Cortex CLI usage for Cortex Cloud Application Security

  20.5.2. Cortex CLI Cortex Cloud Application Security command line reference

#### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

#### Important

* The Cortex CLI Cortex Cloud Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id...

  20.5.3. CLI pipeline code snippets

  20.6. Migrate Cortex CLI

#### Prerequisite

* Before you begin, ensure you have the following: Ensure you have an active API key for your Cortex Cloud tenant with associated CLI role permissions. Refer to Manage API keys for more information Install the Cortex CLI. You can find the installation instructions here

21. Cortex Cloud XQL

  21.1. Get started with XQL

  21.1.1. XQL language features

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

#### Navigation

  You submit XQL queries to Cortex Cloud using the Investigation & Response → Search → Query Builder user interface

  21.1.2. XQL Language Structure

#### Note

* Specifying a dataset is not required because Cortex Cloud uses xdr_data as the default dataset. If you have more than one dataset or lookup, you can change your default dataset by navigating to Settings → Configurations → Data Management → Dataset Management, right-click on the appropriate dataset, and select Set as default.

* You can also build a query that investigates data in both a cold dataset and hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide. For more information on hot and cold storage, see Dataset management.

  21.1.2.1. Adding comments in queries

  21.1.3. Supported operators

#### Note

* In some cases, using an IN or NOT IN operator combined with a dataset and filterfilter stage can be a better alternative to using a join stage.

  21.1.4. Datasets and presets

#### Note

* To set up this Cloud Identity Engine (previously called Directory Sync Service (DSS)) dataset, you need to set up a Cloud Identity Engine. Otherwise, you will not have a pan_dss_raw dataset. For more information, see Set up Cloud Identity Engine.Set up Cloud Identity Engine

* INFO issues are not included in this dataset. The issue fields included in this dataset are limited to certain fields available in the API. For the full list, see Get Alerts Multi-Events v2 API.

* The fields contained in this dataset are a subset of the fields in the xdr_data dataset.

* If the vendor and product are not specified in the Winlogbeat profile's configuration file, Cortex Cloud creates a default dataset called microsoft_windows_raw.

* To ensure GlobalProtect access authentication logs are sent to Cortex Cloud, verify that your PANW firewall's Log Settings for GlobalProtect has the Cortex Data Lake checkbox selected.

* You can query in XQL for this data and build widgets based on the xdr_data dataset or using the preset device_control. To view in an XQL query these events, the Device Configuration of the endpoint profile must be set to Block. Otherwise, the USB events are not captured. The events are also captured when a group of device types are blocked on the...

  21.1.5. About examples

#### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

  21.1.6. JSON functions

#### Important

* JSON field names are case sensitive, so the key to field pairing must be identical in an XQL query for results to be found. For example, if a field value is "TIMESTAMP" and your query is defined to look for "timestamp", no results will be found.

  21.1.7. How to filter for empty values in the results table

  21.1.8. Understanding string manipulation in XQL

  21.2. Build XQL queries

  21.2.1. About the Query Builder

#### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

  21.2.2. How to build XQL queries

#### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex Cloud. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

#### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  21.2.2.1. Get started with XQL queries

  21.2.2.2. Useful XQL user interface features

#### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

  21.2.2.3. XQL Query best practices

  21.2.2.4. Expected results when querying fields

  21.2.2.5. Create XQL query

#### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

  21.2.2.6. Review XQL query results

#### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* In order for Cortex Cloud to provide a histogram for a field, the field must not contain an array or a JSON object.

  21.2.2.7. Translate to XQL

#### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

  21.2.2.8. Graph query results

#### License Type

  Building Cortex Query Language (XQL) queries in the Query Builder requires a Data Collection add-on.

#### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

  21.2.3. XQL query entities

  21.2.3.1. Create authentication query

#### Navigation

  Investigation & Response → Search → Query Builder

  21.2.3.2. Create event log query

#### Navigation

  Investigation & Response → Search → Query Builder

  21.2.3.3. Create file query

#### Navigation

  Investigation & Response → Search → Query Builder

  21.2.3.4. Create image load query

#### Navigation

  Investigation & Response → Search → Query Builder

  21.2.3.5. Create network connections query

#### Navigation

  Investigation & Response → Search → Query Builder

  21.2.3.6. Create network query

#### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

  21.2.3.7. Create process query

#### Navigation

  Investigation & Response → Search → Query Builder

  21.2.3.8. Create registry query

#### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

  21.2.3.9. Query across all entities

#### Navigation

  Investigation & Response → Search → Query Builder

  21.2.4. Edit and run queries in Query Center

#### Navigation

  Investigation & Response → Search → Query Center

  21.2.4.1. Query Center reference information

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  21.2.5. Manage scheduled queries

#### Navigation

  Investigation & Response → Search → Scheduled Queries

  21.2.5.1. Scheduled Queries reference information

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  21.2.6. Manage your personal query library

#### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

  21.3. Stages

  21.4. Functions

22. Graph Search

  22.1. What is Graph Search?

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

#### Note

* Graph Search is a Beta feature and is still subject to changes. To enable the feature in your tenant, contact your Customer Support Team.

  22.2. Get started with Graph Search queries

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

#### Navigation

  Understand your assets and findings data: Graph Search queries are based on the current data that has been collected for assets and findings from the data sources configured and then sent to the Unified Asset Inventory (UAI), which is displayed in the All Assets page (Inventory → Assets → All Assets

  22.3. How to build Graph Search queries?

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

#### Navigation

  You submit Graph Search queries using the Investigation & Response → Search → Query Builder → Graph Search built-in query interface

  22.4. Understand Graph Search query results

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  22.5. Create Graph Search query

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

#### Note

* For more information about the Query Library, see Manage Graph Search Query Library.

#### Tip

* After running the query, you can view the complete query by hovering over the last THAT... in the Graph Search query interface, and the query is displayed in a tooltip. If your query doesn't find any results or you want to change your query for any reason, you can always click anywhere in the Graph Search query interface, where your existing query is...

  22.6. Graph Search examples

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  22.7. Manage Graph Search Query Library

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

#### Navigation

  From Graph Search in the Query Builder Select Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Center

  22.8. Edit and run queries in Query Center

#### Navigation

  Investigation & Response → Search → Query Center

  22.8.1. Query Center reference information

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  22.9. Supported assets and findings

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  22.10. FAQ on Beta Graph Search feature

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).


## Cortex Cloud Runtime Security Documentation


---

## 1. Get started with Cortex Cloud

### 1.1. What is Cortex Cloud?

#### 1.1.1. Key features

### 1.2. What is Cortex Cloud Runtime Security?

### 1.3. Use the interface

### 1.4. Understand your user persona

### 1.5. Understand license plans

#### 1.5.1. Data retention

### 1.6. Fair Usage policy for Cortex Cloud

## 2. Onboard and configure Cortex Cloud

### 2.1. Plan and prepare

### 2.2. Deployment steps and checklist

#### 2.2.1. Activate Cortex Cloud

##### Prerequisite

* The Cortex Cloud activation email. A Customer Support Portal (CSP) account. You need to set up your CSP account. For more information, see How to Create Your CSP User Account. When you create a CSP account, you can set up two-factor authentication (2FA) to log into the CSP by using an Email, Okta Verify, or Google Authenticator (non-FedRAMP accounts)....

##### Note

* Activation can take about an hour and does not require you to remain on the activation page. Cortex Cloud sends a notification to your email when the process is complete.

* You can only change the subdomain once, and it cannot be undone. After deleting the subdomain, you can reuse it after 7 days.

##### 2.2.1.1. Bring your own keys

###### Prerequisite

* Access to BYOK (Bring Your Own Keys) functionality is restricted to tenants that were initially activated with BYOK.

* To disable your encryption keys and deactivate a tenant, you must have an Account Admin role.

###### Note

* To enable the feature in your tenant, contact your account representative.

* The new keys you import will serve as primary encryption keys for newly generated data.

* At any stage, you can select Continue Later to pause the process. To resume the process, in the Cortex gateway, select Continue Setup next to the tenant, and follow the wizard instructions from the point you left off, as detailed below. If you don't use either of your wrapping keys within three days, they expire and you'll have to restart the process.

* BYOK requires a 32-byte, symmetric, unencoded key in binary format.

###### Caution

* Disabling all encryption keys and deactivating the tenant renders the tenant inaccessible and non-operational. Disabling the keys affects the communication with the agents, may prevent the agents from receiving updates to policies, configurations, and crucial information, and may result in loss of data. To secure your tenant data and to prevent...

##### 2.2.1.2. Cortex Cloud supported regions

##### 2.2.1.3. Enable access to required PANW resources

###### Note

* <tenant-name> refers to the selected subdomain of your Cortex Cloud tenant, and <region> is the region in which your tenant is deployed. For more information, see Cortex Cloud supported regions.

#### 2.2.2. Upgrade from Prisma Cloud to Cortex Cloud

##### 2.2.2.1. Overview

###### Note

* Your Prisma Cloud tenant remains available and fully operational during the agreed upgrade period.

##### 2.2.2.2. Link Cortex Cloud to Prisma Cloud

###### Navigation

  Settings → Configurations → Upgrade Helper

##### 2.2.2.3. Copy content

###### Navigation

  Settings → Configurations → Upgrade Helper

###### 2.2.2.3.1. Copy Global configurations

####### Note

* Scope-Based Access Control (SBAC) configurations, such as resources or account lists are not copied. You can manually assign scope-based access to the relevant users or groups.

####### Navigation

  Settings → Configurations → Access Management

###### 2.2.2.3.2. Copy CSPM configurations

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Security

  Posture Management → Rules & Policies → Policies → Cloud Security

  Investigation & Response → Automation → Automation Rules

  Posture Management → Compliance → Standards

###### 2.2.2.3.3. Copy CWP configurations

####### Navigation

  Posture Management → Rules & Policies → Cloud Workload

##### 2.2.2.4. Migrate Cortex CLI

###### Prerequisite

* Before you begin, ensure you have the following: Ensure you have an active API key for your Cortex Cloud tenant with associated CLI role permissions. Refer to Manage API keys for more information Install the Cortex CLI. You can find the installation instructions here

#### 2.2.3. Set up users and roles

##### Note

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* The user who activated the Cortex product is assigned the Account Admin role. You cannot create additional Account Admin roles in the Cortex Cloud tenant. If you do not want the user to have Account Admin permission, you must remove the Account Admin role in Cortex Gateway.

##### 2.2.3.1. User group management

###### Note

* You can create user groups in the tenant or Cortex Gateway. User groups created in Cortex Gateway cannot be mapped to SAML groups. Only user groups created in the tenant support SAML group mapping and scoring. We recommend creating user groups in the Cortex tenant because: User groups are available for all tenants, and you may want different user...

* If users have been created in the CSP, but you want them to access the tenant through SSO only, skip this field and add only SAML group mapping after SSO is set up, otherwise, users can access the tenant through both the CSP and SSO. If you have not yet created any users, skip this field and add them later. See Set up authentication .

* When using Azure AD for SSO, the SAML group mapping needs to be provided using the group object ID (GUID) and not the group name.

###### Important

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

##### 2.2.3.2. Assign user roles and groups

###### Note

* If an existing user in the Cortex Gateway no longer has a role or a user group assigned, the user is revoked. Any roles, user groups, or egress configurations created by that user are shown as created by Revoked user instead of the user's email address.

###### Important

* Setting Cortex Query Language (XQL) dataset access permissions for a user role can only be performed from Cortex Cloud Access Management. For more information, see Manage user roles.

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit Users Permissions.

#### 2.2.4. Manage API keys

##### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

* You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

#### 2.2.5. Set up authentication

##### Tip

* You should have at least one user in the Customer Support Portal for backup, in case of any authentication issues with your IdP provider.

##### 2.2.5.1. Authenticate users through the Customer Support Portal

###### Note

* You must be assigned the Super User role in the Customer Support Portal to add users in the Customer Support Portal. The first Super User who logs into Cortex Gateway is automatically assigned the Account Admin role and has access to the tenant. The user who activates the Cortex Cloud tenant will also be assigned the Account Admin role (if there is no...

* After users are added to the Customer Support Portal and they accept the invitation, you can manage them in Cortex Gateway or the Cortex Cloud tenant.

##### 2.2.5.2. Authenticate users using SSO

###### Note

* To set up SSO authentication in the tenant, you must be assigned an Instance Administrator or Account Admin role. SAML 2.0 users must log in to Cortex Cloud using the FQDN (full URL) of the tenant. To allow login directly from the IdP to , you must set the relay state on the IdP to the FQDN of the tenant. If you have multiple tenants, you must set up...

* The first SSO cannot be deleted, it can only be deactivated by toggling SSO Enabled to off. The Domain parameter is predefined for the first SSO. If you add additional SSO providers, you must provide the email Domain in the SSO Integration settings for all providers except the first. Cortex Cloud uses this domain to determine to which identity provider...

* Cortex Cloud requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex Cloud. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a...

##### 2.2.5.3. Set up Okta as the Identity Provider Using SAML 2.0

###### Note

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

##### 2.2.5.4. Set up Azure AD as the Identity Provider Using SAML 2.0

###### Note

* The default attributes shown on the main single sign-on page in Azure AD are not the values you need. You must click Edit next to Attributes and Claims to view and copy the actual values.

* The attribute claim name must exactly match the value sent by your IdP. In some cases, this may be the full attribute name/namespace, depending on the configuration of our IdP

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Important

* When copying the Single Sign-On URL value, remove idp/saml and leave the trailing /. For example, if the Single Sign-On URL is https://clientname.panproduct.region.paloaltonetworks.com/idp/saml, just copy https://clientname.panproduct.region.paloaltonetworks.com/.

#### 2.2.6. Ingest cloud assets

##### Note

* The cloud accounts being onboarded must be owned by the customer performing the onboarding process.

##### 2.2.6.1. Onboard Google Cloud Platform

###### Prerequisite

* Before you begin, ensure you have: Access to Google Cloud Console Admin user with required admin GCP permissions Enabled the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled) Enabled the following APIs in the GCP project you are...

###### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only modify the instance from the Data Sources page.

###### 2.2.6.1.1. Manually upload template to GCP

####### Prerequisite

* Before you begin, ensure you have: A GCP account. Permission to create the required resources in Google Cloud Deployment Manager. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool.

####### Note

* The directory you create must be a subdirectory of the home directory.

###### 2.2.6.1.2. Configure GCP integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

###### 2.2.6.1.3. Monitor GCP resources inside service perimeters

####### Note

* Each GCP cloud instance is assigned a scope within GCP. If the scope, whether it be organization, folder, or project, includes any projects with a service perimeter, this procedure must be performed for that cloud instance to authorize Cortex Cloud to scan the resources in the perimeter.

##### 2.2.6.2. Onboard Amazon Web Services

###### Prerequisite

* Before you begin, ensure you have: Access to AWS Management Console Required AWS permissions

###### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* When onboarding an AWS organization or organizational unit (OU), Cortex Cloud creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

* See the prerequisites above for specific permissions required for serverless functions.

* If you select Automated, you must already be logged in to AWS.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only edit the instance from the Data Sources page. (AWS only) instances that were previously created in the Automation...

###### 2.2.6.2.1. Manually upload template to AWS

####### Prerequisite

* Before you begin, ensure you have: An AWS account Access to AWS Management Console Permission to create a stack and its resources in AWS CloudFormation

###### 2.2.6.2.2. Configure AWS integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

##### 2.2.6.3. Onboard Microsoft Azure

###### Prerequisite

* Before you begin, ensure you have: An Azure subscription Admin permissions required to onboard Azure or the built-in Security Administrator role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups.

###### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only modify the instance from the Data Sources page.

###### 2.2.6.3.1. Manually upload template to Microsoft Azure Resource Manager using the CLI

####### Prerequisite

* Ensure the Azure CLI tool is installed and you are authorized to create management group policies.

###### 2.2.6.3.2. Manually upload template for Microsoft Azure subscriptions

####### Prerequisite

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the subscription scope. We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed Terraform on your local machine. You can download Terraform from the official...

* Ensure the Azure CLI tool is installed and you are authorized to create management group policies.

###### 2.2.6.3.3. Configure Azure integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

##### 2.2.6.4. Onboard Oracle Cloud Infrastructure

###### Prerequisite

* Before you begin, ensure you have: Access to Oracle Cloud Infrastructure console Permissions for all of the following are required:    Creation of identity groups (for more information, refer to Managing Groups)   Policies (for more information, refer to How Policies Work)   Tag namespaces in the root compartment (for more information, refer to Tags...

###### Note

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only; you can only modify the instance from the Data Sources page.

###### 2.2.6.4.1. Manually upload template to OCI

####### Prerequisite

* Before you begin, ensure you have: An Oracle Cloud Infrastructure account and the tenancy OCID. Permission to deploy a custom template and create its resources in OCI. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed...

##### 2.2.6.5. Manually connect a cloud instance

##### 2.2.6.6. Outposts

###### Prerequisite

* Before you begin, ensure you have: An AWS account Permission to create a stack and its resources in AWS Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the AWS CLI tool and configured your profile with the aws...

* Before you begin, ensure you have: A GCP account Permission to create the required resources in Google Cloud Deployment Manager Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool

* Before you begin, ensure you have: An active Azure subscription. Installed the Azure CLI tool. Permission to deploy a custom template and create its resources in Microsoft Azure ("Owner" or "Contributor" on the designated outpost subscription scope, and Active Directory "Cloud Application Administrator" or "Application Administrator" privileged...

###### Note

* We recommend you use a dedicated account for the outpost, free from other resources. You can only onboard one outpost for each account.

* When creating an outpost for a specific Azure subscription, the outpost account must be in the same Azure organization as the monitored subscriptions.

###### Navigation

  Settings → Data Collection → Outposts

  You can create a new outpost by navigating to Settings → Data Collection → Outposts and clicking New Outpost

##### 2.2.6.7. Onboard the Kubernetes Connector

###### Note

* For GKE or EKS clusters with the metadata service disabled and for AKS clusters with non-default nodes managed resource group, the cluster resource identifier must be specified.

###### 2.2.6.7.1. What's new in Kubernetes Connector?

##### 2.2.6.8. Container Registry Scanning

###### 2.2.6.8.1. Overview of container registry scanning

####### 2.2.6.8.1.1. Registry Components

####### 2.2.6.8.1.2. How Container Registry Scanning Works

###### 2.2.6.8.2. Configure registry scanning

####### Prerequisite

* Ensure that you have performed the all steps till Additional Security Capabilities as listed in the onboarding wizard for the required CSP: Onboard Amazon Web Services Onboard Google Cloud Platform Onboard Microsoft Azure

###### 2.2.6.8.3. Modify the container registry scanning scope

###### 2.2.6.8.4. Scan re-evaluation process

###### 2.2.6.8.5. Connect Docker V2 compliant container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

####### Note

* Scanning is supported only for private repositories on Docker Hub.

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* FedRAMP is not supported for this mode.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.8.5.1. Manage a Docker V2 connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

###### 2.2.6.8.6. Connect JFrog container registry

####### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

####### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

####### 2.2.6.8.6.1. Manage a JFrog connector

######## Note

* If you selected Scan with Broker VM mode, you can't change to a different scan mode (such as Cloud Discovery or Scan with Outpost) when you edit the instance. When editing an instance configured for Scan with Broker VM, you must re-enter your authentication credentials, including Username, Password, and CA certificate.

##### 2.2.6.9. Cloud service provider permissions

###### 2.2.6.9.1. Amazon Web Services provider permissions

###### 2.2.6.9.2. Google Cloud Platform provider permissions

###### 2.2.6.9.3. Microsoft Azure provider permissions

###### 2.2.6.9.4. Oracle Cloud Infrastructure provider permissions

### 2.3. Post-deployment steps

#### 2.3.1. Set up your environment

##### 2.3.1.1. Configure server settings

###### Note

* Keyboard shortcuts, timezone, and timestamp format are not set universally and only apply to the user who sets them.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

###### Navigation

  Settings → Configurations → General → Server Settings

##### 2.3.1.2. Configure security settings

##### 2.3.1.3. Log forwarding

###### 2.3.1.3.1. Forward logs from Cortex Cloud to external services

####### 2.3.1.3.1.1. Integrate a syslog receiver

######## Note

* Up to TLS 1.3 is supported. Make sure the self-signed CA includes your public key.

####### 2.3.1.3.1.2. Integrate Slack for outbound notifications

######## Note

* You are directed to the Slack browser to install Cortex Cloud. You can only use this link to install Cortex Cloud on Slack. Attempting to install from Slack Marketplace will redirect you to Cortex Cloud documentation.

####### 2.3.1.3.1.3. Configure notification forwarding

######## Prerequisite

* Before you can select a syslog receiver or a Slack channel, you must integrate these external services with Cortex Cloud. For more information, see: Integrate a syslog receiver Integrate Slack for outbound notifications

######## Note

* To configure notification forwarding for issues by domain, select Log Type = Issues and filter the Issues table by Issue Domain.

* When a notification is sent for each configured format.

####### 2.3.1.3.1.4. Monitor administrative activity

###### 2.3.1.3.2. Log notification formats

####### 2.3.1.3.2.1. Management audit log messages

####### 2.3.1.3.2.2. Issue notification format

####### 2.3.1.3.2.3. Agent Audit log notification format

####### 2.3.1.3.2.4. Management Audit log notification format

####### 2.3.1.3.2.5. Log format for IOC and BIOC issues

####### 2.3.1.3.2.6. Analytics log format

####### 2.3.1.3.2.7. Log formats

######## Note

* The FUTURE_USE tag applies to fields that Cortex Cloud does not currently implement.

#### 2.3.2. Manage user roles and access management

##### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

##### Note

* For more information on assigning user roles when generating an API key, see Manage API keys.

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* For features where scoping is not applicable, Role-Based Access Control (RBAC) is used and can be configured when managing user roles. For more information, see Manage user roles.

##### 2.3.2.1. Manage user access

###### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Note

* You can only reduce the permissions of an Account Admin user via Cortex Gateway.

* User permissions for components and datasets are based on the access permissions set in the user role. For more information on editing these user role permissions, see Manage user roles.

###### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex Cloud are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit User Permissions.

###### Navigation

  Settings → Configurations → Access Management → Users

###### 2.3.2.1.1. User access reference information

##### 2.3.2.2. Manage user roles

###### Prerequisite

* Managing user roles in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Navigation

  Settings → Configurations → Access Management → Roles

##### 2.3.2.3. Manage user scope

###### Prerequisite

* Configuring user scopes in Cortex Cloud Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles. By default, Enable Scope Based Access Control is...

###### Note

* This configuration can impact the visibility of the related Security domain in the Cases and Issues scope area, but with not affect asset visibility.

* For Cases and Issues domains, a workaround is to create a Dataset View for each required combination of domains, and allow the relevant entity access only to this Dataset View, not to the underlying cases and issues datasets.

* Make sure to assign the required default granular scoping for users. This depends on the structure and divisions within your organization and the particular purpose of each organizational unit to which scoped users belong.

###### Important

* Some areas and features in Cortex Cloud do not respect SBAC. In these cases, use RBAC permissions to restrict access.

* Before configuring, ensure that you review the Understand scoping section.

#### 2.3.3. Dashboards and reports

## 3. Endpoint security

### 3.1. Endpoint protection

#### 3.1.1. Malware protection

#### 3.1.2. Exploit protection

#### 3.1.3. File analysis and protection flow

##### Note

* To enhance performance and efficiency, hash verdict requests from the Cortex XDR agent will be routed to the WildFire service with the lowest latency. File uploads for analysis will strictly adhere to the designated Cortex Cloud and WildFire regions, ensuring data remains within the appropriate geographical boundaries.

#### 3.1.4. Endpoint protection capabilities

#### 3.1.5. Endpoint protection modules

#### 3.1.6. Processes protected by exploit security policy

#### 3.1.7. File Integrity Monitoring (FIM)

##### License Type

  FIM requires the Cortex Cloud Runtime Security add-on.

##### Note

* Google Kubernetes Engine (GKE) is currently not supported

* It is recommended to create a policy that targets only the necessary files and folders.

* Platform cannot be changed once a rule group has been created

* A rule group can contain up to 100 rules.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* It is possible to manage up to 15,000 events per day (24 hours) for each host/container.

##### Navigation

  Creating, modifying and viewing FIM rule groups and rules is be done in the Rule Groups page, located at the Inventory → Endpoints → File Integrity Monitoring menu

  In Inventory → Endpoints → Policy management → Extensions → Profiles, select +Add Profile and then select either Create New or Import from File

#### 3.1.8. WildFire analysis concepts

##### Note

* In cases when the Cortex Cloud agent gets a failed status from the WF service due to a general error or unsupported file type, and the Local Analysis is set to disabled or not applicable, Cortex Cloud will not generate an alert on the file.

#### 3.1.9. Guidelines for keeping Cortex XDR agents and content updated

##### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups. See how to define endpoint group.

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups.

##### Important

* When planning Cortex XDR agent upgrades and content updates, consult with the appropriate stakeholders and teams and follow the change management strategy in your organization.

##### Caution

* Before enabling Auto-Update for Cortex XDR agents, make sure to consult with all relevant stakeholders in your organization.

#### 3.1.10. About content updates

##### Note

* Cortex Cloud delivers the content update to the agent in parts and not as a single file, allowing the agent to retrieve only the updates and additions it needs.

#### 3.1.11. Endpoint data collection

##### Note

* For specific files only and only if the file was written.

##### Important

* Registry key is collected as a real key name, and not as a symbolic link. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, KEY_LOCAL_MACHINE\System\ControlSet001 will be collected. Instead of HKEY_CURRENT_USER, HKEY_USERS\<SID> will be collected, where SID is a SID of the current user.

### 3.2. Install and manage endpoints

#### 3.2.1. Set up endpoint protection

##### 3.2.1.1. Set up endpoint profiles and exception rules

###### Note

* Profiles associated with one or more targets that are beyond the scope of your defined user permissions are locked, and cannot be edited.

###### 3.2.1.1.1. Set up malware prevention profiles

####### Note

* In this profile, the Report options configure the endpoints to report the corresponding suspicious files, actions, processes, or behaviors to Cortex Cloud, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* As part of the anti-malware security flow, the Cortex XDR agent leverages the operating system's capability to identify revoked certificates for executables, and DLL files that attempt to run on the endpoint by accessing the Windows Certificate Revocation List (CRL). To allow the Cortex XDR agent access the CRL, you must enable internet access over...

* The Quarantine Malicious Executables feature is not available for malware identified on network drives.

* The Quarantine Malicious Script Files feature is not available for malware identified on network drives.

* If on-write actions were configured in earlier versions of Cortex Cloud, the same configuration has been preserved and applied globally for all file types. On-write file protection may have an impact on the resources required by the Cortex XDR agent.

* On-demand file protection may have an impact on the resources required by the Cortex XDR agent.

* We recommend that you disable scheduled scanning. VDI machine scans are based on the golden image and additional files will be examined upon execution.

* When periodic scanning is enabled in your profile, the Cortex XDR agent initiates an initial scan when it is first installed on the endpoint, regardless of the periodic scanning scheduling time.

* When you are actively evaluating with BAS tools, it is recommended to enable the BAS mode setting only for the duration of your evaluation, and for a limited number of agents.

* BAS tools mode with content older than version 1850 cannot be configured, the agent will be treated as Enabled.

* The Quarantine Malicious Mach-O Files feature is not available for malware identified on network drives.

* This module is supported by Cortex XDR agent 8.1.0 and later releases.

* Enabling on-demand scanning will automatically scan these core system directories: /etc, /tmp, /home, /usr, /bin, /sbin, /lib, /var, /opt, /dev, /root, /boot.

* The Quarantine Malicious ELF Files feature is not available for malware identified on network drives.

* Blocking functionality is different for each security module. For SMS/MMS, Cortex XDR agent will move detected messages containing such URLs from unknown senders to the Junk folder.

* Ensure that the same numbers are not added multiple times with different leading zeros.

* To fully enable the Safari browser security module on the device side, each iOS device user must enable the Safari Safeguard module on the device, and grant it permission to work on all websites. If the iOS device user does not do this, the endpoint's operation status is reported as Partially Protected. The Safari browser security module will only...

* Cortex XDR agent version 8.4 or higher are required for this feature.

####### Warning

* For optimal user experience, we recommend that you set the action mode to either Allow or Run Local Analysis.

###### 3.2.1.1.2. Set up exploit prevention profiles

####### Note

* In this profile, the Report options configure the endpoints to report the corresponding exploit attempts to Cortex Cloud, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* In exploit prevention profiles, if you change the action mode for processes, you must restart the protected processes for the following security modules to take effect on the process and its forked processes: Brute Force Protection Java Deserialization SO Hijacking

* This step provides a temporary workaround for the following publicly known information-security vulnerabilities and exposures: CVE-2021-24074, CVE-2021-24086 and CVE-2021-24094.

* If you have Windows endpoints in your network that are unpatched and exposed to a known vulnerability, we strongly recommend that you upgrade to the latest Windows Update that has a fix for that vulnerability.

####### Warning

* This workaround applies only to the specific Windows versions listed as exposed to these CVEs, and requires a Cortex XDR agent release 7.1 or later and content 167-51646 or later. This workaround is not recommended for non-persistent, stateless, or linked-clone environments. In some cases, enabling this workaround can affect the network functionality...

###### 3.2.1.1.3. Set up agent settings profiles

####### License Type

  Requires a Cortex XDR Pro per Endpoint license. When you enable this feature, a Cortex XDR Pro per Endpoint license is consumed.

  Requires Host Insights add-on.

  Requires Forensics Add-on.

####### Prerequisite

* User Space Agent mode requires Linux kernel 5.0.0 or higher.

####### Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

* You can enable the option to maintain a persistent notification regarding the disconnection of the endpoint from the network. The settings Persistent Isolation Notification and Blocked Connectivity Notification must be enabled. Until the threat on the endpoint has been removed, the endpoint remains disconnected from the network.

* In Traps 5.0.6 and later releases, when protection is enabled, access will be read-only. In earlier Traps releases, enabling protection disables all access to services, processes, files, and registry values.

* If you choose the Enable option, you must also enable XDR Agent Tampering Protection in the malware profile and set it to Block. Ensure that both profiles are assigned to the same endpoints.

* When you enable Cortex XDR agent registration with the Windows Security Center, Windows automatically shuts down Microsoft Defender on Windows-based workstation endpoints. If you still want to allow Microsoft Defender to run on a workstation endpoint where Cortex Cloud is installed, you must use the Disable option. However, Palo Alto Networks does not...

* To enable access to these options, scroll down to Network Location Configuration, and set Action Mode to Enabled.

* When using Nmap, the Cortex XDR agent downloads an Nmap driver for the duration of the scan and removes the driver upon completion. If an Nmap scan is in process, Cortex Cloud identifies the Nmap driver and places any additional scans in a queue.

* If you disable content updates for a newly installed agent, the agent retrieves the content for the first time from Cortex Cloud, and then disables content updates on the endpoint. When you add a Cortex XDR agent to an endpoint group with a disabled content auto-upgrades policy, the policy is applied to the added agent as well.

* Automatic upgrades are not supported with non-persistent VDI and temporary sessions.

* Limitations in the content download process: When you install the Cortex XDR agent, the agent retrieves the latest content update version available. A freshly installed agent can take between five to ten minutes (depending on your network and content update settings) to retrieve the content for the first time. During this time, your endpoint is not...

* If the Cortex XDR agent is initially unable to communicate without the local store, enforcement is not enabled and the agent will show as partially protected.

* If you choose the Enabled option, you must also set Anti Tampering Protection in the malware security profile to Block, and ensure that both profiles are assigned to the same endpoints.

* Automatic upgrades are not supported for XDR agents running on K8s.

* User Space Agent mode requires Linux kernel 5.0.0 or higher. Endpoints running an older Linux kernel version with this fallback enabled, will not start using User Space Agent mode, and will operate asynchronously.

####### Warning

* If you disable or delay automatic-content updates provided by Palo Alto Networks, it may affect the security level in your organization.

###### 3.2.1.1.4. Set up restrictions prevention profiles

####### Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Configure custom BIOC prevention rules here:

* Wildcards are supported.

###### 3.2.1.1.5. Set up exception profiles and rules

####### 3.2.1.1.5.1. Exception configuration

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Settings → Exception Configuration → Legacy Exceptions and click Start Simulation

####### 3.2.1.1.5.2. Issue exclusions

######## Note

* The agent continues to generate excluded issues on the endpoint, but they are not saved or displayed in Cortex Cloud. Configuration of an issue exclusion does not remove or delete any of the logs that would have triggered the issue notification. You can also set up issue exceptions by creating global endpoint policy exceptions. For more information,...

######## Navigation

  The Settings → Exception Configuration → Issue Exclusions page displays the issue exclusion rules in Cortex Cloud

####### 3.2.1.1.5.3. Add an IOC or BIOC rule exception

######## Note

* Cortex Cloud only supports exceptions with one attribute. See Add an alert exclusion rule to create advanced exceptions based on your filtered criteria.Add an alert exclusion rule

######## Navigation

  Settings → Exceptions Configuration → IOC/BIOC Suppression Rules

####### 3.2.1.1.5.4. Add a disable prevention rule for endpoints

######## Important

* All applicable prevention actions are skipped for the files and process that match the properties defined in the rule. Consider the consequences of disabling a prevention rule before you add the exception, and monitor it over time. You can only apply a Disable Prevention Rule to endpoints running Cortex XDR agents version 7.9 and later.

######## Navigation

  Settings → Exception Configuration → Disable Prevention Rules

####### 3.2.1.1.5.5. Add a disable injection and prevention rule

######## Important

* Exceptions are limited up to 48 hours by default and configurable up to one week. Consider the consequences of disabling a prevention rule before you add the exception and monitor it over time. You can only apply a Disable Prevention Rule to agents version 7.9 and later.

######## Navigation

  Settings → Exception Configuration → Disable Injection and Prevention

####### 3.2.1.1.5.6. Add a support exception rule for endpoints

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Your migrated rules are displayed on the Settings → Exception Configurations → Support Exception Rules page

  From Settings → Exception Configuration → Support Exception Rules, click + Import from file

####### 3.2.1.1.5.7. Add a legacy exception rule for endpoints

######## Note

* This exception prevents the agent from examining the specified file. Use with caution, as it may unintentionally allow unwanted or malicious behavior to go undetected.

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Your migrated rules are displayed on the Settings → Exception Configurations → Legacy Agent Exceptions page

##### 3.2.1.2. Define endpoint groups

###### Note

* Disconnecting Cloud Identity Engine in your Cortex Cloud deployment can affect existing endpoint groups and policy rules based on Active Directory properties.

##### 3.2.1.3. Configure global agent settings

###### Note

* Disabling this capability takes immediate effect on new hashes, fresh agent installations, and existing security policies. It could take up to a week to take effect on existing agents in your environment pending agent caching.

* If you have any Cortex Cloud filters, starring policies, exclusion policies, scoring rules, log forwarding queries, or automation rules configured for XSOAR/3rd party SIEM, we advise you to update those to support the changes before activating the feature. For example, change the query to include the previous description that is still available in the...

##### 3.2.1.4. Apply profiles to endpoints

###### Note

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

##### 3.2.1.5. Create an agent installation package

###### Note

* The profile will be applied if the security policy cannot be retrieved in real-time.

* The Cortex serverless library must be imported after other libraries to activate the hooks that enable auditing.

###### 3.2.1.5.1. Manage an agent installation package

####### Note

* Since Cortex Cloud relies on the installation package ID to approve agent registration during the installation, we recommend that you don't delete the installation package of active endpoints. If you install the Cortex XDR agent from a package after you delete it, Cortex Cloud denies the registration request leaving the agent in an unprotected state....

##### 3.2.1.6. Harden endpoint security

###### Navigation

  From Inventory → Endpoints → Policy Management → Extensions → Profiles, you can create profiles for the following hardened endpoint security capabilities

  To apply the profiles, from Inventory → Endpoints → Policy Management → Extensions → Policy Rules, you can view all the policy rules per operating system

###### 3.2.1.6.1. Device control

####### Note

* Operating systems report on devices in different ways. Sometimes, the same BLE device will report different services and interfaces, depending on the host's operating system. This may have an effect on the specific BLE services that are blocked for each operating system. Depending on your defined user scope permissions, creating device profiles,...

* For network printer print jobs, ensure that you also configure the Agent Settings profile, Network Location Configuration option. This setting must be set to Enabled, and configured. If you do not enable and configure this setting, all network printer operations will be treated as internal network print jobs. For network printer print jobs, ensure that...

* Currently, the default is set to Use Default (Allow), however, Palo Alto Networks may change the default definition at any time.

* You cannot edit or delete the default profiles pre-defined in Cortex Cloud.

* You cannot edit or delete the predefined profiles in Cortex Cloud.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* Permanent exceptions apply across platforms, allowing the devices on all operating systems.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

####### Navigation

  Endpoints → Policy Management → Settings → Device Management

###### 3.2.1.6.2. Host firewall

####### 3.2.1.6.2.1. Host firewall for Windows

######## Note

* A rule is always part of a rules group. It cannot stand on its own. A rule can belong to one rules group only and cannot be reused in different groups.

* When selecting ICMP protocol, you must enter a the ICMP Type and Code. Without these values the ICMP protocol is ignored by the Windows and macOS Cortex XDR agents.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows. New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until target is specified.

* The data is aggregated and reported periodically every 60 minutes since the first time the host firewall policy was enforced on the endpoint, not every round hour. The table lists enforcement events only for rules set to Report Matching Traffic.

######## Navigation

  From Inventory → Endpoints → Policy Management → Extensions and select + Add Profile or Import from File

####### 3.2.1.6.2.2. Host firewall for macOS

######## Note

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

######## Navigation

  From Inventory → Endpoints → Policy Management → Extensions Profiles → Profiles, select + New Profile or Import from File

  Additionally, to monitor the communication on your macOS endpoint, you can use the following operating system utilities: From the endpoint System Preferences → Security and Privacy → Firewall → Firewall options, you can view the list of blocked and allowed applications in the firewall

###### 3.2.1.6.3. Disk encryption

####### Note

* You must select the same encryption method configured by the Microsoft Windows Group Policy in your organization for the target endpoints. Otherwise, if you select a different encryption method than the one already applied through the Windows Group Policy, Cortex Cloud displays errors.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

####### Navigation

  You can monitor the Encryption Status of an endpoint in the Inventory → Endpoints → Disk Encryption Visibility table

###### 3.2.1.6.4. Host Inventory

####### Note

* Cortex Cloud includes only the first 10,000 results per endpoint. Cortex Cloud lists only users that belong to each group directly, and does not include users who belong to a group within the main group. If a local users group includes a domain user (whose credentials are stored on the Domain Controller server and not on the endpoint), Cortex Cloud...

####### Navigation

  Inventory → Endpoints → Host Inventory

###### 3.2.1.6.5. Vulnerability Assessment

####### Prerequisite

* The following are prerequisites for Cortex Cloud to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex Cloud lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex Cloud...

* The following are prerequisites for Cortex Cloud to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex Cloud collects all the information about the operating system and the installed...

####### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex Cloud Application Inventory.

####### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

####### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

##### 3.2.1.7. Set a Cortex XDR agent Critical Environment version

###### Note

* To ensure the stability of the line, CE versions maintenance release cadence is longer than in the standard line, we recommend that deployment is adjusted accordingly.

###### Navigation

  Settings → Configurations → General → Agent Configurations

  Inventory → Endpoints → All Endpoints

##### 3.2.1.8. Set an application proxy for Cortex XDR agents

###### Navigation

  Inventory → Endpoints → All Endpoints

#### 3.2.2. Manage endpoint protection

##### 3.2.2.1. Move agents between managing servers

###### Prerequisite

* Consider the following before making changes: Endpoint type is not Kubernetes Node. Installation type is not VDI. Ensure you have administrator privileges for Cortex Cloud in the hub.

###### Note

* Cortex Cloud does not support moving agents between FedRamp and commercial tenants.

###### Navigation

  Inventory → Endpoints → Agent Installations

  Inventory → Endpoints → All Endpoints

##### 3.2.2.2. Manage endpoint tags

###### Note

* The following explanations use Windows operating system installation parameters and Cytool argument examples.

* Tag names are case sensitive. In Windows and Mac, a tag name can contain spaces. Linux does not support tag names with spaces as command line arguments to the shell installer. Instead, tags can be set in the /etc/panw/cortex.conf configuration file, which supports all Linux installers.

* Tag names are case sensitive and can contain spaces.

* When SBAC is enabled, assigning tags may impact user permissions.

* If you remove the tag and there are assigned users or user groups with scope settings, this can impact user permissions in the system.

##### 3.2.2.3. Set an alias for an endpoint

###### Tip

* If you change your mind in the future, you can select Endpoint Control → Change Endpoint Alias again, and delete the required aliases.

##### 3.2.2.4. Manage endpoint prevention profiles

###### Note

* The filter is stored within the policy definition and assessed during runtime to extract the functions that match the filter criteria.

###### Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

##### 3.2.2.5. Upgrade Cortex XDR agents

###### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

###### Warning

* You must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check whether the extensions were approved, you can either verify that the...

###### Important

* The following list includes important points to take into account when upgrading the Cortex XDR agent: Review the recommended guidelines for keeping Cortex XDR agents and content updated. Read more here. You cannot upgrade the Cortex XDR agent on VDI endpoints or a Golden Image. You must reinstall (uninstall and install again) the relevant agent...

##### 3.2.2.6. Restart agent

##### 3.2.2.7. Uninstall the Cortex XDR agent

###### Note

* Before upgrading a Cortex XDR agent running on macOS 10.15.4 or later, you must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check...

###### Tip

* If needed, use the filter to filter the list of endpoints by attribute or group name.

###### Navigation

  Inventory → Endpoints → All Endpoints

##### 3.2.2.8. Clear agent database

###### Note

* Clearing the agent database is supported on all platforms with Cortex XDR agent version 7.9 or later, and is available only when using the debugging mode.

* You can only right-click to cancel the clear agent database for actions with a pending status.

##### 3.2.2.9. Delete Cortex XDR agents

###### Note

* To reinstate an endpoint, you have to uninstall and reinstall the agent.

###### Navigation

  Inventory → Endpoints → All Endpoints

##### 3.2.2.10. Manage agent tokens

###### Note

* Agent tokens are only supported for Windows and Mac.

* You can select a one or multiple agents to add a temporary token.

##### 3.2.2.11. Retrieve support file password

###### Navigation

  Retrieve Support File Password from Inventory → Endpoints → All Endpoints

##### 3.2.2.12. Monitor agent operational status

###### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex Cloud management console for specific reasons for the state.

###### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

###### Navigation

  You can monitor the Cortex XDR agent Operational Status in Inventory → Endpoints → All Endpoints

##### 3.2.2.13. Monitor agent activity

##### 3.2.2.14. Monitor agent upgrade status

###### Navigation

  From Inventory → Endpoints → All Endpoints, you can view the upgrade status of any Cortex XDR agent that you manage

## 4. Threat management

### 4.1. Detection rules

#### 4.1.1. What are detection rules?

##### 4.1.1.1. What's an IOC?

###### Note

* Cortex Cloud supports a maximum of 4,000,000 IOCs.

###### 4.1.1.1.1. IOC rule details

####### Note

* Field cannot exceed 36 characters.

####### Navigation

  In the Threat Management → Detection Rules → IOC page, you can view all configured or uploaded indicators of compromise (IOCs

###### 4.1.1.1.2. Create an IOC rule

####### Note

* To ensure your IOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex Cloud automatically does the following: Disables any IOC rules that reach 5000 or more hits over 24 hours. Creates a rule exception based on the PROCESS SHA256 field for IOC rules that hit more than 100 endpoints over 72 hours.

####### Navigation

  In Threat Management → Detection Rules → IOC, select + Add IOC

##### 4.1.1.2. What's a BIOC?

###### 4.1.1.2.1. BIOC rule details

####### Navigation

  Manage your behavioral indicator of compromise (BIOC) rules in Threat Management → Detection Rules → BIOC

###### 4.1.1.2.2. Create a BIOC rule

####### License Type

  Custom prevention rules are supported on Cortex Cloud agent 7.2 and later versions and enable you to configure and apply user-defined BIOC rules to Restriction profiles deployed on your Windows, Mac, and Linux endpoints.

####### Note

* To ensure your BIOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex Cloud automatically does the following: Disables BIOC rules that reach 5000 or more hits over a 24-hour period. Creates a rule exception based on the PROCESS SHA256 field for BIOC rules that hit more than 100 endpoints over a 72 hour period.

* A cloud_audit_log dataset requires a Cortex XDR Pro per GB license. Currently, you cannot create a BIOC rule on customized datasets and only the filter stage, alter stage, and functions without any aggregations are supported for XQL queries that define a BIOC. For BIOC rules, the field values in XQL are evaluated as case insensitive (config...

* To demonstrate the expected behavior of the rule before you save it, Cortex Cloud tests the BIOC on historical logs. After you save a BIOC rule, it will operate both on historical logs (up to 10,000 hits) and on new data received from your log sensors.

* To demonstrate the expected behavior of the rule before you save it, Cortex Cloud tests the BIOC on historical logs. After you save a BIOC rule, it will operate on both historical logs (up to 10,000 hits) and new data received from your log sensors.

* You can only import files that were exported from Cortex Cloud. You can not edit an exported file.

* You can only add to existing profiles you created, Cortex Cloud Default profiles will not appear as an option.

* Auto-disable will turn off both the BIOC rule detection and the BIOC prevention rule.

###### 4.1.1.2.3. Manage Global BIOC Rules

##### 4.1.1.3. What's a correlation rule?

###### Navigation

  After you configure your correlation rules, you can manage them in Threat Management → Detection Rules → Correlations, and view and analyze the generated issues in Cases and the Issues Table

###### 4.1.1.3.1. Correlation rule details

####### Note

* Only an administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex Cloud .

* For more information on troubleshooting server errors in scheduled correlation rules, Troubleshoot server errors in scheduled correlation rules.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

####### Navigation

  If you are assigned a role that enables Investigation → Rules privileges, you can manage all user-defined Correlation Rules from Threat Management → Detection Rules → Correlations

###### 4.1.1.3.2. Create a correlation rule

####### Note

* When you open the New Correlation Rule editor from XQL Search, this XQL Search field is already populated with the XQL query that you defined. An administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex Cloud . All other users can only create and view queries built with an existing dataset.

* The XQL features for call, top, and wildcards in datasets (dataset in (<dataset prefix>_*)) are currently not supported in Correlation Rules. If you add them to the XQL definition, you will not be able to Create or Save the Correlation Rule. The XQL features for transaction in datasets (dataset in (<dataset prefix>_*)) are currently not supported in...

* If a generated issue has severity Medium or above, a case is automatically opened. Low severity issues generated by correlation rules are not grouped into cases.

* There is no validation or auto complete for these parameters and the values can be null or empty. In these scenarios, Cortex Cloud does not display the null or empty values, but adds the text NULL or EMPTY in the descriptions.

* When more than one XDM field is listed, Cortex Cloud looks for the field value according to the order of the fields listed.

* When Use the Cortex Cloud default incident enrichment is not selected and you have not mapped any issue fields, the issue is dispatched into a new incident.

####### Important

* The maximum size of a lookup dataset is 50 MB. If the data exceeds this limit, the add to lookup action fails.

####### Tip

* When creating your correlation rule, you can use predefined values for different fields in the editor, such as Alert Name, Alert Description, and Drill-Down Query. For more information, Field replacement syntax in correlation rules.

####### Navigation

  You can create a new correlation rule from either the Threat Management → Detection Rules → Correlation Rules page or when building a query in XQL Search

###### 4.1.1.3.3. Field replacement syntax in correlation rules

###### 4.1.1.3.4. Manage correlation rules

###### 4.1.1.3.5. Monitor correlation rules

####### Note

* In the dataset, the Query start time and Query end time indicate the time frame of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

###### 4.1.1.3.6. Troubleshoot server errors in scheduled correlation rules

##### 4.1.1.4. Manage IOC and BIOC rules

###### Note

* For Analytics BIOC rules, you can only disable and enable rules.

* You cannot delete global BIOCs delivered with content updates.

* For BIOC rules that are applied to prevention profiles: If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention on the agent works as usual. If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention...

* When a BIOC rule is disabled automatically by Cortex Cloud, for example due to the server anti flooding mechanism, prevention on the agent works as before.

###### Navigation

  Threat Management → Detection Rules → BIOC

##### 4.1.1.5. Attack surface rules

###### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

### 4.2. Analytics

#### 4.2.1. Analytics engine

#### 4.2.2. Analytics sensors

#### 4.2.3. Coverage of MITRE Attack tactics

#### 4.2.4. Review MITRE ATT&CK framework coverage

##### Note

* When a contributing data source type is active, it does not imply that all the rules and detectors associated with the data source type are active. Rule applicability is dependent on the data source's context and configuration. To enable an active status, data source types require the following setup: Endpoint: Installed Cortex XDR agent. Network: A...

#### 4.2.5. Analytics detection time intervals

##### Note

* When establishing a baseline, detectors compute limits beyond which network activity will require an issue. In some cases, detectors do not compute baseline limits; instead they are predetermined by Cortex Cloud engineers. The engineers determine the values used for predetermined limits using statistical analysis of malicious activity recorded...

#### 4.2.6. Analytics issues and Analytics BIOCs

#### 4.2.7. View and manage Analytics rules

#### 4.2.8. Identity Analytics

##### Navigation

  After configuring your Cloud Identity Engine instance and Cortex Cloud Analytics, select Settings () → Configurations → Cortex Cloud - Analytics, and in the Featured in Analytics section, Enable Identity Analytics

#### 4.2.9. Identity Threat Module (ITDR)

## 5. Web and API Security (WAAS)

### 5.1. Overview

#### License Type

  Requires the Cortex Cloud Runtime Security add-on.

#### Note

* Verify API security configurations for relevant users and roles.

### 5.2. Personas workflow

### 5.3. Secure your API landscape

#### 5.3.1. API visibility and risk assessment

##### Note

* Data classification findings are only available for enabled profiles.

* Indicates that a JSON Web Token was identified, but it is unknown how to determine its type from the given string. It could be a non-standard JSON Web Token creation algorithm.

#### 5.3.2. Monitor and investigate API threats

#### 5.3.3. Configure API security from end to end

##### 5.3.3.1. Third-party API security integrations

###### 5.3.3.1.1. Ingest AWS API Gateway

####### Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

####### Important

* Leave '–'filter-pattern empty as displayed above.

###### 5.3.3.1.2. Ingest Azure APIM

####### License Type

  Requires the Data Collection add-on.

####### Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

####### Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

###### 5.3.3.1.3. Ingest Apigee Proxy

####### License Type

  Requires the Data Collection add-on.

####### Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

####### Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

###### 5.3.3.1.4. Ingest Kong

####### License Type

  Requires the Data Collection add-on.

####### Note

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

####### Important

* The size of the buffer must be equal to or larger than the max body size setting in the plugin configuration, on every data plane node.

###### 5.3.3.1.5. Ingest-F5

####### License Type

  Requires the Data Collection add-on.

####### Note

* Extract the files from the F5 plugin to a folder before selecting to upload to F5.

* Select panw_apisec_set_ssl_data only if your client SSL profile is enabled.

* The provider for "context_provider" should always be uppercase. Supported providers: AWS, GCP, Azure, On-prem.

##### 5.3.3.2. Agent-based protection

###### Note

* Web and API Security (WAAS) profiles and policies are currently a Beta feature.

###### 5.3.3.2.1. Set up Web and API Security profiles

####### Note

* Web and API Security profiles and policies are currently a Beta feature.

* In this profile, the Report options configure the workload to report the corresponding malicious applications or APIs to Cortex Cloud, without blocking them. The Disabled options configure the workloads to neither analyze nor report the corresponding malware or behavior.

####### Navigation

  Inventory → Endpoints → Policy Management → Prevention → Profiles

###### 5.3.3.2.2. Apply Web and API Security profiles to workloads

####### Note

* Web and API Security profiles and policies are currently a Beta feature.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

###### 5.3.3.2.3. Manage Web and API Security prevention profiles

####### Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

###### 5.3.3.2.4. Add a disable prevention rule for cloud workloads

####### Important

* All applicable prevention actions are skipped for the files and process that match the properties defined in the rule. Consider the consequences of disabling a prevention rule before you add the exception, and monitor it over time.

####### Navigation

  Settings → Exceptions Configuration → Disable Prevention Rules

###### 5.3.3.2.5. Add a support exception rule for cloud workloads

####### Navigation

  From Settings → Exceptions Configuration → Support Exception Rules, click + Import from file

###### 5.3.3.2.6. Add a legacy exception rule for cloud workloads

####### Navigation

  Your rule is created, and can be viewed at the following location: Settings → Exceptions Configuration → Legacy Agent Exceptions

###### 5.3.3.2.7. Additional workload management tasks

####### Navigation

  Several management activities that can be performed on workloads are accessible from Inventory → Endpoints → All Endpoints and from Inventory → Endpoints → Groups

#### 5.3.4. API specification inventory

##### Note

* Even if you have already imported the specification, you can edit the API specification in Cortex Cloud and add or update the server list.

##### 5.3.4.1. Import API specification

###### Note

* Even if you already imported the file, you can edit the API asset and add or update the server list.

## 6. Review inventory and explore your cloud environment

### 6.1. Asset management

#### 6.1.1. All Assets

##### Note

* Keep the following caveats in my mind when working with the Asset Inventory page: Instance Administrators are able to view all Inventory views without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope SBAC is not currently available for custom roles with View/Edit permissions on the...

* The options available are dependent on your license.

##### 6.1.1.1. Container Images

###### Navigation

  All Assets → Compute → Container Images

##### 6.1.1.2. Kubernetes Cluster

###### Navigation

  Inventory → All Assets → Compute → Kubernetes Cluster for a Kubernetes clusters assets overview

##### 6.1.1.3. Virtual Machine Image Scanning

###### 6.1.1.3.1. VM Images Page

####### Navigation

  Inventory → All Assets → Compute → VM images for Agentless VM Image scanning overview

###### 6.1.1.3.2. VM Image Details Page

####### Navigation

  Inventory → All Assets → Compute → VM images

#### 6.1.2. Network configuration

##### 6.1.2.1. Configure your network parameters

###### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

###### Navigation

  In Cortex Cloud , select Assets → Network Configuration → Internal Domain Suffixes

#### 6.1.3. Asset Groups

##### Note

* When you create or edit an Asset Group, the changes are applied immediately to new assets and to existing assets that have been updated. However, it may take a few hours for the changes to appear on existing assets that have not been updated.

##### Navigation

  Inventory → Assets → Groups → Add Group

#### 6.1.4. Asset Roles

##### Note

* Asset Roles are available only if the Identity Threat Module add-on is enabled.

##### 6.1.4.1. Manage Asset Roles for Endpoints

###### Note

* Endpoint Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added endpoint removes the endpoint from the Included Endpoints list. If this endpoint is detected automatically as having this asset role in the future, it will appear in the Included Endpoints list. Excluding a manually added endpoint ensures that even if in the future the endpoint is detected as having this asset role, this...

##### 6.1.4.2. Manage Asset Roles for Users

###### Note

* User Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added user removes the user from the Included Users list. If this user is detected automatically as having this asset role in the future, it will appear in the Included Users list again. Excluding a manually added user ensures that even if in the future the user is detected as having this asset role, this detection is overridden and...

###### 6.1.4.2.1. Honey user

####### Prerequisite

* The honey user role is available only if the Identity Threat Module add-on is enabled.

#### 6.1.5. Manage Asset Scores

##### Note

* The Hosts tab is available if the Identity Threat Module add-on is enabled.

* As new alerts are associated with incidents, the User and Host Scores are recalculated. You can view the latest User and Host Scores on the Asset Scores page, or track the Score trend on the User Risk View and Host Risk View.

* Some User Associated Insights may not appear as part of the User Associated Incidents due to the insight generation mechanism. For example, when an insight related to one of the assets in an incident is generated a few days after the associated incident, the insight may not be associated with the incident.

#### 6.1.6. Vulnerability Assessment

##### Prerequisite

* The following are prerequisites for Cortex Cloud to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex Cloud lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex Cloud...

* The following are prerequisites for Cortex Cloud to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex Cloud collects all the information about the operating system and the installed...

##### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex Cloud Application Inventory.

##### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

##### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

## 7. Review and prioritize posture issues

### 7.1. Cases and issues

#### 7.1.1. What are cases?

##### 7.1.1.1. Issues

##### 7.1.1.2. Findings and events

#### 7.1.2. Case and issue domains

#### 7.1.3. Manage your cases

##### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

##### 7.1.3.1. Assign a case

##### 7.1.3.2. Case thresholds

##### 7.1.3.3. Link or unlink issues from a case

##### 7.1.3.4. Resolve a case

###### 7.1.3.4.1. Resolution reasons for cases and issues

####### Note

* Cases and issues resolved as True Positive and False Positive help Cortex Cloud to identify real threats in your environment by comparing future cases and associated issues to the resolved cases. Therefore, the handling and scoring of future cases is affected by these resolutions.

##### 7.1.3.5. Create a case

###### Note

* To create a case manually, you must have View/Edit permission for Cases and Issues selected under Settings → Configurations → Access Management → Roles → Components → Cases & Issues.

* This option is only relevant for certain domains.

* You can't attach files to manually created cases.

###### Tip

* The issues that you link to a case can be linked to multiple cases, and the issue domains do not need to match the case domain.

##### 7.1.3.6. Issue syncing

###### Prerequisite

* You must set up an integration before you can sync issues. For more information, see Set up an integration for mirroring issues.

###### Note

* Multiple tickets can be linked to an issue with outbound syncing. Issues with inbound syncing can be linked to a single ticket only.

* Using issue fields as variables is not currently supported.

* You can only define a single inbound profile. If you change the inbound sync profile the current profile is overwritten. You can define multiple outbound profiles; one issue can update multiple tickets.

* The inbound syncing flow runs every two minutes, and the outbound syncing flow runs every five minutes. In a bi-directional set-up, if the same field is updated in both tickets, the most recently updated value is used. In the external ticket, the logged history shows updates to the ticket. The user name that is logged with the history reflects the user...

* After an issue is resolved, ticket syncing remains active for up-to seven days. Therefore, you still update, change, or reopen the issue or external ticket and the tickets will continue to sync.

* If you change the selected inbound sync profile, the original sync profile is immediately overwritten.

###### Warning

* If you leave this field blank, all configured instances will be used.

###### Tip

* You can find a sync profile ID under Settings → Configurations → Object Setup → Issues → Sync Profiles. By default the ID field is not displayed in the table. Click the three dot menu and add it to the table layout.

###### Navigation

  Settings → Configurations → Data Sources and click Add Data Source

  Settings → Configurations → Data Collection → Automation & Feed Integrations

###### 7.1.3.6.1. Create a sync profile

####### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

#### 7.1.4. Prioritize cases with starring and scoring

##### 7.1.4.1. Case starring

###### Navigation

  Cases & Issues → Case Configuration → Starred Issues

##### 7.1.4.2. Case scoring

###### 7.1.4.2.1. Set up case scoring

####### Note

* For scoped users, a small lock icon indicates that you don't have permissions to edit a rule.

### 7.2. Investigation and response

#### 7.2.1. Investigate cases

##### 7.2.1.1. Overview of the Cases page

###### Note

* When an issue is resolved, it remains linked to a case and appears in this section. Once all of the issues in a case are resolved, the case is automatically closed.

###### Tip

* Set a default tab in the details pane by selecting the pin icon next to a tab.

###### 7.2.1.1.1. Saved table views

##### 7.2.1.2. Review and investigate a case

###### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

* In some cases, the number of issues associated with the techniques will not be aligned with the number of the parent tactic because of missing tags or in case an issue belongs to several techniques.

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

#### 7.2.2. Investigate issues

##### 7.2.2.1. Overview of the Issues page

###### Note

* Every 12 hours, the system enforces a cleanup policy to remove the oldest issues once the maximum limit is exceeded. The default issue retention period in Cortex Cloud is 186 days.

##### 7.2.2.2. Issue card

###### Note

* This section is context specific and shows data according to the issue context.

###### 7.2.2.2.1. Use the War Room in an investigation

####### Note

* The case War Room is usually used for communication capabilities, but unlike the issue War Room, it does not include playbook specific entries. The case War Room enables you to investigate an entire case, not just an issue.

* Cortex Cloud does not index notes and chats.

####### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

* You can use the up/down arrow buttons in the CLI to do a reverse history search for previous commands with the same prefix.

####### Navigation

  Investigation & Response → Automation → Playground

###### 7.2.2.2.2. Use the Work Plan in an investigation

##### 7.2.2.3. Triage and investigate issues

###### 7.2.2.3.1. Copy issues

###### 7.2.2.3.2. Run an automation on an issue

####### Note

* In addition to automation, some playbooks contain manual tasks that prompt the analyst for input. This enables you to enhance an automation workflow with analyst input.

* You can also manually select a playbook to run from the Issue Work Plan tab.

###### 7.2.2.3.3. Create profile exceptions

####### Navigation

  Inventory+Endpoints → Policy Management → Profiles

###### 7.2.2.3.4. Investigate contributing events

###### 7.2.2.3.5. Retrieve additional issue details

####### Tip

* If you require assistance from Palo Alto Networks support to investigate the issue, make sure to provide the downloaded ZIP file.

###### 7.2.2.3.6. Add a file path to a malware profile allow list

####### Navigation

  Inventory+Endpoints → Policy Management → Prevention → Profiles and locate the malware profile you selected

###### 7.2.2.3.7. Create a featured field

####### Note

* Featured Active Directory values are displayed in the User and Host fields accordingly.

####### Navigation

  Cases & Issues → Case Configuration → Featured Fields and select a type of featured field

###### 7.2.2.3.8. View generating BIOC or IOC rule

###### 7.2.2.3.9. Export issue details to a file

###### 7.2.2.3.10. Exclude an issue

###### 7.2.2.3.11. Query case and issue data

####### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

###### 7.2.2.3.12. Update issue fields

####### Note

* You must create a custom status before you can select it.

####### Tip

* You can create custom issue statuses and resolution reasons, and use the setIssueStatus command to set these custom statuses for issues. For example, when a user starts investigating an issue, the issue status is automatically changed from New to Under Investigation. In some cases, it is useful to create an interim status, such as Triage. After you...

##### 7.2.2.4. What is Causality?

###### Note

* There are no CGOs in the Cloud Causality View, when investigating cloud Cortex Cloud alerts and Cloud Audit Logs, or SaaS Causality View, when investigating SaaS-related alerts for 501 audit events, such as Office 365 audit logs and normalized logs.

###### 7.2.2.4.1. Causality view

####### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

###### 7.2.2.4.2. Network causality view

####### Note

* The network causality view displays only the information it collects from the detectors. It is possible that the CI may not show some of the firewall or agent processes.

####### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

###### 7.2.2.4.3. Cloud causality view

###### 7.2.2.4.4. SaaS causality view

###### 7.2.2.4.5. Timeline

####### Note

* The Timeline view is not available when investigating cloud Cortex Cloud issues and cloud audit logs or SaaS-related issues for 501 audit events, such as Office 365 audit logs and normalized logs. Only the applicable cloud causality view and SaaS causality view is available for this data.

###### 7.2.2.4.6. Causality icons key

#### 7.2.3. Investigate findings

##### 7.2.3.1. Findings card

###### Note

* The information in this card is context specific, therefore some sections are not available for all findings.

#### 7.2.4. Investigate artifacts and assets

##### 7.2.4.1. Investigate an IP address

###### Note

* Requires a license key. Select Settings → Configurations → Integrations  → Threat Intelligence.

##### 7.2.4.2. Investigate an asset

###### Note

* The Asset view is available for hosts with a Cortex XDR agent installed.

##### 7.2.4.3. Investigate a file and process hash

###### Note

* Requires a license key. Go to Settings → Configurations → Integrations  → Threat Intelligence.

##### 7.2.4.4. Investigate a user

###### License Type

  If the Identity Threat module is enabled you can open the User Risk View. This view displays insights and profiling information to help you investigate issues and cases. Viewing anomalies in the context of baseline behavior facilitates risk assessment and shortens the time you require for making verdicts. If the Identity Threat module is not enabled...

###### Note

* Cortex Cloud normalizes and displays case and issue times in your time zone. If you're in a half-hour time zone, the activity in the Normal Activity and the Actual Activity charts is displayed in the whole-hour time slot preceding it. For example, if you're in a UTC +4.5 time zone, the time displayed for the activity will be UTC +4.5, however, the...

###### Tip

* You can also see a list of all users under Assets → Asset Scores.

#### 7.2.5. Investigate endpoints

##### 7.2.5.1. Overview of the Action Center

###### Note

* Blocking files on endpoints is enforced by the endpoint malware profile. To block a hash value, ensure the hash value is configured in the Malware security profile. Select Override Report mode to allow the agent to block hashes, even if the Malware Profile is set to Report.

###### Navigation

  Investigation & Response → Response → Action Center

###### 7.2.5.1.1. Initiate and monitor endpoint actions

####### Navigation

  Investigation & Response → Response → Action Center → New Action

  Investigation & Response → Response → Action Center

###### 7.2.5.1.2. Action Center reference information

##### 7.2.5.2. Manage endpoints

###### Note

* For the Include endpoints from auto upgrade action, you cannot enable auto upgrade for Mobile, VDI, and TS installations.

* If an endpoint is excluded, the auto upgrade profile configuration is not available. If you exclude the endpoint from auto upgrade while the auto upgrade action is In progress, the ongoing upgrade will still take place.

* Content Status is calculated every 30 minutes. Therefore, there might be a delay of up to 30 minutes in displaying the data.

* Only supported for Windows and macOS.

* Changes to the agent status can take up to ten minutes to display on Cortex Cloud .

###### Navigation

  Inventory → Endpoints → All Endpoints

  Settings → Configurations → General → Agent Configurations → Endpoint Administration Cleanup

##### 7.2.5.3. Retrieve files from an endpoint

###### Note

* You cannot define a path using environment variables on Mac and Linux endpoints.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Disabling File Retrieval does not take effect on file retrieval actions that are in progress.

##### 7.2.5.4. Retrieve support logs from an endpoint

###### Navigation

  Investigation & Response → Response → Action Center → + New Action

##### 7.2.5.5. Scan an endpoint for malware

###### Navigation

  Investigation & Response → Response → Action Center → New Action

#### 7.2.6. Investigate files

##### 7.2.6.1. Manage file execution

###### Navigation

  Investigation & Response → Response → Action Center → New Action

##### 7.2.6.2. Manage quarantined files

###### Note

* This will restore all files with the same hash on all of your endpoints.

##### 7.2.6.3. Review WildFire analysis details

###### Note

* Cortex Cloud displays the preview of WildFire reports that were generated within the last couple of years. To view a report that was generated more than two years ago, you can download the report.

##### 7.2.6.4. Import file hash exceptions

###### Navigation

  Investigation & Response → Response → Action Center → New Action

#### 7.2.7. Automation

##### 7.2.7.1. Automation in Cortex Cloud

###### Note

* You can build end-to-end automation workflows from within the playbook editor, including creating automation rules, configuring integration instances, and creating and editing tasks. For more information, see Playbooks.

##### 7.2.7.2. Quick Actions

###### Note

* When investigating an issue, in the Issues table, you can right-click to Run an Automation on one or more issues. For more information, see Manually run a playbook or Quick Action on one or more issues.

##### 7.2.7.3. Manage automation exclusion policies

###### Note

* For the IAM User Hard Remediation and User Soft Remediation policies, we recommend including username, email, and ID for each user you want to exclude. Example: username1, user@example.com, userID112.

* You can also right click on a policy from the main Automation Exclusion Center page to disable or enable the policy. If you click on a list name in the Exclude column, that list opens in the Lists page.

##### 7.2.7.4. Playbooks

###### 7.2.7.4.1. Playbooks overview

###### 7.2.7.4.2. Playbook development checklist

###### 7.2.7.4.3. Plan your playbook

###### 7.2.7.4.4. Manage playbooks

####### Note

* The library by default shows only playbooks that are not adopted. Click the Show Adopted checkbox to show the adopted playbooks, indicated by an Adopted mark. The library shows the most updated playbook version. Adopting an older version than shown should be done through Marketplace. Adopting a playbook does not make it run. Some content packs include...

###### 7.2.7.4.5. Build your playbook

####### 7.2.7.4.5.1. Task 1. Choose from existing playbooks or create your own

######## Tip

* If there are additional relevant playbooks in Marketplace that are not in your Org repository, you can click Explore them now to see them in the Playbook Catalog and choose to adopt.

* To open multiple playbooks at the same time, edit the first playbook and then click New next to the playbook name to create a new tab. You can either create a new playbook, or add an existing one. You can view recently modified or deleted playbooks by clicking version history for all playbooks .

######## Navigation

  the Investigation & Response → Automation → Playbooks page to customize or create a playbook

####### 7.2.7.4.5.2. Task 2. Configure playbook settings

######## Note

* If the playbook has inputs and outputs, the Playbook Starts task will show back and forth arrows. Clicking them opens the Playbook Settings pane Inputs/Outputs tab.

* This rule will trigger the playbook to run if no other Automation Rule triggers the playbook first. You can view and edit the order the rules run in the Automation Rules page.

* If you do not add any fields, the group will be deleted when you click Save.

####### 7.2.7.4.5.3. Task 3. Add objects from the Task Library

####### 7.2.7.4.5.4. Task 4. Add custom playbook features

####### 7.2.7.4.5.5. Task 5. Test and debug the playbook

####### 7.2.7.4.5.6. Task 6. Manage playbook content

###### 7.2.7.4.6. Test your playbook

####### Note

* The debugger does not support using parentIncidentFields.

* Using an existing issue in the debugger does not affect the original issue or change the original context data.

####### 7.2.7.4.6.1. Troubleshoot playbook performance

###### 7.2.7.4.7. Manage playbook content

###### 7.2.7.4.8. Best practices

####### Note

* If you reattach a detached playbook, any customizations you have made to the playbook will be overwritten when the playbook updates to the current version.

* Retries are not supported for data collection tasks that have errors sending emails (indicated by a server timeout). This is because retries only work on automation execution failures, not on email delivery issues.

##### 7.2.7.5. Create an automation rule

###### Note

* You can also define the conditions that trigger a specific playbook in the playbook editor. For more information, see Task 2. Configure playbook settings

###### Important

* Automation rules apply to Medium and higher severity issues. They also apply to Low severity Analytic issues and Low severity ABIOC issues that are tagged with Identity or Cloud. Rules are evaluated in order, and only the first rule that matches the trigger conditions is executed.

##### 7.2.7.6. Scripts

###### 7.2.7.6.1. Use existing scripts

####### Navigation

  Investigation & Response → Automation → Scripts and in the Scripts Library search for the script you want to use

###### 7.2.7.6.2. Create a script

####### Note

* You can enable/disable a script in the Settings, without having to duplicate the script. You can view recently modified or deleted scripts by clicking the version history for all scripts .

####### Navigation

  Investigation & Response → Automation → Scripts and click New Script

###### 7.2.7.6.3. Change the Docker image in a script

####### 7.2.7.6.3.1. Connect an engine to an image registry

######## Note

* This procedure uses the --username and --password command line options to pass the username and password directly. For environments where command history or logs are visible to others, consider more secure methods like Docker configuration files for handling authentication in production or CI/CD environments. For more details, see docker login or...

##### 7.2.7.7. Context data

###### 7.2.7.7.1. Issue context data

###### 7.2.7.7.2. Case context data

###### 7.2.7.7.3. Search context data

###### 7.2.7.7.4. Add context data to an issue

###### 7.2.7.7.5. Add context data to a case

####### Note

* If you run the command in the issue War Room, the data is added to the following places: The case context data. The issue context data under the case tab. If you run the command in the Case War Room, the data is added to the case context data only.

###### 7.2.7.7.6. Delete context data from a case

###### 7.2.7.7.7. Use context data in a playbook

####### Caution

* Users with Trigger Playbook permissions on a given issue may still be able to modify the parent case via commands and scripts, even without full access to the case.

##### 7.2.7.8. Lists

###### Note

* The maximum list size is 209,715 characters (approximately 200 KB).

###### 7.2.7.8.1. Create a list

####### Note

* If you want to edit a list from a content pack, you need to duplicate or detach a list. Detached lists do not receive updated content in subsequent Cortex Cloud content releases. To retain an updated list, reattach it.

####### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

###### 7.2.7.8.2. List commands

###### 7.2.7.8.3. Use cases: JSON lists

####### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

  Investigation & Response → Automation → Playbooks → New Playbook

###### 7.2.7.8.4. Transform a list into an array

####### Navigation

  Investigation & Response → Automation → Playbooks and create or edit a playbook

##### 7.2.7.9. Integrations

###### 7.2.7.9.1. Integrations in Cortex Cloud

###### 7.2.7.9.2. Add an integration instance

####### Navigation

  Settings → Configurations → Data Collection → Automation & Feed Integrations and search for the integration

###### 7.2.7.9.3. Use integration commands in the CLI

####### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

###### 7.2.7.9.4. Troubleshoot Integrations

###### 7.2.7.9.5. Manage credentials

####### Navigation

  Settings → Configurations → Integrations → Credentials → New Credential

  Settings → Configurations → Data Collection → Automation & Feed Integrations and select the integration instance

##### 7.2.7.10. Engines

###### 7.2.7.10.1. What is an engine?

####### Note

* You cannot share a multiple-engine installation with a single-engine installation.

* When you add an engine to a load-balancing group, you cannot use that engine separately. The engine does not appear in the engines menu when configuring an integration instance, but you can choose the load-balancing group.

###### 7.2.7.10.2. Engine requirements

####### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

###### 7.2.7.10.3. Install an engine

####### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex Cloud engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

####### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

####### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

####### 7.2.7.10.3.1. Docker

######## Note

* This section is relevant when installing an engine.

* Docker images can be downloaded together with their relevant content packs for offline installation.

####### 7.2.7.10.3.2. Podman

######## Note

* When upgrading an engine, the engine keeps the previously used container management type (regardless of distribution version).

###### 7.2.7.10.4. Manage engines

###### 7.2.7.10.5. Upgrade an engine

###### 7.2.7.10.6. Remove an engine

###### 7.2.7.10.7. Configure engines

####### Note

* A day is defined as 24 hours and may not exactly correspond to calendar days due to daylight savings, leap seconds, etc.

* In addition, to support engine upgrades from the UI, edit the /usr/local/demisto/upgrade.conf file on the engine to include the SERVER_URLS setting with the new tenant's address. Include only the host, without https:// or any additional path at the end of the host name. For example: SERVER_URLS="api-example.us.paloaltonetworks.com"

* If the engine loses communication for longer than this time, it will disconnect and you need to restart the service.

####### 7.2.7.10.7.1. Configure the engine to use a web proxy

######## Note

* You need to configure Docker to use a proxy. When using a BlueCoat proxy, ensure you encode the values correctly.

* In an environment with a single engine, go to /usr/local/demisto/upgrade.conf. In an environment with multiple engines, go to /usr/local/demisto/<engine-name>/upgrade.conf, replacing <engine-name> with the name of the engine. Note that the key is in the upgrade.conf file and must be https_proxy, even if your proxy address starts with http://.

####### 7.2.7.10.7.2. Configure the engine to call the server without using a proxy

####### 7.2.7.10.7.3. Configure an engine to use custom certificates

###### 7.2.7.10.8. Use an engine in an integration

####### Note

* Long-running integrations should not run on load-balancing groups.

###### 7.2.7.10.9. Run a script using an engine

####### Navigation

  Investigation & Response → Automation → Scripts

###### 7.2.7.10.10. Troubleshoot engines

####### Note

* Ensure that pop-ups are not blocked by your browser.

* If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom path. --keep - Extracts the installer files into the current working directory (without cleaning at the end). If using installer...

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl status d1_<Engine _name>

* Any changes made to variables in the upgrade_engine.sh file are reset after each upgrade. We recommend instead using the upgrade.conf file to set variables.

* You can ignore the following error: Cannot create folder '/var/lib/demisto'

###### 7.2.7.10.11. Troubleshoot integrations running on engines

####### Note

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

* Docker CE installations typically run Docker, while Docker EE installations typically run dockerroot.

#### 7.2.8. Response actions

##### Caution

* Response actions are not supported for Android endpoints.

##### 7.2.8.1. Initiate a Live Terminal session

###### Note

* You can run PowerShell 5.0 or a later release on Live Terminal of Windows.

* Network drives are not supported.

* On Windows endpoints, you cannot run GUI-based cmd commands like winver or appwiz.cpl.

* Disabling Live Terminal does not take effect on sessions that are in progress.

###### Tip

* You can fine-tune the Live Terminal session visibility on the endpoint by adjusting the User Interface options in your Agent Settings Profile.

##### 7.2.8.2. Isolate an endpoint

###### Note

* IP-based file storage protocol traffic will also be blocked. This might affect endpoint functionality if the endpoint uses such mounts.

* If file system operations become unresponsive during isolation, such as being unable to list folder content, unmount the mounted network shares.

###### Tip

* If needed, Filter the list of endpoints.

##### 7.2.8.3. Pause endpoint protection

###### Note

* Pausing your endpoint protection modules leaves your machines exposed to risks.

###### Navigation

  Investigation & Response → Response → Action Center and locate Action Type Pause Endpoint Protection or Resume Endpoint Protection

##### 7.2.8.4. Remediate changes from malicious activity

###### Prerequisite

* To initiate remediation suggestions, you must have the following system requirements: An App Administrator, Privileged Responder, or Privileged Security Admin role permissions which include the remediation permissions. EDR data collection enabled. Agent version 7.2 or above on Windows endpoints.

###### Note

* Endpoints that are part of the Case view and do not meet the required criteria are excluded from the remediation analysis.

##### 7.2.8.5. Search and destroy malicious files

###### Prerequisite

* The following are prerequisites to enable Cortex Cloud to search and destroy files on your endpoints: Supported platforms:    Windows: Cortex XDR agent version 7.2 or a later. If you plan to enable Search and Destroy on VDI sessions, you must perform the initial scan on the Golden Image.   Mac: Cortex XDR agent version 7.3 or a later release running on...

###### Note

* The Cortex Cloud agent does not include the following information in the local files inventory: Information about files that existed on the endpoint and were deleted before the Cortex Cloud agent was installed. Information about files where the file size exceeds the maximum file size for hash calculations that are pre-configured in Cortex Cloud . If...

##### 7.2.8.6. Manage external dynamic lists

###### License Type

  This functionality is not supported for XDR Prevent.

###### Note

* Ensure EDL sizes don't exceed your firewall model limit.

###### Tip

* You can also use the IP list and URL lists as part of a URL Filtering policy, or the domain list as part of a custom Anti-Spyware profile.

##### 7.2.8.7. Collect a memory image

###### License Type

  This functionality has the following license requirements: Forensics add-on license.

#### 7.2.9. Forensics

##### License Type

  Requires the Forensics add-on

##### 7.2.9.1. Forensic investigations

###### 7.2.9.1.1. Manage an investigation

####### 7.2.9.1.1.1. Create a new investigation

######## Note

* To set up user permissions, you must have Scope-Based Access Control (SBAC) enabled.

####### 7.2.9.1.1.2. Edit an investigation

####### 7.2.9.1.1.3. Close an investigation

######## Note

* When you close an investigation, Palo Alto Networks has a grace period of 24 hours before deleting any collections associated with the investigation. During this timeframe, you have the option to cancel the close investigation action.

####### 7.2.9.1.1.4. User permissions

######## Note

* Even if a user does not have access to view an investigation via the Forensics Investigations page, they can still query the results of the collections using an XQL query.

###### 7.2.9.1.2. Data collection

####### 7.2.9.1.2.1. Hunting

####### 7.2.9.1.2.2. Triage

###### 7.2.9.1.3. Analysis and documentation

####### 7.2.9.1.3.1. Review alerts

####### 7.2.9.1.3.2. Investigation timeline

####### 7.2.9.1.3.3. Key assets & artifacts

###### 7.2.9.1.4. Export

####### Note

* You can export a collection more than once.

#### 7.2.10. Build XQL queries

##### 7.2.10.1. About the Query Builder

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

##### 7.2.10.2. How to build XQL queries

###### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex Cloud. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

###### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

###### 7.2.10.2.1. Get started with XQL queries

###### 7.2.10.2.2. Useful XQL user interface features

####### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

###### 7.2.10.2.3. XQL Query best practices

###### 7.2.10.2.4. Expected results when querying fields

###### 7.2.10.2.5. Create XQL query

####### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

###### 7.2.10.2.6. Review XQL query results

####### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* In order for Cortex Cloud to provide a histogram for a field, the field must not contain an array or a JSON object.

###### 7.2.10.2.7. Translate to XQL

####### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

###### 7.2.10.2.8. Graph query results

####### License Type

  Building Cortex Query Language (XQL) queries in the Query Builder requires a Data Collection add-on.

####### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### 7.2.10.3. XQL query entities

###### 7.2.10.3.1. Create authentication query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 7.2.10.3.2. Create event log query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 7.2.10.3.3. Create file query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 7.2.10.3.4. Create image load query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 7.2.10.3.5. Create network connections query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 7.2.10.3.6. Create network query

####### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

###### 7.2.10.3.7. Create process query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 7.2.10.3.8. Create registry query

####### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

###### 7.2.10.3.9. Query across all entities

####### Navigation

  Investigation & Response → Search → Query Builder

##### 7.2.10.4. Edit and run queries in Query Center

###### Navigation

  Investigation & Response → Search → Query Center

###### 7.2.10.4.1. Query Center reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 7.2.10.5. Manage scheduled queries

###### Navigation

  Investigation & Response → Search → Scheduled Queries

###### 7.2.10.5.1. Scheduled Queries reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 7.2.10.6. Manage your personal query library

###### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

#### 7.2.11. Quick Launcher

##### Note

* For hosts, Cortex Cloud displays results for exact matches but supports the use of wildcard (*) which changes the search to return matches that contain the specified text. For example, a search of compy-7* will return any hosts beginning with compy-7 such as compy-7000, compy-7abc, and so forth.

#### 7.2.12. Research a known threat

## 8. Review and report your security posture and progress

### 8.1. Monitor dashboards and reports

#### 8.1.1. About dashboards

##### Note

* You cannot edit the predefined dashboards but you can create a new dashboard that is based on a dashboard template. In addition, private dashboards can only be viewed, edited, and deleted by the dashboard creator.

* Dashboards that are based on custom infrastructure cannot be exported. If you import a dashboard template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

##### 8.1.1.1. Command Center dashboards

###### Note

* Access to the dashboards requires RBAC View permissions for Dashboards & Reports and Command Center Dashboards. The dashboards are available in dark mode only. They are not editable, and you can't create dashboard templates or reports from them. Some of the dashboard's animations are not fully supported by the Safari web browser. We recommend that...

###### 8.1.1.1.1. Cloud Security Command Center

####### 8.1.1.1.1.1. Cloud Security Command Center

######## Note

* The Cloud Security Command Center dashboard is currently only available by default to users with the Instance Administrator and Viewer roles. Custom roles, which include the Cloud Security Command Center View/Edit role permissions, also have access.

###### 8.1.1.1.2. Cloud Security Operations

####### 8.1.1.1.2.1. Cloud Security Operations

######## Note

* Command Center data may not match the counts on the Issues page and you may observe inconsistencies. This is because dashboard data is a snapshot of issues identified, whereas the Issues page provides the most up to date view of risks across your cloud assets. In addition, the Issues pages does not support all the currently available filters on the...

##### 8.1.1.2. Predefined dashboards

###### Note

* Users can access all information on the dashboard when their user access is scoped to view All assets or assigned to the Instance Administrator role. Otherwise, users with granular scoping set to No assets or Select asset groups will have limited access to the dashboard. For more information on Scope-Based Access Control (SBAC), see Manage user...

##### 8.1.1.3. Reports

###### 8.1.1.3.1. Report templates

#### 8.1.2. Build custom dashboards and reports

##### 8.1.2.1. Build a custom dashboard

###### Note

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

##### 8.1.2.2. Manage your Widget Library

###### Note

* Any dashboards or reports that include the widget are affected by the changes.

#### 8.1.3. Fine-tune dashboards and reports

##### 8.1.3.1. Create a custom widget using a script

###### Note

* If you have added arguments to the script, these appear when creating a widget.

* Available options are Pie, Column, Line, and Single Value. To display the result of the script as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### 8.1.3.1.1. Script-based widget examples

####### Note

* Add the widget tag in the script settings to make the script available for use in script-based widgets. For more information, see Create a script.

* If your script returns a time duration, configure the widget with the graph type Single Value and enable Show as Time..

##### 8.1.3.2. Create a text widget

###### Note

* From the dashboard manager, you can right-click an existing dashboard and choose Save as report template. You can also add text-based widgets directly to new or existing report templates, as described below.

##### 8.1.3.3. Create custom XQL widgets

###### Note

* Cortex Query Language (XQL) queries generated from the Widget Library do not appear in the Query Center. The results are used only for creating the custom widget.

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### Tip

* You can create a generic dashboard for multiple views of the same dataset by defining the dataset in the XQL widget as dataset = <dataset_name>*. The placement of the asterisk (*) in the dataset name ensures that any view containing this prefix text is displayed in the results. The dataset in a query is defined as: If there are multiple datasets that...

###### Navigation

  All of your predefined and custom XQL widgets are available in the Widget Library under Dashboards & Reports → Customize → Widget Library

###### 8.1.3.3.1. Configure filters and inputs for custom XQL widgets

####### Prerequisite

* Fixed filters are based on parameters that are defined in custom XQL widgets. Before you can configure fixed filters, take the following steps: Create custom XQL widgets with parameters. For more information, see Create custom XQL widgets. Add the widgets to a Custom dashboard. For more information, see Build a custom dashboard.

####### Note

* If you specify more than one field, only the first field value is used.

####### Tip

* After the initial setup, when you access your dashboard the filters and inputs might need further refinement. You can make changes to the configured parameters in the XQL widgets, and update the Filters & Inputs on your dashboard until you are satisfied with the results.

###### 8.1.3.3.2. Configure dashboard drilldowns

####### Prerequisite

* To configure drilldowns your dashboard must contain custom XQL widgets. In addition, if you want to configure in-dashboard drilldowns your custom XQL widget must contain one or more parameters. For more information about configuring parameters in custom XQL widgets, see Create custom XQL widgets.

####### Note

* If the selected parameter is configured in other XQL widgets on the dashboard, these widgets are also affected by the drilldown.

####### 8.1.3.3.2.1. Variables in drilldowns

#### 8.1.4. Run or schedule reports

##### Note

* Report templates that are based on custom infrastructure cannot be exported. If you import a report template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

* The report name and description will be displayed in the report header and are not editable during customization.

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

##### Navigation

  Dashboards & Reports → Customize → Report Templates

  Dashboards & Reports → Customize → Dashboards Manager

  Under Settings → Configurations → General → Notifications, click + Add Forwarding Configuration

## 9. Discovery Engine

### 9.1. What is the Discovery Engine?

10. Vulnerability management

  10.1. Vulnerability management in Cortex Cloud

#### Note

* Cortex Cloud vulnerability management provides the ability to identify and assess runtime vulnerabilities in every asset across traditional IT and cloud environments. For vulnerabilities detected in your software development lifecycle through application security scans, refer to the Cortex Cloud Application Securitydocumentation.

  10.1.1. Cortex Cloud vulnerability concepts

#### Note

* CVE is an acronym for Common Vulnerabilities and Exposures, which is a list of publicly disclosed security threats. We often use the term "CVE" to refer to a vulnerability that has been a assigned a CVE ID. Cortex Cloud identifies CVEs and non-CVE vulnerabilities.

  10.1.2. Vulnerability Management dashboard

  10.2. Vulnerability policies

  10.2.1. Create a vulnerability policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

  10.2.2. Update the Ignored CVEs, Asset Groups, and Assets policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

  10.2.3. Modify a vulnerability policy

#### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

  10.2.4. Enable or disable a vulnerability policy

#### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

  10.3. Investigate and remediate vulnerabilities

  10.3.1. View all Vulnerabilities

#### Navigation

  Posture Management → Vulnerability Management → Vulnerabilities

  10.3.2. View vulnerability issues

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

  10.3.3. View All Vulnerability Findings

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues and click the All Vulnerability Findings button

  10.3.4. View vulnerable assets

#### Navigation

  Posture Management → Vulnerability Management → Vulnerable Assets

  10.4. Vulnerability Intelligence

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

  10.5. Recast CVSS scores and CVSS severities

#### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

11. Cloud Workload Policies and Rules

#### Prerequisite

* Users need View/Edit RBAC permissions (under Policies → Compute Policies) or the Instance Administrator role to view, edit, and modify Cloud Workload Policies.

  11.1. How policies and rules work together

  11.2. Cloud Workload Policies

  11.2.1. Types of Cloud Workload Policies

  11.2.2. Cloud Workload Policies page

#### Note

* Keep the following caveats in my mind when working with Policies: Instance Administrators are able to view all facets of Policies without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be...

  11.2.2.1. Widgets panel

  11.2.2.1.1. Show or hide the widget panel

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  11.2.2.2. Filter page results

  11.2.2.3. Change the layout of the policies table

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  11.2.2.4. Policy Details Panel

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  11.2.3. Enable or disable a Cloud Workload Policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  11.2.4. Create a Cloud Workload Policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  11.2.5. Use an existing policy to create a new Cloud Workload policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  11.2.6. Edit a Cloud Workload Policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  11.2.7. Delete a Cloud Workload Policy

#### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

  11.3. Cloud Workload Rules

  11.3.1. Default (pre-defined) Rules

  11.3.2. Custom (user-defined) Rules

  11.3.3. Cloud Workload Rules page

#### Note

* Keep the following caveats in my mind when working with Rules: Instance Administrators are able to view all facets of Rules without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be able...

  11.3.3.1. Filter page results

  11.3.3.2. Change the layout of the rules table

  11.3.3.3. Rule details panel

  11.3.4. Create a new Custom Detection Rule

#### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

#### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

  11.3.5. Use an existing rule to create a new Custom Detection Rule

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

  11.3.6. Edit a Custom Detection Rule

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

  11.3.7. Delete a Custom Detection Rule

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

12. Monitor and track compliance adherence

  12.1. Cortex compliance flow

  12.2. Choose compliance standards from the compliance Catalog

#### Navigation

  Cortex provides lists of available standards and controls in the Standards and Controls catalogs under Posture Management → Compliance → Catalogs

  12.2.1. Standards Catalog

  12.2.1.1. Use a built-in or custom standard

  12.2.2. Controls catalog

  12.2.2.1. Use a built-in or custom control

  12.2.2.1.1. Add a custom detection rule to a custom control

#### Note

* Only custom detection rules (not built-in) can be assigned to custom controls.

#### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

  12.2.2.1.2. Create a new Custom Detection Rule

#### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

#### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

  12.3. Use assessment profiles to run compliance checks on your assets

#### Note

* You can view the list of built-in asset groups under Inventory → Assets → Groups, where the MODIFIED BY column shows Palo Alto Networks. While you can edit or delete these asset groups, we do not recommend it. Doing so may cause inaccurate or inconsistent assessment results.

  12.4. View and manage compliance assessments and reports

#### Note

* Compliance assessment results may take up to six hours to be generated.

  12.4.1. Assessments

#### Note

* If there are no rules associated with the control, the control will be assigned a severity of low.

  12.4.2. Reports

#### Navigation

  The Posture Management → Compliance → Results → Reports page shows a table listing compliance assessment report files

13. Serverless function security

  13.1. Overview

  13.2. Serverless function posture security

  13.2.1. Onboard cloud providers for serverless functions

#### Note

* When scanning serverless functions wtih layers, those layers need to be from the same cloud account.

* Only functions containing zip files are supported.

#### Important

* Cortex supports GCP functions deployed by Cloud Functions (1st gen) and Cloud Functions API (2nd gen).

  13.2.2. Serverless function posture policies

  13.2.2.1. Manage serverless function policies

#### Note

* You can select multiple types to view all your serverless function rules across your cloud providers.

* Refer to Create serverless function policies for more information on how to define the steps of a policy in the wizard.

  13.2.2.2. Create serverless function policies

#### Note

* You can select multiple options.

* For more information about rules, refer to Manage serverless function rules.

  13.2.3. Serverless function posture rules

  13.2.3.1. Manage serverless function rules

#### Note

* You can select multiple types to view all your serverless function policies across your cloud providers.

* Refer to Create serverless function rules for more information on how to define the steps of a rule in the wizard.

  13.2.3.2. Create serverless function rules

  13.2.3.3. Create an attack path rule for serverless functions

#### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  in as the operator → enter the CVE ID → Search

  > or >= as the operator → Severity level (such as High, Low) → Search

  > or >= as the operator → enter a score → Search

  13.2.3.4. Create a configuration rule for serverless functions

#### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  13.2.3.5. Create a network exposure rule for serverless functions

#### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  13.2.4. Serverless function usage

#### Navigation

  To access serverless function assets, under Inventory, select All Assets → Compute → Serverless Functions

  Posture Management → Vulnerability Management) → Vulnerability Issues

  Add Filters → Asset Category → Serverless Function

  Posture Management → Vulnerability Management) → Vulnerable Assets

  Add Filters → Asset Category → Serverless Functions

  13.3. Serverless function runtime security

  13.3.1. Overview

  13.3.2. Set up serverless function protection

  13.3.3. Serverless runtime issues

#### Note

* Issues triggered within 24 hours, sharing the same name and description, will be aggregated into cases along with issues from the same function per execution.

14. Cortex Cloud AI Security

  14.1. What is Cortex Cloud AI Security?

  14.2. Supported services in Cortex Cloud AI Security

  14.3. Cortex Cloud AI Security concepts

  14.4. Cortex Cloud AI Security use cases

  14.5. How to perform advanced AI Security investigations using XQL

#### Note

* For more information, see Build XQL queries.

15. Cloud ASM

  15.1. What is Cloud ASM?

  15.2. Cloud ASM concepts

  15.2.1. Scanning

  15.2.1.1. Scanning cadences

  15.2.1.2. Scanning ports and protocols

#### Note

* The following lists are not exhaustive. For current and complete lists, contact your customer success team.

  15.2.2. Network mapping

  15.3. Enable Cloud ASM

#### Note

* Discovered services will increase workload consumption. ASM data will begin to appear in your tenant and be included in your licensing workload meter within 72 hours.

#### Navigation

  Settings → Configurations → Attack Surface → Data Management

  15.4. Attack Surface Management detections

  15.4.1. Attack surface rules

#### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

  15.4.2. Externally inferred CVEs

#### Note

* An externally inferred CVE might impact your service or asset, but additional investigation is required to confirm that the CVE is actually present.

  15.5. Attack surface assets

#### Navigation

  The internet-facing assets that were discovered in a attack surface management (ASM) scan and attributed to your organization are available in the inventory on the Inventory → Assets → All Assets → External Surface pages

  15.6. Review your unmanaged cloud services

#### Navigation

  Inventory → Assets → All Assets → External Surface → Services

  15.7. Review unmanaged cloud issues

16. Cortex Cloud Application Security

  16.1. Application Security Posture Management (ASPM)

  16.1.1. ASPM use cases

  16.1.2. ASPM key features

  16.1.3. ASPM user roles and permissions

#### Navigation

  You can view AppSec Admin permissions in the tenant by navigating to Settings → Configurations → Roles → AppSec Admin

  16.1.4. ASPM Command Center

  16.1.4.1. ASPM Command Center workflow

#### Note

* Breakdown by type: Issues are further broken down by type (such as IAC or Secrets).

  16.1.5. Coverage

  16.1.5.1. Coverage in the user interface

#### Navigation

  Modules, → Application Security → AppSec Coverage

  16.1.6. Backlog baseline

  16.1.6.1. Backlog use cases

  16.1.6.2. Issue/Finding classification by scanner

#### Note

* In some cases/vendors, this is not accurate as findings are deleted every time new findings are uploaded. In such cases, the feature may not be accurate or supported For SAST, the vendor does not support policy in pull requests

* Scanner updates and new detections: When a security scanner is updated to support new languages, detection rules, or capabilities, any issues discovered by these new features for existing code are classified as part of the backlog.

  16.1.6.3. Using Backlog

  16.1.7. Applications

  16.1.7.1. How to build an application

#### Prerequisite

* Before you begin, ensure you have connected the necessary data sources. Refer to Onboard data sources for more information.

#### Note

* These filters are represented by icons displayed on the Code pane after selecting a VCS.

* To edit application assets, click the Clear All icon before clicking Finish. This clears all application data, allowing you to restart the application building process from the beginning.

  16.1.7.2. Application management and visibility

  16.1.7.3. Business application assets

  16.1.7.3.1. Business application expanded asset details

#### Note

* The topology graph is available only when all application components (code, pipeline, build and deploy), are configured.

  16.1.8. Repositories as assets

  16.1.8.1. Explore repository assets

  16.1.8.2. In-depth repository asset information

  16.1.8.3. Manage Repository assets

  16.1.8.4. Export Software Bill of Materials (SBOM)

  16.1.8.5. Manage issues detected in repositories

#### Note

* You can also find the repository issues in the general issue inventory table, and in the dedicated inventory of issues for each scanner type (see step 4 above for details).

  16.1.9. Onboard data sources

  16.1.9.1. Onboard version control systems

#### Note

* Cortex Cloud Application Security (which includes IaC and Secrets scanning), is an add-on to a license (such as Posture Security) that must be purchased separately.

* Disclaimer: When onboarding with third-party data sources, we outline the required steps for setup, but we do not monitor these external resources, and they may change over time. Always refer to the relevant third-party documentation for the most current integration steps.

#### Tip

* Navigate to Settings → Data Sources (under Data Collections) → + Data Source → enter your VCS data source in the search bar.

  16.1.9.1.1. AWS CodeCommit

#### Prerequisite

* Before you begin: Authorize the user integrating Cortex Cloud Application Security with your AWS CodeCommit instances with the following permissions:       Read more...        codecommit:GitPull: Allows users to pull Git repository changes   codecommit:ListBranches: Grants the ability to list branches within a repository   codecommit:GetBranch:...

#### Note

* Select Connect Another Instance if an instance has already been configured.

* The Resource Name Prefix and ExternalID fields are pre-populated. You can modify the Resource Name Prefix, but DO NOT change the ExternalID!

* To create an additional AWS CodeCommit instance: Hover over the AWS CodeCommit card in the catalog and click Connect Another.

  16.1.9.1.2. Azure Repos

#### Prerequisite

* Before you begin: Authorize the user integrating Cortex Cloud Application Security with your Azure Repos instances with the following permissions and scopes.      Permission   Description       Project Administrator   This permission is required to subscribe to webhooks. For more information, refer to the Microsoft Integrate with service...

#### Note

* Select Connect Another Instance if an instance has already been configured.

* For information on Cortex Cloud Application Security access to all organizations associated with your user token, refer to the Azure Third party application access via OAuth documentation.

* To create an additional Azure Repos instance: Hover over the Azure Repos card in the catalog and click Connect Another.

#### Caution

* Do not limit authorization scope.

  16.1.9.1.3. Bitbucket Cloud

#### Prerequisite

* Before you begin: Authorize the user with the following required permissions and scopes to integrate Cortex Cloud Application Security with your Bitbucket Cloud instances.  Note For write access, go to Bitbucket > Repository Settings and grant the user write access to the relevant repositories.     Permissions    Repository Administrator: To scan pull...

#### Note

* Select Connect Another Instance if an instance has already been configured.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Cloud instance: Hover over the Bitbucket Cloud card in the catalog and click Connect Another.

  16.1.9.1.4. Bitbucket Data Center

#### Prerequisite

* Before you begin: Authorize the user integrating Cortex Cloud Application Security with your Bitbucket Data Center instances with the following permissions:    Member of Project Collection Administrators: Required to subscribe to the build.complete event and download the permissions report for CI/CD scans. As Organization owners are automatically part...

#### Note

* By default, the permissions of the access token are set according to your current access level. It is essential to define two levels of permissions, Project and Repository permissions. The Repository permissions inherit from Project permissions, requiring Repository permissions to match or exceed Project permissions Providing read and write permissions...

* For additional security, it is recommended to set an expiry automatically. The expiry date of a token cannot be changed after it is created. You can see the expiry dates for all your tokens on Profile picture → Manage account → Personal access tokens.

* Select Connect Another Instance if an instance has already been configured.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Data Center instance: Hover over the Bitbucket Data Center card in the catalog and click Connect Another.

#### Important

* Always refer to the Bitbucket documentation for information relating to creating a PAT.

  16.1.9.1.5. GitHub Cloud

#### Prerequisite

* Before you begin: Authorize the user integrating Cortex Cloud Application Security with your GitHub SaaS instances with the following permissions:    Read  access to Dependabot alerts, actions, actions variables, administration, deployments, discussions, metadata, packages, repository hooks, secret scanning alerts, secrets, and security events   Read...

#### Note

* Select Connect Another Instance if an instance has already been configured.

* To create an additional GitHub SaaS instance: Hover over the GitHub SaaS card in the catalog and click Connect Another.

  16.1.9.1.6. GitHub Server

#### Prerequisite

* Before you begin: Authorize the user integrating Cortex Cloud Application Security with your GitHub Server instances with the following permissions and scopes:    Permissions    Organization owner permissions   Administrator repository permissions: In order to scan pull requests (PRs), the user performing the integration must have administrative...

#### Note

* Select Connect Another Instance if an instance has already been configured.

* The domain is the hostname associated with your GitHub Server instance.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitHub Server instance: Hover over the GitHub Server card in the catalog and click Connect Another.

  16.1.9.1.7. GitLab SaaS

#### Prerequisite

* Before you begin: Authorize the user integrating Cortex Cloud Application Security with your GitLab SaaS instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including...

#### Note

* Select Connect Another Instance if an instance has already been configured.

* A repository can only be integrated with a single instance. The first instance that connects with the repository will be the one that the repository is assigned to. This means that if multiple integrations attempt to connect to the same repository, only the first integration to establish the connection will be associated with that repository.

* To create an additional GitLab SaaS instance: Hover over the GitLab SaaS card and click in the catalog and Connect Another.

  16.1.9.1.8. GitLab self-managed

#### Prerequisite

* Authorize the user integrating Cortex Cloud Application Security with your GitLab self-managed instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including all...

#### Note

* Select Connect Another Instance if an instance has already been configured.

* The domain is the hostname associated with your GitLab self-managed instance.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitLab self-managed instance: Hover over the GitLab self-managed card in the catalog and click Connect Another.

  16.1.9.2. Onboard CI/CD systems

  16.1.9.2.1. Onboard CircleCI for CI/CD pipeline scans

#### Prerequisite

* Before you begin: User requirements:    Permissions: To enable Cortex Cloud visibility for all CircleCI projects, a version control system (VCS) user with integration permissions must be authorized. This is because CircleCI's user base integrates with the VCS, inheriting its user permissions. For example, if a GitHub user has access to specific...

#### Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for code scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* To add an additional CircleCI instance, navigate to Settings → Data Sources → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

  16.1.9.2.2. Onboard Jenkins for CI/CD pipeline scans

#### Prerequisite

* Permissions Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

#### Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for code scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* The integration is added on the console but integration is pending, and will only be completed after completing step 5 below. You can view the pending integration on the Jenkins Instances page: Select Data Sources →  Jenkins → View Details. The type of integration is Pipeline Risks

* Always refer to the official Jenkins documentation when installing plugins on Jenkins servers.

* To add an additional Jenkins instance, navigate to Settings → Data Sources → select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps above.

  16.1.9.3. Integrate CI tools

#### Note

* For CircleCI CI/CD pipeline scans, refer to CI/CD .

* For Jenkins CI/CD pipeline scans, refer to CI/CD .

#### Navigation

  Settings → Data Sources → hover over a CI tool and click View Details

  Delete an instance: Right-click on an instance of the CI tool → Delete instance → Delete

  16.1.9.3.1. AWS CodeBuild

#### Prerequisite

* Before you begin: Grant Administrator  permissions to the user integrating AWS CodeBuild with Cortex Cloud Application Security Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress...

#### Note

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional AWS CodeBuild instance, navigate to Settings → Data Sources → select the menu for your connected AWS CodeBuild instance → + New Instance, and repeat the onboarding steps above.

  16.1.9.3.2. Onboard CircleCI for code scans

#### Prerequisite

* Before you begin: Grant Administrator permissions to the user integrating Cortex Cloud Application Security with CircleCI Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress...

#### Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for CI/CD scans, refer to...

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* To add an additional CircleCI instance, navigate to Settings → Data Sources → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

#### Important

* The cortex-secrets naming convention for the context is mandatory to ensure functionality and must not be changed.

  16.1.9.3.3. Connect Cortex CLI

#### Prerequisite

* Permissions: Grant the user installing the CLI required permissions. For more information refer to OverviewOverview Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress...

#### Note

* You can view the latest version of the selected OS.

* Recommended: Select With upload results permissions before generating the API key. This option grants the key permission to not only access data but also to upload or send data back. In the API Keys page, the role associated with these permissions is CLI. If you choose to upload without results permissions, the associated role is CLI Read Only Warning:...

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

#### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter 'CLI' in the search bar to locate the Cortex CLI tool.

  16.1.9.3.4. GitHub Actions

#### Prerequisite

* Before you begin: Grant Administrator  permissions to the user integrating GitHub Actions with Cortex Cloud Application Security Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress...

#### Note

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex Cloud. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional GitHub Actions instance, navigate to Settings → Data Sources → select the menu for your connected GitHub Actions instance → + New Instance, and repeat the onboarding steps above.

  16.1.9.3.5. Onboard Jenkins for code scans

#### Prerequisite

* Grant Administrator permissions to the user integrating Cortex Cloud Application Security with Jenkins Create an egress path to establish the designated route for outbound data transmission from Cortex Cloud to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

* For Cortex Cloud Application Security CI tools, you must store secrets in Jenkins Credentials for use in your Jenkins pipelines using either of these methods:    Plain text storage: Store secrets directly as plain text in Jenkins Credentials. Access them in your pipeline using the credentials function, which retrieves the secret directly as plain...

#### Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for CI/CD scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* This step is only required for new pipelines For private repositories, ensure the necessary credentials are configured in Jenkins Credentials

* This ensures your build runs within a Docker environment. If a node without Docker is used, the build will fail.

* To add an additional Jenkins instance, navigate to Settings → Data Sources →  select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps.

  16.1.9.3.6. Onboard Terraform Cloud (Run Tasks)

#### Prerequisite

* Before you begin: Procure a Terraform cloud license that is either a trial license or a TF Cloud license at the TEAM & GOVERNANCE level Grant the user or team the following permissions, depending on integration:    Manage Workspaces permissions at the organization level. These permissions are required to attach and manage the run task on workspaces...

#### Note

* * Cortex Cloud Application Security performs Image Referencer scans for container image vulnerabilities, as full SCA scans are not supported for Terraform Enterprise (Run Tasks).

* Skip this step if you plan on using an existing token.

* Select Connect Another Instance if an instance has already been configured.

* Cortex Cloud Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Cloud (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected your Terraform Cloud (Run Tasks) instance → + New Instance, and repeat the onboarding steps.

  16.1.9.3.7. Onboard Terraform Enterprise (Run Tasks)

#### Prerequisite

* Before you begin: Ensure access to a Terraform Enterprise console to enable you to provide a user or team token that authorizes Cortex Cloud Application Security to access workspaces and helps regulate run configurations Terraform Enterprise version compatibility: Ensure Run Tasks for workspaces on is compatible with version 1.1.9 and above Terraform...

#### Note

* * For container image vulnerabilities, Cortex Cloud Application Security performs 'Image Referencer' scans within Terraform Enterprise (Run Tasks), as full SCA scans are not currently supported.

* Skip this step if you plan on using an existing token.

* Select Connect Another Instance if an instance has already been configured.

* Cortex Cloud Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Enterprise (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected Terraform Enterprise (Run Tasks) instance → + New Instance, and repeat the onboarding steps above.

  16.1.9.4. CLI pipeline code snippets

  16.1.9.5. Ingest third-party data

#### Note

* Only onboarded and scanned repositories can be mapped.

  16.1.9.5.1. Ingest Veracode SAST data

#### Prerequisite

* Permissions: The following user permissions are required:    Cortex Cloud: Instance Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions   Veracode: At minimum, Reviewer permissions are required Permissions: The following user permissions are required: Cortex...

#### Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between Veracode projects and Cortex Cloud Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped applications are ingested

  16.1.9.5.2. Ingest SonarQube SAST data

#### Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Generate and copy a SonarQube API token. Ensure to assign Web API scope to the API token. Refer...

#### Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between SonarQube Applications and Cortex Cloud Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

  16.1.9.5.3. Ingest Semgrep data

#### Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Create a Semgrep API token  Note To create a Semgrep API token, in Semgrep, navigate to Settings...

#### Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between Semgrep Projects Applications and Cortex Cloud code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

  16.1.9.5.4. Generic 3rd Party AppSec Collector

#### Important

* File uploads are limited to a maximum size of 10 MB.

  16.1.9.5.4.1. Onboard the 3rd Party AppSec Collector

#### Prerequisite

* Permissions: The following Cortex Cloud user roles or RBAC permissions are required:    User roles: CortexCortex Cloud Cloud Instance Admin, AppSec Admin   RBAC: View/Edit permissions for Data Sources configurations are required when not using a dedicated user role    For more information about user permissions and groups, refer to Assign user roles...

#### Note

* We recommend using the tool.driver.name from the SARIF file

* This is the newly created generic collector API URL endpoint.

* Only the validity of the format is tested. No findings will be generated from the test file.

#### Warning

* The API key ID and API secret cannot be retrieved once the wizard is closed.

  16.1.9.6. Manage data source integrations

#### Navigation

  Settings → Data Sources → use the search bar to locate the required data source

  16.1.10. Transporter over Broker VM

#### Prerequisite

* Ensure you have the necessary permissions and have already set up your Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex Cloud resources. The IP addresses for the Transporter are in the Broker VM Resources section of the Enable access to required PANW resources document Open port 4052 (inbound), which...

#### Note

* The broker enables multiple connections, allowing a single Transporter applet to connect to various VCS instances Multiple Transporter applets cannot be created on a single Broker VM. Each Broker VM is limited to a single Transporter applet instance

#### Warning

* The Transporter applet is not supported for FedRAMP customers.

  16.1.10.1. Setup a Transporter applet on Broker VM

#### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator)

#### Note

* You cannot add a Transporter applet through Clusters.

#### Navigation

  your AppSec Transporter under the App column → Configure → Add Connection (on the redirected AppSec Transporter setup page

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

  16.1.10.2. Setup a Transporter on your VCS

#### Prerequisite

* Ensure you have user permissions to onboard data sources  Note The dedicated AppSec Admin role includes the required permissions. Ensure you have user permissions to onboard data sources Before you begin you must setup a Transporter applet on your Broker VM. Refer to Setup a Transporter applet on Broker VM for more information

#### Note

* GitLab Enterprise webhook internal IP restriction: GitLab Enterprise's security policies prevent webhook subscriptions to internal IP addresses (such as broker addresses). These subscriptions can only be enabled through specific instance configuration. For more information, refer to https://docs.gitlab.com/security/webhooks/.

#### Navigation

  Settings → Data Sources → + Add Data Source → select your VCS on-premises data source

  16.1.11. Manage 3rd party findings and generated issues

  16.1.12. Manage code weaknesses

#### Note

* You can customize policies to define which findings are categorized as issues.

#### Tip

* You can also view SAST CWE issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Code Weaknesses tab under the Repositories asset inventory. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset...

#### Navigation

  To access SAST code violation issues, under Modules, select Application Security → Issues → Code Weaknesses

  16.1.12.1. Code weaknesses issue inventory

  16.1.12.2. Expanded code weaknesses issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  16.1.12.3. SAST code weakness findings

#### Note

* Findings on the Cortex Cloud platform are not intended for direct action; but rather represent data collected by the platform. They must be promoted to issues to enable mitigation efforts to secure your codebase.

  16.2. CI/CD Security

  16.2.1. CI/CD Security user roles and permissions

  16.2.2. CI/CD Assets

  16.2.2.1. CI/CD Instances as assets

  16.2.2.1.1. Explore CI/CD Instance assets

#### Navigation

  To access CI/CD pipeline instances, under Inventory, select All Assets → Code → Category → CI/CD Instances

  16.2.2.1.2. In-depth CI/CD pipeline instance asset information

  16.2.2.1.3. Manage CI/CD pipeline instances

  16.2.2.2. CI/CD Pipelines as assets

  16.2.2.2.1. Explore CI/CD Pipeline assets

#### Navigation

  To access CI/CD pipelines assets, under Inventory, select All Assets → Code → CI/CD Pipelines

  16.2.2.2.2. In-depth CI/CD pipeline asset information

#### Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

  16.2.2.2.3. Manage CI/CD pipeline assets

  16.2.2.3. Version Control System (VCS) Organizations as assets

  16.2.2.3.1. Explore VCS Organization assets

#### Navigation

  To access VCS Organization assets, under Inventory, select All Assets → Code → VCS Organizations

  16.2.2.3.2. In-depth VCS Organization asset information

#### Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

  16.2.2.3.3. Manage VCS organization assets

  16.2.2.4. VCS Collaborators-as-assets

  16.2.2.4.1. In-depth Collaborator asset information

  16.2.2.4.2. Manage Collaborator assets

  16.2.3. Supply Chain tools

#### Note

* Rejected does not mean the tool is not in use. It allows application security practitioners to search for and remove these tools as needed For information about changing the tool status, refer to Overview

  16.2.3.1. Supply Chain use cases

#### Navigation

  To access Supply Chain Tools, select Modules → Application Security → Supply Chain Tools (under 3rd Party Tools

  16.2.3.2. Explore Supply Chain tools

  16.2.3.3. Expanded Supply Chain tool information

#### Note

* AppSec Admin user permissions are required to perform these actions.

  16.2.4. CI/CD Risks

#### Note

* Cortex Cloud Application Security CI/CD pipeline scans create a comprehensive inventory of all CI/CD pipelines in your environment. For more information refer to CI/CD Pipelines as assets.

  16.2.4.1. CI/CD pipeline issues

#### Navigation

  To access CI/CD pipeline risks issues, under Modules, select Application Security → Issues → CI/CD Risks

  16.2.4.2. Expanded CI/CD risks issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  16.2.4.3. VCS and CI/CD pipeline risk findings

  16.2.5. CI/CD Rules

#### Note

* Out-of-the-box rules cannot be modified Custom CI/CD rules are not supported

  16.2.5.1. CI/CD rules roles and permissions

  16.2.5.2. CI/CD rules inventory

#### Navigation

  In the Filter panel, select Category → Scanner → CI/CD Security

  16.2.5.3. Create custom CI/CD rules

#### Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

  16.2.5.4. Manage CI/CD rules

  16.2.6. CI/CD Policies

  16.2.6.1. CI/CD policies user roles and permissions

  16.2.6.2. CI/CD policies inventory

  16.2.6.3. Create custom CI/CD policies

#### Note

* PR Scan and CI Scan triggers are automatically disabled and unchecked. They can only be enabled if other scan types (that is non-CI/CD risk scans such as Secrets) are also selected, and will only run on non-CI/CD risks types of scans

* You can combine multiple conditions to create complex rules for when the policy should apply. Create conditions that apply to a CI/CD policy which detects high severity CI/CD risks on GitHub: Select Add Filter → Finding Type → CI/CD Risks → AND → Provider → [VCS/CI/CD system] → AND → Severity: → High.

* SBAC scope limitations do not apply to Matching Criteria For CI/CD policies, you can filter Matching Criteria by VCS Organization Name, CI/CD Pipeline [Name/ID], CI/CD Instance [Name/ID] or Collaborator [Name/Email/MFA Enabled/Last Observed]

  16.2.6.4. Manage CI/CD policies

#### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

  16.2.7. CI/CD Compliance

#### Navigation

  To access Compliance, select Posture Management → Compliance → Reports or Assessment

  16.2.7.1. Create CI/CD compliance reports

#### Note

* The CI/CD module supports GitHub and GitLab providers.

* For more information about about Asset Groups, refer to Asset Groups.

* CIS GitLab Benchmark, CIS GitHub Benchmark, and the OWASP Top 10 CI/CD Risks standards are supported.

* For more information about assessment profiles, refer to Use an assessment profile to run compliance checks on your assets.Use an assessment profile to run compliance checks on your assets

#### Navigation

  Posture Management → Compliance → Assessment or Reports

  16.3. Code Security

  16.3.1. Code Security user roles and permissions

  16.3.2. Code Security assets

  16.3.3. Software packages as assets

  16.3.3.1. In-depth software package asset information

  16.3.4. Infrastructure-as-Code (IaC) resources as assets

  16.3.4.1. Explore IaC assets

#### Navigation

  To access IaC assets, under Inventory, select All Assets → Code → IaC Resources

  16.3.4.2. In-depth IaC resource asset information

  16.3.5. Code Security scanners

  16.3.6. Software Composition Analysis (SCA ) scanners

  16.3.6.1. Supported Software Composition Analysis (SCA) frameworks and languages

  16.3.6.2. Software Composition Analysis (SCA) CVE vulnerability issues

#### Tip

* You can also view SCA vulnerabilities in dedicated tabs under other sections when available: In Asset inventories, navigate to Inventory → All Assets → Code:    On the Vulnerabilities tab under Repositories. Refer to In-depth repository asset information for more information Under the All Code inventory: Select an asset from the table →...

#### Navigation

  To access CVE vulnerability issues, under Modules, select Application Security → Issues → Vulnerabilities

  16.3.6.2.1. SCA CVE vulnerabilities inventory

  16.3.6.2.2. Expanded CVE vulnerabilities issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  16.3.6.2.3. CVE vulnerabilities findings

#### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

#### Navigation

  To access CVE findings, under Modules, select Application Security → Issues → Vulnerabilities → click the Findings tab

  16.3.6.2.4. Manage SCA CVE vulnerability issues

  16.3.6.3. License miscompliance issues

#### Tip

* You can also view license miscompliance issues in dedicated tabs under other sections when available: In Application asset inventories: navigate to Inventory → All Assets →  Application → select an option from the Application menu → select an item from the inventory → Package Integrity In Asset inventories, navigate to Inventory → All...

#### Navigation

  To access license miscompliance issues, under Modules, select Application Security → Issues → Licenses

  16.3.6.3.1. License miscompliance issues inventory

  16.3.6.3.2. Expanded License miscompliance issues information

  16.3.6.3.3. License miscompliance findings

#### Navigation

  To access license miscompliance findings, under Modules, select Application Security → Issues → Licenses → click the Findings tab

  16.3.6.3.4. Open-source software license categories

  16.3.6.3.5. Manage license miscompliance issues

  16.3.6.4. Package Integrity

  16.3.6.4.1. Package Integrity issues inventory

#### Navigation

  Modules → Application Security → Package Integrity (under Issues

  16.3.6.4.2. Expanded Package Integrity issues inventory information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  16.3.6.4.3. Package Integrity findings

#### Note

* Findings cannot be mitigated. They must be promoted to issues to enable remediation efforts to secure your software packages.

#### Navigation

  navigate to Modules → Application Security → Package Integrity (under Issues) → click the Findings tab

  16.3.6.4.4. Manage Package Integrity issues

  16.3.7. Secrets scanners

  16.3.7.1. Secrets issues

#### Tip

* You can also view Secrets issues in dedicated tabs under other sections when available: In Code asset inventories: navigate to Inventory → All Assets → Code:    On the Secrets tab under Repositories. Refer to In-depth repository asset informationfor more information   Under the All Code inventory: Select an asset from the table → Secrets In Code...

#### Navigation

  Under Modules, select Application Security → Issues → Secrets

  16.3.7.2. Secrets issues inventory

  16.3.7.3. Expanded Secrets issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  16.3.7.4. Secrets findings

#### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

#### Navigation

  To access Secrets findings, select Application Security → Issues → Secrets → click the Findings tab

  16.3.7.5. Manage Secrets issues

  16.3.8. Infrastructure as Code (IaC) scanners

  16.3.8.1. Supported frameworks and languages

  16.3.8.2. IaC misconfiguration issues

#### Tip

* You can also view IaC misconfiguration issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Configuration tab under Repository assets. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from...

#### Navigation

  To access IaC misconfiguration issues, under Modules, select Application Security → Issues → IaC misconfiguration

  16.3.8.3. IaC misconfiguration issues inventory

  16.3.8.4. Expanded IaC misconfiguration issue information

#### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

  16.3.8.5. IaC misconfiguration findings

#### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

#### Navigation

  To access IaC misconfiguration findings, under Modules, select Application Security → Issues → IaC Misconfigurations → click the Findings tab

  16.3.8.6. Manage IaC misconfiguration issues

  16.3.9. Application Security scans management

  16.3.9.1. How to access Cortex Cloud Application Security scan management

#### Note

* While scans provide a comprehensive inventory of all issues detected during a scan, dedicated inventories are also maintained for specific scan types for more granular management. For more information, refer to Infrastructure as Code (IaC) scanners, Secrets scanners and Software Composition Analysis (SCA ) scanners.

  16.3.9.2. Branch periodic scans

#### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

  16.3.9.3. Pull Request scans

#### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

  16.3.9.4. CI scans

#### Note

* The inventory table displays scan issues for visibility only; remediation is not available in scan management. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

  16.3.9.5. Manage repository scan configurations

#### Note

* For Secrets scans you configure these additional settings: Git history scan: scans Git history to detect secrets deleted from files but still present in past commits, notifying you of these exposures. This helps mitigate the risk of compromised credentials that may be found in the repository's history Secret validation: validates detected secrets...

#### Navigation

  Settings → Data Sources → hover over a connected data source from the catalog → click View Details

  16.3.9.6. Monitor data source instances health

  16.3.10. Application Security Policies

  16.3.10.1. User roles and permissions

  16.3.10.2. Create Cortex Cloud Application Security policies

#### Note

* Add additional condition attributes for a single finding type by using the OR operator When selecting multiple finding types, only filters common to all types are available

* If you select the Applications asset type, the policy evaluates all repositories for matching applications SBAC scope limitations do not apply to Asset Types

  16.3.10.2.1. Cortex Cloud Application Security policy condition attributes

#### Note

* The Severity, AppSec Rule, AppSec Rule Label and Backlog Status attributes are not dependent on the Finding Type attribute For more information about Backlog Status, refer to Backlog baseline

* For CI/CD Risks as the finding type, refer to CI/CD policies user roles and permissions.

  16.3.10.3. Manage Cortex Cloud Application Security policies

#### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

  16.3.11. Application Security Rules

#### Note

* Out-of-the-box rules cannot be modified directly. However, you can create a custom rule by cloning the existing one. This allows you to make changes to the original rule according to your requirements. Refer to Manage Cortex Cloud Application Security custom rules for more information.

  16.3.11.1. Roles and permissions

  16.3.11.2. Rules inventory

#### Navigation

  To filter rules relating to Secrets, select filter icon → Scanner (from the Select field) → Secrets (from the Value field

  16.3.11.3. Create custom Cortex Cloud Application Security rules

#### Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

  16.3.11.4. Manage Cortex Cloud Application Security custom rules

  16.3.11.5. Configure YAML file properties

  16.3.12. Application Security CLI

#### Prerequisite

* For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

#### Note

* For detailed information about the Cortex Cloud CLI, refer to Cortex CLI.

  16.3.12.1. Connect Cortex CLI

#### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

#### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Cortex Cloud Application Security, refer to Cortex CLI usage for Cortex Cloud Application Security

#### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

  16.3.12.2. Cortex CLI usage for Cortex Cloud Application Security

  16.3.12.3. Cortex CLI Cortex Cloud Application Security command line reference

#### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

#### Important

* The Cortex CLI Cortex Cloud Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id...

  16.3.12.4. Cortex CLI common command line reference guide

#### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

  16.3.13. IDE

#### Note

* Not all remediation options are available for all findings or all type of scan category.

  16.3.13.1. System requirements

  16.3.13.2. Visual Studio (VS) Code

#### Prerequisite

* Before you begin: Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

#### Note

* Enforcement rules and CA certificates are not applicable to the open-source project.

#### Navigation

  Install through VS Code IDE: Access the Activity bar → select Extensions → Cortex Cloud → Install

  16.3.13.2.1. How to use the Cortex Cloud extension in VS Code

#### Note

* Not all remediation options are available for all issues.

* The suppression is scoped to the file.

  16.3.13.3. JetBrains

#### Prerequisite

* Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install Node.js version 22 and...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

#### Note

* The Cortex AppSec code security plugin supports all JetBrains products.

#### Navigation

  Settings → Plugins → select the Marketplace tab → search for Prisma Cloud → Install → OK

  Settings → Tools → Cortex Cloud

  16.3.13.3.1. How to use the JetBrains Cortex Cloud extension

#### Note

* After selecting Fix Available, the number of issues displayed in the issue categories (such as IaC) reflect the number of fixable issues for that type.

* The corresponding file simultaneously opens in the Code editor, highlighting the issue within its exact code context. See below for more information.

* Not all types of remediation are available for all issue categories. For example, fixes are not available for License issues.

* Secrets and Licenses category issues are typically mitigated by following the guidance in the Documentation.

  16.4. API documentation

17. Cortex Cloud Data Classification

  17.1. What is Cortex Cloud Data Classification?

  17.2. How to create and validate a custom data pattern

#### Note

* Once a custom data pattern is saved, it runs on all data in the same way as any out-of-the-box (OOTB) pattern, becoming globally applicable for all modules using Cortex Cloud Data Classification.

* For more information, see How to disable and enable data patterns in Data Classification.

  17.3. How to disable and enable data patterns in Data Classification

#### Note

* Disabling data patterns can cause changes in your data profile results and stop detection of these data patterns.

* For more information about data patterns in data classification, see What is Cortex Cloud Data Classification?.

#### Navigation

  In Cortex Command Center, click Settings → Configurations → Data Classification → Data Patterns

  17.4. How to create and validate a custom data profile

#### Note

* If you choose two data locations, only the filters they have in common will be included in the possible filter options.

* For more information, see How to disable and enable data profiles in Cortex Cloud Data Classification.

#### Important

* Deleting a data profile deletes all past data associated with it in all modules using Cortex Cloud Data Classification after a warning notification is displayed.

* Enabling and disabling a data profile removes or re-adds the data profile results to the data objects; that is, files and tables.

  17.5. How to disable and enable data profiles in Cortex Cloud Data Classification

#### Note

* Existing results on past scans are updated in the Asset and Object inventories within two hours after being disabled or enabled.

* For more information about data profiles in Cortex Cloud Data Classification, see What is Cortex Cloud Data Classification?.

#### Navigation

  In Cortex Cloud Security Command Center, click Settings → Configurations → Data Classification → Data Profiles

18. Cortex Cloud Data Security

  18.1. What is Cortex Cloud Data Security?

  18.2. Supported assets in Cortex Cloud Data Security

#### Note

* The list above refers to only data classification; however, Cortex Cloud Data Security discovers and monitors all cloud assets and services for usage and misconfigurations.

* For information about configuring data classification asset types, see How to configure the scanning settings for supported services.

  18.3. Cortex Cloud Data Security concepts

  18.4. Cortex Cloud Data Security use cases

  18.5. Data Inventory

#### Note

* To clear the filters in the filter panel, click Delete.

#### Navigation

  When you select Inventory → All Assets → Data → All Data, a list of all data assets appears

  18.6. How to review errors in Cortex Cloud Data Security

  18.7. How to configure the scanning settings for supported services

#### Note

* All the asset types are selected by default. When you deselect a data asset type, it is not included when the system runs the next scan operation, reducing the total scan time.

  18.8. How to perform advanced Data Security investigations using XQL

#### Note

* For more information, see Build XQL queries.

  18.9. How to onboard Snowflake (Posture)

#### Prerequisite

* In order to use Snowflake (Posture), you must be registered with one of these cloud providers: Amazon AWS, Microsoft Azure, or Google Cloud Platform (GCP). Ensure you have the necessary account permissions to onboard. It is recommended to use account admin as the role for the onboarding.

#### Note

* The account identifier can be found using the user information at the bottom left. Hover over the account you wish to onboard and select the copy option at the top right. The account identifier is usually of the format: (organization).[account]

  18.10. How to onboard Microsoft 365 (Posture)

#### Prerequisite

* You have generated a Globally Unique Identifier (GUID), also known as a Universally Unique Identifier (UUID). You will need this ID for the tenant you want to use for the Microsoft 365 (Posture) instance. In order to use Microsoft 365 (Posture), you must be registered with Microsoft Azure.

  18.11. How to use information protection labels in Cortex Cloud Data Security

#### Note

* Only If you have connected a Microsoft 365 instance to Cortex Cloud, the information protection labels appear. See How to onboard Microsoft 365 (Posture).

19. Cortex Cloud Identity Security

  19.1. What is Cortex Cloud Identity Security?

  19.2. Cortex Cloud Identity Security concepts

#### Note

* Access to the Weak/Compromised Password column requires the ITDR add-on.

* Only ITDR assets can have a risk score.

* When a policy is analyzed and categorized as excessive, a relevant finding and highlight is attached to that policy and the various identities being granted excessive permissions.

* Each action must be defined as either being administrative or not. The administrative tag is an additional tag for administrative actions, along with one of the other access level types. For example, the AWS action iam:CreateGroup is categorized as config and has the administrative tag as well.

#### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

  19.3. Cortex Cloud Identity Security principles

  19.4. Cortex Cloud Identity Security use cases

  19.5. How to manage RBAC and SBAC in Cortex Cloud Identity Security

#### Important

* You can use the Cortex Cloud Identity Security RBAC roles to define access to the various sections and functionalities of Cortex Cloud Identity Security, but these roles do not directly control the specific data a user sees within those sections. Data visibility is further refined and limited by scope-based access control (SBAC) capabilities.

  19.6. How to achieve the principle of least privilege access

#### Note

* In the case of Amazon AWS, Cortex Cloud Identity Security also uses AWS Identity and Access Management (IAM) Access Advisor insights to expand the coverage of supported actions.

#### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

  19.7. How to enable inactive human identity logs on Azure in Cortex Cloud Identity Security

#### Note

* For more information, see Ingest logs from Microsoft Azure Event Hub.

  19.8. How to perform advanced Identity Security investigations using XQL

#### Note

* For more information, see Build XQL queries.

20. Cortex Advanced Email Security

  20.1. Cortex Advanced Email Security module overview

#### Prerequisite

* The following are prerequisites for using the Cortex Cloud Advanced Email Security module. REQUIREMENT DESCRIPTION Setup and Permissions Ensure Analytics is activated before enabling the Cortex Advanced Email Security module. Licenses and Add-ons Cortex Advanced Email Security add-on.

  20.2. Cortex Advanced Email Security module architecture and data flow

  20.3. Getting started with the Cortex Advanced Email Security module

#### Prerequisite

* Before you configure the Cortex Advanced Email Security module, ensure you have the following: Admin-level access to the target email platform API permissions to read mailbox data, manage remediation (if desired), and access user directories Dedicated service account (recommended) for integration purposes (response actions) List of domains and...

  20.4. Deploy and configure the Email Security module

  20.4.1. Integrate Microsoft 365 with the Cortex Advanced Email Security Module

#### License Type

  To configure a quick action, you must first create an application in Microsoft O365.

#### Navigation

  After you onboard your domains and configure the quick actions, Cortex Cloud manage your protected domains in Modules → Email Security → Email Security Configuration

  20.4.2. Configure the Cortex Advanced Email Security module

#### License Type

  Requires the Email Security module.

#### Note

* You can add email indicators to the Allow List also in Exceptions Configuration → Issue Exclusions. However, if you add multiple indicators in a rule using Issue Exclusions under Exceptions Configuration, you cannot edit the rule in the Email Security Allow List.

#### Navigation

  Modules → Email Security → Email Security Configuration

  20.5. Cortex Advanced Email Security threat detection and issues

#### Note

* Depending on data collection mode and platform capabilities, not all fields may be populated for every message. API and export documentation provides further clarification on optional vs required fields.

  20.5.1. Email Security Analytics Rules

#### Navigation

  The Email Security Analytics Rules page is in Modules → Email Security → Email Security Detection Rules

  20.6. Investigate and respond to email security issues

#### License Type

  Requires the Cortex Advanced Email Security module.

#### Navigation

  Modules → Email Security → Email Security Issues

  20.7. Automate remediation for the Cortex Advanced Email Security module

  20.8. Email Command Center

#### License Type

  Requires the Cortex Advanced Email Security module.

21. Data management

  21.1. Broker VM

  21.1.1. What is the Broker VM?

  21.1.2. Set up and configure Broker VM

#### Note

* The Broker VM comes with a 512 GB disk. Therefore, deploy the Broker VM with thin provisioning, meaning the hard disk can grow up to 512 GB but will do so only if needed.

* When DHCP is not enabled in your network and there isn't an IP address for your Broker VM, configure the Broker VM with a static IP using the serial console menu.

* When configuring a Local Agent Settings applet with installer and content caching, you need to configure an SSL certificate for the Broker VM as explained in the task below. For more information on specific requirements for the Local Agent Settings applet, see Activate Local Agent Settings. Keep in mind that several Broker VM applets, such as the...

* You can configure another Broker VM as a proxy server for this Broker VM by selecting the HTTP type. When selecting HTTP to route Broker VM communication, you need to add the IP Address and Port number (set when activating the Agent Proxy) for another Broker VM registered in your tenant. This designates the other Broker VM as a proxy for this Broker VM.

* The Palo Alto Networks Broker VM supports only strong cipher SHA256-based certificates. MD5/SHA1-based certificates are not supported.

* If adding a CA certificate to the Broker VM is not possible, ensure that you've added the Broker Service FQDNs to the SSL Decryption Exclusion list on your firewalls. See Enable Access to Cortex XDR.

#### Important

* There can be instances in which the Broker VM requires up to 50% of the incoming bandwidth as outgoing. Such instances can be, network instability between the Broker VM and Cortex Cloud, or data that is being collected, but not well compressed.

* The internal network for the Broker VM must be unique and reserved. Other devices should not use the same IP as the Broker VM internal network as it can lead to communication issues with the Broker VM.

* If you use SSL decryption in your firewalls and proxies, see the Understanding CA certificate functionality in Broker VM deployments section below. In addition, verify that the proxies used support HTTP/2, gRPC-specific headers, and HTTP/2 trailers, and the inspection policies support gRPC traffic. Any devices that you use with this configuration...

* When configuring more than one network interface, ensure that only one Default Gateway is defined. The rest must be set to 0.0.0.0, which configures them as undefined. In addition, we recommend assigning each network interface to a different subnet, as oppose to configuring two interfaces on the same subnet which can potentially cause unexpected...

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and earlier, Cortex Cloud will only accept 172.17.0.0/16.

* We strongly recommend disabling SSH connectivity when it's not being used. Therefore, activate SSH connectivity when it's needed and disable it right afterwards. When generating a new SSH key ensure to avoid embedding the domain-style username, by not using any backslashes (\) in the comment field, to ensure the SSH key passes validation.

  21.1.2.1. Broker VM image installations

  21.1.2.1.1. Set up Broker VM on Alibaba Cloud

#### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

#### Note

* For Linux and Windows uploads, you can use Alibaba Cloud's graphical management tool called ossbrowser.

* The Object Storage Service must be created in the same Region as the image of the virtual machine.

#### Navigation

  Hamburger menu → Elastic Compute Service → Instances & Images → Instances

  21.1.2.1.2. Set up Broker VM on Amazon Web Services

#### Prerequisite

* Download a Cortex Cloud Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. You need to set up an AWS VM Import role (vmimport) before you continue with the steps to convert the image as it is required for the import-image CLI command. You can use a different role, if the...

#### Note

* Creating an AMI image can take up to 60 minutes to complete.

* Assigning security groups can take up to 15 minutes.

#### Important

* A t2.medium (4GB RAM) is the lowest machine type that can be used as an instance type. Usually, the lowest machine type is sufficient with the Local Agent Settings applet. Yet, when enabling more applets, 8 GB is required.

#### Navigation

  Log in to the AWS IAM Console, and in the navigation pane, select Access Management → Users → Add Users

  Obtain a registration token from the Cortex Cloud Web Console by selecting Settings → Configurations → Data Broker → Broker VMs → Add Broker → Generate Token

  21.1.2.1.3. Set up Broker VM on Google Cloud Platform (GCP)

#### Prerequisite

* Download a Cortex Cloud Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. To complete the set up, you must have G Cloud installed and have an authenticated user account.

* Before importing a GCP image using the gcloud CLI, ensure that you update the Google Cloud components to version 371.0.0 and above using the following command:

#### Note

* The import tool uses Cloud Build API, which must be enabled in your project. For the import to work, Cloud Build service account must have compute.admin and iam.serviceAccountUser roles. When using the Google Cloud console to import the image, you will be prompted to add these permissions automatically.

  21.1.2.1.4. Set up Broker VM on KVM using Ubuntu

#### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  21.1.2.1.5. Set up Broker VM on Microsoft Azure

#### Prerequisite

* Download a Cortex Cloud Broker VM VHD (Azure) image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

#### Note

* Extraction can take up to a few hours.

* Upload can take up to a few hours.

* Creating the VM can take up to 15 minutes. The Broker VM Web UI is not accessible during this time.

* For more information on creating a rule in an Azure VM, see Create a Security Rule in the Azure Documentation.

  21.1.2.1.6. Set up Broker VM on Microsoft Hyper-V

#### Prerequisite

* Download a Cortex Cloud Broker VM VHD image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  21.1.2.1.7. Set up Broker VM on Nutanix Hypervisor

#### Prerequisite

* Download a Cortex Cloud Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

#### Note

* Saving the image to Nutanix hypervisor can take time as it's a large file.

* Creating the VM can take up to 15 minutes. The Broker VM Web user interface is not accessible during this time.

  21.1.2.1.8. Set up Broker VM on VMware ESXi using vSphere Client

#### Prerequisite

* Ensure you have a virtualization platform installed that is compatible with an OVA image, and have an authenticated user account. Download a Cortex Cloud Broker VM OVA image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  21.1.2.2. Broker VM data collector applets

#### License Type

  Some data collector applets require the Data Collection add-on.

  21.1.2.2.1. Activate Apache Kafka Collector

#### License Type

  Requires the Data Collection add-on. This data source is only available in your tenant if the tenant was activated before October 1, 2025 with an active Data Collection add-on.

#### Prerequisite

* Apache Kafka version 2.5.1 and above. Kafka cluster set up on premises, from which the data will be ingested. Privileges to manage Broker Service configuration, such as Instance Administrator privileges. Create a user in the Kafka cluster with the necessary permissions and the following authentication details:    Broker Certificate and Private Key for...

#### Note

* For CEF and LEEF logs, Cortex Cloud takes the vendor and product names from the log itself, regardless of what you configure on this page.

  21.1.2.2.2. Activate CSV Collector

#### License Type

  Requires the Data Collection add-on. This data source is only available in your tenant if the tenant was activated before October 1, 2025 with an active Data Collection add-on.

#### Prerequisite

* Set up and configure Broker VM. Ensure that you share the applicable CSV files. Know the complete file path for the Windows directory.

#### Note

* When you implement a wildcard file search, ensure that the CSV files share the same columns and header rows as all other logs that are collected from the CSV files to create a single dataset.

* The CSV Collector checks for new CSV files every 10 minutes.

  21.1.2.2.3. Activate Database Collector

#### License Type

  Requires the Data Collection add-on. This data source is only available in your tenant if the tenant was activated before October 1, 2025 with an active Data Collection add-on.

#### Prerequisite

* Set up and configure Broker VM

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  21.1.2.2.4. Activate Files and Folders Collector

#### License Type

  Requires the Data Collection add-on. This data source is only available in your tenant if the tenant was activated before October 1, 2025 with an active Data Collection add-on.

#### Prerequisite

* Set up and configure Broker VM. Know the complete path to the files and folders that you want Cortex Cloud to monitor. Ensure that the user permissions for the network share include the ability to rename and delete files in the folder that you want to configure collection.

#### Note

* Cortex Cloud only supports ingestion of files encoded in UTF-8 format.

* When using the Linux file share, including the Linux share with nfs, a Username and Password is not required, so these fields are grayed out in the screen.

* In Batch mode, the Files and Folders Collector supports collecting logs from a network share for a maximum file size of 500 MB.

* When uploading JSON files, Cortex Cloud only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* When the storing method is Replace, the maximum size for the total data to be imported into a lookup dataset is 30 MB each time the data is fetched. The inventory data ingested using the Files and Folders collector is counted towards license utilization. When you use a JOINT function with a lookup table in a query or correlation rule, make sure you...

* You can't specify a file name that's the same as a system file name. The name of a dataset created from a tsv file must always include the extension. If the original file name is mrkdptusrsnov23.tsv, you can name save the dataset with the name marketing_dept_users_Nov_2023.tsv.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

  21.1.2.2.5. Activate FTP Collector

#### License Type

  Requires the Data Collection add-on. This data source is only available in your tenant if the tenant was activated before October 1, 2025 with an active Data Collection add-on.

#### Prerequisite

* Set up and configure Broker VM. Ensure that the user permissions for the FTP, SFTP, or FTPS include the ability to rename and delete files in the folder that you want to configure collection. When setting up an FTPS Collector with a server using a Self-signed certificate, you must upload the certificate first to the Broker VM as a Trusted CA...

#### Note

* When configuring an SFTP connection, Cortex Cloud expects the private key to be in the RSA format that is included in the -----BEGIN RSA PRIVATE KEY----- tag. Cortex Cloud does not support providing the private key in the OpenSSH format from the -----BEGIN OPENSSH PRIVATE KEY----- tag. When using ssh-keygen using a Mac, you get the OpenSSH format by...

* When uploading JSON files, Cortex Cloud only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

  21.1.2.2.6. Activate Local Agent Settings

#### Note

* This is assuming a standard hardware setup with 2vCPU 8 GB memory.

* Broker VMs can act as as a proxy for routing XDR Collector traffic to the Cortex Cloud tenant. The Broker VM does not cache XDR Collector installers.

* When you install your XDR agents, you need to configure the IP address of the Broker VM and a port number during the installation. You can use the default 8888 port or set a custom port. You are not permitted to configure port numbers between 0-1024 and 63000-65000, or port numbers 4369, 5671, 5672, 5986, 6379, 8000, 9100, 15672, 25672. Additionally,...

#### Important

* A FQDN must be configured for Agent Installer and Content Caching to function properly.

* You can only enable Agent Installer and Content Caching, when in the Broker VM Configuration, you've uploaded your signed SSL Server Certificate and key and set the FQDN. For more information, see the Agent Installer and Content Caching requirements explained above.

  21.1.2.2.7. Activate Files and Folders Collector

#### License Type

  Requires the Data Collection add-on. This data source is only available in your tenant if the tenant was activated before October 1, 2025 with an active Data Collection add-on.

#### Prerequisite

* Set up and configure Broker VM. Know the complete path to the files and folders that you want Cortex Cloud to monitor. Ensure that the user permissions for the network share include the ability to rename and delete files in the folder that you want to configure collection.

#### Note

* Cortex Cloud only supports ingestion of files encoded in UTF-8 format.

* When using the Linux file share, including the Linux share with nfs, a Username and Password is not required, so these fields are grayed out in the screen.

* In Batch mode, the Files and Folders Collector supports collecting logs from a network share for a maximum file size of 500 MB.

* When uploading JSON files, Cortex Cloud only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* When the storing method is Replace, the maximum size for the total data to be imported into a lookup dataset is 30 MB each time the data is fetched. The inventory data ingested using the Files and Folders collector is counted towards license utilization. When you use a JOINT function with a lookup table in a query or correlation rule, make sure you...

* You can't specify a file name that's the same as a system file name. The name of a dataset created from a tsv file must always include the extension. If the original file name is mrkdptusrsnov23.tsv, you can name save the dataset with the name marketing_dept_users_Nov_2023.tsv.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

  21.1.2.2.8. Activate NetFlow Collector

#### License Type

  Requires the Data Collection add-on.

#### Prerequisite

* Set up and configure Broker VM

#### Note

* Since multiple network devices can send data to a single NetFlow Collector, we recommend that you configure a maximum of 50 NetFlow Collectors per Broker VM applet, with a maximum aggregated rate of approximately 50K flows per second (FPS) to maintain system performance.

* Since Cortex Cloud reserves some port numbers, it is best to select a port number that is not in the range of 0-1024 (except for 514), in the range of 63000-65000 or has one of the following values: 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672.

* The options available change, according to the set Source Network value.

  21.1.2.2.9. Activate Network Mapper

#### Prerequisite

* After you have configured and registered your Broker VM, you can choose to activate the Network Mapper application.

#### Note

* Each IP address range can receive multiple scan requests based on it's availability.

* IP address ranges are displayed according to what you defined as your Network Parameters.

  21.1.2.2.10. Activate Pathfinder

#### Prerequisite

* Configure and register a Broker VM. Except for Vanilla Windows 7, Cortex Cloud supports activating Pathfinder on Windows operating systems with PowerShell version 3 and later. Verify these requirements wherever you want to activate Pathfinder. The Pathfinder configuration must contain at least one IP address range to run. Make sure that your internal...

#### Note

* Pathfinder isn't supported when configuring Broker VMs in high availability (HA) clusters.

#### Important

* The Broker VM Pathfinder applet is now deprecated. In tenants where the applet was implemented, it will remain operational until January 25, 2026. In all other tenants, the applet is unavailable and cannot be used as of July 20, 2025. To ensure complete coverage and protection, we recommend deploying XDR Agents on all endpoints by this date. Migration...

* The Pathfinder applet isn't supported when configuring Broker VMs in high availability (HA) clusters.

  21.1.2.2.11. Activate Registry Scanner

#### Prerequisite

* To initialize registry scanning on your Broker VM, you must first add the necessary data connectors. For details, see Connect Docker V2-compliant container registry and Connect JFrog container registry When sizing your Broker VM, consider the following recommendations:    Disk Size: Calculate the required disk space by multiplying the average container...

#### Note

* FedRAMP is currently not supported for this applet. You cannot activate the Registry Scanner directly on a new or existing Broker VM. You can only activate or deactivate existing Registry Scanner applets. To activate or deactivate existing applets, see Step 4 under Verify Registry Scanner connection section.

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  21.1.2.2.12. Activate Syslog Collector

#### License Type

  Requires the Data Collection add-on.

#### Prerequisite

* Set up and configure Broker VM

#### Note

* Once configured, you cannot change the Port/PROTOCOL. If you don't want to use a data source, ensure to remove the data source from the list as explained in Task 5.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. For a Log Format set to CEF or LEEF, Cortex Cloud reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex Cloud uses these values even if you specified a value in the Vendor and...

* The server certificate and private key pair is expected in a PEM format. Cortex Cloud will notify you when your certificates are about to expire.

* Because some port numbers are reserved by Cortex Cloud , you must choose a port number that is not: In the range of 0-1024 (except for 514) In the range of 63000-65000 Values of 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672

* CORELIGHT is not available for a UDP protocol.

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  21.1.2.2.13. Activate Transporter

#### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator) Set up and configure Broker VMSet up and configure Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex Cloud resources. The IP addresses...

#### Warning

* The Transporter applet is not supported for FedRAMP customers.

#### Navigation

  Settings → Configurations → Broker VMs (under Data Broker

  the Brokers tab → locate your Broker VM → hover and click + Add under the Apps column → AppSec Transporter

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

  21.1.2.2.14. Activate Windows Event Collector

#### License Type

  Requires the Data Collection add-on.

#### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

#### Note

* You can also activate the Windows Event Collector on Windows Core. For more information, see Activate Windows Event Collector on Windows Core.

* By default, Cortex Cloud collects Palo Alto Networks predefined Security events that are used by the Cortex Cloud detectors. Removing the Security collector interferes with the Cortex Cloud detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

  21.1.2.2.14.1. Activate Windows Event Collector on Windows Core

#### License Type

  Requires the Data Collection add-on.

#### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

#### Note

* By default, Cortex Cloud collects Palo Alto Networks predefined Security events that are used by the Cortex Cloud detectors. Removing the Security collector interferes with the Cortex Cloud detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

  21.1.2.2.14.2. Renew WEC certificates

#### License Type

  Requires the Data Collection add-on.

#### Note

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* You can see more than one ca.wec.paloaltonetworks.com and forwarder.wec.paloaltonetworks.com file from a previous installation in the directory, so select the file with the most extended Expiration Date. You can verify that you are using the correct certificate: To verify the client certificate in the Personal → Certificates folder is related to the...

* Only perform this step under the following conditions: You have completed the WEF certification renewal process for ALL clients in your environment. Otherwise, events from the WEFs that you did not install the new client certificate will not be collected by the WEC. You are approaching the WEC server CA certificate expiration date, which is 2 years...

* If this query does not display results with a timestamp from after the renewal process, it could indicate that the renewal process is not complete, so wait a few minutes before running another query. If you are still having a problem, contact Technical Support.

#### Important

* After you receive a notification for renewing your WEC CA certificate, we recommend that you do not add any new WEF clients until the WEC certification renewal process is complete. Events from these WEF clients that are added afterwards will not be collected by the server until the WEC certificates are renewed.

  21.1.3. Manage Broker VM

#### Note

* For more information on troubleshooting errors and warnings for these broker applets, see Troubleshoot Broker VM applet errors.

* Certain fields are also exposed in the Clusters tab, when a Broker VM node is added to a High Availability (HA) cluster, and each cluster node is expanded to view the Broker VM nodes table. An asterisk (*) is beside every field that is also included in the Broker VM nodes table for each HA cluster.

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  21.1.3.1. Edit Broker VM Configuration

#### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and lower, Cortex Cloud accepts only 172.17.0.0/16.

* Make sure you save the password before closing the window. The only way to re-generate a password is to disable ssh and re-enable.

  21.1.3.2. Increase Broker VM storage allocated for data caching

#### Note

* Follow your hypervisor documentation to understand how to add a persistent disk storage to your VM.

* If your disk is not listed and you didn't shutdown your Broker VM in your hypervisor before manually adding a disk to the VM, you'll need to reboot the Broker VM before the disk details are detected by the Broker VM. This can be performed either in the hypervisor or directly in the Broker VMs page.

#### Warning

* This operation is irreversible, and will make the disk become an integral part of the broker, where disconnecting the disk will result in errors and data loss.

  21.1.3.3. Monitor Broker VM using Prometheus

#### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* For more information on Docker, see the Docker website.

  21.1.3.4. Collect Broker VM Logs

#### Note

* The Download Logs (<TIMESTAMP>) is only displayed when you've downloaded your logs previously using Generate New Logs.

  21.1.3.5. Upgrade Broker VM

#### Important

* After a Broker VM upgrade, your broker may require a reboot to finish installing important updates. A notification about this will be sent to your Cortex Cloud console Notification Center.

  21.1.3.6. Import Broker VM Configuration

#### Important

* This option can only be used on Broker VMs with version 20.0 and later, and is only suitable for importing a configuration of brokers in the same version, or from a broker in an older version to a broker in a newer version.

* If your source Broker VM configuration includes a WEC applet, you'll need to ensure that you update the DNS record of this Broker VM's FQDN to point to the target Broker VM IP address.

  21.1.3.7. Open Live Terminal

#### Note

* You can either restart_routes or reboot the Broker VM for the changes in the /etc/network/routes file to take affect.

  21.1.3.8. Add Broker VM to cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  21.1.3.9. Switchover Primary Node in Cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  21.1.3.10. Remove from Cluster

#### Note

* If you've enabled a Load Balancer Health-Check on the cluster, you need to exclude this Broker VM from your Load Balancer settings.

  21.1.4. Manage Broker VM data collector applets

#### Note

* For more information on the Broker VM applet connectivity status, see Manage Broker VM.

  21.1.5. Broker VM High Availability Cluster

#### Note

* For Load Balancing, you must install a Load Balancer in your network which will distribute the incoming data between the nodes.

* The Pathfinder applet isn't supported when configuring Broker VMs in HA clusters.

  21.1.5.1. Configure High Availability Cluster

#### Prerequisite

* Be sure you do the following tasks before creating a cluster from an existing Broker VM: Since the Pathfinder applet isn't supported when configuring HA clusters, you must ensure Pathfinder is deactivated on the Broker VM. If the Broker VM is explicitly specified in some Agent Settings profile, which mean Cortex Cloud agents retrieve release upgrades...

#### Important

* You can only create a new cluster from an existing Broker VM, when the Broker VM version is 19.0 and later, and the STATUS is Connected. The Create a Cluster from this Broker option is only listed if the Broker VM is not already added to a cluster.

* When the Protocol is set to HTTPS, you may need to perform a few follow-up steps to establish a validated secure SSL connection with the Broker VM. If you're using your own Certificate Authority (CA) to sign the certificates, you'll need to place the CA in the client, such as the Load Balancer, and upload the certificates to the Broker VM. If you're...

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  21.1.5.2. Manage Broker VM clusters

#### Navigation

  After you've configured a cluster, you can manage all your Broker VM clusters from the Clusters tab on the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs → Clusters

  21.1.5.2.1. View cluster details

#### Note

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

#### Navigation

  The Clusters tab of the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs) enables you

  21.1.5.2.2. Edit cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs, and select the Clusters tab

  21.1.5.2.3. Add applet to cluster

#### Note

* With Cortex XDR Prevent, it's only relevant to configure a HA cluster with a Local Agent Settings applet as this is the only applet supported for this product license. The other applets are collector applets, which are only available in Cortex XDR Pro or Cortex XSIAM.

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

  21.1.5.2.4. Add Broker VM to cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  21.1.5.2.5. Remove cluster

#### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  21.1.6. Broker VM notifications

  21.1.7. Monitor Broker VM activity

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  21.1.8. Troubleshoot Broker VM applet errors

  21.2. XDR Collectors

#### Note

* Ingestion of log events larger than 5 MB is not supported.

  21.2.1. XDR Collector audit logs

#### License Type

  Requires the Data Collection add-on.

  21.2.2. XDR Collector machine requirements and supported operating systems

#### License Type

  Requires the Data Collection add-on.

  21.2.3. Resources required to enable access to XDR Collectors

#### License Type

  Requires the Data Collection add-on.

#### Note

* Some of the IP addresses required for access are registered in the United States. As a result, some GeoIP databases do not correctly pinpoint the location in which IP addresses are used. All customer data is stored in your deployment region, regardless of the IP address registration and restricts data transmission through any infrastructure to that...

* Throughout this topic, refers to the chosen subdomain of your Cortex Cloud tenant and <region> is the region in which your Strata Logging Service is deployed.

  21.2.4. Manage XDR Collectors

#### License Type

  Requires the Data Collection add-on.

  21.2.4.1. XDR Collectors installation resource for Windows and Linux

#### License Type

  Requires the Data Collection add-on.

#### Note

* In some circumstances, such as after an XDR Collectors upgrade, the configured settings in the XML configuration file can be erased. Yet, this won't affect the saved settings in the XDR Collectors database.

  21.2.4.2. Create an XDR Collector installation package

#### License Type

  Requires the Data Collection add-on.

#### Note

* To move existing XDR Collectors between Cortex Cloud managing servers, you need to first Uninstall the XDR Collector from the collector machine and then for the new XDR Collector create a new installation package.

* Since Cortex Cloud relies on the installation package ID to approve XDR Collector registration during install, it is not recommended to delete the installation package for any active on-premise collector machines. Hiding the installation package will remove it from the default list of available installation packages, and can be useful to eliminate...

  21.2.4.3. Install the XDR Collector installation package for Windows

#### License Type

  Requires the Data Collection add-on.

  21.2.4.3.1. Install the XDR Collector on Windows using the MSI

#### Note

* When the package is executed using the MSI, an installation log is generated in %TEMP%\MSI<Random characters>.log by default.

* If the XDR Collector does not connect to Cortex Cloud, verify your internet connection on the collector machine. If the XDR Collector still does not connect, verify that the installation package has not been removed from the Cortex Cloud tenant.

  21.2.4.3.2. Install the XDR Collector on Windows using Msiexec

  21.2.4.4. Install the XDR Collector installation package for Linux

#### License Type

  Requires the Data Collection add-on.

#### Note

* We recommend that you perform a Linux RPM or Linux DEB installation.

* If the XDR Collector does not connect to Cortex Cloud, verify your Internet connection on the collector machine. If the XDR Collector still does not connect, verify the installation package has not been removed from the Cortex Cloud management console.

* The XDR Collector does not support proxy communication in environments where proxy authentication is required.

#### Important

* When performing a XDR Collector installation or upgrade in Linux using a shell installer, the  /tmp folder cannot be marked as noexec. Otherwise, the installation or upgrade fails. As a workaround, before the installation or upgrade, use the following command:

  21.2.4.5. Configure the XDR Collector upgrade scheduler

#### License Type

  Requires the Data Collection add-on.

#### Navigation

  In Cortex Cloud, select Settings → Configurations → XDR Collectors → Configuration

  21.2.4.6. Set an application proxy for XDR Collectors

#### License Type

  Requires the Data Collection add-on.

#### Navigation

  In Cortex Cloud, select Settings → Configurations → XDR Collectors → Administration

  21.2.4.7. Set an alias for an XDR Collector machine

#### License Type

  Requires the Data Collection add-on.

#### Navigation

  Settings → Configurations → XDR Collectors → Administration

  21.2.4.8. Upgrade XDR Collectors

#### License Type

  Requires the Data Collection add-on.

#### Note

* The XDR Collector keeps the name of the original installation package after every upgrade.

  21.2.4.9. Uninstall the XDR Collector

#### License Type

  Requires the Data Collection add-on.

#### Navigation

  Settings → Configurations → XDR Collectors → Administration

  Investigation & Response → Response → Action Center

  21.2.5. Define XDR Collector machine groups

#### License Type

  Requires the Data Collection add-on.

#### Note

* XDR Collectors only support IPv4 addresses.

* Disconnecting Directory Sync in your Cortex Cloud deployment can affect existing collector machine groups and policy rules based on Active Directory properties.

  21.2.6. About Cortex XDR Collector content updates

#### License Type

  Requires the Data Collection add-on.

  21.2.7. XDR Collector profiles

#### License Type

  Requires the Data Collection add-on.

  21.2.7.1. Add an XDR Collector profile for Windows

#### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex Cloud collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex Cloud supports logs in single line format or multiline format. For more...

  21.2.7.1.1. Ingest logs from Windows DHCP using Elasticsearch Filebeat

#### Note

* Although this enrichment is available when configuring a Windows DHCP collector for a cloud data collection integration, we recommend configuring Cortex Cloud to receive Windows DHCP logs with an XDR Collector Windows Filebeat profile, because it is simpler to set up.

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the template provided by Cortex Cloud to make your customizations. We recommend that you edit the file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating your...

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the example file provided by Cortex Cloud to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your filebeat.yml file. Validate the syntax of the YML file before you finish creating...

* The tokenizer definition is dependent on the Windows server version that you are using, because the log format differs. For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%...

  21.2.7.1.2. Ingest Windows DNS debug logs using Elasticsearch Filebeat

#### Note

* Detailed logs are significantly larger, because more information is added to the logs.

* To avoid formatting issues in your filebeat.yml file, we recommend that you validate the syntax of the file.

  21.2.7.2. Add an XDR Collector profile for Linux

#### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex Cloud collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex Cloud supports logs in single line format or multiline format. For more...

  21.2.8. Apply profiles to collection machine policies

#### License Type

  Requires the Data Collection add-on.

#### Navigation

  Settings → Configurations → XDR Collectors → Policies → +Add Policy

  21.2.9. XDR Collector datasets

#### License Type

  Requires the Data Collection add-on.

  21.3. Data Ingestion

#### License Type

  Requires the Data Ingestion add-on

  21.3.1. Visibility of logs and issues from external sources

#### License Type

  Data collection may require an add-on.

#### Note

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs.

* Logs with sessionid = 0 are dropped.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. IOCs and BIOCs are only generated for these event types: sso and session_start.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. Analytics, IOCs and BIOCs are only generated on the Firewall data. The Zscaler Nanolog Streaming Service (NSS) feed for web logs is only used for Correlation Rules and threat hunting.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. The Zscaler Nanolog Streaming Service (NSS) feed for web logs is only used for Correlation Rules and threat hunting.

  21.3.2. Visibility of Cortex Cloud audit and authentication logs

#### Note

* Cortex Cloud can create Cortex Cloud issues (Analytics, IOC, BIOC, and Correlation Rules) when relevant from logs.

  21.3.3. External data ingestion vendor support

#### License Type

  Data collection may require an add-on.

  21.3.4. Manage instances

  21.3.4.1. How to configure the scanning settings for supported services

#### Note

* All the asset types are selected by default. When you deselect a data asset type, it is not included when the system runs the next scan operation, reducing the total scan time.

  21.3.4.2. Manage cloud instances

#### Note

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  21.3.4.3. Update cloud permissions after Cortex release updates

#### Prerequisite

* Ensure that the user account used to modify permissions has the necessary privileges within both the Cortex platform and your cloud environment, for example, AWS or Azure. You received a notification regarding a new version available that requires permission updates, or viewed a Needs Update status in the Data Sources page.

#### Note

* Instances requiring updates will not change their connection status, for example, Connected, Warning, Error, Disabled, due to the pending permission update.

  21.3.4.4. Pending cloud instances

  21.3.4.5. Manage Kubernetes Connector instances

  21.3.5. Palo Alto Networks integrations

#### License Type

  Data collection may require an add-on.

#### Note

* Roll-back of Strata Logging Service integration migration is not supported.

  21.3.5.1. About Palo Alto Networks integrations

#### Note

* For Palo Alto Networks Integrations there is an option to turn on or off the collection of URL and File log types. For more information, see Collecting URL and File log types.

* Roll-back of Strata Logging Service integration migration is not supported.

  21.3.5.2. Ingest data from Next-Generation Firewall

#### Prerequisite

* Ensure that you have completed the following on the NGFW or Panorama side: For Panorama only, ensure that the Panorama Cloud Services plugin is installed. Enable log forwarding profiles on firewall rules. Configuration of data ingestion from multiple accounts requires Super User permissions on both the Cortex Cloud tenant and on the device accounts.

#### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* If your firewalls are located in a different region, or bandwidth issues are encountered due to large log size, you can ingest NGFW logs in CEF format, using the Syslog collector. However, the Syslog solution is not as powerful nor as comprehensive as this data collector, and should only be used when this data collector cannot be used. For more...

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version.

* Cortex Cloud does not validate your firewall credentials, you must ensure the certificates or PSK details have been updated in your firewalls in order for data to stream.

* It might take an hour or longer after connecting the firewall in Cortex Cloud until you start seeing notifications that the certificate has been approved, and that the logging service license has appeared on the firewall.

* IOC and BIOC issues are applicable on stitched data only, and are not available on raw data.

#### Tip

* You can see an overview of ingestion status for all log types, and a breakdown of each log type and its daily consumption quota on the NGFW Ingestion Dashboard.

  21.3.5.2.1. Ingest Next-Generation Firewall logs using the Syslog collector

#### Note

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version, to ensure that you have configured log forwarding correctly for all the log types that you would like to forward to Cortex Cloud. The following steps only cover...

* To avoid the possible effects of line formatting, do not copy/paste the message formats directly into the PAN-OS web interface. Instead, paste into a text editor, remove any carriage return or line feed characters, and then copy and paste into the web interface.

* From version 10.0 and later, the log format documented for log types (Traffic, Threat, and URL) exceeds the maximum supported 2048 characters in the Custom Log Format tab on the firewall and Panorama. Select the CEF keys and values to limit the number of characters to 2048, as per your requirements.

  21.3.5.3. Ingest data from Prisma Access

#### Prerequisite

* Configuration of data ingestion from multiple accounts requires Super User permissions in both Cortex Cloud tenant and Prisma Access accounts.

#### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* Cortex Cloud does not validate your Prisma Access account credentials. You must ensure the account has been deployed in order for data to stream.

  21.3.5.4. Ingest logs from Prisma Access Browser

  21.3.5.5. Ingest detection data from Strata Logging Service

#### Note

* IOC and BIOC issues are applicable on stitched data only and are not available on raw data.

  21.3.5.6. Ingest alerts and assets from IoT Security

  21.3.5.7. Collecting URL and File log types

  21.3.5.7.1. Detectors connected to URL and File log types

  21.3.6. External data ingestion

  21.3.6.1. External applications

  21.3.6.2. Ingest network connection logs

  21.3.6.2.1. Ingest network Route 53 logs from Amazon S3

#### Note

* For more information on configuring data collection from Amazon S3 for Route 53 DNS logs, see the AWS Documentation.

* For more information on creating a Stack, see Creating a stack on the AWS CloudFormation console.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex Cloud.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex Cloud.

  21.3.6.2.2. Ingest logs from Check Point firewalls

#### Note

* Logs with sessionid = 0 are dropped. Destination Port data is available only in the raw logs.

  21.3.6.2.3. Ingest logs from Cisco ASA firewalls and AnyConnect

  21.3.6.2.4. Ingest logs from Corelight Zeek

  21.3.6.2.5. Ingest logs from Fortinet Fortigate firewalls

  21.3.6.2.6. Ingest logs from Microsoft Azure Event Hub

#### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex Cloud, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

#### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex Cloud reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex Cloud uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

#### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  21.3.6.2.7. Ingest logs and data from Okta

  21.3.6.2.8. Ingest logs from Zscaler Internet Access

  21.3.6.2.9. Ingest logs from Zscaler Private Access

#### Note

* For more information on configuring the parameters on the screen, see the Zscaler Private Access (ZPA) documentation for Configuring a Log Receiver.

* You can only configure a ZPA log receiver to collect one type of log with your Syslog Collector in Cortex Cloud. To configure more that one log type, you'll need to add another log receiver.

  21.3.6.3. Ingest authentication logs and data

  21.3.6.3.1. Ingest audit logs from AWS Cloud Trail

#### Note

* For more information on configuring data collection from Amazon S3 using AWS CloudTrail, see the AWS CloudTrail Documentation.

* For more information on creating an AWS CloudTrail trail, see Create a trail. If you already have an Amazon S3 bucket configured with AWS CloudTrail audit logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* It is your organization's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* The CloudWatch Logs - optional settings are not supported and should be left disabled.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It your organization's responsibility to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex Cloud.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex Cloud.

  21.3.6.3.2. Ingest logs and data from Google Workspace

#### Note

* For all types of data collected via the Admin Reports API, except alerts and emails, the log events are collected with a preset lag time as reported by Google Workspace. For more information on these lag times for the different types of data, see Google Workspace Data retention and lag times.

* Spam emails from the compliance email account, and from all other monitored email accounts, are not collected. Any draft emails written in the compliance email account are collected by the Google Workspace data collector, and are then deleted even if the email was never sent.

* For more information on the entire process, see Perform Google Workspace Domain-Wide Delegation of Authority.

* When collecting Google Workspace alerts with other types of data, except emails, you need to configure a service account in Google with the applicable permissions to collect events from the Google Reports API and alerts from the Alert Center API. If you prefer to use different service accounts to collect events and alerts separately, you'll need to...

* For more information on the Admin Reports API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information on the Gmail API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information about the events collected from the various Google Reports, see Google Workspace Reports API Documentation.

  21.3.6.3.3. Ingest logs from Microsoft Azure Event Hub

#### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex Cloud, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

#### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex Cloud reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex Cloud uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

#### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  21.3.6.3.4. Ingest logs from Microsoft Office 365

#### License Type

  Requires the ITDR Module add-on. Requires the Data Collection add-on for viewing alerts and Azure AD Activity Logs.

#### Note

* Ingesting Microsoft Entra ID (formerly known as Azure AD) authentication and audit events from Microsoft Graph API requires a Microsoft Azure Premium 1 or Premium 2 license. Alternatively, if the directory type is Azure AD B2C, the sign-in reports are accessible through the API without any additional license requirement. To ingest email logs and data...

* When auditing is turned off from the default setting, you need to first turn on auditing for your organization to collect Microsoft Office 365 audit events from the Management Activity API. Log duplication of up to 5% in Microsoft products is considered normal. In some cases, such as login to a portal using MFA, two log entries are recorded by design.

* To address Azure reporting latency, there is a 10-minute latency period for Cortex Cloud to receive Azure AD logs.

* For more information, see the Office 365 Management Activity API schema.

* In FedRAMP environments, Azure sign-in logs are not supported, due to vendor technical constraints.

* Use this option when you don't want to grant permissions for Azure AD Authentication and Azure AD Audit.

  21.3.6.3.5. Ingest logs and data from Okta

  21.3.6.3.6. Ingest logs and data from OneLogin

#### Note

* Event data is collected every 30 seconds.

* Inventory data snapshots are collected every 10 minutes.

  21.3.6.3.7. Ingest authentication logs from PingFederate

  21.3.6.3.8. Ingest authentication logs and data from PingOne

#### Navigation

  Reporting → Subscriptions → Add Subscription

  21.3.6.4. Ingest operation and system logs from cloud providers

  21.3.6.4.1. Ingest generic logs from Amazon S3

#### License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

#### Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* You need to set up an Amazon S3 data collector to receive generic logs when collecting logs from BeyondTrust Privilege Management Cloud. For more information, see Ingest logs from BeyondTrust Privilege Management Cloud.

* It is the customer's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It is the responsibility of your organization to ensure that the user who performs this task of creating the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex Cloud.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex Cloud.

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex Cloud reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex Cloud uses these values even if you specified a value in the Vendor...

  21.3.6.4.2. Ingest logs and data from a GCP Pub/Sub

#### License Type

  Requires the Cloud Runtime add-on.

#### Note

* When collecting flow logs, we recommend that you include GKE annotations in your logs, which enable you to view the names of the containers that communicated with each other. GKE annotations are only included in logs if appended manually using the custom metadata configuration in GCP. For more information, see VPC Flow Logs Overview. In addition, to...

* For a Log Format set to CEF or LEEF, Cortex Cloud reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex Cloud uses these values even if you specified a value in the Vendor and Product fields in the GCP data collector settings. Yet, when the values are blank in the...

  21.3.6.4.3. Ingest logs from Google Kubernetes Engine

#### Note

* Cortex Cloud supports logs in single line format or multiline format. For more information on handling messages that span multiple lines of text in Elasticsearch Filebeat, see Manage Multiline Messages.

  21.3.6.4.4. Ingest logs from Microsoft Azure Event Hub

#### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex Cloud, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

#### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex Cloud reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex Cloud uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

#### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  21.3.6.4.5. Ingest logs and data from Okta

  21.3.6.5. Ingest cloud assets

#### Note

* The cloud accounts being onboarded must be owned by the customer performing the onboarding process.

  21.3.6.5.1. Onboard Amazon Web Services

#### Prerequisite

* Before you begin, ensure you have: Access to AWS Management Console Required AWS permissions

#### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* When onboarding an AWS organization or organizational unit (OU), Cortex Cloud creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

* See the prerequisites above for specific permissions required for serverless functions.

* If you select Automated, you must already be logged in to AWS.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only edit the instance from the Data Sources page. (AWS only) instances that were previously created in the Automation...

  21.3.6.5.1.1. Manually upload template to AWS

#### Prerequisite

* Before you begin, ensure you have: An AWS account Access to AWS Management Console Permission to create a stack and its resources in AWS CloudFormation

  21.3.6.5.2. Onboard Google Cloud Platform

#### Prerequisite

* Before you begin, ensure you have: Access to Google Cloud Console Admin user with required admin GCP permissions Enabled the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled) Enabled the following APIs in the GCP project you are...

#### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only modify the instance from the Data Sources page.

  21.3.6.5.2.1. Manually upload template to GCP

#### Prerequisite

* Before you begin, ensure you have: A GCP account. Permission to create the required resources in Google Cloud Deployment Manager. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool.

#### Note

* The directory you create must be a subdirectory of the home directory.

  21.3.6.5.3. Onboard Microsoft Azure

#### Prerequisite

* Before you begin, ensure you have: An Azure subscription Admin permissions required to onboard Azure or the built-in Security Administrator role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups.

#### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only modify the instance from the Data Sources page.

  21.3.6.5.3.1. Manually upload template to Microsoft Azure

#### Prerequisite

* Before you begin, ensure you have: An Azure subscription. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the Azure CLI...

  21.3.6.5.3.2. Manually upload template to Microsoft Azure Resource Manager using the CLI

#### Prerequisite

* Ensure the Azure CLI tool is installed and you are authorized to create management group policies.

  21.3.6.5.4. Onboard Oracle Cloud Infrastructure

#### Prerequisite

* Before you begin, ensure you have: Access to Oracle Cloud Infrastructure console Permissions for all of the following are required:    Creation of identity groups (for more information, refer to Managing Groups)   Policies (for more information, refer to How Policies Work)   Tag namespaces in the root compartment (for more information, refer to Tags...

#### Note

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only; you can only modify the instance from the Data Sources page.

  21.3.6.5.4.1. Manually upload template to OCI

#### Prerequisite

* Before you begin, ensure you have: An Oracle Cloud Infrastructure account and the tenancy OCID. Permission to deploy a custom template and create its resources in OCI. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed...

  21.3.6.5.5. Cloud service provider permissions

  21.3.6.5.5.1. Amazon Web Services provider permissions

  21.3.6.5.5.2. Google Cloud Platform provider permissions

  21.3.6.5.5.3. Microsoft Azure provider permissions

  21.3.6.5.5.4. Oracle Cloud Infrastructure provider permissions

  21.3.6.5.6. Outposts

#### Prerequisite

* Before you begin, ensure you have: An AWS account Permission to create a stack and its resources in AWS Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the AWS CLI tool and configured your profile with the aws...

* Before you begin, ensure you have: A GCP account Permission to create the required resources in Google Cloud Deployment Manager Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool

* Before you begin, ensure you have: An active Azure subscription. Installed the Azure CLI tool. Permission to deploy a custom template and create its resources in Microsoft Azure ("Owner" or "Contributor" on the designated outpost subscription scope, and Active Directory "Cloud Application Administrator" or "Application Administrator" privileged...

#### Note

* We recommend you use a dedicated account for the outpost, free from other resources. You can only onboard one outpost for each account.

* When creating an outpost for a specific Azure subscription, the outpost account must be in the same Azure organization as the monitored subscriptions.

#### Navigation

  Settings → Data Collection → Outposts

  You can create a new outpost by navigating to Settings → Data Collection → Outposts and clicking New Outpost

  21.3.6.5.7. Container Registry Scanning

  21.3.6.5.7.1. Overview of container registry scanning

  21.3.6.5.7.2. Configure registry scanning

#### Prerequisite

* Ensure that you have performed the all steps till Additional Security Capabilities as listed in the onboarding wizard for the required CSP: Onboard Amazon Web Services Onboard Google Cloud Platform Onboard Microsoft Azure

  21.3.6.5.7.3. Modify the container registry scanning scope

  21.3.6.5.7.4. Scan re-evaluation process

  21.3.6.5.7.5. Connect Docker V2 compliant container registry

#### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

#### Note

* Scanning is supported only for private repositories on Docker Hub.

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* FedRAMP is not supported for this mode.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  21.3.6.5.7.6. Connect JFrog container registry

#### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

#### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  21.3.6.5.8. Configure AWS integration instances and monitor integration instance health

#### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  21.3.6.6. Ingest data for API security

  21.3.6.6.1. Ingest AWS API Gateway

#### Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

#### Important

* Leave '–'filter-pattern empty as displayed above.

  21.3.6.6.2. Ingest Azure APIM

#### License Type

  Requires the Data Collection add-on.

#### Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

#### Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

  21.3.6.6.3. Ingest Apigee Proxy

#### License Type

  Requires the Data Collection add-on.

#### Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

#### Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

  21.3.6.6.4. Ingest Kong

#### License Type

  Requires the Data Collection add-on.

#### Note

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

#### Important

* The size of the buffer must be equal to or larger than the max body size setting in the plugin configuration, on every data plane node.

  21.3.6.7. Additional log ingestion methods

  21.3.6.7.1. Ingest logs from a Syslog receiver

  21.3.6.7.2. Ingest Apache Kafka events as datasets

  21.3.6.7.3. Ingest CSV files as datasets

  21.3.6.7.4. Ingest database data as datasets

  21.3.6.7.5. Ingest logs in a network share as datasets

#### Note

* The Files and Folders Collector applet only starts to collect files that are more than 256 bytes.

  21.3.6.7.6. Ingest FTP files as datasets

  21.3.6.7.7. Ingest NetFlow flow records as datasets

  21.3.6.7.8. Set up an HTTP log collector to receive logs

#### Note

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex Cloud reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex Cloud uses these values even if you specified a value in the Vendor...

* Each record cannot exceed 5 MB in size.

  21.3.6.7.9. Ingest logs from BeyondTrust Privilege Management Cloud

#### Note

* For a Log Format set to Beyondtrust Cloud ECS, the following fields are automatically set and not configurable. Vendor: Beyondtrust Product: Privilege Management Compression: Uncompressed

  21.3.6.7.10. Ingest logs and data from Box

#### Prerequisite

* Set up an Enterprise Box plan.  Important To collect Box Shield Alerts, you must purchase Box Shield and it must be enabled on Box enterprise. Set up an Enterprise Box plan. Create a valid Box account that is assigned to a role with sufficient permissions for the data you want to collect. For example, create an account assigned to an Admin role to...

#### Note

* The Fetch Intervals are non-configurable.

* Collecting Box Shield Alerts requires implementing Box Shield,

* There is a current bug with the Groups API from Box. If you don't configure the Box app with the proper permissions for managing groups data, the Groups API from Box won't return an error message to Cortex Cloud indicating that the API failed to receive the data, and the Groups data will not be collected.

* For any future change that you make to your Box app, ensure that you send the changes for approval to the administrator, who will need to approve them as explained above.

* Inventory data snapshots are collected every 10 minutes.

  21.3.6.7.11. Ingest logs and data from Dropbox

#### License Type

  Requires the ITDR Module add-on.

#### Prerequisite

* Set up an Advanced Dropbox plan. Create a Dropbox Business admin account with Security admin permissions, which is required to authorize Cortex Cloud to access the Dropbox Business account and generate the OAuth 2.0 access token.

#### Note

* The Fetch Interval is non-configurable.

* When the App Key field is empty, the here link in the tooltip is disabled. When an incorrect App Key is entered, clicking the link results in a 404 error.

* Whenever you change the permissions of the Dropbox app, we recommend that you generate a new Access Code for the Dropbox data collector instance so that the permissions match the updates.

* Event data is collected every 60 seconds with a 10 minute lag time.

* Inventory data snapshots are collected every 10 minutes.

  21.3.6.7.12. Ingest logs from Forcepoint DLP

  21.3.6.7.13. Ingest report data from Workday

#### Prerequisite

* Create an Integration System User that is designated to access the custom report from Workday for data collection in Cortex Cloud. Create an Integration System Security Group for the Integration System User created in Step 1 for accessing the report. When setting this group ensure to define the following:    Type of Tenanted Security Group: Select...

#### Note

* Any user with permissions to view issues and cases can view the Workday data.

* For more information on completing any of the prerequisite steps, see the Workday documentation.

* The Business Object changes depending on the Data Source selected.

* Cortex Cloud uses a structured schema when integrating Workday data. To get the best Analytics results, specify all the fields marked with an asterisk from the recommended schema. workday_user_id* full_name* workday_manager_user_id* manager* worker_type* position_title* department* private_email_address* business_email_address* employment_start_date* em...

  21.3.7. Onboard the Kubernetes Connector

#### Note

* For GKE or EKS clusters with the metadata service disabled and for AKS clusters with non-default nodes managed resource group, the cluster resource identifier must be specified.

  21.3.7.1. What's new in Kubernetes Connector?

  21.3.8. Verify collector connectivity

#### Note

* For more information on troubleshooting data collector applet errors, see Troubleshoot Broker VM applet connectivity.

  21.3.9. Overview of data ingestion metrics

#### Prerequisite

* For Cortex Cloud to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics.Enable the Analytics Engine and Identity Analytics Data Ingestion...

  21.3.9.1. Creating correlation rules to monitor data ingestion health

  21.3.9.2. Measuring data freshness

#### Note

* The max_delay metric is taken from the maximum bucket value with a restricted limit; therefore, metrics show whole numbers. The median and ninetieth_percentile metrics are statistical calculations that give an approximation of the real value; therefore, metrics show decimal numbers. Time slots with a zero log count or zero byte count display records...

  21.3.10. About health issues

#### Prerequisite

* For Cortex Cloud to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics.Enable the Analytics Engine and Identity Analytics Data Ingestion...

#### Note

* The Health Issues page displays issues that were triggered after July 2024. To see health issues that were triggered before this date, click Legacy Health Issues.

* Cortex Cloud enforces the dedup logic to health issues. This logic reduces the likelihood of identical health issues from flooding the issues dataset.

  21.3.10.1. Investigate and resolve health issues

  21.3.10.2. Monitor data ingestion health

#### Prerequisite

* For Cortex Cloud to monitor data ingestion health and create health issues, you must enable Data Ingestion Monitoring in your Server Settings. For more information, see Set up your environment.

  21.3.10.3. Monitor correlation rules

#### Note

* In the dataset, the Query start time and Query end time indicate the timeframe of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

  21.4. Dataset management

#### License Type

  Managing Roles requires an Account Admin or Instance Administrator role. For more information, see Predefined user roles.

#### Note

* Cold storage, in addition to a cold storage license, requires compute units (CU) to run cold storage queries. For more information on CU, see Manage compute units.

* Only datasets that are already handled as part of the GB license are supported for this license. In addition, the retention configuration is only available in Cortex Cloud, as opposed to the public APIs.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default. Datasets include dataset permission enforcements in the Cortex Query Language(XQL), Query Center, and XQL Widgets. For example, to view or access any of the endpoints and host_inventory datasets, you need role-based access control (RBAC)...

* You'll only be able to save the dataset view if the query contains no errors; otherwise, the Save button is disabled.

* For more information on user roles, see Manage user roles.

#### Important

* Cortex Cloud enforces retention on all log-type datasets excluding Host Inventory, Vulnerability Assessment, Metrics, and Users.

* This column is updated once a day. Therefore, if the dataset was created or updated by the target or lookup flows, it's possible that the Last Updated value is a day behind when the queries or reports were run as it was before this column was updated.

  21.4.1. What are datasets?

#### Note

* For more information on tasks specific to lookup datasets, see Lookup datasets.

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

#### Important

* By default, forensic datasets are not included in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  21.4.2. Lookup datasets

#### Note

* A lookup dataset can only be deleted if there are no other dependencies. For example, if a Correlation Rule is based on a lookup dataset, you wouldn't be able to delete the lookup dataset until you removed the dataset from the XQL query of the Correlation Rule.

  21.4.2.1. Import a lookup dataset

#### Prerequisite

* When uploading a CSV, TSV, or JSON file, ensure that the file meets the following requirements: The maximum size for the total data to be imported into a lookup dataset is 30 MB from the Dataset Management page. Otherwise, the limit is 50 MB using Cortex Query Language (XQL) or APIs. Field names can contain characters from different languages, special...

#### Important

* The name of a dataset created from a TSV file must always include the extension. For example, if the original file name is mrkdptusrsnov23.tsv, you can save the dataset with the name marketing_dept_users_Nov_2023.tsv.

  21.4.2.2. Download JSON file of lookup dataset

#### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  21.4.2.3. Set time to live for lookup datasets

#### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  21.4.3. Monitor datasets and dataset views activity

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  21.5. Manage Event Forwarding

#### License Type

  This feature requires an Event Forwarding add-on license. Only Administrators have access to this screen.

#### Important

* Since data is aggregated and compressed, it can take up to two hours until the data is available in the forwarding bucket.

#### Navigation

  Under Settings → Configurations → Data Management → Event Forwarding, activate the licenses in the Activation section

  21.5.1. Endpoints Event Forwarding - included/excluded fields by event type

#### License Type

  This feature requires an Event Forwarding add-on license. Only Administrators have access to this screen.

  21.6. Manage compute units

#### Note

* For more information, see Import historical data into cold storage.Import historical data into cold storage

* The CU consumption of cold storage queries is based on the number of days in the query time frame. For example, when querying 1 hour of a specific day, the CU of querying this entire day is consumed. When querying 1 hour that extends past 2 days, such as from 23:50 to 00:50 of the following day, the CU of querying these two days is consumed.

  21.6.1. Compute units usage

#### Note

* To enable the add-on, select Settings  → Configurations → Cortex Cloud License → Addons tile, and select the Compute Unit tile and Enable.

#### Navigation

  Settings → Configurations → Data Management → Compute Unit Usage

22. Marketplace

  22.1. Cortex Marketplace

  22.2. Cortex Cloud content

  22.3. Manage content packs

#### Note

* Pre-installed core content packs are automatically upgraded.

* Optional content packs that are already installed are treated like they are required content packs to preserve content integrity.

* Third party product Integrations are developed and tested against a specific product version. For products which are on-prem or cloud based with specific API versions, the version developed and tested against will be included in the integration's documentation. Newer versions of the product are not always immediately tested and it is expected that...

#### Caution

* If you want to downgrade, any content that depends on the content pack including any customizations may be deleted if it does not exist in the target content pack version.

* If another content pack is dependent on the content pack you want to delete, it may break the other content pack. You can reinstall the content pack, but you cannot restore detached and customized content.

  22.4. Marketplace FAQs

23. Cortex CLI

#### Note

* The CLI Read Only Role is not supported for CWP as the system does not support offline mode.

  23.1. Connect Cortex CLI

#### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

#### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Cortex Cloud Application Security, refer to Cortex CLI usage for Cortex Cloud Application Security

#### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

  23.2. Cortex CLI common command line reference guide

#### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

  23.3. Cortex CLI for Cloud Workload Protection

#### Prerequisite

* Ensure you have the required user permissions. Refer to Cortex CLI for more information Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more information Verify that Java version 11 and above is installed: Run java -version in your terminal. If not, refer to Java SE Development Kit 11.0.25 for information about installing Java

* Before you begin, ensure you have sudo privileges to execute the image scan.

#### Note

* The output contains the number of created issues for malware, secrets, and vulnerabilities, organized by severity, based on the current policy configuration.

  23.3.1. Cloud Workload Protection command line reference

  23.4. Cortex CLI for API Security

#### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more information Ensure your application exposes APIs and provides a corresponding OpenAPI Specification file Ensure that you have installed Java v 11 and above

  23.4.1. Cortex CLI API Security command line reference guide

  23.5. Cortex CLI for Cortex Cloud Application Security

#### Prerequisite

* For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

  23.5.1. Cortex CLI usage for Cortex Cloud Application Security

  23.5.2. Cortex CLI Cortex Cloud Application Security command line reference

#### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

#### Important

* The Cortex CLI Cortex Cloud Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id...

  23.5.3. CLI pipeline code snippets

  23.6. Migrate Cortex CLI

#### Prerequisite

* Before you begin, ensure you have the following: Ensure you have an active API key for your Cortex Cloud tenant with associated CLI role permissions. Refer to Manage API keys for more information Install the Cortex CLI. You can find the installation instructions here

24. Cortex Cloud XQL

  24.1. Get started with XQL

  24.1.1. XQL language features

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

#### Navigation

  You submit XQL queries to Cortex Cloud using the Investigation & Response → Search → Query Builder user interface

  24.1.2. XQL Language Structure

#### Note

* Specifying a dataset is not required because Cortex Cloud uses xdr_data as the default dataset. If you have more than one dataset or lookup, you can change your default dataset by navigating to Settings → Configurations → Data Management → Dataset Management, right-click on the appropriate dataset, and select Set as default.

* You can also build a query that investigates data in both a cold dataset and hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide. For more information on hot and cold storage, see Dataset management.

  24.1.2.1. Adding comments in queries

  24.1.3. Supported operators

#### Note

* In some cases, using an IN or NOT IN operator combined with a dataset and filterfilter stage can be a better alternative to using a join stage.

  24.1.4. Datasets and presets

#### Note

* To set up this Cloud Identity Engine (previously called Directory Sync Service (DSS)) dataset, you need to set up a Cloud Identity Engine. Otherwise, you will not have a pan_dss_raw dataset. For more information, see Set up Cloud Identity Engine.Set up Cloud Identity Engine

* INFO issues are not included in this dataset. The issue fields included in this dataset are limited to certain fields available in the API. For the full list, see Get Alerts Multi-Events v2 API.

* The fields contained in this dataset are a subset of the fields in the xdr_data dataset.

* If the vendor and product are not specified in the Winlogbeat profile's configuration file, Cortex Cloud creates a default dataset called microsoft_windows_raw.

* To ensure GlobalProtect access authentication logs are sent to Cortex Cloud, verify that your PANW firewall's Log Settings for GlobalProtect has the Cortex Data Lake checkbox selected.

* You can query in XQL for this data and build widgets based on the xdr_data dataset or using the preset device_control. To view in an XQL query these events, the Device Configuration of the endpoint profile must be set to Block. Otherwise, the USB events are not captured. The events are also captured when a group of device types are blocked on the...

  24.1.5. About examples

#### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

  24.1.6. JSON functions

#### Important

* JSON field names are case sensitive, so the key to field pairing must be identical in an XQL query for results to be found. For example, if a field value is "TIMESTAMP" and your query is defined to look for "timestamp", no results will be found.

  24.1.7. How to filter for empty values in the results table

  24.1.8. Understanding string manipulation in XQL

  24.2. Build XQL queries

  24.2.1. About the Query Builder

#### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

  24.2.2. How to build XQL queries

#### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex Cloud. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

#### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  24.2.2.1. Get started with XQL queries

  24.2.2.2. Useful XQL user interface features

#### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

  24.2.2.3. XQL Query best practices

  24.2.2.4. Expected results when querying fields

  24.2.2.5. Create XQL query

#### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

#### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

  24.2.2.6. Review XQL query results

#### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* In order for Cortex Cloud to provide a histogram for a field, the field must not contain an array or a JSON object.

  24.2.2.7. Translate to XQL

#### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

  24.2.2.8. Graph query results

#### License Type

  Building Cortex Query Language (XQL) queries in the Query Builder requires a Data Collection add-on.

#### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

  24.2.3. XQL query entities

  24.2.3.1. Create authentication query

#### Navigation

  Investigation & Response → Search → Query Builder

  24.2.3.2. Create event log query

#### Navigation

  Investigation & Response → Search → Query Builder

  24.2.3.3. Create file query

#### Navigation

  Investigation & Response → Search → Query Builder

  24.2.3.4. Create image load query

#### Navigation

  Investigation & Response → Search → Query Builder

  24.2.3.5. Create network connections query

#### Navigation

  Investigation & Response → Search → Query Builder

  24.2.3.6. Create network query

#### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

  24.2.3.7. Create process query

#### Navigation

  Investigation & Response → Search → Query Builder

  24.2.3.8. Create registry query

#### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

  24.2.3.9. Query across all entities

#### Navigation

  Investigation & Response → Search → Query Builder

  24.2.4. Edit and run queries in Query Center

#### Navigation

  Investigation & Response → Search → Query Center

  24.2.4.1. Query Center reference information

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  24.2.5. Manage scheduled queries

#### Navigation

  Investigation & Response → Search → Scheduled Queries

  24.2.5.1. Scheduled Queries reference information

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  24.2.6. Manage your personal query library

#### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

  24.3. Stages

  24.4. Functions

25. Graph Search

  25.1. What is Graph Search?

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

#### Note

* Graph Search is a Beta feature and is still subject to changes. To enable the feature in your tenant, contact your Customer Support Team.

  25.2. Get started with Graph Search queries

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

#### Navigation

  Understand your assets and findings data: Graph Search queries are based on the current data that has been collected for assets and findings from the data sources configured and then sent to the Unified Asset Inventory (UAI), which is displayed in the All Assets page (Inventory → Assets → All Assets

  25.3. How to build Graph Search queries?

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

#### Navigation

  You submit Graph Search queries using the Investigation & Response → Search → Query Builder → Graph Search built-in query interface

  25.4. Understand Graph Search query results

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  25.5. Create Graph Search query

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

#### Note

* For more information about the Query Library, see Manage Graph Search Query Library.

#### Tip

* After running the query, you can view the complete query by hovering over the last THAT... in the Graph Search query interface, and the query is displayed in a tooltip. If your query doesn't find any results or you want to change your query for any reason, you can always click anywhere in the Graph Search query interface, where your existing query is...

  25.6. Graph Search examples

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  25.7. Manage Graph Search Query Library

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

#### Navigation

  From Graph Search in the Query Builder Select Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Center

  25.8. Edit and run queries in Query Center

#### Navigation

  Investigation & Response → Search → Query Center

  25.8.1. Query Center reference information

#### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  25.9. Supported assets and findings

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  25.10. FAQ on Beta Graph Search feature

#### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).


## Cortex XSIAM Documentation


---

## 1. Learn about Cortex XSIAM

### 1.1. Get started with Cortex XSIAM

#### 1.1.1. Cortex XSIAM architecture

##### Note

* You can host your Cortex Native Data Lake instance in either the United States (US) Region or the European Union (EU) Region.

* You can host your Directory Sync Service instance in either the US Region or EU Region.

### 1.2. Fair Usage policy for Cortex XSIAM

### 1.3. Cortex XSIAM product licenses

#### Note

* You can upgrade your license by purchasing add-ons or moving to a different XSIAM license.

#### 1.3.1. Data retention

#### 1.3.2. Data storage lifecycle

##### Tip

* You can view details about your Cortex XSIAM licenses by selecting Settings → Cortex XSIAM License.

#### 1.3.3. License allocation

##### Note

* It can take up to an hour for Cortex XSIAM to display revived endpoints.

#### 1.3.4. License expiration

#### 1.3.5. Upgrade your tenant

### 1.4. Security Operations Center roles and responsibilities

### 1.5. In-product support case creation

#### Note

* When opening a support case through the Customer Support Portal, you need to manually select Cortex XSIAM as the product. While there may be discrepancies between the categories in this wizard and the Customer Support Portal process, that's because this wizard is designed specifically to focus on options relevant to Cortex XSIAM.

* Selecting an endpoint from the endpoint table and retrieving TSF requires full Retrieve Endpoint Data permissions under Endpoint Administration.

* Console recordings cannot exceed 10 minutes. The current recording time is displayed at the top of the window.

### 1.6. Supported web browsers

### 1.7. Use the interface

#### Note

* Each SAML login session is valid for 8 hours. Some menu items only appear if you have the relevant license.

* CMD fields have a 128-character limit. Shorten longer query strings to 127 characters and add an asterisk (*).

* Deleting a shared view removes it for all users.

### 1.8. What is Cortex Gateway?

## 2. Onboard Cortex XSIAM

### 2.1. Deployment steps

#### 2.1.1. Plan and prepare

#### 2.1.2. Cortex XSIAM onboarding checklist

##### Prerequisite

* Cloud Identity Engine must be set up.

##### Note

* Data collection for Windows endpoints is available with Traps 6.0 and later releases and on endpoints running Windows 7 SP1 and later releases. Data collection on macOS and Linux endpoints are available with Traps 6.1 and later releases.

#### 2.1.3. Activate Cortex XSIAM

##### Prerequisite

* The Cortex XSIAM activation email. A Customer Support Portal (CSP) account. You need to set up your CSP account. For more information, see How to Create Your CSP User Account. When you create a CSP account, you can set up two-factor authentication (2FA) to log into the CSP by using an Email, Okta Verify, or Google Authenticator (non-FedRAMP accounts)....

##### Note

* When you activate, a production tenant is first activated. After activation, you can set up a development tenant (subject to your license).

* Activation can take about an hour and does not require you to remain on the activation page. Cortex XSIAM sends a notification to your email when the process is complete.

* If you want to change your tenant's name, the subdomain, or activate a development tenant (subject to license), on the right-hand side, click the ellipsis. You can only change the subdomain once, and it cannot be undone. After deleting the subdomain, you can reuse it after 7 days.

##### 2.1.3.1. Bring your own keys

###### Prerequisite

* Access to BYOK (Bring Your Own Keys) functionality is restricted to tenants that were initially activated with BYOK.

* To disable your encryption keys and deactivate a tenant, you must have an Account Admin role.

###### Note

* The new keys you import will serve as primary encryption keys for newly generated data.

* At any stage, you can select Continue Later to pause the process. To resume the process, in the Cortex gateway, select Continue Setup next to the tenant, and follow the wizard instructions from the point you left off, as detailed below. If you don't use either of your wrapping keys within three days, they expire and you'll have to restart the process.

* BYOK requires a 32-byte, symmetric, unencoded key in binary format.

###### Caution

* Disabling all encryption keys and deactivating the tenant renders the tenant inaccessible and non-operational. Disabling the keys affects the communication with the agents, may prevent the agents from receiving updates to policies, configurations, and crucial information, and may result in loss of data. To secure your tenant data and to prevent...

##### 2.1.3.2. Cortex XSIAM supported regions

##### 2.1.3.3. Enable access to required PANW resources

###### Note

* <tenant-name> refers to the selected subdomain of your Cortex XSIAM tenant, and <region> is the region in which your tenant is deployed. For more information, see Cortex XSIAM supported regions.

#### 2.1.4. Set up users and roles

##### Note

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* The user who activated the Cortex product is assigned the Account Admin role. You cannot create additional Account Admin roles in the Cortex XSIAM tenant. If you do not want the user to have Account Admin permission, you must remove the Account Admin role in Cortex Gateway.

##### 2.1.4.1. User group management

###### Note

* You can create user groups in the tenant or Cortex Gateway. User groups created in Cortex Gateway cannot be mapped to SAML groups. Only user groups created in the tenant support SAML group mapping and scoring. We recommend creating user groups in the Cortex tenant because: User groups are available for all tenants, and you may want different user...

* If users have been created in the CSP, but you want them to access the tenant through SSO only, skip this field and add only SAML group mapping after SSO is set up, otherwise, users can access the tenant through both the CSP and SSO. If you have not yet created any users, skip this field and add them later. See Set up authentication .

* When using Azure AD for SSO, the SAML group mapping needs to be provided using the group object ID (GUID) and not the group name.

###### Important

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

##### 2.1.4.2. Assign user roles and groups

###### Note

* If an existing user in the Cortex Gateway no longer has a role or a user group assigned, the user is revoked. Any roles, user groups, or egress configurations created by that user are shown as created by Revoked user instead of the user's email address.

###### Important

* Setting Cortex Query Language (XQL) dataset access permissions for a user role can only be performed from Cortex XSIAM Access Management. For more information, see Manage user roles.

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit Users Permissions.

#### 2.1.5. Set up authentication

##### Tip

* You should have at least one user in the Customer Support Portal for backup, in case of any authentication issues with your IdP provider.

##### 2.1.5.1. Authenticate users through the Customer Support Portal

###### Note

* You must be assigned the Super User role in the Customer Support Portal to add users in the Customer Support Portal. The first Super User who logs into Cortex Gateway is automatically assigned the Account Admin role and has access to the tenant. The user who activates the Cortex XSIAM tenant will also be assigned the Account Admin role (if there is no...

* After users are added to the Customer Support Portal and they accept the invitation, you can manage them in Cortex Gateway or the Cortex XSIAM tenant.

##### 2.1.5.2. Authenticate users using SSO

###### Note

* To set up SSO authentication in the tenant, you must be assigned an Instance Administrator or Account Admin role. SAML 2.0 users must log in to Cortex XSIAM using the FQDN (full URL) of the tenant. To allow login directly from the IdP to , you must set the relay state on the IdP to the FQDN of the tenant. If you have multiple tenants, you must set up...

* The first SSO cannot be deleted, it can only be deactivated by toggling SSO Enabled to off. The Domain parameter is predefined for the first SSO. If you add additional SSO providers, you must provide the email Domain in the SSO Integration settings for all providers except the first. Cortex XSIAM uses this domain to determine to which identity provider...

* Cortex XSIAM requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex XSIAM. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a...

##### 2.1.5.3. Set up Okta as the Identity Provider Using SAML 2.0

###### Note

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Navigation

  Settings → Configurations → Access Management → Authentication Settings

  Settings → Configurations → Access Management → User Groups

##### 2.1.5.4. Set up Azure AD as the Identity Provider Using SAML 2.0

###### Note

* The default attributes shown on the main single sign-on page in Azure AD are not the values you need. You must click Edit next to Attributes and Claims to view and copy the actual values.

* The attribute claim name must exactly match the value sent by your IdP. In some cases, this may be the full attribute name/namespace, depending on the configuration of our IdP

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Important

* When copying the Single Sign-On URL value, remove idp/saml and leave the trailing /. For example, if the Single Sign-On URL is https://clientname.panproduct.region.paloaltonetworks.com/idp/saml, just copy https://clientname.panproduct.region.paloaltonetworks.com/.

###### Navigation

  Settings → Configurations → Access Management → User Groups

#### 2.1.6. Pre-installation steps for Cortex XDR agents

##### 2.1.6.1. Define endpoint groups

###### Note

* Disconnecting Cloud Identity Engine in your Cortex XSIAM deployment can affect existing endpoint groups and policy rules based on Active Directory properties.

##### 2.1.6.2. Manage endpoint profiles

##### 2.1.6.3. Endpoint data collection

###### Note

* For specific files only and only if the file was written.

###### Important

* Registry key is collected as a real key name, and not as a symbolic link. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, KEY_LOCAL_MACHINE\System\ControlSet001 will be collected. Instead of HKEY_CURRENT_USER, HKEY_USERS\<SID> will be collected, where SID is a SID of the current user.

##### 2.1.6.4. Configure global agent settings

###### Note

* Disabling this capability takes immediate effect on new hashes, fresh agent installations, and existing security policies. It could take up to a week to take effect on existing agents in your environment pending agent caching.

* If you have any Cortex XSIAM filters, starring policies, exclusion policies, scoring rules, log forwarding queries, or automation rules configured for XSOAR/3rd party SIEM, we advise you to update those to support the changes before activating the feature. For example, change the query to include the previous description that is still available in the...

#### 2.1.7. Install Cortex XDR agents

##### 2.1.7.1. Plan your agent deployment

##### 2.1.7.2. Guidelines for keeping Cortex XDR agents and content updated

###### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups. See how to define endpoint group.

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups.

###### Important

* When planning Cortex XDR agent upgrades and content updates, consult with the appropriate stakeholders and teams and follow the change management strategy in your organization.

###### Caution

* Before enabling Auto-Update for Cortex XDR agents, make sure to consult with all relevant stakeholders in your organization.

##### 2.1.7.3. Create an agent installation package

###### Note

* The profile will be applied if the security policy cannot be retrieved in real-time.

* The Cortex serverless library must be imported after other libraries to activate the hooks that enable auditing.

##### 2.1.7.4. Deploy agent installation packages

#### 2.1.8. Configure and deploy Cortex XSIAM

##### 2.1.8.1. Cortex XSIAM - Analytics

###### Prerequisite

* Before Cortex XSIAM - Analytics can start to analyze your endpoint data, perform the following steps: Configure Cortex XSIAM network parameters to monitor your internal networks. Enable the Analytics Engine. Make sure Cloud Identity Engine is set up. Enable Identity Analytics.

###### 2.1.8.1.1. Configure Cortex XSIAM network parameters

####### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

####### Navigation

  Inventory → Assets → Network Configuration → Internal Domain Suffixes

###### 2.1.8.1.2. Enable the Analytics Engine and Identity Analytics

####### Prerequisite

* Analytics Engine To create a baseline for enabling analytics, Cortex XSIAM requires a minimum of one of the following data sets: EDR or Network logs from at least 30 endpoints over a minimum of 2 weeks Cloud audit logs over a minimum of 5 days Identity Analytics Cortex XSIAM - Analytics must be activated. Cloud Identity Engine must be set up. For more...

####### Navigation

  Settings → Configurations → Cortex XSIAM - Analytics

##### 2.1.8.2. Cortex XSIAM engines

###### 2.1.8.2.1. Engine requirements

####### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

###### 2.1.8.2.2. Install an engine

####### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex XSIAM engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

####### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

####### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

##### 2.1.8.3. Set up Cloud Identity Engine

###### Note

* The Activate risk signal sharing to CIE checkbox is available only after the second step is completed.

###### Navigation

  Settings → Configuration → Integrations → Cloud Identity Engine

#### 2.1.9. Define data sources

##### Note

* Not all content packs are available to download on the Data Sources page. If you require content packs such as Phishing, and Malware, you need to download the pack from Marketplace and configure the integration. The Data Sources page is designed for third-party integrations to help you onboard.

* For some vendors, to receive data from an external source, you must first set up the Syslog Collector applet on a Broker VM within your network. For more information, see Activate Syslog Collector.

##### 2.1.9.1. Cortex XSIAM content

###### 2.1.9.1.1. Cortex Marketplace

###### 2.1.9.1.2. Content packs

####### Note

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

###### 2.1.9.1.3. Install content packs

####### Note

* Currently, not all content packs are supported in the Data Sources page. For example, content packs with several integrations are not yet supported.

* Content packs are also automatically installed when you adopt playbooks and configure tasks.

###### 2.1.9.1.4. Automation and feed integrations

####### Note

* Some integrations can be downloaded directly without having to initially download a content pack from Marketplace. For more information, see Define data sources. In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as...

* If the integration was installed from a content pack, you need to duplicate the integration before editing.

* If the integration was installed from a content pack, you need to duplicate the integration before downloading.

* Integration commands are only available when the integration instance is enabled. Some commands depend on a successful connection between Cortex XSIAM and third-party integrations.

####### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

####### 2.1.9.1.4.1. Manage API keys

######## Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

* You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

####### 2.1.9.1.4.2. Fetch issues from an integration instance

######## Note

* In some integrations, the Issue Fetch interval is called Feed Fetch Interval. If the integration instance does not have the Issue Fetch Interval field, you need to add this field by editing the integration settings. If the integration is from a content pack, you need to create a copy of the integration. Any future updates to this integration will not...

* Some content packs include preconfigured correlation rules, but you should review them to see if they suit your use case and duplicate them if required. Go to Threat Management → Detection Rules → Correlations, search for the relevant rule, right-click, and select Preview Rule. For example, the ServiceNow v2 Alerts (automatically generated)...

####### 2.1.9.1.4.3. Forward Requests to Long-Running Integrations

######## Note

* This integration replaces the External Dynamic list integration, which is deprecated. For more information about how to set up the integration, see Manage external dynamic lists.

* When running on the tenant, you can only use long-running integrations provided by Cortex XSIAM, you cannot create custom ones. Custom long-running integrations are supported only on engines at this time. Configuring custom certificates or private API Keys in the long-running integration instance is supported only on engines, not on the Cortex XSIAM...

* For the TAXII Server and TAXII2 Server integrations, the xdr string is automatically replaced by crtx. For the Microsoft Teams integration, you can use the microsoft-teams-create-messaging-endpoint command to get the correct messaging endpoint based on the server URL, the server version, and the instance configurations. For more information, see...

####### 2.1.9.1.4.4. Manage credentials

######## Navigation

  Settings → Configurations → Integrations → Credentials → New Credential

  Settings → Configurations → Data Collection → Automation & Feed Integrations and select the integration instance

####### 2.1.9.1.4.5. Integration use cases

####### 2.1.9.1.4.6. Troubleshoot Integrations

### 2.2. Post-deployment steps

#### 2.2.1. Perform health checks

##### 2.2.1.1. Monitor agent operational status in Cortex XSIAM

###### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex XSIAM management console for specific reasons for the state.

###### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

#### 2.2.2. Set up your environment

##### 2.2.2.1. Configure server settings

###### License Type

  Requires a Cortex XSIAM or Cortex XDR Pro license

###### Note

* Keyboard shortcuts, timezone, and timestamp format are not set universally and only apply to the user who sets them.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Requires the TIM add-on. By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled.

* Requires an MSSP License and RBAC permissions to Cases & Issues and Investigation & Response → Automation. This setting is available for the parent tenant only.

###### Navigation

  Settings → Configurations → General → Server Settings

##### 2.2.2.2. Configure security settings

###### Navigation

  Settings → Configurations → General → Security Settings

##### 2.2.2.3. Log forwarding

###### 2.2.2.3.1. Forward logs from Cortex XSIAM to external services

####### License Type

  Requires Cortex XDR per Endpoint

####### 2.2.2.3.1.1. Integrate a syslog receiver

######## Note

* Up to TLS 1.3 is supported. Make sure the self-signed CA includes your public key.

####### 2.2.2.3.1.2. Integrate Slack for outbound notifications

######## Note

* You are directed to the Slack browser to install Cortex XSIAM. You can only use this link to install Cortex XSIAM on Slack. Attempting to install from Slack Marketplace will redirect you to Cortex XSIAM documentation.

####### 2.2.2.3.1.3. Configure notification forwarding

######## Prerequisite

* Before you can select a syslog receiver or a Slack channel, you must integrate these external services with Cortex XSIAM. For more information, see: Integrate a syslog receiver Integrate Slack for outbound notifications

######## Note

* To configure notification forwarding for issues by domain, select Log Type = Issues and filter the Issues table by Issue Domain.

* This option will be deprecated in the next release. Configure issues with the filter Issue Domain = Health instead.

* When a notification is sent for each configured format.

####### 2.2.2.3.1.4. Monitor administrative activity

###### 2.2.2.3.2. Log notification formats

####### 2.2.2.3.2.1. Management audit log messages

####### 2.2.2.3.2.2. Issue notification format

####### 2.2.2.3.2.3. Agent Audit log notification format

####### 2.2.2.3.2.4. Management Audit log notification format

####### 2.2.2.3.2.5. Log format for IOC and BIOC issues

####### 2.2.2.3.2.6. Analytics log format

####### 2.2.2.3.2.7. Log formats

######## Note

* The FUTURE_USE tag applies to fields that Cortex XSIAM does not currently implement.

#### 2.2.3. Remote repository management

##### 2.2.3.1. Cortex XSIAM development tenant

###### Important

* Development tenants are not intended for performance checks; they cannot access production data, and they are connected to a limited number of endpoints. As a result, all development tenants have fewer resources than the production tenant, including data ingestion capacity and performance, and compute capabilities. In a development tenant, extreme...

##### 2.2.3.2. Set up a remote repository

###### Navigation

  If the content repository option is disabled for the production or development tenant (under Settings → Configurations → General → Remote Repository Settings, toggle the Content repository slider to off), the tenant becomes standalone and does not push or pull content

  If you are changing your remote repository settings, back up existing content to your local computer by navigating to Settings → Configurations → General → Server Settings → Custom Content and click Export all custom content

###### 2.2.3.2.1. Set up a built-in remote repository

####### Note

* Once enabled, development tenants have a red banner on the top left showing DEV.

* The first tenant that is enabled pushes its content to the remote repository first. For example, these instructions describe enabling the production tenant first, so the remote repository will initially contain production tenant content. You can enable a development tenant first if you want the remote repository to initially contain the content from...

####### Navigation

  Settings → Configurations → General → Remote Repository Settings and toggle the Content repository slider to enable the remote repository

###### 2.2.3.2.2. Set up a Private Remote Repository

####### Note

* Once enabled, the development push tenant has a red banner on the top left showing DEV.

* For repository vendors that use tokens, enter the token type in the username field and the token in the password field. Verify details with your vendor. If your private Git remote repository uses personal access tokens instead of usernames and passwords, enter the token type in the username field and the access token in the password field. For example,...

* You can't add an engine that has been added to a Load-Balancing Group.

* If your private Git remote repository uses personal access tokens instead of usernames and passwords, enter the access token in the password field and leave the username field blank. For repository vendors that use tokens, the token type is entered in the username field and the token is entered in the password field. Verify details with your vendor. If...

* The first tenant that is enabled pushes its content to the remote repository first. For example, these instructions describe enabling the production tenant first, so the remote repository will initially contain production tenant content. You can enable a development tenant first if you want the remote repository to initially contain the content from...

####### Tip

* Due to security concerns, there is a closed allow list of approved URLs for private repositories. If you want to use a URL that is excluded from the allow list, use an engine (engine groups are not supported).

##### 2.2.3.3. Push and pull content

###### Navigation

  Settings → Configurations → Remote Repository Content → User-Defined Content

##### 2.2.3.4. Remote repository troubleshooting

#### 2.2.4. Manage user roles and access management

##### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

##### Note

* For more information on assigning user roles when generating an API key, see Manage API keys.

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* For features where scoping is not applicable, Role-Based Access Control (RBAC) is used and can be configured when managing user roles. For more information, see Manage user roles.

##### 2.2.4.1. Manage user roles

###### Prerequisite

* Managing user roles in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Navigation

  Settings → Configurations → Access Management → Roles

##### 2.2.4.2. Manage user access

###### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Note

* You can only reduce the permissions of an Account Admin user via Cortex Gateway.

* User permissions for components and datasets are based on the access permissions set in the user role. For more information on editing these user role permissions, see Manage user roles.

###### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit User Permissions.

###### Navigation

  Settings → Configurations → Access Management → Users

###### 2.2.4.2.1. User access reference information

##### 2.2.4.3. Manage user scope

###### Prerequisite

* Configuring user scopes in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles. By default, Enable Scope Based Access Control is...

###### Note

* This configuration can impact the visibility of the related Security domain in the Cases and Issues scope area, but with not affect asset visibility.

* For Cases and Issues domains, a workaround is to create a Dataset View for each required combination of domains, and allow the relevant entity access only to this Dataset View, not to the underlying cases and issues datasets.

* Make sure to assign the required default granular scoping for users. This depends on the structure and divisions within your organization and the particular purpose of each organizational unit to which scoped users belong.

###### Important

* Some areas and features in Cortex XSIAM do not respect SBAC. In these cases, use RBAC permissions to restrict access.

* Before configuring, ensure that you review the Understand scoping section.

#### 2.2.5. Dashboards and reports

## 3. Configure Cortex XSIAM

### 3.1. Configure and deploy Cortex XSIAM

### 3.2. Cortex XSIAM - Analytics

#### Prerequisite

* Before Cortex XSIAM - Analytics can start to analyze your endpoint data, perform the following steps: Configure Cortex XSIAM network parameters to monitor your internal networks. Enable the Analytics Engine. Make sure Cloud Identity Engine is set up. Enable Identity Analytics.

#### 3.2.1. Configure Cortex XSIAM network parameters

##### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

##### Navigation

  Inventory → Assets → Network Configuration → Internal Domain Suffixes

#### 3.2.2. Enable the Analytics Engine and Identity Analytics

##### Prerequisite

* Analytics Engine To create a baseline for enabling analytics, Cortex XSIAM requires a minimum of one of the following data sets: EDR or Network logs from at least 30 endpoints over a minimum of 2 weeks Cloud audit logs over a minimum of 5 days Identity Analytics Cortex XSIAM - Analytics must be activated. Cloud Identity Engine must be set up. For more...

##### Navigation

  Settings → Configurations → Cortex XSIAM - Analytics

### 3.3. Cortex XSIAM engines

#### 3.3.1. Engine requirements

##### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

#### 3.3.2. Install an engine

##### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex XSIAM engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

##### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

##### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

### 3.4. Set up Cloud Identity Engine

#### Note

* The Activate risk signal sharing to CIE checkbox is available only after the second step is completed.

#### Navigation

  Settings → Configuration → Integrations → Cloud Identity Engine

### 3.5. Multi-Tenant

#### 3.5.1. What is Cortex XSIAM multi-tenant?

##### Note

* By default, multi-tenant licenses include one child tenant.

##### 3.5.1.1. MSSP multi-tenant

##### 3.5.1.2. Enterprise multi-tenant

#### 3.5.2. Multi-tenant central licensing management

##### Note

* In MSSP or enterprise multi-tenant, the license specifies the maximum number of child tenants that can be created. Once this limit is reached, no additional tenants can be created, even if there remains allocation for endpoints or GBs.

#### 3.5.3. Onboard Cortex multi-tenant

##### 3.5.3.1. Onboarding checklist for multi-tenant central licensing deployments

###### 3.5.3.1.1. Step 1. Activate Cortex XSIAM (main account)

####### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

###### 3.5.3.1.2. Step 2. Create a child tenant

####### Note

* The main account is labeled in Cortex Gateway, but child tenants are not labeled. Cortex enables parent-child pairing between tenants located in different geographical regions. To enable this capability, contact your support team. To create a child tenant, ensure that you have Account Admin permissions.

* After activating a child tenant, you can't change the child tenant's name.

* This is a public FQDN, so be careful with sensitive information such as the company name. After activating a child tenant, you can only change the child tenant subdomain once.

* Ensure that you meet the minimum requirements for child tenant allocation.

* If you reach your limit for child tenants, depending on your license, you may be able to create more tenants. You may be charged for additional tenants. Contact Customer Support if you are approaching your authorized limit.

##### 3.5.3.2. Onboarding checklist for multi-tenant customer-owned license deployments

###### 3.5.3.2.1. Step 1. Activate Cortex Cortex XSIAM (parent and child tenants)

####### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

###### 3.5.3.2.2. Step 2. Define access configurations and role permissions

###### 3.5.3.2.3. Step 3. Pair a parent tenant with child tenant

####### Note

* This field is not enabled by default. To enable this, contact your support team.

#### 3.5.4. Dynamic license allocation

##### Note

* Changing the tenant's allocations might result in a short downtime of your tenant.

* After activating a child tenant, you can't change the child tenant's name.

* This is a public FQDN, so be careful with sensitive information such as the company name. After activating a child tenant, you can only change the child tenant subdomain once.

* Ensure that you meet the minimum requirements for child tenant allocation.

* If you reach your limit for child tenants, depending on your license, you may be able to create more tenants. You may be charged for additional tenants. Contact Customer Support if you are approaching your authorized limit.

* In a multi-tenant central licensing management environment, you cannot unpair a child tenant from the main account. The only way to remove the connection to the main account is to delete the tenant.

#### 3.5.5. Child tenant management

##### 3.5.5.1. Manage a child tenant

###### Note

* Once a configuration is created Cortex XSIAM resets the child tenant data and synchronizes the security actions configured in the parent tenant.

##### 3.5.5.2. Track your tenant management

###### Note

* This field is not enabled by default. To enable, contact your account administrator.

###### Navigation

  To view child tenant details, in Cortex XSIAM, select Settings → Configurations → Tenant Management

##### 3.5.5.3. Investigate child tenant data

##### 3.5.5.4. Create and allocate configurations

###### Note

* You can configure Profiles only as Managed or Unmanaged. All profiles you create are automatically cloned to your child tenants.

##### 3.5.5.5. Create a security managed action

###### Note

* Profiles you create are automatically cloned to your child tenants.

#### 3.5.6. About managed threat hunting

##### 3.5.6.1. Set up Managed Threat Hunting

###### Navigation

  Settings → Configurations → Managed Services

##### 3.5.6.2. Investigate Managed Threat Hunting reports

###### Note

* The MTH page is available for users with the Managed Threat Hunting license and have the necessary permission to view and triage alerts and incidents in Cortex XSIAM.

## 4. Protect your endpoints

### License Type

  Cortex endpoint security is not included in the Cortex XSIAM NG SIEM license.

### 4.1. Endpoint security

#### 4.1.1. Endpoint protection

##### 4.1.1.1. Malware protection

###### Note

* From Cortex XDR agent for Android version 9.0 and later, this module is deprecated.

##### 4.1.1.2. Exploit protection

##### 4.1.1.3. File analysis and protection flow

###### Note

* To enhance performance and efficiency, hash verdict requests from the Cortex XDR agent will be routed to the WildFire service with the lowest latency. File uploads for analysis will strictly adhere to the designated Cortex XSIAM and WildFire regions, ensuring data remains within the appropriate geographical boundaries.

##### 4.1.1.4. Endpoint protection capabilities

##### 4.1.1.5. Endpoint protection modules

##### 4.1.1.6. Processes protected by exploit security policy

##### 4.1.1.7. File Integrity Monitoring (FIM)

###### License Type

  FIM requires the Cortex Cloud Runtime Security add-on.

###### Note

* Google Kubernetes Engine (GKE) is currently not supported

* It is recommended to create a policy that targets only the necessary files and folders.

* Platform cannot be changed once a rule group has been created

* A rule group can contain up to 100 rules.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* It is possible to manage up to 15,000 events per day (24 hours) for each host/container.

###### Navigation

  Creating, modifying and viewing FIM rule groups and rules is be done in the Rule Groups page, located at the Inventory → Endpoints → File Integrity Monitoring menu

  In Inventory → Endpoints → Policy management → Extensions → Profiles, select +Add Profile and then select either Create New or Import from File

##### 4.1.1.8. WildFire analysis concepts

###### Note

* In cases when the Cortex XSIAM agent gets a failed status from the WF service due to a general error or unsupported file type, and the Local Analysis is set to disabled or not applicable, Cortex XSIAM will not generate an alert on the file.

##### 4.1.1.9. Guidelines for keeping Cortex XDR agents and content updated

###### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups. See how to define endpoint group.

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups.

###### Important

* When planning Cortex XDR agent upgrades and content updates, consult with the appropriate stakeholders and teams and follow the change management strategy in your organization.

###### Caution

* Before enabling Auto-Update for Cortex XDR agents, make sure to consult with all relevant stakeholders in your organization.

##### 4.1.1.10. About content updates

###### Note

* Cortex XSIAM delivers the content update to the agent in parts and not as a single file, allowing the agent to retrieve only the updates and additions it needs.

##### 4.1.1.11. Endpoint data collection

###### Note

* For specific files only and only if the file was written.

###### Important

* Registry key is collected as a real key name, and not as a symbolic link. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, KEY_LOCAL_MACHINE\System\ControlSet001 will be collected. Instead of HKEY_CURRENT_USER, HKEY_USERS\<SID> will be collected, where SID is a SID of the current user.

#### 4.1.2. Install and manage endpoints

##### 4.1.2.1. Set up endpoint protection

###### 4.1.2.1.1. Set up endpoint profiles and exception rules

####### Note

* Profiles associated with one or more targets that are beyond the scope of your defined user permissions are locked, and cannot be edited.

####### 4.1.2.1.1.1. Set up malware prevention profiles

######## Note

* In this profile, the Report options configure the endpoints to report the corresponding suspicious files, actions, processes, or behaviors to Cortex XSIAM, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* As part of the anti-malware security flow, the Cortex XDR agent leverages the operating system's capability to identify revoked certificates for executables, and DLL files that attempt to run on the endpoint by accessing the Windows Certificate Revocation List (CRL). To allow the Cortex XDR agent access the CRL, you must enable internet access over...

* The Quarantine Malicious Executables feature is not available for malware identified on network drives.

* The Quarantine Malicious Script Files feature is not available for malware identified on network drives.

* If on-write actions were configured in earlier versions of Cortex XSIAM, the same configuration has been preserved and applied globally for all file types. On-write file protection may have an impact on the resources required by the Cortex XDR agent.

* On-demand file protection may have an impact on the resources required by the Cortex XDR agent.

* We recommend that you disable scheduled scanning. VDI machine scans are based on the golden image and additional files will be examined upon execution.

* When periodic scanning is enabled in your profile, the Cortex XDR agent initiates an initial scan when it is first installed on the endpoint, regardless of the periodic scanning scheduling time.

* When you are actively evaluating with BAS tools, it is recommended to enable the BAS mode setting only for the duration of your evaluation, and for a limited number of agents.

* BAS tools mode with content older than version 1850 cannot be configured, the agent will be treated as Enabled.

* The Quarantine Malicious Mach-O Files feature is not available for malware identified on network drives.

* This module is supported by Cortex XDR agent 8.1.0 and later releases.

* Enabling on-demand scanning will automatically scan these core system directories: /etc, /tmp, /home, /usr, /bin, /sbin, /lib, /var, /opt, /dev, /root, /boot.

* The Quarantine Malicious ELF Files feature is not available for malware identified on network drives.

* Blocking functionality is different for each security module. For SMS/MMS, Cortex XDR agent will move detected messages containing such URLs from unknown senders to the Junk folder.

* Ensure that the same numbers are not added multiple times with different leading zeros.

* To fully enable the Safari browser security module on the device side, each iOS device user must enable the Safari Safeguard module on the device, and grant it permission to work on all websites. If the iOS device user does not do this, the endpoint's operation status is reported as Partially Protected. The Safari browser security module will only...

* Cortex XDR agent version 8.4 or higher are required for this feature.

######## Warning

* For optimal user experience, we recommend that you set the action mode to either Allow or Run Local Analysis.

####### 4.1.2.1.1.2. Set up exploit prevention profiles

######## Note

* In this profile, the Report options configure the endpoints to report the corresponding exploit attempts to Cortex XSIAM, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* In exploit prevention profiles, if you change the action mode for processes, you must restart the protected processes for the following security modules to take effect on the process and its forked processes: Brute Force Protection Java Deserialization SO Hijacking

* This step provides a temporary workaround for the following publicly known information-security vulnerabilities and exposures: CVE-2021-24074, CVE-2021-24086 and CVE-2021-24094.

* If you have Windows endpoints in your network that are unpatched and exposed to a known vulnerability, we strongly recommend that you upgrade to the latest Windows Update that has a fix for that vulnerability.

######## Warning

* This workaround applies only to the specific Windows versions listed as exposed to these CVEs, and requires a Cortex XDR agent release 7.1 or later and content 167-51646 or later. This workaround is not recommended for non-persistent, stateless, or linked-clone environments. In some cases, enabling this workaround can affect the network functionality...

####### 4.1.2.1.1.3. Set up agent settings profiles

######## License Type

  Requires a Cortex XDR Pro per Endpoint license. When you enable this feature, a Cortex XDR Pro per Endpoint license is consumed.

  Requires Host Insights add-on.

  Requires Forensics Add-on.

######## Prerequisite

* User Space Agent mode requires Linux kernel 5.0.0 or higher.

######## Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

* You can enable the option to maintain a persistent notification regarding the disconnection of the endpoint from the network. The settings Persistent Isolation Notification and Blocked Connectivity Notification must be enabled. Until the threat on the endpoint has been removed, the endpoint remains disconnected from the network.

* In Traps 5.0.6 and later releases, when protection is enabled, access will be read-only. In earlier Traps releases, enabling protection disables all access to services, processes, files, and registry values.

* If you choose the Enable option, you must also enable XDR Agent Tampering Protection in the malware profile and set it to Block. Ensure that both profiles are assigned to the same endpoints.

* When you enable Cortex XDR agent registration with the Windows Security Center, Windows automatically shuts down Microsoft Defender on Windows-based workstation endpoints. If you still want to allow Microsoft Defender to run on a workstation endpoint where Cortex XSIAM is installed, you must use the Disable option. However, Palo Alto Networks does not...

* To enable access to these options, scroll down to Network Location Configuration, and set Action Mode to Enabled.

* When using Nmap, the Cortex XDR agent downloads an Nmap driver for the duration of the scan and removes the driver upon completion. If an Nmap scan is in process, Cortex XSIAM identifies the Nmap driver and places any additional scans in a queue.

* If you disable content updates for a newly installed agent, the agent retrieves the content for the first time from Cortex XSIAM, and then disables content updates on the endpoint. When you add a Cortex XDR agent to an endpoint group with a disabled content auto-upgrades policy, the policy is applied to the added agent as well.

* Automatic upgrades are not supported with non-persistent VDI and temporary sessions.

* Limitations in the content download process: When you install the Cortex XDR agent, the agent retrieves the latest content update version available. A freshly installed agent can take between five to ten minutes (depending on your network and content update settings) to retrieve the content for the first time. During this time, your endpoint is not...

* If the Cortex XDR agent is initially unable to communicate without the local store, enforcement is not enabled and the agent will show as partially protected.

* If you choose the Enabled option, you must also set Anti Tampering Protection in the malware security profile to Block, and ensure that both profiles are assigned to the same endpoints.

* Automatic upgrades are not supported for XDR agents running on K8s.

* User Space Agent mode requires Linux kernel 5.0.0 or higher. Endpoints running an older Linux kernel version with this fallback enabled, will not start using User Space Agent mode, and will operate asynchronously.

######## Warning

* If you disable or delay automatic-content updates provided by Palo Alto Networks, it may affect the security level in your organization.

####### 4.1.2.1.1.4. Set up restrictions prevention profiles

######## License Type

  A Threat Intel Management (TIM) license is required for this feature.

######## Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Configure custom BIOC prevention rules here: Detection & Threat Intel → Detection Rules → BIOC

* Configure this as follows: Prepare this restriction profile first, make a note of its name for later, and set it to Enabled. Prepare the prevention Indicator Rule (go to Detection & Threat Intel → Indicator Rules, ensuring to select Prevention when creating the rule), and while preparing it, map it to your restriction profile.

* Wildcards are supported.

####### 4.1.2.1.1.5. Set up exception profiles and rules

######## 4.1.2.1.1.5.1. Exception configuration

######## 4.1.2.1.1.5.2. Issue exclusions

######### 4.1.2.1.1.5.2.1. Add an issue exclusion rule

######## 4.1.2.1.1.5.3. Add an IOC or BIOC rule exception

######## 4.1.2.1.1.5.4. Add a disable prevention rule for endpoints

######## 4.1.2.1.1.5.5. Add a disable injection and prevention rule

######## 4.1.2.1.1.5.6. Add a support exception rule for endpoints

######## 4.1.2.1.1.5.7. Add a legacy exception rule for endpoints

######### 4.1.2.1.1.5.7.1. Add a new exceptions security profile

######### 4.1.2.1.1.5.7.2. Add a global endpoint policy exception

###### 4.1.2.1.2. Define endpoint groups

####### Note

* Disconnecting Cloud Identity Engine in your Cortex XSIAM deployment can affect existing endpoint groups and policy rules based on Active Directory properties.

###### 4.1.2.1.3. Configure global agent settings

####### Note

* Disabling this capability takes immediate effect on new hashes, fresh agent installations, and existing security policies. It could take up to a week to take effect on existing agents in your environment pending agent caching.

* If you have any Cortex XSIAM filters, starring policies, exclusion policies, scoring rules, log forwarding queries, or automation rules configured for XSOAR/3rd party SIEM, we advise you to update those to support the changes before activating the feature. For example, change the query to include the previous description that is still available in the...

###### 4.1.2.1.4. Apply profiles to endpoints

####### Note

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

###### 4.1.2.1.5. Create an agent installation package

####### Note

* The profile will be applied if the security policy cannot be retrieved in real-time.

* The Cortex serverless library must be imported after other libraries to activate the hooks that enable auditing.

####### 4.1.2.1.5.1. Manage an agent installation package

######## Note

* Since Cortex XSIAM relies on the installation package ID to approve agent registration during the installation, we recommend that you don't delete the installation package of active endpoints. If you install the Cortex XDR agent from a package after you delete it, Cortex XSIAM denies the registration request leaving the agent in an unprotected state....

###### 4.1.2.1.6. Harden endpoint security

####### Caution

* Hardened endpoint security capabilities are not supported for Android or iOS endpoints.

####### Navigation

  From Inventory → Endpoints → Policy Management → Extensions → Profiles, you can create profiles for the following hardened endpoint security capabilities

  To apply the profiles, from Inventory → Endpoints → Policy Management → Extensions → Policy Rules, you can view all the policy rules per operating system

####### 4.1.2.1.6.1. Device control

######## Note

* Operating systems report on devices in different ways. Sometimes, the same BLE device will report different services and interfaces, depending on the host's operating system. This may have an effect on the specific BLE services that are blocked for each operating system. Depending on your defined user scope permissions, creating device profiles,...

* For network printer print jobs, ensure that you also configure the Agent Settings profile, Network Location Configuration option. This setting must be set to Enabled, and configured. If you do not enable and configure this setting, all network printer operations will be treated as internal network print jobs. For network printer print jobs, ensure that...

* Currently, the default is set to Use Default (Allow), however, Palo Alto Networks may change the default definition at any time.

* You cannot edit or delete the default profiles pre-defined in Cortex XSIAM.

* You cannot edit or delete the predefined profiles in Cortex XSIAM.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* Permanent exceptions apply across platforms, allowing the devices on all operating systems.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

######## Navigation

  Endpoints → Policy Management → Settings → Device Management

####### 4.1.2.1.6.2. Host firewall

######## 4.1.2.1.6.2.1. Host firewall for Windows

######## 4.1.2.1.6.2.2. Host firewall for macOS

####### 4.1.2.1.6.3. Disk encryption

######## Note

* You must select the same encryption method configured by the Microsoft Windows Group Policy in your organization for the target endpoints. Otherwise, if you select a different encryption method than the one already applied through the Windows Group Policy, Cortex XSIAM displays errors.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

######## Navigation

  You can monitor the Encryption Status of an endpoint in the Inventory → Endpoints → Disk Encryption Visibility table

####### 4.1.2.1.6.4. Host Inventory

######## Note

* Cortex XSIAM includes only the first 10,000 results per endpoint. Cortex XSIAM lists only users that belong to each group directly, and does not include users who belong to a group within the main group. If a local users group includes a domain user (whose credentials are stored on the Domain Controller server and not on the endpoint), Cortex XSIAM...

######## Navigation

  Inventory → Endpoints → Host Inventory

####### 4.1.2.1.6.5. Vulnerability Assessment

######## Prerequisite

* The following are prerequisites for Cortex XSIAM to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XSIAM lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex XSIAM...

* The following are prerequisites for Cortex XSIAM to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex XSIAM collects all the information about the operating system and the installed...

######## Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex XSIAM Application Inventory.

######## Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

######## Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

###### 4.1.2.1.7. Set a Cortex XDR agent Critical Environment version

####### Note

* To ensure the stability of the line, CE versions maintenance release cadence is longer than in the standard line, we recommend that deployment is adjusted accordingly.

####### Navigation

  Settings → Configurations → General → Agent Configurations

  Inventory → Endpoints → All Endpoints

###### 4.1.2.1.8. Set an application proxy for Cortex XDR agents

####### Navigation

  Inventory → Endpoints → All Endpoints

##### 4.1.2.2. Manage endpoint protection

###### 4.1.2.2.1. Move agents between managing servers

####### Prerequisite

* Consider the following before making changes: Endpoint type is not Kubernetes Node. Installation type is not VDI. Ensure you have administrator privileges for Cortex XSIAM in the hub.

####### Note

* Cortex XSIAM does not support moving agents between FedRamp and commercial tenants.

####### Navigation

  Inventory → Endpoints → Agent Installations

  Inventory → Endpoints → All Endpoints

###### 4.1.2.2.2. Manage endpoint tags

####### Note

* The following explanations use Windows operating system installation parameters and Cytool argument examples.

* Tag names are case sensitive. In Windows and Mac, a tag name can contain spaces. Linux does not support tag names with spaces as command line arguments to the shell installer. Instead, tags can be set in the /etc/panw/cortex.conf configuration file, which supports all Linux installers.

* Tag names are case sensitive and can contain spaces.

* When SBAC is enabled, assigning tags may impact user permissions.

* If you remove the tag and there are assigned users or user groups with scope settings, this can impact user permissions in the system.

###### 4.1.2.2.3. Set an alias for an endpoint

####### Tip

* If you change your mind in the future, you can select Endpoint Control → Change Endpoint Alias again, and delete the required aliases.

###### 4.1.2.2.4. Manage endpoint prevention profiles

####### Note

* The filter is stored within the policy definition and assessed during runtime to extract the functions that match the filter criteria.

####### Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

###### 4.1.2.2.5. Upgrade Cortex XDR agents

####### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

####### Warning

* You must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check whether the extensions were approved, you can either verify that the...

####### Important

* The following list includes important points to take into account when upgrading the Cortex XDR agent: Review the recommended guidelines for keeping Cortex XDR agents and content updated. Read more here. You cannot upgrade the Cortex XDR agent on VDI endpoints or a Golden Image. You must reinstall (uninstall and install again) the relevant agent...

###### 4.1.2.2.6. Restart agent

###### 4.1.2.2.7. Uninstall the Cortex XDR agent

####### Note

* Before upgrading a Cortex XDR agent running on macOS 10.15.4 or later, you must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check...

####### Tip

* If needed, use the filter to filter the list of endpoints by attribute or group name.

####### Navigation

  Inventory → Endpoints → All Endpoints

###### 4.1.2.2.8. Clear agent database

####### Note

* Clearing the agent database is supported on all platforms with Cortex XDR agent version 7.9 or later, and is available only when using the debugging mode.

* You can only right-click to cancel the clear agent database for actions with a pending status.

###### 4.1.2.2.9. Delete Cortex XDR agents

####### Note

* To reinstate an endpoint, you have to uninstall and reinstall the agent.

####### Navigation

  Inventory → Endpoints → All Endpoints

###### 4.1.2.2.10. Manage agent tokens

####### Note

* Agent tokens are only supported for Windows and Mac.

* You can select a one or multiple agents to add a temporary token.

###### 4.1.2.2.11. Retrieve support file password

####### Navigation

  Retrieve Support File Password from Inventory → Endpoints → All Endpoints

###### 4.1.2.2.12. Monitor agent operational status

####### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex XSIAM management console for specific reasons for the state.

####### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

####### Navigation

  You can monitor the Cortex XDR agent Operational Status in Inventory → Endpoints → All Endpoints

###### 4.1.2.2.13. Monitor agent activity

###### 4.1.2.2.14. Monitor agent upgrade status

####### Navigation

  From Inventory → Endpoints → All Endpoints, you can view the upgrade status of any Cortex XDR agent that you manage

## 5. Detect, investigate, and respond to threats

### 5.1. Monitor dashboards and reports

#### 5.1.1. About dashboards

##### Note

* You cannot edit the predefined dashboards but you can create a new dashboard that is based on a dashboard template. In addition, private dashboards can only be viewed, edited, and deleted by the dashboard creator.

* Dashboards that are based on custom infrastructure cannot be exported. If you import a dashboard template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

##### 5.1.1.1. Command Center dashboards

###### Note

* Access to the dashboards requires RBAC View permissions for Dashboards & Reports and Command Center Dashboards. The dashboards are available in dark mode only. They are not editable, and you can't create dashboard templates or reports from them. Some of the dashboard's animations are not fully supported by the Safari web browser. We recommend that...

###### 5.1.1.1.1. Cortex Command Center

####### Note

* The Cortex Command Center requires RBAC View permissions for Dashboards, Command Center Dashboards, and Asset Inventory.

###### 5.1.1.1.2. XSIAM Command Center

###### 5.1.1.1.3. Cloud Detection and Response (CDR) Command Center

###### 5.1.1.1.4. Cloud Security Command Center

####### 5.1.1.1.4.1. Cloud Security Command Center

######## Note

* The Cloud Security Command Center dashboard is currently only available by default to users with the Instance Administrator and Viewer roles. Custom roles, which include the Cloud Security Command Center View/Edit role permissions, also have access.

######## 5.1.1.1.4.1.1. Fine-Tune your Investigation

######### 5.1.1.1.4.1.1.1. Data Sources

######### 5.1.1.1.4.1.1.2. Assets with Vulnerabilities

######### 5.1.1.1.4.1.1.3. Security Outcomes

######## 5.1.1.1.4.1.2. Value Metrics

###### 5.1.1.1.5. Cloud Security Operations

####### 5.1.1.1.5.1. Cloud Security Operations

######## License Type

  Requires the Cortex Cloud Runtime Security add-on or the Cortex Cloud Posture Management add-on.

######## Note

* Command Center data may not match the counts on the Issues page and you may observe inconsistencies. This is because dashboard data is a snapshot of issues identified, whereas the Issues page provides the most up to date view of risks across your cloud assets. In addition, the Issues pages does not support all the currently available filters on the...

######## 5.1.1.1.5.1.1. Dashboard Widgets

######### 5.1.1.1.5.1.1.1. Generate Reports

######### 5.1.1.1.5.1.1.2. Filter Options

##### 5.1.1.2. Predefined dashboards

###### License Type

  Requires the ITDR add-on.

###### Note

* Users can access all information on the dashboard when their user access is scoped to view All assets or assigned to the Instance Administrator role. Otherwise, users with granular scoping set to No assets or Select asset groups will have limited access to the dashboard. For more information on Scope-Based Access Control (SBAC), see Manage user...

##### 5.1.1.3. Reports

###### 5.1.1.3.1. Report templates

#### 5.1.2. Build custom dashboards and reports

##### 5.1.2.1. Build a custom dashboard

###### Note

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

##### 5.1.2.2. Manage your Widget Library

###### Note

* Any dashboards or reports that include the widget are affected by the changes.

#### 5.1.3. Fine-tune dashboards and reports

##### 5.1.3.1. Create a custom widget using a script

###### Note

* If you have added arguments to the script, these appear when creating a widget.

* Available options are Pie, Column, Line, and Single Value. To display the result of the script as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### 5.1.3.1.1. Script-based widget examples

####### Note

* Add the widget tag in the script settings to make the script available for use in script-based widgets. For more information, see Create a script.Create a script

* If your script returns a time duration, configure the widget with the graph type Single Value and enable Show as Time..

##### 5.1.3.2. Create a text widget

###### Note

* From the dashboard manager, you can right-click an existing dashboard and choose Save as report template. You can also add text-based widgets directly to new or existing report templates, as described below.

##### 5.1.3.3. Create custom XQL widgets

###### Note

* Cortex Query Language (XQL) queries generated from the Widget Library do not appear in the Query Center. The results are used only for creating the custom widget.

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

###### Tip

* You can create a generic dashboard for multiple views of the same dataset by defining the dataset in the XQL widget as dataset = <dataset_name>*. The placement of the asterisk (*) in the dataset name ensures that any view containing this prefix text is displayed in the results. The dataset in a query is defined as: If there are multiple datasets that...

###### Navigation

  All of your predefined and custom XQL widgets are available in the Widget Library under Dashboards & Reports → Customize → Widget Library

###### 5.1.3.3.1. Configure filters and inputs for custom XQL widgets

####### Prerequisite

* Fixed filters are based on parameters that are defined in custom XQL widgets. Before you can configure fixed filters, take the following steps: Create custom XQL widgets with parameters. For more information, see Create custom XQL widgets. Add the widgets to a Custom dashboard. For more information, see Build a custom dashboard.

####### Note

* If you specify more than one field, only the first field value is used.

####### Tip

* After the initial setup, when you access your dashboard the filters and inputs might need further refinement. You can make changes to the configured parameters in the XQL widgets, and update the Filters & Inputs on your dashboard until you are satisfied with the results.

##### 5.1.3.4. Configure dashboard drilldowns

###### Prerequisite

* To configure drilldowns your dashboard must contain custom XQL widgets. In addition, if you want to configure in-dashboard drilldowns your custom XQL widget must contain one or more parameters. For more information about configuring parameters in custom XQL widgets, see Create custom XQL widgets.

###### Note

* If the selected parameter is configured in other XQL widgets on the dashboard, these widgets are also affected by the drilldown.

###### 5.1.3.4.1. Variables in drilldowns

#### 5.1.4. Run or schedule reports

##### Note

* Report templates that are based on custom infrastructure cannot be exported. If you import a report template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

* The report name and description will be displayed in the report header and are not editable during customization.

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

##### Navigation

  Dashboards & Reports → Customize → Report Templates

  Dashboards & Reports → Customize → Dashboards Manager

  Under Settings → Configurations → General → Notifications, click + Add Forwarding Configuration

### 5.2. Investigation and response

#### 5.2.1. Cases and issues

##### 5.2.1.1. What are cases?

###### 5.2.1.1.1. Issues

###### 5.2.1.1.2. Findings and events

##### 5.2.1.2. Case and issue domains

###### Navigation

  You can see all domains under Configurations → Object Setup → Cases → Domains

##### 5.2.1.3. Manage your cases

###### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

###### 5.2.1.3.1. Assign a case

###### 5.2.1.3.2. Case thresholds

###### 5.2.1.3.3. Link or unlink issues from a case

###### 5.2.1.3.4. Resolve a case

####### 5.2.1.3.4.1. Resolution reasons for cases and issues

######## Note

* The displayed resolution reasons are domain specific. You can see the resolution reasons that are defined for a domain under Configurations → Object Setup → Cases → Domains.

* Cases and issues resolved as True Positive and False Positive help Cortex XSIAM to identify real threats in your environment by comparing future cases and associated issues to the resolved cases. Therefore, the handling and scoring of future cases is affected by these resolutions.

####### 5.2.1.3.4.2. Create custom case statuses and resolution reasons

######## Note

* Before you create a custom status, please review the built-in options. For more information, see Resolution reasons for cases and issues. We recommend using the built-in statuses and resolution reasons where possible. Custom statuses and resolution reasons might not be supported by all content, and status syncing can take time. In addition, custom...

* After creation, custom statuses and resolution reasons cannot be deleted or modified.

######## Navigation

  Configurations → Object Setup → Cases → Properties

###### 5.2.1.3.5. Create a case

####### Note

* To create a case manually, you must have View/Edit permission for Cases and Issues selected under Settings → Configurations → Access Management → Roles → Components → Cases & Issues.

* You can assign a case to a single domain only and you cannot change the assigned domain. For more information, see Case and issue domains.

* This option is only relevant for certain domains.

* You can't attach files to manually created cases.

####### Tip

* The issues that you link to a case can be linked to multiple cases, and the issue domains do not need to match the case domain.

###### 5.2.1.3.6. Issue syncing

####### Prerequisite

* You must set up an integration before you can sync issues. For more information, see Set up an integration for mirroring issues.

####### Note

* Multiple tickets can be linked to an issue with outbound syncing. Issues with inbound syncing can be linked to a single ticket only.

* Using issue fields as variables is not currently supported.

* You can only define a single inbound profile. If you change the inbound sync profile the current profile is overwritten. You can define multiple outbound profiles; one issue can update multiple tickets.

* The inbound syncing flow runs every two minutes, and the outbound syncing flow runs every five minutes. In a bi-directional set-up, if the same field is updated in both tickets, the most recently updated value is used. In the external ticket, the logged history shows updates to the ticket. The user name that is logged with the history reflects the user...

* After an issue is resolved, ticket syncing remains active for up-to seven days. Therefore, you still update, change, or reopen the issue or external ticket and the tickets will continue to sync.

* If you change the selected inbound sync profile, the original sync profile is immediately overwritten.

####### Warning

* If you leave this field blank, all configured instances will be used.

####### Tip

* You can find a sync profile ID under Settings → Configurations → Object Setup → Issues → Sync Profiles. By default the ID field is not displayed in the table. Click the three dot menu and add it to the table layout.

####### Navigation

  Settings → Configurations → Data Sources and click Add Data Source

  Settings → Configurations → Data Collection → Automation & Feed Integrations

####### 5.2.1.3.6.1. Create a sync profile

######## Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

##### 5.2.1.4. Customize your cases

###### 5.2.1.4.1. External integrations

###### 5.2.1.4.2. Prioritize cases with starring and scoring

####### 5.2.1.4.2.1. Case starring

######## Navigation

  Cases & Issues → Case Configuration → Starred Issues

####### 5.2.1.4.2.2. Case scoring

######## 5.2.1.4.2.2.1. Set up case scoring

###### 5.2.1.4.3. Customize issue fields and layouts

####### 5.2.1.4.3.1. Issue fields

######## Warning

* Deleting an issue field or uninstalling a content pack containing an issue field may affect detection and other capabilities based on the deleted field. For example, correlation, layouts, case scoring, starring rules, and playbook triggers.

######## 5.2.1.4.3.1.1. Issue field types

######## 5.2.1.4.3.1.2. Create custom issue fields

######### 5.2.1.4.3.1.2.1. Create a grid field

######### 5.2.1.4.3.1.2.2. Issue field triggered scripts

######### 5.2.1.4.3.1.2.3. Issue timer fields

####### 5.2.1.4.3.2. Issue layouts

####### 5.2.1.4.3.3. Create custom issue layouts

######## Note

* The script that runs when an action button is clicked accepts only mandatory arguments through the pop up window and does not provide an option for any non-mandatory arguments to be filled in when the button is clicked. We recommend using a wrapper script to collect and validate arguments in scenarios where there can be a combination of mandatory and...

######## Tip

* Limit the number of issue fields to 50 in each section. You can create additional sections as needed.

######## 5.2.1.4.3.3.1. Add a custom widget to an issue layout

####### 5.2.1.4.3.4. Create rules for issue layouts

######## Navigation

  Settings → Configurations → Object Setup → Issues → Layout Rules → New Rule

###### 5.2.1.4.4. Customize case fields and layouts

####### 5.2.1.4.4.1. Create case timers and SLAs

######## Prerequisite

* Before you can create a case SLA, you must first create a timer field. A timer field can be associated with a single case SLA.

######## Note

* If you edit this filter after creation, the timer and associated SLA will be removed from any case that no longer qualifies, even if the timer is already running.

######## Navigation

  Settings → Configurations → Object Setup → Cases and open the Fields tab

######## 5.2.1.4.4.1.1. Update case timer and SLA fields

####### 5.2.1.4.4.2. Case fields

######## Warning

* Deleting a case field or uninstalling a content pack containing a case field may affect capabilities based on the deleted field, layouts and case scoring.

######## 5.2.1.4.4.2.1. Case field types

######## 5.2.1.4.4.2.2. Create custom case fields

######### 5.2.1.4.4.2.2.1. Create a grid field for a case

######## 5.2.1.4.4.2.3. Update case fields

####### 5.2.1.4.4.3. Case layouts

######## 5.2.1.4.4.3.1. Create custom case layouts

######## 5.2.1.4.4.3.2. Create rules for case layouts

###### 5.2.1.4.5. Create a case domain

####### Note

* Adding custom domains requires a View/Edit RBAC permission for Case Properties (under Object Setup). Once created, a custom case domain cannot be deleted or renamed.

####### Warning

* Before you add a custom domain, please review the built-in options. For more information, see Case and issue domains. We recommend using the built-in domains where possible. Custom domains might not be supported by all content. In addition, custom domains affect Cortex XSIAM's ability to learn, correctly identify, and score future cases. Smart...

####### Navigation

  Settings → Configurations → Object Setup → Cases → Domains

  Settings → Configurations → Access Management → User Groups

  Settings → Configurations → Access Management → Users

  To enable access to the domain for an API key, got to Settings → Configurations → Integrations → API Keys

###### 5.2.1.4.6. Create a sync profile

####### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

###### 5.2.1.4.7. Run indicator extraction in the CLI

####### Note

* Triggering enrichment on a substantial amount of indicators can take time (since it's activating all enrichment integrations per indicator) and can result in performance degradation.

##### 5.2.1.5. Cortex Copilot

###### Navigation

  To increase usability, you can create a personalized keyboard shortcut: Settings → Configurations → Server Settings → Keyboard Shortcuts and choose the shortcut you want to use

###### 5.2.1.5.1. Cortex Copilot layout

###### 5.2.1.5.2. Cortex Copilot capabilities

####### Note

* When you choose an option from the Respond column, Cortex Copilot will always prompt you to approve the action before executing.

* Disabling Cortex Copilot requires users to refresh their page.

#### 5.2.2. Investigate cases

##### 5.2.2.1. Overview of the Cases page

###### Note

* For MSSP and multi-tenant administrators, if the Unified Case View is enabled, this view consolidates all cases across your distributed environment, allowing you to view and perform actions on child tenants. If the Unified Case view is disabled, this view displays a single tenant at a time with a drop-down list for moving between tenants in read-only...

* When an issue is resolved, it remains linked to a case and appears in this section. Once all of the issues in a case are resolved, the case is automatically closed.

###### Tip

* Set a default tab in the details pane by selecting the pin icon next to a tab. Click on the Notepad, Messenger, and Case Context Data icons to add notes on the case, and see existing notes from other analysts.

###### 5.2.2.1.1. Saved table views

###### 5.2.2.1.2. Unified case view

####### License Type

  Requires an MSSP license.

####### Note

* Requires the following RBAC permissions:    Cases & Issues   Investigation & Response → Automation Requires the following RBAC permissions: Cases & Issues Investigation & Response → Automation This view is available for the parent tenant only. To take actions on a child tenant from a parent tenant, you must have the appropriate permissions for both...

* Custom case layouts of child tenants are not visible in the parent tenant.

##### 5.2.2.2. Review and investigate a case

###### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

* In some cases, the number of issues associated with the techniques will not be aligned with the number of the parent tactic because of missing tags or in case an issue belongs to several techniques.

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

* Cloud related issues are displayed in the User Name grouping. Prisma Cloud Compute issues are displayed in the Host Name grouping.

#### 5.2.3. Investigate issues

##### 5.2.3.1. Overview of the Issues page

###### Note

* Every 12 hours, the system enforces a cleanup policy to remove the oldest issues once the maximum limit is exceeded. The default issue retention period in Cortex XSIAM is 186 days.

##### 5.2.3.2. Issue card

###### Note

* This section is context specific and shows data according to the issue context.

###### 5.2.3.2.1. Use the War Room in an investigation

####### Note

* The case War Room is usually used for communication capabilities, but unlike the issue War Room, it does not include playbook specific entries. The case War Room enables you to investigate an entire case, not just an issue.

* Cortex XSIAM does not index notes and chats.

####### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

* You can use the up/down arrow buttons in the CLI to do a reverse history search for previous commands with the same prefix.

####### Navigation

  Investigation & Response → Automation → Playground

###### 5.2.3.2.2. Use the Work Plan in an investigation

##### 5.2.3.3. Triage and investigate issues

###### 5.2.3.3.1. Copy issues

###### 5.2.3.3.2. Analyze an issue

###### 5.2.3.3.3. Run an automation on an issue

####### Note

* In addition to automation, some playbooks contain manual tasks that prompt the analyst for input. This enables you to enhance an automation workflow with analyst input.

* You can also manually select a playbook to run from the Issue Work Plan tab.

###### 5.2.3.3.4. Create profile exceptions

####### Navigation

  Inventory+Endpoints → Policy Management → Profiles

###### 5.2.3.3.5. Investigate contributing events

###### 5.2.3.3.6. Retrieve additional issue details

####### Tip

* If you require assistance from Palo Alto Networks support to investigate the issue, make sure to provide the downloaded ZIP file.

###### 5.2.3.3.7. Add a file path to a malware profile allow list

####### Navigation

  Inventory+Endpoints → Policy Management → Prevention → Profiles and locate the malware profile you selected

###### 5.2.3.3.8. Create a featured field

####### Note

* Featured Active Directory values are displayed in the User and Host fields accordingly.

####### Navigation

  Cases & Issues → Case Configuration → Featured Fields and select a type of featured field

###### 5.2.3.3.9. View generating BIOC or IOC rule

###### 5.2.3.3.10. Export issue details to a file

###### 5.2.3.3.11. Exclude an issue

###### 5.2.3.3.12. Query case and issue data

####### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

###### 5.2.3.3.13. Update issue fields

####### Note

* You must create a custom status before you can select it.

####### Tip

* You can create custom issue statuses and resolution reasons, and use the setIssueStatus command to set these custom statuses for issues. For example, when a user starts investigating an issue, the issue status is automatically changed from New to Under Investigation. In some cases, it is useful to create an interim status, such as Triage. After you...

###### 5.2.3.3.14. Close an issue

####### Note

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

##### 5.2.3.4. What is Causality?

###### Note

* There are no CGOs in the Cloud Causality View, when investigating cloud Cortex XSIAM alerts and Cloud Audit Logs, or SaaS Causality View, when investigating SaaS-related alerts for 501 audit events, such as Office 365 audit logs and normalized logs.

###### 5.2.3.4.1. Causality view

####### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

###### 5.2.3.4.2. Network causality view

####### Note

* The network causality view displays only the information it collects from the detectors. It is possible that the CI may not show some of the firewall or agent processes.

####### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

###### 5.2.3.4.3. Cloud causality view

###### 5.2.3.4.4. SaaS causality view

###### 5.2.3.4.5. Timeline

####### Note

* The Timeline view is not available when investigating cloud Cortex XSIAM issues and cloud audit logs or SaaS-related issues for 501 audit events, such as Office 365 audit logs and normalized logs. Only the applicable cloud causality view and SaaS causality view is available for this data.

###### 5.2.3.4.6. Causality icons key

##### 5.2.3.5. Cortex Response and Remediation content pack

###### 5.2.3.5.1. Investigate an issue using Cortex Response and Remediation playbooks

###### 5.2.3.5.2. Example use cases

#### 5.2.4. Investigate findings

##### 5.2.4.1. Findings card

###### Note

* The information in this card is context specific, therefore some sections are not available for all findings.

#### 5.2.5. Investigate artifacts and assets

##### 5.2.5.1. Investigate an IP address

###### Note

* Requires a license key. Select Settings → Configurations → Integrations  → Threat Intelligence.

##### 5.2.5.2. Investigate an asset

###### Note

* The Asset view is available for hosts with a Cortex XDR agent installed.

##### 5.2.5.3. Investigate a host

###### License Type

  The Host Risk View requires the Identity Threat Module add-on.

###### Tip

* You can also see a list of all hosts under Inventory → Assets → Asset Scores.

##### 5.2.5.4. Investigate a file and process hash

###### Note

* Requires a license key. Go to Settings → Configurations → Integrations  → Threat Intelligence.

##### 5.2.5.5. Investigate a user

###### License Type

  If the Identity Threat module is enabled you can open the User Risk View. This view displays insights and profiling information to help you investigate issues and cases. Viewing anomalies in the context of baseline behavior facilitates risk assessment and shortens the time you require for making verdicts. If the Identity Threat module is not enabled...

###### Note

* Cortex XSIAM normalizes and displays case and issue times in your time zone. If you're in a half-hour time zone, the activity in the Normal Activity and the Actual Activity charts is displayed in the whole-hour time slot preceding it. For example, if you're in a UTC +4.5 time zone, the time displayed for the activity will be UTC +4.5, however, the...

###### Tip

* You can also see a list of all users under Assets → Asset Scores.

#### 5.2.6. Investigate endpoints

##### 5.2.6.1. Overview of the Action Center

###### Note

* Blocking files on endpoints is enforced by the endpoint malware profile. To block a hash value, ensure the hash value is configured in the Malware security profile. Select Override Report mode to allow the agent to block hashes, even if the Malware Profile is set to Report.

###### Navigation

  Investigation & Response → Response → Action Center

###### 5.2.6.1.1. Initiate and monitor endpoint actions

####### Navigation

  Investigation & Response → Response → Action Center → New Action

  Investigation & Response → Response → Action Center

###### 5.2.6.1.2. Action Center reference information

##### 5.2.6.2. Manage endpoints

###### Note

* For the Include endpoints from auto upgrade action, you cannot enable auto upgrade for Mobile, VDI, and TS installations.

* If an endpoint is excluded, the auto upgrade profile configuration is not available. If you exclude the endpoint from auto upgrade while the auto upgrade action is In progress, the ongoing upgrade will still take place.

* Content Status is calculated every 30 minutes. Therefore, there might be a delay of up to 30 minutes in displaying the data.

* Only supported for Windows and macOS.

* Changes to the agent status can take up to ten minutes to display on Cortex XSIAM .

###### Navigation

  Inventory → Endpoints → All Endpoints

  Settings → Configurations → General → Agent Configurations → Endpoint Administration Cleanup

##### 5.2.6.3. Retrieve files from an endpoint

###### Note

* You cannot define a path using environment variables on Mac and Linux endpoints.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Disabling File Retrieval does not take effect on file retrieval actions that are in progress.

##### 5.2.6.4. Retrieve support logs from an endpoint

###### Navigation

  Investigation & Response → Response → Action Center → + New Action

##### 5.2.6.5. Retrieve support file password

###### Navigation

  Retrieve Support File Password from Inventory → Endpoints → All Endpoints

##### 5.2.6.6. Scan an endpoint for malware

###### Navigation

  Investigation & Response → Response → Action Center → New Action

#### 5.2.7. Investigate files

##### 5.2.7.1. Manage file execution

###### Navigation

  Investigation & Response → Response → Action Center → New Action

##### 5.2.7.2. Manage quarantined files

###### Note

* This will restore all files with the same hash on all of your endpoints.

##### 5.2.7.3. Review WildFire analysis details

###### Note

* Cortex XSIAM displays the preview of WildFire reports that were generated within the last couple of years. To view a report that was generated more than two years ago, you can download the report.

##### 5.2.7.4. Import file hash exceptions

###### Navigation

  Investigation & Response → Response → Action Center → New Action

#### 5.2.8. Automations

##### 5.2.8.1. Automation in Cortex XSIAM

###### Note

* You can build end-to-end automation workflows from within the playbook editor, including creating automation rules, configuring integration instances, and creating and editing tasks. For more information, see Playbooks.

##### 5.2.8.2. Quick Actions

###### Note

* When investigating an issue, in the Issues table, you can right-click to Run an Automation on one or more issues. For more information, see Run an automation on an issue.Run an automation on an issue

##### 5.2.8.3. Manage automation exclusion policies

###### Note

* For the IAM User Hard Remediation and User Soft Remediation policies, we recommend including username, email, and ID for each user you want to exclude. Example: username1, user@example.com, userID112.

* You can also right click on a policy from the main Automation Exclusion Center page to disable or enable the policy. If you click on a list name in the Exclude column, that list opens in the Lists page.

##### 5.2.8.4. Playbooks

###### 5.2.8.4.1. Playbooks overview

###### 5.2.8.4.2. Playbook development checklist

###### 5.2.8.4.3. Plan your playbook

###### 5.2.8.4.4. Manage playbooks

####### Note

* The library by default shows only playbooks that are not adopted. Click the Show Adopted checkbox to show the adopted playbooks, indicated by an Adopted mark. The library shows the most updated playbook version. Adopting an older version than shown should be done through Marketplace. Adopting a playbook does not make it run. Some content packs include...

###### 5.2.8.4.5. Build your playbook

####### 5.2.8.4.5.1. Task 1. Choose from existing playbooks or create your own

######## Tip

* If there are additional relevant playbooks in Marketplace that are not in your Org repository, you can click Explore them now to see them in the Playbook Catalog and choose to adopt.

* To open multiple playbooks at the same time, edit the first playbook and then click New next to the playbook name to create a new tab. You can either create a new playbook, or add an existing one. You can view recently modified or deleted playbooks by clicking version history for all playbooks .

######## Navigation

  the Investigation & Response → Automation → Playbooks page to customize or create a playbook

####### 5.2.8.4.5.2. Task 2. Configure playbook settings

######## Note

* If the playbook has inputs and outputs, the Playbook Starts task will show back and forth arrows. Clicking them opens the Playbook Settings pane Inputs/Outputs tab.

* This rule will trigger the playbook to run if no other Automation Rule triggers the playbook first. You can view and edit the order the rules run in the Automation Rules page.

* If you do not add any fields, the group will be deleted when you click Save.

####### 5.2.8.4.5.3. Task 3. Add objects from the Task Library

######## 5.2.8.4.5.3.1. Add Quick Actions, commands, and scripts

######## 5.2.8.4.5.3.2. Add sub-playbooks

######## 5.2.8.4.5.3.3. Add manual tasks and blank tasks

######### 5.2.8.4.5.3.3.1. Create a standard task

######### 5.2.8.4.5.3.3.2. Create a conditional task

######### 5.2.8.4.5.3.3.3. Create a communication task

######## 5.2.8.4.5.3.4. Create a section header

######## 5.2.8.4.5.3.5. Configure script error handling in a playbook

####### 5.2.8.4.5.4. Task 4. Add custom playbook features

####### 5.2.8.4.5.5. Task 5. Test and debug the playbook

####### 5.2.8.4.5.6. Task 6. Manage playbook content

###### 5.2.8.4.6. Customize your playbook

####### 5.2.8.4.6.1. Configure a sub-playbook loop

######## Note

* Consider the following when adding a loop: The maximum number of loops (default is 100). A high number of loops or a high wait time combined with a large number of issues may affect performance. Periodically check looping conditions to ensure they are still valid for the data set. If you want a sub playbook task to loop over an array passed into its...

######## Tip

* Balance between the number of iterations and the interval so you do not overload the server.

####### 5.2.8.4.6.2. Filter and transform data

######## Caution

* You can change the context data root to filter, but it is not recommended to select a different root, as it affects the filter results. The drop-down list displays the filter root for backward compatibility.

######## Navigation

  Investigation & Response → Automation → Scripts → New Script

######## 5.2.8.4.6.2.1. Filter considerations, categories, and built-in filters

######## 5.2.8.4.6.2.2. Transformer considerations, categories, and built-in transformers

####### 5.2.8.4.6.3. Extract indicators

######## Note

* This configuration may delay playbook execution (issue creation). While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

####### 5.2.8.4.6.4. Extend context

####### 5.2.8.4.6.5. Update issue fields with playbook tasks

######## Note

* The setIssue script includes all available fields; use the scroll bar to see all the fields. The name field has a limit of 600 characters. If there are more than 600 characters, you can shorten the name field to under 600 characters and then include the full information in a long text field such as the description field. There are many fields already...

####### 5.2.8.4.6.6. Playbook polling

######## Note

* You need to use the GenericPolling playbook as a sub-playbook in a main playbook, such as Detonate File - JoeSecurity. The main playbook should follow this structure: Start Command: The task contains a command that fetches the initial state of the process and saves it to context. This command starts the process that should be polled. For...

###### 5.2.8.4.7. Test your playbook

####### Note

* The debugger does not support using parentIncidentFields.

* Using an existing issue in the debugger does not affect the original issue or change the original context data.

####### 5.2.8.4.7.1. Troubleshoot playbook performance

###### 5.2.8.4.8. Manage playbook content

###### 5.2.8.4.9. Best practices

####### Note

* If you reattach a detached playbook, any customizations you have made to the playbook will be overwritten when the playbook updates to the current version.

* Retries are not supported for data collection tasks that have errors sending emails (indicated by a server timeout). This is because retries only work on automation execution failures, not on email delivery issues.

##### 5.2.8.5. Create an automation rule

###### Note

* You can also define the conditions that trigger a specific playbook in the playbook editor. For more information, see Task 2. Configure playbook settings

###### Important

* Automation rules apply to Medium and higher severity issues. They also apply to Low severity Analytic issues and Low severity ABIOC issues that are tagged with Identity or Cloud. Rules are evaluated in order, and only the first rule that matches the trigger conditions is executed.

##### 5.2.8.6. Context data

###### 5.2.8.6.1. Issue context data

###### 5.2.8.6.2. Case context data

###### 5.2.8.6.3. Search context data

###### 5.2.8.6.4. Add context data to an issue

###### 5.2.8.6.5. Add context data to a case

####### Note

* If you run the command in the issue War Room, the data is added to the following places: The case context data. The issue context data under the case tab. If you run the command in the Case War Room, the data is added to the case context data only.

###### 5.2.8.6.6. Delete context data from a case

###### 5.2.8.6.7. Use context data in a playbook

####### Note

* Generic polling does not work if a playbook's context data is shared globally. For more information, see Playbook polling.

####### Caution

* Users with Trigger Playbook permissions on a given issue may still be able to modify the parent case via commands and scripts, even without full access to the case.

##### 5.2.8.7. Lists

###### Note

* The maximum list size is 209,715 characters (approximately 200 KB).

###### 5.2.8.7.1. Create a list

####### Note

* If you want to edit a list from a content pack, you need to duplicate or detach a list. Detached lists do not receive updated content in subsequent Cortex XSIAM content releases. To retain an updated list, reattach it.

####### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

###### 5.2.8.7.2. List commands

###### 5.2.8.7.3. Use cases: JSON lists

####### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

  Investigation & Response → Automation → Playbooks → New Playbook

###### 5.2.8.7.4. Transform a list into an array

####### Navigation

  Investigation & Response → Automation → Playbooks and create or edit a playbook

##### 5.2.8.8. Jobs

###### 5.2.8.8.1. Manage jobs

####### Note

* Only Account Admins and Instance Administrator roles can create jobs and view/edit job runs. If the owner of a job has been removed from Cortex XSIAM, the job will fail to run. In this case, you must change the owner to a current user.

###### 5.2.8.8.2. Create a time triggered job

####### Note

* To view a human readable description of a cron schedule for an existing job, click  and select Job Schedule from the available columns.

####### Important

* We recommend to avoid triggering a job while a previous run of the job is active by configuring the playbook a job triggers to close the investigation before running a new instance of the job.

###### 5.2.8.8.3. Create a job triggered by a delta in a feed

####### Note

* A job triggered by a delta in a feed runs only if there is a change in the feed, and does not run on a feed's initial fetch. For the initial fetch, you can run the playbook manually and then set up an event triggered job for subsequent fetches. If you want to trigger a job after a feed completes a fetch operation and the feed does not change...

####### Navigation

  Investigation & Response → Automation → Jobs → New Job

##### 5.2.8.9. Engines

###### 5.2.8.9.1. What is an engine?

####### Note

* You cannot share a multiple-engine installation with a single-engine installation.

* When you add an engine to a load-balancing group, you cannot use that engine separately. The engine does not appear in the engines menu when configuring an integration instance, but you can choose the load-balancing group.

###### 5.2.8.9.2. Engine requirements

####### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

###### 5.2.8.9.3. Install an engine

####### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex XSIAM engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

####### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

####### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

####### 5.2.8.9.3.1. Docker

######## Note

* This section is relevant when installing an engine.

* Docker images can be downloaded together with their relevant content packs for offline installation.

######## 5.2.8.9.3.1.1. Install Docker

######### 5.2.8.9.3.1.1.1. Install Docker distribution for Red Hat on an engine server

######### 5.2.8.9.3.1.1.2. Docker image security

######### 5.2.8.9.3.1.1.3. Docker FAQs

######### 5.2.8.9.3.1.1.4. Troubleshoot Docker issues

######### 5.2.8.9.3.1.1.5. Configure Docker pull rate limit

######### 5.2.8.9.3.1.1.6. Change the Docker installation folder

######## 5.2.8.9.3.1.2. Docker hardening guide

####### 5.2.8.9.3.2. Podman

######## Note

* When upgrading an engine, the engine keeps the previously used container management type (regardless of distribution version).

######## 5.2.8.9.3.2.1. Change the container storage directory

######## 5.2.8.9.3.2.2. Install Podman

######## 5.2.8.9.3.2.3. Migrate From Docker to Podman

######## 5.2.8.9.3.2.4. Troubleshoot Podman

###### 5.2.8.9.4. Manage engines

####### Navigation

  You can manage your engines and load-balancing groups by going to Settings → Configurations → Data Broker → Engines

###### 5.2.8.9.5. Upgrade an engine

####### Note

* The upgrade.conf file is available on the engine after it has been upgraded to Cortex XSIAM 3.1. Any custom variables you add to the file are applied when you upgrade from Cortex XSIAM 3.1 to Cortex XSIAM 3.2 or later.

###### 5.2.8.9.6. Remove an engine

###### 5.2.8.9.7. Configure engines

####### Note

* A day is defined as 24 hours and may not exactly correspond to calendar days due to daylight savings, leap seconds, etc.

* In addition, to support engine upgrades from the UI, edit the /usr/local/demisto/upgrade.conf file on the engine to include the SERVER_URLS setting with the new tenant's address. Include only the host, without https:// or any additional path at the end of the host name. For example: SERVER_URLS="api-example.us.paloaltonetworks.com"

* If the engine loses communication for longer than this time, it will disconnect and you need to restart the service.

####### 5.2.8.9.7.1. Configure the engine to use a web proxy

######## Note

* You need to configure Docker to use a proxy. When using a BlueCoat proxy, ensure you encode the values correctly.

* In an environment with a single engine, go to /usr/local/demisto/upgrade.conf. In an environment with multiple engines, go to /usr/local/demisto/<engine-name>/upgrade.conf, replacing <engine-name> with the name of the engine. Note that the key is in the upgrade.conf file and must be https_proxy, even if your proxy address starts with http://.

####### 5.2.8.9.7.2. Configure the engine to call the server without using a proxy

######## 5.2.8.9.7.2.1. Use NGINX as a reverse proxy

####### 5.2.8.9.7.3. Configure an engine to use custom certificates

###### 5.2.8.9.8. Use an engine in an integration

####### Note

* Long-running integrations should not run on load-balancing groups.

###### 5.2.8.9.9. Run a script using an engine

####### Navigation

  Investigation & Response → Automation → Scripts

###### 5.2.8.9.10. Troubleshoot engines

####### Note

* Ensure that pop-ups are not blocked by your browser.

* If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom path. --keep - Extracts the installer files into the current working directory (without cleaning at the end). If using installer...

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl status d1_<Engine _name>

* Any changes made to variables in the upgrade_engine.sh file are reset after each upgrade. We recommend instead using the upgrade.conf file to set variables.

* You can ignore the following error: Cannot create folder '/var/lib/demisto'

####### Navigation

  When troubleshooting engines, access the logs from Settings → Configurations → Engines and select the engine from which you want to download the logs

###### 5.2.8.9.11. Troubleshoot integrations running on engines

####### Note

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

* Docker CE installations typically run Docker, while Docker EE installations typically run dockerroot.

#### 5.2.9. Response actions

##### Caution

* Response actions are not supported for Android endpoints.

##### 5.2.9.1. Initiate a Live Terminal session

###### Note

* You can run PowerShell 5.0 or a later release on Live Terminal of Windows.

* Network drives are not supported.

* On Windows endpoints, you cannot run GUI-based cmd commands like winver or appwiz.cpl.

* Disabling Live Terminal does not take effect on sessions that are in progress.

###### Tip

* You can fine-tune the Live Terminal session visibility on the endpoint by adjusting the User Interface options in your Agent Settings Profile.

##### 5.2.9.2. Isolate an endpoint

###### Note

* IP-based file storage protocol traffic will also be blocked. This might affect endpoint functionality if the endpoint uses such mounts.

* If file system operations become unresponsive during isolation, such as being unable to list folder content, unmount the mounted network shares.

###### Tip

* If needed, Filter the list of endpoints.

##### 5.2.9.3. Pause endpoint protection

###### Note

* Pausing your endpoint protection modules leaves your machines exposed to risks.

###### Navigation

  Investigation & Response → Response → Action Center and locate Action Type Pause Endpoint Protection or Resume Endpoint Protection

##### 5.2.9.4. Remediate changes from malicious activity

###### Prerequisite

* To initiate remediation suggestions, you must have the following system requirements: An App Administrator, Privileged Responder, or Privileged Security Admin role permissions which include the remediation permissions. EDR data collection enabled. Agent version 7.2 or above on Windows endpoints.

###### Note

* Endpoints that are part of the Case view and do not meet the required criteria are excluded from the remediation analysis.

##### 5.2.9.5. Run agent scripts on an endpoint

###### Prerequisite

* To run scripts on an endpoint, you must have the following system requirements: Endpoints running the Agent v7.1 and later. Since the agent uses its built-in capabilities and many available Python modules to execute the scripts, no additional setup is required on the endpoint. Role in the hub with the following permissions to run and configure...

###### Note

* *Since all scripts are running under System context, you cannot perform any registry operations on user-specific hives (HKEY_CURRENT_USER of a specific user).

* Always use lowercase for variable names.

* Disabling Script Execution does not take effect on scripts that are in progress.

##### 5.2.9.6. Search and destroy malicious files

###### Prerequisite

* The following are prerequisites to enable Cortex XSIAM to search and destroy files on your endpoints: Supported platforms:    Windows: Cortex XDR agent version 7.2 or a later. If you plan to enable Search and Destroy on VDI sessions, you must perform the initial scan on the Golden Image.   Mac: Cortex XDR agent version 7.3 or a later release running on...

###### Note

* The Cortex XSIAM agent does not include the following information in the local files inventory: Information about files that existed on the endpoint and were deleted before the Cortex XSIAM agent was installed. Information about files where the file size exceeds the maximum file size for hash calculations that are pre-configured in Cortex XSIAM . If...

##### 5.2.9.7. Manage external dynamic lists

###### Note

* To configure an EDL, you must have a role that includes EDL permissions, such as Instance Admin or Account Admin. Configuring custom certificates or private API Keys in the EDL integration instance is supported only on engines, not on the Cortex XSIAM server. For EDL integrations on the server, you must set a username and password. For long-running...

* The legacy external dynamic list PAN-OS integration is deprecated. Configure the EDL integration by clicking the Automation & Feed Integration link.

* If the EDL integration runs on the Cortex XSIAM server, you do not need to enter a Listen Port in the instance settings. The system auto-selects an unused port for the EDL integration when the instance is saved. If you enter a value for Listen Port, it will be overwritten by the port auto-selected by the system

###### Important

* The EDL URL must always be prefixed by ext-.

##### 5.2.9.8. Collect a memory image

###### License Type

  This functionality has the following license requirements: Forensics add-on license.

#### 5.2.10. Forensics

##### License Type

  Requires the Forensics add-on

##### 5.2.10.1. Forensic investigations

###### 5.2.10.1.1. Manage an investigation

####### 5.2.10.1.1.1. Create a new investigation

######## Note

* To set up user permissions, you must have Scope-Based Access Control (SBAC) enabled.

####### 5.2.10.1.1.2. Edit an investigation

####### 5.2.10.1.1.3. Close an investigation

######## Note

* When you close an investigation, Palo Alto Networks has a grace period of 24 hours before deleting any collections associated with the investigation. During this timeframe, you have the option to cancel the close investigation action.

####### 5.2.10.1.1.4. User permissions

######## Note

* Even if a user does not have access to view an investigation via the Forensics Investigations page, they can still query the results of the collections using an XQL query.

###### 5.2.10.1.2. Data collection

####### 5.2.10.1.2.1. Hunting

######## 5.2.10.1.2.1.1. Create a hunt

######## 5.2.10.1.2.1.2. Hunt results

######## 5.2.10.1.2.1.3. Hunt status

####### 5.2.10.1.2.2. Triage

######## 5.2.10.1.2.2.1. Create a triage

######## 5.2.10.1.2.2.2. Upload an offline triage package

######## 5.2.10.1.2.2.3. Offline triage collection

######## 5.2.10.1.2.2.4. Triage results

######## 5.2.10.1.2.2.5. Triage status

###### 5.2.10.1.3. Analysis and documentation

####### 5.2.10.1.3.1. Review alerts

####### 5.2.10.1.3.2. Investigation timeline

####### 5.2.10.1.3.3. Key assets & artifacts

###### 5.2.10.1.4. Export

####### Note

* You can export a collection more than once.

#### 5.2.11. Notebooks

##### Prerequisite

* Cortex XSIAM Notebooks usage requires the following. Cortex XSIAM Enterprise or Cortex XSIAM Premium. Apps and XQL RBAC permissions.    To use Notebooks, you must have the View/Edit permissions in Settings → Configurations → Access Management → Roles → Apps → Jupyter.   To configure Notebooks, you must have the View/Edit permissions...

##### Note

* You can only add one instance of Notebooks. Cortex XSIAM Notebooks has access to approved sites on the internet when embedded in Cortex XSIAM. The Notebooks instance includes restart options.

##### Navigation

  Settings → Configurations → Integrations → Apps

  To edit the Notebooks instance, from Settings → Configurations → Integrations → Apps, hover over the instance and select the edit icon

##### 5.2.11.1. Manage datasets in Notebooks

###### Note

* If a schema is not provided, the function detects the schema automatically.

* Using this function, you can only delete datasets created using the Notebooks APIs . When you delete a dataset, the rules that use the dataset return an error.

##### 5.2.11.2. Notebooks scheduler

#### 5.2.12. Build XQL queries

##### 5.2.12.1. About the Query Builder

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

##### 5.2.12.2. How to build XQL queries

###### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

###### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

###### 5.2.12.2.1. Get started with XQL queries

####### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

###### 5.2.12.2.2. Useful XQL user interface features

####### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

###### 5.2.12.2.3. XQL Query best practices

###### 5.2.12.2.4. Expected results when querying fields

###### 5.2.12.2.5. Create XQL query

####### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

###### 5.2.12.2.6. Review XQL query results

####### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* In order for Cortex XSIAM to provide a histogram for a field, the field must not contain an array or a JSON object.

###### 5.2.12.2.7. Translate to XQL

####### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

###### 5.2.12.2.8. Graph query results

####### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### 5.2.12.3. Query Builder templates

###### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

###### 5.2.12.3.1. Get started with Query Builder templates

###### 5.2.12.3.2. Considerations for using Query Builder templates

###### 5.2.12.3.3. Create a query from a template

####### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

###### 5.2.12.3.4. Run a free text query

####### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

###### 5.2.12.3.5. Query Builder template examples

####### Navigation

  Investigation & Response → Search → Query Builder

##### 5.2.12.4. Edit and run queries in Query Center

###### Navigation

  Investigation & Response → Search → Query Center

###### 5.2.12.4.1. Query Center reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 5.2.12.5. Manage scheduled queries

###### Navigation

  Investigation & Response → Search → Scheduled Queries

###### 5.2.12.5.1. Scheduled Queries reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 5.2.12.6. Manage your personal query library

###### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

##### 5.2.12.7. Legacy Query Builder

###### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

###### 5.2.12.7.1. Create authentication query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 5.2.12.7.2. Create event log query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 5.2.12.7.3. Create file query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 5.2.12.7.4. Create image load query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 5.2.12.7.5. Create network connections query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 5.2.12.7.6. Create network query

####### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

###### 5.2.12.7.7. Create process query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 5.2.12.7.8. Create registry query

####### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

###### 5.2.12.7.9. Query across all entities

####### Navigation

  Investigation & Response → Search → Query Builder

#### 5.2.13. Research a known threat

### 5.3. Threat management

#### 5.3.1. Enable prompt log collection in Azure

#### 5.3.2. Detection rules

##### 5.3.2.1. What are detection rules?

###### 5.3.2.1.1. What's an IOC?

####### Note

* Cortex XSIAM supports a maximum of 4,000,000 IOCs.

####### 5.3.2.1.1.1. IOC rule details

######## Note

* Field cannot exceed 36 characters.

######## Navigation

  In the Threat Management → Detection Rules → IOC page, you can view all configured or uploaded indicators of compromise (IOCs

####### 5.3.2.1.1.2. Create an IOC rule

######## Note

* To ensure your IOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically does the following: Disables any IOC rules that reach 5000 or more hits over 24 hours. Creates a rule exception based on the PROCESS SHA256 field for IOC rules that hit more than 100 endpoints over 72 hours. If you have the Threat...

######## Navigation

  In Threat Management → Detection Rules → IOC, select + Add IOC

###### 5.3.2.1.2. What's a BIOC?

####### 5.3.2.1.2.1. BIOC rule details

######## Navigation

  Manage your behavioral indicator of compromise (BIOC) rules in Threat Management → Detection Rules → BIOC

####### 5.3.2.1.2.2. Create a BIOC rule

######## License Type

  Custom prevention rules are supported on Cortex XSIAM agent 7.2 and later versions and enable you to configure and apply user-defined BIOC rules to Restriction profiles deployed on your Windows, Mac, and Linux endpoints.

######## Note

* To ensure your BIOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically does the following: Disables BIOC rules that reach 5000 or more hits over a 24-hour period. Creates a rule exception based on the PROCESS SHA256 field for BIOC rules that hit more than 100 endpoints over a 72 hour period.

* A cloud_audit_log dataset requires a Cortex XDR Pro per GB license. Currently, you cannot create a BIOC rule on customized datasets and only the filter stage, alter stage, and functions without any aggregations are supported for XQL queries that define a BIOC. For BIOC rules, the field values in XQL are evaluated as case insensitive (config...

* To demonstrate the expected behavior of the rule before you save it, Cortex XSIAM tests the BIOC on historical logs. After you save a BIOC rule, it will operate both on historical logs (up to 10,000 hits) and on new data received from your log sensors.

* To demonstrate the expected behavior of the rule before you save it, Cortex XSIAM tests the BIOC on historical logs. After you save a BIOC rule, it will operate on both historical logs (up to 10,000 hits) and new data received from your log sensors.

* You can only import files that were exported from Cortex XSIAM. You can not edit an exported file.

* You can only add to existing profiles you created, Cortex XSIAM Default profiles will not appear as an option.

* Auto-disable will turn off both the BIOC rule detection and the BIOC prevention rule.

####### 5.3.2.1.2.3. Manage Global BIOC Rules

###### 5.3.2.1.3. What's a correlation rule?

####### Navigation

  After you configure your correlation rules, you can manage them in Threat Management → Detection Rules → Correlations, and view and analyze the generated issues in Cases and the Issues Table

####### 5.3.2.1.3.1. Correlation rule details

######## Note

* Only an administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM .

* For more information on troubleshooting server errors in scheduled correlation rules, Troubleshoot server errors in scheduled correlation rules.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

######## Navigation

  If you are assigned a role that enables Investigation → Rules privileges, you can manage all user-defined Correlation Rules from Threat Management → Detection Rules → Correlations

####### 5.3.2.1.3.2. Create a correlation rule

######## Prerequisite

* To enable pivots from issues to a third-party source system, ensure that you know the dataset field name which contains the URL of the source system. Some vendors already provide this URL as part of their API, and you can find it in the third-party product dataset. If there is no URL, you cannot enable this feature.

######## Note

* When creating a Real Time Correlation Rule, you can only generate an issue as the resulting action for the Correlation Rule. All other options are disabled. To ensure your Correlation rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically disables Correlation rules that reach 5000 or more hits over a...

* When you open the New Correlation Rule editor from XQL Search, this XQL Search field is already populated with the XQL query that you defined. An administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM . All other users can only create and view queries built with an existing dataset.

* The XQL features for call, top, and wildcards in datasets (dataset in (<dataset prefix>_*)) are currently not supported in Correlation Rules. If you add them to the XQL definition, you will not be able to Create or Save the Correlation Rule. The XQL features for transaction in datasets (dataset in (<dataset prefix>_*)) are currently not supported in...

* The incident that contains the issues will also be assigned to the selected domain. For more information, see Case and issue domains. If you want to generate a health issue, choose the Health domain. For more information about health issues, see About health issues.

* If a generated issue has severity Medium or above, a case is automatically opened. Low severity issues generated by correlation rules are not grouped into cases.

* There is no validation or auto complete for these parameters and the values can be null or empty. In these scenarios, Cortex XSIAM does not display the null or empty values, but adds the text NULL or EMPTY in the descriptions.

* When more than one XDM field is listed, Cortex XSIAM looks for the field value according to the order of the fields listed.

* When Use the Cortex XSIAM default incident enrichment is not selected and you have not mapped any issue fields, the issue is dispatched into a new incident.

######## Important

* The maximum size of a lookup dataset is 50 MB. If the data exceeds this limit, the add to lookup action fails.

######## Tip

* When creating your correlation rule, you can use predefined values for different fields in the editor, such as Alert Name, Alert Description, and Drill-Down Query. For more information, Field replacement syntax in correlation rules.

######## Navigation

  You can create a new correlation rule from either the Threat Management → Detection Rules → Correlation Rules page or when building a query in XQL Search

####### 5.3.2.1.3.3. Field replacement syntax in correlation rules

####### 5.3.2.1.3.4. Manage correlation rules

######## Note

* Execute Rule is not available for real time correlation rules.

####### 5.3.2.1.3.5. Monitor correlation rules

######## Note

* In the dataset, the Query start time and Query end time indicate the time frame of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

####### 5.3.2.1.3.6. Troubleshoot server errors in scheduled correlation rules

###### 5.3.2.1.4. Manage IOC and BIOC rules

####### Note

* For Analytics BIOC rules, you can only disable and enable rules.

* You cannot delete global BIOCs delivered with content updates.

* For BIOC rules that are applied to prevention profiles: If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention on the agent works as usual. If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention...

* When a BIOC rule is disabled automatically by Cortex XSIAM, for example due to the server anti flooding mechanism, prevention on the agent works as before.

####### Navigation

  Threat Management → Detection Rules → BIOC

#### 5.3.3. Analytics

##### 5.3.3.1. Analytics engine

##### 5.3.3.2. Analytics sensors

##### 5.3.3.3. Coverage of MITRE Attack tactics

##### 5.3.3.4. Review MITRE ATT&CK framework coverage

###### Note

* When a contributing data source type is active, it does not imply that all the rules and detectors associated with the data source type are active. Rule applicability is dependent on the data source's context and configuration. To enable an active status, data source types require the following setup: Endpoint: Installed Cortex XDR agent. Network: A...

##### 5.3.3.5. Analytics detection time intervals

###### Note

* When establishing a baseline, detectors compute limits beyond which network activity will require an issue. In some cases, detectors do not compute baseline limits; instead they are predetermined by Cortex XSIAM engineers. The engineers determine the values used for predetermined limits using statistical analysis of malicious activity recorded...

##### 5.3.3.6. Analytics issues and Analytics BIOCs

##### 5.3.3.7. View and manage Analytics rules

##### 5.3.3.8. Identity Analytics

###### Navigation

  After configuring your Cloud Identity Engine instance and Cortex XSIAM Analytics, select Settings () → Configurations → Cortex XSIAM - Analytics, and in the Featured in Analytics section, Enable Identity Analytics

##### 5.3.3.9. Identity Threat Module (ITDR)

##### 5.3.3.10. AI Detection & Response in Cortex XSIAM (Beta)

###### Prerequisite

* To enable AIDR, you must have one of the following user roles: Instance Admin or Account Admin.

###### Navigation

  Settings → Configurations → Cortex - Analytics

###### 5.3.3.10.1. Data sources and supported services

###### 5.3.3.10.2. AI Detection & Response Dashboard

###### 5.3.3.10.3. Collect prompt logs

####### 5.3.3.10.3.1. Prompt log collection in AWS

####### 5.3.3.10.3.2. Enable prompt log collection in Azure

######## 5.3.3.10.3.2.1. Configure the Azure Event Hub collection in Cortex XSIAM

######## 5.3.3.10.3.2.2. Set up prompt logging

######## 5.3.3.10.3.2.3. Log HTTP data

######## 5.3.3.10.3.2.4. Configure diagnostic settings:

#### 5.3.4. Threat Intel Management

##### 5.3.4.1. Get started with Threat Intel Management

###### Note

* By default, the Palo Alto Networks Wildfire Reports integration, which is used as part of the sample analysis feature, is installed and configured. The Palo Alto Networks Wildfire v2 integration, for dynamic malware analysis, is also installed, but you must add an integration instance. No API key is required.

###### 5.3.4.1.1. What is Threat Intel Management?

###### 5.3.4.1.2. Threat Intel Management use cases

####### Navigation

  Settings → Configurations → Data Collections → Automation & Feed Integrations and in the Category field, select Threat Intel Feeds

###### 5.3.4.1.3. Roles and responsibilities in Threat Intel Management

###### 5.3.4.1.4. Indicator concepts

####### Note

* You can store up to 100,000,000 indicators.

###### 5.3.4.1.5. Indicator lifecycle

####### Note

* To run enhancement scripts and reputation commands, you must configure a relevant enrichment integration, such as VirusTotal, IPinfo v2, etc.

####### Tip

* We recommend defining your policy for handling expired indicators.

##### 5.3.4.2. Indicator configuration

###### 5.3.4.2.1. Customize indicator fields and types

####### 5.3.4.2.1.1. Create an indicator type

######## Note

* If you miss mapping any field, you can create additional new indicator fields and either relate them to all indicator types, or relate them only to the new indicator type (recommended).

######## Navigation

  Settings → Configurations → Object Setup → Indicators → Types

######## 5.3.4.2.1.1.1. Indicator type profile

######## 5.3.4.2.1.1.2. File indicators

######## 5.3.4.2.1.1.3. Formatting scripts

######## 5.3.4.2.1.1.4. Enhancement scripts

######## 5.3.4.2.1.1.5. Reputation scripts

######## 5.3.4.2.1.1.6. Reputation commands

######## 5.3.4.2.1.1.7. Map custom indicator fields

####### 5.3.4.2.1.2. Create an indicator field

######## Note

* Cortex XSIAM IOC fields are based on the STIX 2.1 specifications. For more information, see Indicator field structure.

* The following HTML tags are not permitted: blockquote, del, dd, div, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, iframe, ins, li, math, noscript, ol, pre, p, script, style, table, ul, address, article, aside, canvas, details, dialog, figcaption, figure, footer, header, hgroup, main, nav, output, progress, section, video. The following CSS tags...

######## Navigation

  Settings → Configurations → Object Setup → Indicators → Fields → New Field

######## 5.3.4.2.1.2.1. Indicator field structure

######## 5.3.4.2.1.2.2. Indicator field trigger scripts

###### 5.3.4.2.2. Indicator classification and mapping

####### Note

* When creating a new indicator type, you classify and map the indicator fields in the indicator type settings. For more details, see Map custom indicator fields.

* You can optionally skip importing data. Click the pencil on the right of each indicator type on the right pane to enter the value manually.

* In the Classification & Mapping page, the mapping does not indicate for which indicator types they are configured. When creating a mapper, it is best practice to add to the mapper name and the indicator type the mapper is for. For example, Mail Listener - Phishing. When mapping a list, we recommend you map to a multi-select field. Short text fields do...

###### 5.3.4.2.3. Indicator extraction

####### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Reputation commands, such as !ip and !domain, can only be used after you configure and enable a reputation integration instance, such as VirusTotal and Whois.

* The inline configuration may delay playbook execution.

* While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks. All indicators are automatically extracted and enriched before a playbook is run. For an on-field change, extraction occurs before the next playbook tasks run.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

####### 5.3.4.2.3.1. Set the indicator extraction mode for a playbook task

####### 5.3.4.2.3.2. Disable indicator extraction for scripts or integrations

###### 5.3.4.2.4. Configure indicator expiration

####### Note

* You need to run CLI commands in the Case or Issue War Room.

* If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its expiration method reverts to that of the indicator type (time-based). Time-based expiration is set according to feed reliability. If the same indicator appears on multiple feeds, the...

###### 5.3.4.2.5. Configure Threat Intelligence feed integrations

####### Note

* Some feeds only provide information about new indicators and do not specify when indicators are removed. Indicators from these feeds cannot be automatically expired on removal. If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its...

###### 5.3.4.2.6. Exclude indicators from enrichment

###### 5.3.4.2.7. Generate issues from indicators using indicator rules for prevention and detection

####### Note

* Indicators should be present in the Threat Intelligence database (Threat Management → Threat Intelligence → Indicators) before creating detection and prevention rules.

* Although you can create IOC rules for detection, indicator rules are designed to leverage threat intelligence indicators like MD5 and SHA256 hashes that are present in your TIM library. These rules directly integrate with and rely on the indicators ingested and managed by TIM. Indicators must be in the TIM database before creating these rules. For more...

* You can't change the Preventable = True, Status = Active and Type = File filters, which comply with the requirements of the supported indicator type for Prevention on the Agent.

* The Indicator Rule shows the number of issues generated by the rule, You can view the issues that were generated using the Indicator rule, by right-clicking the rule and select View related issues.

* You can't change the Detectable = True and Status = Active filters, which comply with the requirements of the supported indicator type for detection.

* The Issue source is Threat Intelligence.

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

###### 5.3.4.2.8. Export indicators

####### Caution

* You should not run a query on a field that you might change in the playbook flow. For example, you shouldn't have a playbook with query Verdict:Malicious and then change the indicator verdict as a part of the playbook.

##### 5.3.4.3. Indicator management

###### Note

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

##### 5.3.4.4. Query indicators with Unit 42 Intel data

###### Note

* You can search or look up indicators. A search, which can include wildcards and complex queries, can return multiple results. Searches are only performed in Cortex XSIAM. Lookups are exact values, are performed in both Cortex XSIAM and Unit 42 Intel data, and can only return one result.

##### 5.3.4.5. Indicator investigation

###### 5.3.4.5.1. Indicator verdict

###### 5.3.4.5.2. Extract and enrich an indicator

####### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Triggering enrichment on a substantial number of indicators can take time (because it's activating all enrichment integrations per indicator) and can result in performance degradation.

* Reputation commands, such as !ip, !domain can only be used when you configure and enable a reputation integration instance, such as VirusTotal and WHOIS.

###### 5.3.4.5.3. Expire an indicator

####### Note

* You need to run these commands in the Case or Issue War Room.

###### 5.3.4.5.4. Manage indicator relationships

####### Note

* You can also add an indicator relationship from the Quick View when selecting an indicator from an issue.

###### 5.3.4.5.5. Delete and exclude indicators

####### Caution

* Ensure you are using the correct syntax when defining the values for your exclusion lists.

###### 5.3.4.5.6. Investigate files using sample analysis

####### Note

* WildFire provides verdicts and analysis reports without requiring a license key. To send files to WildFire for analysis, see Set up Malware Prevention Profiles.Set up malware prevention profiles

* When searching on the Sample Analysis page for relationships -relationships"", some results may appear without their specific relationships listed, due to internal relationship permissions.

###### 5.3.4.5.7. Use sessions and submissions in your investigation

####### Note

* When searching on the Sessions & Submissions page for relationships -relationships"", some results may appear without their specific relationships listed, due to internal relationship permissions.

* The Application is matched to the type of application traffic detected in a session. For example, a search for the Application web-browsing returns sessions during which web browsing over HTTP occurred. See Applipedia for an updated list of applications that Palo Alto Networks identifies.

### 5.4. Inventory management

#### 5.4.1. Asset management

##### 5.4.1.1. All Assets

###### Note

* Keep the following caveats in my mind when working with the Asset Inventory page: Instance Administrators are able to view all Inventory views without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope SBAC is not currently available for custom roles with View/Edit permissions on the...

* The options available are dependent on your license.

###### 5.4.1.1.1. Container Images

####### Navigation

  All Assets → Compute → Container Images

###### 5.4.1.1.2. Kubernetes Cluster

####### Navigation

  Inventory → All Assets → Compute → Kubernetes Cluster for a Kubernetes clusters assets overview

###### 5.4.1.1.3. Container Instances

####### Navigation

  Asset Inventory → Compute → Container Instances

###### 5.4.1.1.4. External Surface assets

####### License Type

  Requires the Attack Surface Management (ASM) add-on

####### 5.4.1.1.4.1. External Surface attribution evidence

##### 5.4.1.2. Network configuration

###### 5.4.1.2.1. Configure your network parameters

####### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

* Viewing external IP address ranges requires the Attack Surface Management add-on.

####### Navigation

  In Cortex XSIAM , select Assets → Network Configuration → Internal Domain Suffixes

##### 5.4.1.3. Asset Groups

###### Note

* When you create or edit an Asset Group, the changes are applied immediately to new assets and to existing assets that have been updated. However, it may take a few hours for the changes to appear on existing assets that have not been updated.

###### Navigation

  Inventory → Assets → Groups → Add Group

##### 5.4.1.4. Asset Roles

###### Note

* Asset Roles are available only if the Identity Threat Module add-on is enabled.

###### 5.4.1.4.1. Manage Asset Roles for Endpoints

####### Note

* Endpoint Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added endpoint removes the endpoint from the Included Endpoints list. If this endpoint is detected automatically as having this asset role in the future, it will appear in the Included Endpoints list. Excluding a manually added endpoint ensures that even if in the future the endpoint is detected as having this asset role, this...

###### 5.4.1.4.2. Manage Asset Roles for Users

####### Note

* User Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added user removes the user from the Included Users list. If this user is detected automatically as having this asset role in the future, it will appear in the Included Users list again. Excluding a manually added user ensures that even if in the future the user is detected as having this asset role, this detection is overridden and...

####### 5.4.1.4.2.1. Honey user

######## Prerequisite

* The honey user role is available only if the Identity Threat Module add-on is enabled.

##### 5.4.1.5. Manage Asset Scores

###### Note

* The Hosts tab is available if the Identity Threat Module add-on is enabled.

* As new alerts are associated with incidents, the User and Host Scores are recalculated. You can view the latest User and Host Scores on the Asset Scores page, or track the Score trend on the User Risk View and Host Risk View.

* Some User Associated Insights may not appear as part of the User Associated Incidents due to the insight generation mechanism. For example, when an insight related to one of the assets in an incident is generated a few days after the associated incident, the insight may not be associated with the incident.

##### 5.4.1.6. Vulnerability Assessment

###### Prerequisite

* The following are prerequisites for Cortex XSIAM to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XSIAM lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex XSIAM...

* The following are prerequisites for Cortex XSIAM to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex XSIAM collects all the information about the operating system and the installed...

###### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex XSIAM Application Inventory.

###### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

###### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

### 5.5. Modules

#### 5.5.1. Discovery Engine

##### 5.5.1.1. What is the Discovery Engine?

###### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM product that has the Cloud Runtime Security or Cloud Posture Management add-ons.

#### 5.5.2. Cortex Cloud AI Security

##### 5.5.2.1. What is Cortex Cloud AI Security?

##### 5.5.2.2. Supported services in Cortex Cloud AI Security

##### 5.5.2.3. Cortex Cloud AI Security concepts

##### 5.5.2.4. Cortex Cloud AI Security use cases

##### 5.5.2.5. How to perform advanced AI Security investigations using XQL

###### Note

* For more information, see Build XQL queries.Build XQL queries

#### 5.5.3. Cortex Cloud Application Security

##### 5.5.3.1. Application Security Posture Management (ASPM)

###### 5.5.3.1.1. ASPM use cases

###### 5.5.3.1.2. ASPM key features

###### 5.5.3.1.3. ASPM user roles and permissions

####### Navigation

  You can view AppSec Admin permissions in the tenant by navigating to Settings → Configurations → Roles → AppSec Admin

###### 5.5.3.1.4. ASPM Command Center

####### 5.5.3.1.4.1. ASPM Command Center workflow

######## Note

* Breakdown by type: Issues are further broken down by type (such as IAC or Secrets).

###### 5.5.3.1.5. Coverage

####### 5.5.3.1.5.1. Coverage in the user interface

######## Navigation

  Modules, → Application Security → AppSec Coverage

###### 5.5.3.1.6. Backlog baseline

####### 5.5.3.1.6.1. Backlog use cases

####### 5.5.3.1.6.2. Issue/Finding classification by scanner

######## Note

* In some cases/vendors, this is not accurate as findings are deleted every time new findings are uploaded. In such cases, the feature may not be accurate or supported For SAST, the vendor does not support policy in pull requests

* Scanner updates and new detections: When a security scanner is updated to support new languages, detection rules, or capabilities, any issues discovered by these new features for existing code are classified as part of the backlog.

####### 5.5.3.1.6.3. Using Backlog

###### 5.5.3.1.7. Applications

####### 5.5.3.1.7.1. How to build an application

######## Prerequisite

* Before you begin, ensure you have connected the necessary data sources. Refer to Onboard data sources for more information.

######## Note

* These filters are represented by icons displayed on the Code pane after selecting a VCS.

* To edit application assets, click the Clear All icon before clicking Finish. This clears all application data, allowing you to restart the application building process from the beginning.

####### 5.5.3.1.7.2. Application management and visibility

####### 5.5.3.1.7.3. Business application assets

######## 5.5.3.1.7.3.1. Business application expanded asset details

###### 5.5.3.1.8. Repositories as assets

####### 5.5.3.1.8.1. Explore repository assets

####### 5.5.3.1.8.2. In-depth repository asset information

####### 5.5.3.1.8.3. Manage Repository assets

####### 5.5.3.1.8.4. Export Software Bill of Materials (SBOM)

####### 5.5.3.1.8.5. Manage issues detected in repositories

######## Note

* You can also find the repository issues in the general issue inventory table, and in the dedicated inventory of issues for each scanner type (see step 4 above for details).

###### 5.5.3.1.9. Onboard data sources

####### 5.5.3.1.9.1. Onboard version control systems

######## Note

* Application Security (which includes IaC and Secrets scanning), is an add-on to a license (such as Posture Security) that must be purchased separately.

* Disclaimer: When onboarding with third-party data sources, we outline the required steps for setup, but we do not monitor these external resources, and they may change over time. Always refer to the relevant third-party documentation for the most current integration steps.

######## Tip

* Navigate to Settings → Data Sources (under Data Collections) → + Data Source → enter your VCS data source in the search bar.

######## 5.5.3.1.9.1.1. AWS CodeCommit

######## 5.5.3.1.9.1.2. Azure Repos

######## 5.5.3.1.9.1.3. Bitbucket Cloud

######## 5.5.3.1.9.1.4. Bitbucket Data Center

######## 5.5.3.1.9.1.5. GitHub Cloud

######## 5.5.3.1.9.1.6. GitHub Server

######## 5.5.3.1.9.1.7. GitLab SaaS

######## 5.5.3.1.9.1.8. GitLab self-managed

####### 5.5.3.1.9.2. Onboard CI/CD systems

######## 5.5.3.1.9.2.1. Onboard CircleCI for CI/CD pipeline scans

######## 5.5.3.1.9.2.2. Onboard Jenkins for CI/CD pipeline scans

####### 5.5.3.1.9.3. Integrate CI tools

######## Note

* For CircleCI CI/CD pipeline scans, refer to CI/CD .

* For Jenkins CI/CD pipeline scans, refer to CI/CD .

######## Navigation

  Settings → Data Sources → hover over a CI tool and click View Details

  Delete an instance: Right-click on an instance of the CI tool → Delete instance → Delete

######## 5.5.3.1.9.3.1. AWS CodeBuild

######## 5.5.3.1.9.3.2. Onboard CircleCI for code scans

######## 5.5.3.1.9.3.3. Connect Cortex CLI

######## 5.5.3.1.9.3.4. GitHub Actions

######## 5.5.3.1.9.3.5. Onboard Jenkins for code scans

######## 5.5.3.1.9.3.6. Onboard Terraform Cloud (Run Tasks)

######## 5.5.3.1.9.3.7. Onboard Terraform Enterprise (Run Tasks)

####### 5.5.3.1.9.4. CLI pipeline code snippets

####### 5.5.3.1.9.5. Ingest third-party data

######## Note

* Only onboarded and scanned repositories can be mapped.

######## 5.5.3.1.9.5.1. Ingest Veracode SAST data

######## 5.5.3.1.9.5.2. Ingest SonarQube SAST data

######## 5.5.3.1.9.5.3. Ingest Semgrep data

######## 5.5.3.1.9.5.4. Generic 3rd Party AppSec Collector

######### 5.5.3.1.9.5.4.1. Onboard the 3rd Party AppSec Collector

####### 5.5.3.1.9.6. Manage data source integrations

######## Navigation

  Settings → Data Sources → use the search bar to locate the required data source

###### 5.5.3.1.10. Transporter over Broker VM

####### Prerequisite

* Ensure you have the necessary permissions and have already set up your Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex XSIAM resources. The IP addresses for the Transporter are in the Broker VM Resources section of the Enable access to required PANW resources document Open port 4052 (inbound), which...

####### Note

* The broker enables multiple connections, allowing a single Transporter applet to connect to various VCS instances Multiple Transporter applets cannot be created on a single Broker VM. Each Broker VM is limited to a single Transporter applet instance

####### Warning

* The Transporter applet is not supported for FedRAMP customers.

####### 5.5.3.1.10.1. Setup a Transporter applet on Broker VM

######## Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator)

######## Note

* You cannot add a Transporter applet through Clusters.

######## Navigation

  your AppSec Transporter under the App column → Configure → Add Connection (on the redirected AppSec Transporter setup page

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

####### 5.5.3.1.10.2. Setup a Transporter on your VCS

######## Prerequisite

* Ensure you have user permissions to onboard data sources  Note The dedicated AppSec Admin role includes the required permissions. Ensure you have user permissions to onboard data sources Before you begin you must setup a Transporter applet on your Broker VM. Refer to Setup a Transporter applet on Broker VM for more information

######## Note

* GitLab Enterprise webhook internal IP restriction: GitLab Enterprise's security policies prevent webhook subscriptions to internal IP addresses (such as broker addresses). These subscriptions can only be enabled through specific instance configuration. For more information, refer to https://docs.gitlab.com/security/webhooks/.

######## Navigation

  Settings → Data Sources → + Add Data Source → select your VCS on-premises data source

###### 5.5.3.1.11. Manage 3rd party findings and generated issues

###### 5.5.3.1.12. Manage code weaknesses

####### Note

* You can customize policies to define which findings are categorized as issues.

####### Tip

* You can also view SAST CWE issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Code Weaknesses tab under the Repositories asset inventory. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset...

####### Navigation

  To access SAST code violation issues, under Modules, select Application Security → Issues → Code Weaknesses

####### 5.5.3.1.12.1. Code weaknesses issue inventory

####### 5.5.3.1.12.2. Expanded code weaknesses issue information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 5.5.3.1.12.3. SAST code weakness findings

######## Note

* Findings on the Cortex XSIAM platform are not intended for direct action; but rather represent data collected by the platform. They must be promoted to issues to enable mitigation efforts to secure your codebase.

##### 5.5.3.2. CI/CD Security

###### 5.5.3.2.1. CI/CD Security user roles and permissions

###### 5.5.3.2.2. CI/CD Assets

####### 5.5.3.2.2.1. CI/CD Instances as assets

######## 5.5.3.2.2.1.1. Explore CI/CD Instance assets

######## 5.5.3.2.2.1.2. In-depth CI/CD pipeline instance asset information

######## 5.5.3.2.2.1.3. Manage CI/CD pipeline instances

####### 5.5.3.2.2.2. CI/CD Pipelines as assets

######## 5.5.3.2.2.2.1. Explore CI/CD Pipeline assets

######## 5.5.3.2.2.2.2. In-depth CI/CD pipeline asset information

######## 5.5.3.2.2.2.3. Manage CI/CD pipeline assets

####### 5.5.3.2.2.3. Version Control System (VCS) Organizations as assets

######## 5.5.3.2.2.3.1. Explore VCS Organization assets

######## 5.5.3.2.2.3.2. In-depth VCS Organization asset information

######## 5.5.3.2.2.3.3. Manage VCS organization assets

####### 5.5.3.2.2.4. VCS Collaborators-as-assets

######## 5.5.3.2.2.4.1. In-depth Collaborator asset information

######## 5.5.3.2.2.4.2. Manage Collaborator assets

###### 5.5.3.2.3. Supply Chain tools

####### Note

* Rejected does not mean the tool is not in use. It allows application security practitioners to search for and remove these tools as needed For information about changing the tool status, refer to Overview

####### 5.5.3.2.3.1. Supply Chain use cases

######## Navigation

  To access Supply Chain Tools, select Modules → Application Security → Supply Chain Tools (under 3rd Party Tools

####### 5.5.3.2.3.2. Explore Supply Chain tools

####### 5.5.3.2.3.3. Expanded Supply Chain tool information

######## Note

* AppSec Admin user permissions are required to perform these actions.

###### 5.5.3.2.4. CI/CD Risks

####### Note

* Application Security CI/CD pipeline scans create a comprehensive inventory of all CI/CD pipelines in your environment. For more information refer to CI/CD Pipelines as assets.

####### 5.5.3.2.4.1. CI/CD pipeline issues

######## Navigation

  To access CI/CD pipeline risks issues, under Modules, select Application Security → Issues → CI/CD Risks

####### 5.5.3.2.4.2. Expanded CI/CD risks issue information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 5.5.3.2.4.3. VCS and CI/CD pipeline risk findings

###### 5.5.3.2.5. CI/CD Rules

####### Note

* Out-of-the-box rules cannot be modified Custom CI/CD rules are not supported

####### 5.5.3.2.5.1. CI/CD rules roles and permissions

####### 5.5.3.2.5.2. CI/CD rules inventory

######## Navigation

  In the Filter panel, select Category → Scanner → CI/CD Security

####### 5.5.3.2.5.3. Create custom CI/CD rules

######## Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

####### 5.5.3.2.5.4. Manage CI/CD rules

###### 5.5.3.2.6. CI/CD Policies

####### 5.5.3.2.6.1. CI/CD policies user roles and permissions

####### 5.5.3.2.6.2. CI/CD policies inventory

####### 5.5.3.2.6.3. Create custom CI/CD policies

######## Note

* PR Scan and CI Scan triggers are automatically disabled and unchecked. They can only be enabled if other scan types (that is non-CI/CD risk scans such as Secrets) are also selected, and will only run on non-CI/CD risks types of scans

* You can combine multiple conditions to create complex rules for when the policy should apply. Create conditions that apply to a CI/CD policy which detects high severity CI/CD risks on GitHub: Select Add Filter → Finding Type → CI/CD Risks → AND → Provider → [VCS/CI/CD system] → AND → Severity: → High.

* SBAC scope limitations do not apply to Matching Criteria For CI/CD policies, you can filter Matching Criteria by VCS Organization Name, CI/CD Pipeline [Name/ID], CI/CD Instance [Name/ID] or Collaborator [Name/Email/MFA Enabled/Last Observed]

####### 5.5.3.2.6.4. Manage CI/CD policies

######## Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

###### 5.5.3.2.7. CI/CD Compliance

####### Navigation

  To access Compliance, select Posture Management → Compliance → Reports or Assessment

####### 5.5.3.2.7.1. Create CI/CD compliance reports

######## Note

* The CI/CD module supports GitHub and GitLab providers.

* For more information about about Asset Groups, refer to Asset Groups.

* CIS GitLab Benchmark, CIS GitHub Benchmark, and the OWASP Top 10 CI/CD Risks standards are supported.

* For more information about assessment profiles, refer to Use an assessment profile to run compliance checks on your assets.Use an assessment profile to run compliance checks on your assets

######## Navigation

  Posture Management → Compliance → Assessment or Reports

##### 5.5.3.3. Code Security

###### 5.5.3.3.1. Code Security user roles and permissions

###### 5.5.3.3.2. Code Security assets

###### 5.5.3.3.3. Software packages as assets

####### 5.5.3.3.3.1. In-depth software package asset information

###### 5.5.3.3.4. Infrastructure-as-Code (IaC) resources as assets

####### 5.5.3.3.4.1. Explore IaC assets

######## Navigation

  To access IaC assets, under Inventory, select All Assets → Code → IaC Resources

####### 5.5.3.3.4.2. In-depth IaC resource asset information

###### 5.5.3.3.5. Code Security scanners

###### 5.5.3.3.6. Software Composition Analysis (SCA ) scanners

####### 5.5.3.3.6.1. Supported Software Composition Analysis (SCA) frameworks and languages

####### 5.5.3.3.6.2. Software Composition Analysis (SCA) CVE vulnerability issues

######## Tip

* You can also view SCA vulnerabilities in dedicated tabs under other sections when available: In Asset inventories, navigate to Inventory → All Assets → Code:    On the Vulnerabilities tab under Repositories. Refer to In-depth repository asset information for more information Under the All Code inventory: Select an asset from the table →...

######## Navigation

  To access CVE vulnerability issues, under Modules, select Application Security → Issues → Vulnerabilities

######## 5.5.3.3.6.2.1. SCA CVE vulnerabilities inventory

######## 5.5.3.3.6.2.2. Expanded CVE vulnerabilities issue information

######## 5.5.3.3.6.2.3. CVE vulnerabilities findings

######## 5.5.3.3.6.2.4. Manage SCA CVE vulnerability issues

####### 5.5.3.3.6.3. License miscompliance issues

######## Tip

* You can also view license miscompliance issues in dedicated tabs under other sections when available: In Application asset inventories: navigate to Inventory → All Assets →  Application → select an option from the Application menu → select an item from the inventory → Package Integrity In Asset inventories, navigate to Inventory → All...

######## Navigation

  To access license miscompliance issues, under Modules, select Application Security → Issues → Licenses

######## 5.5.3.3.6.3.1. License miscompliance issues inventory

######## 5.5.3.3.6.3.2. Expanded License miscompliance issues information

######## 5.5.3.3.6.3.3. License miscompliance findings

######## 5.5.3.3.6.3.4. Open-source software license categories

######## 5.5.3.3.6.3.5. Manage license miscompliance issues

####### 5.5.3.3.6.4. Package Integrity

######## 5.5.3.3.6.4.1. Package Integrity issues inventory

######## 5.5.3.3.6.4.2. Expanded Package Integrity issues inventory information

######## 5.5.3.3.6.4.3. Package Integrity findings

######## 5.5.3.3.6.4.4. Manage Package Integrity issues

###### 5.5.3.3.7. Secrets scanners

####### 5.5.3.3.7.1. Secrets issues

######## Tip

* You can also view Secrets issues in dedicated tabs under other sections when available: In Code asset inventories: navigate to Inventory → All Assets → Code:    On the Secrets tab under Repositories. Refer to In-depth repository asset informationfor more information   Under the All Code inventory: Select an asset from the table → Secrets In Code...

######## Navigation

  Under Modules, select Application Security → Issues → Secrets

####### 5.5.3.3.7.2. Secrets issues inventory

####### 5.5.3.3.7.3. Expanded Secrets issue information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 5.5.3.3.7.4. Secrets findings

######## Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

######## Navigation

  To access Secrets findings, select Application Security → Issues → Secrets → click the Findings tab

####### 5.5.3.3.7.5. Manage Secrets issues

###### 5.5.3.3.8. Infrastructure as Code (IaC) scanners

####### 5.5.3.3.8.1. Supported frameworks and languages

####### 5.5.3.3.8.2. IaC misconfiguration issues

######## Tip

* You can also view IaC misconfiguration issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Configuration tab under Repository assets. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from...

######## Navigation

  To access IaC misconfiguration issues, under Modules, select Application Security → Issues → IaC misconfiguration

####### 5.5.3.3.8.3. IaC misconfiguration issues inventory

####### 5.5.3.3.8.4. Expanded IaC misconfiguration issue information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 5.5.3.3.8.5. IaC misconfiguration findings

######## Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

######## Navigation

  To access IaC misconfiguration findings, under Modules, select Application Security → Issues → IaC Misconfigurations → click the Findings tab

####### 5.5.3.3.8.6. Manage IaC misconfiguration issues

###### 5.5.3.3.9. Application Security scans management

####### 5.5.3.3.9.1. How to access Application Security scan management

######## Note

* While scans provide a comprehensive inventory of all issues detected during a scan, dedicated inventories are also maintained for specific scan types for more granular management. For more information, refer to Infrastructure as Code (IaC) scanners, Secrets scanners and Software Composition Analysis (SCA ) scanners.

####### 5.5.3.3.9.2. Branch periodic scans

######## Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

####### 5.5.3.3.9.3. Pull Request scans

######## Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

####### 5.5.3.3.9.4. CI scans

######## Note

* The inventory table displays scan issues for visibility only; remediation is not available in scan management. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

####### 5.5.3.3.9.5. Manage repository scan configurations

######## Note

* For Secrets scans you configure these additional settings: Git history scan: scans Git history to detect secrets deleted from files but still present in past commits, notifying you of these exposures. This helps mitigate the risk of compromised credentials that may be found in the repository's history Secret validation: validates detected secrets...

######## Navigation

  Settings → Data Sources → hover over a connected data source from the catalog → click View Details

####### 5.5.3.3.9.6. Monitor data source instances health

###### 5.5.3.3.10. Application Security Policies

####### 5.5.3.3.10.1. User roles and permissions

####### 5.5.3.3.10.2. Create Application Security policies

######## Note

* Add additional condition attributes for a single finding type by using the OR operator When selecting multiple finding types, only filters common to all types are available

* If you select the Applications asset type, the policy evaluates all repositories for matching applications SBAC scope limitations do not apply to Asset Types

######## 5.5.3.3.10.2.1. Application Security policy condition attributes

####### 5.5.3.3.10.3. Manage Application Security policies

######## Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

###### 5.5.3.3.11. Application Security Rules

####### Note

* Out-of-the-box rules cannot be modified directly. However, you can create a custom rule by cloning the existing one. This allows you to make changes to the original rule according to your requirements. Refer to Manage Application Security custom rules for more information.

####### 5.5.3.3.11.1. Roles and permissions

####### 5.5.3.3.11.2. Rules inventory

######## Navigation

  To filter rules relating to Secrets, select filter icon → Scanner (from the Select field) → Secrets (from the Value field

####### 5.5.3.3.11.3. Create custom Application Security rules

######## Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

####### 5.5.3.3.11.4. Manage Application Security custom rules

####### 5.5.3.3.11.5. Configure YAML file properties

###### 5.5.3.3.12. Application Security CLI

####### Prerequisite

* For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

####### Note

* For detailed information about the Cortex XSIAM CLI, refer to Cortex CLI.

####### 5.5.3.3.12.1. Connect Cortex CLI

######## Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

######## Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Application Security, refer to Cortex CLI usage for Application Security

######## Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

####### 5.5.3.3.12.2. Cortex CLI usage for Application Security

####### 5.5.3.3.12.3. Cortex CLI Application Security command line reference

######## Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

######## Important

* The Cortex CLI Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id <YOUR_AUTH_ID>...

####### 5.5.3.3.12.4. Cortex CLI common command line reference guide

######## Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

###### 5.5.3.3.13. IDE

####### Note

* Not all remediation options are available for all findings or all type of scan category.

####### 5.5.3.3.13.1. System requirements

####### 5.5.3.3.13.2. Visual Studio (VS) Code

######## Prerequisite

* Before you begin: Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

######## Note

* Enforcement rules and CA certificates are not applicable to the open-source project.

######## Navigation

  Install through VS Code IDE: Access the Activity bar → select Extensions → Cortex Cloud → Install

######## 5.5.3.3.13.2.1. How to use the Cortex Cloud extension in VS Code

####### 5.5.3.3.13.3. JetBrains

######## Prerequisite

* Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install Node.js version 22 and...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

######## Note

* The Cortex AppSec code security plugin supports all JetBrains products.

######## Navigation

  Settings → Plugins → select the Marketplace tab → search for Prisma Cloud → Install → OK

  Settings → Tools → Cortex Cloud

######## 5.5.3.3.13.3.1. How to use the JetBrains Cortex XSIAM extension

##### 5.5.3.4. API documentation

#### 5.5.4. Attack Surface Management

##### 5.5.4.1. Get started with Attack Surface Management

###### License Type

  Requires the ASM add-on.

###### 5.5.4.1.1. What is Attack Surface Management?

####### 5.5.4.1.1.1. Attack Surface Management use cases

###### 5.5.4.1.2. Network mapping

###### 5.5.4.1.3. Scanning

####### 5.5.4.1.3.1. Scanning cadences

####### 5.5.4.1.3.2. Known Assets Monitoring

####### 5.5.4.1.3.3. Scanning ports and protocols

######## Note

* The following lists are not exhaustive. For current and complete lists, contact your customer success team.

###### 5.5.4.1.4. GeoIP data collection

##### 5.5.4.2. Attack Surface Management detections

###### 5.5.4.2.1. Attack surface rules

####### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

###### 5.5.4.2.2. Attack Surface Testing

####### Note

* Requires the ASM add-on.

* Attack surface testing scans are typically not CFAA compliant, meaning that they may attempt more extensive fuzzing to confirm or deny the presence of a CVE. Additionally, some attack surface tests are more intrusive than others. Tests are labeled with the level of intrusivity, so you can decide whether to run more intrusive tests.

####### 5.5.4.2.2.1. Set up Attack Surface Testing

######## Navigation

  Settings → Configurations → Access Management → Roles, and select the role

  Modules → Attack Surface → Policies → Attack Surface Tests

  Settings → Configurations → Attack Surface → Attack Surface Testing

###### 5.5.4.2.3. Externally inferred CVEs

####### Note

* An externally inferred CVE might impact your service or asset, but additional investigation is required to confirm that the CVE is actually present.

###### 5.5.4.2.4. Digital Risk Protection

####### Note

* Both of these attack surface rules are based on the attributed domain assets that appear in the asset inventory. If there are no attributed domains in your inventory, Cortex XSIAM will not generate Digital Risk Protection findings and issues.

####### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

##### 5.5.4.3. Attack surface assets

###### Navigation

  The internet-facing assets that were discovered in a attack surface management (ASM) scan and attributed to your organization are available in the inventory on the Inventory → Assets → All Assets → External Surface pages

  Inventory → Assets → Network Configuration → IP Address Ranges → External IP Address Ranges

###### 5.5.4.3.1. Upload or remove ASM assets

####### Note

* You must have the Instance Administrator role to upload or remove assets.

####### 5.5.4.3.1.1. Upload assets

######## Note

* If an asset upload request has an invalid CSV or includes one or more invalid assets, the entire request will fail, and none of the assets will be uploaded. If this happens, Cortex XSIAM will display an error message indicating what caused the error, so you can fix the problem and resubmit if you choose.

######## Navigation

  Settings → Configurations → Asset Management → Asset Uploads/Removals

####### 5.5.4.3.1.2. Remove assets

######## Note

* If an asset removal request has an incorrectly formatted CSV or includes one or more invalid assets, the entire request will fail, and none of the assets will be removed. If this happens, Cortex XSIAM will display an error message indicating what caused the error, so you can fix the problem and resubmit if you choose.

######## Navigation

  Settings → Configurations → Asset Management → Asset Uploads/Removals

##### 5.5.4.4. Deploy ASM and Exposure Management enrichment and remediation automation

###### Note

* For details and requirements regarding the enrichment information that can be collected and the specific issues that can be remediated automatically, review the Exposure Management Content Pack information in Marketplace.

* Cortex Exposure Management playbooks only run on issues that were created after the automation rules have been configured.

###### Navigation

  Investigation & Response → Automation → Automation Rules

  Settings → Configurations → Data Collection → Automation & Feed Integrations

##### 5.5.4.5. ASM enrichment of cloud assets

###### Navigation

  Inventory → Assets → All Assets → External Surface → Services

##### 5.5.4.6. Emerging Vulnerabilities

###### License Type

  Requires the ASM add-on

###### Note

* You must have a role with Attack Surface Rules permission to access the Emerging Vulnerabilities page. When setting up Roles Based Access Control (RBAC), you can find Attack Surface Rules in the Detection & Threat Intel component.

###### Navigation

  Posture Management → Vulnerability Management → Emerging Vulnerabilities

##### 5.5.4.7. Global Lookup

###### Navigation

  Modules → Attack Surface → Global Lookup

#### 5.5.5. Cloud Workload Policies and Rules

##### Prerequisite

* Users need View/Edit RBAC permissions (under Policies → Compute Policies) or the Instance Administrator role to view, edit, and modify Cloud Workload Policies.

##### 5.5.5.1. How policies and rules work together

##### 5.5.5.2. Cloud Workload Policies

###### 5.5.5.2.1. Types of Cloud Workload Policies

###### 5.5.5.2.2. Cloud Workload Policies page

####### Note

* Keep the following caveats in my mind when working with Policies: Instance Administrators are able to view all facets of Policies without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be...

####### 5.5.5.2.2.1. Widgets panel

######## 5.5.5.2.2.1.1. Show or hide the widget panel

####### 5.5.5.2.2.2. Filter page results

####### 5.5.5.2.2.3. Change the layout of the policies table

######## Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

####### 5.5.5.2.2.4. Policy Details Panel

######## Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 5.5.5.2.3. Enable or disable a Cloud Workload Policy

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 5.5.5.2.4. Create a Cloud Workload Policy

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 5.5.5.2.5. Use an existing policy to create a new Cloud Workload policy

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 5.5.5.2.6. Edit a Cloud Workload Policy

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 5.5.5.2.7. Delete a Cloud Workload Policy

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 5.5.5.3. Cloud Workload Rules

###### 5.5.5.3.1. Default (pre-defined) Rules

###### 5.5.5.3.2. Custom (user-defined) Rules

###### 5.5.5.3.3. Cloud Workload Rules page

####### Note

* Keep the following caveats in my mind when working with Rules: Instance Administrators are able to view all facets of Rules without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be able...

####### 5.5.5.3.3.1. Filter page results

####### 5.5.5.3.3.2. Change the layout of the rules table

####### 5.5.5.3.3.3. Rule details panel

###### 5.5.5.3.4. Create a new Custom Detection Rule

####### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

####### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

###### 5.5.5.3.5. Use an existing rule to create a new Custom Detection Rule

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

###### 5.5.5.3.6. Edit a Custom Detection Rule

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

###### 5.5.5.3.7. Delete a Custom Detection Rule

####### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

#### 5.5.6. Cortex Cloud Data Classification

##### 5.5.6.1. What is Cortex Cloud Data Classification?

##### 5.5.6.2. How to create and validate a custom data pattern

###### Note

* Once a custom data pattern is saved, it runs on all data in the same way as any out-of-the-box (OOTB) pattern, becoming globally applicable for all modules using Cortex Cloud Data Classification.

* For more information, see How to disable and enable data patterns in Data Classification.

##### 5.5.6.3. How to disable and enable data patterns in Data Classification

###### Note

* Disabling data patterns can cause changes in your data profile results and stop detection of these data patterns.

* For more information about data patterns in data classification, see What is Cortex Cloud Data Classification?.

###### Navigation

  In Cortex Command Center, click Settings → Configurations → Data Classification → Data Patterns

##### 5.5.6.4. How to create and validate a custom data profile

###### Note

* If you choose two data locations, only the filters they have in common will be included in the possible filter options.

* For more information, see How to disable and enable data profiles in Cortex Cloud Data Classification.

###### Important

* Deleting a data profile deletes all past data associated with it in all modules using Cortex Cloud Data Classification after a warning notification is displayed.

* Enabling and disabling a data profile removes or re-adds the data profile results to the data objects; that is, files and tables.

##### 5.5.6.5. How to disable and enable data profiles in Cortex Cloud Data Classification

###### Note

* Existing results on past scans are updated in the Asset and Object inventories within two hours after being disabled or enabled.

* For more information about data profiles in Cortex Cloud Data Classification, see What is Cortex Cloud Data Classification?.

###### Navigation

  In Cortex XSIAM Security Command Center, click Settings → Configurations → Data Classification → Data Profiles

#### 5.5.7. Cortex Cloud Data Security

##### 5.5.7.1. What is Cortex Cloud Data Security?

##### 5.5.7.2. Supported assets in Cortex Cloud Data Security

###### Note

* The list above refers to only data classification; however, Cortex Cloud Data Security discovers and monitors all cloud assets and services for usage and misconfigurations.

* For information about configuring data classification asset types, see How to configure the scanning settings for supported services.

##### 5.5.7.3. Cortex Cloud Data Security concepts

##### 5.5.7.4. Cortex Cloud Data Security use cases

##### 5.5.7.5. Data Inventory

###### Note

* To clear the filters in the filter panel, click Delete.

###### Navigation

  When you select Inventory → All Assets → Data → All Data, a list of all data assets appears

##### 5.5.7.6. How to review errors in Cortex Cloud Data Security

##### 5.5.7.7. How to configure the scanning settings for supported services

###### Note

* All the asset types are selected by default. When you deselect a data asset type, it is not included when the system runs the next scan operation, reducing the total scan time.

##### 5.5.7.8. How to perform advanced Data Security investigations using XQL

###### Note

* For more information, see Build XQL queries.Build XQL queries

##### 5.5.7.9. How to onboard Snowflake (Posture)

###### Prerequisite

* In order to use Snowflake (Posture), you must be registered with one of these cloud providers: Amazon AWS, Microsoft Azure, or Google Cloud Platform (GCP). Ensure you have the necessary account permissions to onboard. It is recommended to use account admin as the role for the onboarding.

###### Note

* The account identifier can be found using the user information at the bottom left. Hover over the account you wish to onboard and select the copy option at the top right. The account identifier is usually of the format: (organization).[account]

##### 5.5.7.10. How to onboard Microsoft 365 (Posture)

###### Prerequisite

* You have generated a Globally Unique Identifier (GUID), also known as a Universally Unique Identifier (UUID). You will need this ID for the tenant you want to use for the Microsoft 365 (Posture) instance. In order to use Microsoft 365 (Posture), you must be registered with Microsoft Azure.

##### 5.5.7.11. How to use information protection labels in Cortex Cloud Data Security

###### Note

* Only If you have connected a Microsoft 365 instance to Cortex Cloud, the information protection labels appear. See How to onboard Microsoft 365 (Posture).

#### 5.5.8. Cortex Cloud Identity Security

##### 5.5.8.1. What is Cortex Cloud Identity Security?

##### 5.5.8.2. Cortex Cloud Identity Security concepts

###### Note

* Access to the Weak/Compromised Password column requires the ITDR add-on.

* Only ITDR assets can have a risk score.

* When a policy is analyzed and categorized as excessive, a relevant finding and highlight is attached to that policy and the various identities being granted excessive permissions.

* Each action must be defined as either being administrative or not. The administrative tag is an additional tag for administrative actions, along with one of the other access level types. For example, the AWS action iam:CreateGroup is categorized as config and has the administrative tag as well.

###### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

##### 5.5.8.3. Cortex Cloud Identity Security principles

##### 5.5.8.4. Cortex Cloud Identity Security use cases

##### 5.5.8.5. How to manage RBAC and SBAC in Cortex Cloud Identity Security

###### Important

* You can use the Cortex Cloud Identity Security RBAC roles to define access to the various sections and functionalities of Cortex Cloud Identity Security, but these roles do not directly control the specific data a user sees within those sections. Data visibility is further refined and limited by scope-based access control (SBAC) capabilities.

##### 5.5.8.6. How to achieve the principle of least privilege access

###### Note

* In the case of Amazon AWS, Cortex Cloud Identity Security also uses AWS Identity and Access Management (IAM) Access Advisor insights to expand the coverage of supported actions.

###### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

##### 5.5.8.7. How to enable inactive human identity logs on Azure in Cortex Cloud Identity Security

###### Note

* For more information, see Ingest logs from Microsoft Azure Event Hub.

##### 5.5.8.8. How to perform advanced Identity Security investigations using XQL

###### Note

* For more information, see Build XQL queries.Build XQL queries

#### 5.5.9. Cortex Advanced Email Security

##### 5.5.9.1. Cortex Advanced Email Security module overview

###### Prerequisite

* The following are prerequisites for using the Cortex XSIAM Advanced Email Security module. REQUIREMENT DESCRIPTION Setup and Permissions Ensure Analytics is activated before enabling the Cortex Advanced Email Security module. Licenses and Add-ons Cortex Advanced Email Security add-on.

##### 5.5.9.2. Cortex Advanced Email Security module architecture and data flow

##### 5.5.9.3. Getting started with the Cortex Advanced Email Security module

###### Prerequisite

* Before you configure the Cortex Advanced Email Security module, ensure you have the following: Admin-level access to the target email platform API permissions to read mailbox data, manage remediation (if desired), and access user directories Dedicated service account (recommended) for integration purposes (response actions) List of domains and...

##### 5.5.9.4. Deploy and configure the Email Security module

###### 5.5.9.4.1. Integrate Microsoft 365 with the Cortex Advanced Email Security Module

####### License Type

  To configure a quick action, you must first create an application in Microsoft O365.

####### Navigation

  After you onboard your domains and configure the quick actions, Cortex XSIAM manage your protected domains in Modules → Email Security → Email Security Configuration

###### 5.5.9.4.2. Configure the Cortex Advanced Email Security module

####### License Type

  Requires the Email Security module.

####### Note

* You can add email indicators to the Allow List also in Exceptions Configuration → Issue Exclusions. However, if you add multiple indicators in a rule using Issue Exclusions under Exceptions Configuration, you cannot edit the rule in the Email Security Allow List.

####### Navigation

  Modules → Email Security → Email Security Configuration

##### 5.5.9.5. Cortex Advanced Email Security threat detection and issues

###### Note

* Depending on data collection mode and platform capabilities, not all fields may be populated for every message. API and export documentation provides further clarification on optional vs required fields.

###### 5.5.9.5.1. Email Security Analytics Rules

####### Navigation

  The Email Security Analytics Rules page is in Modules → Email Security → Email Security Detection Rules

##### 5.5.9.6. Investigate and respond to email security issues

###### License Type

  Requires the Cortex Advanced Email Security module.

###### Navigation

  Modules → Email Security → Email Security Issues

##### 5.5.9.7. Automate remediation for the Cortex Advanced Email Security module

##### 5.5.9.8. Email Command Center

###### License Type

  Requires the Cortex Advanced Email Security module.

#### 5.5.10. Exposure management

##### 5.5.10.1. Exposure Management in Cortex XSIAM

###### License Type

  Requires the Exposure Management add-on.

##### 5.5.10.2. Get started with Exposure Management

##### 5.5.10.3. Exposure Management Command Center

##### 5.5.10.4. Compensating Controls

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

##### 5.5.10.5. Cortex Network Scanner

###### 5.5.10.5.1. Get started with Cortex Network Scanner

####### License Type

  Requires the Exposure Management add-on.

####### Prerequisite

* Review the Cortex Network Scanner deployment recommendations and complete any prerequisites. Set up and configure Broker VM

####### Note

* The current version of the Cortex Network Scanner does not support load distribution and balancing. Vulnerability assessment scans can take time, and currently you can assign only one scanner per scan task. To scan the entire network we recommend splitting your scanning activity into smaller tasks to preserve performance.

* The Cortex Network Scanner applet is not supported for FedRAMP customers.

####### Important

* The Cortex Network Scanner applet is not supported for FedRAMP customers.

####### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  Settings → Configurations → Network Scanners → Network Scanners and find your new scanner in the list

###### 5.5.10.5.2. Add a network

####### Navigation

  Settings → Configurations → Network Scanning → Networks and click + Add Network

###### 5.5.10.5.3. Add credentials for authenticated scans

####### Prerequisite

* Before initiating an authenticated scan, complete the following prerequisites on your target hosts: Create dedicated service accounts. We highly recommend creating dedicated service accounts on your target devices specifically for the network scanner. Avoid using existing administrative accounts or personal user accounts. This practice enhances...

####### Note

* You cannot edit saved credentials, but you can delete them and create new ones as needed.

####### Navigation

  Settings → Configurations → Network Scanners → Credential Management

###### 5.5.10.5.4. Create a scan

####### Tip

* Most use cases can use the default advanced settings.

* ICMP Ping provides the quickest discovery scan and is good for initial discovery and scoping, however in the modern enterprise environment ICMP response can be blocked by the firewall or endpoint security rules. Using additional methods increases the accuracy of the host discovery, although makes the scan take a longer time. The best approach is to use...

###### 5.5.10.5.5. Manage scans

####### Navigation

  Settings → Configurations → Network Scanners → Scan Management

###### 5.5.10.5.6. View issues triggered by network scanner findings

####### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

#### 5.5.11. Vulnerability management

##### 5.5.11.1. Vulnerability management in Cortex XSIAM

###### Note

* Cortex XSIAM vulnerability management provides the ability to identify and assess runtime vulnerabilities in every asset across traditional IT and cloud environments. For vulnerabilities detected in your software development lifecycle through application security scans, refer to the Cortex Cloud Application Securitydocumentation.

###### 5.5.11.1.1. Cortex XSIAM vulnerability concepts

####### Note

* CVE is an acronym for Common Vulnerabilities and Exposures, which is a list of publicly disclosed security threats. We often use the term "CVE" to refer to a vulnerability that has been a assigned a CVE ID. Cortex XSIAM identifies CVEs and non-CVE vulnerabilities.

###### 5.5.11.1.2. Vulnerability Management dashboard

##### 5.5.11.2. Vulnerability policies

###### 5.5.11.2.1. Create a vulnerability policy

####### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

###### 5.5.11.2.2. Update the Ignored CVEs, Asset Groups, and Assets policy

####### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

###### 5.5.11.2.3. Modify a vulnerability policy

####### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

###### 5.5.11.2.4. Enable or disable a vulnerability policy

####### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

##### 5.5.11.3. Investigate and remediate vulnerabilities

###### 5.5.11.3.1. View all Vulnerabilities

####### Navigation

  Posture Management → Vulnerability Management → Vulnerabilities

###### 5.5.11.3.2. View vulnerability issues

####### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

###### 5.5.11.3.3. View All Vulnerability Findings

####### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues and click the All Vulnerability Findings button

###### 5.5.11.3.4. View vulnerable assets

####### Navigation

  Posture Management → Vulnerability Management → Vulnerable Assets

##### 5.5.11.4. Vulnerability Intelligence

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

##### 5.5.11.5. Recast CVSS scores and CVSS severities

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

### 5.6. Web and API Security (WAAS)

#### 5.6.1. Overview

##### License Type

  Requires the Cortex Cloud Runtime Security add-on.

##### Note

* Verify API security configurations for relevant users and roles.

#### 5.6.2. Personas workflow

#### 5.6.3. Secure your API landscape

##### 5.6.3.1. API visibility and risk assessment

###### Note

* Data classification findings are only available for enabled profiles.

* Indicates that a JSON Web Token was identified, but it is unknown how to determine its type from the given string. It could be a non-standard JSON Web Token creation algorithm.

##### 5.6.3.2. Monitor and investigate API threats

##### 5.6.3.3. Configure API security from end to end

###### 5.6.3.3.1. Third-party API security integrations

####### 5.6.3.3.1.1. Ingest AWS API Gateway

######## Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

######## Important

* Leave '–'filter-pattern empty as displayed above.

####### 5.6.3.3.1.2. Ingest Azure APIM

######## License Type

  Requires the Data Collection add-on.

######## Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

######## Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

####### 5.6.3.3.1.3. Ingest Apigee Proxy

######## License Type

  Requires the Data Collection add-on.

######## Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

######## Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

####### 5.6.3.3.1.4. Ingest Kong

######## License Type

  Requires the Data Collection add-on.

######## Note

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

######## Important

* The size of the buffer must be equal to or larger than the max body size setting in the plugin configuration, on every data plane node.

####### 5.6.3.3.1.5. Ingest-F5

######## License Type

  Requires the Data Collection add-on.

######## Note

* Extract the files from the F5 plugin to a folder before selecting to upload to F5.

* Select panw_apisec_set_ssl_data only if your client SSL profile is enabled.

* The provider for "context_provider" should always be uppercase. Supported providers: AWS, GCP, Azure, On-prem.

###### 5.6.3.3.2. Agent-based protection

####### Note

* Web and API Security (WAAS) profiles and policies are currently a Beta feature.

####### 5.6.3.3.2.1. Set up Web and API Security profiles

######## Note

* Web and API Security profiles and policies are currently a Beta feature.

* In this profile, the Report options configure the workload to report the corresponding malicious applications or APIs to Cortex XSIAM, without blocking them. The Disabled options configure the workloads to neither analyze nor report the corresponding malware or behavior.

######## Navigation

  Inventory → Endpoints → Policy Management → Prevention → Profiles

####### 5.6.3.3.2.2. Apply Web and API Security profiles to workloads

######## Note

* Web and API Security profiles and policies are currently a Beta feature.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

####### 5.6.3.3.2.3. Manage Web and API Security prevention profiles

######## Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

####### 5.6.3.3.2.4. Add a disable prevention rule for cloud workloads

######## Important

* All applicable prevention actions are skipped for the files and process that match the properties defined in the rule. Consider the consequences of disabling a prevention rule before you add the exception, and monitor it over time.

######## Navigation

  Settings → Exceptions Configuration → Disable Prevention Rules

####### 5.6.3.3.2.5. Add a support exception rule for cloud workloads

######## Navigation

  From Settings → Exceptions Configuration → Support Exception Rules, click + Import from file

####### 5.6.3.3.2.6. Add a legacy exception rule for cloud workloads

######## Navigation

  Your rule is created, and can be viewed at the following location: Settings → Exceptions Configuration → Legacy Agent Exceptions

####### 5.6.3.3.2.7. Additional workload management tasks

######## Navigation

  Several management activities that can be performed on workloads are accessible from Inventory → Endpoints → All Endpoints and from Inventory → Endpoints → Groups

##### 5.6.3.4. API specification inventory

###### Note

* Even if you have already imported the specification, you can edit the API specification in Cortex XSIAM and add or update the server list.

###### 5.6.3.4.1. Import API specification

####### Note

* Even if you already imported the file, you can edit the API asset and add or update the server list.

### 5.7. Serverless function security

#### 5.7.1. Overview

#### 5.7.2. Serverless function posture security

##### 5.7.2.1. Onboard cloud providers for serverless functions

###### Note

* When scanning serverless functions wtih layers, those layers need to be from the same cloud account.

* Only functions containing zip files are supported.

###### Important

* Cortex supports GCP functions deployed by Cloud Functions (1st gen) and Cloud Functions API (2nd gen).

##### 5.7.2.2. Serverless function posture policies

###### 5.7.2.2.1. Manage serverless function policies

####### Note

* You can select multiple types to view all your serverless function rules across your cloud providers.

* Refer to Create serverless function policies for more information on how to define the steps of a policy in the wizard.

###### 5.7.2.2.2. Create serverless function policies

####### Note

* You can select multiple options.

* For more information about rules, refer to Manage serverless function rules.

##### 5.7.2.3. Serverless function posture rules

###### 5.7.2.3.1. Manage serverless function rules

####### Note

* You can select multiple types to view all your serverless function policies across your cloud providers.

* Refer to Create serverless function rules for more information on how to define the steps of a rule in the wizard.

###### 5.7.2.3.2. Create serverless function rules

###### 5.7.2.3.3. Create an attack path rule for serverless functions

####### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  in as the operator → enter the CVE ID → Search

  > or >= as the operator → Severity level (such as High, Low) → Search

  > or >= as the operator → enter a score → Search

###### 5.7.2.3.4. Create a configuration rule for serverless functions

####### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

###### 5.7.2.3.5. Create a network exposure rule for serverless functions

####### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

##### 5.7.2.4. Serverless function usage

###### Navigation

  To access serverless function assets, under Inventory, select All Assets → Compute → Serverless Functions

  Posture Management → Vulnerability Management) → Vulnerability Issues

  Add Filters → Asset Category → Serverless Function

  Posture Management → Vulnerability Management) → Vulnerable Assets

  Add Filters → Asset Category → Serverless Functions

#### 5.7.3. Serverless function runtime security

##### 5.7.3.1. Overview

##### 5.7.3.2. Set up serverless function protection

##### 5.7.3.3. Serverless runtime issues

###### Note

* Issues triggered within 24 hours, sharing the same name and description, will be aggregated into cases along with issues from the same function per execution.

### 5.8. Data management

#### 5.8.1. Broker VM

##### 5.8.1.1. What is the Broker VM?

##### 5.8.1.2. Set up and configure Broker VM

###### Note

* The Broker VM comes with a 512 GB disk. Therefore, deploy the Broker VM with thin provisioning, meaning the hard disk can grow up to 512 GB but will do so only if needed.

* When DHCP is not enabled in your network and there isn't an IP address for your Broker VM, configure the Broker VM with a static IP using the serial console menu.

* When configuring a Local Agent Settings applet with installer and content caching, you need to configure an SSL certificate for the Broker VM as explained in the task below. For more information on specific requirements for the Local Agent Settings applet, see Activate Local Agent Settings. Keep in mind that several Broker VM applets, such as the...

* You can configure another Broker VM as a proxy server for this Broker VM by selecting the HTTP type. When selecting HTTP to route Broker VM communication, you need to add the IP Address and Port number (set when activating the Agent Proxy) for another Broker VM registered in your tenant. This designates the other Broker VM as a proxy for this Broker VM.

* The Palo Alto Networks Broker VM supports only strong cipher SHA256-based certificates. MD5/SHA1-based certificates are not supported.

* If adding a CA certificate to the Broker VM is not possible, ensure that you've added the Broker Service FQDNs to the SSL Decryption Exclusion list on your firewalls. See Enable Access to Cortex XDR.

###### Important

* There can be instances in which the Broker VM requires up to 50% of the incoming bandwidth as outgoing. Such instances can be, network instability between the Broker VM and Cortex XSIAM, or data that is being collected, but not well compressed.

* The internal network for the Broker VM must be unique and reserved. Other devices should not use the same IP as the Broker VM internal network as it can lead to communication issues with the Broker VM.

* If you use SSL decryption in your firewalls and proxies, see the Understanding CA certificate functionality in Broker VM deployments section below. In addition, verify that the proxies used support HTTP/2, gRPC-specific headers, and HTTP/2 trailers, and the inspection policies support gRPC traffic. Any devices that you use with this configuration...

* When configuring more than one network interface, ensure that only one Default Gateway is defined. The rest must be set to 0.0.0.0, which configures them as undefined. In addition, we recommend assigning each network interface to a different subnet, as oppose to configuring two interfaces on the same subnet which can potentially cause unexpected...

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and earlier, Cortex XSIAM will only accept 172.17.0.0/16.

* We strongly recommend disabling SSH connectivity when it's not being used. Therefore, activate SSH connectivity when it's needed and disable it right afterwards. When generating a new SSH key ensure to avoid embedding the domain-style username, by not using any backslashes (\) in the comment field, to ensure the SSH key passes validation.

###### 5.8.1.2.1. Broker VM image installations

####### 5.8.1.2.1.1. Set up Broker VM on Alibaba Cloud

######## Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

######## Note

* For Linux and Windows uploads, you can use Alibaba Cloud's graphical management tool called ossbrowser.

* The Object Storage Service must be created in the same Region as the image of the virtual machine.

######## Navigation

  Hamburger menu → Elastic Compute Service → Instances & Images → Instances

####### 5.8.1.2.1.2. Set up Broker VM on Amazon Web Services

######## Prerequisite

* Download a Cortex XSIAM Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. You need to set up an AWS VM Import role (vmimport) before you continue with the steps to convert the image as it is required for the import-image CLI command. You can use a different role, if the...

######## Note

* Creating an AMI image can take up to 60 minutes to complete.

* Assigning security groups can take up to 15 minutes.

######## Important

* A t2.medium (4GB RAM) is the lowest machine type that can be used as an instance type. Usually, the lowest machine type is sufficient with the Local Agent Settings applet. Yet, when enabling more applets, 8 GB is required.

######## Navigation

  Log in to the AWS IAM Console, and in the navigation pane, select Access Management → Users → Add Users

  Obtain a registration token from the Cortex XSIAM Web Console by selecting Settings → Configurations → Data Broker → Broker VMs → Add Broker → Generate Token

####### 5.8.1.2.1.3. Set up Broker VM on Google Cloud Platform (GCP)

######## Prerequisite

* Download a Cortex XSIAM Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. To complete the set up, you must have G Cloud installed and have an authenticated user account.

* Before importing a GCP image using the gcloud CLI, ensure that you update the Google Cloud components to version 371.0.0 and above using the following command:

######## Note

* The import tool uses Cloud Build API, which must be enabled in your project. For the import to work, Cloud Build service account must have compute.admin and iam.serviceAccountUser roles. When using the Google Cloud console to import the image, you will be prompted to add these permissions automatically.

####### 5.8.1.2.1.4. Set up Broker VM on KVM using Ubuntu

######## Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

####### 5.8.1.2.1.5. Set up Broker VM on Microsoft Azure

######## Prerequisite

* Download a Cortex XSIAM Broker VM VHD (Azure) image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

######## Note

* Extraction can take up to a few hours.

* Upload can take up to a few hours.

* Creating the VM can take up to 15 minutes. The Broker VM Web UI is not accessible during this time.

* For more information on creating a rule in an Azure VM, see Create a Security Rule in the Azure Documentation.

####### 5.8.1.2.1.6. Set up Broker VM on Microsoft Hyper-V

######## Prerequisite

* Download a Cortex XSIAM Broker VM VHD image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

####### 5.8.1.2.1.7. Set up Broker VM on Nutanix Hypervisor

######## Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

######## Note

* Saving the image to Nutanix hypervisor can take time as it's a large file.

* Creating the VM can take up to 15 minutes. The Broker VM Web user interface is not accessible during this time.

####### 5.8.1.2.1.8. Set up Broker VM on VMware ESXi using vSphere Client

######## Prerequisite

* Ensure you have a virtualization platform installed that is compatible with an OVA image, and have an authenticated user account. Download a Cortex XSIAM Broker VM OVA image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

###### 5.8.1.2.2. Broker VM data collector applets

####### 5.8.1.2.2.1. Activate Apache Kafka Collector

######## Prerequisite

* Apache Kafka version 2.5.1 and above. Kafka cluster set up on premises, from which the data will be ingested. Privileges to manage Broker Service configuration, such as Instance Administrator privileges. Create a user in the Kafka cluster with the necessary permissions and the following authentication details:    Broker Certificate and Private Key for...

######## Note

* For CEF and LEEF logs, Cortex XSIAM takes the vendor and product names from the log itself, regardless of what you configure on this page.

####### 5.8.1.2.2.2. Activate CSV Collector

######## Prerequisite

* Set up and configure Broker VM. Ensure that you share the applicable CSV files. Know the complete file path for the Windows directory.

######## Note

* When you implement a wildcard file search, ensure that the CSV files share the same columns and header rows as all other logs that are collected from the CSV files to create a single dataset.

* The CSV Collector checks for new CSV files every 10 minutes.

####### 5.8.1.2.2.3. Activate Cortex Network Scanner

######## License Type

  Requires the Exposure Management add-on.

######## Prerequisite

* Review the Cortex Network Scanner deployment recommendations and complete any prerequisites. Set up and configure Broker VM

######## Important

* The Cortex Network Scanner applet is not supported for FedRAMP customers.

######## Navigation

  Settings → Configurations → Data Broker → Broker VMs

  Settings → Configurations → Network Scanners → Network Scanners and find your new scanner in the list

####### 5.8.1.2.2.4. Activate Database Collector

######## Prerequisite

* Set up and configure Broker VM

######## Navigation

  Settings → Configurations → Data Broker → Broker VMs

####### 5.8.1.2.2.5. Activate Files and Folders Collector

######## Prerequisite

* Set up and configure Broker VM. Know the complete path to the files and folders that you want Cortex XSIAM to monitor. Ensure that the user permissions for the network share include the ability to rename and delete files in the folder that you want to configure collection.

######## Note

* Cortex XSIAM only supports ingestion of files encoded in UTF-8 format.

* When using the Linux file share, including the Linux share with nfs, a Username and Password is not required, so these fields are grayed out in the screen.

* In Batch mode, the Files and Folders Collector supports collecting logs from a network share for a maximum file size of 500 MB.

* When uploading JSON files, Cortex XSIAM only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* When the storing method is Replace, the maximum size for the total data to be imported into a lookup dataset is 30 MB each time the data is fetched. The inventory data ingested using the Files and Folders collector is counted towards license utilization. When you use a JOINT function with a lookup table in a query or correlation rule, make sure you...

* You can't specify a file name that's the same as a system file name. The name of a dataset created from a tsv file must always include the extension. If the original file name is mrkdptusrsnov23.tsv, you can name save the dataset with the name marketing_dept_users_Nov_2023.tsv.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

####### 5.8.1.2.2.6. Activate FTP Collector

######## Prerequisite

* Set up and configure Broker VM. Ensure that the user permissions for the FTP, SFTP, or FTPS include the ability to rename and delete files in the folder that you want to configure collection. When setting up an FTPS Collector with a server using a Self-signed certificate, you must upload the certificate first to the Broker VM as a Trusted CA...

######## Note

* When configuring an SFTP connection, Cortex XSIAM expects the private key to be in the RSA format that is included in the -----BEGIN RSA PRIVATE KEY----- tag. Cortex XSIAM does not support providing the private key in the OpenSSH format from the -----BEGIN OPENSSH PRIVATE KEY----- tag. When using ssh-keygen using a Mac, you get the OpenSSH format by...

* When uploading JSON files, Cortex XSIAM only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

####### 5.8.1.2.2.7. Activate Local Agent Settings

######## Note

* This is assuming a standard hardware setup with 2vCPU 8 GB memory.

* Broker VMs can act as as a proxy for routing XDR Collector traffic to the Cortex XSIAM tenant. The Broker VM does not cache XDR Collector installers.

* When you install your XDR agents, you need to configure the IP address of the Broker VM and a port number during the installation. You can use the default 8888 port or set a custom port. You are not permitted to configure port numbers between 0-1024 and 63000-65000, or port numbers 4369, 5671, 5672, 5986, 6379, 8000, 9100, 15672, 25672. Additionally,...

######## Important

* A FQDN must be configured for WEC and Agent Installer and Content Caching to function properly.

* You can only enable Agent Installer and Content Caching, when in the Broker VM Configuration, you've uploaded your signed SSL Server Certificate and key and set the FQDN. For more information, see the Agent Installer and Content Caching requirements explained above.

####### 5.8.1.2.2.8. Activate NetFlow Collector

######## Prerequisite

* Set up and configure Broker VM

######## Note

* Since multiple network devices can send data to a single NetFlow Collector, we recommend that you configure a maximum of 50 NetFlow Collectors per Broker VM applet, with a maximum aggregated rate of approximately 50K flows per second (FPS) to maintain system performance.

* Since Cortex XSIAM reserves some port numbers, it is best to select a port number that is not in the range of 0-1024 (except for 514), in the range of 63000-65000 or has one of the following values: 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672.

* The options available change, according to the set Source Network value.

####### 5.8.1.2.2.9. Activate Network Mapper

######## Prerequisite

* After you have configured and registered your Broker VM, you can choose to activate the Network Mapper application.

######## Note

* Each IP address range can receive multiple scan requests based on it's availability.

* IP address ranges are displayed according to what you defined as your Network Parameters.

####### 5.8.1.2.2.10. Activate Pathfinder

######## Prerequisite

* Configure and register a Broker VM. Except for Vanilla Windows 7, Cortex XSIAM supports activating Pathfinder on Windows operating systems with PowerShell version 3 and later. Verify these requirements wherever you want to activate Pathfinder. The Pathfinder configuration must contain at least one IP address range to run. Make sure that your internal...

######## Note

* Pathfinder isn't supported when configuring Broker VMs in high availability (HA) clusters.

######## Important

* The Broker VM Pathfinder applet is now deprecated. In tenants where the applet was implemented, it will remain operational until January 25, 2026. In all other tenants, the applet is unavailable and cannot be used as of July 20, 2025. To ensure complete coverage and protection, we recommend deploying XDR Agents on all endpoints by this date. Migration...

* The Pathfinder applet isn't supported when configuring Broker VMs in high availability (HA) clusters.

####### 5.8.1.2.2.11. Activate Registry Scanner

######## Prerequisite

* To initialize registry scanning on your Broker VM, you must first add the necessary data connectors. For details, see Connect Docker V2-compliant container registry and Connect JFrog container registry When sizing your Broker VM, consider the following recommendations:    Disk Size: Calculate the required disk space by multiplying the average container...

######## Note

* FedRAMP is currently not supported for this applet. You cannot activate the Registry Scanner directly on a new or existing Broker VM. You can only activate or deactivate existing Registry Scanner applets. To activate or deactivate existing applets, see Step 4 under Verify Registry Scanner connection section.

######## Navigation

  Settings → Configurations → Data Broker → Broker VMs

####### 5.8.1.2.2.12. Activate Syslog Collector

######## Prerequisite

* Set up and configure Broker VM

######## Note

* Once configured, you cannot change the Port/PROTOCOL. If you don't want to use a data source, ensure to remove the data source from the list as explained in Task 5.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and...

* The server certificate and private key pair is expected in a PEM format. Cortex XSIAM will notify you when your certificates are about to expire.

* Because some port numbers are reserved by Cortex XSIAM , you must choose a port number that is not: In the range of 0-1024 (except for 514) In the range of 63000-65000 Values of 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672

* CORELIGHT is not available for a UDP protocol.

######## Navigation

  Settings → Configurations → Data Broker → Broker VMs

####### 5.8.1.2.2.13. Activate Transporter

######## Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator) Set up and configure Broker VMSet up and configure Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex XSIAM resources. The IP addresses...

######## Warning

* The Transporter applet is not supported for FedRAMP customers.

######## Navigation

  Settings → Configurations → Broker VMs (under Data Broker

  the Brokers tab → locate your Broker VM → hover and click + Add under the Apps column → AppSec Transporter

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

####### 5.8.1.2.2.14. Activate Windows Event Collector

######## Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

######## Note

* You can also activate the Windows Event Collector on Windows Core. For more information, see Activate Windows Event Collector on Windows Core.

* By default, Cortex XSIAM collects Palo Alto Networks predefined Security events that are used by the Cortex XSIAM detectors. Removing the Security collector interferes with the Cortex XSIAM detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

######## 5.8.1.2.2.14.1. Activate Windows Event Collector on Windows Core

######## 5.8.1.2.2.14.2. Renew WEC certificates

##### 5.8.1.3. Manage Broker VM

###### Note

* For more information on troubleshooting errors and warnings for these broker applets, see Troubleshoot Broker VM applet errors.

* Certain fields are also exposed in the Clusters tab, when a Broker VM node is added to a High Availability (HA) cluster, and each cluster node is expanded to view the Broker VM nodes table. An asterisk (*) is beside every field that is also included in the Broker VM nodes table for each HA cluster.

###### Navigation

  Settings → Configurations → Data Broker → Broker VMs

###### 5.8.1.3.1. Edit Broker VM Configuration

####### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and lower, Cortex XSIAM accepts only 172.17.0.0/16.

* Make sure you save the password before closing the window. The only way to re-generate a password is to disable ssh and re-enable.

###### 5.8.1.3.2. Increase Broker VM storage allocated for data caching

####### Note

* Follow your hypervisor documentation to understand how to add a persistent disk storage to your VM.

* If your disk is not listed and you didn't shutdown your Broker VM in your hypervisor before manually adding a disk to the VM, you'll need to reboot the Broker VM before the disk details are detected by the Broker VM. This can be performed either in the hypervisor or directly in the Broker VMs page.

####### Warning

* This operation is irreversible, and will make the disk become an integral part of the broker, where disconnecting the disk will result in errors and data loss.

###### 5.8.1.3.3. Monitor Broker VM using Prometheus

####### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* For more information on Docker, see the Docker website.

###### 5.8.1.3.4. Collect Broker VM Logs

####### Note

* The Download Logs (<TIMESTAMP>) is only displayed when you've downloaded your logs previously using Generate New Logs.

###### 5.8.1.3.5. Upgrade Broker VM

####### Important

* After a Broker VM upgrade, your broker may require a reboot to finish installing important updates. A notification about this will be sent to your Cortex XSIAM console Notification Center.

###### 5.8.1.3.6. Import Broker VM Configuration

####### Important

* This option can only be used on Broker VMs with version 20.0 and later, and is only suitable for importing a configuration of brokers in the same version, or from a broker in an older version to a broker in a newer version.

* If your source Broker VM configuration includes a WEC applet, you'll need to ensure that you update the DNS record of this Broker VM's FQDN to point to the target Broker VM IP address.

###### 5.8.1.3.7. Open Live Terminal

####### Note

* You can either restart_routes or reboot the Broker VM for the changes in the /etc/network/routes file to take affect.

###### 5.8.1.3.8. Add Broker VM to cluster

####### Navigation

  Settings → Configurations → Data Broker → Broker VMs

###### 5.8.1.3.9. Switchover Primary Node in Cluster

####### Navigation

  Settings → Configurations → Data Broker → Broker VMs

###### 5.8.1.3.10. Remove from Cluster

####### Note

* If you've enabled a Load Balancer Health-Check on the cluster, you need to exclude this Broker VM from your Load Balancer settings.

##### 5.8.1.4. Manage Broker VM data collector applets

###### Note

* For more information on the Broker VM applet connectivity status, see Manage Broker VM.

##### 5.8.1.5. Broker VM High Availability Cluster

###### Note

* For Load Balancing, you must install a Load Balancer in your network which will distribute the incoming data between the nodes.

* The Pathfinder applet isn't supported when configuring Broker VMs in HA clusters.

###### 5.8.1.5.1. Configure High Availability Cluster

####### Prerequisite

* Be sure you do the following tasks before creating a cluster from an existing Broker VM: Since the Pathfinder applet isn't supported when configuring HA clusters, you must ensure Pathfinder is deactivated on the Broker VM. If the Broker VM is explicitly specified in some Agent Settings profile, which mean Cortex XSIAM agents retrieve release upgrades...

####### Important

* You can only create a new cluster from an existing Broker VM, when the Broker VM version is 19.0 and later, and the STATUS is Connected. The Create a Cluster from this Broker option is only listed if the Broker VM is not already added to a cluster.

* When the Protocol is set to HTTPS, you may need to perform a few follow-up steps to establish a validated secure SSL connection with the Broker VM. If you're using your own Certificate Authority (CA) to sign the certificates, you'll need to place the CA in the client, such as the Load Balancer, and upload the certificates to the Broker VM. If you're...

####### Navigation

  Settings → Configurations → Data Broker → Broker VMs

###### 5.8.1.5.2. Manage Broker VM clusters

####### Navigation

  After you've configured a cluster, you can manage all your Broker VM clusters from the Clusters tab on the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs → Clusters

####### 5.8.1.5.2.1. View cluster details

######## Note

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

######## Navigation

  The Clusters tab of the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs) enables you

####### 5.8.1.5.2.2. Edit cluster

######## Navigation

  Settings → Configurations → Data Broker → Broker VMs, and select the Clusters tab

####### 5.8.1.5.2.3. Add applet to cluster

######## Note

* With Cortex XDR Prevent, it's only relevant to configure a HA cluster with a Local Agent Settings applet as this is the only applet supported for this product license. The other applets are collector applets, which are only available in Cortex XDR Pro or Cortex XSIAM.

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

####### 5.8.1.5.2.4. Add Broker VM to cluster

######## Navigation

  Settings → Configurations → Data Broker → Broker VMs

####### 5.8.1.5.2.5. Remove cluster

######## Navigation

  Settings → Configurations → Data Broker → Broker VMs

##### 5.8.1.6. Broker VM notifications

###### Note

* For more information on upgrading to a new Broker VM image, see Migrating to a New Broker VM Image.

##### 5.8.1.7. Monitor Broker VM activity

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 5.8.1.8. Troubleshoot Broker VM applet errors

###### Note

* For more information on creating correlation rules to trigger collection health issues, see How can I set up correlation rules to trigger collection health issues?.

#### 5.8.2. XDR Collectors

##### Note

* Ingestion of log events larger than 5 MB is not supported.

##### 5.8.2.1. XDR Collector audit logs

##### 5.8.2.2. XDR Collector machine requirements and supported operating systems

##### 5.8.2.3. Resources required to enable access to XDR Collectors

###### Note

* Some of the IP addresses required for access are registered in the United States. As a result, some GeoIP databases do not correctly pinpoint the location in which IP addresses are used. All customer data is stored in your deployment region, regardless of the IP address registration and restricts data transmission through any infrastructure to that...

* Throughout this topic, <xsiam-tenant> refers to the chosen subdomain of your Cortex XSIAM tenant and <region> is the region in which your Strata Logging Service is deployed.

##### 5.8.2.4. Manage XDR Collectors

###### 5.8.2.4.1. XDR Collectors installation resource for Windows and Linux

####### Note

* In some circumstances, such as after an XDR Collectors upgrade, the configured settings in the XML configuration file can be erased. Yet, this won't affect the saved settings in the XDR Collectors database.

###### 5.8.2.4.2. Create an XDR Collector installation package

####### Note

* To move existing XDR Collectors between Cortex XSIAM managing servers, you need to first Uninstall the XDR Collector from the collector machine and then for the new XDR Collector create a new installation package.

* Since Cortex XSIAM relies on the installation package ID to approve XDR Collector registration during install, it is not recommended to delete the installation package for any active on-premise collector machines. Hiding the installation package will remove it from the default list of available installation packages, and can be useful to eliminate...

###### 5.8.2.4.3. Install the XDR Collector installation package for Windows

####### 5.8.2.4.3.1. Install the XDR Collector on Windows using the MSI

######## Note

* When the package is executed using the MSI, an installation log is generated in %TEMP%\MSI<Random characters>.log by default.

* If the XDR Collector does not connect to Cortex XSIAM, verify your internet connection on the collector machine. If the XDR Collector still does not connect, verify that the installation package has not been removed from the Cortex XSIAM tenant.

####### 5.8.2.4.3.2. Install the XDR Collector on Windows using Msiexec

###### 5.8.2.4.4. Install the XDR Collector installation package for Linux

####### Note

* We recommend that you perform a Linux RPM or Linux DEB installation.

* If the XDR Collector does not connect to Cortex XSIAM, verify your Internet connection on the collector machine. If the XDR Collector still does not connect, verify the installation package has not been removed from the Cortex XSIAM management console.

* The XDR Collector does not support proxy communication in environments where proxy authentication is required.

####### Important

* When performing a XDR Collector installation or upgrade in Linux using a shell installer, the  /tmp folder cannot be marked as noexec. Otherwise, the installation or upgrade fails. As a workaround, before the installation or upgrade, use the following command:

###### 5.8.2.4.5. Configure the XDR Collector upgrade scheduler

####### Navigation

  In Cortex XSIAM, select Settings → Configurations → XDR Collectors → Configuration

###### 5.8.2.4.6. Set an application proxy for XDR Collectors

####### Navigation

  In Cortex XSIAM, select Settings → Configurations → XDR Collectors → Administration

###### 5.8.2.4.7. Set an alias for an XDR Collector machine

####### Navigation

  Settings → Configurations → XDR Collectors → Administration

###### 5.8.2.4.8. Upgrade XDR Collectors

####### Note

* The XDR Collector keeps the name of the original installation package after every upgrade.

###### 5.8.2.4.9. Uninstall the XDR Collector

####### Navigation

  Settings → Configurations → XDR Collectors → Administration

  Investigation & Response → Response → Action Center

##### 5.8.2.5. Define XDR Collector machine groups

###### Note

* XDR Collectors only support IPv4 addresses.

* Disconnecting Directory Sync in your Cortex XSIAM deployment can affect existing collector machine groups and policy rules based on Active Directory properties.

##### 5.8.2.6. About Cortex XDR Collector content updates

##### 5.8.2.7. XDR Collector profiles

###### 5.8.2.7.1. Add an XDR Collector profile for Windows

####### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex XSIAM collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex XSIAM supports logs in single line format or multiline format. For more...

####### 5.8.2.7.1.1. Ingest logs from Windows DHCP using Elasticsearch Filebeat

######## Note

* Although this enrichment is available when configuring a Windows DHCP collector for a cloud data collection integration, we recommend configuring Cortex XSIAM to receive Windows DHCP logs with an XDR Collector Windows Filebeat profile, because it is simpler to set up.

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the template provided by Cortex XSIAM to make your customizations. We recommend that you edit the file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating your...

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the example file provided by Cortex XSIAM to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your filebeat.yml file. Validate the syntax of the YML file before you finish creating...

* The tokenizer definition is dependent on the Windows server version that you are using, because the log format differs. For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%...

####### 5.8.2.7.1.2. Ingest Windows DNS debug logs using Elasticsearch Filebeat

######## Note

* Detailed logs are significantly larger, because more information is added to the logs.

* To avoid formatting issues in your filebeat.yml file, we recommend that you validate the syntax of the file.

###### 5.8.2.7.2. Add an XDR Collector profile for Linux

####### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex XSIAM collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex XSIAM supports logs in single line format or multiline format. For more...

##### 5.8.2.8. Apply profiles to collection machine policies

###### Navigation

  Settings → Configurations → XDR Collectors → Policies → +Add Policy

##### 5.8.2.9. XDR Collector datasets

#### 5.8.3. Data Collection

##### 5.8.3.1. Visibility of logs and issues from external sources

###### License Type

  Data collection may require an add-on.

###### Note

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs.

* Logs with sessionid = 0 are dropped.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. IOCs and BIOCs are only generated for these event types: sso and session_start.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. Analytics, IOCs and BIOCs are only generated on the Firewall data. The Zscaler Nanolog Streaming Service (NSS) feed for web logs is only used for Correlation Rules and threat hunting.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. The Zscaler Nanolog Streaming Service (NSS) feed for web logs is only used for Correlation Rules and threat hunting.

##### 5.8.3.2. Visibility of Cortex XSIAM audit and authentication logs

###### Note

* Cortex XSIAM can create Cortex XSIAM issues (Analytics, IOC, BIOC, and Correlation Rules) when relevant from logs.

##### 5.8.3.3. External data ingestion vendor support

###### License Type

  Data collection may require an add-on.

##### 5.8.3.4. Manage instances

###### 5.8.3.4.1. Add a new data source or instance

####### Note

* If a data source contains multiple integrations, the integration configured as the default integration will used by the Data Onboarder. The default integration of the content pack is indicated in each content pack's documentation. The other integrations are available for configuration in the Automation and Feed Integrations page after installing the...

* If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant page in the system, for example Correlations, Playbooks, or Scripts. If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant...

###### 5.8.3.4.2. How to configure the scanning settings for supported services

####### Note

* All the asset types are selected by default. When you deselect a data asset type, it is not included when the system runs the next scan operation, reducing the total scan time.

###### 5.8.3.4.3. Manage cloud instances

###### 5.8.3.4.4. Update cloud permissions after Cortex release updates

####### Prerequisite

* Ensure that the user account used to modify permissions has the necessary privileges within both the Cortex platform and your cloud environment, for example, AWS or Azure. You received a notification regarding a new version available that requires permission updates, or viewed a Needs Update status in the Data Sources page.

####### Note

* Instances requiring updates will not change their connection status, for example, Connected, Warning, Error, Disabled, due to the pending permission update.

###### 5.8.3.4.5. Pending cloud instances

###### 5.8.3.4.6. Troubleshoot errors on cloud instances

####### Note

* Errors related to collection of audit logs in the cloud instance are recorded in the collection_auditing dataset. For more information, see Audit logs fields and query examples.

###### 5.8.3.4.7. Manage Kubernetes Connector instances

##### 5.8.3.5. Palo Alto Networks integrations

###### License Type

  Data collection may require an add-on.

###### Note

* Roll-back of Strata Logging Service integration migration is not supported.

###### 5.8.3.5.1. About Palo Alto Networks integrations

####### Note

* For Palo Alto Networks Integrations there is an option to turn on or off the collection of URL and File log types. For more information, see Collecting URL and File log types.

* Roll-back of Strata Logging Service integration migration is not supported.

###### 5.8.3.5.2. Ingest data from Next-Generation Firewall

####### Prerequisite

* Ensure that you have completed the following on the NGFW or Panorama side: For Panorama only, ensure that the Panorama Cloud Services plugin is installed. Enable log forwarding profiles on firewall rules. On the Cortex XSIAM side, ensure that you have user role permissions for Data Collection > Data Sources. Configuration of data ingestion from...

####### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* If your firewalls are located in a different region, or bandwidth issues are encountered due to large log size, you can ingest NGFW logs in CEF format, using the Syslog collector. However, the Syslog solution is not as powerful nor as comprehensive as this data collector, and should only be used when this data collector cannot be used. For more...

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version.

* Cortex XSIAM does not validate your firewall credentials, you must ensure the certificates or PSK details have been updated in your firewalls in order for data to stream.

* It might take an hour or longer after connecting the firewall in Cortex XSIAM until you start seeing notifications that the certificate has been approved, and that the logging service license has appeared on the firewall.

* IOC and BIOC issues are applicable on stitched data only, and are not available on raw data.

####### Tip

* You can see an overview of ingestion status for all log types, and a breakdown of each log type and its daily consumption quota on the NGFW Ingestion Dashboard.

####### 5.8.3.5.2.1. Ingest Next-Generation Firewall logs using the Syslog collector

######## Note

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version, to ensure that you have configured log forwarding correctly for all the log types that you would like to forward to Cortex XSIAM. The following steps only cover...

* To avoid the possible effects of line formatting, do not copy/paste the message formats directly into the PAN-OS web interface. Instead, paste into a text editor, remove any carriage return or line feed characters, and then copy and paste into the web interface.

* From version 10.0 and later, the log format documented for log types (Traffic, Threat, and URL) exceeds the maximum supported 2048 characters in the Custom Log Format tab on the firewall and Panorama. Select the CEF keys and values to limit the number of characters to 2048, as per your requirements.

###### 5.8.3.5.3. Ingest data from Prisma Access

####### Prerequisite

* Configuration of data ingestion from multiple accounts requires Super User permissions in both Cortex XSIAM tenant and Prisma Access accounts.

####### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* Cortex XSIAM does not validate your Prisma Access account credentials. You must ensure the account has been deployed in order for data to stream.

###### 5.8.3.5.4. Ingest logs from Prisma Access Browser

###### 5.8.3.5.5. Ingest detection data from Strata Logging Service

####### Note

* IOC and BIOC issues are applicable on stitched data only and are not available on raw data.

###### 5.8.3.5.6. Ingest alerts and assets from IoT Security

###### 5.8.3.5.7. Collecting URL and File log types

####### 5.8.3.5.7.1. Detectors connected to URL and File log types

##### 5.8.3.6. External data ingestion

###### 5.8.3.6.1. External applications

###### 5.8.3.6.2. Ingest network connection logs

####### 5.8.3.6.2.1. Ingest network flow logs from Amazon S3

######## Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* To create a new VPC, click Launch VPC Wizard. For more information, see AWS VPC Flow Logs.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex XSIAM.

######## 5.8.3.6.2.1.1. Create an assumed role

######## 5.8.3.6.2.1.2. Configure data collection from Amazon S3 manually

####### 5.8.3.6.2.2. Ingest network Route 53 logs from Amazon S3

######## Note

* For more information on configuring data collection from Amazon S3 for Route 53 DNS logs, see the AWS Documentation.

* For more information on creating a Stack, see Creating a stack on the AWS CloudFormation console.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex XSIAM.

####### 5.8.3.6.2.3. Ingest logs from Check Point firewalls

######## Note

* Logs with sessionid = 0 are dropped. Destination Port data is available only in the raw logs.

####### 5.8.3.6.2.4. Ingest logs from Cisco ASA firewalls and AnyConnect

####### 5.8.3.6.2.5. Ingest logs from Corelight Zeek

####### 5.8.3.6.2.6. Ingest logs from Fortinet Fortigate firewalls

####### 5.8.3.6.2.7. Ingest logs from Microsoft Azure Event Hub

######## Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

######## Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

######## Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

####### 5.8.3.6.2.8. Ingest network flow logs from Microsoft Azure Network Watcher

######## Prerequisite

* For NSG:    Ensure that your NSG flow logs in Azure Network Watcher conform to the requirements as outlined in Microsoft documentation. For more information, see Introduction to flow logging for network security groups.   Enable NSG flow logs in the Microsoft Azure Portal. For NSG: Ensure that your NSG flow logs in Azure Network Watcher conform to the...

######## Note

* In addition to your storage account, the template automatically creates another storage account that is required by the function app for internal use only. The internal storage account name is prefixed with cortex and is followed by a unique suffix based on the resource group, storage account, and container names.

####### 5.8.3.6.2.9. Ingest logs and data from Okta

####### 5.8.3.6.2.10. Ingest logs from Windows DHCP using Elasticsearch Filebeat

######## Note

* To avoid formatting issues in filebeat.yml, we recommend that you edit the text file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating the profile.

* For more information on configuring the filebeat.yml file, see the Elastic Filebeat Documentation.

* To avoid formatting issues in your filebeat.yml, we recommend that you use the download example file to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your file.

* The tokenizer definition is dependent on the Windows server version that you are using as the log format differs. -For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" -For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{mac...

####### 5.8.3.6.2.11. Ingest logs from Zscaler Internet Access

####### 5.8.3.6.2.12. Ingest logs from Zscaler Private Access

######## Note

* For more information on configuring the parameters on the screen, see the Zscaler Private Access (ZPA) documentation for Configuring a Log Receiver.

* You can only configure a ZPA log receiver to collect one type of log with your Syslog Collector in Cortex XSIAM. To configure more that one log type, you'll need to add another log receiver.

###### 5.8.3.6.3. Ingest authentication logs and data

####### 5.8.3.6.3.1. Ingest audit logs from AWS Cloud Trail

######## Note

* For more information on configuring data collection from Amazon S3 using AWS CloudTrail, see the AWS CloudTrail Documentation.

* For more information on creating an AWS CloudTrail trail, see Create a trail. If you already have an Amazon S3 bucket configured with AWS CloudTrail audit logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* It is your organization's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* The CloudWatch Logs - optional settings are not supported and should be left disabled.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It your organization's responsibility to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

####### 5.8.3.6.3.2. Ingest logs and data from a GCP Pub/Sub

######## Note

* When collecting flow logs, we recommend that you include GKE annotations in your logs, which enable you to view the names of the containers that communicated with each other. GKE annotations are only included in logs if appended manually using the custom metadata configuration in GCP. For more information, see VPC Flow Logs Overview. In addition, to...

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the GCP data collector settings. Yet, when the values are blank in the...

####### 5.8.3.6.3.3. Ingest logs and data from Google Workspace

######## Note

* For all types of data collected via the Admin Reports API, except alerts and emails, the log events are collected with a preset lag time as reported by Google Workspace. For more information on these lag times for the different types of data, see Google Workspace Data retention and lag times.

* Spam emails from the compliance email account, and from all other monitored email accounts, are not collected. Any draft emails written in the compliance email account are collected by the Google Workspace data collector, and are then deleted even if the email was never sent.

* For more information on the entire process, see Perform Google Workspace Domain-Wide Delegation of Authority.

* When collecting Google Workspace alerts with other types of data, except emails, you need to configure a service account in Google with the applicable permissions to collect events from the Google Reports API and alerts from the Alert Center API. If you prefer to use different service accounts to collect events and alerts separately, you'll need to...

* For more information on the Admin Reports API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information on the Gmail API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information about the events collected from the various Google Reports, see Google Workspace Reports API Documentation.

####### 5.8.3.6.3.4. Ingest logs from Microsoft Azure Event Hub

######## Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

######## Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

######## Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

####### 5.8.3.6.3.5. Ingest logs from Microsoft Office 365

######## Note

* Ingesting Microsoft Entra ID (formerly known as Azure AD) authentication and audit events from Microsoft Graph API requires a Microsoft Azure Premium 1 or Premium 2 license. Alternatively, if the directory type is Azure AD B2C, the sign-in reports are accessible through the API without any additional license requirement. To ingest email logs and data...

* When auditing is turned off from the default setting, you need to first turn on auditing for your organization to collect Microsoft Office 365 audit events from the Management Activity API. Log duplication of up to 5% in Microsoft products is considered normal. In some cases, such as login to a portal using MFA, two log entries are recorded by design.

* To address Azure reporting latency, there is a 10-minute latency period for Cortex XSIAM to receive Azure AD logs.

* You can also implement the corresponding Cortex Data Model (XDM) mappings for these Microsoft Graph Security API v2 alerts using Cortex Marketplace via the Microsoft Graph Security content pack.

* For more information, see the Office 365 Management Activity API schema.

* In FedRAMP environments, Azure sign-in logs are not supported, due to vendor technical constraints.

* Use this option when you don't want to grant permissions for Azure AD Authentication and Azure AD Audit.

####### 5.8.3.6.3.6. Ingest logs and data from Microsoft 365

######## License Type

  Email data: The subject, body, and attachments are visible only with an Email Security module license.

######## Prerequisite

* A user account with the Microsoft Azure Account Administrator role is required to set up a new Microsoft 365 email collector. The following Microsoft Graph API permissions are required:    Mailbox access (read-write)    Read and write mail in all mailboxes   Read contacts in all mailboxes   Read all user mailbox settings      User information, groups,...

######## Note

* For other logs from Microsoft Office 365, use the Office 365 data collector. For more information, see Ingest logs from Microsoft Office 365.

####### 5.8.3.6.3.7. Ingest logs and data from Okta

####### 5.8.3.6.3.8. Ingest logs and data from OneLogin

######## Note

* Event data is collected every 30 seconds.

* Inventory data snapshots are collected every 10 minutes.

####### 5.8.3.6.3.9. Ingest authentication logs from PingFederate

####### 5.8.3.6.3.10. Ingest authentication logs and data from PingOne

######## Navigation

  Reporting → Subscriptions → Add Subscription

###### 5.8.3.6.4. Ingest operation and system logs from cloud providers

####### 5.8.3.6.4.1. Ingest generic logs from Amazon S3

######## License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

######## Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* You need to set up an Amazon S3 data collector to receive generic logs when collecting logs from BeyondTrust Privilege Management Cloud. For more information, see Ingest logs from BeyondTrust Privilege Management Cloud.

* If you want to ingest raw EDR events from SentinelOne DeepVisibility, use the SentinelOne DeepVisibility log collector. For more information, see Ingest raw EDR events from SentinelOne DeepVisibility.

* It is the customer's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It is the responsibility of your organization to ensure that the user who performs this task of creating the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor...

####### 5.8.3.6.4.2. Ingest logs from Amazon CloudWatch

####### 5.8.3.6.4.3. Ingest logs and data from a GCP Pub/Sub

######## Note

* When collecting flow logs, we recommend that you include GKE annotations in your logs, which enable you to view the names of the containers that communicated with each other. GKE annotations are only included in logs if appended manually using the custom metadata configuration in GCP. For more information, see VPC Flow Logs Overview. In addition, to...

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the GCP data collector settings. Yet, when the values are blank in the...

####### 5.8.3.6.4.4. Ingest logs from Google Kubernetes Engine

######## Note

* Cortex XSIAM supports logs in single line format or multiline format. For more information on handling messages that span multiple lines of text in Elasticsearch Filebeat, see Manage Multiline Messages.

####### 5.8.3.6.4.5. Ingest logs from Microsoft Azure Event Hub

######## Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

######## Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

######## Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

####### 5.8.3.6.4.6. Ingest logs and data from Okta

###### 5.8.3.6.5. Ingest endpoint data

####### 5.8.3.6.5.1. Ingest alerts and metadata from CrowdStrike APIs

######## Note

* To enable some of the APIs, you may need to reach out to CrowdStrike support.

* For more information on configuring data collection from CrowdStrike APIs, see the CrowdStrike Documentation.

* Ensure that you save the SECRET value because this is the only time that it is displayed.

####### 5.8.3.6.5.2. Ingest raw EDR events from CrowdStrike Falcon Data Replicator

######## Prerequisite

* Ensure that your organization has a license for the CrowdStrike Falcon Data Replicator (FDR). Ensure that CrowdStrike FDR is enabled. CrowdStrike FDR can only be enabled by CrowdStrike Support. If CrowdStrike FDR is not enabled, submit a support ticket through the CrowdStrike support portal. Follow these steps to check if CrowdStrike FDR is...

######## Note

* Due to limitations with the S3 bucket used by CrowdStrike, data can only be collected once, by one system.

* For more information on configuring data collection from CrowdStrike via Falcon Data Replicator, see CrowdStrike documentation.

* Ensure that you copy the Secret, and store it in a safe place. You will not be able to retrieve it later. If you need a new secret, you must reset the feed credentials.

* CrowdStrike Falcon Data Replicator only supports one FDR credential configuration.

* Ensure that you save the SECRET value, because this is the only time that it is displayed. You can go back to this page later to copy the other credentials, but you will not have access to the secret again.

####### 5.8.3.6.5.3. Ingest raw EDR events from Microsoft Defender for Endpoint

######## Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection. Create an Azure Event Hub. For more information, see Quickstart: Create an event hub using Azure portal.    Create a resource group (optional if you already have a resource group configured).   Create an Event Hubs namespace.   Create an event hub within the namespace....

######## Note

* The generic Cortex XSIAM Azure Event Hub collector does not offer full functionality for EDR data (such as stitching), and is therefore not suitable for EDR data ingestion.

* If you select all event types and leave Event-Hub name empty, an event hub will be created for each category in the selected namespace. If you are not using a Dedicated Event Hubs ClusterEvent Hub, namespaces have a limit of 10 Event Hubs.

####### 5.8.3.6.5.4. Ingest raw EDR events from SentinelOne DeepVisibility

######## Prerequisite

* The SentinelOne DeepVisibility logs that will be collected by your dedicated Amazon S3 bucket must adhere to the following guidelines:    Each log file must use the 1 log per line format as multi-line format is not supported.   The log format must be compressed as gzip or uncompressed.   For best performance, we recommend limiting each file size to up...

######## Note

* It is your responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule on the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If you receive an error when trying to save your changes, check that the permissions are set up correctly, and fix them if necessary.

* It is the responsibility of your organization to ensure that the user who creates the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors.

* For more information, see Managing access keys for IAM users.

###### 5.8.3.6.6. Ingest cloud assets

####### Note

* The cloud accounts being onboarded must be owned by the customer performing the onboarding process.

####### 5.8.3.6.6.1. Onboard Amazon Web Services

######## License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

######## Prerequisite

* Before you begin, ensure you have: Access to AWS Management Console Required AWS permissions

######## Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* When onboarding an AWS organization or organizational unit (OU), Cortex XSIAM creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

* See the prerequisites above for specific permissions required for serverless functions.

* If you select Automated, you must already be logged in to AWS.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only edit the instance from the Data Sources page. (AWS only) instances that were previously created in the Automation...

######## 5.8.3.6.6.1.1. Manually upload template to AWS

####### 5.8.3.6.6.2. Onboard Google Cloud Platform

######## License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

######## Prerequisite

* Before you begin, ensure you have: Access to Google Cloud Console Admin user with required admin GCP permissions Enabled the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled) Enabled the following APIs in the GCP project you are...

######## Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only modify the instance from the Data Sources page.

######## 5.8.3.6.6.2.1. Manually upload template to GCP

######## 5.8.3.6.6.2.2. Monitor GCP resources inside service perimeters

####### 5.8.3.6.6.3. Onboard Microsoft Azure

######## License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

######## Prerequisite

* Before you begin, ensure you have: An Azure subscription Admin permissions required to onboard Azure or the built-in Security Administrator role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups.

######## Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only modify the instance from the Data Sources page.

######## 5.8.3.6.6.3.1. Manually upload template to Microsoft Azure Resource Manager using the CLI

######## 5.8.3.6.6.3.2. Manually upload template for Microsoft Azure subscriptions

####### 5.8.3.6.6.4. Onboard Oracle Cloud Infrastructure

######## License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

######## Prerequisite

* Before you begin, ensure you have: Access to Oracle Cloud Infrastructure console Permissions for all of the following are required:    Creation of identity groups (for more information, refer to Managing Groups)   Policies (for more information, refer to How Policies Work)   Tag namespaces in the root compartment (for more information, refer to Tags...

######## Note

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only; you can only modify the instance from the Data Sources page.

######## 5.8.3.6.6.4.1. Manually upload template to OCI

####### 5.8.3.6.6.5. Configure AWS integration instances and monitor integration instance health

######## Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

####### 5.8.3.6.6.6. Manually connect a cloud instance

####### 5.8.3.6.6.7. Outposts

######## Prerequisite

* Before you begin, ensure you have: An AWS account Permission to create a stack and its resources in AWS Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the AWS CLI tool and configured your profile with the aws...

* Before you begin, ensure you have: A GCP account Permission to create the required resources in Google Cloud Deployment Manager Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool

* Before you begin, ensure you have: An active Azure subscription. Installed the Azure CLI tool. Permission to deploy a custom template and create its resources in Microsoft Azure ("Owner" or "Contributor" on the designated outpost subscription scope, and Active Directory "Cloud Application Administrator" or "Application Administrator" privileged...

######## Note

* We recommend you use a dedicated account for the outpost, free from other resources. You can only onboard one outpost for each account.

* When creating an outpost for a specific Azure subscription, the outpost account must be in the same Azure organization as the monitored subscriptions.

######## Navigation

  Settings → Data Collection → Outposts

  You can create a new outpost by navigating to Settings → Data Collection → Outposts and clicking New Outpost

####### 5.8.3.6.6.8. Container Registry Scanning

######## 5.8.3.6.6.8.1. Overview of container registry scanning

######### 5.8.3.6.6.8.1.1. Registry Components

######### 5.8.3.6.6.8.1.2. How Container Registry Scanning Works

######## 5.8.3.6.6.8.2. Configure registry scanning

######## 5.8.3.6.6.8.3. Modify the container registry scanning scope

######## 5.8.3.6.6.8.4. Scan re-evaluation process

######## 5.8.3.6.6.8.5. Connect Docker V2 compliant container registry

######### 5.8.3.6.6.8.5.1. Manage a Docker V2 connector

######## 5.8.3.6.6.8.6. Connect JFrog container registry

######### 5.8.3.6.6.8.6.1. Manage a JFrog connector

####### 5.8.3.6.6.9. Cloud service provider permissions

######## 5.8.3.6.6.9.1. Amazon Web Services provider permissions

######## 5.8.3.6.6.9.2. Google Cloud Platform provider permissions

######## 5.8.3.6.6.9.3. Microsoft Azure provider permissions

######## 5.8.3.6.6.9.4. Oracle Cloud Infrastructure provider permissions

###### 5.8.3.6.7. Ingest data for API security

####### 5.8.3.6.7.1. Ingest AWS API Gateway

######## Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

######## Important

* Leave '–'filter-pattern empty as displayed above.

####### 5.8.3.6.7.2. Ingest Azure APIM

######## License Type

  Requires the Data Collection add-on.

######## Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

######## Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

####### 5.8.3.6.7.3. Ingest Apigee Proxy

######## License Type

  Requires the Data Collection add-on.

######## Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

######## Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

####### 5.8.3.6.7.4. Ingest Kong

######## License Type

  Requires the Data Collection add-on.

######## Note

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

######## Important

* The size of the buffer must be equal to or larger than the max body size setting in the plugin configuration, on every data plane node.

###### 5.8.3.6.8. Ingest data from third-party pipeline solutions

####### 5.8.3.6.8.1. Ingest data from Cribl

######## Prerequisite

* Ensure that you have the credentials and IDs for each data source, such as Tenant ID, App ID and Client secret.

* Ensure that you have the copies of the Cortex XSIAM authorization token and API URL obtained in Task 2.

######## Note

* We do not support email data collection via Cribl.

* Only one Cribl data collector instance can be configured in Cortex XSIAM.

######## 5.8.3.6.8.1.1. Data source UUIDs

###### 5.8.3.6.9. Additional log ingestion methods

####### 5.8.3.6.9.1. Ingest logs from a Syslog receiver

####### 5.8.3.6.9.2. Ingest Apache Kafka events as datasets

####### 5.8.3.6.9.3. Ingest CSV files as datasets

####### 5.8.3.6.9.4. Ingest database data as datasets

####### 5.8.3.6.9.5. Ingest logs in a network share as datasets

######## Note

* The Files and Folders Collector applet only starts to collect files that are more than 256 bytes.

####### 5.8.3.6.9.6. Ingest FTP files as datasets

####### 5.8.3.6.9.7. Ingest NetFlow flow records as datasets

####### 5.8.3.6.9.8. Set up an HTTP log collector to receive logs

######## Note

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor...

* Each record cannot exceed 5 MB in size.

####### 5.8.3.6.9.9. Ingest logs from BeyondTrust Privilege Management Cloud

######## Note

* For a Log Format set to Beyondtrust Cloud ECS, the following fields are automatically set and not configurable. Vendor: Beyondtrust Product: Privilege Management Compression: Uncompressed

####### 5.8.3.6.9.10. Ingest logs and data from Box

######## Prerequisite

* Set up an Enterprise Box plan.  Important To collect Box Shield Alerts, you must purchase Box Shield and it must be enabled on Box enterprise. Set up an Enterprise Box plan. Create a valid Box account that is assigned to a role with sufficient permissions for the data you want to collect. For example, create an account assigned to an Admin role to...

######## Note

* The Fetch Intervals are non-configurable.

* Collecting Box Shield Alerts requires implementing Box Shield,

* There is a current bug with the Groups API from Box. If you don't configure the Box app with the proper permissions for managing groups data, the Groups API from Box won't return an error message to Cortex XSIAM indicating that the API failed to receive the data, and the Groups data will not be collected.

* For any future change that you make to your Box app, ensure that you send the changes for approval to the administrator, who will need to approve them as explained above.

* Inventory data snapshots are collected every 10 minutes.

####### 5.8.3.6.9.11. Ingest logs and data from Dropbox

######## Prerequisite

* Set up an Advanced Dropbox plan. Create a Dropbox Business admin account with Security admin permissions, which is required to authorize Cortex XSIAM to access the Dropbox Business account and generate the OAuth 2.0 access token.

######## Note

* The Fetch Interval is non-configurable.

* When the App Key field is empty, the here link in the tooltip is disabled. When an incorrect App Key is entered, clicking the link results in a 404 error.

* Whenever you change the permissions of the Dropbox app, we recommend that you generate a new Access Code for the Dropbox data collector instance so that the permissions match the updates.

* Event data is collected every 60 seconds with a 10 minute lag time.

* Inventory data snapshots are collected every 10 minutes.

####### 5.8.3.6.9.12. Ingest logs from Elasticsearch Filebeat

######## Navigation

  You can return to the Settings → Configurations → Data Collection → Data Sources page to monitor the status of your Filebeat configuration

####### 5.8.3.6.9.13. Ingest logs from Forcepoint DLP

####### 5.8.3.6.9.14. Ingest logs from Proofpoint Targeted Attack Protection

####### 5.8.3.6.9.15. Ingest logs and data from Salesforce.com

######## Prerequisite

* Cortex XSIAM:    To manage collection integration in Cortex XSIAM, ensure that you have the privilege to View/Edit Log Collections (for example, Instance Administrator). Cortex XSIAM: To manage collection integration in Cortex XSIAM, ensure that you have the privilege to View/Edit Log Collections (for example, Instance...

######## Note

* For more detailed reference information, see Configure a Connected App for the OAuth 2.0 Client Credentials Flow. Unlike other data collector setups, in this case, the setup includes obtaining an OAuth 2.0 code from Salesforce.com, and this code is only valid for 15 minutes. Therefore, make sure that you enable the data collector within 15 minutes of...

* When these options are cleared, only these data types will be omitted from collection. All other data will be collected as usual.

####### 5.8.3.6.9.16. Ingest data from ServiceNow CMDB

####### 5.8.3.6.9.17. Ingest report data from Workday

######## Prerequisite

* Create an Integration System User that is designated to access the custom report from Workday for data collection in Cortex XSIAM. Create an Integration System Security Group for the Integration System User created in Step 1 for accessing the report. When setting this group ensure to define the following:    Type of Tenanted Security Group: Select...

######## Note

* Any user with permissions to view issues and cases can view the Workday data.

* For more information on completing any of the prerequisite steps, see the Workday documentation.

* The Business Object changes depending on the Data Source selected.

* Cortex XSIAM uses a structured schema when integrating Workday data. To get the best Analytics results, specify all the fields marked with an asterisk from the recommended schema. workday_user_id* full_name* workday_manager_user_id* manager* worker_type* position_title* department* private_email_address* business_email_address* employment_start_date* em...

####### 5.8.3.6.9.18. Ingest external alerts

######## Note

* If you send pre-parsed alerts using the Cortex XSIAM API, additional mapping is not required.

######## Navigation

  In Cortex XSIAM, select Settings → Configurations → Data Collection → External Issue Mapping

##### 5.8.3.7. Onboard the Kubernetes Connector

###### License Type

  Requires the Cortex Cloud Posture Management add-on.

###### Note

* For GKE or EKS clusters with the metadata service disabled and for AKS clusters with non-default nodes managed resource group, the cluster resource identifier must be specified.

###### 5.8.3.7.1. What's new in Kubernetes Connector?

####### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### 5.8.3.8. Automation and feed integrations

###### Note

* Some integrations can be downloaded directly without having to initially download a content pack from Marketplace. For more information, see Define data sources. In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as...

* If the integration was installed from a content pack, you need to duplicate the integration before editing.

* If the integration was installed from a content pack, you need to duplicate the integration before downloading.

* Integration commands are only available when the integration instance is enabled. Some commands depend on a successful connection between Cortex XSIAM and third-party integrations.

###### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

###### 5.8.3.8.1. Integration use cases

###### 5.8.3.8.2. Add an integration instance

####### Note

* This procedure describes how to add an integration instance from the Automation and Feed Integration page. Some integration instances can also be configured on the Data Sources page. For more information, see Add a new data source or instance.

* In some integrations, a classifier, an issue type, and mapper fields are included.

####### Navigation

  Settings → Configurations → Data Collection → Automation & Feed Integrations and search for the integration

###### 5.8.3.8.3. Configure integration permissions

####### Navigation

  Settings → Configurations → Data Collection → Integration Permissions

###### 5.8.3.8.4. Fetch issues from an integration instance

####### Note

* In some integrations, the Issue Fetch interval is called Feed Fetch Interval. If the integration instance does not have the Issue Fetch Interval field, you need to add this field by editing the integration settings. If the integration is from a content pack, you need to create a copy of the integration. Any future updates to this integration will not...

* Some content packs include preconfigured correlation rules, but you should review them to see if they suit your use case and duplicate them if required. Go to Threat Management → Detection Rules → Correlations, search for the relevant rule, right-click, and select Preview Rule. For example, the ServiceNow v2 Alerts (automatically generated)...

####### 5.8.3.8.4.1. Map fields to issue types

######## Note

* In the Classification & Mapping page, the mapping does not indicate for which issue types they are configured. Therefore, when creating a mapper, it is best practice to add to the mapper name, the issue types the mapper is for. For example, Mail Listener - Phishing.

* When mapping a list, we recommend you map to a multi select field. Short text fields do not support lists. If you do need to map a list to a short text field, add a transformer in the relevant playbook task, to split the data back into a list.

######## Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

  Settings → Configurations → Data Collection → Automation & Feed Integrations

####### 5.8.3.8.4.2. Classify events using a classifier for issue types

######## Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

  Settings → Configurations → Data Collection → Automation & Feed Integrations

###### 5.8.3.8.5. Troubleshoot Integrations

###### 5.8.3.8.6. Forward Requests to Long-Running Integrations

####### Note

* This integration replaces the External Dynamic list integration, which is deprecated. For more information about how to set up the integration, see Manage external dynamic lists.

* When running on the tenant, you can only use long-running integrations provided by Cortex XSIAM, you cannot create custom ones. Custom long-running integrations are supported only on engines at this time. Configuring custom certificates or private API Keys in the long-running integration instance is supported only on engines, not on the Cortex XSIAM...

* For the TAXII Server and TAXII2 Server integrations, the xdr string is automatically replaced by crtx. For the Microsoft Teams integration, you can use the microsoft-teams-create-messaging-endpoint command to get the correct messaging endpoint based on the server URL, the server version, and the instance configurations. For more information, see...

##### 5.8.3.9. Verify collector connectivity

###### Note

* For more information on troubleshooting data collector applet errors, see Troubleshoot Broker VM applet connectivity.

* If an issue is triggered, the investigation options in the right-click menu of the Health Issues pages are context-specific. Make sure that you specify the relevant issue category.

##### 5.8.3.10. Overview of data ingestion metrics

###### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics. Data Ingestion Monitoring: Go to Configurations → General → Server...

###### 5.8.3.10.1. Creating correlation rules to monitor data ingestion health

###### 5.8.3.10.2. Measuring data freshness

####### Note

* The max_delay metric is taken from the maximum bucket value with a restricted limit; therefore, metrics show whole numbers. The median and ninetieth_percentile metrics are statistical calculations that give an approximation of the real value; therefore, metrics show decimal numbers. Time slots with a zero log count or zero byte count display records...

##### 5.8.3.11. About health issues

###### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics. Data Ingestion Monitoring: Go to Configurations → General → Server...

###### Note

* The Health Issues page displays issues that were triggered after July 2024. To see health issues that were triggered before this date, click Legacy Health Issues.

* Cortex XSIAM enforces the dedup logic to health issues. This logic reduces the likelihood of identical health issues from flooding the issues dataset.

###### 5.8.3.11.1. Investigate and resolve health issues

###### 5.8.3.11.2. Monitor data ingestion health

####### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable Data Ingestion Monitoring in your Server Settings. For more information, see Set up your environment.

###### 5.8.3.11.3. Monitor correlation rules

####### Note

* In the dataset, the Query start time and Query end time indicate the timeframe of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

#### 5.8.4. Dataset management

##### License Type

  Managing Roles requires an Account Admin or Instance Administrator role. For more information, see Predefined user roles.

##### Note

* Cold storage, in addition to a cold storage license, requires compute units (CU) to run cold storage queries. For more information on CU, see Manage compute units. For information on the CU add-on license, see Understand the Cortex XSIAM license planUnderstand the Cortex XSIAM license plan.

* Only datasets that are already handled as part of the GB license are supported for this license. In addition, the retention configuration is only available in Cortex XSIAM, as opposed to the public APIs.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default. Datasets include dataset permission enforcements in the Cortex Query Language(XQL), Query Center, and XQL Widgets. For example, to view or access any of the endpoints and host_inventory datasets, you need role-based access control (RBAC)...

* You'll only be able to save the dataset view if the query contains no errors; otherwise, the Save button is disabled.

* For more information on user roles, see Manage user roles.

##### Important

* Cortex XSIAM enforces retention on all log-type datasets excluding Host Inventory, Vulnerability Assessment, Metrics, and Users.

* This column is updated once a day. Therefore, if the dataset was created or updated by the target or lookup flows, it's possible that the Last Updated value is a day behind when the queries or reports were run as it was before this column was updated.

##### 5.8.4.1. What are datasets?

###### Note

* For more information on tasks specific to lookup datasets, see Lookup datasets.

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

###### Important

* By default, forensic datasets are not included in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

##### 5.8.4.2. Lookup datasets

###### Note

* A lookup dataset can only be deleted if there are no other dependencies. For example, if a Correlation Rule is based on a lookup dataset, you wouldn't be able to delete the lookup dataset until you removed the dataset from the XQL query of the Correlation Rule.

###### 5.8.4.2.1. Import a lookup dataset

####### Prerequisite

* When uploading a CSV, TSV, or JSON file, ensure that the file meets the following requirements: The maximum size for the total data to be imported into a lookup dataset is 30 MB from the Dataset Management page. Otherwise, the limit is 50 MB using Cortex Query Language (XQL) or APIs. Field names can contain characters from different languages, special...

####### Important

* The name of a dataset created from a TSV file must always include the extension. For example, if the original file name is mrkdptusrsnov23.tsv, you can save the dataset with the name marketing_dept_users_Nov_2023.tsv.

###### 5.8.4.2.2. Download JSON file of lookup dataset

####### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

###### 5.8.4.2.3. Set time to live for lookup datasets

####### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

##### 5.8.4.3. Monitor datasets and dataset views activity

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 5.8.5. Archived data

##### 5.8.5.1. Import historical data into cold storage

###### License Type

  Importing historical data into cold storage requires a Period-Based Retention - Cold Storage add-on license.

###### Prerequisite

* Importing historical data into cold storage requires a View/Edit RBAC permission for Data Management (under Configurations).

##### 5.8.5.2. Building XQL archived data queries

###### Prerequisite

* Archived cold storage, in addition to a Period-Based Retention - Cold Storage add-on license, requires compute units (CU) to run archived cold storage queries. Cortex XSIAM provides a free daily quota of compute units (CU) allocated according to your license size. Queries run without enough quota will fail. To expand your investigation capabilities,...

##### 5.8.5.3. Success and failure code responses to your HTTP POST requests

#### 5.8.6. Parsing Rules

##### 5.8.6.1. What are Parsing Rules?

###### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

##### 5.8.6.2. Parsing Rules editor views

###### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

##### 5.8.6.3. Parsing Rules file structure and syntax

###### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Cortex XQL Language Reference.

* An inner type of join stage is only supported in CONST, INGEST, and RULE sections and is not supported in a COLLECT section. You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

* The regexcapture function is only supported in Parsing Rules and cannot be used in any other XQL query.

* Every statement in the Parsing Rules file must end with a semicolon (;).

###### 5.8.6.3.1. INGEST

####### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* You can't add tags to parsing rules using the Next-Generation Firewall (NGFW) datasets that are in the format panw_ngfw_<text>_raw, and the Observability dataset called panw_observability_raw.

###### 5.8.6.3.2. COLLECT

####### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

####### Note

* The CSV Collector applet is not affected by the COLLECT rules applied to a Broker VM.

####### Tip

* To reduce the amount of data transmitted to Cortex XSIAM from the broker, use filters to drop logs. Yet, be aware that once the logs are modified using alter or fields stages, the Broker VM will convert the original log into a JSON format, which could increase the data size being sent from the broker to Cortex XSIAM.

###### 5.8.6.3.3. CONST

####### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

####### Note

* The dollar sign ($) must be adjacent to the [CONST] name, without any whitespace in between.

####### Important

* Only quoted or integer terminal values are considered valid for CONST sections.

###### 5.8.6.3.4. RULE

####### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Get started with XQL.

* You can also add tags using only the INGEST section. For more information, see INGEST.

###### 5.8.6.3.5. EXTEND

####### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Get started with XQL.

##### 5.8.6.4. Create Parsing Rules

###### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* You need Cortex XSIAM administrator or Instance Administrator permissions to access the Simulate view and perform these tests.

##### 5.8.6.5. Troubleshooting Parsing rules errors

###### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* Some errors can only be found after the applicable logs are collected in Cortex XSIAM.

##### 5.8.6.6. Parsing Rules Raw Dataset

###### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

#### 5.8.7. Data Model Rules

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

##### 5.8.7.1. What are Data Model Rules?

###### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

##### 5.8.7.2. Data Model Rules editor views

###### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

##### 5.8.7.3. Data Model Rules file structure and syntax

###### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

* For more information on XQL syntax, see the XQL Language Reference Guide.

* You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

###### 5.8.7.3.1. MODEL

####### Note

* The Settings → Configurations → XQL Configuration → Case Sensitivity (case_sensitive) setting can overwrite this case_sensitive configuration for all fields in the application except for BIOCs, which will remain case insensitive no matter what this setting is set to. For more information on this setting, see XQL Configuration.

* We recommend that you do not configure the same data source in both Marketplace and using a Cortex XSIAM data collector. Yet, if you do, the following will happen: For network data, all relevant logs from the different data sources are stitched to the same network story. For authentication data, all relevant logs from the different data sources are...

###### 5.8.7.3.2. RULE

####### Note

* For more information on the XQL syntax, see the XQL Language Reference Guide.

###### 5.8.7.3.3. Field structure

####### Note

* For more information on these data model fields, see Cortex XSIAM Data Model Schema.

##### 5.8.7.4. How to map authentication story events?

###### Prerequisite

* Familiarize yourself with the Cortex Data model (XDM) schema for field definitions and naming conventions, see Cortex XSIAM Data Model Schema.

###### Important

* This Feature focuses on authentication events related to SSO (Single Sign-On) and SaaS (Software-as-a-Service) application authentications. It does not cover internal authentication mechanisms such as Kerberos, NTLM, or traditional domain logon events generated by on-premise infrastructure.

* To maximize the variety of issues that are retrieved based on the XDM authentication stories, we recommend that the following additional fields are populated: xdm.target.resource_name, xdm.logon.type, xdm.source.user_agent, and xdm.source.host.device_category. Should you decide to change the default XDM mappings, ensure that both the mandatory and...

##### 5.8.7.5. Create Data Model Rules

###### Prerequisite

* Data Model Rules editor views Data Model Rules file structure and syntax How to map authentication story events?

###### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

###### Navigation

  In Cortex XSIAM, select Settings → Configurations → Data Management → Data Model Rules

##### 5.8.7.6. Troubleshooting Data Model Rules

###### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

* Since this dataset also contains Parsing Rules errors, some of the fields are irrelevant for Data Model Rules and aren't included in the table.

###### Tip

* To ensure you and your colleagues stay informed about Data Model Rules activity, you can also Configure notification forwarding to forward your Data Model Rules audit logs to an email distribution list or Syslog server. For more information about the Data Model Rules audit logs, see Monitor Data Model Rules activity.

##### 5.8.7.7. Using data enrichment

###### Note

* For a complete list of auto-enriched fields, see the Cortex Data Model Schema Guide.

###### Important

* When manually mapping ASN fields that are enriched, such as xdm.source.asn.as_number, with other ISP and domain fields that are not enriched, such as xdm.source.asn.isp and xdm.source.asn.domain, it's possible to receive incorrect XDM query results due to the misalignment between the overridden enrichement and system enrichment fields.

##### 5.8.7.8. Data Model Rules notifications

##### 5.8.7.9. Monitor Data Model Rules activity

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 5.8.8. Manage Event Forwarding

##### License Type

  This feature requires an Event Forwarding add-on license. Only Administrators have access to this screen.

##### Important

* Since data is aggregated and compressed, it can take up to two hours until the data is available in the forwarding bucket.

##### Navigation

  Under Settings → Configurations → Data Management → Event Forwarding, activate the licenses in the Activation section

##### 5.8.8.1. Endpoints Event Forwarding - included/excluded fields by event type

###### License Type

  This feature requires an Event Forwarding add-on license. Only Administrators have access to this screen.

#### 5.8.9. Manage compute units

##### Note

* For more information, see Import historical data into cold storage.

* The CU consumption of cold storage queries is based on the number of days in the query time frame. For example, when querying 1 hour of a specific day, the CU of querying this entire day is consumed. When querying 1 hour that extends past 2 days, such as from 23:50 to 00:50 of the following day, the CU of querying these two days is consumed.

##### 5.8.9.1. Compute units usage

###### Note

* To enable the add-on, select Settings  → Configurations → Cortex XSIAM License → Addons tile, and select the Compute Unit tile and Enable.

###### Navigation

  Settings → Configurations → Data Management → Compute Unit Usage

### 5.9. Vulnerability management

#### 5.9.1. Vulnerability management in Cortex XSIAM

##### Note

* Cortex XSIAM vulnerability management provides the ability to identify and assess runtime vulnerabilities in every asset across traditional IT and cloud environments. For vulnerabilities detected in your software development lifecycle through application security scans, refer to the Cortex Cloud Application Securitydocumentation.

##### 5.9.1.1. Cortex XSIAM vulnerability concepts

###### Note

* CVE is an acronym for Common Vulnerabilities and Exposures, which is a list of publicly disclosed security threats. We often use the term "CVE" to refer to a vulnerability that has been a assigned a CVE ID. Cortex XSIAM identifies CVEs and non-CVE vulnerabilities.

##### 5.9.1.2. Vulnerability Management dashboard

#### 5.9.2. Vulnerability policies

##### 5.9.2.1. Create a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

##### 5.9.2.2. Update the Ignored CVEs, Asset Groups, and Assets policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

##### 5.9.2.3. Modify a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

##### 5.9.2.4. Enable or disable a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

#### 5.9.3. Investigate and remediate vulnerabilities

##### 5.9.3.1. View all Vulnerabilities

###### Navigation

  Posture Management → Vulnerability Management → Vulnerabilities

##### 5.9.3.2. View vulnerability issues

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

##### 5.9.3.3. View All Vulnerability Findings

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues and click the All Vulnerability Findings button

##### 5.9.3.4. View vulnerable assets

###### Navigation

  Posture Management → Vulnerability Management → Vulnerable Assets

#### 5.9.4. Vulnerability Intelligence

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

#### 5.9.5. Recast CVSS scores and CVSS severities

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

### 5.10. Marketplace

#### 5.10.1. Cortex Marketplace

#### 5.10.2. Content packs

##### Note

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

#### 5.10.3. Content Pack Support Types

##### Note

* Palo Alto Networks is not liable for and does not warrant or support any content pack produced by a third-party publisher. Palo Alto Networks does not support content packs that do not have official available documentation.

#### 5.10.4. Cortex XSIAM content

#### 5.10.5. Manage content packs

##### Note

* Optional content packs that are already installed are treated like they are required content packs to preserve content integrity.

* In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as scripts or integrations.

* Third-party product Integrations are developed and tested against a specific product version. For products that are on-prem or cloud-based with specific API versions, the version developed and tested against will be included in the integration's documentation. Newer versions of the product are not always immediately tested, and it is expected that...

##### Caution

* If another content pack is dependent on the content pack you want to delete, it may break the other content pack. You can reinstall the content pack, but you cannot restore detached and customized content.

* If you want to downgrade, any content that depends on the content pack including any customizations may be deleted if it does not exist in the target content pack version.

#### 5.10.6. Marketplace FAQs

#### 5.10.7. Content changes when upgrading Cortex XSIAM versions

#### 5.10.8. Content pack contributions

## 6. Reference and developer docs

### 6.1. Cortex XSIAM XQL

#### 6.1.1. Get started with XQL

##### 6.1.1.1. XQL language features

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

###### Navigation

  You submit XQL queries to Cortex XSIAM using the Investigation & Response → Search → Query Builder user interface

##### 6.1.1.2. XQL Language Structure

###### 6.1.1.2.1. Adding comments in queries

##### 6.1.1.3. Supported operators

###### Note

* In some cases, using an IN or NOT IN operator combined with a dataset and filter stage can be a better alternative to using a join stage.

##### 6.1.1.4. Datasets and presets

###### Note

* To set up this Cloud Identity Engine (previously called Directory Sync Service (DSS)) dataset, you need to set up a Cloud Identity Engine. Otherwise, you will not have a pan_dss_raw dataset. For more information, see Set up Cloud Identity Engine.

* INFO issues are not included in this dataset. This dataset includes issues from the Security and Health domains. For more information, see Overview of the Issues page.

* The fields contained in this dataset are a subset of the fields in the xdr_data dataset.

* If the vendor and product are not specified in the Winlogbeat profile's configuration file, Cortex XSIAM creates a default dataset called microsoft_windows_raw.

* To ensure GlobalProtect access authentication logs are sent to Cortex XSIAM, verify that your PANW firewall's Log Settings for GlobalProtect has the Cortex Data Lake checkbox selected.

* You must have the Cortex XSIAM Threat Intel Management (TIM) Add-on to use this dataset.

* You can query in XQL for this data and build widgets based on the xdr_data dataset or using the preset device_control. To view in an XQL query these events, the Device Configuration of the endpoint profile must be set to Block. Otherwise, the USB events are not captured. The events are also captured when a group of device types are blocked on the...

###### Important

* This dataset will not be updated after June 2024. Use the health_alerts dataset instead.

##### 6.1.1.5. About examples

###### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

##### 6.1.1.6. JSON functions

###### Important

* JSON field names are case sensitive, so the key to field pairing must be identical in an XQL query for results to be found. For example, if a field value is "TIMESTAMP" and your query is defined to look for "timestamp", no results will be found.

##### 6.1.1.7. How to filter for empty values in the results table

##### 6.1.1.8. Understanding string manipulation in XQL

#### 6.1.2. Build XQL queries

##### 6.1.2.1. About the Query Builder

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

##### 6.1.2.2. How to build XQL queries

###### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

###### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

###### 6.1.2.2.1. Get started with XQL queries

####### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

###### 6.1.2.2.2. Useful XQL user interface features

####### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

###### 6.1.2.2.3. XQL Query best practices

###### 6.1.2.2.4. Expected results when querying fields

###### 6.1.2.2.5. Create XQL query

####### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

####### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

###### 6.1.2.2.6. Review XQL query results

####### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* In order for Cortex XSIAM to provide a histogram for a field, the field must not contain an array or a JSON object.

###### 6.1.2.2.7. Translate to XQL

####### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

###### 6.1.2.2.8. Graph query results

####### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### 6.1.2.3. Query Builder templates

###### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

###### 6.1.2.3.1. Get started with Query Builder templates

###### 6.1.2.3.2. Considerations for using Query Builder templates

###### 6.1.2.3.3. Create a query from a template

####### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

###### 6.1.2.3.4. Run a free text query

####### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

###### 6.1.2.3.5. Query Builder template examples

####### Navigation

  Investigation & Response → Search → Query Builder

##### 6.1.2.4. Edit and run queries in Query Center

###### Navigation

  Investigation & Response → Search → Query Center

###### 6.1.2.4.1. Query Center reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 6.1.2.5. Manage scheduled queries

###### Navigation

  Investigation & Response → Search → Scheduled Queries

###### 6.1.2.5.1. Scheduled Queries reference information

####### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

##### 6.1.2.6. Manage your personal query library

###### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

##### 6.1.2.7. Legacy Query Builder

###### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

###### 6.1.2.7.1. Create authentication query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 6.1.2.7.2. Create event log query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 6.1.2.7.3. Create file query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 6.1.2.7.4. Create image load query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 6.1.2.7.5. Create network connections query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 6.1.2.7.6. Create network query

####### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

###### 6.1.2.7.7. Create process query

####### Navigation

  Investigation & Response → Search → Query Builder

###### 6.1.2.7.8. Create registry query

####### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

###### 6.1.2.7.9. Query across all entities

####### Navigation

  Investigation & Response → Search → Query Builder

#### 6.1.3. Stages

#### 6.1.4. Functions

### 6.2. Graph Search

#### 6.2.1. What is Graph Search?

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Note

* Graph Search is a Beta feature and is still subject to changes. To enable the feature in your tenant, contact your Customer Support Team.

#### 6.2.2. Get started with Graph Search queries

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Navigation

  Understand your assets and findings data: Graph Search queries are based on the current data that has been collected for assets and findings from the data sources configured and then sent to the Unified Asset Inventory (UAI), which is displayed in the All Assets page (Inventory → Assets → All Assets

#### 6.2.3. How to build Graph Search queries?

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Navigation

  You submit Graph Search queries using the Investigation & Response → Search → Query Builder → Graph Search built-in query interface

#### 6.2.4. Understand Graph Search query results

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

#### 6.2.5. Create Graph Search query

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Note

* For more information about the Query Library, see Manage Graph Search Query Library.

##### Tip

* After running the query, you can view the complete query by hovering over the last THAT... in the Graph Search query interface, and the query is displayed in a tooltip. If your query doesn't find any results or you want to change your query for any reason, you can always click anywhere in the Graph Search query interface, where your existing query is...

#### 6.2.6. Graph Search examples

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

#### 6.2.7. Manage Graph Search Query Library

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Navigation

  From Graph Search in the Query Builder Select Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Center

#### 6.2.8. Edit and run queries in Query Center

##### Navigation

  Investigation & Response → Search → Query Center

##### 6.2.8.1. Query Center reference information

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 6.2.9. Supported assets and findings

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

#### 6.2.10. FAQ on Beta Graph Search feature

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

### 6.3. Cortex CLI

#### Note

* The CLI Read Only Role is not supported for CWP as the system does not support offline mode.

#### 6.3.1. Connect Cortex CLI

##### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

##### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Application Security, refer to Cortex CLI usage for Application Security

##### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

#### 6.3.2. Cortex CLI common command line reference guide

##### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

#### 6.3.3. Cortex CLI for Cloud Workload Protection

##### Prerequisite

* Ensure you have the required user permissions. Refer to Cortex CLI for more information Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more information Verify that Java version 11 and above is installed: Run java -version in your terminal. If not, refer to Java SE Development Kit 11.0.25 for information about installing Java

* Before you begin, ensure you have sudo privileges to execute the image scan.

##### Note

* The output contains the number of created issues for malware, secrets, and vulnerabilities, organized by severity, based on the current policy configuration.

##### 6.3.3.1. Cloud Workload Protection command line reference

#### 6.3.4. Cortex CLI for API Security

##### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more information Ensure your application exposes APIs and provides a corresponding OpenAPI Specification file Ensure that you have installed Java v 11 and above

##### 6.3.4.1. Cortex CLI API Security command line reference guide

#### 6.3.5. Cortex CLI for Application Security

##### Prerequisite

* For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

##### 6.3.5.1. Cortex CLI usage for Application Security

##### 6.3.5.2. Cortex CLI Application Security command line reference

###### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

###### Important

* The Cortex CLI Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id <YOUR_AUTH_ID>...

##### 6.3.5.3. CLI pipeline code snippets

#### 6.3.6. Migrate Cortex CLI

##### Prerequisite

* Before you begin, ensure you have the following: Ensure you have an active API key for your Cortex Cloud tenant with associated CLI role permissions. Refer to Manage API keys for more information Install the Cortex CLI. You can find the installation instructions here

### 6.4. Cortex XSIAM 3.x Documentation

### 6.5. Reference

#### 6.5.1. Cloud service provider permissions

##### 6.5.1.1. Amazon Web Services provider permissions

##### 6.5.1.2. Google Cloud Platform provider permissions

##### 6.5.1.3. Microsoft Azure provider permissions

#### 6.5.2. Microsoft Windows security auditing setup

##### 6.5.2.1. Enable security auditing event IDs

###### Note

* We recommend you configure security auditing using Group Policy Object (GPO). Using GPO simplifies audit management and ensures that auditing settings are uniformly applied across your network, reducing the risk of misconfigurations on individual machines.

###### 6.5.2.1.1. Enable security auditing event IDs with GPO

####### Note

* We recommend that you configure the Group Policy Object (GPO) to apply to all endpoints and not just Domain Controllers. This ensures comprehensive auditing across your entire network.

####### Navigation

  Server Manager → Tools → Group Policy Management

  Computer Configuration → Policies → Windows Settings → Security Settings → Advanced Audit Policy Configuration → Audit Policies

###### 6.5.2.1.2. Set up local machine security auditing without GPO

###### 6.5.2.1.3. Additional setup for Active Directory Certificate Services (ADCS) events

####### Note

* Enabling auditing for Active Directory Certificate Services (ADCS) restarts (events 4880 and 4881) can significantly slow down the service if you have a large database. To prevent delays: Clean up the database: Remove any unnecessary entries to reduce its size. Skip this audit: If restart speed is critical, consider not enabling auditing for ADCS...

###### 6.5.2.1.4. Enable auditing access to AD domain objects - 4662

####### Note

* The Descendant msDS-DelegatedManagedServiceAccount Objects configuration is relevant only for Windows Server 2025.

##### 6.5.2.2. Enable additional event logs using Event Viewer

###### Navigation

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → User Profile Service, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → CAPI2, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → DNS Client Events, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → DriverFrameworks-UserMode, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → PowerShell, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → Windows Defender, right click Operational and select Enable Log

  In Event viewer → Application and Services Logs → Microsoft → Windows → TerminalServices-ClientActiveXCore → Microsoft-Windows-TerminalServices-RDPClient, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → Windows Firewall With Advanced Security → Firewall, right click Operational and select Enable Log

##### 6.5.2.3. Enable LDAP server events logging (1644)

###### 6.5.2.3.1. Enable LDAP server events logging using RegEdit

###### 6.5.2.3.2. Enable LDAP server events logging using GPO

####### Navigation

  Computer Configuration → Preferences → Windows Settings → Registry

###### 6.5.2.3.3. Validate log collection for LDAP Server events

#### 6.5.3. XDM fields for mapping authentication events

##### Note

* For more information on the entire Cortex Data model (XDM) schema, see Cortex XSIAM Data Model Schema.

* Do not map a static string, list, or empty string. You must map this field from the raw log field that best represents the actual source IP used in the authentication attempt. In cases where multiple IP fields are available, such as client_ip, source_ip, and original_client_ip, choose the field that captures the IP address from which the user initially...

* Mapping should be done per event type. The same system could be an IDP in one event and an SP in another.

* For more information on the event outcome constants in the Cortex Data Model, see XDM_CONST.OUTCOME.

* Outcome is based on a conclusive event type reflecting the true end state of the authentication flow.Critical for effectiveness of detection rules. Incorrect derivation can lead to missed detections or false positives.

* These are the most common values, but other logon types also exist. For a complete list, see XDM_CONST.LOGON_TYPE.

* For more information, see XDM_CONST.USER_TYPE.

* For more information, see XDM_CONST.PRIVILEGE_LEVEL.

* For more information, see XDM_CONST.OS_FAMILY.

* While xdm.network.session_id aggregates multiple user actions within a broader session window. xdm.session.context.id is used to correlate events that belong to a single authentication request or transaction.


## Cortex XSIAM Premium Documentation


---

## 1. Get started with Cortex XSIAM

### 1.1. Get started with Cortex XSIAM

#### 1.1.1. Cortex XSIAM architecture

##### Note

* You can host your Cortex Native Data Lake instance in either the United States (US) Region or the European Union (EU) Region.

* You can host your Directory Sync Service instance in either the US Region or EU Region.

### 1.2. Fair Usage policy for Cortex XSIAM

### 1.3. Cortex XSIAM product licenses

#### Note

* You can upgrade your license by purchasing add-ons or moving to a different XSIAM license.

#### 1.3.1. Data retention

#### 1.3.2. Data storage lifecycle

##### Tip

* You can view details about your Cortex XSIAM licenses by selecting Settings → Cortex XSIAM License.

#### 1.3.3. License allocation

##### Note

* It can take up to an hour for Cortex XSIAM to display revived endpoints.

#### 1.3.4. License expiration

#### 1.3.5. Upgrade your tenant

### 1.4. Security Operations Center roles and responsibilities

### 1.5. In-product support case creation

#### Note

* When opening a support case through the Customer Support Portal, you need to manually select Cortex XSIAM as the product. While there may be discrepancies between the categories in this wizard and the Customer Support Portal process, that's because this wizard is designed specifically to focus on options relevant to Cortex XSIAM.

* Selecting an endpoint from the endpoint table and retrieving TSF requires full Retrieve Endpoint Data permissions under Endpoint Administration.

* Console recordings cannot exceed 10 minutes. The current recording time is displayed at the top of the window.

### 1.6. Supported web browsers

### 1.7. Use the interface

#### Note

* Each SAML login session is valid for 8 hours. Some menu items only appear if you have the relevant license.

* CMD fields have a 128-character limit. Shorten longer query strings to 127 characters and add an asterisk (*).

* Deleting a shared view removes it for all users.

### 1.8. What is Cortex Gateway?

## 2. Onboard and configure Cortex XSIAM

### 2.1. Deployment steps

#### 2.1.1. Plan and prepare

#### 2.1.2. Cortex XSIAM onboarding checklist

##### Prerequisite

* Cloud Identity Engine must be set up.

##### Note

* Data collection for Windows endpoints is available with Traps 6.0 and later releases and on endpoints running Windows 7 SP1 and later releases. Data collection on macOS and Linux endpoints are available with Traps 6.1 and later releases.

#### 2.1.3. Activate Cortex XSIAM

##### Prerequisite

* The Cortex XSIAM activation email. A Customer Support Portal (CSP) account. You need to set up your CSP account. For more information, see How to Create Your CSP User Account. When you create a CSP account, you can set up two-factor authentication (2FA) to log into the CSP by using an Email, Okta Verify, or Google Authenticator (non-FedRAMP accounts)....

##### Note

* When you activate, a production tenant is first activated. After activation, you can set up a development tenant (subject to your license).

* Activation can take about an hour and does not require you to remain on the activation page. Cortex XSIAM sends a notification to your email when the process is complete.

* If you want to change your tenant's name, the subdomain, or activate a development tenant (subject to license), on the right-hand side, click the ellipsis. You can only change the subdomain once, and it cannot be undone. After deleting the subdomain, you can reuse it after 7 days.

##### 2.1.3.1. Bring your own keys

###### Prerequisite

* Access to BYOK (Bring Your Own Keys) functionality is restricted to tenants that were initially activated with BYOK.

* To disable your encryption keys and deactivate a tenant, you must have an Account Admin role.

###### Note

* The new keys you import will serve as primary encryption keys for newly generated data.

* At any stage, you can select Continue Later to pause the process. To resume the process, in the Cortex gateway, select Continue Setup next to the tenant, and follow the wizard instructions from the point you left off, as detailed below. If you don't use either of your wrapping keys within three days, they expire and you'll have to restart the process.

* BYOK requires a 32-byte, symmetric, unencoded key in binary format.

###### Caution

* Disabling all encryption keys and deactivating the tenant renders the tenant inaccessible and non-operational. Disabling the keys affects the communication with the agents, may prevent the agents from receiving updates to policies, configurations, and crucial information, and may result in loss of data. To secure your tenant data and to prevent...

##### 2.1.3.2. Cortex XSIAM supported regions

##### 2.1.3.3. Enable access to required PANW resources

###### Note

* <tenant-name> refers to the selected subdomain of your Cortex XSIAM tenant, and <region> is the region in which your tenant is deployed. For more information, see Cortex XSIAM supported regions.

#### 2.1.4. Set up users and roles

##### Note

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* The user who activated the Cortex product is assigned the Account Admin role. You cannot create additional Account Admin roles in the Cortex XSIAM tenant. If you do not want the user to have Account Admin permission, you must remove the Account Admin role in Cortex Gateway.

##### 2.1.4.1. User group management

###### Note

* You can create user groups in the tenant or Cortex Gateway. User groups created in Cortex Gateway cannot be mapped to SAML groups. Only user groups created in the tenant support SAML group mapping and scoring. We recommend creating user groups in the Cortex tenant because: User groups are available for all tenants, and you may want different user...

* If users have been created in the CSP, but you want them to access the tenant through SSO only, skip this field and add only SAML group mapping after SSO is set up, otherwise, users can access the tenant through both the CSP and SSO. If you have not yet created any users, skip this field and add them later. See Set up authentication .

* When using Azure AD for SSO, the SAML group mapping needs to be provided using the group object ID (GUID) and not the group name.

###### Important

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

##### 2.1.4.2. Assign user roles and groups

###### Note

* If an existing user in the Cortex Gateway no longer has a role or a user group assigned, the user is revoked. Any roles, user groups, or egress configurations created by that user are shown as created by Revoked user instead of the user's email address.

###### Important

* Setting Cortex Query Language (XQL) dataset access permissions for a user role can only be performed from Cortex XSIAM Access Management. For more information, see Manage user roles.

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit Users Permissions.

#### 2.1.5. Set up authentication

##### Tip

* You should have at least one user in the Customer Support Portal for backup, in case of any authentication issues with your IdP provider.

##### 2.1.5.1. Authenticate users through the Customer Support Portal

###### Note

* You must be assigned the Super User role in the Customer Support Portal to add users in the Customer Support Portal. The first Super User who logs into Cortex Gateway is automatically assigned the Account Admin role and has access to the tenant. The user who activates the Cortex XSIAM tenant will also be assigned the Account Admin role (if there is no...

* After users are added to the Customer Support Portal and they accept the invitation, you can manage them in Cortex Gateway or the Cortex XSIAM tenant.

##### 2.1.5.2. Authenticate users using SSO

###### Note

* To set up SSO authentication in the tenant, you must be assigned an Instance Administrator or Account Admin role. SAML 2.0 users must log in to Cortex XSIAM using the FQDN (full URL) of the tenant. To allow login directly from the IdP to , you must set the relay state on the IdP to the FQDN of the tenant. If you have multiple tenants, you must set up...

* The first SSO cannot be deleted, it can only be deactivated by toggling SSO Enabled to off. The Domain parameter is predefined for the first SSO. If you add additional SSO providers, you must provide the email Domain in the SSO Integration settings for all providers except the first. Cortex XSIAM uses this domain to determine to which identity provider...

* Cortex XSIAM requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex XSIAM. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a...

##### 2.1.5.3. Set up Okta as the Identity Provider Using SAML 2.0

###### Note

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Navigation

  Settings → Configurations → Access Management → Authentication Settings

  Settings → Configurations → Access Management → User Groups

##### 2.1.5.4. Set up Azure AD as the Identity Provider Using SAML 2.0

###### Note

* The default attributes shown on the main single sign-on page in Azure AD are not the values you need. You must click Edit next to Attributes and Claims to view and copy the actual values.

* The attribute claim name must exactly match the value sent by your IdP. In some cases, this may be the full attribute name/namespace, depending on the configuration of our IdP

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Important

* When copying the Single Sign-On URL value, remove idp/saml and leave the trailing /. For example, if the Single Sign-On URL is https://clientname.panproduct.region.paloaltonetworks.com/idp/saml, just copy https://clientname.panproduct.region.paloaltonetworks.com/.

###### Navigation

  Settings → Configurations → Access Management → User Groups

#### 2.1.6. Pre-installation steps for Cortex XDR agents

##### 2.1.6.1. Define endpoint groups

###### Note

* Disconnecting Cloud Identity Engine in your Cortex XSIAM deployment can affect existing endpoint groups and policy rules based on Active Directory properties.

##### 2.1.6.2. Manage endpoint profiles

##### 2.1.6.3. Endpoint data collection

###### Note

* For specific files only and only if the file was written.

###### Important

* Registry key is collected as a real key name, and not as a symbolic link. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, KEY_LOCAL_MACHINE\System\ControlSet001 will be collected. Instead of HKEY_CURRENT_USER, HKEY_USERS\<SID> will be collected, where SID is a SID of the current user.

##### 2.1.6.4. Configure global agent settings

###### Note

* Disabling this capability takes immediate effect on new hashes, fresh agent installations, and existing security policies. It could take up to a week to take effect on existing agents in your environment pending agent caching.

* If you have any Cortex XSIAM filters, starring policies, exclusion policies, scoring rules, log forwarding queries, or automation rules configured for XSOAR/3rd party SIEM, we advise you to update those to support the changes before activating the feature. For example, change the query to include the previous description that is still available in the...

#### 2.1.7. Install Cortex XDR agents

##### 2.1.7.1. Plan your agent deployment

##### 2.1.7.2. Guidelines for keeping Cortex XDR agents and content updated

###### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups. See how to define endpoint group.

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups.

###### Important

* When planning Cortex XDR agent upgrades and content updates, consult with the appropriate stakeholders and teams and follow the change management strategy in your organization.

###### Caution

* Before enabling Auto-Update for Cortex XDR agents, make sure to consult with all relevant stakeholders in your organization.

##### 2.1.7.3. Create an agent installation package

###### Note

* The profile will be applied if the security policy cannot be retrieved in real-time.

* The Cortex serverless library must be imported after other libraries to activate the hooks that enable auditing.

##### 2.1.7.4. Deploy agent installation packages

#### 2.1.8. Configure and deploy Cortex XSIAM

##### 2.1.8.1. Cortex XSIAM - Analytics

###### Prerequisite

* Before Cortex XSIAM - Analytics can start to analyze your endpoint data, perform the following steps: Configure Cortex XSIAM network parameters to monitor your internal networks. Enable the Analytics Engine. Make sure Cloud Identity Engine is set up. Enable Identity Analytics.

###### 2.1.8.1.1. Configure Cortex XSIAM network parameters

####### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

####### Navigation

  Inventory → Assets → Network Configuration → Internal Domain Suffixes

###### 2.1.8.1.2. Enable the Analytics Engine and Identity Analytics

####### Prerequisite

* Analytics Engine To create a baseline for enabling analytics, Cortex XSIAM requires a minimum of one of the following data sets: EDR or Network logs from at least 30 endpoints over a minimum of 2 weeks Cloud audit logs over a minimum of 5 days Identity Analytics Cortex XSIAM - Analytics must be activated. Cloud Identity Engine must be set up. For more...

####### Navigation

  Settings → Configurations → Cortex XSIAM - Analytics

##### 2.1.8.2. Cortex XSIAM engines

###### 2.1.8.2.1. Engine requirements

####### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

###### 2.1.8.2.2. Install an engine

####### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex XSIAM engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

####### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

####### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

##### 2.1.8.3. Set up Cloud Identity Engine

###### Note

* The Activate risk signal sharing to CIE checkbox is available only after the second step is completed.

###### Navigation

  Settings → Configuration → Integrations → Cloud Identity Engine

#### 2.1.9. Define data sources

##### Note

* Not all content packs are available to download on the Data Sources page. If you require content packs such as Phishing, and Malware, you need to download the pack from Marketplace and configure the integration. The Data Sources page is designed for third-party integrations to help you onboard.

* For some vendors, to receive data from an external source, you must first set up the Syslog Collector applet on a Broker VM within your network. For more information, see Activate Syslog Collector.

##### 2.1.9.1. Cortex XSIAM content

###### 2.1.9.1.1. Cortex Marketplace

###### 2.1.9.1.2. Content packs

####### Note

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

###### 2.1.9.1.3. Install content packs

####### Note

* Currently, not all content packs are supported in the Data Sources page. For example, content packs with several integrations are not yet supported.

* Content packs are also automatically installed when you adopt playbooks and configure tasks.

###### 2.1.9.1.4. Automation and feed integrations

####### Note

* Some integrations can be downloaded directly without having to initially download a content pack from Marketplace. For more information, see Define data sources. In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as...

* If the integration was installed from a content pack, you need to duplicate the integration before editing.

* If the integration was installed from a content pack, you need to duplicate the integration before downloading.

* Integration commands are only available when the integration instance is enabled. Some commands depend on a successful connection between Cortex XSIAM and third-party integrations.

####### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

####### 2.1.9.1.4.1. Manage API keys

######## Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

* You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

####### 2.1.9.1.4.2. Fetch issues from an integration instance

######## Note

* In some integrations, the Issue Fetch interval is called Feed Fetch Interval. If the integration instance does not have the Issue Fetch Interval field, you need to add this field by editing the integration settings. If the integration is from a content pack, you need to create a copy of the integration. Any future updates to this integration will not...

* Some content packs include preconfigured correlation rules, but you should review them to see if they suit your use case and duplicate them if required. Go to Threat Management → Detection Rules → Correlations, search for the relevant rule, right-click, and select Preview Rule. For example, the ServiceNow v2 Alerts (automatically generated)...

####### 2.1.9.1.4.3. Forward Requests to Long-Running Integrations

######## Note

* This integration replaces the External Dynamic list integration, which is deprecated. For more information about how to set up the integration, see Manage external dynamic lists.

* When running on the tenant, you can only use long-running integrations provided by Cortex XSIAM, you cannot create custom ones. Custom long-running integrations are supported only on engines at this time. Configuring custom certificates or private API Keys in the long-running integration instance is supported only on engines, not on the Cortex XSIAM...

* For the TAXII Server and TAXII2 Server integrations, the xdr string is automatically replaced by crtx. For the Microsoft Teams integration, you can use the microsoft-teams-create-messaging-endpoint command to get the correct messaging endpoint based on the server URL, the server version, and the instance configurations. For more information, see...

####### 2.1.9.1.4.4. Manage credentials

######## Navigation

  Settings → Configurations → Integrations → Credentials → New Credential

  Settings → Configurations → Data Collection → Automation & Feed Integrations and select the integration instance

####### 2.1.9.1.4.5. Integration use cases

####### 2.1.9.1.4.6. Troubleshoot Integrations

### 2.2. Post-deployment steps

#### 2.2.1. Perform health checks

##### 2.2.1.1. Monitor agent operational status in Cortex XSIAM

###### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex XSIAM management console for specific reasons for the state.

###### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

#### 2.2.2. Set up your environment

##### 2.2.2.1. Configure server settings

###### License Type

  Requires a Cortex XSIAM or Cortex XDR Pro license

###### Note

* Keyboard shortcuts, timezone, and timestamp format are not set universally and only apply to the user who sets them.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Requires the TIM add-on. By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled.

* Requires an MSSP License and RBAC permissions to Cases & Issues and Investigation & Response → Automation. This setting is available for the parent tenant only.

###### Navigation

  Settings → Configurations → General → Server Settings

##### 2.2.2.2. Configure security settings

###### Navigation

  Settings → Configurations → General → Security Settings

##### 2.2.2.3. Log forwarding

###### 2.2.2.3.1. Forward logs from Cortex XSIAM to external services

####### License Type

  Requires Cortex XDR per Endpoint

####### 2.2.2.3.1.1. Integrate a syslog receiver

######## Note

* Up to TLS 1.3 is supported. Make sure the self-signed CA includes your public key.

####### 2.2.2.3.1.2. Integrate Slack for outbound notifications

######## Note

* You are directed to the Slack browser to install Cortex XSIAM. You can only use this link to install Cortex XSIAM on Slack. Attempting to install from Slack Marketplace will redirect you to Cortex XSIAM documentation.

####### 2.2.2.3.1.3. Configure notification forwarding

######## Prerequisite

* Before you can select a syslog receiver or a Slack channel, you must integrate these external services with Cortex XSIAM. For more information, see: Integrate a syslog receiver Integrate Slack for outbound notifications

######## Note

* To configure notification forwarding for issues by domain, select Log Type = Issues and filter the Issues table by Issue Domain.

* This option will be deprecated in the next release. Configure issues with the filter Issue Domain = Health instead.

* When a notification is sent for each configured format.

####### 2.2.2.3.1.4. Monitor administrative activity

###### 2.2.2.3.2. Log notification formats

####### 2.2.2.3.2.1. Management audit log messages

####### 2.2.2.3.2.2. Issue notification format

####### 2.2.2.3.2.3. Agent Audit log notification format

####### 2.2.2.3.2.4. Management Audit log notification format

####### 2.2.2.3.2.5. Log format for IOC and BIOC issues

####### 2.2.2.3.2.6. Analytics log format

####### 2.2.2.3.2.7. Log formats

######## Note

* The FUTURE_USE tag applies to fields that Cortex XSIAM does not currently implement.

#### 2.2.3. Remote repository management

##### 2.2.3.1. Cortex XSIAM development tenant

###### Important

* Development tenants are not intended for performance checks; they cannot access production data, and they are connected to a limited number of endpoints. As a result, all development tenants have fewer resources than the production tenant, including data ingestion capacity and performance, and compute capabilities. In a development tenant, extreme...

##### 2.2.3.2. Set up a remote repository

###### Navigation

  If the content repository option is disabled for the production or development tenant (under Settings → Configurations → General → Remote Repository Settings, toggle the Content repository slider to off), the tenant becomes standalone and does not push or pull content

  If you are changing your remote repository settings, back up existing content to your local computer by navigating to Settings → Configurations → General → Server Settings → Custom Content and click Export all custom content

###### 2.2.3.2.1. Set up a built-in remote repository

####### Note

* Once enabled, development tenants have a red banner on the top left showing DEV.

* The first tenant that is enabled pushes its content to the remote repository first. For example, these instructions describe enabling the production tenant first, so the remote repository will initially contain production tenant content. You can enable a development tenant first if you want the remote repository to initially contain the content from...

####### Navigation

  Settings → Configurations → General → Remote Repository Settings and toggle the Content repository slider to enable the remote repository

###### 2.2.3.2.2. Set up a Private Remote Repository

####### Note

* Once enabled, the development push tenant has a red banner on the top left showing DEV.

* For repository vendors that use tokens, enter the token type in the username field and the token in the password field. Verify details with your vendor. If your private Git remote repository uses personal access tokens instead of usernames and passwords, enter the token type in the username field and the access token in the password field. For example,...

* You can't add an engine that has been added to a Load-Balancing Group.

* If your private Git remote repository uses personal access tokens instead of usernames and passwords, enter the access token in the password field and leave the username field blank. For repository vendors that use tokens, the token type is entered in the username field and the token is entered in the password field. Verify details with your vendor. If...

* The first tenant that is enabled pushes its content to the remote repository first. For example, these instructions describe enabling the production tenant first, so the remote repository will initially contain production tenant content. You can enable a development tenant first if you want the remote repository to initially contain the content from...

####### Tip

* Due to security concerns, there is a closed allow list of approved URLs for private repositories. If you want to use a URL that is excluded from the allow list, use an engine (engine groups are not supported).

##### 2.2.3.3. Push and pull content

###### Navigation

  Settings → Configurations → Remote Repository Content → User-Defined Content

##### 2.2.3.4. Remote repository troubleshooting

#### 2.2.4. Manage user roles and access management

##### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

##### Note

* For more information on assigning user roles when generating an API key, see Manage API keys.

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* For features where scoping is not applicable, Role-Based Access Control (RBAC) is used and can be configured when managing user roles. For more information, see Manage user roles.

##### 2.2.4.1. Manage user roles

###### Prerequisite

* Managing user roles in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Navigation

  Settings → Configurations → Access Management → Roles

##### 2.2.4.2. Manage user access

###### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Note

* You can only reduce the permissions of an Account Admin user via Cortex Gateway.

* User permissions for components and datasets are based on the access permissions set in the user role. For more information on editing these user role permissions, see Manage user roles.

###### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit User Permissions.

###### Navigation

  Settings → Configurations → Access Management → Users

###### 2.2.4.2.1. User access reference information

##### 2.2.4.3. Manage user scope

###### Prerequisite

* Configuring user scopes in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles. By default, Enable Scope Based Access Control is...

###### Note

* This configuration can impact the visibility of the related Security domain in the Cases and Issues scope area, but with not affect asset visibility.

* For Cases and Issues domains, a workaround is to create a Dataset View for each required combination of domains, and allow the relevant entity access only to this Dataset View, not to the underlying cases and issues datasets.

* Make sure to assign the required default granular scoping for users. This depends on the structure and divisions within your organization and the particular purpose of each organizational unit to which scoped users belong.

###### Important

* Some areas and features in Cortex XSIAM do not respect SBAC. In these cases, use RBAC permissions to restrict access.

* Before configuring, ensure that you review the Understand scoping section.

#### 2.2.5. Dashboards and reports

## 3. Endpoint security

### 3.1. Endpoint protection

#### 3.1.1. Malware protection

##### Note

* From Cortex XDR agent for Android version 9.0 and later, this module is deprecated.

#### 3.1.2. Exploit protection

#### 3.1.3. File analysis and protection flow

##### Note

* To enhance performance and efficiency, hash verdict requests from the Cortex XDR agent will be routed to the WildFire service with the lowest latency. File uploads for analysis will strictly adhere to the designated Cortex XSIAM and WildFire regions, ensuring data remains within the appropriate geographical boundaries.

#### 3.1.4. Endpoint protection capabilities

#### 3.1.5. Endpoint protection modules

#### 3.1.6. Processes protected by exploit security policy

#### 3.1.7. File Integrity Monitoring (FIM)

##### License Type

  FIM requires the Cortex Cloud Runtime Security add-on.

##### Note

* Google Kubernetes Engine (GKE) is currently not supported

* It is recommended to create a policy that targets only the necessary files and folders.

* Platform cannot be changed once a rule group has been created

* A rule group can contain up to 100 rules.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* It is possible to manage up to 15,000 events per day (24 hours) for each host/container.

##### Navigation

  Creating, modifying and viewing FIM rule groups and rules is be done in the Rule Groups page, located at the Inventory → Endpoints → File Integrity Monitoring menu

  In Inventory → Endpoints → Policy management → Extensions → Profiles, select +Add Profile and then select either Create New or Import from File

#### 3.1.8. WildFire analysis concepts

##### Note

* In cases when the Cortex XSIAM agent gets a failed status from the WF service due to a general error or unsupported file type, and the Local Analysis is set to disabled or not applicable, Cortex XSIAM will not generate an alert on the file.

#### 3.1.9. Guidelines for keeping Cortex XDR agents and content updated

##### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups. See how to define endpoint group.

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups.

##### Important

* When planning Cortex XDR agent upgrades and content updates, consult with the appropriate stakeholders and teams and follow the change management strategy in your organization.

##### Caution

* Before enabling Auto-Update for Cortex XDR agents, make sure to consult with all relevant stakeholders in your organization.

#### 3.1.10. About content updates

##### Note

* Cortex XSIAM delivers the content update to the agent in parts and not as a single file, allowing the agent to retrieve only the updates and additions it needs.

#### 3.1.11. Endpoint data collection

##### Note

* For specific files only and only if the file was written.

##### Important

* Registry key is collected as a real key name, and not as a symbolic link. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, KEY_LOCAL_MACHINE\System\ControlSet001 will be collected. Instead of HKEY_CURRENT_USER, HKEY_USERS\<SID> will be collected, where SID is a SID of the current user.

### 3.2. Install and manage endpoints

#### 3.2.1. Set up endpoint protection

##### 3.2.1.1. Set up endpoint profiles and exception rules

###### Note

* Profiles associated with one or more targets that are beyond the scope of your defined user permissions are locked, and cannot be edited.

###### 3.2.1.1.1. Set up malware prevention profiles

####### Note

* In this profile, the Report options configure the endpoints to report the corresponding suspicious files, actions, processes, or behaviors to Cortex XSIAM, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* As part of the anti-malware security flow, the Cortex XDR agent leverages the operating system's capability to identify revoked certificates for executables, and DLL files that attempt to run on the endpoint by accessing the Windows Certificate Revocation List (CRL). To allow the Cortex XDR agent access the CRL, you must enable internet access over...

* The Quarantine Malicious Executables feature is not available for malware identified on network drives.

* The Quarantine Malicious Script Files feature is not available for malware identified on network drives.

* If on-write actions were configured in earlier versions of Cortex XSIAM, the same configuration has been preserved and applied globally for all file types. On-write file protection may have an impact on the resources required by the Cortex XDR agent.

* On-demand file protection may have an impact on the resources required by the Cortex XDR agent.

* We recommend that you disable scheduled scanning. VDI machine scans are based on the golden image and additional files will be examined upon execution.

* When periodic scanning is enabled in your profile, the Cortex XDR agent initiates an initial scan when it is first installed on the endpoint, regardless of the periodic scanning scheduling time.

* When you are actively evaluating with BAS tools, it is recommended to enable the BAS mode setting only for the duration of your evaluation, and for a limited number of agents.

* BAS tools mode with content older than version 1850 cannot be configured, the agent will be treated as Enabled.

* The Quarantine Malicious Mach-O Files feature is not available for malware identified on network drives.

* This module is supported by Cortex XDR agent 8.1.0 and later releases.

* Enabling on-demand scanning will automatically scan these core system directories: /etc, /tmp, /home, /usr, /bin, /sbin, /lib, /var, /opt, /dev, /root, /boot.

* The Quarantine Malicious ELF Files feature is not available for malware identified on network drives.

* Blocking functionality is different for each security module. For SMS/MMS, Cortex XDR agent will move detected messages containing such URLs from unknown senders to the Junk folder.

* Ensure that the same numbers are not added multiple times with different leading zeros.

* To fully enable the Safari browser security module on the device side, each iOS device user must enable the Safari Safeguard module on the device, and grant it permission to work on all websites. If the iOS device user does not do this, the endpoint's operation status is reported as Partially Protected. The Safari browser security module will only...

* Cortex XDR agent version 8.4 or higher are required for this feature.

####### Warning

* For optimal user experience, we recommend that you set the action mode to either Allow or Run Local Analysis.

###### 3.2.1.1.2. Set up exploit prevention profiles

####### Note

* In this profile, the Report options configure the endpoints to report the corresponding exploit attempts to Cortex XSIAM, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* In exploit prevention profiles, if you change the action mode for processes, you must restart the protected processes for the following security modules to take effect on the process and its forked processes: Brute Force Protection Java Deserialization SO Hijacking

* This step provides a temporary workaround for the following publicly known information-security vulnerabilities and exposures: CVE-2021-24074, CVE-2021-24086 and CVE-2021-24094.

* If you have Windows endpoints in your network that are unpatched and exposed to a known vulnerability, we strongly recommend that you upgrade to the latest Windows Update that has a fix for that vulnerability.

####### Warning

* This workaround applies only to the specific Windows versions listed as exposed to these CVEs, and requires a Cortex XDR agent release 7.1 or later and content 167-51646 or later. This workaround is not recommended for non-persistent, stateless, or linked-clone environments. In some cases, enabling this workaround can affect the network functionality...

###### 3.2.1.1.3. Set up agent settings profiles

####### License Type

  Requires a Cortex XDR Pro per Endpoint license. When you enable this feature, a Cortex XDR Pro per Endpoint license is consumed.

  Requires Host Insights add-on.

  Requires Forensics Add-on.

####### Prerequisite

* User Space Agent mode requires Linux kernel 5.0.0 or higher.

####### Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

* You can enable the option to maintain a persistent notification regarding the disconnection of the endpoint from the network. The settings Persistent Isolation Notification and Blocked Connectivity Notification must be enabled. Until the threat on the endpoint has been removed, the endpoint remains disconnected from the network.

* In Traps 5.0.6 and later releases, when protection is enabled, access will be read-only. In earlier Traps releases, enabling protection disables all access to services, processes, files, and registry values.

* If you choose the Enable option, you must also enable XDR Agent Tampering Protection in the malware profile and set it to Block. Ensure that both profiles are assigned to the same endpoints.

* When you enable Cortex XDR agent registration with the Windows Security Center, Windows automatically shuts down Microsoft Defender on Windows-based workstation endpoints. If you still want to allow Microsoft Defender to run on a workstation endpoint where Cortex XSIAM is installed, you must use the Disable option. However, Palo Alto Networks does not...

* To enable access to these options, scroll down to Network Location Configuration, and set Action Mode to Enabled.

* When using Nmap, the Cortex XDR agent downloads an Nmap driver for the duration of the scan and removes the driver upon completion. If an Nmap scan is in process, Cortex XSIAM identifies the Nmap driver and places any additional scans in a queue.

* If you disable content updates for a newly installed agent, the agent retrieves the content for the first time from Cortex XSIAM, and then disables content updates on the endpoint. When you add a Cortex XDR agent to an endpoint group with a disabled content auto-upgrades policy, the policy is applied to the added agent as well.

* Automatic upgrades are not supported with non-persistent VDI and temporary sessions.

* Limitations in the content download process: When you install the Cortex XDR agent, the agent retrieves the latest content update version available. A freshly installed agent can take between five to ten minutes (depending on your network and content update settings) to retrieve the content for the first time. During this time, your endpoint is not...

* If the Cortex XDR agent is initially unable to communicate without the local store, enforcement is not enabled and the agent will show as partially protected.

* If you choose the Enabled option, you must also set Anti Tampering Protection in the malware security profile to Block, and ensure that both profiles are assigned to the same endpoints.

* Automatic upgrades are not supported for XDR agents running on K8s.

* User Space Agent mode requires Linux kernel 5.0.0 or higher. Endpoints running an older Linux kernel version with this fallback enabled, will not start using User Space Agent mode, and will operate asynchronously.

####### Warning

* If you disable or delay automatic-content updates provided by Palo Alto Networks, it may affect the security level in your organization.

###### 3.2.1.1.4. Set up restrictions prevention profiles

####### License Type

  A Threat Intel Management (TIM) license is required for this feature.

####### Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Configure custom BIOC prevention rules here: Detection & Threat Intel → Detection Rules → BIOC

* Configure this as follows: Prepare this restriction profile first, make a note of its name for later, and set it to Enabled. Prepare the prevention Indicator Rule (go to Detection & Threat Intel → Indicator Rules, ensuring to select Prevention when creating the rule), and while preparing it, map it to your restriction profile.

* Wildcards are supported.

###### 3.2.1.1.5. Set up exception profiles and rules

####### 3.2.1.1.5.1. Exception configuration

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Settings → Exception Configuration → Legacy Exceptions and click Start Simulation

####### 3.2.1.1.5.2. Issue exclusions

######## Note

* The agent continues to generate excluded issues on the endpoint, but they are not saved or displayed in Cortex XSIAM. Configuration of an issue exclusion does not remove or delete any of the logs that would have triggered the issue notification. You can also set up issue exceptions by creating global endpoint policy exceptions. For more information,...

######## Navigation

  The Settings → Exception Configuration → Issue Exclusions page displays the issue exclusion rules in Cortex XSIAM

######## 3.2.1.1.5.2.1. Add an issue exclusion rule

####### 3.2.1.1.5.3. Add an IOC or BIOC rule exception

######## Note

* Cortex XSIAM only supports exceptions with one attribute. See Add an alert exclusion rule to create advanced exceptions based on your filtered criteria.Add an alert exclusion rule

######## Navigation

  Settings → Exceptions Configuration → IOC/BIOC Suppression Rules

####### 3.2.1.1.5.4. Add a disable prevention rule for endpoints

######## Important

* All applicable prevention actions are skipped for the files and process that match the properties defined in the rule. Consider the consequences of disabling a prevention rule before you add the exception, and monitor it over time. You can only apply a Disable Prevention Rule to endpoints running Cortex XDR agents version 7.9 and later.

######## Navigation

  Settings → Exception Configuration → Disable Prevention Rules

####### 3.2.1.1.5.5. Add a disable injection and prevention rule

######## Important

* Exceptions are limited up to 48 hours by default and configurable up to one week. Consider the consequences of disabling a prevention rule before you add the exception and monitor it over time. You can only apply a Disable Prevention Rule to agents version 7.9 and later.

######## Navigation

  Settings → Exception Configuration → Disable Injection and Prevention

####### 3.2.1.1.5.6. Add a support exception rule for endpoints

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Your migrated rules are displayed on the Settings → Exception Configurations → Support Exception Rules page

  From Settings → Exception Configuration → Support Exception Rules, click + Import from file

####### 3.2.1.1.5.7. Add a legacy exception rule for endpoints

######## Note

* This exception prevents the agent from examining the specified file. Use with caution, as it may unintentionally allow unwanted or malicious behavior to go undetected.

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Your migrated rules are displayed on the Settings → Exception Configurations → Legacy Agent Exceptions page

######## 3.2.1.1.5.7.1. Add a new exceptions security profile

######## 3.2.1.1.5.7.2. Add a global endpoint policy exception

##### 3.2.1.2. Define endpoint groups

###### Note

* Disconnecting Cloud Identity Engine in your Cortex XSIAM deployment can affect existing endpoint groups and policy rules based on Active Directory properties.

##### 3.2.1.3. Configure global agent settings

###### Note

* Disabling this capability takes immediate effect on new hashes, fresh agent installations, and existing security policies. It could take up to a week to take effect on existing agents in your environment pending agent caching.

* If you have any Cortex XSIAM filters, starring policies, exclusion policies, scoring rules, log forwarding queries, or automation rules configured for XSOAR/3rd party SIEM, we advise you to update those to support the changes before activating the feature. For example, change the query to include the previous description that is still available in the...

##### 3.2.1.4. Apply profiles to endpoints

###### Note

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

##### 3.2.1.5. Create an agent installation package

###### Note

* The profile will be applied if the security policy cannot be retrieved in real-time.

* The Cortex serverless library must be imported after other libraries to activate the hooks that enable auditing.

###### 3.2.1.5.1. Manage an agent installation package

####### Note

* Since Cortex XSIAM relies on the installation package ID to approve agent registration during the installation, we recommend that you don't delete the installation package of active endpoints. If you install the Cortex XDR agent from a package after you delete it, Cortex XSIAM denies the registration request leaving the agent in an unprotected state....

##### 3.2.1.6. Harden endpoint security

###### Caution

* Hardened endpoint security capabilities are not supported for Android or iOS endpoints.

###### Navigation

  From Inventory → Endpoints → Policy Management → Extensions → Profiles, you can create profiles for the following hardened endpoint security capabilities

  To apply the profiles, from Inventory → Endpoints → Policy Management → Extensions → Policy Rules, you can view all the policy rules per operating system

###### 3.2.1.6.1. Device control

####### Note

* Operating systems report on devices in different ways. Sometimes, the same BLE device will report different services and interfaces, depending on the host's operating system. This may have an effect on the specific BLE services that are blocked for each operating system. Depending on your defined user scope permissions, creating device profiles,...

* For network printer print jobs, ensure that you also configure the Agent Settings profile, Network Location Configuration option. This setting must be set to Enabled, and configured. If you do not enable and configure this setting, all network printer operations will be treated as internal network print jobs. For network printer print jobs, ensure that...

* Currently, the default is set to Use Default (Allow), however, Palo Alto Networks may change the default definition at any time.

* You cannot edit or delete the default profiles pre-defined in Cortex XSIAM.

* You cannot edit or delete the predefined profiles in Cortex XSIAM.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* Permanent exceptions apply across platforms, allowing the devices on all operating systems.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

####### Navigation

  Endpoints → Policy Management → Settings → Device Management

###### 3.2.1.6.2. Host firewall

####### 3.2.1.6.2.1. Host firewall for Windows

######## Note

* A rule is always part of a rules group. It cannot stand on its own. A rule can belong to one rules group only and cannot be reused in different groups.

* When selecting ICMP protocol, you must enter a the ICMP Type and Code. Without these values the ICMP protocol is ignored by the Windows and macOS Cortex XDR agents.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows. New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until target is specified.

* The data is aggregated and reported periodically every 60 minutes since the first time the host firewall policy was enforced on the endpoint, not every round hour. The table lists enforcement events only for rules set to Report Matching Traffic.

######## Navigation

  From Inventory → Endpoints → Policy Management → Extensions and select + Add Profile or Import from File

####### 3.2.1.6.2.2. Host firewall for macOS

######## Note

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

######## Navigation

  From Inventory → Endpoints → Policy Management → Extensions Profiles → Profiles, select + New Profile or Import from File

  Additionally, to monitor the communication on your macOS endpoint, you can use the following operating system utilities: From the endpoint System Preferences → Security and Privacy → Firewall → Firewall options, you can view the list of blocked and allowed applications in the firewall

###### 3.2.1.6.3. Disk encryption

####### Note

* You must select the same encryption method configured by the Microsoft Windows Group Policy in your organization for the target endpoints. Otherwise, if you select a different encryption method than the one already applied through the Windows Group Policy, Cortex XSIAM displays errors.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

####### Navigation

  You can monitor the Encryption Status of an endpoint in the Inventory → Endpoints → Disk Encryption Visibility table

###### 3.2.1.6.4. Host Inventory

####### Note

* Cortex XSIAM includes only the first 10,000 results per endpoint. Cortex XSIAM lists only users that belong to each group directly, and does not include users who belong to a group within the main group. If a local users group includes a domain user (whose credentials are stored on the Domain Controller server and not on the endpoint), Cortex XSIAM...

####### Navigation

  Inventory → Endpoints → Host Inventory

###### 3.2.1.6.5. Vulnerability Assessment

####### Prerequisite

* The following are prerequisites for Cortex XSIAM to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XSIAM lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex XSIAM...

* The following are prerequisites for Cortex XSIAM to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex XSIAM collects all the information about the operating system and the installed...

####### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex XSIAM Application Inventory.

####### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

####### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

##### 3.2.1.7. Set a Cortex XDR agent Critical Environment version

###### Note

* To ensure the stability of the line, CE versions maintenance release cadence is longer than in the standard line, we recommend that deployment is adjusted accordingly.

###### Navigation

  Settings → Configurations → General → Agent Configurations

  Inventory → Endpoints → All Endpoints

##### 3.2.1.8. Set an application proxy for Cortex XDR agents

###### Navigation

  Inventory → Endpoints → All Endpoints

#### 3.2.2. Manage endpoint protection

##### 3.2.2.1. Move agents between managing servers

###### Prerequisite

* Consider the following before making changes: Endpoint type is not Kubernetes Node. Installation type is not VDI. Ensure you have administrator privileges for Cortex XSIAM in the hub.

###### Note

* Cortex XSIAM does not support moving agents between FedRamp and commercial tenants.

###### Navigation

  Inventory → Endpoints → Agent Installations

  Inventory → Endpoints → All Endpoints

##### 3.2.2.2. Manage endpoint tags

###### Note

* The following explanations use Windows operating system installation parameters and Cytool argument examples.

* Tag names are case sensitive. In Windows and Mac, a tag name can contain spaces. Linux does not support tag names with spaces as command line arguments to the shell installer. Instead, tags can be set in the /etc/panw/cortex.conf configuration file, which supports all Linux installers.

* Tag names are case sensitive and can contain spaces.

* When SBAC is enabled, assigning tags may impact user permissions.

* If you remove the tag and there are assigned users or user groups with scope settings, this can impact user permissions in the system.

##### 3.2.2.3. Set an alias for an endpoint

###### Tip

* If you change your mind in the future, you can select Endpoint Control → Change Endpoint Alias again, and delete the required aliases.

##### 3.2.2.4. Manage endpoint prevention profiles

###### Note

* The filter is stored within the policy definition and assessed during runtime to extract the functions that match the filter criteria.

###### Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

##### 3.2.2.5. Upgrade Cortex XDR agents

###### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

###### Warning

* You must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check whether the extensions were approved, you can either verify that the...

###### Important

* The following list includes important points to take into account when upgrading the Cortex XDR agent: Review the recommended guidelines for keeping Cortex XDR agents and content updated. Read more here. You cannot upgrade the Cortex XDR agent on VDI endpoints or a Golden Image. You must reinstall (uninstall and install again) the relevant agent...

##### 3.2.2.6. Restart agent

##### 3.2.2.7. Uninstall the Cortex XDR agent

###### Note

* Before upgrading a Cortex XDR agent running on macOS 10.15.4 or later, you must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check...

###### Tip

* If needed, use the filter to filter the list of endpoints by attribute or group name.

###### Navigation

  Inventory → Endpoints → All Endpoints

##### 3.2.2.8. Clear agent database

###### Note

* Clearing the agent database is supported on all platforms with Cortex XDR agent version 7.9 or later, and is available only when using the debugging mode.

* You can only right-click to cancel the clear agent database for actions with a pending status.

##### 3.2.2.9. Delete Cortex XDR agents

###### Note

* To reinstate an endpoint, you have to uninstall and reinstall the agent.

###### Navigation

  Inventory → Endpoints → All Endpoints

##### 3.2.2.10. Manage agent tokens

###### Note

* Agent tokens are only supported for Windows and Mac.

* You can select a one or multiple agents to add a temporary token.

##### 3.2.2.11. Retrieve support file password

###### Navigation

  Retrieve Support File Password from Inventory → Endpoints → All Endpoints

##### 3.2.2.12. Monitor agent operational status

###### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex XSIAM management console for specific reasons for the state.

###### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

###### Navigation

  You can monitor the Cortex XDR agent Operational Status in Inventory → Endpoints → All Endpoints

##### 3.2.2.13. Monitor agent activity

##### 3.2.2.14. Monitor agent upgrade status

###### Navigation

  From Inventory → Endpoints → All Endpoints, you can view the upgrade status of any Cortex XDR agent that you manage

## 4. Web and API Security (WAAS)

### 4.1. Overview

#### License Type

  Requires the Cortex Cloud Runtime Security add-on.

#### Note

* Verify API security configurations for relevant users and roles.

### 4.2. Personas workflow

### 4.3. Secure your API landscape

#### 4.3.1. API visibility and risk assessment

##### Note

* Data classification findings are only available for enabled profiles.

* Indicates that a JSON Web Token was identified, but it is unknown how to determine its type from the given string. It could be a non-standard JSON Web Token creation algorithm.

#### 4.3.2. Monitor and investigate API threats

#### 4.3.3. Configure API security from end to end

##### 4.3.3.1. Third-party API security integrations

###### 4.3.3.1.1. Ingest AWS API Gateway

####### Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

####### Important

* Leave '–'filter-pattern empty as displayed above.

###### 4.3.3.1.2. Ingest Azure APIM

####### License Type

  Requires the Data Collection add-on.

####### Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

####### Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

###### 4.3.3.1.3. Ingest Apigee Proxy

####### License Type

  Requires the Data Collection add-on.

####### Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

####### Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

###### 4.3.3.1.4. Ingest Kong

####### License Type

  Requires the Data Collection add-on.

####### Note

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

####### Important

* The size of the buffer must be equal to or larger than the max body size setting in the plugin configuration, on every data plane node.

###### 4.3.3.1.5. Ingest-F5

####### License Type

  Requires the Data Collection add-on.

####### Note

* Extract the files from the F5 plugin to a folder before selecting to upload to F5.

* Select panw_apisec_set_ssl_data only if your client SSL profile is enabled.

* The provider for "context_provider" should always be uppercase. Supported providers: AWS, GCP, Azure, On-prem.

##### 4.3.3.2. Agent-based protection

###### Note

* Web and API Security (WAAS) profiles and policies are currently a Beta feature.

###### 4.3.3.2.1. Set up Web and API Security profiles

####### Note

* Web and API Security profiles and policies are currently a Beta feature.

* In this profile, the Report options configure the workload to report the corresponding malicious applications or APIs to Cortex XSIAM, without blocking them. The Disabled options configure the workloads to neither analyze nor report the corresponding malware or behavior.

####### Navigation

  Inventory → Endpoints → Policy Management → Prevention → Profiles

###### 4.3.3.2.2. Apply Web and API Security profiles to workloads

####### Note

* Web and API Security profiles and policies are currently a Beta feature.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

###### 4.3.3.2.3. Manage Web and API Security prevention profiles

####### Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

###### 4.3.3.2.4. Add a disable prevention rule for cloud workloads

####### Important

* All applicable prevention actions are skipped for the files and process that match the properties defined in the rule. Consider the consequences of disabling a prevention rule before you add the exception, and monitor it over time.

####### Navigation

  Settings → Exceptions Configuration → Disable Prevention Rules

###### 4.3.3.2.5. Add a support exception rule for cloud workloads

####### Navigation

  From Settings → Exceptions Configuration → Support Exception Rules, click + Import from file

###### 4.3.3.2.6. Add a legacy exception rule for cloud workloads

####### Navigation

  Your rule is created, and can be viewed at the following location: Settings → Exceptions Configuration → Legacy Agent Exceptions

###### 4.3.3.2.7. Additional workload management tasks

####### Navigation

  Several management activities that can be performed on workloads are accessible from Inventory → Endpoints → All Endpoints and from Inventory → Endpoints → Groups

#### 4.3.4. API specification inventory

##### Note

* Even if you have already imported the specification, you can edit the API specification in Cortex XSIAM and add or update the server list.

##### 4.3.4.1. Import API specification

###### Note

* Even if you already imported the file, you can edit the API asset and add or update the server list.

## 5. Monitor dashboards and reports

### 5.1. About dashboards

#### Note

* You cannot edit the predefined dashboards but you can create a new dashboard that is based on a dashboard template. In addition, private dashboards can only be viewed, edited, and deleted by the dashboard creator.

* Dashboards that are based on custom infrastructure cannot be exported. If you import a dashboard template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

#### 5.1.1. Command Center dashboards

##### Note

* Access to the dashboards requires RBAC View permissions for Dashboards & Reports and Command Center Dashboards. The dashboards are available in dark mode only. They are not editable, and you can't create dashboard templates or reports from them. Some of the dashboard's animations are not fully supported by the Safari web browser. We recommend that...

##### 5.1.1.1. Cortex Command Center

###### Note

* The Cortex Command Center requires RBAC View permissions for Dashboards, Command Center Dashboards, and Asset Inventory.

##### 5.1.1.2. XSIAM Command Center

##### 5.1.1.3. Cloud Detection and Response (CDR) Command Center

##### 5.1.1.4. Cloud Security Command Center

###### 5.1.1.4.1. Cloud Security Command Center

####### Note

* The Cloud Security Command Center dashboard is currently only available by default to users with the Instance Administrator and Viewer roles. Custom roles, which include the Cloud Security Command Center View/Edit role permissions, also have access.

####### 5.1.1.4.1.1. Fine-Tune your Investigation

######## 5.1.1.4.1.1.1. Data Sources

######## 5.1.1.4.1.1.2. Assets with Vulnerabilities

######## 5.1.1.4.1.1.3. Security Outcomes

######### 5.1.1.4.1.1.3.1. Security Cases

######### 5.1.1.4.1.1.3.2. Posture Cases

####### 5.1.1.4.1.2. Value Metrics

######## Note

* The Time Saved estimate is based on the total amount of savings derived from the reduction of issues by grouping and addressing them as Posture Cases and Attack Paths. Analyst savings are estimates based on an average Security Analyst's wage coupled with the reduction in time spent addressing Issues on an individual basis.

##### 5.1.1.5. Cloud Security Operations

###### 5.1.1.5.1. Cloud Security Operations

####### License Type

  Requires the Cortex Cloud Runtime Security add-on or the Cortex Cloud Posture Management add-on.

####### Note

* Command Center data may not match the counts on the Issues page and you may observe inconsistencies. This is because dashboard data is a snapshot of issues identified, whereas the Issues page provides the most up to date view of risks across your cloud assets. In addition, the Issues pages does not support all the currently available filters on the...

####### 5.1.1.5.1.1. Dashboard Widgets

######## Note

* The Last updated time indicated on each widget may differ as widget data is gathered at varying intervals.

######## 5.1.1.5.1.1.1. Generate Reports

######## 5.1.1.5.1.1.2. Filter Options

#### 5.1.2. Predefined dashboards

##### License Type

  Requires the ITDR add-on.

##### Note

* Users can access all information on the dashboard when their user access is scoped to view All assets or assigned to the Instance Administrator role. Otherwise, users with granular scoping set to No assets or Select asset groups will have limited access to the dashboard. For more information on Scope-Based Access Control (SBAC), see Manage user...

#### 5.1.3. Reports

##### 5.1.3.1. Report templates

### 5.2. Build custom dashboards and reports

#### 5.2.1. Build a custom dashboard

##### Note

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

#### 5.2.2. Manage your Widget Library

##### Note

* Any dashboards or reports that include the widget are affected by the changes.

### 5.3. Fine-tune dashboards and reports

#### 5.3.1. Create a custom widget using a script

##### Note

* If you have added arguments to the script, these appear when creating a widget.

* Available options are Pie, Column, Line, and Single Value. To display the result of the script as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### 5.3.1.1. Script-based widget examples

###### Note

* Add the widget tag in the script settings to make the script available for use in script-based widgets. For more information, see Create a script.Create a script

* If your script returns a time duration, configure the widget with the graph type Single Value and enable Show as Time..

#### 5.3.2. Create a text widget

##### Note

* From the dashboard manager, you can right-click an existing dashboard and choose Save as report template. You can also add text-based widgets directly to new or existing report templates, as described below.

#### 5.3.3. Create custom XQL widgets

##### Note

* Cortex Query Language (XQL) queries generated from the Widget Library do not appear in the Query Center. The results are used only for creating the custom widget.

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### Tip

* You can create a generic dashboard for multiple views of the same dataset by defining the dataset in the XQL widget as dataset = <dataset_name>*. The placement of the asterisk (*) in the dataset name ensures that any view containing this prefix text is displayed in the results. The dataset in a query is defined as: If there are multiple datasets that...

##### Navigation

  All of your predefined and custom XQL widgets are available in the Widget Library under Dashboards & Reports → Customize → Widget Library

##### 5.3.3.1. Configure filters and inputs for custom XQL widgets

###### Prerequisite

* Fixed filters are based on parameters that are defined in custom XQL widgets. Before you can configure fixed filters, take the following steps: Create custom XQL widgets with parameters. For more information, see Create custom XQL widgets. Add the widgets to a Custom dashboard. For more information, see Build a custom dashboard.

###### Note

* If you specify more than one field, only the first field value is used.

###### Tip

* After the initial setup, when you access your dashboard the filters and inputs might need further refinement. You can make changes to the configured parameters in the XQL widgets, and update the Filters & Inputs on your dashboard until you are satisfied with the results.

#### 5.3.4. Configure dashboard drilldowns

##### Prerequisite

* To configure drilldowns your dashboard must contain custom XQL widgets. In addition, if you want to configure in-dashboard drilldowns your custom XQL widget must contain one or more parameters. For more information about configuring parameters in custom XQL widgets, see Create custom XQL widgets.

##### Note

* If the selected parameter is configured in other XQL widgets on the dashboard, these widgets are also affected by the drilldown.

##### 5.3.4.1. Variables in drilldowns

### 5.4. Run or schedule reports

#### Note

* Report templates that are based on custom infrastructure cannot be exported. If you import a report template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

* The report name and description will be displayed in the report header and are not editable during customization.

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

#### Navigation

  Dashboards & Reports → Customize → Report Templates

  Dashboards & Reports → Customize → Dashboards Manager

  Under Settings → Configurations → General → Notifications, click + Add Forwarding Configuration

## 6. Investigation and response

### 6.1. Cases and issues

#### 6.1.1. What are cases?

##### 6.1.1.1. Issues

##### 6.1.1.2. Findings and events

#### 6.1.2. Case and issue domains

##### Navigation

  You can see all domains under Configurations → Object Setup → Cases → Domains

#### 6.1.3. Manage your cases

##### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

##### 6.1.3.1. Assign a case

##### 6.1.3.2. Case thresholds

##### 6.1.3.3. Link or unlink issues from a case

##### 6.1.3.4. Resolve a case

###### 6.1.3.4.1. Resolution reasons for cases and issues

####### Note

* The displayed resolution reasons are domain specific. You can see the resolution reasons that are defined for a domain under Configurations → Object Setup → Cases → Domains.

* Cases and issues resolved as True Positive and False Positive help Cortex XSIAM to identify real threats in your environment by comparing future cases and associated issues to the resolved cases. Therefore, the handling and scoring of future cases is affected by these resolutions.

###### 6.1.3.4.2. Create custom case statuses and resolution reasons

####### Note

* Before you create a custom status, please review the built-in options. For more information, see Resolution reasons for cases and issues. We recommend using the built-in statuses and resolution reasons where possible. Custom statuses and resolution reasons might not be supported by all content, and status syncing can take time. In addition, custom...

* After creation, custom statuses and resolution reasons cannot be deleted or modified.

####### Navigation

  Configurations → Object Setup → Cases → Properties

##### 6.1.3.5. Create a case

###### Note

* To create a case manually, you must have View/Edit permission for Cases and Issues selected under Settings → Configurations → Access Management → Roles → Components → Cases & Issues.

* You can assign a case to a single domain only and you cannot change the assigned domain. For more information, see Case and issue domains.

* This option is only relevant for certain domains.

* You can't attach files to manually created cases.

###### Tip

* The issues that you link to a case can be linked to multiple cases, and the issue domains do not need to match the case domain.

##### 6.1.3.6. Issue syncing

###### Prerequisite

* You must set up an integration before you can sync issues. For more information, see Set up an integration for mirroring issues.

###### Note

* Multiple tickets can be linked to an issue with outbound syncing. Issues with inbound syncing can be linked to a single ticket only.

* Using issue fields as variables is not currently supported.

* You can only define a single inbound profile. If you change the inbound sync profile the current profile is overwritten. You can define multiple outbound profiles; one issue can update multiple tickets.

* The inbound syncing flow runs every two minutes, and the outbound syncing flow runs every five minutes. In a bi-directional set-up, if the same field is updated in both tickets, the most recently updated value is used. In the external ticket, the logged history shows updates to the ticket. The user name that is logged with the history reflects the user...

* After an issue is resolved, ticket syncing remains active for up-to seven days. Therefore, you still update, change, or reopen the issue or external ticket and the tickets will continue to sync.

* If you change the selected inbound sync profile, the original sync profile is immediately overwritten.

###### Warning

* If you leave this field blank, all configured instances will be used.

###### Tip

* You can find a sync profile ID under Settings → Configurations → Object Setup → Issues → Sync Profiles. By default the ID field is not displayed in the table. Click the three dot menu and add it to the table layout.

###### Navigation

  Settings → Configurations → Data Sources and click Add Data Source

  Settings → Configurations → Data Collection → Automation & Feed Integrations

###### 6.1.3.6.1. Create a sync profile

####### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

#### 6.1.4. Customize your cases

##### 6.1.4.1. External integrations

##### 6.1.4.2. Prioritize cases with starring and scoring

###### 6.1.4.2.1. Case starring

####### Navigation

  Cases & Issues → Case Configuration → Starred Issues

###### 6.1.4.2.2. Case scoring

####### 6.1.4.2.2.1. Set up case scoring

######## Note

* On the first activation, it can take up to 48 hours for SmartScore to calculate and display the score. Enabling SmartScore subsequently impacts the User Score.

* For scoped users, a small lock icon indicates that you don't have permissions to edit a rule.

##### 6.1.4.3. Customize issue fields and layouts

###### 6.1.4.3.1. Issue fields

####### Warning

* Deleting an issue field or uninstalling a content pack containing an issue field may affect detection and other capabilities based on the deleted field. For example, correlation, layouts, case scoring, starring rules, and playbook triggers.

####### 6.1.4.3.1.1. Issue field types

######## Note

* You cannot set filters, starring rules, playbook triggers, layout rules, or issue exclusions based on the values in custom timestamp fields.

* When grid field is shown in the Issues table, if there are values in the field, they do not display in the table. Instead, the column shows Data Available.

* When an HTML field is shown in the Issues table, if there is a value in the field, it does not display in the Issues table. Instead, the column shows Data Available. The following HTML tags are not permitted: blockquote, del, dd, div, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, iframe, ins, li, math, noscript, ol, pre, p, script, style, table,...

* When a Markdown field is shown in the Issues table, if there is a value in the field, it does not display in the table. Instead, the column shows Data Available.

####### 6.1.4.3.1.2. Create custom issue fields

######## Navigation

  Settings → Configurations → Object Setup → Issues → Fields → New Field

######## 6.1.4.3.1.2.1. Create a grid field

######## 6.1.4.3.1.2.2. Issue field triggered scripts

######## 6.1.4.3.1.2.3. Issue timer fields

######### 6.1.4.3.1.2.3.1. Configure issue timer fields

######### 6.1.4.3.1.2.3.2. Configure a playbook to run timers

######### 6.1.4.3.1.2.3.3. Automate changes to issue fields using timer scripts

######### 6.1.4.3.1.2.3.4. Use issue timer field commands manually in the CLI

###### 6.1.4.3.2. Issue layouts

###### 6.1.4.3.3. Create custom issue layouts

####### Note

* The script that runs when an action button is clicked accepts only mandatory arguments through the pop up window and does not provide an option for any non-mandatory arguments to be filled in when the button is clicked. We recommend using a wrapper script to collect and validate arguments in scenarios where there can be a combination of mandatory and...

####### Tip

* Limit the number of issue fields to 50 in each section. You can create additional sections as needed.

####### 6.1.4.3.3.1. Add a custom widget to an issue layout

######## Navigation

  Investigation & Response → Automation → Scripts and upload the following script: Expand script commonfields: id: ee3b9604-324b-4ab5-8164-15ddf6e428ab version: 49 name: IndicatorWidgetBar script: |- # Constants HIGH = 3 SUSPICIOUS = 2 LOW = 1 NONE = 0 indicators = [] scores = {HIGH: 0, SUSPICIOUS: 0, LOW: 0, NONE: 0} incident_id = demisto

  Investigation & Response → Automation → Scripts and upload the following script

  Settings → Configurations → Object Setup → Issues → Layouts

###### 6.1.4.3.4. Create rules for issue layouts

####### Navigation

  Settings → Configurations → Object Setup → Issues → Layout Rules → New Rule

##### 6.1.4.4. Customize case fields and layouts

###### 6.1.4.4.1. Create case timers and SLAs

####### Prerequisite

* Before you can create a case SLA, you must first create a timer field. A timer field can be associated with a single case SLA.

####### Note

* If you edit this filter after creation, the timer and associated SLA will be removed from any case that no longer qualifies, even if the timer is already running.

####### Navigation

  Settings → Configurations → Object Setup → Cases and open the Fields tab

####### 6.1.4.4.1.1. Update case timer and SLA fields

###### 6.1.4.4.2. Case fields

####### Warning

* Deleting a case field or uninstalling a content pack containing a case field may affect capabilities based on the deleted field, layouts and case scoring.

####### 6.1.4.4.2.1. Case field types

######## Note

* You cannot set filters, starring rules, playbook triggers, layout rules, or issue exclusions based on the values in custom timestamp fields.

* When grid field is shown in the Cases table, if there are values in the field, they do not display in the Cases table. Instead, the column shows Data Available.

* When an HTML field is shown in the Issues table, if there is a value in the field, it does not display in the Cases table. Instead, the column shows Data Available.

* When a Markdown field is shown in the Cases table, if there is a value in the field, it does not display in the Cases table. Instead, the column shows Data Available.

* If you make changes to case fields you can update the context data by running a playbook, script, or command. For more information, see Update case fields. To update dynamic custom case fields, such as SLA and Timer fields, see Update case timer and SLA fields.

####### 6.1.4.4.2.2. Create custom case fields

######## Navigation

  Settings → Configurations → Object Setup → Cases → Fields → New Field

######## 6.1.4.4.2.2.1. Create a grid field for a case

####### 6.1.4.4.2.3. Update case fields

######## Note

* Ensure that you have the required RBAC permission to write scripts.

###### 6.1.4.4.3. Case layouts

####### 6.1.4.4.3.1. Create custom case layouts

######## Note

* The script that runs when an action button is clicked accepts only mandatory arguments through the pop up window and does not provide an option for any non-mandatory arguments to be filled in when the button is clicked. We recommend using a wrapper script to collect and validate arguments in scenarios where there can be a combination of mandatory and...

######## Tip

* Limit the number of case fields to 50 in each section. You can create additional sections as needed.

####### 6.1.4.4.3.2. Create rules for case layouts

######## Note

* Layout rules support SBAC (scoped based access control). The following parameters are considered for editing access. If Scope-Based Access Control (SBAC) is enabled and Endpoint Scoping Mode is set to restrictive mode, you can edit a rule if you are scoped to all tags in the rule. If Scope-Based Access Control (SBAC) is enabled and Endpoint Scoping...

######## Navigation

  Settings → Configurations → Object Setup → Cases → Layout Rules → New Rule

##### 6.1.4.5. Create a case domain

###### Note

* Adding custom domains requires a View/Edit RBAC permission for Case Properties (under Object Setup). Once created, a custom case domain cannot be deleted or renamed.

###### Warning

* Before you add a custom domain, please review the built-in options. For more information, see Case and issue domains. We recommend using the built-in domains where possible. Custom domains might not be supported by all content. In addition, custom domains affect Cortex XSIAM's ability to learn, correctly identify, and score future cases. Smart...

###### Navigation

  Settings → Configurations → Object Setup → Cases → Domains

  Settings → Configurations → Access Management → User Groups

  Settings → Configurations → Access Management → Users

  To enable access to the domain for an API key, got to Settings → Configurations → Integrations → API Keys

##### 6.1.4.6. Create a sync profile

###### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

##### 6.1.4.7. Run indicator extraction in the CLI

###### Note

* Triggering enrichment on a substantial amount of indicators can take time (since it's activating all enrichment integrations per indicator) and can result in performance degradation.

#### 6.1.5. Cortex Copilot

##### Navigation

  To increase usability, you can create a personalized keyboard shortcut: Settings → Configurations → Server Settings → Keyboard Shortcuts and choose the shortcut you want to use

##### 6.1.5.1. Cortex Copilot layout

##### 6.1.5.2. Cortex Copilot capabilities

###### Note

* When you choose an option from the Respond column, Cortex Copilot will always prompt you to approve the action before executing.

* Disabling Cortex Copilot requires users to refresh their page.

### 6.2. Investigate cases

#### 6.2.1. Overview of the Cases page

##### Note

* For MSSP and multi-tenant administrators, if the Unified Case View is enabled, this view consolidates all cases across your distributed environment, allowing you to view and perform actions on child tenants. If the Unified Case view is disabled, this view displays a single tenant at a time with a drop-down list for moving between tenants in read-only...

* When an issue is resolved, it remains linked to a case and appears in this section. Once all of the issues in a case are resolved, the case is automatically closed.

##### Tip

* Set a default tab in the details pane by selecting the pin icon next to a tab. Click on the Notepad, Messenger, and Case Context Data icons to add notes on the case, and see existing notes from other analysts.

##### 6.2.1.1. Saved table views

##### 6.2.1.2. Unified case view

###### License Type

  Requires an MSSP license.

###### Note

* Requires the following RBAC permissions:    Cases & Issues   Investigation & Response → Automation Requires the following RBAC permissions: Cases & Issues Investigation & Response → Automation This view is available for the parent tenant only. To take actions on a child tenant from a parent tenant, you must have the appropriate permissions for both...

* Custom case layouts of child tenants are not visible in the parent tenant.

#### 6.2.2. Review and investigate a case

##### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

* In some cases, the number of issues associated with the techniques will not be aligned with the number of the parent tactic because of missing tags or in case an issue belongs to several techniques.

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

* Cloud related issues are displayed in the User Name grouping. Prisma Cloud Compute issues are displayed in the Host Name grouping.

### 6.3. Investigate issues

#### 6.3.1. Overview of the Issues page

##### Note

* Every 12 hours, the system enforces a cleanup policy to remove the oldest issues once the maximum limit is exceeded. The default issue retention period in Cortex XSIAM is 186 days.

#### 6.3.2. Issue card

##### Note

* This section is context specific and shows data according to the issue context.

##### 6.3.2.1. Use the War Room in an investigation

###### Note

* The case War Room is usually used for communication capabilities, but unlike the issue War Room, it does not include playbook specific entries. The case War Room enables you to investigate an entire case, not just an issue.

* Cortex XSIAM does not index notes and chats.

###### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

* You can use the up/down arrow buttons in the CLI to do a reverse history search for previous commands with the same prefix.

###### Navigation

  Investigation & Response → Automation → Playground

##### 6.3.2.2. Use the Work Plan in an investigation

#### 6.3.3. Triage and investigate issues

##### 6.3.3.1. Copy issues

##### 6.3.3.2. Analyze an issue

##### 6.3.3.3. Run an automation on an issue

###### Note

* In addition to automation, some playbooks contain manual tasks that prompt the analyst for input. This enables you to enhance an automation workflow with analyst input.

* You can also manually select a playbook to run from the Issue Work Plan tab.

##### 6.3.3.4. Create profile exceptions

###### Navigation

  Inventory+Endpoints → Policy Management → Profiles

##### 6.3.3.5. Investigate contributing events

##### 6.3.3.6. Retrieve additional issue details

###### Tip

* If you require assistance from Palo Alto Networks support to investigate the issue, make sure to provide the downloaded ZIP file.

##### 6.3.3.7. Add a file path to a malware profile allow list

###### Navigation

  Inventory+Endpoints → Policy Management → Prevention → Profiles and locate the malware profile you selected

##### 6.3.3.8. Create a featured field

###### Note

* Featured Active Directory values are displayed in the User and Host fields accordingly.

###### Navigation

  Cases & Issues → Case Configuration → Featured Fields and select a type of featured field

##### 6.3.3.9. View generating BIOC or IOC rule

##### 6.3.3.10. Export issue details to a file

##### 6.3.3.11. Exclude an issue

##### 6.3.3.12. Query case and issue data

###### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

##### 6.3.3.13. Update issue fields

###### Note

* You must create a custom status before you can select it.

###### Tip

* You can create custom issue statuses and resolution reasons, and use the setIssueStatus command to set these custom statuses for issues. For example, when a user starts investigating an issue, the issue status is automatically changed from New to Under Investigation. In some cases, it is useful to create an interim status, such as Triage. After you...

##### 6.3.3.14. Close an issue

###### Note

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

#### 6.3.4. What is Causality?

##### Note

* There are no CGOs in the Cloud Causality View, when investigating cloud Cortex XSIAM alerts and Cloud Audit Logs, or SaaS Causality View, when investigating SaaS-related alerts for 501 audit events, such as Office 365 audit logs and normalized logs.

##### 6.3.4.1. Causality view

###### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

##### 6.3.4.2. Network causality view

###### Note

* The network causality view displays only the information it collects from the detectors. It is possible that the CI may not show some of the firewall or agent processes.

###### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

##### 6.3.4.3. Cloud causality view

##### 6.3.4.4. SaaS causality view

##### 6.3.4.5. Timeline

###### Note

* The Timeline view is not available when investigating cloud Cortex XSIAM issues and cloud audit logs or SaaS-related issues for 501 audit events, such as Office 365 audit logs and normalized logs. Only the applicable cloud causality view and SaaS causality view is available for this data.

##### 6.3.4.6. Causality icons key

#### 6.3.5. Cortex Response and Remediation content pack

##### 6.3.5.1. Investigate an issue using Cortex Response and Remediation playbooks

##### 6.3.5.2. Example use cases

### 6.4. Investigate findings

#### 6.4.1. Findings card

##### Note

* The information in this card is context specific, therefore some sections are not available for all findings.

### 6.5. Investigate artifacts and assets

#### 6.5.1. Investigate an IP address

##### Note

* Requires a license key. Select Settings → Configurations → Integrations  → Threat Intelligence.

#### 6.5.2. Investigate an asset

##### Note

* The Asset view is available for hosts with a Cortex XDR agent installed.

#### 6.5.3. Investigate a host

##### License Type

  The Host Risk View requires the Identity Threat Module add-on.

##### Tip

* You can also see a list of all hosts under Inventory → Assets → Asset Scores.

#### 6.5.4. Investigate a file and process hash

##### Note

* Requires a license key. Go to Settings → Configurations → Integrations  → Threat Intelligence.

#### 6.5.5. Investigate a user

##### License Type

  If the Identity Threat module is enabled you can open the User Risk View. This view displays insights and profiling information to help you investigate issues and cases. Viewing anomalies in the context of baseline behavior facilitates risk assessment and shortens the time you require for making verdicts. If the Identity Threat module is not enabled...

##### Note

* Cortex XSIAM normalizes and displays case and issue times in your time zone. If you're in a half-hour time zone, the activity in the Normal Activity and the Actual Activity charts is displayed in the whole-hour time slot preceding it. For example, if you're in a UTC +4.5 time zone, the time displayed for the activity will be UTC +4.5, however, the...

##### Tip

* You can also see a list of all users under Assets → Asset Scores.

### 6.6. Investigate endpoints

#### 6.6.1. Overview of the Action Center

##### Note

* Blocking files on endpoints is enforced by the endpoint malware profile. To block a hash value, ensure the hash value is configured in the Malware security profile. Select Override Report mode to allow the agent to block hashes, even if the Malware Profile is set to Report.

##### Navigation

  Investigation & Response → Response → Action Center

##### 6.6.1.1. Initiate and monitor endpoint actions

###### Navigation

  Investigation & Response → Response → Action Center → New Action

  Investigation & Response → Response → Action Center

##### 6.6.1.2. Action Center reference information

#### 6.6.2. Manage endpoints

##### Note

* For the Include endpoints from auto upgrade action, you cannot enable auto upgrade for Mobile, VDI, and TS installations.

* If an endpoint is excluded, the auto upgrade profile configuration is not available. If you exclude the endpoint from auto upgrade while the auto upgrade action is In progress, the ongoing upgrade will still take place.

* Content Status is calculated every 30 minutes. Therefore, there might be a delay of up to 30 minutes in displaying the data.

* Only supported for Windows and macOS.

* Changes to the agent status can take up to ten minutes to display on Cortex XSIAM .

##### Navigation

  Inventory → Endpoints → All Endpoints

  Settings → Configurations → General → Agent Configurations → Endpoint Administration Cleanup

#### 6.6.3. Retrieve files from an endpoint

##### Note

* You cannot define a path using environment variables on Mac and Linux endpoints.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Disabling File Retrieval does not take effect on file retrieval actions that are in progress.

#### 6.6.4. Retrieve support logs from an endpoint

##### Navigation

  Investigation & Response → Response → Action Center → + New Action

#### 6.6.5. Retrieve support file password

##### Navigation

  Retrieve Support File Password from Inventory → Endpoints → All Endpoints

#### 6.6.6. Scan an endpoint for malware

##### Navigation

  Investigation & Response → Response → Action Center → New Action

### 6.7. Investigate files

#### 6.7.1. Manage file execution

##### Navigation

  Investigation & Response → Response → Action Center → New Action

#### 6.7.2. Manage quarantined files

##### Note

* This will restore all files with the same hash on all of your endpoints.

#### 6.7.3. Review WildFire analysis details

##### Note

* Cortex XSIAM displays the preview of WildFire reports that were generated within the last couple of years. To view a report that was generated more than two years ago, you can download the report.

#### 6.7.4. Import file hash exceptions

##### Navigation

  Investigation & Response → Response → Action Center → New Action

### 6.8. Automations

#### 6.8.1. Automation in Cortex XSIAM

##### Note

* You can build end-to-end automation workflows from within the playbook editor, including creating automation rules, configuring integration instances, and creating and editing tasks. For more information, see Playbooks.

#### 6.8.2. Quick Actions

##### Note

* When investigating an issue, in the Issues table, you can right-click to Run an Automation on one or more issues. For more information, see Run an automation on an issue.Run an automation on an issue

#### 6.8.3. Manage automation exclusion policies

##### Note

* For the IAM User Hard Remediation and User Soft Remediation policies, we recommend including username, email, and ID for each user you want to exclude. Example: username1, user@example.com, userID112.

* You can also right click on a policy from the main Automation Exclusion Center page to disable or enable the policy. If you click on a list name in the Exclude column, that list opens in the Lists page.

#### 6.8.4. Playbooks

##### 6.8.4.1. Playbooks overview

##### 6.8.4.2. Playbook development checklist

##### 6.8.4.3. Plan your playbook

##### 6.8.4.4. Manage playbooks

###### Note

* The library by default shows only playbooks that are not adopted. Click the Show Adopted checkbox to show the adopted playbooks, indicated by an Adopted mark. The library shows the most updated playbook version. Adopting an older version than shown should be done through Marketplace. Adopting a playbook does not make it run. Some content packs include...

##### 6.8.4.5. Build your playbook

###### 6.8.4.5.1. Task 1. Choose from existing playbooks or create your own

####### Tip

* If there are additional relevant playbooks in Marketplace that are not in your Org repository, you can click Explore them now to see them in the Playbook Catalog and choose to adopt.

* To open multiple playbooks at the same time, edit the first playbook and then click New next to the playbook name to create a new tab. You can either create a new playbook, or add an existing one. You can view recently modified or deleted playbooks by clicking version history for all playbooks .

####### Navigation

  the Investigation & Response → Automation → Playbooks page to customize or create a playbook

###### 6.8.4.5.2. Task 2. Configure playbook settings

####### Note

* If the playbook has inputs and outputs, the Playbook Starts task will show back and forth arrows. Clicking them opens the Playbook Settings pane Inputs/Outputs tab.

* This rule will trigger the playbook to run if no other Automation Rule triggers the playbook first. You can view and edit the order the rules run in the Automation Rules page.

* If you do not add any fields, the group will be deleted when you click Save.

###### 6.8.4.5.3. Task 3. Add objects from the Task Library

####### 6.8.4.5.3.1. Add Quick Actions, commands, and scripts

######## Note

* If the Quick Action requires an integration instance and it is not yet configured, you have the option to create an integration instance from within the playbook editor.

* If you want to add a script that is not yet adopted, Cortex XSIAM automatically installs the content pack containing the script. If the script requires an integration instance, you are prompted to configure one.

* If you do not have permission to download the script, contact your administrator for help. You can also filter by "show only configured" to show scripts you can use.

* The output value is dynamic and is derived from the context at the time that the task is processed. As a result, parallel tasks that are based on the same output may return inconsistent results.

####### 6.8.4.5.3.2. Add sub-playbooks

######## Tip

* Balance between the number of iterations and the interval so you do not overload the server.

####### 6.8.4.5.3.3. Add manual tasks and blank tasks

######## 6.8.4.5.3.3.1. Create a standard task

######## 6.8.4.5.3.3.2. Create a conditional task

######## 6.8.4.5.3.3.3. Create a communication task

####### 6.8.4.5.3.4. Create a section header

####### 6.8.4.5.3.5. Configure script error handling in a playbook

######## Note

* Use the GetErrorsFromEntry script (part of the Common Scripts Pack) to check whether the given entry returns an error and returns an error message. For example, when using the script in a playbook, you can fetch the error message from a given task, such as a runtime error. You can then add a step in the playbook flow to send those error messages to the...

* You can set up script error handling only when running a script in a Standard task or a Conditional task. For more information about error handling settings for these tasks, see Create a standard task or Create a conditional task. Built-in, Manual, and Ask Conditional tasks have On Error settings for number of retries and retry interval, but not Error...

###### 6.8.4.5.4. Task 4. Add custom playbook features

###### 6.8.4.5.5. Task 5. Test and debug the playbook

###### 6.8.4.5.6. Task 6. Manage playbook content

##### 6.8.4.6. Customize your playbook

###### 6.8.4.6.1. Configure a sub-playbook loop

####### Note

* Consider the following when adding a loop: The maximum number of loops (default is 100). A high number of loops or a high wait time combined with a large number of issues may affect performance. Periodically check looping conditions to ensure they are still valid for the data set. If you want a sub playbook task to loop over an array passed into its...

####### Tip

* Balance between the number of iterations and the interval so you do not overload the server.

###### 6.8.4.6.2. Filter and transform data

####### Caution

* You can change the context data root to filter, but it is not recommended to select a different root, as it affects the filter results. The drop-down list displays the filter root for backward compatibility.

####### Navigation

  Investigation & Response → Automation → Scripts → New Script

####### 6.8.4.6.2.1. Filter considerations, categories, and built-in filters

######## Note

* Is defined considers false and empty strings and lists to be defined values. If you don't want those to be included as defined, use Is not empty.

* Not defined considers false and empty strings and lists to be defined values. If you don't want those to be included as defined, use Is empty.

####### 6.8.4.6.2.2. Transformer considerations, categories, and built-in transformers

######## Note

* To make regex case non-sensitive, use the (?i) prefix (for example (?i)yourRegexText.

###### 6.8.4.6.3. Extract indicators

####### Note

* This configuration may delay playbook execution (issue creation). While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

###### 6.8.4.6.4. Extend context

###### 6.8.4.6.5. Update issue fields with playbook tasks

####### Note

* The setIssue script includes all available fields; use the scroll bar to see all the fields. The name field has a limit of 600 characters. If there are more than 600 characters, you can shorten the name field to under 600 characters and then include the full information in a long text field such as the description field. There are many fields already...

###### 6.8.4.6.6. Playbook polling

####### Note

* You need to use the GenericPolling playbook as a sub-playbook in a main playbook, such as Detonate File - JoeSecurity. The main playbook should follow this structure: Start Command: The task contains a command that fetches the initial state of the process and saves it to context. This command starts the process that should be polled. For...

##### 6.8.4.7. Test your playbook

###### Note

* The debugger does not support using parentIncidentFields.

* Using an existing issue in the debugger does not affect the original issue or change the original context data.

###### 6.8.4.7.1. Troubleshoot playbook performance

##### 6.8.4.8. Manage playbook content

##### 6.8.4.9. Best practices

###### Note

* If you reattach a detached playbook, any customizations you have made to the playbook will be overwritten when the playbook updates to the current version.

* Retries are not supported for data collection tasks that have errors sending emails (indicated by a server timeout). This is because retries only work on automation execution failures, not on email delivery issues.

#### 6.8.5. Create an automation rule

##### Note

* You can also define the conditions that trigger a specific playbook in the playbook editor. For more information, see Task 2. Configure playbook settings

##### Important

* Automation rules apply to Medium and higher severity issues. They also apply to Low severity Analytic issues and Low severity ABIOC issues that are tagged with Identity or Cloud. Rules are evaluated in order, and only the first rule that matches the trigger conditions is executed.

#### 6.8.6. Context data

##### 6.8.6.1. Issue context data

##### 6.8.6.2. Case context data

##### 6.8.6.3. Search context data

##### 6.8.6.4. Add context data to an issue

##### 6.8.6.5. Add context data to a case

###### Note

* If you run the command in the issue War Room, the data is added to the following places: The case context data. The issue context data under the case tab. If you run the command in the Case War Room, the data is added to the case context data only.

##### 6.8.6.6. Delete context data from a case

##### 6.8.6.7. Use context data in a playbook

###### Note

* Generic polling does not work if a playbook's context data is shared globally. For more information, see Playbook polling.

###### Caution

* Users with Trigger Playbook permissions on a given issue may still be able to modify the parent case via commands and scripts, even without full access to the case.

#### 6.8.7. Lists

##### Note

* The maximum list size is 209,715 characters (approximately 200 KB).

##### 6.8.7.1. Create a list

###### Note

* If you want to edit a list from a content pack, you need to duplicate or detach a list. Detached lists do not receive updated content in subsequent Cortex XSIAM content releases. To retain an updated list, reattach it.

###### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

##### 6.8.7.2. List commands

##### 6.8.7.3. Use cases: JSON lists

###### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

  Investigation & Response → Automation → Playbooks → New Playbook

##### 6.8.7.4. Transform a list into an array

###### Navigation

  Investigation & Response → Automation → Playbooks and create or edit a playbook

#### 6.8.8. Jobs

##### 6.8.8.1. Manage jobs

###### Note

* Only Account Admins and Instance Administrator roles can create jobs and view/edit job runs. If the owner of a job has been removed from Cortex XSIAM, the job will fail to run. In this case, you must change the owner to a current user.

##### 6.8.8.2. Create a time triggered job

###### Note

* To view a human readable description of a cron schedule for an existing job, click  and select Job Schedule from the available columns.

###### Important

* We recommend to avoid triggering a job while a previous run of the job is active by configuring the playbook a job triggers to close the investigation before running a new instance of the job.

##### 6.8.8.3. Create a job triggered by a delta in a feed

###### Note

* A job triggered by a delta in a feed runs only if there is a change in the feed, and does not run on a feed's initial fetch. For the initial fetch, you can run the playbook manually and then set up an event triggered job for subsequent fetches. If you want to trigger a job after a feed completes a fetch operation and the feed does not change...

###### Navigation

  Investigation & Response → Automation → Jobs → New Job

#### 6.8.9. Engines

##### 6.8.9.1. What is an engine?

###### Note

* You cannot share a multiple-engine installation with a single-engine installation.

* When you add an engine to a load-balancing group, you cannot use that engine separately. The engine does not appear in the engines menu when configuring an integration instance, but you can choose the load-balancing group.

##### 6.8.9.2. Engine requirements

###### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

##### 6.8.9.3. Install an engine

###### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex XSIAM engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

###### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

###### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

###### 6.8.9.3.1. Docker

####### Note

* This section is relevant when installing an engine.

* Docker images can be downloaded together with their relevant content packs for offline installation.

####### 6.8.9.3.1.1. Install Docker

######## Note

* For Red Hat's Docker distribution, you need Mirantis Container Runtime (formerly Docker Engine - Enterprise) to run specific Docker-dependent integrations and scripts. For more information, see Install Docker distribution for Red Hat on an engine server. To use the Mirantis Container Runtime (formerly Docker Engine - Enterprise) follow the deployment...

######## 6.8.9.3.1.1.1. Install Docker distribution for Red Hat on an engine server

######## 6.8.9.3.1.1.2. Docker image security

######## 6.8.9.3.1.1.3. Docker FAQs

######## 6.8.9.3.1.1.4. Troubleshoot Docker issues

######## 6.8.9.3.1.1.5. Configure Docker pull rate limit

######## 6.8.9.3.1.1.6. Change the Docker installation folder

####### 6.8.9.3.1.2. Docker hardening guide

######## Note

* The settings below can also be applied to Podman, with the exception of limiting available memory, limiting available CPU, and limiting PIDS.

* If you do not want to apply Docker memory limitations, you should explicitly set the advanced parameter: limit.docker.memory to false.

######## Tip

* We recommend reviewing Docker network hardening below before changing any parameters in the configuration file. To securely run Docker containers, we recommend using the latest Docker version.

###### 6.8.9.3.2. Podman

####### Note

* When upgrading an engine, the engine keeps the previously used container management type (regardless of distribution version).

####### 6.8.9.3.2.1. Change the container storage directory

######## Note

* Alternatively, the runroot setting may be set to some temporary directory that is accessible by the user demisto. If you choose to set the runroot, it must be a directory that is mounted as tmpfs (temporary filesystem), unlike the graphroot.

######## Warning

* Do not use NAS storage or a temporary (tmpfs) directory for the graphroot setting. The graphroot needs to be a local, non-temporary directory for Podman to work. For more information, see https://en.wikipedia.org/wiki/Network-attached_storage.

######## Tip

* We recommend reserving 150 GB for container storage, either in the /home partition or a different storage directory that you have set using the graphroot key.

####### 6.8.9.3.2.2. Install Podman

######## Note

* This procedure is intended for RHEL 8 or later. It may not work for other operating system types. Do not use NAS storage for the $HOME directory. The directory needs to be a local directory for Podman to work.

* If you edit the file with the root user, make sure to set the demisto user as file owner by running chown demisto:demisto /home/demisto/.config/containers/registries.conf

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

####### 6.8.9.3.2.3. Migrate From Docker to Podman

####### 6.8.9.3.2.4. Troubleshoot Podman

######## Note

* This step removes all Podman images, including any custom images you may have created.

* $(id -u demisto) is used to get the demisto user ID, which is part of the directory name. For example, /tmp/podman-run-993 Not all the directories above may be present.

* When you run podman container cleanup --rm -a, you might see a message such as running or paused containers cannot be moved without force. The message can be safely ignored, as it only pertains to current running containers, which are not removed.

* To change to the demisto OS user, run the following command: sudo su - -s /bin/bash demisto

* You must switch to user demisto before running the "system migrate" (running it as root will have no effect).

* The "system migrate" must be done by the user demisto.

######## Important

* The runroot must be located under the tmpfs file system type. This is required to clean Podman's run state on reboot and for performance reasons.

######## Caution

* Unlike the runroot, the graphroot must NOT be located under the tmpfs file system type. Using tmpfs for the graphroot might corrupt container images, causing command executions to fail. It also degrades performance by forcing Podman to needlessly re-pull images.

##### 6.8.9.4. Manage engines

###### Navigation

  You can manage your engines and load-balancing groups by going to Settings → Configurations → Data Broker → Engines

##### 6.8.9.5. Upgrade an engine

###### Note

* The upgrade.conf file is available on the engine after it has been upgraded to Cortex XSIAM 3.1. Any custom variables you add to the file are applied when you upgrade from Cortex XSIAM 3.1 to Cortex XSIAM 3.2 or later.

##### 6.8.9.6. Remove an engine

##### 6.8.9.7. Configure engines

###### Note

* A day is defined as 24 hours and may not exactly correspond to calendar days due to daylight savings, leap seconds, etc.

* In addition, to support engine upgrades from the UI, edit the /usr/local/demisto/upgrade.conf file on the engine to include the SERVER_URLS setting with the new tenant's address. Include only the host, without https:// or any additional path at the end of the host name. For example: SERVER_URLS="api-example.us.paloaltonetworks.com"

* If the engine loses communication for longer than this time, it will disconnect and you need to restart the service.

###### 6.8.9.7.1. Configure the engine to use a web proxy

####### Note

* You need to configure Docker to use a proxy. When using a BlueCoat proxy, ensure you encode the values correctly.

* In an environment with a single engine, go to /usr/local/demisto/upgrade.conf. In an environment with multiple engines, go to /usr/local/demisto/<engine-name>/upgrade.conf, replacing <engine-name> with the name of the engine. Note that the key is in the upgrade.conf file and must be https_proxy, even if your proxy address starts with http://.

###### 6.8.9.7.2. Configure the engine to call the server without using a proxy

####### 6.8.9.7.2.1. Use NGINX as a reverse proxy

######## Note

* For multi-tenant deployments, replace location ~ ^/(websocket|d1ws|d2ws) { with location ~ ^/(acc_\S+/)?(websocket|d1ws|d2ws)

###### 6.8.9.7.3. Configure an engine to use custom certificates

##### 6.8.9.8. Use an engine in an integration

###### Note

* Long-running integrations should not run on load-balancing groups.

##### 6.8.9.9. Run a script using an engine

###### Navigation

  Investigation & Response → Automation → Scripts

##### 6.8.9.10. Troubleshoot engines

###### Note

* Ensure that pop-ups are not blocked by your browser.

* If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom path. --keep - Extracts the installer files into the current working directory (without cleaning at the end). If using installer...

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl status d1_<Engine _name>

* Any changes made to variables in the upgrade_engine.sh file are reset after each upgrade. We recommend instead using the upgrade.conf file to set variables.

* You can ignore the following error: Cannot create folder '/var/lib/demisto'

###### Navigation

  When troubleshooting engines, access the logs from Settings → Configurations → Engines and select the engine from which you want to download the logs

##### 6.8.9.11. Troubleshoot integrations running on engines

###### Note

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

* Docker CE installations typically run Docker, while Docker EE installations typically run dockerroot.

### 6.9. Response actions

#### Caution

* Response actions are not supported for Android endpoints.

#### 6.9.1. Initiate a Live Terminal session

##### Note

* You can run PowerShell 5.0 or a later release on Live Terminal of Windows.

* Network drives are not supported.

* On Windows endpoints, you cannot run GUI-based cmd commands like winver or appwiz.cpl.

* Disabling Live Terminal does not take effect on sessions that are in progress.

##### Tip

* You can fine-tune the Live Terminal session visibility on the endpoint by adjusting the User Interface options in your Agent Settings Profile.

#### 6.9.2. Isolate an endpoint

##### Note

* IP-based file storage protocol traffic will also be blocked. This might affect endpoint functionality if the endpoint uses such mounts.

* If file system operations become unresponsive during isolation, such as being unable to list folder content, unmount the mounted network shares.

##### Tip

* If needed, Filter the list of endpoints.

#### 6.9.3. Pause endpoint protection

##### Note

* Pausing your endpoint protection modules leaves your machines exposed to risks.

##### Navigation

  Investigation & Response → Response → Action Center and locate Action Type Pause Endpoint Protection or Resume Endpoint Protection

#### 6.9.4. Remediate changes from malicious activity

##### Prerequisite

* To initiate remediation suggestions, you must have the following system requirements: An App Administrator, Privileged Responder, or Privileged Security Admin role permissions which include the remediation permissions. EDR data collection enabled. Agent version 7.2 or above on Windows endpoints.

##### Note

* Endpoints that are part of the Case view and do not meet the required criteria are excluded from the remediation analysis.

#### 6.9.5. Run agent scripts on an endpoint

##### Prerequisite

* To run scripts on an endpoint, you must have the following system requirements: Endpoints running the Agent v7.1 and later. Since the agent uses its built-in capabilities and many available Python modules to execute the scripts, no additional setup is required on the endpoint. Role in the hub with the following permissions to run and configure...

##### Note

* *Since all scripts are running under System context, you cannot perform any registry operations on user-specific hives (HKEY_CURRENT_USER of a specific user).

* Always use lowercase for variable names.

* Disabling Script Execution does not take effect on scripts that are in progress.

#### 6.9.6. Search and destroy malicious files

##### Prerequisite

* The following are prerequisites to enable Cortex XSIAM to search and destroy files on your endpoints: Supported platforms:    Windows: Cortex XDR agent version 7.2 or a later. If you plan to enable Search and Destroy on VDI sessions, you must perform the initial scan on the Golden Image.   Mac: Cortex XDR agent version 7.3 or a later release running on...

##### Note

* The Cortex XSIAM agent does not include the following information in the local files inventory: Information about files that existed on the endpoint and were deleted before the Cortex XSIAM agent was installed. Information about files where the file size exceeds the maximum file size for hash calculations that are pre-configured in Cortex XSIAM . If...

#### 6.9.7. Manage external dynamic lists

##### Note

* To configure an EDL, you must have a role that includes EDL permissions, such as Instance Admin or Account Admin. Configuring custom certificates or private API Keys in the EDL integration instance is supported only on engines, not on the Cortex XSIAM server. For EDL integrations on the server, you must set a username and password. For long-running...

* The legacy external dynamic list PAN-OS integration is deprecated. Configure the EDL integration by clicking the Automation & Feed Integration link.

* If the EDL integration runs on the Cortex XSIAM server, you do not need to enter a Listen Port in the instance settings. The system auto-selects an unused port for the EDL integration when the instance is saved. If you enter a value for Listen Port, it will be overwritten by the port auto-selected by the system

##### Important

* The EDL URL must always be prefixed by ext-.

#### 6.9.8. Collect a memory image

##### License Type

  This functionality has the following license requirements: Forensics add-on license.

### 6.10. Forensics

#### License Type

  Requires the Forensics add-on

#### 6.10.1. Forensic investigations

##### 6.10.1.1. Manage an investigation

###### 6.10.1.1.1. Create a new investigation

####### Note

* To set up user permissions, you must have Scope-Based Access Control (SBAC) enabled.

###### 6.10.1.1.2. Edit an investigation

###### 6.10.1.1.3. Close an investigation

####### Note

* When you close an investigation, Palo Alto Networks has a grace period of 24 hours before deleting any collections associated with the investigation. During this timeframe, you have the option to cancel the close investigation action.

###### 6.10.1.1.4. User permissions

####### Note

* Even if a user does not have access to view an investigation via the Forensics Investigations page, they can still query the results of the collections using an XQL query.

##### 6.10.1.2. Data collection

###### 6.10.1.2.1. Hunting

####### 6.10.1.2.1.1. Create a hunt

######## Note

* You can save hunts in an incomplete state and edit them later. After a hunt has run, you cannot edit it. Instead, you can duplicate to create a new hunt with the same configuration in order to edit.

* When search fields are specified, the results of the search are limited based upon those filters. If more than one entry in a search filter field, the search returns entries that match any of the provided entries. For example: A File Search with two specified paths ("C:\Test\*" and "C:\Windows\*") will return results from both the Test folder and the...

####### 6.10.1.2.1.2. Hunt results

######## Note

* The grouping button () shows the number of affected endpoints grouped by executable name. This enables you to perform hunting via frequency analysis (referred to as stacking) and provides a birds eye view of potential malware files that require further analysis.

* The grouping button () shows the number of affected endpoints grouped by file path. This enables you to perform hunting via frequency analysis (referred to as stacking) and provides a birds eye view of potential malware files that require further analysis.

####### 6.10.1.2.1.3. Hunt status

###### 6.10.1.2.2. Triage

####### 6.10.1.2.2.1. Create a triage

####### 6.10.1.2.2.2. Upload an offline triage package

######## Note

* Do not upload memory images captured by the Offline Triage Collector. These images are collected for analysis using third-party tools and are not intended for upload.

####### 6.10.1.2.2.3. Offline triage collection

######## Note

* Security software running on the endpoint (including the Cortex agent) can interfere or block the execution of the offline triage collector. Disable any security software on the endpoint while the collector is running or whitelist the collector in your security software before running the offline triage collector.

####### 6.10.1.2.2.4. Triage results

####### 6.10.1.2.2.5. Triage status

##### 6.10.1.3. Analysis and documentation

###### 6.10.1.3.1. Review alerts

###### 6.10.1.3.2. Investigation timeline

###### 6.10.1.3.3. Key assets & artifacts

##### 6.10.1.4. Export

###### Note

* You can export a collection more than once.

### 6.11. Notebooks

#### Prerequisite

* Cortex XSIAM Notebooks usage requires the following. Cortex XSIAM Enterprise or Cortex XSIAM Premium. Apps and XQL RBAC permissions.    To use Notebooks, you must have the View/Edit permissions in Settings → Configurations → Access Management → Roles → Apps → Jupyter.   To configure Notebooks, you must have the View/Edit permissions...

#### Note

* You can only add one instance of Notebooks. Cortex XSIAM Notebooks has access to approved sites on the internet when embedded in Cortex XSIAM. The Notebooks instance includes restart options.

#### Navigation

  Settings → Configurations → Integrations → Apps

  To edit the Notebooks instance, from Settings → Configurations → Integrations → Apps, hover over the instance and select the edit icon

#### 6.11.1. Manage datasets in Notebooks

##### Note

* If a schema is not provided, the function detects the schema automatically.

* Using this function, you can only delete datasets created using the Notebooks APIs . When you delete a dataset, the rules that use the dataset return an error.

#### 6.11.2. Notebooks scheduler

### 6.12. Build XQL queries

#### 6.12.1. About the Query Builder

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

#### 6.12.2. How to build XQL queries

##### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

##### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

##### 6.12.2.1. Get started with XQL queries

###### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

##### 6.12.2.2. Useful XQL user interface features

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

##### 6.12.2.3. XQL Query best practices

##### 6.12.2.4. Expected results when querying fields

##### 6.12.2.5. Create XQL query

###### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

##### 6.12.2.6. Review XQL query results

###### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* In order for Cortex XSIAM to provide a histogram for a field, the field must not contain an array or a JSON object.

##### 6.12.2.7. Translate to XQL

###### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

##### 6.12.2.8. Graph query results

###### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

#### 6.12.3. Query Builder templates

##### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

##### 6.12.3.1. Get started with Query Builder templates

##### 6.12.3.2. Considerations for using Query Builder templates

##### 6.12.3.3. Create a query from a template

###### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

##### 6.12.3.4. Run a free text query

###### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

##### 6.12.3.5. Query Builder template examples

###### Navigation

  Investigation & Response → Search → Query Builder

#### 6.12.4. Edit and run queries in Query Center

##### Navigation

  Investigation & Response → Search → Query Center

##### 6.12.4.1. Query Center reference information

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 6.12.5. Manage scheduled queries

##### Navigation

  Investigation & Response → Search → Scheduled Queries

##### 6.12.5.1. Scheduled Queries reference information

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 6.12.6. Manage your personal query library

##### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

#### 6.12.7. Legacy Query Builder

##### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

##### 6.12.7.1. Create authentication query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.12.7.2. Create event log query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.12.7.3. Create file query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.12.7.4. Create image load query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.12.7.5. Create network connections query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.12.7.6. Create network query

###### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

##### 6.12.7.7. Create process query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.12.7.8. Create registry query

###### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

##### 6.12.7.9. Query across all entities

###### Navigation

  Investigation & Response → Search → Query Builder

### 6.13. Research a known threat

## 7. Threat management

### 7.1. Enable prompt log collection in Azure

### 7.2. Detection rules

#### 7.2.1. What are detection rules?

##### 7.2.1.1. What's an IOC?

###### Note

* Cortex XSIAM supports a maximum of 4,000,000 IOCs.

###### 7.2.1.1.1. IOC rule details

####### Note

* Field cannot exceed 36 characters.

####### Navigation

  In the Threat Management → Detection Rules → IOC page, you can view all configured or uploaded indicators of compromise (IOCs

###### 7.2.1.1.2. Create an IOC rule

####### Note

* To ensure your IOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically does the following: Disables any IOC rules that reach 5000 or more hits over 24 hours. Creates a rule exception based on the PROCESS SHA256 field for IOC rules that hit more than 100 endpoints over 72 hours. If you have the Threat...

####### Navigation

  In Threat Management → Detection Rules → IOC, select + Add IOC

##### 7.2.1.2. What's a BIOC?

###### 7.2.1.2.1. BIOC rule details

####### Navigation

  Manage your behavioral indicator of compromise (BIOC) rules in Threat Management → Detection Rules → BIOC

###### 7.2.1.2.2. Create a BIOC rule

####### License Type

  Custom prevention rules are supported on Cortex XSIAM agent 7.2 and later versions and enable you to configure and apply user-defined BIOC rules to Restriction profiles deployed on your Windows, Mac, and Linux endpoints.

####### Note

* To ensure your BIOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically does the following: Disables BIOC rules that reach 5000 or more hits over a 24-hour period. Creates a rule exception based on the PROCESS SHA256 field for BIOC rules that hit more than 100 endpoints over a 72 hour period.

* A cloud_audit_log dataset requires a Cortex XDR Pro per GB license. Currently, you cannot create a BIOC rule on customized datasets and only the filter stage, alter stage, and functions without any aggregations are supported for XQL queries that define a BIOC. For BIOC rules, the field values in XQL are evaluated as case insensitive (config...

* To demonstrate the expected behavior of the rule before you save it, Cortex XSIAM tests the BIOC on historical logs. After you save a BIOC rule, it will operate both on historical logs (up to 10,000 hits) and on new data received from your log sensors.

* To demonstrate the expected behavior of the rule before you save it, Cortex XSIAM tests the BIOC on historical logs. After you save a BIOC rule, it will operate on both historical logs (up to 10,000 hits) and new data received from your log sensors.

* You can only import files that were exported from Cortex XSIAM. You can not edit an exported file.

* You can only add to existing profiles you created, Cortex XSIAM Default profiles will not appear as an option.

* Auto-disable will turn off both the BIOC rule detection and the BIOC prevention rule.

###### 7.2.1.2.3. Manage Global BIOC Rules

##### 7.2.1.3. What's a correlation rule?

###### Navigation

  After you configure your correlation rules, you can manage them in Threat Management → Detection Rules → Correlations, and view and analyze the generated issues in Cases and the Issues Table

###### 7.2.1.3.1. Correlation rule details

####### Note

* Only an administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM .

* For more information on troubleshooting server errors in scheduled correlation rules, Troubleshoot server errors in scheduled correlation rules.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

####### Navigation

  If you are assigned a role that enables Investigation → Rules privileges, you can manage all user-defined Correlation Rules from Threat Management → Detection Rules → Correlations

###### 7.2.1.3.2. Create a correlation rule

####### Prerequisite

* To enable pivots from issues to a third-party source system, ensure that you know the dataset field name which contains the URL of the source system. Some vendors already provide this URL as part of their API, and you can find it in the third-party product dataset. If there is no URL, you cannot enable this feature.

####### Note

* When creating a Real Time Correlation Rule, you can only generate an issue as the resulting action for the Correlation Rule. All other options are disabled. To ensure your Correlation rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically disables Correlation rules that reach 5000 or more hits over a...

* When you open the New Correlation Rule editor from XQL Search, this XQL Search field is already populated with the XQL query that you defined. An administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM . All other users can only create and view queries built with an existing dataset.

* The XQL features for call, top, and wildcards in datasets (dataset in (<dataset prefix>_*)) are currently not supported in Correlation Rules. If you add them to the XQL definition, you will not be able to Create or Save the Correlation Rule. The XQL features for transaction in datasets (dataset in (<dataset prefix>_*)) are currently not supported in...

* The incident that contains the issues will also be assigned to the selected domain. For more information, see Case and issue domains. If you want to generate a health issue, choose the Health domain. For more information about health issues, see About health issues.

* If a generated issue has severity Medium or above, a case is automatically opened. Low severity issues generated by correlation rules are not grouped into cases.

* There is no validation or auto complete for these parameters and the values can be null or empty. In these scenarios, Cortex XSIAM does not display the null or empty values, but adds the text NULL or EMPTY in the descriptions.

* When more than one XDM field is listed, Cortex XSIAM looks for the field value according to the order of the fields listed.

* When Use the Cortex XSIAM default incident enrichment is not selected and you have not mapped any issue fields, the issue is dispatched into a new incident.

####### Important

* The maximum size of a lookup dataset is 50 MB. If the data exceeds this limit, the add to lookup action fails.

####### Tip

* When creating your correlation rule, you can use predefined values for different fields in the editor, such as Alert Name, Alert Description, and Drill-Down Query. For more information, Field replacement syntax in correlation rules.

####### Navigation

  You can create a new correlation rule from either the Threat Management → Detection Rules → Correlation Rules page or when building a query in XQL Search

###### 7.2.1.3.3. Field replacement syntax in correlation rules

###### 7.2.1.3.4. Manage correlation rules

####### Note

* Execute Rule is not available for real time correlation rules.

###### 7.2.1.3.5. Monitor correlation rules

####### Note

* In the dataset, the Query start time and Query end time indicate the time frame of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

###### 7.2.1.3.6. Troubleshoot server errors in scheduled correlation rules

##### 7.2.1.4. Manage IOC and BIOC rules

###### Note

* For Analytics BIOC rules, you can only disable and enable rules.

* You cannot delete global BIOCs delivered with content updates.

* For BIOC rules that are applied to prevention profiles: If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention on the agent works as usual. If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention...

* When a BIOC rule is disabled automatically by Cortex XSIAM, for example due to the server anti flooding mechanism, prevention on the agent works as before.

###### Navigation

  Threat Management → Detection Rules → BIOC

### 7.3. Analytics

#### 7.3.1. Analytics engine

#### 7.3.2. Analytics sensors

#### 7.3.3. Coverage of MITRE Attack tactics

#### 7.3.4. Review MITRE ATT&CK framework coverage

##### Note

* When a contributing data source type is active, it does not imply that all the rules and detectors associated with the data source type are active. Rule applicability is dependent on the data source's context and configuration. To enable an active status, data source types require the following setup: Endpoint: Installed Cortex XDR agent. Network: A...

#### 7.3.5. Analytics detection time intervals

##### Note

* When establishing a baseline, detectors compute limits beyond which network activity will require an issue. In some cases, detectors do not compute baseline limits; instead they are predetermined by Cortex XSIAM engineers. The engineers determine the values used for predetermined limits using statistical analysis of malicious activity recorded...

#### 7.3.6. Analytics issues and Analytics BIOCs

#### 7.3.7. View and manage Analytics rules

#### 7.3.8. Identity Analytics

##### Navigation

  After configuring your Cloud Identity Engine instance and Cortex XSIAM Analytics, select Settings () → Configurations → Cortex XSIAM - Analytics, and in the Featured in Analytics section, Enable Identity Analytics

#### 7.3.9. Identity Threat Module (ITDR)

#### 7.3.10. AI Detection & Response in Cortex XSIAM (Beta)

##### Prerequisite

* To enable AIDR, you must have one of the following user roles: Instance Admin or Account Admin.

##### Navigation

  Settings → Configurations → Cortex - Analytics

##### 7.3.10.1. Data sources and supported services

##### 7.3.10.2. AI Detection & Response Dashboard

##### 7.3.10.3. Collect prompt logs

###### 7.3.10.3.1. Prompt log collection in AWS

###### 7.3.10.3.2. Enable prompt log collection in Azure

####### 7.3.10.3.2.1. Configure the Azure Event Hub collection in Cortex XSIAM

####### 7.3.10.3.2.2. Set up prompt logging

####### 7.3.10.3.2.3. Log HTTP data

####### 7.3.10.3.2.4. Configure diagnostic settings:

### 7.4. Threat Intel Management

#### 7.4.1. Get started with Threat Intel Management

##### Note

* By default, the Palo Alto Networks Wildfire Reports integration, which is used as part of the sample analysis feature, is installed and configured. The Palo Alto Networks Wildfire v2 integration, for dynamic malware analysis, is also installed, but you must add an integration instance. No API key is required.

##### 7.4.1.1. What is Threat Intel Management?

##### 7.4.1.2. Threat Intel Management use cases

###### Navigation

  Settings → Configurations → Data Collections → Automation & Feed Integrations and in the Category field, select Threat Intel Feeds

##### 7.4.1.3. Roles and responsibilities in Threat Intel Management

##### 7.4.1.4. Indicator concepts

###### Note

* You can store up to 100,000,000 indicators.

##### 7.4.1.5. Indicator lifecycle

###### Note

* To run enhancement scripts and reputation commands, you must configure a relevant enrichment integration, such as VirusTotal, IPinfo v2, etc.

###### Tip

* We recommend defining your policy for handling expired indicators.

#### 7.4.2. Indicator configuration

##### 7.4.2.1. Customize indicator fields and types

###### 7.4.2.1.1. Create an indicator type

####### Note

* If you miss mapping any field, you can create additional new indicator fields and either relate them to all indicator types, or relate them only to the new indicator type (recommended).

####### Navigation

  Settings → Configurations → Object Setup → Indicators → Types

####### 7.4.2.1.1.1. Indicator type profile

######## Note

* Indicator cache expiration rules only apply to standard enrichment (for example, running the enrichIndicators command). If you run a reputation command, such as !ip, the commands executes even if the cache has not expired.

####### 7.4.2.1.1.2. File indicators

######## Note

* A new File indicator only affects new indicators ingested to the Cortex XSIAM platform. Indicators that were already in Cortex XSIAM continue to appear as their respective hash-related indicators.

######## Navigation

  Settings → Configurations → Object Setup → Indicators → Types

####### 7.4.2.1.1.3. Formatting scripts

######## Note

* Formatting scripts must have the indicator-format tag to appear in the list.

* Formatting scripts for out-of-the-box indicator types are system-level, which means that the formatting scripts for these indicator types are not configurable. To create a formatting script for an out-of-the-box indicator type, you need to disable the existing indicator type and create a new (custom) indicator type. If you configured a formatting...

####### 7.4.2.1.1.4. Enhancement scripts

######## Note

* Enhancement scripts are different from reputation commands. A reputation command runs every integration that has that command within it, to enrich the indicator. The reputation command ip , for example, runs every IP integration command in your enabled integrations, to collect data from multiple sources. An enhancement script is manually run after the...

* Enhancement scripts must have the enhancement tag applied to appear in the list.

####### 7.4.2.1.1.5. Reputation scripts

######## Note

* The Reputation script overrides any default settings for the indicator that relates to the verdict.

* Reputation scripts must have the reputation tag applied to appear in the list.

####### 7.4.2.1.1.6. Reputation commands

######## Note

* Running a reputation command directly (such as !ip) might not apply the result to an indicator, nor does it use the enrichment cache. To ensure an indicator is enriched, and to take advantage of caching, use the enrichIndicators command or the Enrich button in the UI. This runs the appropriate reputation command/script based on the indicator type...

####### 7.4.2.1.1.7. Map custom indicator fields

######## Note

* Some integrations have indicator mappers and classifiers, such as AWS. If you want to use an integration mapper or classifier, see Indicator classification and mapping.

######## Navigation

  Settings → Configurations → Object Setup → Indicators → Types

###### 7.4.2.1.2. Create an indicator field

####### Note

* Cortex XSIAM IOC fields are based on the STIX 2.1 specifications. For more information, see Indicator field structure.

* The following HTML tags are not permitted: blockquote, del, dd, div, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, iframe, ins, li, math, noscript, ol, pre, p, script, style, table, ul, address, article, aside, canvas, details, dialog, figcaption, figure, footer, header, hgroup, main, nav, output, progress, section, video. The following CSS tags...

####### Navigation

  Settings → Configurations → Object Setup → Indicators → Fields → New Field

####### 7.4.2.1.2.1. Indicator field structure

####### 7.4.2.1.2.2. Indicator field trigger scripts

######## Note

* Indicator field trigger scripts must have the field-change-triggered-indicator tag to appear in the list.

##### 7.4.2.2. Indicator classification and mapping

###### Note

* When creating a new indicator type, you classify and map the indicator fields in the indicator type settings. For more details, see Map custom indicator fields.

* You can optionally skip importing data. Click the pencil on the right of each indicator type on the right pane to enter the value manually.

* In the Classification & Mapping page, the mapping does not indicate for which indicator types they are configured. When creating a mapper, it is best practice to add to the mapper name and the indicator type the mapper is for. For example, Mail Listener - Phishing. When mapping a list, we recommend you map to a multi-select field. Short text fields do...

##### 7.4.2.3. Indicator extraction

###### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Reputation commands, such as !ip and !domain, can only be used after you configure and enable a reputation integration instance, such as VirusTotal and Whois.

* The inline configuration may delay playbook execution.

* While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks. All indicators are automatically extracted and enriched before a playbook is run. For an on-field change, extraction occurs before the next playbook tasks run.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

###### 7.4.2.3.1. Set the indicator extraction mode for a playbook task

###### 7.4.2.3.2. Disable indicator extraction for scripts or integrations

##### 7.4.2.4. Configure indicator expiration

###### Note

* You need to run CLI commands in the Case or Issue War Room.

* If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its expiration method reverts to that of the indicator type (time-based). Time-based expiration is set according to feed reliability. If the same indicator appears on multiple feeds, the...

##### 7.4.2.5. Configure Threat Intelligence feed integrations

###### Note

* Some feeds only provide information about new indicators and do not specify when indicators are removed. Indicators from these feeds cannot be automatically expired on removal. If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its...

##### 7.4.2.6. Exclude indicators from enrichment

##### 7.4.2.7. Generate issues from indicators using indicator rules for prevention and detection

###### Note

* Indicators should be present in the Threat Intelligence database (Threat Management → Threat Intelligence → Indicators) before creating detection and prevention rules.

* Although you can create IOC rules for detection, indicator rules are designed to leverage threat intelligence indicators like MD5 and SHA256 hashes that are present in your TIM library. These rules directly integrate with and rely on the indicators ingested and managed by TIM. Indicators must be in the TIM database before creating these rules. For more...

* You can't change the Preventable = True, Status = Active and Type = File filters, which comply with the requirements of the supported indicator type for Prevention on the Agent.

* The Indicator Rule shows the number of issues generated by the rule, You can view the issues that were generated using the Indicator rule, by right-clicking the rule and select View related issues.

* You can't change the Detectable = True and Status = Active filters, which comply with the requirements of the supported indicator type for detection.

* The Issue source is Threat Intelligence.

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

##### 7.4.2.8. Export indicators

###### Caution

* You should not run a query on a field that you might change in the playbook flow. For example, you shouldn't have a playbook with query Verdict:Malicious and then change the indicator verdict as a part of the playbook.

#### 7.4.3. Indicator management

##### Note

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

#### 7.4.4. Query indicators with Unit 42 Intel data

##### Note

* You can search or look up indicators. A search, which can include wildcards and complex queries, can return multiple results. Searches are only performed in Cortex XSIAM. Lookups are exact values, are performed in both Cortex XSIAM and Unit 42 Intel data, and can only return one result.

#### 7.4.5. Indicator investigation

##### 7.4.5.1. Indicator verdict

##### 7.4.5.2. Extract and enrich an indicator

###### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Triggering enrichment on a substantial number of indicators can take time (because it's activating all enrichment integrations per indicator) and can result in performance degradation.

* Reputation commands, such as !ip, !domain can only be used when you configure and enable a reputation integration instance, such as VirusTotal and WHOIS.

##### 7.4.5.3. Expire an indicator

###### Note

* You need to run these commands in the Case or Issue War Room.

##### 7.4.5.4. Manage indicator relationships

###### Note

* You can also add an indicator relationship from the Quick View when selecting an indicator from an issue.

##### 7.4.5.5. Delete and exclude indicators

###### Caution

* Ensure you are using the correct syntax when defining the values for your exclusion lists.

##### 7.4.5.6. Investigate files using sample analysis

###### Note

* WildFire provides verdicts and analysis reports without requiring a license key. To send files to WildFire for analysis, see Set up Malware Prevention Profiles.Set up malware prevention profiles

* When searching on the Sample Analysis page for relationships -relationships"", some results may appear without their specific relationships listed, due to internal relationship permissions.

##### 7.4.5.7. Use sessions and submissions in your investigation

###### Note

* When searching on the Sessions & Submissions page for relationships -relationships"", some results may appear without their specific relationships listed, due to internal relationship permissions.

* The Application is matched to the type of application traffic detected in a session. For example, a search for the Application web-browsing returns sessions during which web browsing over HTTP occurred. See Applipedia for an updated list of applications that Palo Alto Networks identifies.

## 8. Inventory management

### 8.1. Asset management

#### 8.1.1. All Assets

##### Note

* Keep the following caveats in my mind when working with the Asset Inventory page: Instance Administrators are able to view all Inventory views without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope SBAC is not currently available for custom roles with View/Edit permissions on the...

* The options available are dependent on your license.

##### 8.1.1.1. Container Images

###### Navigation

  All Assets → Compute → Container Images

##### 8.1.1.2. Kubernetes Cluster

###### Navigation

  Inventory → All Assets → Compute → Kubernetes Cluster for a Kubernetes clusters assets overview

##### 8.1.1.3. Container Instances

###### Navigation

  Asset Inventory → Compute → Container Instances

##### 8.1.1.4. External Surface assets

###### License Type

  Requires the Attack Surface Management (ASM) add-on

###### 8.1.1.4.1. External Surface attribution evidence

#### 8.1.2. Network configuration

##### 8.1.2.1. Configure your network parameters

###### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

* Viewing external IP address ranges requires the Attack Surface Management add-on.

###### Navigation

  In Cortex XSIAM , select Assets → Network Configuration → Internal Domain Suffixes

#### 8.1.3. Asset Groups

##### Note

* When you create or edit an Asset Group, the changes are applied immediately to new assets and to existing assets that have been updated. However, it may take a few hours for the changes to appear on existing assets that have not been updated.

##### Navigation

  Inventory → Assets → Groups → Add Group

#### 8.1.4. Asset Roles

##### Note

* Asset Roles are available only if the Identity Threat Module add-on is enabled.

##### 8.1.4.1. Manage Asset Roles for Endpoints

###### Note

* Endpoint Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added endpoint removes the endpoint from the Included Endpoints list. If this endpoint is detected automatically as having this asset role in the future, it will appear in the Included Endpoints list. Excluding a manually added endpoint ensures that even if in the future the endpoint is detected as having this asset role, this...

##### 8.1.4.2. Manage Asset Roles for Users

###### Note

* User Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added user removes the user from the Included Users list. If this user is detected automatically as having this asset role in the future, it will appear in the Included Users list again. Excluding a manually added user ensures that even if in the future the user is detected as having this asset role, this detection is overridden and...

###### 8.1.4.2.1. Honey user

####### Prerequisite

* The honey user role is available only if the Identity Threat Module add-on is enabled.

#### 8.1.5. Manage Asset Scores

##### Note

* The Hosts tab is available if the Identity Threat Module add-on is enabled.

* As new alerts are associated with incidents, the User and Host Scores are recalculated. You can view the latest User and Host Scores on the Asset Scores page, or track the Score trend on the User Risk View and Host Risk View.

* Some User Associated Insights may not appear as part of the User Associated Incidents due to the insight generation mechanism. For example, when an insight related to one of the assets in an incident is generated a few days after the associated incident, the insight may not be associated with the incident.

#### 8.1.6. Vulnerability Assessment

##### Prerequisite

* The following are prerequisites for Cortex XSIAM to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XSIAM lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex XSIAM...

* The following are prerequisites for Cortex XSIAM to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex XSIAM collects all the information about the operating system and the installed...

##### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex XSIAM Application Inventory.

##### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

##### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

## 9. Modules

### 9.1. Discovery Engine

#### 9.1.1. What is the Discovery Engine?

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM product that has the Cloud Runtime Security or Cloud Posture Management add-ons.

### 9.2. Cortex Cloud AI Security

#### 9.2.1. What is Cortex Cloud AI Security?

#### 9.2.2. Supported services in Cortex Cloud AI Security

#### 9.2.3. Cortex Cloud AI Security concepts

#### 9.2.4. Cortex Cloud AI Security use cases

#### 9.2.5. How to perform advanced AI Security investigations using XQL

##### Note

* For more information, see Build XQL queries.Build XQL queries

### 9.3. Cortex Cloud Application Security

#### 9.3.1. Application Security Posture Management (ASPM)

##### 9.3.1.1. ASPM use cases

##### 9.3.1.2. ASPM key features

##### 9.3.1.3. ASPM user roles and permissions

###### Navigation

  You can view AppSec Admin permissions in the tenant by navigating to Settings → Configurations → Roles → AppSec Admin

##### 9.3.1.4. ASPM Command Center

###### 9.3.1.4.1. ASPM Command Center workflow

####### Note

* Breakdown by type: Issues are further broken down by type (such as IAC or Secrets).

##### 9.3.1.5. Coverage

###### 9.3.1.5.1. Coverage in the user interface

####### Navigation

  Modules, → Application Security → AppSec Coverage

##### 9.3.1.6. Backlog baseline

###### 9.3.1.6.1. Backlog use cases

###### 9.3.1.6.2. Issue/Finding classification by scanner

####### Note

* In some cases/vendors, this is not accurate as findings are deleted every time new findings are uploaded. In such cases, the feature may not be accurate or supported For SAST, the vendor does not support policy in pull requests

* Scanner updates and new detections: When a security scanner is updated to support new languages, detection rules, or capabilities, any issues discovered by these new features for existing code are classified as part of the backlog.

###### 9.3.1.6.3. Using Backlog

##### 9.3.1.7. Applications

###### 9.3.1.7.1. How to build an application

####### Prerequisite

* Before you begin, ensure you have connected the necessary data sources. Refer to Onboard data sources for more information.

####### Note

* These filters are represented by icons displayed on the Code pane after selecting a VCS.

* To edit application assets, click the Clear All icon before clicking Finish. This clears all application data, allowing you to restart the application building process from the beginning.

###### 9.3.1.7.2. Application management and visibility

###### 9.3.1.7.3. Business application assets

####### 9.3.1.7.3.1. Business application expanded asset details

######## Note

* The topology graph is available only when all application components (code, pipeline, build and deploy), are configured.

##### 9.3.1.8. Repositories as assets

###### 9.3.1.8.1. Explore repository assets

###### 9.3.1.8.2. In-depth repository asset information

###### 9.3.1.8.3. Manage Repository assets

###### 9.3.1.8.4. Export Software Bill of Materials (SBOM)

###### 9.3.1.8.5. Manage issues detected in repositories

####### Note

* You can also find the repository issues in the general issue inventory table, and in the dedicated inventory of issues for each scanner type (see step 4 above for details).

##### 9.3.1.9. Onboard data sources

###### 9.3.1.9.1. Onboard version control systems

####### Note

* Application Security (which includes IaC and Secrets scanning), is an add-on to a license (such as Posture Security) that must be purchased separately.

* Disclaimer: When onboarding with third-party data sources, we outline the required steps for setup, but we do not monitor these external resources, and they may change over time. Always refer to the relevant third-party documentation for the most current integration steps.

####### Tip

* Navigate to Settings → Data Sources (under Data Collections) → + Data Source → enter your VCS data source in the search bar.

####### 9.3.1.9.1.1. AWS CodeCommit

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your AWS CodeCommit instances with the following permissions:       Read more...        codecommit:GitPull: Allows users to pull Git repository changes   codecommit:ListBranches: Grants the ability to list branches within a repository   codecommit:GetBranch: Required to get...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* The Resource Name Prefix and ExternalID fields are pre-populated. You can modify the Resource Name Prefix, but DO NOT change the ExternalID!

* To create an additional AWS CodeCommit instance: Hover over the AWS CodeCommit card in the catalog and click Connect Another.

####### 9.3.1.9.1.2. Azure Repos

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your Azure Repos instances with the following permissions and scopes.      Permission   Description       Project Administrator   This permission is required to subscribe to webhooks. For more information, refer to the Microsoft Integrate with service...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* For information on Application Security access to all organizations associated with your user token, refer to the Azure Third party application access via OAuth documentation.

* To create an additional Azure Repos instance: Hover over the Azure Repos card in the catalog and click Connect Another.

######## Caution

* Do not limit authorization scope.

####### 9.3.1.9.1.3. Bitbucket Cloud

######## Prerequisite

* Before you begin: Authorize the user with the following required permissions and scopes to integrate Application Security with your Bitbucket Cloud instances.  Note For write access, go to Bitbucket > Repository Settings and grant the user write access to the relevant repositories.     Permissions    Repository Administrator: To scan pull requests...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Cloud instance: Hover over the Bitbucket Cloud card in the catalog and click Connect Another.

####### 9.3.1.9.1.4. Bitbucket Data Center

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your Bitbucket Data Center instances with the following permissions:    Member of Project Collection Administrators: Required to subscribe to the build.complete event and download the permissions report for CI/CD scans. As Organization owners are automatically part of this...

######## Note

* By default, the permissions of the access token are set according to your current access level. It is essential to define two levels of permissions, Project and Repository permissions. The Repository permissions inherit from Project permissions, requiring Repository permissions to match or exceed Project permissions Providing read and write permissions...

* For additional security, it is recommended to set an expiry automatically. The expiry date of a token cannot be changed after it is created. You can see the expiry dates for all your tokens on Profile picture → Manage account → Personal access tokens.

* Select Connect Another Instance if an instance has already been configured.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Data Center instance: Hover over the Bitbucket Data Center card in the catalog and click Connect Another.

######## Important

* Always refer to the Bitbucket documentation for information relating to creating a PAT.

####### 9.3.1.9.1.5. GitHub Cloud

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your GitHub SaaS instances with the following permissions:    Read  access to Dependabot alerts, actions, actions variables, administration, deployments, discussions, metadata, packages, repository hooks, secret scanning alerts, secrets, and security events   Read and write...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* To create an additional GitHub SaaS instance: Hover over the GitHub SaaS card in the catalog and click Connect Another.

####### 9.3.1.9.1.6. GitHub Server

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your GitHub Server instances with the following permissions and scopes:    Permissions    Organization owner permissions   Administrator repository permissions: In order to scan pull requests (PRs), the user performing the integration must have administrative privileges for the...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* The domain is the hostname associated with your GitHub Server instance.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitHub Server instance: Hover over the GitHub Server card in the catalog and click Connect Another.

####### 9.3.1.9.1.7. GitLab SaaS

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your GitLab SaaS instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including all groups...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* A repository can only be integrated with a single instance. The first instance that connects with the repository will be the one that the repository is assigned to. This means that if multiple integrations attempt to connect to the same repository, only the first integration to establish the connection will be associated with that repository.

* To create an additional GitLab SaaS instance: Hover over the GitLab SaaS card and click in the catalog and Connect Another.

####### 9.3.1.9.1.8. GitLab self-managed

######## Prerequisite

* Authorize the user integrating Application Security with your GitLab self-managed instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including all groups and...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* The domain is the hostname associated with your GitLab self-managed instance.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitLab self-managed instance: Hover over the GitLab self-managed card in the catalog and click Connect Another.

###### 9.3.1.9.2. Onboard CI/CD systems

####### 9.3.1.9.2.1. Onboard CircleCI for CI/CD pipeline scans

######## Prerequisite

* Before you begin: User requirements:    Permissions: To enable Cortex XSIAM visibility for all CircleCI projects, a version control system (VCS) user with integration permissions must be authorized. This is because CircleCI's user base integrates with the VCS, inheriting its user permissions. For example, if a GitHub user has access to specific...

######## Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for code scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* To add an additional CircleCI instance, navigate to Settings → Data Sources → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

####### 9.3.1.9.2.2. Onboard Jenkins for CI/CD pipeline scans

######## Prerequisite

* Permissions Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

######## Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for code scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* The integration is added on the console but integration is pending, and will only be completed after completing step 5 below. You can view the pending integration on the Jenkins Instances page: Select Data Sources →  Jenkins → View Details. The type of integration is Pipeline Risks

* Always refer to the official Jenkins documentation when installing plugins on Jenkins servers.

* To add an additional Jenkins instance, navigate to Settings → Data Sources → select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps above.

###### 9.3.1.9.3. Integrate CI tools

####### Note

* For CircleCI CI/CD pipeline scans, refer to CI/CD .

* For Jenkins CI/CD pipeline scans, refer to CI/CD .

####### Navigation

  Settings → Data Sources → hover over a CI tool and click View Details

  Delete an instance: Right-click on an instance of the CI tool → Delete instance → Delete

####### 9.3.1.9.3.1. AWS CodeBuild

######## Prerequisite

* Before you begin: Grant Administrator  permissions to the user integrating AWS CodeBuild with Application Security Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional AWS CodeBuild instance, navigate to Settings → Data Sources → select the menu for your connected AWS CodeBuild instance → + New Instance, and repeat the onboarding steps above.

####### 9.3.1.9.3.2. Onboard CircleCI for code scans

######## Prerequisite

* Before you begin: Grant Administrator permissions to the user integrating Application Security with CircleCI Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

######## Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for CI/CD scans, refer to...

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* To add an additional CircleCI instance, navigate to Settings → Data Sources → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

######## Important

* The cortex-secrets naming convention for the context is mandatory to ensure functionality and must not be changed.

####### 9.3.1.9.3.3. Connect Cortex CLI

######## Prerequisite

* Permissions: Grant the user installing the CLI required permissions. For more information refer to OverviewOverview Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress...

######## Note

* You can view the latest version of the selected OS.

* Recommended: Select With upload results permissions before generating the API key. This option grants the key permission to not only access data but also to upload or send data back. In the API Keys page, the role associated with these permissions is CLI. If you choose to upload without results permissions, the associated role is CLI Read Only Warning:...

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

######## Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter 'CLI' in the search bar to locate the Cortex CLI tool.

####### 9.3.1.9.3.4. GitHub Actions

######## Prerequisite

* Before you begin: Grant Administrator  permissions to the user integrating GitHub Actions with Application Security Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional GitHub Actions instance, navigate to Settings → Data Sources → select the menu for your connected GitHub Actions instance → + New Instance, and repeat the onboarding steps above.

####### 9.3.1.9.3.5. Onboard Jenkins for code scans

######## Prerequisite

* Grant Administrator permissions to the user integrating Application Security with Jenkins Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

* For Application Security CI tools, you must store secrets in Jenkins Credentials for use in your Jenkins pipelines using either of these methods:    Plain text storage: Store secrets directly as plain text in Jenkins Credentials. Access them in your pipeline using the credentials function, which retrieves the secret directly as plain text   Credentials...

######## Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for CI/CD scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* This step is only required for new pipelines For private repositories, ensure the necessary credentials are configured in Jenkins Credentials

* This ensures your build runs within a Docker environment. If a node without Docker is used, the build will fail.

* To add an additional Jenkins instance, navigate to Settings → Data Sources →  select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps.

####### 9.3.1.9.3.6. Onboard Terraform Cloud (Run Tasks)

######## Prerequisite

* Before you begin: Procure a Terraform cloud license that is either a trial license or a TF Cloud license at the TEAM & GOVERNANCE level Grant the user or team the following permissions, depending on integration:    Manage Workspaces permissions at the organization level. These permissions are required to attach and manage the run task on workspaces...

######## Note

* * Application Security performs Image Referencer scans for container image vulnerabilities, as full SCA scans are not supported for Terraform Enterprise (Run Tasks).

* Skip this step if you plan on using an existing token.

* Select Connect Another Instance if an instance has already been configured.

* Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Cloud (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected your Terraform Cloud (Run Tasks) instance → + New Instance, and repeat the onboarding steps.

####### 9.3.1.9.3.7. Onboard Terraform Enterprise (Run Tasks)

######## Prerequisite

* Before you begin: Ensure access to a Terraform Enterprise console to enable you to provide a user or team token that authorizes Application Security to access workspaces and helps regulate run configurations Terraform Enterprise version compatibility: Ensure Run Tasks for workspaces on is compatible with version 1.1.9 and above Terraform Enterprise...

######## Note

* * For container image vulnerabilities, Application Security performs 'Image Referencer' scans within Terraform Enterprise (Run Tasks), as full SCA scans are not currently supported.

* Skip this step if you plan on using an existing token.

* Select Connect Another Instance if an instance has already been configured.

* Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Enterprise (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected Terraform Enterprise (Run Tasks) instance → + New Instance, and repeat the onboarding steps above.

###### 9.3.1.9.4. CLI pipeline code snippets

###### 9.3.1.9.5. Ingest third-party data

####### Note

* Only onboarded and scanned repositories can be mapped.

####### 9.3.1.9.5.1. Ingest Veracode SAST data

######## Prerequisite

* Permissions: The following user permissions are required:    Cortex Cloud: Instance Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions   Veracode: At minimum, Reviewer permissions are required Permissions: The following user permissions are required: Cortex...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between Veracode projects and Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped applications are ingested

####### 9.3.1.9.5.2. Ingest SonarQube SAST data

######## Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Generate and copy a SonarQube API token. Ensure to assign Web API scope to the API token. Refer...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between SonarQube Applications and Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

####### 9.3.1.9.5.3. Ingest Semgrep data

######## Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Create a Semgrep API token  Note To create a Semgrep API token, in Semgrep, navigate to Settings...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between Semgrep Projects Applications and Cortex XSIAM code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

####### 9.3.1.9.5.4. Generic 3rd Party AppSec Collector

######## Important

* File uploads are limited to a maximum size of 10 MB.

######## 9.3.1.9.5.4.1. Onboard the 3rd Party AppSec Collector

###### 9.3.1.9.6. Manage data source integrations

####### Navigation

  Settings → Data Sources → use the search bar to locate the required data source

##### 9.3.1.10. Transporter over Broker VM

###### Prerequisite

* Ensure you have the necessary permissions and have already set up your Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex XSIAM resources. The IP addresses for the Transporter are in the Broker VM Resources section of the Enable access to required PANW resources document Open port 4052 (inbound), which...

###### Note

* The broker enables multiple connections, allowing a single Transporter applet to connect to various VCS instances Multiple Transporter applets cannot be created on a single Broker VM. Each Broker VM is limited to a single Transporter applet instance

###### Warning

* The Transporter applet is not supported for FedRAMP customers.

###### 9.3.1.10.1. Setup a Transporter applet on Broker VM

####### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator)

####### Note

* You cannot add a Transporter applet through Clusters.

####### Navigation

  your AppSec Transporter under the App column → Configure → Add Connection (on the redirected AppSec Transporter setup page

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

###### 9.3.1.10.2. Setup a Transporter on your VCS

####### Prerequisite

* Ensure you have user permissions to onboard data sources  Note The dedicated AppSec Admin role includes the required permissions. Ensure you have user permissions to onboard data sources Before you begin you must setup a Transporter applet on your Broker VM. Refer to Setup a Transporter applet on Broker VM for more information

####### Note

* GitLab Enterprise webhook internal IP restriction: GitLab Enterprise's security policies prevent webhook subscriptions to internal IP addresses (such as broker addresses). These subscriptions can only be enabled through specific instance configuration. For more information, refer to https://docs.gitlab.com/security/webhooks/.

####### Navigation

  Settings → Data Sources → + Add Data Source → select your VCS on-premises data source

##### 9.3.1.11. Manage 3rd party findings and generated issues

##### 9.3.1.12. Manage code weaknesses

###### Note

* You can customize policies to define which findings are categorized as issues.

###### Tip

* You can also view SAST CWE issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Code Weaknesses tab under the Repositories asset inventory. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset...

###### Navigation

  To access SAST code violation issues, under Modules, select Application Security → Issues → Code Weaknesses

###### 9.3.1.12.1. Code weaknesses issue inventory

###### 9.3.1.12.2. Expanded code weaknesses issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 9.3.1.12.3. SAST code weakness findings

####### Note

* Findings on the Cortex XSIAM platform are not intended for direct action; but rather represent data collected by the platform. They must be promoted to issues to enable mitigation efforts to secure your codebase.

#### 9.3.2. CI/CD Security

##### 9.3.2.1. CI/CD Security user roles and permissions

##### 9.3.2.2. CI/CD Assets

###### 9.3.2.2.1. CI/CD Instances as assets

####### 9.3.2.2.1.1. Explore CI/CD Instance assets

######## Navigation

  To access CI/CD pipeline instances, under Inventory, select All Assets → Code → Category → CI/CD Instances

####### 9.3.2.2.1.2. In-depth CI/CD pipeline instance asset information

####### 9.3.2.2.1.3. Manage CI/CD pipeline instances

###### 9.3.2.2.2. CI/CD Pipelines as assets

####### 9.3.2.2.2.1. Explore CI/CD Pipeline assets

######## Navigation

  To access CI/CD pipelines assets, under Inventory, select All Assets → Code → CI/CD Pipelines

####### 9.3.2.2.2.2. In-depth CI/CD pipeline asset information

######## Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

####### 9.3.2.2.2.3. Manage CI/CD pipeline assets

###### 9.3.2.2.3. Version Control System (VCS) Organizations as assets

####### 9.3.2.2.3.1. Explore VCS Organization assets

######## Navigation

  To access VCS Organization assets, under Inventory, select All Assets → Code → VCS Organizations

####### 9.3.2.2.3.2. In-depth VCS Organization asset information

######## Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

####### 9.3.2.2.3.3. Manage VCS organization assets

###### 9.3.2.2.4. VCS Collaborators-as-assets

####### 9.3.2.2.4.1. In-depth Collaborator asset information

####### 9.3.2.2.4.2. Manage Collaborator assets

##### 9.3.2.3. Supply Chain tools

###### Note

* Rejected does not mean the tool is not in use. It allows application security practitioners to search for and remove these tools as needed For information about changing the tool status, refer to Overview

###### 9.3.2.3.1. Supply Chain use cases

####### Navigation

  To access Supply Chain Tools, select Modules → Application Security → Supply Chain Tools (under 3rd Party Tools

###### 9.3.2.3.2. Explore Supply Chain tools

###### 9.3.2.3.3. Expanded Supply Chain tool information

####### Note

* AppSec Admin user permissions are required to perform these actions.

##### 9.3.2.4. CI/CD Risks

###### Note

* Application Security CI/CD pipeline scans create a comprehensive inventory of all CI/CD pipelines in your environment. For more information refer to CI/CD Pipelines as assets.

###### 9.3.2.4.1. CI/CD pipeline issues

####### Navigation

  To access CI/CD pipeline risks issues, under Modules, select Application Security → Issues → CI/CD Risks

###### 9.3.2.4.2. Expanded CI/CD risks issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 9.3.2.4.3. VCS and CI/CD pipeline risk findings

##### 9.3.2.5. CI/CD Rules

###### Note

* Out-of-the-box rules cannot be modified Custom CI/CD rules are not supported

###### 9.3.2.5.1. CI/CD rules roles and permissions

###### 9.3.2.5.2. CI/CD rules inventory

####### Navigation

  In the Filter panel, select Category → Scanner → CI/CD Security

###### 9.3.2.5.3. Create custom CI/CD rules

####### Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

###### 9.3.2.5.4. Manage CI/CD rules

##### 9.3.2.6. CI/CD Policies

###### 9.3.2.6.1. CI/CD policies user roles and permissions

###### 9.3.2.6.2. CI/CD policies inventory

###### 9.3.2.6.3. Create custom CI/CD policies

####### Note

* PR Scan and CI Scan triggers are automatically disabled and unchecked. They can only be enabled if other scan types (that is non-CI/CD risk scans such as Secrets) are also selected, and will only run on non-CI/CD risks types of scans

* You can combine multiple conditions to create complex rules for when the policy should apply. Create conditions that apply to a CI/CD policy which detects high severity CI/CD risks on GitHub: Select Add Filter → Finding Type → CI/CD Risks → AND → Provider → [VCS/CI/CD system] → AND → Severity: → High.

* SBAC scope limitations do not apply to Matching Criteria For CI/CD policies, you can filter Matching Criteria by VCS Organization Name, CI/CD Pipeline [Name/ID], CI/CD Instance [Name/ID] or Collaborator [Name/Email/MFA Enabled/Last Observed]

###### 9.3.2.6.4. Manage CI/CD policies

####### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

##### 9.3.2.7. CI/CD Compliance

###### Navigation

  To access Compliance, select Posture Management → Compliance → Reports or Assessment

###### 9.3.2.7.1. Create CI/CD compliance reports

####### Note

* The CI/CD module supports GitHub and GitLab providers.

* For more information about about Asset Groups, refer to Asset Groups.

* CIS GitLab Benchmark, CIS GitHub Benchmark, and the OWASP Top 10 CI/CD Risks standards are supported.

* For more information about assessment profiles, refer to Use an assessment profile to run compliance checks on your assets.Use an assessment profile to run compliance checks on your assets

####### Navigation

  Posture Management → Compliance → Assessment or Reports

#### 9.3.3. Code Security

##### 9.3.3.1. Code Security user roles and permissions

##### 9.3.3.2. Code Security assets

##### 9.3.3.3. Software packages as assets

###### 9.3.3.3.1. In-depth software package asset information

##### 9.3.3.4. Infrastructure-as-Code (IaC) resources as assets

###### 9.3.3.4.1. Explore IaC assets

####### Navigation

  To access IaC assets, under Inventory, select All Assets → Code → IaC Resources

###### 9.3.3.4.2. In-depth IaC resource asset information

##### 9.3.3.5. Code Security scanners

##### 9.3.3.6. Software Composition Analysis (SCA ) scanners

###### 9.3.3.6.1. Supported Software Composition Analysis (SCA) frameworks and languages

###### 9.3.3.6.2. Software Composition Analysis (SCA) CVE vulnerability issues

####### Tip

* You can also view SCA vulnerabilities in dedicated tabs under other sections when available: In Asset inventories, navigate to Inventory → All Assets → Code:    On the Vulnerabilities tab under Repositories. Refer to In-depth repository asset information for more information Under the All Code inventory: Select an asset from the table →...

####### Navigation

  To access CVE vulnerability issues, under Modules, select Application Security → Issues → Vulnerabilities

####### 9.3.3.6.2.1. SCA CVE vulnerabilities inventory

####### 9.3.3.6.2.2. Expanded CVE vulnerabilities issue information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 9.3.3.6.2.3. CVE vulnerabilities findings

######## Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

######## Navigation

  To access CVE findings, under Modules, select Application Security → Issues → Vulnerabilities → click the Findings tab

####### 9.3.3.6.2.4. Manage SCA CVE vulnerability issues

###### 9.3.3.6.3. License miscompliance issues

####### Tip

* You can also view license miscompliance issues in dedicated tabs under other sections when available: In Application asset inventories: navigate to Inventory → All Assets →  Application → select an option from the Application menu → select an item from the inventory → Package Integrity In Asset inventories, navigate to Inventory → All...

####### Navigation

  To access license miscompliance issues, under Modules, select Application Security → Issues → Licenses

####### 9.3.3.6.3.1. License miscompliance issues inventory

####### 9.3.3.6.3.2. Expanded License miscompliance issues information

####### 9.3.3.6.3.3. License miscompliance findings

######## Navigation

  To access license miscompliance findings, under Modules, select Application Security → Issues → Licenses → click the Findings tab

####### 9.3.3.6.3.4. Open-source software license categories

####### 9.3.3.6.3.5. Manage license miscompliance issues

###### 9.3.3.6.4. Package Integrity

####### 9.3.3.6.4.1. Package Integrity issues inventory

######## Navigation

  Modules → Application Security → Package Integrity (under Issues

####### 9.3.3.6.4.2. Expanded Package Integrity issues inventory information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 9.3.3.6.4.3. Package Integrity findings

######## Note

* Findings cannot be mitigated. They must be promoted to issues to enable remediation efforts to secure your software packages.

######## Navigation

  navigate to Modules → Application Security → Package Integrity (under Issues) → click the Findings tab

####### 9.3.3.6.4.4. Manage Package Integrity issues

##### 9.3.3.7. Secrets scanners

###### 9.3.3.7.1. Secrets issues

####### Tip

* You can also view Secrets issues in dedicated tabs under other sections when available: In Code asset inventories: navigate to Inventory → All Assets → Code:    On the Secrets tab under Repositories. Refer to In-depth repository asset informationfor more information   Under the All Code inventory: Select an asset from the table → Secrets In Code...

####### Navigation

  Under Modules, select Application Security → Issues → Secrets

###### 9.3.3.7.2. Secrets issues inventory

###### 9.3.3.7.3. Expanded Secrets issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 9.3.3.7.4. Secrets findings

####### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

####### Navigation

  To access Secrets findings, select Application Security → Issues → Secrets → click the Findings tab

###### 9.3.3.7.5. Manage Secrets issues

##### 9.3.3.8. Infrastructure as Code (IaC) scanners

###### 9.3.3.8.1. Supported frameworks and languages

###### 9.3.3.8.2. IaC misconfiguration issues

####### Tip

* You can also view IaC misconfiguration issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Configuration tab under Repository assets. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from...

####### Navigation

  To access IaC misconfiguration issues, under Modules, select Application Security → Issues → IaC misconfiguration

###### 9.3.3.8.3. IaC misconfiguration issues inventory

###### 9.3.3.8.4. Expanded IaC misconfiguration issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 9.3.3.8.5. IaC misconfiguration findings

####### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

####### Navigation

  To access IaC misconfiguration findings, under Modules, select Application Security → Issues → IaC Misconfigurations → click the Findings tab

###### 9.3.3.8.6. Manage IaC misconfiguration issues

##### 9.3.3.9. Application Security scans management

###### 9.3.3.9.1. How to access Application Security scan management

####### Note

* While scans provide a comprehensive inventory of all issues detected during a scan, dedicated inventories are also maintained for specific scan types for more granular management. For more information, refer to Infrastructure as Code (IaC) scanners, Secrets scanners and Software Composition Analysis (SCA ) scanners.

###### 9.3.3.9.2. Branch periodic scans

####### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

###### 9.3.3.9.3. Pull Request scans

####### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

###### 9.3.3.9.4. CI scans

####### Note

* The inventory table displays scan issues for visibility only; remediation is not available in scan management. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

###### 9.3.3.9.5. Manage repository scan configurations

####### Note

* For Secrets scans you configure these additional settings: Git history scan: scans Git history to detect secrets deleted from files but still present in past commits, notifying you of these exposures. This helps mitigate the risk of compromised credentials that may be found in the repository's history Secret validation: validates detected secrets...

####### Navigation

  Settings → Data Sources → hover over a connected data source from the catalog → click View Details

###### 9.3.3.9.6. Monitor data source instances health

##### 9.3.3.10. Application Security Policies

###### 9.3.3.10.1. User roles and permissions

###### 9.3.3.10.2. Create Application Security policies

####### Note

* Add additional condition attributes for a single finding type by using the OR operator When selecting multiple finding types, only filters common to all types are available

* If you select the Applications asset type, the policy evaluates all repositories for matching applications SBAC scope limitations do not apply to Asset Types

####### 9.3.3.10.2.1. Application Security policy condition attributes

######## Note

* The Severity, AppSec Rule, AppSec Rule Label and Backlog Status attributes are not dependent on the Finding Type attribute For more information about Backlog Status, refer to Backlog baseline

* For CI/CD Risks as the finding type, refer to CI/CD policies user roles and permissions.

###### 9.3.3.10.3. Manage Application Security policies

####### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

##### 9.3.3.11. Application Security Rules

###### Note

* Out-of-the-box rules cannot be modified directly. However, you can create a custom rule by cloning the existing one. This allows you to make changes to the original rule according to your requirements. Refer to Manage Application Security custom rules for more information.

###### 9.3.3.11.1. Roles and permissions

###### 9.3.3.11.2. Rules inventory

####### Navigation

  To filter rules relating to Secrets, select filter icon → Scanner (from the Select field) → Secrets (from the Value field

###### 9.3.3.11.3. Create custom Application Security rules

####### Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

###### 9.3.3.11.4. Manage Application Security custom rules

###### 9.3.3.11.5. Configure YAML file properties

##### 9.3.3.12. Application Security CLI

###### Prerequisite

* For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

###### Note

* For detailed information about the Cortex XSIAM CLI, refer to Cortex CLI.

###### 9.3.3.12.1. Connect Cortex CLI

####### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

####### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Application Security, refer to Cortex CLI usage for Application Security

####### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

###### 9.3.3.12.2. Cortex CLI usage for Application Security

###### 9.3.3.12.3. Cortex CLI Application Security command line reference

####### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

####### Important

* The Cortex CLI Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id <YOUR_AUTH_ID>...

###### 9.3.3.12.4. Cortex CLI common command line reference guide

####### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

##### 9.3.3.13. IDE

###### Note

* Not all remediation options are available for all findings or all type of scan category.

###### 9.3.3.13.1. System requirements

###### 9.3.3.13.2. Visual Studio (VS) Code

####### Prerequisite

* Before you begin: Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

####### Note

* Enforcement rules and CA certificates are not applicable to the open-source project.

####### Navigation

  Install through VS Code IDE: Access the Activity bar → select Extensions → Cortex Cloud → Install

####### 9.3.3.13.2.1. How to use the Cortex Cloud extension in VS Code

######## Note

* Not all remediation options are available for all issues.

* The suppression is scoped to the file.

###### 9.3.3.13.3. JetBrains

####### Prerequisite

* Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install Node.js version 22 and...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

####### Note

* The Cortex AppSec code security plugin supports all JetBrains products.

####### Navigation

  Settings → Plugins → select the Marketplace tab → search for Prisma Cloud → Install → OK

  Settings → Tools → Cortex Cloud

####### 9.3.3.13.3.1. How to use the JetBrains Cortex XSIAM extension

######## Note

* After selecting Fix Available, the number of issues displayed in the issue categories (such as IaC) reflect the number of fixable issues for that type.

* The corresponding file simultaneously opens in the Code editor, highlighting the issue within its exact code context. See below for more information.

* Not all types of remediation are available for all issue categories. For example, fixes are not available for License issues.

* Secrets and Licenses category issues are typically mitigated by following the guidance in the Documentation.

#### 9.3.4. API documentation

### 9.4. Attack Surface Management

#### 9.4.1. Get started with Attack Surface Management

##### License Type

  Requires the ASM add-on.

##### 9.4.1.1. What is Attack Surface Management?

###### 9.4.1.1.1. Attack Surface Management use cases

##### 9.4.1.2. Network mapping

##### 9.4.1.3. Scanning

###### 9.4.1.3.1. Scanning cadences

###### 9.4.1.3.2. Known Assets Monitoring

###### 9.4.1.3.3. Scanning ports and protocols

####### Note

* The following lists are not exhaustive. For current and complete lists, contact your customer success team.

##### 9.4.1.4. GeoIP data collection

#### 9.4.2. Attack Surface Management detections

##### 9.4.2.1. Attack surface rules

###### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

##### 9.4.2.2. Attack Surface Testing

###### Note

* Requires the ASM add-on.

* Attack surface testing scans are typically not CFAA compliant, meaning that they may attempt more extensive fuzzing to confirm or deny the presence of a CVE. Additionally, some attack surface tests are more intrusive than others. Tests are labeled with the level of intrusivity, so you can decide whether to run more intrusive tests.

###### 9.4.2.2.1. Set up Attack Surface Testing

####### Navigation

  Settings → Configurations → Access Management → Roles, and select the role

  Modules → Attack Surface → Policies → Attack Surface Tests

  Settings → Configurations → Attack Surface → Attack Surface Testing

##### 9.4.2.3. Externally inferred CVEs

###### Note

* An externally inferred CVE might impact your service or asset, but additional investigation is required to confirm that the CVE is actually present.

##### 9.4.2.4. Digital Risk Protection

###### Note

* Both of these attack surface rules are based on the attributed domain assets that appear in the asset inventory. If there are no attributed domains in your inventory, Cortex XSIAM will not generate Digital Risk Protection findings and issues.

###### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

#### 9.4.3. Attack surface assets

##### Navigation

  The internet-facing assets that were discovered in a attack surface management (ASM) scan and attributed to your organization are available in the inventory on the Inventory → Assets → All Assets → External Surface pages

  Inventory → Assets → Network Configuration → IP Address Ranges → External IP Address Ranges

##### 9.4.3.1. Upload or remove ASM assets

###### Note

* You must have the Instance Administrator role to upload or remove assets.

###### 9.4.3.1.1. Upload assets

####### Note

* If an asset upload request has an invalid CSV or includes one or more invalid assets, the entire request will fail, and none of the assets will be uploaded. If this happens, Cortex XSIAM will display an error message indicating what caused the error, so you can fix the problem and resubmit if you choose.

####### Navigation

  Settings → Configurations → Asset Management → Asset Uploads/Removals

###### 9.4.3.1.2. Remove assets

####### Note

* If an asset removal request has an incorrectly formatted CSV or includes one or more invalid assets, the entire request will fail, and none of the assets will be removed. If this happens, Cortex XSIAM will display an error message indicating what caused the error, so you can fix the problem and resubmit if you choose.

####### Navigation

  Settings → Configurations → Asset Management → Asset Uploads/Removals

#### 9.4.4. Deploy ASM and Exposure Management enrichment and remediation automation

##### Note

* For details and requirements regarding the enrichment information that can be collected and the specific issues that can be remediated automatically, review the Exposure Management Content Pack information in Marketplace.

* Cortex Exposure Management playbooks only run on issues that were created after the automation rules have been configured.

##### Navigation

  Investigation & Response → Automation → Automation Rules

  Settings → Configurations → Data Collection → Automation & Feed Integrations

#### 9.4.5. ASM enrichment of cloud assets

##### Navigation

  Inventory → Assets → All Assets → External Surface → Services

#### 9.4.6. Emerging Vulnerabilities

##### License Type

  Requires the ASM add-on

##### Note

* You must have a role with Attack Surface Rules permission to access the Emerging Vulnerabilities page. When setting up Roles Based Access Control (RBAC), you can find Attack Surface Rules in the Detection & Threat Intel component.

##### Navigation

  Posture Management → Vulnerability Management → Emerging Vulnerabilities

#### 9.4.7. Global Lookup

##### Navigation

  Modules → Attack Surface → Global Lookup

### 9.5. Cloud Workload Policies and Rules

#### Prerequisite

* Users need View/Edit RBAC permissions (under Policies → Compute Policies) or the Instance Administrator role to view, edit, and modify Cloud Workload Policies.

#### 9.5.1. How policies and rules work together

#### 9.5.2. Cloud Workload Policies

##### 9.5.2.1. Types of Cloud Workload Policies

##### 9.5.2.2. Cloud Workload Policies page

###### Note

* Keep the following caveats in my mind when working with Policies: Instance Administrators are able to view all facets of Policies without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be...

###### 9.5.2.2.1. Widgets panel

####### 9.5.2.2.1.1. Show or hide the widget panel

######## Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 9.5.2.2.2. Filter page results

###### 9.5.2.2.3. Change the layout of the policies table

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 9.5.2.2.4. Policy Details Panel

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.5.2.3. Enable or disable a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.5.2.4. Create a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.5.2.5. Use an existing policy to create a new Cloud Workload policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.5.2.6. Edit a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.5.2.7. Delete a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

#### 9.5.3. Cloud Workload Rules

##### 9.5.3.1. Default (pre-defined) Rules

##### 9.5.3.2. Custom (user-defined) Rules

##### 9.5.3.3. Cloud Workload Rules page

###### Note

* Keep the following caveats in my mind when working with Rules: Instance Administrators are able to view all facets of Rules without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be able...

###### 9.5.3.3.1. Filter page results

###### 9.5.3.3.2. Change the layout of the rules table

###### 9.5.3.3.3. Rule details panel

##### 9.5.3.4. Create a new Custom Detection Rule

###### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

###### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

##### 9.5.3.5. Use an existing rule to create a new Custom Detection Rule

###### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

##### 9.5.3.6. Edit a Custom Detection Rule

###### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

##### 9.5.3.7. Delete a Custom Detection Rule

###### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

### 9.6. Cortex Cloud Data Classification

#### 9.6.1. What is Cortex Cloud Data Classification?

#### 9.6.2. How to create and validate a custom data pattern

##### Note

* Once a custom data pattern is saved, it runs on all data in the same way as any out-of-the-box (OOTB) pattern, becoming globally applicable for all modules using Cortex Cloud Data Classification.

* For more information, see How to disable and enable data patterns in Data Classification.

#### 9.6.3. How to disable and enable data patterns in Data Classification

##### Note

* Disabling data patterns can cause changes in your data profile results and stop detection of these data patterns.

* For more information about data patterns in data classification, see What is Cortex Cloud Data Classification?.

##### Navigation

  In Cortex Command Center, click Settings → Configurations → Data Classification → Data Patterns

#### 9.6.4. How to create and validate a custom data profile

##### Note

* If you choose two data locations, only the filters they have in common will be included in the possible filter options.

* For more information, see How to disable and enable data profiles in Cortex Cloud Data Classification.

##### Important

* Deleting a data profile deletes all past data associated with it in all modules using Cortex Cloud Data Classification after a warning notification is displayed.

* Enabling and disabling a data profile removes or re-adds the data profile results to the data objects; that is, files and tables.

#### 9.6.5. How to disable and enable data profiles in Cortex Cloud Data Classification

##### Note

* Existing results on past scans are updated in the Asset and Object inventories within two hours after being disabled or enabled.

* For more information about data profiles in Cortex Cloud Data Classification, see What is Cortex Cloud Data Classification?.

##### Navigation

  In Cortex XSIAM Security Command Center, click Settings → Configurations → Data Classification → Data Profiles

### 9.7. Cortex Cloud Data Security

#### 9.7.1. What is Cortex Cloud Data Security?

#### 9.7.2. Supported assets in Cortex Cloud Data Security

##### Note

* The list above refers to only data classification; however, Cortex Cloud Data Security discovers and monitors all cloud assets and services for usage and misconfigurations.

* For information about configuring data classification asset types, see How to configure the scanning settings for supported services.

#### 9.7.3. Cortex Cloud Data Security concepts

#### 9.7.4. Cortex Cloud Data Security use cases

#### 9.7.5. Data Inventory

##### Note

* To clear the filters in the filter panel, click Delete.

##### Navigation

  When you select Inventory → All Assets → Data → All Data, a list of all data assets appears

#### 9.7.6. How to review errors in Cortex Cloud Data Security

#### 9.7.7. How to configure the scanning settings for supported services

##### Note

* All the asset types are selected by default. When you deselect a data asset type, it is not included when the system runs the next scan operation, reducing the total scan time.

#### 9.7.8. How to perform advanced Data Security investigations using XQL

##### Note

* For more information, see Build XQL queries.Build XQL queries

#### 9.7.9. How to onboard Snowflake (Posture)

##### Prerequisite

* In order to use Snowflake (Posture), you must be registered with one of these cloud providers: Amazon AWS, Microsoft Azure, or Google Cloud Platform (GCP). Ensure you have the necessary account permissions to onboard. It is recommended to use account admin as the role for the onboarding.

##### Note

* The account identifier can be found using the user information at the bottom left. Hover over the account you wish to onboard and select the copy option at the top right. The account identifier is usually of the format: (organization).[account]

#### 9.7.10. How to onboard Microsoft 365 (Posture)

##### Prerequisite

* You have generated a Globally Unique Identifier (GUID), also known as a Universally Unique Identifier (UUID). You will need this ID for the tenant you want to use for the Microsoft 365 (Posture) instance. In order to use Microsoft 365 (Posture), you must be registered with Microsoft Azure.

#### 9.7.11. How to use information protection labels in Cortex Cloud Data Security

##### Note

* Only If you have connected a Microsoft 365 instance to Cortex Cloud, the information protection labels appear. See How to onboard Microsoft 365 (Posture).

### 9.8. Cortex Cloud Identity Security

#### 9.8.1. What is Cortex Cloud Identity Security?

#### 9.8.2. Cortex Cloud Identity Security concepts

##### Note

* Access to the Weak/Compromised Password column requires the ITDR add-on.

* Only ITDR assets can have a risk score.

* When a policy is analyzed and categorized as excessive, a relevant finding and highlight is attached to that policy and the various identities being granted excessive permissions.

* Each action must be defined as either being administrative or not. The administrative tag is an additional tag for administrative actions, along with one of the other access level types. For example, the AWS action iam:CreateGroup is categorized as config and has the administrative tag as well.

##### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

#### 9.8.3. Cortex Cloud Identity Security principles

#### 9.8.4. Cortex Cloud Identity Security use cases

#### 9.8.5. How to manage RBAC and SBAC in Cortex Cloud Identity Security

##### Important

* You can use the Cortex Cloud Identity Security RBAC roles to define access to the various sections and functionalities of Cortex Cloud Identity Security, but these roles do not directly control the specific data a user sees within those sections. Data visibility is further refined and limited by scope-based access control (SBAC) capabilities.

#### 9.8.6. How to achieve the principle of least privilege access

##### Note

* In the case of Amazon AWS, Cortex Cloud Identity Security also uses AWS Identity and Access Management (IAM) Access Advisor insights to expand the coverage of supported actions.

##### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

#### 9.8.7. How to enable inactive human identity logs on Azure in Cortex Cloud Identity Security

##### Note

* For more information, see Ingest logs from Microsoft Azure Event Hub.

#### 9.8.8. How to perform advanced Identity Security investigations using XQL

##### Note

* For more information, see Build XQL queries.Build XQL queries

### 9.9. Cortex Advanced Email Security

#### 9.9.1. Cortex Advanced Email Security module overview

##### Prerequisite

* The following are prerequisites for using the Cortex XSIAM Advanced Email Security module. REQUIREMENT DESCRIPTION Setup and Permissions Ensure Analytics is activated before enabling the Cortex Advanced Email Security module. Licenses and Add-ons Cortex Advanced Email Security add-on.

#### 9.9.2. Cortex Advanced Email Security module architecture and data flow

#### 9.9.3. Getting started with the Cortex Advanced Email Security module

##### Prerequisite

* Before you configure the Cortex Advanced Email Security module, ensure you have the following: Admin-level access to the target email platform API permissions to read mailbox data, manage remediation (if desired), and access user directories Dedicated service account (recommended) for integration purposes (response actions) List of domains and...

#### 9.9.4. Deploy and configure the Email Security module

##### 9.9.4.1. Integrate Microsoft 365 with the Cortex Advanced Email Security Module

###### License Type

  To configure a quick action, you must first create an application in Microsoft O365.

###### Navigation

  After you onboard your domains and configure the quick actions, Cortex XSIAM manage your protected domains in Modules → Email Security → Email Security Configuration

##### 9.9.4.2. Configure the Cortex Advanced Email Security module

###### License Type

  Requires the Email Security module.

###### Note

* You can add email indicators to the Allow List also in Exceptions Configuration → Issue Exclusions. However, if you add multiple indicators in a rule using Issue Exclusions under Exceptions Configuration, you cannot edit the rule in the Email Security Allow List.

###### Navigation

  Modules → Email Security → Email Security Configuration

#### 9.9.5. Cortex Advanced Email Security threat detection and issues

##### Note

* Depending on data collection mode and platform capabilities, not all fields may be populated for every message. API and export documentation provides further clarification on optional vs required fields.

##### 9.9.5.1. Email Security Analytics Rules

###### Navigation

  The Email Security Analytics Rules page is in Modules → Email Security → Email Security Detection Rules

#### 9.9.6. Investigate and respond to email security issues

##### License Type

  Requires the Cortex Advanced Email Security module.

##### Navigation

  Modules → Email Security → Email Security Issues

#### 9.9.7. Automate remediation for the Cortex Advanced Email Security module

#### 9.9.8. Email Command Center

##### License Type

  Requires the Cortex Advanced Email Security module.

### 9.10. Exposure management

#### 9.10.1. Exposure Management in Cortex XSIAM

##### License Type

  Requires the Exposure Management add-on.

#### 9.10.2. Get started with Exposure Management

#### 9.10.3. Exposure Management Command Center

#### 9.10.4. Compensating Controls

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

#### 9.10.5. Cortex Network Scanner

##### 9.10.5.1. Get started with Cortex Network Scanner

###### License Type

  Requires the Exposure Management add-on.

###### Prerequisite

* Review the Cortex Network Scanner deployment recommendations and complete any prerequisites. Set up and configure Broker VM

###### Note

* The current version of the Cortex Network Scanner does not support load distribution and balancing. Vulnerability assessment scans can take time, and currently you can assign only one scanner per scan task. To scan the entire network we recommend splitting your scanning activity into smaller tasks to preserve performance.

* The Cortex Network Scanner applet is not supported for FedRAMP customers.

###### Important

* The Cortex Network Scanner applet is not supported for FedRAMP customers.

###### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  Settings → Configurations → Network Scanners → Network Scanners and find your new scanner in the list

##### 9.10.5.2. Add a network

###### Navigation

  Settings → Configurations → Network Scanning → Networks and click + Add Network

##### 9.10.5.3. Add credentials for authenticated scans

###### Prerequisite

* Before initiating an authenticated scan, complete the following prerequisites on your target hosts: Create dedicated service accounts. We highly recommend creating dedicated service accounts on your target devices specifically for the network scanner. Avoid using existing administrative accounts or personal user accounts. This practice enhances...

###### Note

* You cannot edit saved credentials, but you can delete them and create new ones as needed.

###### Navigation

  Settings → Configurations → Network Scanners → Credential Management

##### 9.10.5.4. Create a scan

###### Tip

* Most use cases can use the default advanced settings.

* ICMP Ping provides the quickest discovery scan and is good for initial discovery and scoping, however in the modern enterprise environment ICMP response can be blocked by the firewall or endpoint security rules. Using additional methods increases the accuracy of the host discovery, although makes the scan take a longer time. The best approach is to use...

##### 9.10.5.5. Manage scans

###### Navigation

  Settings → Configurations → Network Scanners → Scan Management

##### 9.10.5.6. View issues triggered by network scanner findings

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

### 9.11. Vulnerability management

#### 9.11.1. Vulnerability management in Cortex XSIAM

##### Note

* Cortex XSIAM vulnerability management provides the ability to identify and assess runtime vulnerabilities in every asset across traditional IT and cloud environments. For vulnerabilities detected in your software development lifecycle through application security scans, refer to the Cortex Cloud Application Securitydocumentation.

##### 9.11.1.1. Cortex XSIAM vulnerability concepts

###### Note

* CVE is an acronym for Common Vulnerabilities and Exposures, which is a list of publicly disclosed security threats. We often use the term "CVE" to refer to a vulnerability that has been a assigned a CVE ID. Cortex XSIAM identifies CVEs and non-CVE vulnerabilities.

##### 9.11.1.2. Vulnerability Management dashboard

#### 9.11.2. Vulnerability policies

##### 9.11.2.1. Create a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

##### 9.11.2.2. Update the Ignored CVEs, Asset Groups, and Assets policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

##### 9.11.2.3. Modify a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

##### 9.11.2.4. Enable or disable a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

#### 9.11.3. Investigate and remediate vulnerabilities

##### 9.11.3.1. View all Vulnerabilities

###### Navigation

  Posture Management → Vulnerability Management → Vulnerabilities

##### 9.11.3.2. View vulnerability issues

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

##### 9.11.3.3. View All Vulnerability Findings

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues and click the All Vulnerability Findings button

##### 9.11.3.4. View vulnerable assets

###### Navigation

  Posture Management → Vulnerability Management → Vulnerable Assets

#### 9.11.4. Vulnerability Intelligence

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

#### 9.11.5. Recast CVSS scores and CVSS severities

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

10. Serverless function security

  10.1. Overview

  10.2. Serverless function posture security

  10.2.1. Onboard cloud providers for serverless functions

##### Note

* When scanning serverless functions wtih layers, those layers need to be from the same cloud account.

* Only functions containing zip files are supported.

##### Important

* Cortex supports GCP functions deployed by Cloud Functions (1st gen) and Cloud Functions API (2nd gen).

  10.2.2. Serverless function posture policies

  10.2.2.1. Manage serverless function policies

##### Note

* You can select multiple types to view all your serverless function rules across your cloud providers.

* Refer to Create serverless function policies for more information on how to define the steps of a policy in the wizard.

  10.2.2.2. Create serverless function policies

##### Note

* You can select multiple options.

* For more information about rules, refer to Manage serverless function rules.

  10.2.3. Serverless function posture rules

  10.2.3.1. Manage serverless function rules

##### Note

* You can select multiple types to view all your serverless function policies across your cloud providers.

* Refer to Create serverless function rules for more information on how to define the steps of a rule in the wizard.

  10.2.3.2. Create serverless function rules

  10.2.3.3. Create an attack path rule for serverless functions

##### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  in as the operator → enter the CVE ID → Search

  > or >= as the operator → Severity level (such as High, Low) → Search

  > or >= as the operator → enter a score → Search

  10.2.3.4. Create a configuration rule for serverless functions

##### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  10.2.3.5. Create a network exposure rule for serverless functions

##### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  10.2.4. Serverless function usage

##### Navigation

  To access serverless function assets, under Inventory, select All Assets → Compute → Serverless Functions

  Posture Management → Vulnerability Management) → Vulnerability Issues

  Add Filters → Asset Category → Serverless Function

  Posture Management → Vulnerability Management) → Vulnerable Assets

  Add Filters → Asset Category → Serverless Functions

  10.3. Serverless function runtime security

  10.3.1. Overview

  10.3.2. Set up serverless function protection

  10.3.3. Serverless runtime issues

##### Note

* Issues triggered within 24 hours, sharing the same name and description, will be aggregated into cases along with issues from the same function per execution.

11. Data management

  11.1. Broker VM

  11.1.1. What is the Broker VM?

  11.1.2. Set up and configure Broker VM

##### Note

* The Broker VM comes with a 512 GB disk. Therefore, deploy the Broker VM with thin provisioning, meaning the hard disk can grow up to 512 GB but will do so only if needed.

* When DHCP is not enabled in your network and there isn't an IP address for your Broker VM, configure the Broker VM with a static IP using the serial console menu.

* When configuring a Local Agent Settings applet with installer and content caching, you need to configure an SSL certificate for the Broker VM as explained in the task below. For more information on specific requirements for the Local Agent Settings applet, see Activate Local Agent Settings. Keep in mind that several Broker VM applets, such as the...

* You can configure another Broker VM as a proxy server for this Broker VM by selecting the HTTP type. When selecting HTTP to route Broker VM communication, you need to add the IP Address and Port number (set when activating the Agent Proxy) for another Broker VM registered in your tenant. This designates the other Broker VM as a proxy for this Broker VM.

* The Palo Alto Networks Broker VM supports only strong cipher SHA256-based certificates. MD5/SHA1-based certificates are not supported.

* If adding a CA certificate to the Broker VM is not possible, ensure that you've added the Broker Service FQDNs to the SSL Decryption Exclusion list on your firewalls. See Enable Access to Cortex XDR.

##### Important

* There can be instances in which the Broker VM requires up to 50% of the incoming bandwidth as outgoing. Such instances can be, network instability between the Broker VM and Cortex XSIAM, or data that is being collected, but not well compressed.

* The internal network for the Broker VM must be unique and reserved. Other devices should not use the same IP as the Broker VM internal network as it can lead to communication issues with the Broker VM.

* If you use SSL decryption in your firewalls and proxies, see the Understanding CA certificate functionality in Broker VM deployments section below. In addition, verify that the proxies used support HTTP/2, gRPC-specific headers, and HTTP/2 trailers, and the inspection policies support gRPC traffic. Any devices that you use with this configuration...

* When configuring more than one network interface, ensure that only one Default Gateway is defined. The rest must be set to 0.0.0.0, which configures them as undefined. In addition, we recommend assigning each network interface to a different subnet, as oppose to configuring two interfaces on the same subnet which can potentially cause unexpected...

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and earlier, Cortex XSIAM will only accept 172.17.0.0/16.

* We strongly recommend disabling SSH connectivity when it's not being used. Therefore, activate SSH connectivity when it's needed and disable it right afterwards. When generating a new SSH key ensure to avoid embedding the domain-style username, by not using any backslashes (\) in the comment field, to ensure the SSH key passes validation.

  11.1.2.1. Broker VM image installations

  11.1.2.1.1. Set up Broker VM on Alibaba Cloud

##### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* For Linux and Windows uploads, you can use Alibaba Cloud's graphical management tool called ossbrowser.

* The Object Storage Service must be created in the same Region as the image of the virtual machine.

##### Navigation

  Hamburger menu → Elastic Compute Service → Instances & Images → Instances

  11.1.2.1.2. Set up Broker VM on Amazon Web Services

##### Prerequisite

* Download a Cortex XSIAM Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. You need to set up an AWS VM Import role (vmimport) before you continue with the steps to convert the image as it is required for the import-image CLI command. You can use a different role, if the...

##### Note

* Creating an AMI image can take up to 60 minutes to complete.

* Assigning security groups can take up to 15 minutes.

##### Important

* A t2.medium (4GB RAM) is the lowest machine type that can be used as an instance type. Usually, the lowest machine type is sufficient with the Local Agent Settings applet. Yet, when enabling more applets, 8 GB is required.

##### Navigation

  Log in to the AWS IAM Console, and in the navigation pane, select Access Management → Users → Add Users

  Obtain a registration token from the Cortex XSIAM Web Console by selecting Settings → Configurations → Data Broker → Broker VMs → Add Broker → Generate Token

  11.1.2.1.3. Set up Broker VM on Google Cloud Platform (GCP)

##### Prerequisite

* Download a Cortex XSIAM Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. To complete the set up, you must have G Cloud installed and have an authenticated user account.

* Before importing a GCP image using the gcloud CLI, ensure that you update the Google Cloud components to version 371.0.0 and above using the following command:

##### Note

* The import tool uses Cloud Build API, which must be enabled in your project. For the import to work, Cloud Build service account must have compute.admin and iam.serviceAccountUser roles. When using the Google Cloud console to import the image, you will be prompted to add these permissions automatically.

  11.1.2.1.4. Set up Broker VM on KVM using Ubuntu

##### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  11.1.2.1.5. Set up Broker VM on Microsoft Azure

##### Prerequisite

* Download a Cortex XSIAM Broker VM VHD (Azure) image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* Extraction can take up to a few hours.

* Upload can take up to a few hours.

* Creating the VM can take up to 15 minutes. The Broker VM Web UI is not accessible during this time.

* For more information on creating a rule in an Azure VM, see Create a Security Rule in the Azure Documentation.

  11.1.2.1.6. Set up Broker VM on Microsoft Hyper-V

##### Prerequisite

* Download a Cortex XSIAM Broker VM VHD image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  11.1.2.1.7. Set up Broker VM on Nutanix Hypervisor

##### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* Saving the image to Nutanix hypervisor can take time as it's a large file.

* Creating the VM can take up to 15 minutes. The Broker VM Web user interface is not accessible during this time.

  11.1.2.1.8. Set up Broker VM on VMware ESXi using vSphere Client

##### Prerequisite

* Ensure you have a virtualization platform installed that is compatible with an OVA image, and have an authenticated user account. Download a Cortex XSIAM Broker VM OVA image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  11.1.2.2. Broker VM data collector applets

  11.1.2.2.1. Activate Apache Kafka Collector

##### Prerequisite

* Apache Kafka version 2.5.1 and above. Kafka cluster set up on premises, from which the data will be ingested. Privileges to manage Broker Service configuration, such as Instance Administrator privileges. Create a user in the Kafka cluster with the necessary permissions and the following authentication details:    Broker Certificate and Private Key for...

##### Note

* For CEF and LEEF logs, Cortex XSIAM takes the vendor and product names from the log itself, regardless of what you configure on this page.

  11.1.2.2.2. Activate CSV Collector

##### Prerequisite

* Set up and configure Broker VM. Ensure that you share the applicable CSV files. Know the complete file path for the Windows directory.

##### Note

* When you implement a wildcard file search, ensure that the CSV files share the same columns and header rows as all other logs that are collected from the CSV files to create a single dataset.

* The CSV Collector checks for new CSV files every 10 minutes.

  11.1.2.2.3. Activate Cortex Network Scanner

##### License Type

  Requires the Exposure Management add-on.

##### Prerequisite

* Review the Cortex Network Scanner deployment recommendations and complete any prerequisites. Set up and configure Broker VM

##### Important

* The Cortex Network Scanner applet is not supported for FedRAMP customers.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  Settings → Configurations → Network Scanners → Network Scanners and find your new scanner in the list

  11.1.2.2.4. Activate Database Collector

##### Prerequisite

* Set up and configure Broker VM

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.2.2.5. Activate Files and Folders Collector

##### Prerequisite

* Set up and configure Broker VM. Know the complete path to the files and folders that you want Cortex XSIAM to monitor. Ensure that the user permissions for the network share include the ability to rename and delete files in the folder that you want to configure collection.

##### Note

* Cortex XSIAM only supports ingestion of files encoded in UTF-8 format.

* When using the Linux file share, including the Linux share with nfs, a Username and Password is not required, so these fields are grayed out in the screen.

* In Batch mode, the Files and Folders Collector supports collecting logs from a network share for a maximum file size of 500 MB.

* When uploading JSON files, Cortex XSIAM only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* When the storing method is Replace, the maximum size for the total data to be imported into a lookup dataset is 30 MB each time the data is fetched. The inventory data ingested using the Files and Folders collector is counted towards license utilization. When you use a JOINT function with a lookup table in a query or correlation rule, make sure you...

* You can't specify a file name that's the same as a system file name. The name of a dataset created from a tsv file must always include the extension. If the original file name is mrkdptusrsnov23.tsv, you can name save the dataset with the name marketing_dept_users_Nov_2023.tsv.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

  11.1.2.2.6. Activate FTP Collector

##### Prerequisite

* Set up and configure Broker VM. Ensure that the user permissions for the FTP, SFTP, or FTPS include the ability to rename and delete files in the folder that you want to configure collection. When setting up an FTPS Collector with a server using a Self-signed certificate, you must upload the certificate first to the Broker VM as a Trusted CA...

##### Note

* When configuring an SFTP connection, Cortex XSIAM expects the private key to be in the RSA format that is included in the -----BEGIN RSA PRIVATE KEY----- tag. Cortex XSIAM does not support providing the private key in the OpenSSH format from the -----BEGIN OPENSSH PRIVATE KEY----- tag. When using ssh-keygen using a Mac, you get the OpenSSH format by...

* When uploading JSON files, Cortex XSIAM only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

  11.1.2.2.7. Activate Local Agent Settings

##### Note

* This is assuming a standard hardware setup with 2vCPU 8 GB memory.

* Broker VMs can act as as a proxy for routing XDR Collector traffic to the Cortex XSIAM tenant. The Broker VM does not cache XDR Collector installers.

* When you install your XDR agents, you need to configure the IP address of the Broker VM and a port number during the installation. You can use the default 8888 port or set a custom port. You are not permitted to configure port numbers between 0-1024 and 63000-65000, or port numbers 4369, 5671, 5672, 5986, 6379, 8000, 9100, 15672, 25672. Additionally,...

##### Important

* A FQDN must be configured for WEC and Agent Installer and Content Caching to function properly.

* You can only enable Agent Installer and Content Caching, when in the Broker VM Configuration, you've uploaded your signed SSL Server Certificate and key and set the FQDN. For more information, see the Agent Installer and Content Caching requirements explained above.

  11.1.2.2.8. Activate NetFlow Collector

##### Prerequisite

* Set up and configure Broker VM

##### Note

* Since multiple network devices can send data to a single NetFlow Collector, we recommend that you configure a maximum of 50 NetFlow Collectors per Broker VM applet, with a maximum aggregated rate of approximately 50K flows per second (FPS) to maintain system performance.

* Since Cortex XSIAM reserves some port numbers, it is best to select a port number that is not in the range of 0-1024 (except for 514), in the range of 63000-65000 or has one of the following values: 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672.

* The options available change, according to the set Source Network value.

  11.1.2.2.9. Activate Network Mapper

##### Prerequisite

* After you have configured and registered your Broker VM, you can choose to activate the Network Mapper application.

##### Note

* Each IP address range can receive multiple scan requests based on it's availability.

* IP address ranges are displayed according to what you defined as your Network Parameters.

  11.1.2.2.10. Activate Pathfinder

##### Prerequisite

* Configure and register a Broker VM. Except for Vanilla Windows 7, Cortex XSIAM supports activating Pathfinder on Windows operating systems with PowerShell version 3 and later. Verify these requirements wherever you want to activate Pathfinder. The Pathfinder configuration must contain at least one IP address range to run. Make sure that your internal...

##### Note

* Pathfinder isn't supported when configuring Broker VMs in high availability (HA) clusters.

##### Important

* The Broker VM Pathfinder applet is now deprecated. In tenants where the applet was implemented, it will remain operational until January 25, 2026. In all other tenants, the applet is unavailable and cannot be used as of July 20, 2025. To ensure complete coverage and protection, we recommend deploying XDR Agents on all endpoints by this date. Migration...

* The Pathfinder applet isn't supported when configuring Broker VMs in high availability (HA) clusters.

  11.1.2.2.11. Activate Registry Scanner

##### Prerequisite

* To initialize registry scanning on your Broker VM, you must first add the necessary data connectors. For details, see Connect Docker V2-compliant container registry and Connect JFrog container registry When sizing your Broker VM, consider the following recommendations:    Disk Size: Calculate the required disk space by multiplying the average container...

##### Note

* FedRAMP is currently not supported for this applet. You cannot activate the Registry Scanner directly on a new or existing Broker VM. You can only activate or deactivate existing Registry Scanner applets. To activate or deactivate existing applets, see Step 4 under Verify Registry Scanner connection section.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.2.2.12. Activate Syslog Collector

##### Prerequisite

* Set up and configure Broker VM

##### Note

* Once configured, you cannot change the Port/PROTOCOL. If you don't want to use a data source, ensure to remove the data source from the list as explained in Task 5.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and...

* The server certificate and private key pair is expected in a PEM format. Cortex XSIAM will notify you when your certificates are about to expire.

* Because some port numbers are reserved by Cortex XSIAM , you must choose a port number that is not: In the range of 0-1024 (except for 514) In the range of 63000-65000 Values of 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672

* CORELIGHT is not available for a UDP protocol.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.2.2.13. Activate Transporter

##### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator) Set up and configure Broker VMSet up and configure Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex XSIAM resources. The IP addresses...

##### Warning

* The Transporter applet is not supported for FedRAMP customers.

##### Navigation

  Settings → Configurations → Broker VMs (under Data Broker

  the Brokers tab → locate your Broker VM → hover and click + Add under the Apps column → AppSec Transporter

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

  11.1.2.2.14. Activate Windows Event Collector

##### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

##### Note

* You can also activate the Windows Event Collector on Windows Core. For more information, see Activate Windows Event Collector on Windows Core.

* By default, Cortex XSIAM collects Palo Alto Networks predefined Security events that are used by the Cortex XSIAM detectors. Removing the Security collector interferes with the Cortex XSIAM detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

  11.1.2.2.14.1. Activate Windows Event Collector on Windows Core

##### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

##### Note

* By default, Cortex XSIAM collects Palo Alto Networks predefined Security events that are used by the Cortex XSIAM detectors. Removing the Security collector interferes with the Cortex XSIAM detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

  11.1.2.2.14.2. Renew WEC certificates

##### Note

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* You can see more than one ca.wec.paloaltonetworks.com and forwarder.wec.paloaltonetworks.com file from a previous installation in the directory, so select the file with the most extended Expiration Date. You can verify that you are using the correct certificate: To verify the client certificate in the Personal → Certificates folder is related to the...

* Only perform this step under the following conditions: You have completed the WEF certification renewal process for ALL clients in your environment. Otherwise, events from the WEFs that you did not install the new client certificate will not be collected by the WEC. You are approaching the WEC server CA certificate expiration date, which is 2 years...

* If this query does not display results with a timestamp from after the renewal process, it could indicate that the renewal process is not complete, so wait a few minutes before running another query. If you are still having a problem, contact Technical Support.

##### Important

* After you receive a notification for renewing your WEC CA certificate, we recommend that you do not add any new WEF clients until the WEC certification renewal process is complete. Events from these WEF clients that are added afterwards will not be collected by the server until the WEC certificates are renewed.

  11.1.3. Manage Broker VM

##### Note

* For more information on troubleshooting errors and warnings for these broker applets, see Troubleshoot Broker VM applet errors.

* Certain fields are also exposed in the Clusters tab, when a Broker VM node is added to a High Availability (HA) cluster, and each cluster node is expanded to view the Broker VM nodes table. An asterisk (*) is beside every field that is also included in the Broker VM nodes table for each HA cluster.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.3.1. Edit Broker VM Configuration

##### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and lower, Cortex XSIAM accepts only 172.17.0.0/16.

* Make sure you save the password before closing the window. The only way to re-generate a password is to disable ssh and re-enable.

  11.1.3.2. Increase Broker VM storage allocated for data caching

##### Note

* Follow your hypervisor documentation to understand how to add a persistent disk storage to your VM.

* If your disk is not listed and you didn't shutdown your Broker VM in your hypervisor before manually adding a disk to the VM, you'll need to reboot the Broker VM before the disk details are detected by the Broker VM. This can be performed either in the hypervisor or directly in the Broker VMs page.

##### Warning

* This operation is irreversible, and will make the disk become an integral part of the broker, where disconnecting the disk will result in errors and data loss.

  11.1.3.3. Monitor Broker VM using Prometheus

##### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* For more information on Docker, see the Docker website.

  11.1.3.4. Collect Broker VM Logs

##### Note

* The Download Logs (<TIMESTAMP>) is only displayed when you've downloaded your logs previously using Generate New Logs.

  11.1.3.5. Upgrade Broker VM

##### Important

* After a Broker VM upgrade, your broker may require a reboot to finish installing important updates. A notification about this will be sent to your Cortex XSIAM console Notification Center.

  11.1.3.6. Import Broker VM Configuration

##### Important

* This option can only be used on Broker VMs with version 20.0 and later, and is only suitable for importing a configuration of brokers in the same version, or from a broker in an older version to a broker in a newer version.

* If your source Broker VM configuration includes a WEC applet, you'll need to ensure that you update the DNS record of this Broker VM's FQDN to point to the target Broker VM IP address.

  11.1.3.7. Open Live Terminal

##### Note

* You can either restart_routes or reboot the Broker VM for the changes in the /etc/network/routes file to take affect.

  11.1.3.8. Add Broker VM to cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.3.9. Switchover Primary Node in Cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.3.10. Remove from Cluster

##### Note

* If you've enabled a Load Balancer Health-Check on the cluster, you need to exclude this Broker VM from your Load Balancer settings.

  11.1.4. Manage Broker VM data collector applets

##### Note

* For more information on the Broker VM applet connectivity status, see Manage Broker VM.

  11.1.5. Broker VM High Availability Cluster

##### Note

* For Load Balancing, you must install a Load Balancer in your network which will distribute the incoming data between the nodes.

* The Pathfinder applet isn't supported when configuring Broker VMs in HA clusters.

  11.1.5.1. Configure High Availability Cluster

##### Prerequisite

* Be sure you do the following tasks before creating a cluster from an existing Broker VM: Since the Pathfinder applet isn't supported when configuring HA clusters, you must ensure Pathfinder is deactivated on the Broker VM. If the Broker VM is explicitly specified in some Agent Settings profile, which mean Cortex XSIAM agents retrieve release upgrades...

##### Important

* You can only create a new cluster from an existing Broker VM, when the Broker VM version is 19.0 and later, and the STATUS is Connected. The Create a Cluster from this Broker option is only listed if the Broker VM is not already added to a cluster.

* When the Protocol is set to HTTPS, you may need to perform a few follow-up steps to establish a validated secure SSL connection with the Broker VM. If you're using your own Certificate Authority (CA) to sign the certificates, you'll need to place the CA in the client, such as the Load Balancer, and upload the certificates to the Broker VM. If you're...

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.5.2. Manage Broker VM clusters

##### Navigation

  After you've configured a cluster, you can manage all your Broker VM clusters from the Clusters tab on the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs → Clusters

  11.1.5.2.1. View cluster details

##### Note

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

##### Navigation

  The Clusters tab of the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs) enables you

  11.1.5.2.2. Edit cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs, and select the Clusters tab

  11.1.5.2.3. Add applet to cluster

##### Note

* With Cortex XDR Prevent, it's only relevant to configure a HA cluster with a Local Agent Settings applet as this is the only applet supported for this product license. The other applets are collector applets, which are only available in Cortex XDR Pro or Cortex XSIAM.

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

  11.1.5.2.4. Add Broker VM to cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.5.2.5. Remove cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.6. Broker VM notifications

##### Note

* For more information on upgrading to a new Broker VM image, see Migrating to a New Broker VM Image.

  11.1.7. Monitor Broker VM activity

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  11.1.8. Troubleshoot Broker VM applet errors

##### Note

* For more information on creating correlation rules to trigger collection health issues, see How can I set up correlation rules to trigger collection health issues?.

  11.2. XDR Collectors

##### Note

* Ingestion of log events larger than 5 MB is not supported.

  11.2.1. XDR Collector audit logs

  11.2.2. XDR Collector machine requirements and supported operating systems

  11.2.3. Resources required to enable access to XDR Collectors

##### Note

* Some of the IP addresses required for access are registered in the United States. As a result, some GeoIP databases do not correctly pinpoint the location in which IP addresses are used. All customer data is stored in your deployment region, regardless of the IP address registration and restricts data transmission through any infrastructure to that...

* Throughout this topic, <xsiam-tenant> refers to the chosen subdomain of your Cortex XSIAM tenant and <region> is the region in which your Strata Logging Service is deployed.

  11.2.4. Manage XDR Collectors

  11.2.4.1. XDR Collectors installation resource for Windows and Linux

##### Note

* In some circumstances, such as after an XDR Collectors upgrade, the configured settings in the XML configuration file can be erased. Yet, this won't affect the saved settings in the XDR Collectors database.

  11.2.4.2. Create an XDR Collector installation package

##### Note

* To move existing XDR Collectors between Cortex XSIAM managing servers, you need to first Uninstall the XDR Collector from the collector machine and then for the new XDR Collector create a new installation package.

* Since Cortex XSIAM relies on the installation package ID to approve XDR Collector registration during install, it is not recommended to delete the installation package for any active on-premise collector machines. Hiding the installation package will remove it from the default list of available installation packages, and can be useful to eliminate...

  11.2.4.3. Install the XDR Collector installation package for Windows

  11.2.4.3.1. Install the XDR Collector on Windows using the MSI

##### Note

* When the package is executed using the MSI, an installation log is generated in %TEMP%\MSI<Random characters>.log by default.

* If the XDR Collector does not connect to Cortex XSIAM, verify your internet connection on the collector machine. If the XDR Collector still does not connect, verify that the installation package has not been removed from the Cortex XSIAM tenant.

  11.2.4.3.2. Install the XDR Collector on Windows using Msiexec

  11.2.4.4. Install the XDR Collector installation package for Linux

##### Note

* We recommend that you perform a Linux RPM or Linux DEB installation.

* If the XDR Collector does not connect to Cortex XSIAM, verify your Internet connection on the collector machine. If the XDR Collector still does not connect, verify the installation package has not been removed from the Cortex XSIAM management console.

* The XDR Collector does not support proxy communication in environments where proxy authentication is required.

##### Important

* When performing a XDR Collector installation or upgrade in Linux using a shell installer, the  /tmp folder cannot be marked as noexec. Otherwise, the installation or upgrade fails. As a workaround, before the installation or upgrade, use the following command:

  11.2.4.5. Configure the XDR Collector upgrade scheduler

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → XDR Collectors → Configuration

  11.2.4.6. Set an application proxy for XDR Collectors

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → XDR Collectors → Administration

  11.2.4.7. Set an alias for an XDR Collector machine

##### Navigation

  Settings → Configurations → XDR Collectors → Administration

  11.2.4.8. Upgrade XDR Collectors

##### Note

* The XDR Collector keeps the name of the original installation package after every upgrade.

  11.2.4.9. Uninstall the XDR Collector

##### Navigation

  Settings → Configurations → XDR Collectors → Administration

  Investigation & Response → Response → Action Center

  11.2.5. Define XDR Collector machine groups

##### Note

* XDR Collectors only support IPv4 addresses.

* Disconnecting Directory Sync in your Cortex XSIAM deployment can affect existing collector machine groups and policy rules based on Active Directory properties.

  11.2.6. About Cortex XDR Collector content updates

  11.2.7. XDR Collector profiles

  11.2.7.1. Add an XDR Collector profile for Windows

##### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex XSIAM collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex XSIAM supports logs in single line format or multiline format. For more...

  11.2.7.1.1. Ingest logs from Windows DHCP using Elasticsearch Filebeat

##### Note

* Although this enrichment is available when configuring a Windows DHCP collector for a cloud data collection integration, we recommend configuring Cortex XSIAM to receive Windows DHCP logs with an XDR Collector Windows Filebeat profile, because it is simpler to set up.

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the template provided by Cortex XSIAM to make your customizations. We recommend that you edit the file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating your...

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the example file provided by Cortex XSIAM to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your filebeat.yml file. Validate the syntax of the YML file before you finish creating...

* The tokenizer definition is dependent on the Windows server version that you are using, because the log format differs. For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%...

  11.2.7.1.2. Ingest Windows DNS debug logs using Elasticsearch Filebeat

##### Note

* Detailed logs are significantly larger, because more information is added to the logs.

* To avoid formatting issues in your filebeat.yml file, we recommend that you validate the syntax of the file.

  11.2.7.2. Add an XDR Collector profile for Linux

##### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex XSIAM collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex XSIAM supports logs in single line format or multiline format. For more...

  11.2.8. Apply profiles to collection machine policies

##### Navigation

  Settings → Configurations → XDR Collectors → Policies → +Add Policy

  11.2.9. XDR Collector datasets

  11.3. Data Collection

  11.3.1. Visibility of logs and issues from external sources

##### License Type

  Data collection may require an add-on.

##### Note

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs.

* Logs with sessionid = 0 are dropped.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. IOCs and BIOCs are only generated for these event types: sso and session_start.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. Analytics, IOCs and BIOCs are only generated on the Firewall data. The Zscaler Nanolog Streaming Service (NSS) feed for web logs is only used for Correlation Rules and threat hunting.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. The Zscaler Nanolog Streaming Service (NSS) feed for web logs is only used for Correlation Rules and threat hunting.

  11.3.2. Visibility of Cortex XSIAM audit and authentication logs

##### Note

* Cortex XSIAM can create Cortex XSIAM issues (Analytics, IOC, BIOC, and Correlation Rules) when relevant from logs.

  11.3.3. External data ingestion vendor support

##### License Type

  Data collection may require an add-on.

  11.3.4. Manage instances

  11.3.4.1. Add a new data source or instance

##### Note

* If a data source contains multiple integrations, the integration configured as the default integration will used by the Data Onboarder. The default integration of the content pack is indicated in each content pack's documentation. The other integrations are available for configuration in the Automation and Feed Integrations page after installing the...

* If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant page in the system, for example Correlations, Playbooks, or Scripts. If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant...

  11.3.4.2. How to configure the scanning settings for supported services

##### Note

* All the asset types are selected by default. When you deselect a data asset type, it is not included when the system runs the next scan operation, reducing the total scan time.

  11.3.4.3. Manage cloud instances

  11.3.4.4. Update cloud permissions after Cortex release updates

##### Prerequisite

* Ensure that the user account used to modify permissions has the necessary privileges within both the Cortex platform and your cloud environment, for example, AWS or Azure. You received a notification regarding a new version available that requires permission updates, or viewed a Needs Update status in the Data Sources page.

##### Note

* Instances requiring updates will not change their connection status, for example, Connected, Warning, Error, Disabled, due to the pending permission update.

  11.3.4.5. Pending cloud instances

  11.3.4.6. Troubleshoot errors on cloud instances

##### Note

* Errors related to collection of audit logs in the cloud instance are recorded in the collection_auditing dataset. For more information, see Audit logs fields and query examples.

  11.3.4.7. Manage Kubernetes Connector instances

  11.3.5. Palo Alto Networks integrations

##### License Type

  Data collection may require an add-on.

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

  11.3.5.1. About Palo Alto Networks integrations

##### Note

* For Palo Alto Networks Integrations there is an option to turn on or off the collection of URL and File log types. For more information, see Collecting URL and File log types.

* Roll-back of Strata Logging Service integration migration is not supported.

  11.3.5.2. Ingest data from Next-Generation Firewall

##### Prerequisite

* Ensure that you have completed the following on the NGFW or Panorama side: For Panorama only, ensure that the Panorama Cloud Services plugin is installed. Enable log forwarding profiles on firewall rules. On the Cortex XSIAM side, ensure that you have user role permissions for Data Collection > Data Sources. Configuration of data ingestion from...

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* If your firewalls are located in a different region, or bandwidth issues are encountered due to large log size, you can ingest NGFW logs in CEF format, using the Syslog collector. However, the Syslog solution is not as powerful nor as comprehensive as this data collector, and should only be used when this data collector cannot be used. For more...

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version.

* Cortex XSIAM does not validate your firewall credentials, you must ensure the certificates or PSK details have been updated in your firewalls in order for data to stream.

* It might take an hour or longer after connecting the firewall in Cortex XSIAM until you start seeing notifications that the certificate has been approved, and that the logging service license has appeared on the firewall.

* IOC and BIOC issues are applicable on stitched data only, and are not available on raw data.

##### Tip

* You can see an overview of ingestion status for all log types, and a breakdown of each log type and its daily consumption quota on the NGFW Ingestion Dashboard.

  11.3.5.2.1. Ingest Next-Generation Firewall logs using the Syslog collector

##### Note

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version, to ensure that you have configured log forwarding correctly for all the log types that you would like to forward to Cortex XSIAM. The following steps only cover...

* To avoid the possible effects of line formatting, do not copy/paste the message formats directly into the PAN-OS web interface. Instead, paste into a text editor, remove any carriage return or line feed characters, and then copy and paste into the web interface.

* From version 10.0 and later, the log format documented for log types (Traffic, Threat, and URL) exceeds the maximum supported 2048 characters in the Custom Log Format tab on the firewall and Panorama. Select the CEF keys and values to limit the number of characters to 2048, as per your requirements.

  11.3.5.3. Ingest data from Prisma Access

##### Prerequisite

* Configuration of data ingestion from multiple accounts requires Super User permissions in both Cortex XSIAM tenant and Prisma Access accounts.

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* Cortex XSIAM does not validate your Prisma Access account credentials. You must ensure the account has been deployed in order for data to stream.

  11.3.5.4. Ingest logs from Prisma Access Browser

  11.3.5.5. Ingest detection data from Strata Logging Service

##### Note

* IOC and BIOC issues are applicable on stitched data only and are not available on raw data.

  11.3.5.6. Ingest alerts and assets from IoT Security

  11.3.5.7. Collecting URL and File log types

  11.3.5.7.1. Detectors connected to URL and File log types

  11.3.6. External data ingestion

  11.3.6.1. External applications

  11.3.6.2. Ingest network connection logs

  11.3.6.2.1. Ingest network flow logs from Amazon S3

##### Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* To create a new VPC, click Launch VPC Wizard. For more information, see AWS VPC Flow Logs.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex XSIAM.

  11.3.6.2.1.1. Create an assumed role

##### Note

* In AWS this is an optional field to configure, but this must be configured to set up the Amazon S3 Collector in Cortex XSIAM .

* The <s3-arn> and <sqs-arn> placeholders. These will be filled out later depending on which Amazon S3 logs you are configuring, including network flow logs, audit logs, or generic logs.

  11.3.6.2.1.2. Configure data collection from Amazon S3 manually

##### License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

##### Note

* If you already have an Amazon S3 bucket configured with VPC flow logs that you want to use for this configuration, you do not need to perform the prerequisite steps detailed in the first two bullets.

* It is your responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* If you already have an Amazon S3 bucket configured with VPC flow logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

  11.3.6.2.2. Ingest network Route 53 logs from Amazon S3

##### Note

* For more information on configuring data collection from Amazon S3 for Route 53 DNS logs, see the AWS Documentation.

* For more information on creating a Stack, see Creating a stack on the AWS CloudFormation console.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex XSIAM.

  11.3.6.2.3. Ingest logs from Check Point firewalls

##### Note

* Logs with sessionid = 0 are dropped. Destination Port data is available only in the raw logs.

  11.3.6.2.4. Ingest logs from Cisco ASA firewalls and AnyConnect

  11.3.6.2.5. Ingest logs from Corelight Zeek

  11.3.6.2.6. Ingest logs from Fortinet Fortigate firewalls

  11.3.6.2.7. Ingest logs from Microsoft Azure Event Hub

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

##### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

##### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  11.3.6.2.8. Ingest network flow logs from Microsoft Azure Network Watcher

##### Prerequisite

* For NSG:    Ensure that your NSG flow logs in Azure Network Watcher conform to the requirements as outlined in Microsoft documentation. For more information, see Introduction to flow logging for network security groups.   Enable NSG flow logs in the Microsoft Azure Portal. For NSG: Ensure that your NSG flow logs in Azure Network Watcher conform to the...

##### Note

* In addition to your storage account, the template automatically creates another storage account that is required by the function app for internal use only. The internal storage account name is prefixed with cortex and is followed by a unique suffix based on the resource group, storage account, and container names.

  11.3.6.2.9. Ingest logs and data from Okta

  11.3.6.2.10. Ingest logs from Windows DHCP using Elasticsearch Filebeat

##### Note

* To avoid formatting issues in filebeat.yml, we recommend that you edit the text file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating the profile.

* For more information on configuring the filebeat.yml file, see the Elastic Filebeat Documentation.

* To avoid formatting issues in your filebeat.yml, we recommend that you use the download example file to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your file.

* The tokenizer definition is dependent on the Windows server version that you are using as the log format differs. -For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" -For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{mac...

  11.3.6.2.11. Ingest logs from Zscaler Internet Access

  11.3.6.2.12. Ingest logs from Zscaler Private Access

##### Note

* For more information on configuring the parameters on the screen, see the Zscaler Private Access (ZPA) documentation for Configuring a Log Receiver.

* You can only configure a ZPA log receiver to collect one type of log with your Syslog Collector in Cortex XSIAM. To configure more that one log type, you'll need to add another log receiver.

  11.3.6.3. Ingest authentication logs and data

  11.3.6.3.1. Ingest audit logs from AWS Cloud Trail

##### Note

* For more information on configuring data collection from Amazon S3 using AWS CloudTrail, see the AWS CloudTrail Documentation.

* For more information on creating an AWS CloudTrail trail, see Create a trail. If you already have an Amazon S3 bucket configured with AWS CloudTrail audit logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* It is your organization's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* The CloudWatch Logs - optional settings are not supported and should be left disabled.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It your organization's responsibility to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

  11.3.6.3.2. Ingest logs and data from a GCP Pub/Sub

##### Note

* When collecting flow logs, we recommend that you include GKE annotations in your logs, which enable you to view the names of the containers that communicated with each other. GKE annotations are only included in logs if appended manually using the custom metadata configuration in GCP. For more information, see VPC Flow Logs Overview. In addition, to...

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the GCP data collector settings. Yet, when the values are blank in the...

  11.3.6.3.3. Ingest logs and data from Google Workspace

##### Note

* For all types of data collected via the Admin Reports API, except alerts and emails, the log events are collected with a preset lag time as reported by Google Workspace. For more information on these lag times for the different types of data, see Google Workspace Data retention and lag times.

* Spam emails from the compliance email account, and from all other monitored email accounts, are not collected. Any draft emails written in the compliance email account are collected by the Google Workspace data collector, and are then deleted even if the email was never sent.

* For more information on the entire process, see Perform Google Workspace Domain-Wide Delegation of Authority.

* When collecting Google Workspace alerts with other types of data, except emails, you need to configure a service account in Google with the applicable permissions to collect events from the Google Reports API and alerts from the Alert Center API. If you prefer to use different service accounts to collect events and alerts separately, you'll need to...

* For more information on the Admin Reports API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information on the Gmail API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information about the events collected from the various Google Reports, see Google Workspace Reports API Documentation.

  11.3.6.3.4. Ingest logs from Microsoft Azure Event Hub

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

##### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

##### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  11.3.6.3.5. Ingest logs from Microsoft Office 365

##### Note

* Ingesting Microsoft Entra ID (formerly known as Azure AD) authentication and audit events from Microsoft Graph API requires a Microsoft Azure Premium 1 or Premium 2 license. Alternatively, if the directory type is Azure AD B2C, the sign-in reports are accessible through the API without any additional license requirement. To ingest email logs and data...

* When auditing is turned off from the default setting, you need to first turn on auditing for your organization to collect Microsoft Office 365 audit events from the Management Activity API. Log duplication of up to 5% in Microsoft products is considered normal. In some cases, such as login to a portal using MFA, two log entries are recorded by design.

* To address Azure reporting latency, there is a 10-minute latency period for Cortex XSIAM to receive Azure AD logs.

* You can also implement the corresponding Cortex Data Model (XDM) mappings for these Microsoft Graph Security API v2 alerts using Cortex Marketplace via the Microsoft Graph Security content pack.

* For more information, see the Office 365 Management Activity API schema.

* In FedRAMP environments, Azure sign-in logs are not supported, due to vendor technical constraints.

* Use this option when you don't want to grant permissions for Azure AD Authentication and Azure AD Audit.

  11.3.6.3.6. Ingest logs and data from Microsoft 365

##### License Type

  Email data: The subject, body, and attachments are visible only with an Email Security module license.

##### Prerequisite

* A user account with the Microsoft Azure Account Administrator role is required to set up a new Microsoft 365 email collector. The following Microsoft Graph API permissions are required:    Mailbox access (read-write)    Read and write mail in all mailboxes   Read contacts in all mailboxes   Read all user mailbox settings      User information, groups,...

##### Note

* For other logs from Microsoft Office 365, use the Office 365 data collector. For more information, see Ingest logs from Microsoft Office 365.

  11.3.6.3.7. Ingest logs and data from Okta

  11.3.6.3.8. Ingest logs and data from OneLogin

##### Note

* Event data is collected every 30 seconds.

* Inventory data snapshots are collected every 10 minutes.

  11.3.6.3.9. Ingest authentication logs from PingFederate

  11.3.6.3.10. Ingest authentication logs and data from PingOne

##### Navigation

  Reporting → Subscriptions → Add Subscription

  11.3.6.4. Ingest operation and system logs from cloud providers

  11.3.6.4.1. Ingest generic logs from Amazon S3

##### License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

##### Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* You need to set up an Amazon S3 data collector to receive generic logs when collecting logs from BeyondTrust Privilege Management Cloud. For more information, see Ingest logs from BeyondTrust Privilege Management Cloud.

* If you want to ingest raw EDR events from SentinelOne DeepVisibility, use the SentinelOne DeepVisibility log collector. For more information, see Ingest raw EDR events from SentinelOne DeepVisibility.

* It is the customer's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It is the responsibility of your organization to ensure that the user who performs this task of creating the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor...

  11.3.6.4.2. Ingest logs from Amazon CloudWatch

  11.3.6.4.3. Ingest logs and data from a GCP Pub/Sub

##### Note

* When collecting flow logs, we recommend that you include GKE annotations in your logs, which enable you to view the names of the containers that communicated with each other. GKE annotations are only included in logs if appended manually using the custom metadata configuration in GCP. For more information, see VPC Flow Logs Overview. In addition, to...

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the GCP data collector settings. Yet, when the values are blank in the...

  11.3.6.4.4. Ingest logs from Google Kubernetes Engine

##### Note

* Cortex XSIAM supports logs in single line format or multiline format. For more information on handling messages that span multiple lines of text in Elasticsearch Filebeat, see Manage Multiline Messages.

  11.3.6.4.5. Ingest logs from Microsoft Azure Event Hub

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

##### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

##### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  11.3.6.4.6. Ingest logs and data from Okta

  11.3.6.5. Ingest endpoint data

  11.3.6.5.1. Ingest alerts and metadata from CrowdStrike APIs

##### Note

* To enable some of the APIs, you may need to reach out to CrowdStrike support.

* For more information on configuring data collection from CrowdStrike APIs, see the CrowdStrike Documentation.

* Ensure that you save the SECRET value because this is the only time that it is displayed.

  11.3.6.5.2. Ingest raw EDR events from CrowdStrike Falcon Data Replicator

##### Prerequisite

* Ensure that your organization has a license for the CrowdStrike Falcon Data Replicator (FDR). Ensure that CrowdStrike FDR is enabled. CrowdStrike FDR can only be enabled by CrowdStrike Support. If CrowdStrike FDR is not enabled, submit a support ticket through the CrowdStrike support portal. Follow these steps to check if CrowdStrike FDR is...

##### Note

* Due to limitations with the S3 bucket used by CrowdStrike, data can only be collected once, by one system.

* For more information on configuring data collection from CrowdStrike via Falcon Data Replicator, see CrowdStrike documentation.

* Ensure that you copy the Secret, and store it in a safe place. You will not be able to retrieve it later. If you need a new secret, you must reset the feed credentials.

* CrowdStrike Falcon Data Replicator only supports one FDR credential configuration.

* Ensure that you save the SECRET value, because this is the only time that it is displayed. You can go back to this page later to copy the other credentials, but you will not have access to the secret again.

  11.3.6.5.3. Ingest raw EDR events from Microsoft Defender for Endpoint

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection. Create an Azure Event Hub. For more information, see Quickstart: Create an event hub using Azure portal.    Create a resource group (optional if you already have a resource group configured).   Create an Event Hubs namespace.   Create an event hub within the namespace....

##### Note

* The generic Cortex XSIAM Azure Event Hub collector does not offer full functionality for EDR data (such as stitching), and is therefore not suitable for EDR data ingestion.

* If you select all event types and leave Event-Hub name empty, an event hub will be created for each category in the selected namespace. If you are not using a Dedicated Event Hubs ClusterEvent Hub, namespaces have a limit of 10 Event Hubs.

  11.3.6.5.4. Ingest raw EDR events from SentinelOne DeepVisibility

##### Prerequisite

* The SentinelOne DeepVisibility logs that will be collected by your dedicated Amazon S3 bucket must adhere to the following guidelines:    Each log file must use the 1 log per line format as multi-line format is not supported.   The log format must be compressed as gzip or uncompressed.   For best performance, we recommend limiting each file size to up...

##### Note

* It is your responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule on the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If you receive an error when trying to save your changes, check that the permissions are set up correctly, and fix them if necessary.

* It is the responsibility of your organization to ensure that the user who creates the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors.

* For more information, see Managing access keys for IAM users.

  11.3.6.6. Ingest cloud assets

##### Note

* The cloud accounts being onboarded must be owned by the customer performing the onboarding process.

  11.3.6.6.1. Onboard Amazon Web Services

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

##### Prerequisite

* Before you begin, ensure you have: Access to AWS Management Console Required AWS permissions

##### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* When onboarding an AWS organization or organizational unit (OU), Cortex XSIAM creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

* See the prerequisites above for specific permissions required for serverless functions.

* If you select Automated, you must already be logged in to AWS.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only edit the instance from the Data Sources page. (AWS only) instances that were previously created in the Automation...

  11.3.6.6.1.1. Manually upload template to AWS

##### Prerequisite

* Before you begin, ensure you have: An AWS account Access to AWS Management Console Permission to create a stack and its resources in AWS CloudFormation

  11.3.6.6.1.2. Configure AWS integration instances and monitor integration instance health

##### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  11.3.6.6.2. Onboard Google Cloud Platform

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

##### Prerequisite

* Before you begin, ensure you have: Access to Google Cloud Console Admin user with required admin GCP permissions Enabled the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled) Enabled the following APIs in the GCP project you are...

##### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only modify the instance from the Data Sources page.

  11.3.6.6.2.1. Manually upload template to GCP

##### Prerequisite

* Before you begin, ensure you have: A GCP account. Permission to create the required resources in Google Cloud Deployment Manager. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool.

##### Note

* The directory you create must be a subdirectory of the home directory.

  11.3.6.6.2.2. Configure GCP integration instances and monitor integration instance health

##### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  11.3.6.6.2.3. Monitor GCP resources inside service perimeters

##### Note

* Each GCP cloud instance is assigned a scope within GCP. If the scope, whether it be organization, folder, or project, includes any projects with a service perimeter, this procedure must be performed for that cloud instance to authorize Cortex XSIAM to scan the resources in the perimeter.

  11.3.6.6.3. Onboard Microsoft Azure

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

##### Prerequisite

* Before you begin, ensure you have: An Azure subscription Admin permissions required to onboard Azure or the built-in Security Administrator role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups.

##### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only, you can only modify the instance from the Data Sources page.

  11.3.6.6.3.1. Manually upload template to Microsoft Azure Resource Manager using the CLI

##### Prerequisite

* Ensure the Azure CLI tool is installed and you are authorized to create management group policies.

  11.3.6.6.3.2. Manually upload template for Microsoft Azure subscriptions

##### Prerequisite

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the subscription scope. We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed Terraform on your local machine. You can download Terraform from the official...

* Ensure the Azure CLI tool is installed and you are authorized to create management group policies.

  11.3.6.6.3.3. Configure Azure integration instances and monitor integration instance health

##### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  11.3.6.6.4. Onboard Oracle Cloud Infrastructure

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

##### Prerequisite

* Before you begin, ensure you have: Access to Oracle Cloud Infrastructure console Permissions for all of the following are required:    Creation of identity groups (for more information, refer to Managing Groups)   Policies (for more information, refer to How Policies Work)   Tag namespaces in the root compartment (for more information, refer to Tags...

##### Note

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only; you can only modify the instance from the Data Sources page.

  11.3.6.6.4.1. Manually upload template to OCI

##### Prerequisite

* Before you begin, ensure you have: An Oracle Cloud Infrastructure account and the tenancy OCID. Permission to deploy a custom template and create its resources in OCI. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed...

  11.3.6.6.5. Manually connect a cloud instance

  11.3.6.6.6. Outposts

##### Prerequisite

* Before you begin, ensure you have: An AWS account Permission to create a stack and its resources in AWS Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the AWS CLI tool and configured your profile with the aws...

* Before you begin, ensure you have: A GCP account Permission to create the required resources in Google Cloud Deployment Manager Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool

* Before you begin, ensure you have: An active Azure subscription. Installed the Azure CLI tool. Permission to deploy a custom template and create its resources in Microsoft Azure ("Owner" or "Contributor" on the designated outpost subscription scope, and Active Directory "Cloud Application Administrator" or "Application Administrator" privileged...

##### Note

* We recommend you use a dedicated account for the outpost, free from other resources. You can only onboard one outpost for each account.

* When creating an outpost for a specific Azure subscription, the outpost account must be in the same Azure organization as the monitored subscriptions.

##### Navigation

  Settings → Data Collection → Outposts

  You can create a new outpost by navigating to Settings → Data Collection → Outposts and clicking New Outpost

  11.3.6.6.7. Container Registry Scanning

  11.3.6.6.7.1. Overview of container registry scanning

  11.3.6.6.7.1.1. Registry Components

  11.3.6.6.7.1.2. How Container Registry Scanning Works

  11.3.6.6.7.2. Configure registry scanning

##### Prerequisite

* Ensure that you have performed the all steps till Additional Security Capabilities as listed in the onboarding wizard for the required CSP: Onboard Amazon Web Services Onboard Google Cloud Platform Onboard Microsoft Azure

  11.3.6.6.7.3. Modify the container registry scanning scope

  11.3.6.6.7.4. Scan re-evaluation process

  11.3.6.6.7.5. Connect Docker V2 compliant container registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

##### Note

* Scanning is supported only for private repositories on Docker Hub.

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* FedRAMP is not supported for this mode.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  11.3.6.6.7.5.1. Manage a Docker V2 connector

  11.3.6.6.7.6. Connect JFrog container registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

##### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  11.3.6.6.7.6.1. Manage a JFrog connector

  11.3.6.6.8. Cloud service provider permissions

  11.3.6.6.8.1. Amazon Web Services provider permissions

  11.3.6.6.8.2. Google Cloud Platform provider permissions

  11.3.6.6.8.3. Microsoft Azure provider permissions

  11.3.6.6.8.4. Oracle Cloud Infrastructure provider permissions

  11.3.6.7. Ingest data for API security

  11.3.6.7.1. Ingest AWS API Gateway

##### Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

##### Important

* Leave '–'filter-pattern empty as displayed above.

  11.3.6.7.2. Ingest Azure APIM

##### License Type

  Requires the Data Collection add-on.

##### Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

##### Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

  11.3.6.7.3. Ingest Apigee Proxy

##### License Type

  Requires the Data Collection add-on.

##### Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

##### Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

  11.3.6.7.4. Ingest Kong

##### License Type

  Requires the Data Collection add-on.

##### Note

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

##### Important

* The size of the buffer must be equal to or larger than the max body size setting in the plugin configuration, on every data plane node.

  11.3.6.8. Ingest data from third-party pipeline solutions

  11.3.6.8.1. Ingest data from Cribl

##### Prerequisite

* Ensure that you have the credentials and IDs for each data source, such as Tenant ID, App ID and Client secret.

* Ensure that you have the copies of the Cortex XSIAM authorization token and API URL obtained in Task 2.

##### Note

* We do not support email data collection via Cribl.

* Only one Cribl data collector instance can be configured in Cortex XSIAM.

  11.3.6.8.1.1. Data source UUIDs

##### Note

* Do not use this generic UUID when your data source is listed in this table.

  11.3.6.9. Additional log ingestion methods

  11.3.6.9.1. Ingest logs from a Syslog receiver

  11.3.6.9.2. Ingest Apache Kafka events as datasets

  11.3.6.9.3. Ingest CSV files as datasets

  11.3.6.9.4. Ingest database data as datasets

  11.3.6.9.5. Ingest logs in a network share as datasets

##### Note

* The Files and Folders Collector applet only starts to collect files that are more than 256 bytes.

  11.3.6.9.6. Ingest FTP files as datasets

  11.3.6.9.7. Ingest NetFlow flow records as datasets

  11.3.6.9.8. Set up an HTTP log collector to receive logs

##### Note

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor...

* Each record cannot exceed 5 MB in size.

  11.3.6.9.9. Ingest logs from BeyondTrust Privilege Management Cloud

##### Note

* For a Log Format set to Beyondtrust Cloud ECS, the following fields are automatically set and not configurable. Vendor: Beyondtrust Product: Privilege Management Compression: Uncompressed

  11.3.6.9.10. Ingest logs and data from Box

##### Prerequisite

* Set up an Enterprise Box plan.  Important To collect Box Shield Alerts, you must purchase Box Shield and it must be enabled on Box enterprise. Set up an Enterprise Box plan. Create a valid Box account that is assigned to a role with sufficient permissions for the data you want to collect. For example, create an account assigned to an Admin role to...

##### Note

* The Fetch Intervals are non-configurable.

* Collecting Box Shield Alerts requires implementing Box Shield,

* There is a current bug with the Groups API from Box. If you don't configure the Box app with the proper permissions for managing groups data, the Groups API from Box won't return an error message to Cortex XSIAM indicating that the API failed to receive the data, and the Groups data will not be collected.

* For any future change that you make to your Box app, ensure that you send the changes for approval to the administrator, who will need to approve them as explained above.

* Inventory data snapshots are collected every 10 minutes.

  11.3.6.9.11. Ingest logs and data from Dropbox

##### Prerequisite

* Set up an Advanced Dropbox plan. Create a Dropbox Business admin account with Security admin permissions, which is required to authorize Cortex XSIAM to access the Dropbox Business account and generate the OAuth 2.0 access token.

##### Note

* The Fetch Interval is non-configurable.

* When the App Key field is empty, the here link in the tooltip is disabled. When an incorrect App Key is entered, clicking the link results in a 404 error.

* Whenever you change the permissions of the Dropbox app, we recommend that you generate a new Access Code for the Dropbox data collector instance so that the permissions match the updates.

* Event data is collected every 60 seconds with a 10 minute lag time.

* Inventory data snapshots are collected every 10 minutes.

  11.3.6.9.12. Ingest logs from Elasticsearch Filebeat

##### Navigation

  You can return to the Settings → Configurations → Data Collection → Data Sources page to monitor the status of your Filebeat configuration

  11.3.6.9.13. Ingest logs from Forcepoint DLP

  11.3.6.9.14. Ingest logs from Proofpoint Targeted Attack Protection

  11.3.6.9.15. Ingest logs and data from Salesforce.com

##### Prerequisite

* Cortex XSIAM:    To manage collection integration in Cortex XSIAM, ensure that you have the privilege to View/Edit Log Collections (for example, Instance Administrator). Cortex XSIAM: To manage collection integration in Cortex XSIAM, ensure that you have the privilege to View/Edit Log Collections (for example, Instance...

##### Note

* For more detailed reference information, see Configure a Connected App for the OAuth 2.0 Client Credentials Flow. Unlike other data collector setups, in this case, the setup includes obtaining an OAuth 2.0 code from Salesforce.com, and this code is only valid for 15 minutes. Therefore, make sure that you enable the data collector within 15 minutes of...

* When these options are cleared, only these data types will be omitted from collection. All other data will be collected as usual.

  11.3.6.9.16. Ingest data from ServiceNow CMDB

  11.3.6.9.17. Ingest report data from Workday

##### Prerequisite

* Create an Integration System User that is designated to access the custom report from Workday for data collection in Cortex XSIAM. Create an Integration System Security Group for the Integration System User created in Step 1 for accessing the report. When setting this group ensure to define the following:    Type of Tenanted Security Group: Select...

##### Note

* Any user with permissions to view issues and cases can view the Workday data.

* For more information on completing any of the prerequisite steps, see the Workday documentation.

* The Business Object changes depending on the Data Source selected.

* Cortex XSIAM uses a structured schema when integrating Workday data. To get the best Analytics results, specify all the fields marked with an asterisk from the recommended schema. workday_user_id* full_name* workday_manager_user_id* manager* worker_type* position_title* department* private_email_address* business_email_address* employment_start_date* em...

  11.3.6.9.18. Ingest external alerts

##### Note

* If you send pre-parsed alerts using the Cortex XSIAM API, additional mapping is not required.

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → Data Collection → External Issue Mapping

  11.3.7. Onboard the Kubernetes Connector

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Note

* For GKE or EKS clusters with the metadata service disabled and for AKS clusters with non-default nodes managed resource group, the cluster resource identifier must be specified.

  11.3.7.1. What's new in Kubernetes Connector?

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

  11.3.8. Automation and feed integrations

##### Note

* Some integrations can be downloaded directly without having to initially download a content pack from Marketplace. For more information, see Define data sources. In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as...

* If the integration was installed from a content pack, you need to duplicate the integration before editing.

* If the integration was installed from a content pack, you need to duplicate the integration before downloading.

* Integration commands are only available when the integration instance is enabled. Some commands depend on a successful connection between Cortex XSIAM and third-party integrations.

##### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

  11.3.8.1. Integration use cases

  11.3.8.2. Add an integration instance

##### Note

* This procedure describes how to add an integration instance from the Automation and Feed Integration page. Some integration instances can also be configured on the Data Sources page. For more information, see Add a new data source or instance.

* In some integrations, a classifier, an issue type, and mapper fields are included.

##### Navigation

  Settings → Configurations → Data Collection → Automation & Feed Integrations and search for the integration

  11.3.8.3. Configure integration permissions

##### Navigation

  Settings → Configurations → Data Collection → Integration Permissions

  11.3.8.4. Fetch issues from an integration instance

##### Note

* In some integrations, the Issue Fetch interval is called Feed Fetch Interval. If the integration instance does not have the Issue Fetch Interval field, you need to add this field by editing the integration settings. If the integration is from a content pack, you need to create a copy of the integration. Any future updates to this integration will not...

* Some content packs include preconfigured correlation rules, but you should review them to see if they suit your use case and duplicate them if required. Go to Threat Management → Detection Rules → Correlations, search for the relevant rule, right-click, and select Preview Rule. For example, the ServiceNow v2 Alerts (automatically generated)...

  11.3.8.4.1. Map fields to issue types

##### Note

* In the Classification & Mapping page, the mapping does not indicate for which issue types they are configured. Therefore, when creating a mapper, it is best practice to add to the mapper name, the issue types the mapper is for. For example, Mail Listener - Phishing.

* When mapping a list, we recommend you map to a multi select field. Short text fields do not support lists. If you do need to map a list to a short text field, add a transformer in the relevant playbook task, to split the data back into a list.

##### Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

  Settings → Configurations → Data Collection → Automation & Feed Integrations

  11.3.8.4.2. Classify events using a classifier for issue types

##### Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

  Settings → Configurations → Data Collection → Automation & Feed Integrations

  11.3.8.5. Troubleshoot Integrations

  11.3.8.6. Forward Requests to Long-Running Integrations

##### Note

* This integration replaces the External Dynamic list integration, which is deprecated. For more information about how to set up the integration, see Manage external dynamic lists.

* When running on the tenant, you can only use long-running integrations provided by Cortex XSIAM, you cannot create custom ones. Custom long-running integrations are supported only on engines at this time. Configuring custom certificates or private API Keys in the long-running integration instance is supported only on engines, not on the Cortex XSIAM...

* For the TAXII Server and TAXII2 Server integrations, the xdr string is automatically replaced by crtx. For the Microsoft Teams integration, you can use the microsoft-teams-create-messaging-endpoint command to get the correct messaging endpoint based on the server URL, the server version, and the instance configurations. For more information, see...

  11.3.9. Verify collector connectivity

##### Note

* For more information on troubleshooting data collector applet errors, see Troubleshoot Broker VM applet connectivity.

* If an issue is triggered, the investigation options in the right-click menu of the Health Issues pages are context-specific. Make sure that you specify the relevant issue category.

  11.3.10. Overview of data ingestion metrics

##### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics. Data Ingestion Monitoring: Go to Configurations → General → Server...

  11.3.10.1. Creating correlation rules to monitor data ingestion health

  11.3.10.2. Measuring data freshness

##### Note

* The max_delay metric is taken from the maximum bucket value with a restricted limit; therefore, metrics show whole numbers. The median and ninetieth_percentile metrics are statistical calculations that give an approximation of the real value; therefore, metrics show decimal numbers. Time slots with a zero log count or zero byte count display records...

  11.3.11. About health issues

##### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics. Data Ingestion Monitoring: Go to Configurations → General → Server...

##### Note

* The Health Issues page displays issues that were triggered after July 2024. To see health issues that were triggered before this date, click Legacy Health Issues.

* Cortex XSIAM enforces the dedup logic to health issues. This logic reduces the likelihood of identical health issues from flooding the issues dataset.

  11.3.11.1. Investigate and resolve health issues

  11.3.11.2. Monitor data ingestion health

##### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable Data Ingestion Monitoring in your Server Settings. For more information, see Set up your environment.

  11.3.11.3. Monitor correlation rules

##### Note

* In the dataset, the Query start time and Query end time indicate the timeframe of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

  11.4. Dataset management

##### License Type

  Managing Roles requires an Account Admin or Instance Administrator role. For more information, see Predefined user roles.

##### Note

* Cold storage, in addition to a cold storage license, requires compute units (CU) to run cold storage queries. For more information on CU, see Manage compute units. For information on the CU add-on license, see Understand the Cortex XSIAM license planUnderstand the Cortex XSIAM license plan.

* Only datasets that are already handled as part of the GB license are supported for this license. In addition, the retention configuration is only available in Cortex XSIAM, as opposed to the public APIs.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default. Datasets include dataset permission enforcements in the Cortex Query Language(XQL), Query Center, and XQL Widgets. For example, to view or access any of the endpoints and host_inventory datasets, you need role-based access control (RBAC)...

* You'll only be able to save the dataset view if the query contains no errors; otherwise, the Save button is disabled.

* For more information on user roles, see Manage user roles.

##### Important

* Cortex XSIAM enforces retention on all log-type datasets excluding Host Inventory, Vulnerability Assessment, Metrics, and Users.

* This column is updated once a day. Therefore, if the dataset was created or updated by the target or lookup flows, it's possible that the Last Updated value is a day behind when the queries or reports were run as it was before this column was updated.

  11.4.1. What are datasets?

##### Note

* For more information on tasks specific to lookup datasets, see Lookup datasets.

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

##### Important

* By default, forensic datasets are not included in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  11.4.2. Lookup datasets

##### Note

* A lookup dataset can only be deleted if there are no other dependencies. For example, if a Correlation Rule is based on a lookup dataset, you wouldn't be able to delete the lookup dataset until you removed the dataset from the XQL query of the Correlation Rule.

  11.4.2.1. Import a lookup dataset

##### Prerequisite

* When uploading a CSV, TSV, or JSON file, ensure that the file meets the following requirements: The maximum size for the total data to be imported into a lookup dataset is 30 MB from the Dataset Management page. Otherwise, the limit is 50 MB using Cortex Query Language (XQL) or APIs. Field names can contain characters from different languages, special...

##### Important

* The name of a dataset created from a TSV file must always include the extension. For example, if the original file name is mrkdptusrsnov23.tsv, you can save the dataset with the name marketing_dept_users_Nov_2023.tsv.

  11.4.2.2. Download JSON file of lookup dataset

##### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  11.4.2.3. Set time to live for lookup datasets

##### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  11.4.3. Monitor datasets and dataset views activity

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  11.5. Archived data

  11.5.1. Import historical data into cold storage

##### License Type

  Importing historical data into cold storage requires a Period-Based Retention - Cold Storage add-on license.

##### Prerequisite

* Importing historical data into cold storage requires a View/Edit RBAC permission for Data Management (under Configurations).

  11.5.2. Building XQL archived data queries

##### Prerequisite

* Archived cold storage, in addition to a Period-Based Retention - Cold Storage add-on license, requires compute units (CU) to run archived cold storage queries. Cortex XSIAM provides a free daily quota of compute units (CU) allocated according to your license size. Queries run without enough quota will fail. To expand your investigation capabilities,...

  11.5.3. Success and failure code responses to your HTTP POST requests

  11.6. Parsing Rules

  11.6.1. What are Parsing Rules?

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

  11.6.2. Parsing Rules editor views

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

  11.6.3. Parsing Rules file structure and syntax

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Cortex XQL Language Reference.

* An inner type of join stage is only supported in CONST, INGEST, and RULE sections and is not supported in a COLLECT section. You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

* The regexcapture function is only supported in Parsing Rules and cannot be used in any other XQL query.

* Every statement in the Parsing Rules file must end with a semicolon (;).

  11.6.3.1. INGEST

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* You can't add tags to parsing rules using the Next-Generation Firewall (NGFW) datasets that are in the format panw_ngfw_<text>_raw, and the Observability dataset called panw_observability_raw.

  11.6.3.2. COLLECT

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

##### Note

* The CSV Collector applet is not affected by the COLLECT rules applied to a Broker VM.

##### Tip

* To reduce the amount of data transmitted to Cortex XSIAM from the broker, use filters to drop logs. Yet, be aware that once the logs are modified using alter or fields stages, the Broker VM will convert the original log into a JSON format, which could increase the data size being sent from the broker to Cortex XSIAM.

  11.6.3.3. CONST

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

##### Note

* The dollar sign ($) must be adjacent to the [CONST] name, without any whitespace in between.

##### Important

* Only quoted or integer terminal values are considered valid for CONST sections.

  11.6.3.4. RULE

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Get started with XQL.

* You can also add tags using only the INGEST section. For more information, see INGEST.

  11.6.3.5. EXTEND

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Get started with XQL.

  11.6.4. Create Parsing Rules

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* You need Cortex XSIAM administrator or Instance Administrator permissions to access the Simulate view and perform these tests.

  11.6.5. Troubleshooting Parsing rules errors

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* Some errors can only be found after the applicable logs are collected in Cortex XSIAM.

  11.6.6. Parsing Rules Raw Dataset

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

  11.7. Data Model Rules

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

  11.7.1. What are Data Model Rules?

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

  11.7.2. Data Model Rules editor views

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

  11.7.3. Data Model Rules file structure and syntax

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

* For more information on XQL syntax, see the XQL Language Reference Guide.

* You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

  11.7.3.1. MODEL

##### Note

* The Settings → Configurations → XQL Configuration → Case Sensitivity (case_sensitive) setting can overwrite this case_sensitive configuration for all fields in the application except for BIOCs, which will remain case insensitive no matter what this setting is set to. For more information on this setting, see XQL Configuration.

* We recommend that you do not configure the same data source in both Marketplace and using a Cortex XSIAM data collector. Yet, if you do, the following will happen: For network data, all relevant logs from the different data sources are stitched to the same network story. For authentication data, all relevant logs from the different data sources are...

  11.7.3.2. RULE

##### Note

* For more information on the XQL syntax, see the XQL Language Reference Guide.

  11.7.3.3. Field structure

##### Note

* For more information on these data model fields, see Cortex XSIAM Data Model Schema.

  11.7.4. How to map authentication story events?

##### Prerequisite

* Familiarize yourself with the Cortex Data model (XDM) schema for field definitions and naming conventions, see Cortex XSIAM Data Model Schema.

##### Important

* This Feature focuses on authentication events related to SSO (Single Sign-On) and SaaS (Software-as-a-Service) application authentications. It does not cover internal authentication mechanisms such as Kerberos, NTLM, or traditional domain logon events generated by on-premise infrastructure.

* To maximize the variety of issues that are retrieved based on the XDM authentication stories, we recommend that the following additional fields are populated: xdm.target.resource_name, xdm.logon.type, xdm.source.user_agent, and xdm.source.host.device_category. Should you decide to change the default XDM mappings, ensure that both the mandatory and...

  11.7.5. Create Data Model Rules

##### Prerequisite

* Data Model Rules editor views Data Model Rules file structure and syntax How to map authentication story events?

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → Data Management → Data Model Rules

  11.7.6. Troubleshooting Data Model Rules

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

* Since this dataset also contains Parsing Rules errors, some of the fields are irrelevant for Data Model Rules and aren't included in the table.

##### Tip

* To ensure you and your colleagues stay informed about Data Model Rules activity, you can also Configure notification forwarding to forward your Data Model Rules audit logs to an email distribution list or Syslog server. For more information about the Data Model Rules audit logs, see Monitor Data Model Rules activity.

  11.7.7. Using data enrichment

##### Note

* For a complete list of auto-enriched fields, see the Cortex Data Model Schema Guide.

##### Important

* When manually mapping ASN fields that are enriched, such as xdm.source.asn.as_number, with other ISP and domain fields that are not enriched, such as xdm.source.asn.isp and xdm.source.asn.domain, it's possible to receive incorrect XDM query results due to the misalignment between the overridden enrichement and system enrichment fields.

  11.7.8. Data Model Rules notifications

  11.7.9. Monitor Data Model Rules activity

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  11.8. Manage Event Forwarding

##### License Type

  This feature requires an Event Forwarding add-on license. Only Administrators have access to this screen.

##### Important

* Since data is aggregated and compressed, it can take up to two hours until the data is available in the forwarding bucket.

##### Navigation

  Under Settings → Configurations → Data Management → Event Forwarding, activate the licenses in the Activation section

  11.8.1. Endpoints Event Forwarding - included/excluded fields by event type

##### License Type

  This feature requires an Event Forwarding add-on license. Only Administrators have access to this screen.

  11.9. Manage compute units

##### Note

* For more information, see Import historical data into cold storage.

* The CU consumption of cold storage queries is based on the number of days in the query time frame. For example, when querying 1 hour of a specific day, the CU of querying this entire day is consumed. When querying 1 hour that extends past 2 days, such as from 23:50 to 00:50 of the following day, the CU of querying these two days is consumed.

  11.9.1. Compute units usage

##### Note

* To enable the add-on, select Settings  → Configurations → Cortex XSIAM License → Addons tile, and select the Compute Unit tile and Enable.

##### Navigation

  Settings → Configurations → Data Management → Compute Unit Usage

12. Marketplace

  12.1. Cortex Marketplace

  12.2. Content packs

##### Note

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

  12.3. Content Pack Support Types

##### Note

* Palo Alto Networks is not liable for and does not warrant or support any content pack produced by a third-party publisher. Palo Alto Networks does not support content packs that do not have official available documentation.

  12.4. Cortex XSIAM content

  12.5. Manage content packs

##### Note

* Optional content packs that are already installed are treated like they are required content packs to preserve content integrity.

* In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as scripts or integrations.

* Third-party product Integrations are developed and tested against a specific product version. For products that are on-prem or cloud-based with specific API versions, the version developed and tested against will be included in the integration's documentation. Newer versions of the product are not always immediately tested, and it is expected that...

##### Caution

* If another content pack is dependent on the content pack you want to delete, it may break the other content pack. You can reinstall the content pack, but you cannot restore detached and customized content.

* If you want to downgrade, any content that depends on the content pack including any customizations may be deleted if it does not exist in the target content pack version.

  12.6. Marketplace FAQs

  12.7. Content changes when upgrading Cortex XSIAM versions

  12.8. Content pack contributions

13. Cortex XSIAM XQL

  13.1. Get started with XQL

  13.1.1. XQL language features

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

##### Navigation

  You submit XQL queries to Cortex XSIAM using the Investigation & Response → Search → Query Builder user interface

  13.1.2. XQL Language Structure

  13.1.2.1. Adding comments in queries

  13.1.3. Supported operators

##### Note

* In some cases, using an IN or NOT IN operator combined with a dataset and filter stage can be a better alternative to using a join stage.

  13.1.4. Datasets and presets

##### Note

* To set up this Cloud Identity Engine (previously called Directory Sync Service (DSS)) dataset, you need to set up a Cloud Identity Engine. Otherwise, you will not have a pan_dss_raw dataset. For more information, see Set up Cloud Identity Engine.

* INFO issues are not included in this dataset. This dataset includes issues from the Security and Health domains. For more information, see Overview of the Issues page.

* The fields contained in this dataset are a subset of the fields in the xdr_data dataset.

* If the vendor and product are not specified in the Winlogbeat profile's configuration file, Cortex XSIAM creates a default dataset called microsoft_windows_raw.

* To ensure GlobalProtect access authentication logs are sent to Cortex XSIAM, verify that your PANW firewall's Log Settings for GlobalProtect has the Cortex Data Lake checkbox selected.

* You must have the Cortex XSIAM Threat Intel Management (TIM) Add-on to use this dataset.

* You can query in XQL for this data and build widgets based on the xdr_data dataset or using the preset device_control. To view in an XQL query these events, the Device Configuration of the endpoint profile must be set to Block. Otherwise, the USB events are not captured. The events are also captured when a group of device types are blocked on the...

##### Important

* This dataset will not be updated after June 2024. Use the health_alerts dataset instead.

  13.1.5. About examples

##### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

  13.1.6. JSON functions

##### Important

* JSON field names are case sensitive, so the key to field pairing must be identical in an XQL query for results to be found. For example, if a field value is "TIMESTAMP" and your query is defined to look for "timestamp", no results will be found.

  13.1.7. How to filter for empty values in the results table

  13.1.8. Understanding string manipulation in XQL

  13.2. Build XQL queries

  13.2.1. About the Query Builder

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

  13.2.2. How to build XQL queries

##### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

##### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  13.2.2.1. Get started with XQL queries

##### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

  13.2.2.2. Useful XQL user interface features

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

  13.2.2.3. XQL Query best practices

  13.2.2.4. Expected results when querying fields

  13.2.2.5. Create XQL query

##### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

  13.2.2.6. Review XQL query results

##### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* In order for Cortex XSIAM to provide a histogram for a field, the field must not contain an array or a JSON object.

  13.2.2.7. Translate to XQL

##### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

  13.2.2.8. Graph query results

##### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

  13.2.3. Query Builder templates

##### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

  13.2.3.1. Get started with Query Builder templates

  13.2.3.2. Considerations for using Query Builder templates

  13.2.3.3. Create a query from a template

##### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

  13.2.3.4. Run a free text query

##### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

  13.2.3.5. Query Builder template examples

##### Navigation

  Investigation & Response → Search → Query Builder

  13.2.4. Edit and run queries in Query Center

##### Navigation

  Investigation & Response → Search → Query Center

  13.2.4.1. Query Center reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  13.2.5. Manage scheduled queries

##### Navigation

  Investigation & Response → Search → Scheduled Queries

  13.2.5.1. Scheduled Queries reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  13.2.6. Manage your personal query library

##### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

  13.2.7. Legacy Query Builder

##### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

  13.2.7.1. Create authentication query

##### Navigation

  Investigation & Response → Search → Query Builder

  13.2.7.2. Create event log query

##### Navigation

  Investigation & Response → Search → Query Builder

  13.2.7.3. Create file query

##### Navigation

  Investigation & Response → Search → Query Builder

  13.2.7.4. Create image load query

##### Navigation

  Investigation & Response → Search → Query Builder

  13.2.7.5. Create network connections query

##### Navigation

  Investigation & Response → Search → Query Builder

  13.2.7.6. Create network query

##### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

  13.2.7.7. Create process query

##### Navigation

  Investigation & Response → Search → Query Builder

  13.2.7.8. Create registry query

##### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

  13.2.7.9. Query across all entities

##### Navigation

  Investigation & Response → Search → Query Builder

  13.3. Stages

  13.4. Functions

14. Graph Search

  14.1. What is Graph Search?

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Note

* Graph Search is a Beta feature and is still subject to changes. To enable the feature in your tenant, contact your Customer Support Team.

  14.2. Get started with Graph Search queries

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Navigation

  Understand your assets and findings data: Graph Search queries are based on the current data that has been collected for assets and findings from the data sources configured and then sent to the Unified Asset Inventory (UAI), which is displayed in the All Assets page (Inventory → Assets → All Assets

  14.3. How to build Graph Search queries?

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Navigation

  You submit Graph Search queries using the Investigation & Response → Search → Query Builder → Graph Search built-in query interface

  14.4. Understand Graph Search query results

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  14.5. Create Graph Search query

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Note

* For more information about the Query Library, see Manage Graph Search Query Library.

##### Tip

* After running the query, you can view the complete query by hovering over the last THAT... in the Graph Search query interface, and the query is displayed in a tooltip. If your query doesn't find any results or you want to change your query for any reason, you can always click anywhere in the Graph Search query interface, where your existing query is...

  14.6. Graph Search examples

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  14.7. Manage Graph Search Query Library

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Navigation

  From Graph Search in the Query Builder Select Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Center

  14.8. Edit and run queries in Query Center

##### Navigation

  Investigation & Response → Search → Query Center

  14.8.1. Query Center reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  14.9. Supported assets and findings

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  14.10. FAQ on Beta Graph Search feature

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

15. Cortex CLI

##### Note

* The CLI Read Only Role is not supported for CWP as the system does not support offline mode.

  15.1. Connect Cortex CLI

##### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

##### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Application Security, refer to Cortex CLI usage for Application Security

##### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

  15.2. Cortex CLI common command line reference guide

##### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

  15.3. Cortex CLI for Cloud Workload Protection

##### Prerequisite

* Ensure you have the required user permissions. Refer to Cortex CLI for more information Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more information Verify that Java version 11 and above is installed: Run java -version in your terminal. If not, refer to Java SE Development Kit 11.0.25 for information about installing Java

* Before you begin, ensure you have sudo privileges to execute the image scan.

##### Note

* The output contains the number of created issues for malware, secrets, and vulnerabilities, organized by severity, based on the current policy configuration.

  15.3.1. Cloud Workload Protection command line reference

  15.4. Cortex CLI for API Security

##### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more information Ensure your application exposes APIs and provides a corresponding OpenAPI Specification file Ensure that you have installed Java v 11 and above

  15.4.1. Cortex CLI API Security command line reference guide

  15.5. Cortex CLI for Application Security

##### Prerequisite

* For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

  15.5.1. Cortex CLI usage for Application Security

  15.5.2. Cortex CLI Application Security command line reference

##### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

##### Important

* The Cortex CLI Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id <YOUR_AUTH_ID>...

  15.5.3. CLI pipeline code snippets

  15.6. Migrate Cortex CLI

##### Prerequisite

* Before you begin, ensure you have the following: Ensure you have an active API key for your Cortex Cloud tenant with associated CLI role permissions. Refer to Manage API keys for more information Install the Cortex CLI. You can find the installation instructions here

16. Multi-Tenant

  16.1. What is Cortex XSIAM multi-tenant?

##### Note

* By default, multi-tenant licenses include one child tenant.

  16.1.1. MSSP multi-tenant

  16.1.2. Enterprise multi-tenant

  16.2. Multi-tenant central licensing management

##### Note

* In MSSP or enterprise multi-tenant, the license specifies the maximum number of child tenants that can be created. Once this limit is reached, no additional tenants can be created, even if there remains allocation for endpoints or GBs.

  16.3. Onboard Cortex multi-tenant

  16.3.1. Onboarding checklist for multi-tenant central licensing deployments

  16.3.1.1. Step 1. Activate Cortex XSIAM (main account)

##### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

  16.3.1.2. Step 2. Create a child tenant

##### Note

* The main account is labeled in Cortex Gateway, but child tenants are not labeled. Cortex enables parent-child pairing between tenants located in different geographical regions. To enable this capability, contact your support team. To create a child tenant, ensure that you have Account Admin permissions.

* After activating a child tenant, you can't change the child tenant's name.

* This is a public FQDN, so be careful with sensitive information such as the company name. After activating a child tenant, you can only change the child tenant subdomain once.

* Ensure that you meet the minimum requirements for child tenant allocation.

* If you reach your limit for child tenants, depending on your license, you may be able to create more tenants. You may be charged for additional tenants. Contact Customer Support if you are approaching your authorized limit.

  16.3.2. Onboarding checklist for multi-tenant customer-owned license deployments

  16.3.2.1. Step 1. Activate Cortex Cortex XSIAM (parent and child tenants)

##### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

  16.3.2.2. Step 2. Define access configurations and role permissions

  16.3.2.3. Step 3. Pair a parent tenant with child tenant

##### Note

* This field is not enabled by default. To enable this, contact your support team.

  16.4. Dynamic license allocation

##### Note

* Changing the tenant's allocations might result in a short downtime of your tenant.

* After activating a child tenant, you can't change the child tenant's name.

* This is a public FQDN, so be careful with sensitive information such as the company name. After activating a child tenant, you can only change the child tenant subdomain once.

* Ensure that you meet the minimum requirements for child tenant allocation.

* If you reach your limit for child tenants, depending on your license, you may be able to create more tenants. You may be charged for additional tenants. Contact Customer Support if you are approaching your authorized limit.

* In a multi-tenant central licensing management environment, you cannot unpair a child tenant from the main account. The only way to remove the connection to the main account is to delete the tenant.

  16.5. Child tenant management

  16.5.1. Manage a child tenant

##### Note

* Once a configuration is created Cortex XSIAM resets the child tenant data and synchronizes the security actions configured in the parent tenant.

  16.5.2. Track your tenant management

##### Note

* This field is not enabled by default. To enable, contact your account administrator.

##### Navigation

  To view child tenant details, in Cortex XSIAM, select Settings → Configurations → Tenant Management

  16.5.3. Investigate child tenant data

  16.5.4. Create and allocate configurations

##### Note

* You can configure Profiles only as Managed or Unmanaged. All profiles you create are automatically cloned to your child tenants.

  16.5.5. Create a security managed action

##### Note

* Profiles you create are automatically cloned to your child tenants.

  16.6. About managed threat hunting

  16.6.1. Set up Managed Threat Hunting

##### Navigation

  Settings → Configurations → Managed Services

  16.6.2. Investigate Managed Threat Hunting reports

##### Note

* The MTH page is available for users with the Managed Threat Hunting license and have the necessary permission to view and triage alerts and incidents in Cortex XSIAM.

17. Reference

  17.1. Cloud service provider permissions

  17.1.1. Amazon Web Services provider permissions

  17.1.2. Google Cloud Platform provider permissions

  17.1.3. Microsoft Azure provider permissions

  17.2. Microsoft Windows security auditing setup

  17.2.1. Enable security auditing event IDs

##### Note

* We recommend you configure security auditing using Group Policy Object (GPO). Using GPO simplifies audit management and ensures that auditing settings are uniformly applied across your network, reducing the risk of misconfigurations on individual machines.

  17.2.1.1. Enable security auditing event IDs with GPO

##### Note

* We recommend that you configure the Group Policy Object (GPO) to apply to all endpoints and not just Domain Controllers. This ensures comprehensive auditing across your entire network.

##### Navigation

  Server Manager → Tools → Group Policy Management

  Computer Configuration → Policies → Windows Settings → Security Settings → Advanced Audit Policy Configuration → Audit Policies

  17.2.1.2. Set up local machine security auditing without GPO

  17.2.1.3. Additional setup for Active Directory Certificate Services (ADCS) events

##### Note

* Enabling auditing for Active Directory Certificate Services (ADCS) restarts (events 4880 and 4881) can significantly slow down the service if you have a large database. To prevent delays: Clean up the database: Remove any unnecessary entries to reduce its size. Skip this audit: If restart speed is critical, consider not enabling auditing for ADCS...

  17.2.1.4. Enable auditing access to AD domain objects - 4662

##### Note

* The Descendant msDS-DelegatedManagedServiceAccount Objects configuration is relevant only for Windows Server 2025.

  17.2.2. Enable additional event logs using Event Viewer

##### Navigation

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → User Profile Service, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → CAPI2, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → DNS Client Events, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → DriverFrameworks-UserMode, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → PowerShell, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → Windows Defender, right click Operational and select Enable Log

  In Event viewer → Application and Services Logs → Microsoft → Windows → TerminalServices-ClientActiveXCore → Microsoft-Windows-TerminalServices-RDPClient, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → Windows Firewall With Advanced Security → Firewall, right click Operational and select Enable Log

  17.2.3. Enable LDAP server events logging (1644)

  17.2.3.1. Enable LDAP server events logging using RegEdit

  17.2.3.2. Enable LDAP server events logging using GPO

##### Navigation

  Computer Configuration → Preferences → Windows Settings → Registry

  17.2.3.3. Validate log collection for LDAP Server events

  17.3. XDM fields for mapping authentication events

##### Note

* For more information on the entire Cortex Data model (XDM) schema, see Cortex XSIAM Data Model Schema.

* Do not map a static string, list, or empty string. You must map this field from the raw log field that best represents the actual source IP used in the authentication attempt. In cases where multiple IP fields are available, such as client_ip, source_ip, and original_client_ip, choose the field that captures the IP address from which the user initially...

* Mapping should be done per event type. The same system could be an IDP in one event and an SP in another.

* For more information on the event outcome constants in the Cortex Data Model, see XDM_CONST.OUTCOME.

* Outcome is based on a conclusive event type reflecting the true end state of the authentication flow.Critical for effectiveness of detection rules. Incorrect derivation can lead to missed detections or false positives.

* These are the most common values, but other logon types also exist. For a complete list, see XDM_CONST.LOGON_TYPE.

* For more information, see XDM_CONST.USER_TYPE.

* For more information, see XDM_CONST.PRIVILEGE_LEVEL.

* For more information, see XDM_CONST.OS_FAMILY.

* While xdm.network.session_id aggregates multiple user actions within a broader session window. xdm.session.context.id is used to correlate events that belong to a single authentication request or transaction.


## Cortex XSIAM Enterprise Documentation


---

## 1. Get started with Cortex XSIAM

### 1.1. Get started with Cortex XSIAM

#### 1.1.1. Cortex XSIAM architecture

##### Note

* You can host your Cortex Native Data Lake instance in either the United States (US) Region or the European Union (EU) Region.

* You can host your Directory Sync Service instance in either the US Region or EU Region.

### 1.2. Fair Usage policy for Cortex XSIAM

### 1.3. Cortex XSIAM product licenses

#### Note

* You can upgrade your license by purchasing add-ons or moving to a different XSIAM license.

#### 1.3.1. Data retention

#### 1.3.2. Data storage lifecycle

##### Tip

* You can view details about your Cortex XSIAM licenses by selecting Settings → Cortex XSIAM License.

#### 1.3.3. License allocation

##### Note

* It can take up to an hour for Cortex XSIAM to display revived endpoints.

#### 1.3.4. License expiration

#### 1.3.5. Upgrade your tenant

### 1.4. Security Operations Center roles and responsibilities

### 1.5. In-product support case creation

#### Note

* When opening a support case through the Customer Support Portal, you need to manually select Cortex XSIAM as the product. While there may be discrepancies between the categories in this wizard and the Customer Support Portal process, that's because this wizard is designed specifically to focus on options relevant to Cortex XSIAM.

* Selecting an endpoint from the endpoint table and retrieving TSF requires full Retrieve Endpoint Data permissions under Endpoint Administration.

* Console recordings cannot exceed 10 minutes. The current recording time is displayed at the top of the window.

### 1.6. Supported web browsers

### 1.7. Use the interface

#### Note

* Each SAML login session is valid for 8 hours. Some menu items only appear if you have the relevant license.

* CMD fields have a 128-character limit. Shorten longer query strings to 127 characters and add an asterisk (*).

* Deleting a shared view removes it for all users.

### 1.8. What is Cortex Gateway?

## 2. Onboard and configure Cortex XSIAM

### 2.1. Deployment steps

#### 2.1.1. Plan and prepare

#### 2.1.2. Cortex XSIAM onboarding checklist

##### Prerequisite

* Cloud Identity Engine must be set up.

##### Note

* Data collection for Windows endpoints is available with Traps 6.0 and later releases and on endpoints running Windows 7 SP1 and later releases. Data collection on macOS and Linux endpoints are available with Traps 6.1 and later releases.

#### 2.1.3. Activate Cortex XSIAM

##### Prerequisite

* The Cortex XSIAM activation email. A Customer Support Portal (CSP) account. You need to set up your CSP account. For more information, see How to Create Your CSP User Account. When you create a CSP account, you can set up two-factor authentication (2FA) to log into the CSP by using an Email, Okta Verify, or Google Authenticator (non-FedRAMP accounts)....

##### Note

* When you activate, a production tenant is first activated. After activation, you can set up a development tenant (subject to your license).

* Activation can take about an hour and does not require you to remain on the activation page. Cortex XSIAM sends a notification to your email when the process is complete.

* If you want to change your tenant's name, the subdomain, or activate a development tenant (subject to license), on the right-hand side, click the ellipsis. You can only change the subdomain once, and it cannot be undone. After deleting the subdomain, you can reuse it after 7 days.

##### 2.1.3.1. Bring your own keys

###### Prerequisite

* Access to BYOK (Bring Your Own Keys) functionality is restricted to tenants that were initially activated with BYOK.

* To disable your encryption keys and deactivate a tenant, you must have an Account Admin role.

###### Note

* The new keys you import will serve as primary encryption keys for newly generated data.

* At any stage, you can select Continue Later to pause the process. To resume the process, in the Cortex gateway, select Continue Setup next to the tenant, and follow the wizard instructions from the point you left off, as detailed below. If you don't use either of your wrapping keys within three days, they expire and you'll have to restart the process.

* BYOK requires a 32-byte, symmetric, unencoded key in binary format.

###### Caution

* Disabling all encryption keys and deactivating the tenant renders the tenant inaccessible and non-operational. Disabling the keys affects the communication with the agents, may prevent the agents from receiving updates to policies, configurations, and crucial information, and may result in loss of data. To secure your tenant data and to prevent...

##### 2.1.3.2. Cortex XSIAM supported regions

##### 2.1.3.3. Enable access to required PANW resources

###### Note

* <tenant-name> refers to the selected subdomain of your Cortex XSIAM tenant, and <region> is the region in which your tenant is deployed. For more information, see Cortex XSIAM supported regions.

#### 2.1.4. Set up users and roles

##### Note

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* The user who activated the Cortex product is assigned the Account Admin role. You cannot create additional Account Admin roles in the Cortex XSIAM tenant. If you do not want the user to have Account Admin permission, you must remove the Account Admin role in Cortex Gateway.

##### 2.1.4.1. User group management

###### Note

* You can create user groups in the tenant or Cortex Gateway. User groups created in Cortex Gateway cannot be mapped to SAML groups. Only user groups created in the tenant support SAML group mapping and scoring. We recommend creating user groups in the Cortex tenant because: User groups are available for all tenants, and you may want different user...

* If users have been created in the CSP, but you want them to access the tenant through SSO only, skip this field and add only SAML group mapping after SSO is set up, otherwise, users can access the tenant through both the CSP and SSO. If you have not yet created any users, skip this field and add them later. See Set up authentication .

* When using Azure AD for SSO, the SAML group mapping needs to be provided using the group object ID (GUID) and not the group name.

###### Important

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

##### 2.1.4.2. Assign user roles and groups

###### Note

* If an existing user in the Cortex Gateway no longer has a role or a user group assigned, the user is revoked. Any roles, user groups, or egress configurations created by that user are shown as created by Revoked user instead of the user's email address.

###### Important

* Setting Cortex Query Language (XQL) dataset access permissions for a user role can only be performed from Cortex XSIAM Access Management. For more information, see Manage user roles.

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit Users Permissions.

#### 2.1.5. Set up authentication

##### Tip

* You should have at least one user in the Customer Support Portal for backup, in case of any authentication issues with your IdP provider.

##### 2.1.5.1. Authenticate users through the Customer Support Portal

###### Note

* You must be assigned the Super User role in the Customer Support Portal to add users in the Customer Support Portal. The first Super User who logs into Cortex Gateway is automatically assigned the Account Admin role and has access to the tenant. The user who activates the Cortex XSIAM tenant will also be assigned the Account Admin role (if there is no...

* After users are added to the Customer Support Portal and they accept the invitation, you can manage them in Cortex Gateway or the Cortex XSIAM tenant.

##### 2.1.5.2. Authenticate users using SSO

###### Note

* To set up SSO authentication in the tenant, you must be assigned an Instance Administrator or Account Admin role. SAML 2.0 users must log in to Cortex XSIAM using the FQDN (full URL) of the tenant. To allow login directly from the IdP to , you must set the relay state on the IdP to the FQDN of the tenant. If you have multiple tenants, you must set up...

* The first SSO cannot be deleted, it can only be deactivated by toggling SSO Enabled to off. The Domain parameter is predefined for the first SSO. If you add additional SSO providers, you must provide the email Domain in the SSO Integration settings for all providers except the first. Cortex XSIAM uses this domain to determine to which identity provider...

* Cortex XSIAM requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex XSIAM. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a...

##### 2.1.5.3. Set up Okta as the Identity Provider Using SAML 2.0

###### Note

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Navigation

  Settings → Configurations → Access Management → Authentication Settings

  Settings → Configurations → Access Management → User Groups

##### 2.1.5.4. Set up Azure AD as the Identity Provider Using SAML 2.0

###### Note

* The default attributes shown on the main single sign-on page in Azure AD are not the values you need. You must click Edit next to Attributes and Claims to view and copy the actual values.

* The attribute claim name must exactly match the value sent by your IdP. In some cases, this may be the full attribute name/namespace, depending on the configuration of our IdP

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Important

* When copying the Single Sign-On URL value, remove idp/saml and leave the trailing /. For example, if the Single Sign-On URL is https://clientname.panproduct.region.paloaltonetworks.com/idp/saml, just copy https://clientname.panproduct.region.paloaltonetworks.com/.

###### Navigation

  Settings → Configurations → Access Management → User Groups

#### 2.1.6. Pre-installation steps for Cortex XDR agents

##### 2.1.6.1. Define endpoint groups

###### Note

* Disconnecting Cloud Identity Engine in your Cortex XSIAM deployment can affect existing endpoint groups and policy rules based on Active Directory properties.

##### 2.1.6.2. Manage endpoint profiles

##### 2.1.6.3. Endpoint data collection

###### Note

* For specific files only and only if the file was written.

###### Important

* Registry key is collected as a real key name, and not as a symbolic link. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, KEY_LOCAL_MACHINE\System\ControlSet001 will be collected. Instead of HKEY_CURRENT_USER, HKEY_USERS\<SID> will be collected, where SID is a SID of the current user.

##### 2.1.6.4. Configure global agent settings

###### Note

* Disabling this capability takes immediate effect on new hashes, fresh agent installations, and existing security policies. It could take up to a week to take effect on existing agents in your environment pending agent caching.

* If you have any Cortex XSIAM filters, starring policies, exclusion policies, scoring rules, log forwarding queries, or automation rules configured for XSOAR/3rd party SIEM, we advise you to update those to support the changes before activating the feature. For example, change the query to include the previous description that is still available in the...

#### 2.1.7. Install Cortex XDR agents

##### 2.1.7.1. Plan your agent deployment

##### 2.1.7.2. Guidelines for keeping Cortex XDR agents and content updated

###### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups. See how to define endpoint group.

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups.

###### Important

* When planning Cortex XDR agent upgrades and content updates, consult with the appropriate stakeholders and teams and follow the change management strategy in your organization.

###### Caution

* Before enabling Auto-Update for Cortex XDR agents, make sure to consult with all relevant stakeholders in your organization.

##### 2.1.7.3. Create an agent installation package

###### Note

* The profile will be applied if the security policy cannot be retrieved in real-time.

* The Cortex serverless library must be imported after other libraries to activate the hooks that enable auditing.

##### 2.1.7.4. Deploy agent installation packages

#### 2.1.8. Configure and deploy Cortex XSIAM

##### 2.1.8.1. Cortex XSIAM - Analytics

###### Prerequisite

* Before Cortex XSIAM - Analytics can start to analyze your endpoint data, perform the following steps: Configure Cortex XSIAM network parameters to monitor your internal networks. Enable the Analytics Engine. Make sure Cloud Identity Engine is set up. Enable Identity Analytics.

###### 2.1.8.1.1. Configure Cortex XSIAM network parameters

####### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

####### Navigation

  Inventory → Assets → Network Configuration → Internal Domain Suffixes

###### 2.1.8.1.2. Enable the Analytics Engine and Identity Analytics

####### Prerequisite

* Analytics Engine To create a baseline for enabling analytics, Cortex XSIAM requires a minimum of one of the following data sets: EDR or Network logs from at least 30 endpoints over a minimum of 2 weeks Cloud audit logs over a minimum of 5 days Identity Analytics Cortex XSIAM - Analytics must be activated. Cloud Identity Engine must be set up. For more...

####### Navigation

  Settings → Configurations → Cortex XSIAM - Analytics

##### 2.1.8.2. Cortex XSIAM engines

###### 2.1.8.2.1. Engine requirements

####### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

###### 2.1.8.2.2. Install an engine

####### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex XSIAM engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

####### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

####### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

##### 2.1.8.3. Set up Cloud Identity Engine

###### Note

* The Activate risk signal sharing to CIE checkbox is available only after the second step is completed.

###### Navigation

  Settings → Configuration → Integrations → Cloud Identity Engine

#### 2.1.9. Define data sources

##### Note

* Not all content packs are available to download on the Data Sources page. If you require content packs such as Phishing, and Malware, you need to download the pack from Marketplace and configure the integration. The Data Sources page is designed for third-party integrations to help you onboard.

* For some vendors, to receive data from an external source, you must first set up the Syslog Collector applet on a Broker VM within your network. For more information, see Activate Syslog Collector.

##### 2.1.9.1. Cortex XSIAM content

###### 2.1.9.1.1. Cortex Marketplace

###### 2.1.9.1.2. Content packs

####### Note

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

###### 2.1.9.1.3. Install content packs

####### Note

* Currently, not all content packs are supported in the Data Sources page. For example, content packs with several integrations are not yet supported.

* Content packs are also automatically installed when you adopt playbooks and configure tasks.

###### 2.1.9.1.4. Automation and feed integrations

####### Note

* Some integrations can be downloaded directly without having to initially download a content pack from Marketplace. For more information, see Define data sources. In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as...

* If the integration was installed from a content pack, you need to duplicate the integration before editing.

* If the integration was installed from a content pack, you need to duplicate the integration before downloading.

* Integration commands are only available when the integration instance is enabled. Some commands depend on a successful connection between Cortex XSIAM and third-party integrations.

####### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

####### 2.1.9.1.4.1. Manage API keys

######## Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

* You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

####### 2.1.9.1.4.2. Fetch issues from an integration instance

######## Note

* In some integrations, the Issue Fetch interval is called Feed Fetch Interval. If the integration instance does not have the Issue Fetch Interval field, you need to add this field by editing the integration settings. If the integration is from a content pack, you need to create a copy of the integration. Any future updates to this integration will not...

* Some content packs include preconfigured correlation rules, but you should review them to see if they suit your use case and duplicate them if required. Go to Threat Management → Detection Rules → Correlations, search for the relevant rule, right-click, and select Preview Rule. For example, the ServiceNow v2 Alerts (automatically generated)...

####### 2.1.9.1.4.3. Forward Requests to Long-Running Integrations

######## Note

* This integration replaces the External Dynamic list integration, which is deprecated. For more information about how to set up the integration, see Manage external dynamic lists.

* When running on the tenant, you can only use long-running integrations provided by Cortex XSIAM, you cannot create custom ones. Custom long-running integrations are supported only on engines at this time. Configuring custom certificates or private API Keys in the long-running integration instance is supported only on engines, not on the Cortex XSIAM...

* For the TAXII Server and TAXII2 Server integrations, the xdr string is automatically replaced by crtx. For the Microsoft Teams integration, you can use the microsoft-teams-create-messaging-endpoint command to get the correct messaging endpoint based on the server URL, the server version, and the instance configurations. For more information, see...

####### 2.1.9.1.4.4. Manage credentials

######## Navigation

  Settings → Configurations → Integrations → Credentials → New Credential

  Settings → Configurations → Data Collection → Automation & Feed Integrations and select the integration instance

####### 2.1.9.1.4.5. Integration use cases

####### 2.1.9.1.4.6. Troubleshoot Integrations

### 2.2. Post-deployment steps

#### 2.2.1. Perform health checks

##### 2.2.1.1. Monitor agent operational status in Cortex XSIAM

###### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex XSIAM management console for specific reasons for the state.

###### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

#### 2.2.2. Set up your environment

##### 2.2.2.1. Configure server settings

###### License Type

  Requires a Cortex XSIAM or Cortex XDR Pro license

###### Note

* Keyboard shortcuts, timezone, and timestamp format are not set universally and only apply to the user who sets them.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Requires the TIM add-on. By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled.

* Requires an MSSP License and RBAC permissions to Cases & Issues and Investigation & Response → Automation. This setting is available for the parent tenant only.

###### Navigation

  Settings → Configurations → General → Server Settings

##### 2.2.2.2. Configure security settings

###### Navigation

  Settings → Configurations → General → Security Settings

##### 2.2.2.3. Log forwarding

###### 2.2.2.3.1. Forward logs from Cortex XSIAM to external services

####### License Type

  Requires Cortex XDR per Endpoint

####### 2.2.2.3.1.1. Integrate a syslog receiver

######## Note

* Up to TLS 1.3 is supported. Make sure the self-signed CA includes your public key.

####### 2.2.2.3.1.2. Integrate Slack for outbound notifications

######## Note

* You are directed to the Slack browser to install Cortex XSIAM. You can only use this link to install Cortex XSIAM on Slack. Attempting to install from Slack Marketplace will redirect you to Cortex XSIAM documentation.

####### 2.2.2.3.1.3. Configure notification forwarding

######## Prerequisite

* Before you can select a syslog receiver or a Slack channel, you must integrate these external services with Cortex XSIAM. For more information, see: Integrate a syslog receiver Integrate Slack for outbound notifications

######## Note

* To configure notification forwarding for issues by domain, select Log Type = Issues and filter the Issues table by Issue Domain.

* This option will be deprecated in the next release. Configure issues with the filter Issue Domain = Health instead.

* When a notification is sent for each configured format.

####### 2.2.2.3.1.4. Monitor administrative activity

###### 2.2.2.3.2. Log notification formats

####### 2.2.2.3.2.1. Management audit log messages

####### 2.2.2.3.2.2. Issue notification format

####### 2.2.2.3.2.3. Agent Audit log notification format

####### 2.2.2.3.2.4. Management Audit log notification format

####### 2.2.2.3.2.5. Log format for IOC and BIOC issues

####### 2.2.2.3.2.6. Analytics log format

####### 2.2.2.3.2.7. Log formats

######## Note

* The FUTURE_USE tag applies to fields that Cortex XSIAM does not currently implement.

#### 2.2.3. Remote repository management

##### 2.2.3.1. Cortex XSIAM development tenant

###### Important

* Development tenants are not intended for performance checks; they cannot access production data, and they are connected to a limited number of endpoints. As a result, all development tenants have fewer resources than the production tenant, including data ingestion capacity and performance, and compute capabilities. In a development tenant, extreme...

##### 2.2.3.2. Set up a remote repository

###### Navigation

  If the content repository option is disabled for the production or development tenant (under Settings → Configurations → General → Remote Repository Settings, toggle the Content repository slider to off), the tenant becomes standalone and does not push or pull content

  If you are changing your remote repository settings, back up existing content to your local computer by navigating to Settings → Configurations → General → Server Settings → Custom Content and click Export all custom content

###### 2.2.3.2.1. Set up a built-in remote repository

####### Note

* Once enabled, development tenants have a red banner on the top left showing DEV.

* The first tenant that is enabled pushes its content to the remote repository first. For example, these instructions describe enabling the production tenant first, so the remote repository will initially contain production tenant content. You can enable a development tenant first if you want the remote repository to initially contain the content from...

####### Navigation

  Settings → Configurations → General → Remote Repository Settings and toggle the Content repository slider to enable the remote repository

###### 2.2.3.2.2. Set up a Private Remote Repository

####### Note

* Once enabled, the development push tenant has a red banner on the top left showing DEV.

* For repository vendors that use tokens, enter the token type in the username field and the token in the password field. Verify details with your vendor. If your private Git remote repository uses personal access tokens instead of usernames and passwords, enter the token type in the username field and the access token in the password field. For example,...

* You can't add an engine that has been added to a Load-Balancing Group.

* If your private Git remote repository uses personal access tokens instead of usernames and passwords, enter the access token in the password field and leave the username field blank. For repository vendors that use tokens, the token type is entered in the username field and the token is entered in the password field. Verify details with your vendor. If...

* The first tenant that is enabled pushes its content to the remote repository first. For example, these instructions describe enabling the production tenant first, so the remote repository will initially contain production tenant content. You can enable a development tenant first if you want the remote repository to initially contain the content from...

####### Tip

* Due to security concerns, there is a closed allow list of approved URLs for private repositories. If you want to use a URL that is excluded from the allow list, use an engine (engine groups are not supported).

##### 2.2.3.3. Push and pull content

###### Navigation

  Settings → Configurations → Remote Repository Content → User-Defined Content

##### 2.2.3.4. Remote repository troubleshooting

#### 2.2.4. Manage user roles and access management

##### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

##### Note

* For more information on assigning user roles when generating an API key, see Manage API keys.

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* For features where scoping is not applicable, Role-Based Access Control (RBAC) is used and can be configured when managing user roles. For more information, see Manage user roles.

##### 2.2.4.1. Manage user roles

###### Prerequisite

* Managing user roles in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Navigation

  Settings → Configurations → Access Management → Roles

##### 2.2.4.2. Manage user access

###### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Note

* You can only reduce the permissions of an Account Admin user via Cortex Gateway.

* User permissions for components and datasets are based on the access permissions set in the user role. For more information on editing these user role permissions, see Manage user roles.

###### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit User Permissions.

###### Navigation

  Settings → Configurations → Access Management → Users

###### 2.2.4.2.1. User access reference information

##### 2.2.4.3. Manage user scope

###### Prerequisite

* Configuring user scopes in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles. By default, Enable Scope Based Access Control is...

###### Note

* This configuration can impact the visibility of the related Security domain in the Cases and Issues scope area, but with not affect asset visibility.

* For Cases and Issues domains, a workaround is to create a Dataset View for each required combination of domains, and allow the relevant entity access only to this Dataset View, not to the underlying cases and issues datasets.

* Make sure to assign the required default granular scoping for users. This depends on the structure and divisions within your organization and the particular purpose of each organizational unit to which scoped users belong.

###### Important

* Some areas and features in Cortex XSIAM do not respect SBAC. In these cases, use RBAC permissions to restrict access.

* Before configuring, ensure that you review the Understand scoping section.

#### 2.2.5. Dashboards and reports

## 3. Endpoint security

### 3.1. Endpoint protection

#### 3.1.1. Malware protection

##### Note

* From Cortex XDR agent for Android version 9.0 and later, this module is deprecated.

#### 3.1.2. Exploit protection

#### 3.1.3. File analysis and protection flow

##### Note

* To enhance performance and efficiency, hash verdict requests from the Cortex XDR agent will be routed to the WildFire service with the lowest latency. File uploads for analysis will strictly adhere to the designated Cortex XSIAM and WildFire regions, ensuring data remains within the appropriate geographical boundaries.

#### 3.1.4. Endpoint protection capabilities

#### 3.1.5. Endpoint protection modules

#### 3.1.6. Processes protected by exploit security policy

#### 3.1.7. File Integrity Monitoring (FIM)

##### License Type

  FIM requires the Cortex Cloud Runtime Security add-on.

##### Note

* Google Kubernetes Engine (GKE) is currently not supported

* It is recommended to create a policy that targets only the necessary files and folders.

* Platform cannot be changed once a rule group has been created

* A rule group can contain up to 100 rules.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* It is possible to manage up to 15,000 events per day (24 hours) for each host/container.

##### Navigation

  Creating, modifying and viewing FIM rule groups and rules is be done in the Rule Groups page, located at the Inventory → Endpoints → File Integrity Monitoring menu

  In Inventory → Endpoints → Policy management → Extensions → Profiles, select +Add Profile and then select either Create New or Import from File

#### 3.1.8. WildFire analysis concepts

##### Note

* In cases when the Cortex XSIAM agent gets a failed status from the WF service due to a general error or unsupported file type, and the Local Analysis is set to disabled or not applicable, Cortex XSIAM will not generate an alert on the file.

#### 3.1.9. Guidelines for keeping Cortex XDR agents and content updated

##### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups. See how to define endpoint group.

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups.

##### Important

* When planning Cortex XDR agent upgrades and content updates, consult with the appropriate stakeholders and teams and follow the change management strategy in your organization.

##### Caution

* Before enabling Auto-Update for Cortex XDR agents, make sure to consult with all relevant stakeholders in your organization.

#### 3.1.10. About content updates

##### Note

* Cortex XSIAM delivers the content update to the agent in parts and not as a single file, allowing the agent to retrieve only the updates and additions it needs.

#### 3.1.11. Endpoint data collection

##### Note

* For specific files only and only if the file was written.

##### Important

* Registry key is collected as a real key name, and not as a symbolic link. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, KEY_LOCAL_MACHINE\System\ControlSet001 will be collected. Instead of HKEY_CURRENT_USER, HKEY_USERS\<SID> will be collected, where SID is a SID of the current user.

### 3.2. Install and manage endpoints

#### 3.2.1. Set up endpoint protection

##### 3.2.1.1. Set up endpoint profiles and exception rules

###### Note

* Profiles associated with one or more targets that are beyond the scope of your defined user permissions are locked, and cannot be edited.

###### 3.2.1.1.1. Set up malware prevention profiles

####### Note

* In this profile, the Report options configure the endpoints to report the corresponding suspicious files, actions, processes, or behaviors to Cortex XSIAM, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* As part of the anti-malware security flow, the Cortex XDR agent leverages the operating system's capability to identify revoked certificates for executables, and DLL files that attempt to run on the endpoint by accessing the Windows Certificate Revocation List (CRL). To allow the Cortex XDR agent access the CRL, you must enable internet access over...

* The Quarantine Malicious Executables feature is not available for malware identified on network drives.

* The Quarantine Malicious Script Files feature is not available for malware identified on network drives.

* If on-write actions were configured in earlier versions of Cortex XSIAM, the same configuration has been preserved and applied globally for all file types. On-write file protection may have an impact on the resources required by the Cortex XDR agent.

* On-demand file protection may have an impact on the resources required by the Cortex XDR agent.

* We recommend that you disable scheduled scanning. VDI machine scans are based on the golden image and additional files will be examined upon execution.

* When periodic scanning is enabled in your profile, the Cortex XDR agent initiates an initial scan when it is first installed on the endpoint, regardless of the periodic scanning scheduling time.

* When you are actively evaluating with BAS tools, it is recommended to enable the BAS mode setting only for the duration of your evaluation, and for a limited number of agents.

* BAS tools mode with content older than version 1850 cannot be configured, the agent will be treated as Enabled.

* The Quarantine Malicious Mach-O Files feature is not available for malware identified on network drives.

* This module is supported by Cortex XDR agent 8.1.0 and later releases.

* Enabling on-demand scanning will automatically scan these core system directories: /etc, /tmp, /home, /usr, /bin, /sbin, /lib, /var, /opt, /dev, /root, /boot.

* The Quarantine Malicious ELF Files feature is not available for malware identified on network drives.

* Blocking functionality is different for each security module. For SMS/MMS, Cortex XDR agent will move detected messages containing such URLs from unknown senders to the Junk folder.

* Ensure that the same numbers are not added multiple times with different leading zeros.

* To fully enable the Safari browser security module on the device side, each iOS device user must enable the Safari Safeguard module on the device, and grant it permission to work on all websites. If the iOS device user does not do this, the endpoint's operation status is reported as Partially Protected. The Safari browser security module will only...

* Cortex XDR agent version 8.4 or higher are required for this feature.

####### Warning

* For optimal user experience, we recommend that you set the action mode to either Allow or Run Local Analysis.

###### 3.2.1.1.2. Set up exploit prevention profiles

####### Note

* In this profile, the Report options configure the endpoints to report the corresponding exploit attempts to Cortex XSIAM, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* In exploit prevention profiles, if you change the action mode for processes, you must restart the protected processes for the following security modules to take effect on the process and its forked processes: Brute Force Protection Java Deserialization SO Hijacking

* This step provides a temporary workaround for the following publicly known information-security vulnerabilities and exposures: CVE-2021-24074, CVE-2021-24086 and CVE-2021-24094.

* If you have Windows endpoints in your network that are unpatched and exposed to a known vulnerability, we strongly recommend that you upgrade to the latest Windows Update that has a fix for that vulnerability.

####### Warning

* This workaround applies only to the specific Windows versions listed as exposed to these CVEs, and requires a Cortex XDR agent release 7.1 or later and content 167-51646 or later. This workaround is not recommended for non-persistent, stateless, or linked-clone environments. In some cases, enabling this workaround can affect the network functionality...

###### 3.2.1.1.3. Set up agent settings profiles

####### License Type

  Requires a Cortex XDR Pro per Endpoint license. When you enable this feature, a Cortex XDR Pro per Endpoint license is consumed.

  Requires Host Insights add-on.

  Requires Forensics Add-on.

####### Prerequisite

* User Space Agent mode requires Linux kernel 5.0.0 or higher.

####### Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

* You can enable the option to maintain a persistent notification regarding the disconnection of the endpoint from the network. The settings Persistent Isolation Notification and Blocked Connectivity Notification must be enabled. Until the threat on the endpoint has been removed, the endpoint remains disconnected from the network.

* In Traps 5.0.6 and later releases, when protection is enabled, access will be read-only. In earlier Traps releases, enabling protection disables all access to services, processes, files, and registry values.

* If you choose the Enable option, you must also enable XDR Agent Tampering Protection in the malware profile and set it to Block. Ensure that both profiles are assigned to the same endpoints.

* When you enable Cortex XDR agent registration with the Windows Security Center, Windows automatically shuts down Microsoft Defender on Windows-based workstation endpoints. If you still want to allow Microsoft Defender to run on a workstation endpoint where Cortex XSIAM is installed, you must use the Disable option. However, Palo Alto Networks does not...

* To enable access to these options, scroll down to Network Location Configuration, and set Action Mode to Enabled.

* When using Nmap, the Cortex XDR agent downloads an Nmap driver for the duration of the scan and removes the driver upon completion. If an Nmap scan is in process, Cortex XSIAM identifies the Nmap driver and places any additional scans in a queue.

* If you disable content updates for a newly installed agent, the agent retrieves the content for the first time from Cortex XSIAM, and then disables content updates on the endpoint. When you add a Cortex XDR agent to an endpoint group with a disabled content auto-upgrades policy, the policy is applied to the added agent as well.

* Automatic upgrades are not supported with non-persistent VDI and temporary sessions.

* Limitations in the content download process: When you install the Cortex XDR agent, the agent retrieves the latest content update version available. A freshly installed agent can take between five to ten minutes (depending on your network and content update settings) to retrieve the content for the first time. During this time, your endpoint is not...

* If the Cortex XDR agent is initially unable to communicate without the local store, enforcement is not enabled and the agent will show as partially protected.

* If you choose the Enabled option, you must also set Anti Tampering Protection in the malware security profile to Block, and ensure that both profiles are assigned to the same endpoints.

* Automatic upgrades are not supported for XDR agents running on K8s.

* User Space Agent mode requires Linux kernel 5.0.0 or higher. Endpoints running an older Linux kernel version with this fallback enabled, will not start using User Space Agent mode, and will operate asynchronously.

####### Warning

* If you disable or delay automatic-content updates provided by Palo Alto Networks, it may affect the security level in your organization.

###### 3.2.1.1.4. Set up restrictions prevention profiles

####### License Type

  A Threat Intel Management (TIM) license is required for this feature.

####### Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Configure custom BIOC prevention rules here: Detection & Threat Intel → Detection Rules → BIOC

* Configure this as follows: Prepare this restriction profile first, make a note of its name for later, and set it to Enabled. Prepare the prevention Indicator Rule (go to Detection & Threat Intel → Indicator Rules, ensuring to select Prevention when creating the rule), and while preparing it, map it to your restriction profile.

* Wildcards are supported.

###### 3.2.1.1.5. Set up exception profiles and rules

####### 3.2.1.1.5.1. Exception configuration

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Settings → Exception Configuration → Legacy Exceptions and click Start Simulation

####### 3.2.1.1.5.2. Issue exclusions

######## Note

* The agent continues to generate excluded issues on the endpoint, but they are not saved or displayed in Cortex XSIAM. Configuration of an issue exclusion does not remove or delete any of the logs that would have triggered the issue notification. You can also set up issue exceptions by creating global endpoint policy exceptions. For more information,...

######## Navigation

  The Settings → Exception Configuration → Issue Exclusions page displays the issue exclusion rules in Cortex XSIAM

######## 3.2.1.1.5.2.1. Add an issue exclusion rule

####### 3.2.1.1.5.3. Add an IOC or BIOC rule exception

######## Note

* Cortex XSIAM only supports exceptions with one attribute. See Add an alert exclusion rule to create advanced exceptions based on your filtered criteria.Add an alert exclusion rule

######## Navigation

  Settings → Exceptions Configuration → IOC/BIOC Suppression Rules

####### 3.2.1.1.5.4. Add a disable prevention rule for endpoints

######## Important

* All applicable prevention actions are skipped for the files and process that match the properties defined in the rule. Consider the consequences of disabling a prevention rule before you add the exception, and monitor it over time. You can only apply a Disable Prevention Rule to endpoints running Cortex XDR agents version 7.9 and later.

######## Navigation

  Settings → Exception Configuration → Disable Prevention Rules

####### 3.2.1.1.5.5. Add a disable injection and prevention rule

######## Important

* Exceptions are limited up to 48 hours by default and configurable up to one week. Consider the consequences of disabling a prevention rule before you add the exception and monitor it over time. You can only apply a Disable Prevention Rule to agents version 7.9 and later.

######## Navigation

  Settings → Exception Configuration → Disable Injection and Prevention

####### 3.2.1.1.5.6. Add a support exception rule for endpoints

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Your migrated rules are displayed on the Settings → Exception Configurations → Support Exception Rules page

  From Settings → Exception Configuration → Support Exception Rules, click + Import from file

####### 3.2.1.1.5.7. Add a legacy exception rule for endpoints

######## Note

* This exception prevents the agent from examining the specified file. Use with caution, as it may unintentionally allow unwanted or malicious behavior to go undetected.

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Your migrated rules are displayed on the Settings → Exception Configurations → Legacy Agent Exceptions page

######## 3.2.1.1.5.7.1. Add a new exceptions security profile

######## 3.2.1.1.5.7.2. Add a global endpoint policy exception

##### 3.2.1.2. Define endpoint groups

###### Note

* Disconnecting Cloud Identity Engine in your Cortex XSIAM deployment can affect existing endpoint groups and policy rules based on Active Directory properties.

##### 3.2.1.3. Configure global agent settings

###### Note

* Disabling this capability takes immediate effect on new hashes, fresh agent installations, and existing security policies. It could take up to a week to take effect on existing agents in your environment pending agent caching.

* If you have any Cortex XSIAM filters, starring policies, exclusion policies, scoring rules, log forwarding queries, or automation rules configured for XSOAR/3rd party SIEM, we advise you to update those to support the changes before activating the feature. For example, change the query to include the previous description that is still available in the...

##### 3.2.1.4. Apply profiles to endpoints

###### Note

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

##### 3.2.1.5. Create an agent installation package

###### Note

* The profile will be applied if the security policy cannot be retrieved in real-time.

* The Cortex serverless library must be imported after other libraries to activate the hooks that enable auditing.

###### 3.2.1.5.1. Manage an agent installation package

####### Note

* Since Cortex XSIAM relies on the installation package ID to approve agent registration during the installation, we recommend that you don't delete the installation package of active endpoints. If you install the Cortex XDR agent from a package after you delete it, Cortex XSIAM denies the registration request leaving the agent in an unprotected state....

##### 3.2.1.6. Harden endpoint security

###### Caution

* Hardened endpoint security capabilities are not supported for Android or iOS endpoints.

###### Navigation

  From Inventory → Endpoints → Policy Management → Extensions → Profiles, you can create profiles for the following hardened endpoint security capabilities

  To apply the profiles, from Inventory → Endpoints → Policy Management → Extensions → Policy Rules, you can view all the policy rules per operating system

###### 3.2.1.6.1. Device control

####### Note

* Operating systems report on devices in different ways. Sometimes, the same BLE device will report different services and interfaces, depending on the host's operating system. This may have an effect on the specific BLE services that are blocked for each operating system. Depending on your defined user scope permissions, creating device profiles,...

* For network printer print jobs, ensure that you also configure the Agent Settings profile, Network Location Configuration option. This setting must be set to Enabled, and configured. If you do not enable and configure this setting, all network printer operations will be treated as internal network print jobs. For network printer print jobs, ensure that...

* Currently, the default is set to Use Default (Allow), however, Palo Alto Networks may change the default definition at any time.

* You cannot edit or delete the default profiles pre-defined in Cortex XSIAM.

* You cannot edit or delete the predefined profiles in Cortex XSIAM.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* Permanent exceptions apply across platforms, allowing the devices on all operating systems.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

####### Navigation

  Endpoints → Policy Management → Settings → Device Management

###### 3.2.1.6.2. Host firewall

####### 3.2.1.6.2.1. Host firewall for Windows

######## Note

* A rule is always part of a rules group. It cannot stand on its own. A rule can belong to one rules group only and cannot be reused in different groups.

* When selecting ICMP protocol, you must enter a the ICMP Type and Code. Without these values the ICMP protocol is ignored by the Windows and macOS Cortex XDR agents.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows. New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until target is specified.

* The data is aggregated and reported periodically every 60 minutes since the first time the host firewall policy was enforced on the endpoint, not every round hour. The table lists enforcement events only for rules set to Report Matching Traffic.

######## Navigation

  From Inventory → Endpoints → Policy Management → Extensions and select + Add Profile or Import from File

####### 3.2.1.6.2.2. Host firewall for macOS

######## Note

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

######## Navigation

  From Inventory → Endpoints → Policy Management → Extensions Profiles → Profiles, select + New Profile or Import from File

  Additionally, to monitor the communication on your macOS endpoint, you can use the following operating system utilities: From the endpoint System Preferences → Security and Privacy → Firewall → Firewall options, you can view the list of blocked and allowed applications in the firewall

###### 3.2.1.6.3. Disk encryption

####### Note

* You must select the same encryption method configured by the Microsoft Windows Group Policy in your organization for the target endpoints. Otherwise, if you select a different encryption method than the one already applied through the Windows Group Policy, Cortex XSIAM displays errors.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

####### Navigation

  You can monitor the Encryption Status of an endpoint in the Inventory → Endpoints → Disk Encryption Visibility table

###### 3.2.1.6.4. Host Inventory

####### Note

* Cortex XSIAM includes only the first 10,000 results per endpoint. Cortex XSIAM lists only users that belong to each group directly, and does not include users who belong to a group within the main group. If a local users group includes a domain user (whose credentials are stored on the Domain Controller server and not on the endpoint), Cortex XSIAM...

####### Navigation

  Inventory → Endpoints → Host Inventory

###### 3.2.1.6.5. Vulnerability Assessment

####### Prerequisite

* The following are prerequisites for Cortex XSIAM to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XSIAM lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex XSIAM...

* The following are prerequisites for Cortex XSIAM to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex XSIAM collects all the information about the operating system and the installed...

####### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex XSIAM Application Inventory.

####### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

####### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

##### 3.2.1.7. Set a Cortex XDR agent Critical Environment version

###### Note

* To ensure the stability of the line, CE versions maintenance release cadence is longer than in the standard line, we recommend that deployment is adjusted accordingly.

###### Navigation

  Settings → Configurations → General → Agent Configurations

  Inventory → Endpoints → All Endpoints

##### 3.2.1.8. Set an application proxy for Cortex XDR agents

###### Navigation

  Inventory → Endpoints → All Endpoints

#### 3.2.2. Manage endpoint protection

##### 3.2.2.1. Move agents between managing servers

###### Prerequisite

* Consider the following before making changes: Endpoint type is not Kubernetes Node. Installation type is not VDI. Ensure you have administrator privileges for Cortex XSIAM in the hub.

###### Note

* Cortex XSIAM does not support moving agents between FedRamp and commercial tenants.

###### Navigation

  Inventory → Endpoints → Agent Installations

  Inventory → Endpoints → All Endpoints

##### 3.2.2.2. Manage endpoint tags

###### Note

* The following explanations use Windows operating system installation parameters and Cytool argument examples.

* Tag names are case sensitive. In Windows and Mac, a tag name can contain spaces. Linux does not support tag names with spaces as command line arguments to the shell installer. Instead, tags can be set in the /etc/panw/cortex.conf configuration file, which supports all Linux installers.

* Tag names are case sensitive and can contain spaces.

* When SBAC is enabled, assigning tags may impact user permissions.

* If you remove the tag and there are assigned users or user groups with scope settings, this can impact user permissions in the system.

##### 3.2.2.3. Set an alias for an endpoint

###### Tip

* If you change your mind in the future, you can select Endpoint Control → Change Endpoint Alias again, and delete the required aliases.

##### 3.2.2.4. Manage endpoint prevention profiles

###### Note

* The filter is stored within the policy definition and assessed during runtime to extract the functions that match the filter criteria.

###### Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

##### 3.2.2.5. Upgrade Cortex XDR agents

###### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

###### Warning

* You must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check whether the extensions were approved, you can either verify that the...

###### Important

* The following list includes important points to take into account when upgrading the Cortex XDR agent: Review the recommended guidelines for keeping Cortex XDR agents and content updated. Read more here. You cannot upgrade the Cortex XDR agent on VDI endpoints or a Golden Image. You must reinstall (uninstall and install again) the relevant agent...

##### 3.2.2.6. Restart agent

##### 3.2.2.7. Uninstall the Cortex XDR agent

###### Note

* Before upgrading a Cortex XDR agent running on macOS 10.15.4 or later, you must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check...

###### Tip

* If needed, use the filter to filter the list of endpoints by attribute or group name.

###### Navigation

  Inventory → Endpoints → All Endpoints

##### 3.2.2.8. Clear agent database

###### Note

* Clearing the agent database is supported on all platforms with Cortex XDR agent version 7.9 or later, and is available only when using the debugging mode.

* You can only right-click to cancel the clear agent database for actions with a pending status.

##### 3.2.2.9. Delete Cortex XDR agents

###### Note

* To reinstate an endpoint, you have to uninstall and reinstall the agent.

###### Navigation

  Inventory → Endpoints → All Endpoints

##### 3.2.2.10. Manage agent tokens

###### Note

* Agent tokens are only supported for Windows and Mac.

* You can select a one or multiple agents to add a temporary token.

##### 3.2.2.11. Retrieve support file password

###### Navigation

  Retrieve Support File Password from Inventory → Endpoints → All Endpoints

##### 3.2.2.12. Monitor agent operational status

###### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex XSIAM management console for specific reasons for the state.

###### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

###### Navigation

  You can monitor the Cortex XDR agent Operational Status in Inventory → Endpoints → All Endpoints

##### 3.2.2.13. Monitor agent activity

##### 3.2.2.14. Monitor agent upgrade status

###### Navigation

  From Inventory → Endpoints → All Endpoints, you can view the upgrade status of any Cortex XDR agent that you manage

## 4. Web and API Security (WAAS)

### 4.1. Overview

#### License Type

  Requires the Cortex Cloud Runtime Security add-on.

#### Note

* Verify API security configurations for relevant users and roles.

### 4.2. Personas workflow

### 4.3. Secure your API landscape

#### 4.3.1. API visibility and risk assessment

##### Note

* Data classification findings are only available for enabled profiles.

* Indicates that a JSON Web Token was identified, but it is unknown how to determine its type from the given string. It could be a non-standard JSON Web Token creation algorithm.

#### 4.3.2. Monitor and investigate API threats

#### 4.3.3. Configure API security from end to end

##### 4.3.3.1. Third-party API security integrations

###### 4.3.3.1.1. Ingest AWS API Gateway

####### Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

####### Important

* Leave '–'filter-pattern empty as displayed above.

###### 4.3.3.1.2. Ingest Azure APIM

####### License Type

  Requires the Data Collection add-on.

####### Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

####### Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

###### 4.3.3.1.3. Ingest Apigee Proxy

####### License Type

  Requires the Data Collection add-on.

####### Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

####### Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

###### 4.3.3.1.4. Ingest Kong

####### License Type

  Requires the Data Collection add-on.

####### Note

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

####### Important

* The size of the buffer must be equal to or larger than the max body size setting in the plugin configuration, on every data plane node.

###### 4.3.3.1.5. Ingest-F5

####### License Type

  Requires the Data Collection add-on.

####### Note

* Extract the files from the F5 plugin to a folder before selecting to upload to F5.

* Select panw_apisec_set_ssl_data only if your client SSL profile is enabled.

* The provider for "context_provider" should always be uppercase. Supported providers: AWS, GCP, Azure, On-prem.

##### 4.3.3.2. Agent-based protection

###### Note

* Web and API Security (WAAS) profiles and policies are currently a Beta feature.

###### 4.3.3.2.1. Set up Web and API Security profiles

####### Note

* Web and API Security profiles and policies are currently a Beta feature.

* In this profile, the Report options configure the workload to report the corresponding malicious applications or APIs to Cortex XSIAM, without blocking them. The Disabled options configure the workloads to neither analyze nor report the corresponding malware or behavior.

####### Navigation

  Inventory → Endpoints → Policy Management → Prevention → Profiles

###### 4.3.3.2.2. Apply Web and API Security profiles to workloads

####### Note

* Web and API Security profiles and policies are currently a Beta feature.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

###### 4.3.3.2.3. Manage Web and API Security prevention profiles

####### Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

###### 4.3.3.2.4. Add a disable prevention rule for cloud workloads

####### Important

* All applicable prevention actions are skipped for the files and process that match the properties defined in the rule. Consider the consequences of disabling a prevention rule before you add the exception, and monitor it over time.

####### Navigation

  Settings → Exceptions Configuration → Disable Prevention Rules

###### 4.3.3.2.5. Add a support exception rule for cloud workloads

####### Navigation

  From Settings → Exceptions Configuration → Support Exception Rules, click + Import from file

###### 4.3.3.2.6. Add a legacy exception rule for cloud workloads

####### Navigation

  Your rule is created, and can be viewed at the following location: Settings → Exceptions Configuration → Legacy Agent Exceptions

###### 4.3.3.2.7. Additional workload management tasks

####### Navigation

  Several management activities that can be performed on workloads are accessible from Inventory → Endpoints → All Endpoints and from Inventory → Endpoints → Groups

#### 4.3.4. API specification inventory

##### Note

* Even if you have already imported the specification, you can edit the API specification in Cortex XSIAM and add or update the server list.

##### 4.3.4.1. Import API specification

###### Note

* Even if you already imported the file, you can edit the API asset and add or update the server list.

## 5. Monitor dashboards and reports

### 5.1. About dashboards

#### Note

* You cannot edit the predefined dashboards but you can create a new dashboard that is based on a dashboard template. In addition, private dashboards can only be viewed, edited, and deleted by the dashboard creator.

* Dashboards that are based on custom infrastructure cannot be exported. If you import a dashboard template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

#### 5.1.1. Command Center dashboards

##### Note

* Access to the dashboards requires RBAC View permissions for Dashboards & Reports and Command Center Dashboards. The dashboards are available in dark mode only. They are not editable, and you can't create dashboard templates or reports from them. Some of the dashboard's animations are not fully supported by the Safari web browser. We recommend that...

##### 5.1.1.1. XSIAM Command Center

##### 5.1.1.2. Cloud Detection and Response (CDR) Command Center

##### 5.1.1.3. Cloud Security Command Center

###### 5.1.1.3.1. Cloud Security Command Center

####### License Type

  Requires the Cortex Cloud Runtime Security or the Cortex Cloud Posture Management add-on.

####### Note

* The Cloud Security Command Center dashboard is currently only available by default to users with the Instance Administrator and Viewer roles. Custom roles, which include the Cloud Security Command Center View/Edit role permissions, also have access.

####### 5.1.1.3.1.1. Fine-Tune your Investigation

######## 5.1.1.3.1.1.1. Data Sources

######## 5.1.1.3.1.1.2. Assets with Vulnerabilities

######## 5.1.1.3.1.1.3. Security Outcomes

######### 5.1.1.3.1.1.3.1. Security Cases

######### 5.1.1.3.1.1.3.2. Posture Cases

####### 5.1.1.3.1.2. Value Metrics

######## Note

* The Time Saved estimate is based on the total amount of savings derived from the reduction of issues by grouping and addressing them as Posture Cases and Attack Paths. Analyst savings are estimates based on an average Security Analyst's wage coupled with the reduction in time spent addressing Issues on an individual basis.

##### 5.1.1.4. Cloud Security Operations

###### 5.1.1.4.1. Cloud Security Operations

####### License Type

  Requires the Cortex Cloud Runtime Security add-on or the Cortex Cloud Posture Management add-on.

####### Note

* Command Center data may not match the counts on the Issues page and you may observe inconsistencies. This is because dashboard data is a snapshot of issues identified, whereas the Issues page provides the most up to date view of risks across your cloud assets. In addition, the Issues pages does not support all the currently available filters on the...

####### 5.1.1.4.1.1. Dashboard Widgets

######## Note

* The Last updated time indicated on each widget may differ as widget data is gathered at varying intervals.

######## 5.1.1.4.1.1.1. Generate Reports

######## 5.1.1.4.1.1.2. Filter Options

#### 5.1.2. Predefined dashboards

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

  Requires the Posture Management add-on or the Runtime Security add-on.

  Requires the ITDR add-on.

  Requires the TIM add-on.

##### Note

* Users can access all information on the dashboard when their user access is scoped to view All assets or assigned to the Instance Administrator role. Otherwise, users with granular scoping set to No assets or Select asset groups will have limited access to the dashboard. For more information on Scope-Based Access Control (SBAC), see Manage user...

#### 5.1.3. Reports

##### 5.1.3.1. Report templates

### 5.2. Build custom dashboards and reports

#### 5.2.1. Build a custom dashboard

##### Note

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

#### 5.2.2. Manage your Widget Library

##### Note

* Any dashboards or reports that include the widget are affected by the changes.

### 5.3. Fine-tune dashboards and reports

#### 5.3.1. Create a custom widget using a script

##### Note

* If you have added arguments to the script, these appear when creating a widget.

* Available options are Pie, Column, Line, and Single Value. To display the result of the script as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### 5.3.1.1. Script-based widget examples

###### Note

* Add the widget tag in the script settings to make the script available for use in script-based widgets. For more information, see Create a script.Create a script

* If your script returns a time duration, configure the widget with the graph type Single Value and enable Show as Time..

#### 5.3.2. Create a text widget

##### Note

* From the dashboard manager, you can right-click an existing dashboard and choose Save as report template. You can also add text-based widgets directly to new or existing report templates, as described below.

#### 5.3.3. Create custom XQL widgets

##### Note

* Cortex Query Language (XQL) queries generated from the Widget Library do not appear in the Query Center. The results are used only for creating the custom widget.

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### Tip

* You can create a generic dashboard for multiple views of the same dataset by defining the dataset in the XQL widget as dataset = <dataset_name>*. The placement of the asterisk (*) in the dataset name ensures that any view containing this prefix text is displayed in the results. The dataset in a query is defined as: If there are multiple datasets that...

##### Navigation

  All of your predefined and custom XQL widgets are available in the Widget Library under Dashboards & Reports → Customize → Widget Library

##### 5.3.3.1. Configure filters and inputs for custom XQL widgets

###### Prerequisite

* Fixed filters are based on parameters that are defined in custom XQL widgets. Before you can configure fixed filters, take the following steps: Create custom XQL widgets with parameters. For more information, see Create custom XQL widgets. Add the widgets to a Custom dashboard. For more information, see Build a custom dashboard.

###### Note

* If you specify more than one field, only the first field value is used.

###### Tip

* After the initial setup, when you access your dashboard the filters and inputs might need further refinement. You can make changes to the configured parameters in the XQL widgets, and update the Filters & Inputs on your dashboard until you are satisfied with the results.

##### 5.3.3.2. Configure dashboard drilldowns

###### Prerequisite

* To configure drilldowns your dashboard must contain custom XQL widgets. In addition, if you want to configure in-dashboard drilldowns your custom XQL widget must contain one or more parameters. For more information about configuring parameters in custom XQL widgets, see Create custom XQL widgets.

###### Note

* If the selected parameter is configured in other XQL widgets on the dashboard, these widgets are also affected by the drilldown.

###### 5.3.3.2.1. Variables in drilldowns

### 5.4. Run or schedule reports

#### Note

* Report templates that are based on custom infrastructure cannot be exported. If you import a report template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

* The report name and description will be displayed in the report header and are not editable during customization.

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

#### Navigation

  Dashboards & Reports → Customize → Report Templates

  Dashboards & Reports → Customize → Dashboards Manager

  Under Settings → Configurations → General → Notifications, click + Add Forwarding Configuration

## 6. Investigation and response

### 6.1. Cases and issues

#### 6.1.1. What are cases?

##### 6.1.1.1. Issues

##### 6.1.1.2. Findings and events

#### 6.1.2. Case and issue domains

##### Navigation

  You can see all domains under Configurations → Object Setup → Cases → Domains

#### 6.1.3. Manage your cases

##### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

##### 6.1.3.1. Assign a case

##### 6.1.3.2. Case thresholds

##### 6.1.3.3. Link or unlink issues from a case

##### 6.1.3.4. Resolve a case

###### 6.1.3.4.1. Resolution reasons for cases and issues

####### Note

* The displayed resolution reasons are domain specific. You can see the resolution reasons that are defined for a domain under Configurations → Object Setup → Cases → Domains.

* Cases and issues resolved as True Positive and False Positive help Cortex XSIAM to identify real threats in your environment by comparing future cases and associated issues to the resolved cases. Therefore, the handling and scoring of future cases is affected by these resolutions.

###### 6.1.3.4.2. Create custom case statuses and resolution reasons

####### Note

* Before you create a custom status, please review the built-in options. For more information, see Resolution reasons for cases and issues. We recommend using the built-in statuses and resolution reasons where possible. Custom statuses and resolution reasons might not be supported by all content, and status syncing can take time. In addition, custom...

* After creation, custom statuses and resolution reasons cannot be deleted or modified.

####### Navigation

  Configurations → Object Setup → Cases → Properties

##### 6.1.3.5. Create a case

###### Note

* To create a case manually, you must have View/Edit permission for Cases and Issues selected under Settings → Configurations → Access Management → Roles → Components → Cases & Issues.

* You can assign a case to a single domain only and you cannot change the assigned domain. For more information, see Case and issue domains.

* This option is only relevant for certain domains.

* You can't attach files to manually created cases.

###### Tip

* The issues that you link to a case can be linked to multiple cases, and the issue domains do not need to match the case domain.

##### 6.1.3.6. Issue syncing

###### Prerequisite

* You must set up an integration before you can sync issues. For more information, see Set up an integration for mirroring issues.

###### Note

* Multiple tickets can be linked to an issue with outbound syncing. Issues with inbound syncing can be linked to a single ticket only.

* Using issue fields as variables is not currently supported.

* You can only define a single inbound profile. If you change the inbound sync profile the current profile is overwritten. You can define multiple outbound profiles; one issue can update multiple tickets.

* The inbound syncing flow runs every two minutes, and the outbound syncing flow runs every five minutes. In a bi-directional set-up, if the same field is updated in both tickets, the most recently updated value is used. In the external ticket, the logged history shows updates to the ticket. The user name that is logged with the history reflects the user...

* After an issue is resolved, ticket syncing remains active for up-to seven days. Therefore, you still update, change, or reopen the issue or external ticket and the tickets will continue to sync.

* If you change the selected inbound sync profile, the original sync profile is immediately overwritten.

###### Warning

* If you leave this field blank, all configured instances will be used.

###### Tip

* You can find a sync profile ID under Settings → Configurations → Object Setup → Issues → Sync Profiles. By default the ID field is not displayed in the table. Click the three dot menu and add it to the table layout.

###### Navigation

  Settings → Configurations → Data Sources and click Add Data Source

  Settings → Configurations → Data Collection → Automation & Feed Integrations

###### 6.1.3.6.1. Create a sync profile

####### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

#### 6.1.4. Customize your cases

##### 6.1.4.1. External integrations

##### 6.1.4.2. Prioritize cases with starring and scoring

###### 6.1.4.2.1. Case starring

####### Navigation

  Cases & Issues → Case Configuration → Starred Issues

###### 6.1.4.2.2. Case scoring

####### 6.1.4.2.2.1. Set up case scoring

######## Note

* On the first activation, it can take up to 48 hours for SmartScore to calculate and display the score. Enabling SmartScore subsequently impacts the User Score.

* For scoped users, a small lock icon indicates that you don't have permissions to edit a rule.

##### 6.1.4.3. Customize issue fields and layouts

###### 6.1.4.3.1. Issue fields

####### Warning

* Deleting an issue field or uninstalling a content pack containing an issue field may affect detection and other capabilities based on the deleted field. For example, correlation, layouts, case scoring, starring rules, and playbook triggers.

####### 6.1.4.3.1.1. Issue field types

######## Note

* You cannot set filters, starring rules, playbook triggers, layout rules, or issue exclusions based on the values in custom timestamp fields.

* When grid field is shown in the Issues table, if there are values in the field, they do not display in the table. Instead, the column shows Data Available.

* When an HTML field is shown in the Issues table, if there is a value in the field, it does not display in the Issues table. Instead, the column shows Data Available. The following HTML tags are not permitted: blockquote, del, dd, div, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, iframe, ins, li, math, noscript, ol, pre, p, script, style, table,...

* When a Markdown field is shown in the Issues table, if there is a value in the field, it does not display in the table. Instead, the column shows Data Available.

####### 6.1.4.3.1.2. Create custom issue fields

######## Navigation

  Settings → Configurations → Object Setup → Issues → Fields → New Field

######## 6.1.4.3.1.2.1. Create a grid field

######## 6.1.4.3.1.2.2. Issue field triggered scripts

######## 6.1.4.3.1.2.3. Issue timer fields

######### 6.1.4.3.1.2.3.1. Configure issue timer fields

######### 6.1.4.3.1.2.3.2. Configure a playbook to run timers

######### 6.1.4.3.1.2.3.3. Automate changes to issue fields using timer scripts

######### 6.1.4.3.1.2.3.4. Use issue timer field commands manually in the CLI

###### 6.1.4.3.2. Issue layouts

###### 6.1.4.3.3. Create custom issue layouts

####### Note

* The script that runs when an action button is clicked accepts only mandatory arguments through the pop up window and does not provide an option for any non-mandatory arguments to be filled in when the button is clicked. We recommend using a wrapper script to collect and validate arguments in scenarios where there can be a combination of mandatory and...

####### Tip

* Limit the number of issue fields to 50 in each section. You can create additional sections as needed.

####### 6.1.4.3.3.1. Add a custom widget to an issue layout

######## Navigation

  Investigation & Response → Automation → Scripts and upload the following script: Expand script commonfields: id: ee3b9604-324b-4ab5-8164-15ddf6e428ab version: 49 name: IndicatorWidgetBar script: |- # Constants HIGH = 3 SUSPICIOUS = 2 LOW = 1 NONE = 0 indicators = [] scores = {HIGH: 0, SUSPICIOUS: 0, LOW: 0, NONE: 0} incident_id = demisto

  Investigation & Response → Automation → Scripts and upload the following script

  Settings → Configurations → Object Setup → Issues → Layouts

###### 6.1.4.3.4. Create rules for issue layouts

####### Navigation

  Settings → Configurations → Object Setup → Issues → Layout Rules → New Rule

##### 6.1.4.4. Customize case fields and layouts

###### 6.1.4.4.1. Create case timers and SLAs

####### Prerequisite

* Before you can create a case SLA, you must first create a timer field. A timer field can be associated with a single case SLA.

####### Note

* If you edit this filter after creation, the timer and associated SLA will be removed from any case that no longer qualifies, even if the timer is already running.

####### Navigation

  Settings → Configurations → Object Setup → Cases and open the Fields tab

####### 6.1.4.4.1.1. Update case timer and SLA fields

###### 6.1.4.4.2. Case fields

####### Warning

* Deleting a case field or uninstalling a content pack containing a case field may affect capabilities based on the deleted field, layouts and case scoring.

####### 6.1.4.4.2.1. Case field types

######## Note

* You cannot set filters, starring rules, playbook triggers, layout rules, or issue exclusions based on the values in custom timestamp fields.

* When grid field is shown in the Cases table, if there are values in the field, they do not display in the Cases table. Instead, the column shows Data Available.

* When an HTML field is shown in the Issues table, if there is a value in the field, it does not display in the Cases table. Instead, the column shows Data Available.

* When a Markdown field is shown in the Cases table, if there is a value in the field, it does not display in the Cases table. Instead, the column shows Data Available.

* If you make changes to case fields you can update the context data by running a playbook, script, or command. For more information, see Update case fields. To update dynamic custom case fields, such as SLA and Timer fields, see Update case timer and SLA fields.

####### 6.1.4.4.2.2. Create custom case fields

######## Navigation

  Settings → Configurations → Object Setup → Cases → Fields → New Field

######## 6.1.4.4.2.2.1. Create a grid field for a case

####### 6.1.4.4.2.3. Update case fields

######## Note

* Ensure that you have the required RBAC permission to write scripts.

###### 6.1.4.4.3. Case layouts

####### 6.1.4.4.3.1. Create custom case layouts

######## Note

* The script that runs when an action button is clicked accepts only mandatory arguments through the pop up window and does not provide an option for any non-mandatory arguments to be filled in when the button is clicked. We recommend using a wrapper script to collect and validate arguments in scenarios where there can be a combination of mandatory and...

######## Tip

* Limit the number of case fields to 50 in each section. You can create additional sections as needed.

####### 6.1.4.4.3.2. Create rules for case layouts

######## Note

* Layout rules support SBAC (scoped based access control). The following parameters are considered for editing access. If Scope-Based Access Control (SBAC) is enabled and Endpoint Scoping Mode is set to restrictive mode, you can edit a rule if you are scoped to all tags in the rule. If Scope-Based Access Control (SBAC) is enabled and Endpoint Scoping...

######## Navigation

  Settings → Configurations → Object Setup → Cases → Layout Rules → New Rule

##### 6.1.4.5. Create a case domain

###### Note

* Adding custom domains requires a View/Edit RBAC permission for Case Properties (under Object Setup). Once created, a custom case domain cannot be deleted or renamed.

###### Warning

* Before you add a custom domain, please review the built-in options. For more information, see Case and issue domains. We recommend using the built-in domains where possible. Custom domains might not be supported by all content. In addition, custom domains affect Cortex XSIAM's ability to learn, correctly identify, and score future cases. Smart...

###### Navigation

  Settings → Configurations → Object Setup → Cases → Domains

  Settings → Configurations → Access Management → User Groups

  Settings → Configurations → Access Management → Users

  To enable access to the domain for an API key, got to Settings → Configurations → Integrations → API Keys

##### 6.1.4.6. Create a sync profile

###### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

##### 6.1.4.7. Run indicator extraction in the CLI

###### Note

* Triggering enrichment on a substantial amount of indicators can take time (since it's activating all enrichment integrations per indicator) and can result in performance degradation.

#### 6.1.5. Cortex Copilot

##### Navigation

  To increase usability, you can create a personalized keyboard shortcut: Settings → Configurations → Server Settings → Keyboard Shortcuts and choose the shortcut you want to use

##### 6.1.5.1. Cortex Copilot layout

##### 6.1.5.2. Cortex Copilot capabilities

###### Note

* When you choose an option from the Respond column, Cortex Copilot will always prompt you to approve the action before executing.

* Disabling Cortex Copilot requires users to refresh their page.

### 6.2. Investigate cases

#### 6.2.1. Overview of the Cases page

##### Note

* For MSSP and multi-tenant administrators, if the Unified Case View is enabled, this view consolidates all cases across your distributed environment, allowing you to view and perform actions on child tenants. If the Unified Case view is disabled, this view displays a single tenant at a time with a drop-down list for moving between tenants in read-only...

* When an issue is resolved, it remains linked to a case and appears in this section. Once all of the issues in a case are resolved, the case is automatically closed.

##### Tip

* Set a default tab in the details pane by selecting the pin icon next to a tab. Click on the Notepad, Messenger, and Case Context Data icons to add notes on the case, and see existing notes from other analysts.

##### 6.2.1.1. Saved table views

##### 6.2.1.2. Unified case view

###### License Type

  Requires an MSSP license.

###### Note

* Requires the following RBAC permissions:    Cases & Issues   Investigation & Response → Automation Requires the following RBAC permissions: Cases & Issues Investigation & Response → Automation This view is available for the parent tenant only. To take actions on a child tenant from a parent tenant, you must have the appropriate permissions for both...

* Custom case layouts of child tenants are not visible in the parent tenant.

#### 6.2.2. Review and investigate a case

##### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

* In some cases, the number of issues associated with the techniques will not be aligned with the number of the parent tactic because of missing tags or in case an issue belongs to several techniques.

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

* Cloud related issues are displayed in the User Name grouping. Prisma Cloud Compute issues are displayed in the Host Name grouping.

### 6.3. Investigate issues

#### 6.3.1. Overview of the Issues page

##### Note

* Every 12 hours, the system enforces a cleanup policy to remove the oldest issues once the maximum limit is exceeded. The default issue retention period in Cortex XSIAM is 186 days.

#### 6.3.2. Issue card

##### License Type

  Requires the TIM add-on.

##### Note

* This section is context specific and shows data according to the issue context.

##### 6.3.2.1. Use the War Room in an investigation

###### Note

* The case War Room is usually used for communication capabilities, but unlike the issue War Room, it does not include playbook specific entries. The case War Room enables you to investigate an entire case, not just an issue.

* Cortex XSIAM does not index notes and chats.

###### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

* You can use the up/down arrow buttons in the CLI to do a reverse history search for previous commands with the same prefix.

###### Navigation

  Investigation & Response → Automation → Playground

##### 6.3.2.2. Use the Work Plan in an investigation

#### 6.3.3. Triage and investigate issues

##### 6.3.3.1. Copy issues

##### 6.3.3.2. Analyze an issue

##### 6.3.3.3. Run an automation on an issue

###### Note

* In addition to automation, some playbooks contain manual tasks that prompt the analyst for input. This enables you to enhance an automation workflow with analyst input.

* You can also manually select a playbook to run from the Issue Work Plan tab.

##### 6.3.3.4. Create profile exceptions

###### Navigation

  Inventory+Endpoints → Policy Management → Profiles

##### 6.3.3.5. Investigate contributing events

##### 6.3.3.6. Retrieve additional issue details

###### Tip

* If you require assistance from Palo Alto Networks support to investigate the issue, make sure to provide the downloaded ZIP file.

##### 6.3.3.7. Add a file path to a malware profile allow list

###### Navigation

  Inventory+Endpoints → Policy Management → Prevention → Profiles and locate the malware profile you selected

##### 6.3.3.8. Create a featured field

###### Note

* Featured Active Directory values are displayed in the User and Host fields accordingly.

###### Navigation

  Cases & Issues → Case Configuration → Featured Fields and select a type of featured field

##### 6.3.3.9. View generating BIOC or IOC rule

##### 6.3.3.10. Export issue details to a file

##### 6.3.3.11. Exclude an issue

##### 6.3.3.12. Query case and issue data

###### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

##### 6.3.3.13. Update issue fields

###### Note

* You must create a custom status before you can select it.

###### Tip

* You can create custom issue statuses and resolution reasons, and use the setIssueStatus command to set these custom statuses for issues. For example, when a user starts investigating an issue, the issue status is automatically changed from New to Under Investigation. In some cases, it is useful to create an interim status, such as Triage. After you...

##### 6.3.3.14. Close an issue

###### Note

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

#### 6.3.4. What is Causality?

##### Note

* There are no CGOs in the Cloud Causality View, when investigating cloud Cortex XSIAM alerts and Cloud Audit Logs, or SaaS Causality View, when investigating SaaS-related alerts for 501 audit events, such as Office 365 audit logs and normalized logs.

##### 6.3.4.1. Causality view

###### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

##### 6.3.4.2. Network causality view

###### Note

* The network causality view displays only the information it collects from the detectors. It is possible that the CI may not show some of the firewall or agent processes.

###### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

##### 6.3.4.3. Cloud causality view

##### 6.3.4.4. SaaS causality view

##### 6.3.4.5. Timeline

###### Note

* The Timeline view is not available when investigating cloud Cortex XSIAM issues and cloud audit logs or SaaS-related issues for 501 audit events, such as Office 365 audit logs and normalized logs. Only the applicable cloud causality view and SaaS causality view is available for this data.

##### 6.3.4.6. Causality icons key

#### 6.3.5. Cortex Response and Remediation content pack

##### 6.3.5.1. Investigate an issue using Cortex Response and Remediation playbooks

##### 6.3.5.2. Example use cases

### 6.4. Investigate findings

#### Note

* Depending on your license type, some finding types require the Cortex Cloud Posture Management add-on.

#### 6.4.1. Findings card

##### Note

* The information in this card is context specific, therefore some sections are not available for all findings.

### 6.5. Investigate artifacts and assets

#### 6.5.1. Investigate an IP address

##### Note

* Requires a license key. Select Settings → Configurations → Integrations  → Threat Intelligence.

#### 6.5.2. Investigate an asset

##### Note

* The Asset view is available for hosts with a Cortex XDR agent installed.

#### 6.5.3. Investigate a host

##### License Type

  The Host Risk View requires the Identity Threat Module add-on.

##### Tip

* You can also see a list of all hosts under Inventory → Assets → Asset Scores.

#### 6.5.4. Investigate a file and process hash

##### Note

* Requires a license key. Go to Settings → Configurations → Integrations  → Threat Intelligence.

#### 6.5.5. Investigate a user

##### License Type

  If the Identity Threat module is enabled you can open the User Risk View. This view displays insights and profiling information to help you investigate issues and cases. Viewing anomalies in the context of baseline behavior facilitates risk assessment and shortens the time you require for making verdicts. If the Identity Threat module is not enabled...

##### Note

* Cortex XSIAM normalizes and displays case and issue times in your time zone. If you're in a half-hour time zone, the activity in the Normal Activity and the Actual Activity charts is displayed in the whole-hour time slot preceding it. For example, if you're in a UTC +4.5 time zone, the time displayed for the activity will be UTC +4.5, however, the...

##### Tip

* You can also see a list of all users under Assets → Asset Scores.

### 6.6. Investigate endpoints

#### 6.6.1. Overview of the Action Center

##### Note

* Blocking files on endpoints is enforced by the endpoint malware profile. To block a hash value, ensure the hash value is configured in the Malware security profile. Select Override Report mode to allow the agent to block hashes, even if the Malware Profile is set to Report.

##### Navigation

  Investigation & Response → Response → Action Center

##### 6.6.1.1. Initiate and monitor endpoint actions

###### Navigation

  Investigation & Response → Response → Action Center → New Action

  Investigation & Response → Response → Action Center

##### 6.6.1.2. Action Center reference information

#### 6.6.2. Manage endpoints

##### Note

* For the Include endpoints from auto upgrade action, you cannot enable auto upgrade for Mobile, VDI, and TS installations.

* If an endpoint is excluded, the auto upgrade profile configuration is not available. If you exclude the endpoint from auto upgrade while the auto upgrade action is In progress, the ongoing upgrade will still take place.

* Content Status is calculated every 30 minutes. Therefore, there might be a delay of up to 30 minutes in displaying the data.

* Only supported for Windows and macOS.

* Changes to the agent status can take up to ten minutes to display on Cortex XSIAM .

##### Navigation

  Inventory → Endpoints → All Endpoints

  Settings → Configurations → General → Agent Configurations → Endpoint Administration Cleanup

#### 6.6.3. Retrieve files from an endpoint

##### Note

* You cannot define a path using environment variables on Mac and Linux endpoints.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Disabling File Retrieval does not take effect on file retrieval actions that are in progress.

#### 6.6.4. Retrieve support logs from an endpoint

##### Navigation

  Investigation & Response → Response → Action Center → + New Action

#### 6.6.5. Retrieve support file password

##### Navigation

  Retrieve Support File Password from Inventory → Endpoints → All Endpoints

#### 6.6.6. Scan an endpoint for malware

##### Navigation

  Investigation & Response → Response → Action Center → New Action

### 6.7. Investigate files

#### 6.7.1. Manage file execution

##### Navigation

  Investigation & Response → Response → Action Center → New Action

#### 6.7.2. Manage quarantined files

##### Note

* This will restore all files with the same hash on all of your endpoints.

#### 6.7.3. Review WildFire analysis details

##### Note

* Cortex XSIAM displays the preview of WildFire reports that were generated within the last couple of years. To view a report that was generated more than two years ago, you can download the report.

#### 6.7.4. Import file hash exceptions

##### Navigation

  Investigation & Response → Response → Action Center → New Action

### 6.8. Automations

#### 6.8.1. Automation in Cortex XSIAM

##### Note

* You can build end-to-end automation workflows from within the playbook editor, including creating automation rules, configuring integration instances, and creating and editing tasks. For more information, see Playbooks.

#### 6.8.2. Quick Actions

##### Note

* When investigating an issue, in the Issues table, you can right-click to Run an Automation on one or more issues. For more information, see Run an automation on an issue.Run an automation on an issue

#### 6.8.3. Manage automation exclusion policies

##### Note

* For the IAM User Hard Remediation and User Soft Remediation policies, we recommend including username, email, and ID for each user you want to exclude. Example: username1, user@example.com, userID112.

* You can also right click on a policy from the main Automation Exclusion Center page to disable or enable the policy. If you click on a list name in the Exclude column, that list opens in the Lists page.

#### 6.8.4. Playbooks

##### 6.8.4.1. Playbooks overview

##### 6.8.4.2. Playbook development checklist

##### 6.8.4.3. Plan your playbook

##### 6.8.4.4. Manage playbooks

###### Note

* The library by default shows only playbooks that are not adopted. Click the Show Adopted checkbox to show the adopted playbooks, indicated by an Adopted mark. The library shows the most updated playbook version. Adopting an older version than shown should be done through Marketplace. Adopting a playbook does not make it run. Some content packs include...

##### 6.8.4.5. Build your playbook

###### 6.8.4.5.1. Task 1. Choose from existing playbooks or create your own

####### Tip

* If there are additional relevant playbooks in Marketplace that are not in your Org repository, you can click Explore them now to see them in the Playbook Catalog and choose to adopt.

* To open multiple playbooks at the same time, edit the first playbook and then click New next to the playbook name to create a new tab. You can either create a new playbook, or add an existing one. You can view recently modified or deleted playbooks by clicking version history for all playbooks .

####### Navigation

  the Investigation & Response → Automation → Playbooks page to customize or create a playbook

###### 6.8.4.5.2. Task 2. Configure playbook settings

####### Note

* If the playbook has inputs and outputs, the Playbook Starts task will show back and forth arrows. Clicking them opens the Playbook Settings pane Inputs/Outputs tab.

* This rule will trigger the playbook to run if no other Automation Rule triggers the playbook first. You can view and edit the order the rules run in the Automation Rules page.

* If you do not add any fields, the group will be deleted when you click Save.

###### 6.8.4.5.3. Task 3. Add objects from the Task Library

####### 6.8.4.5.3.1. Add Quick Actions, commands, and scripts

######## Note

* If the Quick Action requires an integration instance and it is not yet configured, you have the option to create an integration instance from within the playbook editor.

* If you want to add a script that is not yet adopted, Cortex XSIAM automatically installs the content pack containing the script. If the script requires an integration instance, you are prompted to configure one.

* If you do not have permission to download the script, contact your administrator for help. You can also filter by "show only configured" to show scripts you can use.

* The output value is dynamic and is derived from the context at the time that the task is processed. As a result, parallel tasks that are based on the same output may return inconsistent results.

####### 6.8.4.5.3.2. Add sub-playbooks

######## Tip

* Balance between the number of iterations and the interval so you do not overload the server.

####### 6.8.4.5.3.3. Add manual tasks and blank tasks

######## 6.8.4.5.3.3.1. Create a standard task

######## 6.8.4.5.3.3.2. Create a conditional task

######## 6.8.4.5.3.3.3. Create a communication task

####### 6.8.4.5.3.4. Create a section header

####### 6.8.4.5.3.5. Configure script error handling in a playbook

######## Note

* Use the GetErrorsFromEntry script (part of the Common Scripts Pack) to check whether the given entry returns an error and returns an error message. For example, when using the script in a playbook, you can fetch the error message from a given task, such as a runtime error. You can then add a step in the playbook flow to send those error messages to the...

* You can set up script error handling only when running a script in a Standard task or a Conditional task. For more information about error handling settings for these tasks, see Create a standard task or Create a conditional task. Built-in, Manual, and Ask Conditional tasks have On Error settings for number of retries and retry interval, but not Error...

###### 6.8.4.5.4. Task 4. Add custom playbook features

###### 6.8.4.5.5. Task 5. Test and debug the playbook

###### 6.8.4.5.6. Task 6. Manage playbook content

##### 6.8.4.6. Customize your playbook

###### 6.8.4.6.1. Configure a sub-playbook loop

####### Note

* Consider the following when adding a loop: The maximum number of loops (default is 100). A high number of loops or a high wait time combined with a large number of issues may affect performance. Periodically check looping conditions to ensure they are still valid for the data set. If you want a sub playbook task to loop over an array passed into its...

####### Tip

* Balance between the number of iterations and the interval so you do not overload the server.

###### 6.8.4.6.2. Filter and transform data

####### Caution

* You can change the context data root to filter, but it is not recommended to select a different root, as it affects the filter results. The drop-down list displays the filter root for backward compatibility.

####### Navigation

  Investigation & Response → Automation → Scripts → New Script

####### 6.8.4.6.2.1. Filter considerations, categories, and built-in filters

######## Note

* Is defined considers false and empty strings and lists to be defined values. If you don't want those to be included as defined, use Is not empty.

* Not defined considers false and empty strings and lists to be defined values. If you don't want those to be included as defined, use Is empty.

####### 6.8.4.6.2.2. Transformer considerations, categories, and built-in transformers

######## Note

* To make regex case non-sensitive, use the (?i) prefix (for example (?i)yourRegexText.

###### 6.8.4.6.3. Extract indicators

####### Note

* This configuration may delay playbook execution (issue creation). While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

###### 6.8.4.6.4. Extend context

###### 6.8.4.6.5. Update issue fields with playbook tasks

####### Note

* The setIssue script includes all available fields; use the scroll bar to see all the fields. The name field has a limit of 600 characters. If there are more than 600 characters, you can shorten the name field to under 600 characters and then include the full information in a long text field such as the description field. There are many fields already...

###### 6.8.4.6.6. Playbook polling

####### Note

* You need to use the GenericPolling playbook as a sub-playbook in a main playbook, such as Detonate File - JoeSecurity. The main playbook should follow this structure: Start Command: The task contains a command that fetches the initial state of the process and saves it to context. This command starts the process that should be polled. For...

##### 6.8.4.7. Test your playbook

###### Note

* The debugger does not support using parentIncidentFields.

* Using an existing issue in the debugger does not affect the original issue or change the original context data.

###### 6.8.4.7.1. Troubleshoot playbook performance

##### 6.8.4.8. Manage playbook content

##### 6.8.4.9. Best practices

###### Note

* If you reattach a detached playbook, any customizations you have made to the playbook will be overwritten when the playbook updates to the current version.

* Retries are not supported for data collection tasks that have errors sending emails (indicated by a server timeout). This is because retries only work on automation execution failures, not on email delivery issues.

#### 6.8.5. Create an automation rule

##### Note

* You can also define the conditions that trigger a specific playbook in the playbook editor. For more information, see Task 2. Configure playbook settings

##### Important

* Automation rules apply to Medium and higher severity issues. They also apply to Low severity Analytic issues and Low severity ABIOC issues that are tagged with Identity or Cloud. Rules are evaluated in order, and only the first rule that matches the trigger conditions is executed.

#### 6.8.6. Context data

##### 6.8.6.1. Issue context data

##### 6.8.6.2. Case context data

##### 6.8.6.3. Search context data

##### 6.8.6.4. Add context data to an issue

##### 6.8.6.5. Add context data to a case

###### Note

* If you run the command in the issue War Room, the data is added to the following places: The case context data. The issue context data under the case tab. If you run the command in the Case War Room, the data is added to the case context data only.

##### 6.8.6.6. Delete context data from a case

##### 6.8.6.7. Use context data in a playbook

###### Note

* Generic polling does not work if a playbook's context data is shared globally. For more information, see Playbook polling.

###### Caution

* Users with Trigger Playbook permissions on a given issue may still be able to modify the parent case via commands and scripts, even without full access to the case.

#### 6.8.7. Lists

##### Note

* The maximum list size is 209,715 characters (approximately 200 KB).

##### 6.8.7.1. Create a list

###### Note

* If you want to edit a list from a content pack, you need to duplicate or detach a list. Detached lists do not receive updated content in subsequent Cortex XSIAM content releases. To retain an updated list, reattach it.

###### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

##### 6.8.7.2. List commands

##### 6.8.7.3. Use cases: JSON lists

###### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

  Investigation & Response → Automation → Playbooks → New Playbook

##### 6.8.7.4. Transform a list into an array

###### Navigation

  Investigation & Response → Automation → Playbooks and create or edit a playbook

#### 6.8.8. Jobs

##### 6.8.8.1. Manage jobs

###### Note

* Only Account Admins and Instance Administrator roles can create jobs and view/edit job runs. If the owner of a job has been removed from Cortex XSIAM, the job will fail to run. In this case, you must change the owner to a current user.

##### 6.8.8.2. Create a time triggered job

###### Note

* To view a human readable description of a cron schedule for an existing job, click  and select Job Schedule from the available columns.

###### Important

* We recommend to avoid triggering a job while a previous run of the job is active by configuring the playbook a job triggers to close the investigation before running a new instance of the job.

##### 6.8.8.3. Create a job triggered by a delta in a feed

###### Note

* A job triggered by a delta in a feed runs only if there is a change in the feed, and does not run on a feed's initial fetch. For the initial fetch, you can run the playbook manually and then set up an event triggered job for subsequent fetches. If you want to trigger a job after a feed completes a fetch operation and the feed does not change...

###### Navigation

  Investigation & Response → Automation → Jobs → New Job

#### 6.8.9. Engines

##### 6.8.9.1. What is an engine?

###### Note

* You cannot share a multiple-engine installation with a single-engine installation.

* When you add an engine to a load-balancing group, you cannot use that engine separately. The engine does not appear in the engines menu when configuring an integration instance, but you can choose the load-balancing group.

##### 6.8.9.2. Engine requirements

###### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

##### 6.8.9.3. Install an engine

###### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex XSIAM engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

###### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

###### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

###### 6.8.9.3.1. Docker

####### Note

* This section is relevant when installing an engine.

* Docker images can be downloaded together with their relevant content packs for offline installation.

####### 6.8.9.3.1.1. Install Docker

######## Note

* For Red Hat's Docker distribution, you need Mirantis Container Runtime (formerly Docker Engine - Enterprise) to run specific Docker-dependent integrations and scripts. For more information, see Install Docker distribution for Red Hat on an engine server. To use the Mirantis Container Runtime (formerly Docker Engine - Enterprise) follow the deployment...

######## 6.8.9.3.1.1.1. Install Docker distribution for Red Hat on an engine server

######## 6.8.9.3.1.1.2. Docker image security

######## 6.8.9.3.1.1.3. Docker FAQs

######## 6.8.9.3.1.1.4. Troubleshoot Docker issues

######## 6.8.9.3.1.1.5. Configure Docker pull rate limit

######## 6.8.9.3.1.1.6. Change the Docker installation folder

####### 6.8.9.3.1.2. Docker hardening guide

######## Note

* The settings below can also be applied to Podman, with the exception of limiting available memory, limiting available CPU, and limiting PIDS.

* If you do not want to apply Docker memory limitations, you should explicitly set the advanced parameter: limit.docker.memory to false.

######## Tip

* We recommend reviewing Docker network hardening below before changing any parameters in the configuration file. To securely run Docker containers, we recommend using the latest Docker version.

###### 6.8.9.3.2. Podman

####### Note

* When upgrading an engine, the engine keeps the previously used container management type (regardless of distribution version).

####### 6.8.9.3.2.1. Change the container storage directory

######## Note

* Alternatively, the runroot setting may be set to some temporary directory that is accessible by the user demisto. If you choose to set the runroot, it must be a directory that is mounted as tmpfs (temporary filesystem), unlike the graphroot.

######## Warning

* Do not use NAS storage or a temporary (tmpfs) directory for the graphroot setting. The graphroot needs to be a local, non-temporary directory for Podman to work. For more information, see https://en.wikipedia.org/wiki/Network-attached_storage.

######## Tip

* We recommend reserving 150 GB for container storage, either in the /home partition or a different storage directory that you have set using the graphroot key.

####### 6.8.9.3.2.2. Install Podman

######## Note

* This procedure is intended for RHEL 8 or later. It may not work for other operating system types. Do not use NAS storage for the $HOME directory. The directory needs to be a local directory for Podman to work.

* If you edit the file with the root user, make sure to set the demisto user as file owner by running chown demisto:demisto /home/demisto/.config/containers/registries.conf

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

####### 6.8.9.3.2.3. Migrate From Docker to Podman

####### 6.8.9.3.2.4. Troubleshoot Podman

######## Note

* This step removes all Podman images, including any custom images you may have created.

* $(id -u demisto) is used to get the demisto user ID, which is part of the directory name. For example, /tmp/podman-run-993 Not all the directories above may be present.

* When you run podman container cleanup --rm -a, you might see a message such as running or paused containers cannot be moved without force. The message can be safely ignored, as it only pertains to current running containers, which are not removed.

* To change to the demisto OS user, run the following command: sudo su - -s /bin/bash demisto

* You must switch to user demisto before running the "system migrate" (running it as root will have no effect).

* The "system migrate" must be done by the user demisto.

######## Important

* The runroot must be located under the tmpfs file system type. This is required to clean Podman's run state on reboot and for performance reasons.

######## Caution

* Unlike the runroot, the graphroot must NOT be located under the tmpfs file system type. Using tmpfs for the graphroot might corrupt container images, causing command executions to fail. It also degrades performance by forcing Podman to needlessly re-pull images.

##### 6.8.9.4. Manage engines

###### Navigation

  You can manage your engines and load-balancing groups by going to Settings → Configurations → Data Broker → Engines

##### 6.8.9.5. Upgrade an engine

###### Note

* The upgrade.conf file is available on the engine after it has been upgraded to Cortex XSIAM 3.1. Any custom variables you add to the file are applied when you upgrade from Cortex XSIAM 3.1 to Cortex XSIAM 3.2 or later.

##### 6.8.9.6. Remove an engine

##### 6.8.9.7. Configure engines

###### Note

* A day is defined as 24 hours and may not exactly correspond to calendar days due to daylight savings, leap seconds, etc.

* In addition, to support engine upgrades from the UI, edit the /usr/local/demisto/upgrade.conf file on the engine to include the SERVER_URLS setting with the new tenant's address. Include only the host, without https:// or any additional path at the end of the host name. For example: SERVER_URLS="api-example.us.paloaltonetworks.com"

* If the engine loses communication for longer than this time, it will disconnect and you need to restart the service.

###### 6.8.9.7.1. Configure the engine to use a web proxy

####### Note

* You need to configure Docker to use a proxy. When using a BlueCoat proxy, ensure you encode the values correctly.

* In an environment with a single engine, go to /usr/local/demisto/upgrade.conf. In an environment with multiple engines, go to /usr/local/demisto/<engine-name>/upgrade.conf, replacing <engine-name> with the name of the engine. Note that the key is in the upgrade.conf file and must be https_proxy, even if your proxy address starts with http://.

###### 6.8.9.7.2. Configure the engine to call the server without using a proxy

####### 6.8.9.7.2.1. Use NGINX as a reverse proxy

######## Note

* For multi-tenant deployments, replace location ~ ^/(websocket|d1ws|d2ws) { with location ~ ^/(acc_\S+/)?(websocket|d1ws|d2ws)

###### 6.8.9.7.3. Configure an engine to use custom certificates

##### 6.8.9.8. Use an engine in an integration

###### Note

* Long-running integrations should not run on load-balancing groups.

##### 6.8.9.9. Run a script using an engine

###### Navigation

  Investigation & Response → Automation → Scripts

##### 6.8.9.10. Troubleshoot engines

###### Note

* Ensure that pop-ups are not blocked by your browser.

* If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom path. --keep - Extracts the installer files into the current working directory (without cleaning at the end). If using installer...

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl status d1_<Engine _name>

* Any changes made to variables in the upgrade_engine.sh file are reset after each upgrade. We recommend instead using the upgrade.conf file to set variables.

* You can ignore the following error: Cannot create folder '/var/lib/demisto'

###### Navigation

  When troubleshooting engines, access the logs from Settings → Configurations → Engines and select the engine from which you want to download the logs

##### 6.8.9.11. Troubleshoot integrations running on engines

###### Note

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

* Docker CE installations typically run Docker, while Docker EE installations typically run dockerroot.

### 6.9. Response actions

#### Caution

* Response actions are not supported for Android endpoints.

#### 6.9.1. Initiate a Live Terminal session

##### Note

* You can run PowerShell 5.0 or a later release on Live Terminal of Windows.

* Network drives are not supported.

* On Windows endpoints, you cannot run GUI-based cmd commands like winver or appwiz.cpl.

* Disabling Live Terminal does not take effect on sessions that are in progress.

##### Tip

* You can fine-tune the Live Terminal session visibility on the endpoint by adjusting the User Interface options in your Agent Settings Profile.

#### 6.9.2. Isolate an endpoint

##### Note

* IP-based file storage protocol traffic will also be blocked. This might affect endpoint functionality if the endpoint uses such mounts.

* If file system operations become unresponsive during isolation, such as being unable to list folder content, unmount the mounted network shares.

##### Tip

* If needed, Filter the list of endpoints.

#### 6.9.3. Pause endpoint protection

##### Note

* Pausing your endpoint protection modules leaves your machines exposed to risks.

##### Navigation

  Investigation & Response → Response → Action Center and locate Action Type Pause Endpoint Protection or Resume Endpoint Protection

#### 6.9.4. Remediate changes from malicious activity

##### Prerequisite

* To initiate remediation suggestions, you must have the following system requirements: An App Administrator, Privileged Responder, or Privileged Security Admin role permissions which include the remediation permissions. EDR data collection enabled. Agent version 7.2 or above on Windows endpoints.

##### Note

* Endpoints that are part of the Case view and do not meet the required criteria are excluded from the remediation analysis.

#### 6.9.5. Run agent scripts on an endpoint

##### Prerequisite

* To run scripts on an endpoint, you must have the following system requirements: Endpoints running the Agent v7.1 and later. Since the agent uses its built-in capabilities and many available Python modules to execute the scripts, no additional setup is required on the endpoint. Role in the hub with the following permissions to run and configure...

##### Note

* *Since all scripts are running under System context, you cannot perform any registry operations on user-specific hives (HKEY_CURRENT_USER of a specific user).

* Always use lowercase for variable names.

* Disabling Script Execution does not take effect on scripts that are in progress.

#### 6.9.6. Search and destroy malicious files

##### Prerequisite

* The following are prerequisites to enable Cortex XSIAM to search and destroy files on your endpoints: Supported platforms:    Windows: Cortex XDR agent version 7.2 or a later. If you plan to enable Search and Destroy on VDI sessions, you must perform the initial scan on the Golden Image.   Mac: Cortex XDR agent version 7.3 or a later release running on...

##### Note

* The Cortex XSIAM agent does not include the following information in the local files inventory: Information about files that existed on the endpoint and were deleted before the Cortex XSIAM agent was installed. Information about files where the file size exceeds the maximum file size for hash calculations that are pre-configured in Cortex XSIAM . If...

#### 6.9.7. Manage external dynamic lists

##### Note

* To configure an EDL, you must have a role that includes EDL permissions, such as Instance Admin or Account Admin. Configuring custom certificates or private API Keys in the EDL integration instance is supported only on engines, not on the Cortex XSIAM server. For EDL integrations on the server, you must set a username and password. For long-running...

* The legacy external dynamic list PAN-OS integration is deprecated. Configure the EDL integration by clicking the Automation & Feed Integration link.

* If the EDL integration runs on the Cortex XSIAM server, you do not need to enter a Listen Port in the instance settings. The system auto-selects an unused port for the EDL integration when the instance is saved. If you enter a value for Listen Port, it will be overwritten by the port auto-selected by the system

##### Important

* The EDL URL must always be prefixed by ext-.

#### 6.9.8. Collect a memory image

##### License Type

  This functionality has the following license requirements: Forensics add-on license.

### 6.10. Forensics

#### License Type

  Requires the Forensics add-on

#### 6.10.1. Forensic investigations

##### 6.10.1.1. Manage an investigation

###### 6.10.1.1.1. Create a new investigation

####### Note

* To set up user permissions, you must have Scope-Based Access Control (SBAC) enabled.

###### 6.10.1.1.2. Edit an investigation

###### 6.10.1.1.3. Close an investigation

####### Note

* When you close an investigation, Palo Alto Networks has a grace period of 24 hours before deleting any collections associated with the investigation. During this timeframe, you have the option to cancel the close investigation action.

###### 6.10.1.1.4. User permissions

####### Note

* Even if a user does not have access to view an investigation via the Forensics Investigations page, they can still query the results of the collections using an XQL query.

##### 6.10.1.2. Data collection

###### 6.10.1.2.1. Hunting

####### 6.10.1.2.1.1. Create a hunt

######## Note

* You can save hunts in an incomplete state and edit them later. After a hunt has run, you cannot edit it. Instead, you can duplicate to create a new hunt with the same configuration in order to edit.

* When search fields are specified, the results of the search are limited based upon those filters. If more than one entry in a search filter field, the search returns entries that match any of the provided entries. For example: A File Search with two specified paths ("C:\Test\*" and "C:\Windows\*") will return results from both the Test folder and the...

####### 6.10.1.2.1.2. Hunt results

######## Note

* The grouping button () shows the number of affected endpoints grouped by executable name. This enables you to perform hunting via frequency analysis (referred to as stacking) and provides a birds eye view of potential malware files that require further analysis.

* The grouping button () shows the number of affected endpoints grouped by file path. This enables you to perform hunting via frequency analysis (referred to as stacking) and provides a birds eye view of potential malware files that require further analysis.

####### 6.10.1.2.1.3. Hunt status

###### 6.10.1.2.2. Triage

####### 6.10.1.2.2.1. Create a triage

####### 6.10.1.2.2.2. Upload an offline triage package

######## Note

* Do not upload memory images captured by the Offline Triage Collector. These images are collected for analysis using third-party tools and are not intended for upload.

####### 6.10.1.2.2.3. Offline triage collection

######## Note

* Security software running on the endpoint (including the Cortex agent) can interfere or block the execution of the offline triage collector. Disable any security software on the endpoint while the collector is running or whitelist the collector in your security software before running the offline triage collector.

####### 6.10.1.2.2.4. Triage results

####### 6.10.1.2.2.5. Triage status

##### 6.10.1.3. Analysis and documentation

###### 6.10.1.3.1. Review alerts

###### 6.10.1.3.2. Investigation timeline

###### 6.10.1.3.3. Key assets & artifacts

##### 6.10.1.4. Export

###### Note

* You can export a collection more than once.

### 6.11. Notebooks

#### Prerequisite

* Cortex XSIAM Notebooks usage requires the following. Cortex XSIAM Enterprise or Cortex XSIAM Premium. Apps and XQL RBAC permissions.    To use Notebooks, you must have the View/Edit permissions in Settings → Configurations → Access Management → Roles → Apps → Jupyter.   To configure Notebooks, you must have the View/Edit permissions...

#### Note

* You can only add one instance of Notebooks. Cortex XSIAM Notebooks has access to approved sites on the internet when embedded in Cortex XSIAM. The Notebooks instance includes restart options.

#### Navigation

  Settings → Configurations → Integrations → Apps

  To edit the Notebooks instance, from Settings → Configurations → Integrations → Apps, hover over the instance and select the edit icon

#### 6.11.1. Manage datasets in Notebooks

##### Note

* If a schema is not provided, the function detects the schema automatically.

* Using this function, you can only delete datasets created using the Notebooks APIs . When you delete a dataset, the rules that use the dataset return an error.

#### 6.11.2. Notebooks scheduler

### 6.12. Build XQL queries

#### 6.12.1. About the Query Builder

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

#### 6.12.2. How to build XQL queries

##### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

##### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

##### 6.12.2.1. Get started with XQL queries

###### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

##### 6.12.2.2. Useful XQL user interface features

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

##### 6.12.2.3. XQL Query best practices

##### 6.12.2.4. Expected results when querying fields

##### 6.12.2.5. Create XQL query

###### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

##### 6.12.2.6. Review XQL query results

###### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* In order for Cortex XSIAM to provide a histogram for a field, the field must not contain an array or a JSON object.

##### 6.12.2.7. Translate to XQL

###### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

##### 6.12.2.8. Graph query results

###### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

#### 6.12.3. Query Builder templates

##### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

##### 6.12.3.1. Get started with Query Builder templates

##### 6.12.3.2. Considerations for using Query Builder templates

##### 6.12.3.3. Create a query from a template

###### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

##### 6.12.3.4. Run a free text query

###### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

##### 6.12.3.5. Query Builder template examples

###### Navigation

  Investigation & Response → Search → Query Builder

#### 6.12.4. Edit and run queries in Query Center

##### Navigation

  Investigation & Response → Search → Query Center

##### 6.12.4.1. Query Center reference information

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 6.12.5. Manage scheduled queries

##### Navigation

  Investigation & Response → Search → Scheduled Queries

##### 6.12.5.1. Scheduled Queries reference information

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 6.12.6. Manage your personal query library

##### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

#### 6.12.7. Legacy Query Builder

##### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

##### 6.12.7.1. Create authentication query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.12.7.2. Create event log query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.12.7.3. Create file query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.12.7.4. Create image load query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.12.7.5. Create network connections query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.12.7.6. Create network query

###### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

##### 6.12.7.7. Create process query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 6.12.7.8. Create registry query

###### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

##### 6.12.7.9. Query across all entities

###### Navigation

  Investigation & Response → Search → Query Builder

### 6.13. Research a known threat

## 7. Threat management

### 7.1. Enable prompt log collection in Azure

### 7.2. Detection rules

#### 7.2.1. What are detection rules?

##### 7.2.1.1. What's an IOC?

###### Note

* Cortex XSIAM supports a maximum of 4,000,000 IOCs.

###### 7.2.1.1.1. IOC rule details

####### Note

* Field cannot exceed 36 characters.

####### Navigation

  In the Threat Management → Detection Rules → IOC page, you can view all configured or uploaded indicators of compromise (IOCs

###### 7.2.1.1.2. Create an IOC rule

####### Note

* To ensure your IOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically does the following: Disables any IOC rules that reach 5000 or more hits over 24 hours. Creates a rule exception based on the PROCESS SHA256 field for IOC rules that hit more than 100 endpoints over 72 hours. If you have the Threat...

####### Navigation

  In Threat Management → Detection Rules → IOC, select + Add IOC

##### 7.2.1.2. What's a BIOC?

###### 7.2.1.2.1. BIOC rule details

####### Navigation

  Manage your behavioral indicator of compromise (BIOC) rules in Threat Management → Detection Rules → BIOC

###### 7.2.1.2.2. Create a BIOC rule

####### License Type

  Custom prevention rules are supported on Cortex XSIAM agent 7.2 and later versions and enable you to configure and apply user-defined BIOC rules to Restriction profiles deployed on your Windows, Mac, and Linux endpoints.

####### Note

* To ensure your BIOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically does the following: Disables BIOC rules that reach 5000 or more hits over a 24-hour period. Creates a rule exception based on the PROCESS SHA256 field for BIOC rules that hit more than 100 endpoints over a 72 hour period.

* A cloud_audit_log dataset requires a Cortex XDR Pro per GB license. Currently, you cannot create a BIOC rule on customized datasets and only the filter stage, alter stage, and functions without any aggregations are supported for XQL queries that define a BIOC. For BIOC rules, the field values in XQL are evaluated as case insensitive (config...

* To demonstrate the expected behavior of the rule before you save it, Cortex XSIAM tests the BIOC on historical logs. After you save a BIOC rule, it will operate both on historical logs (up to 10,000 hits) and on new data received from your log sensors.

* To demonstrate the expected behavior of the rule before you save it, Cortex XSIAM tests the BIOC on historical logs. After you save a BIOC rule, it will operate on both historical logs (up to 10,000 hits) and new data received from your log sensors.

* You can only import files that were exported from Cortex XSIAM. You can not edit an exported file.

* You can only add to existing profiles you created, Cortex XSIAM Default profiles will not appear as an option.

* Auto-disable will turn off both the BIOC rule detection and the BIOC prevention rule.

###### 7.2.1.2.3. Manage Global BIOC Rules

##### 7.2.1.3. What's a correlation rule?

###### Navigation

  After you configure your correlation rules, you can manage them in Threat Management → Detection Rules → Correlations, and view and analyze the generated issues in Cases and the Issues Table

###### 7.2.1.3.1. Correlation rule details

####### Note

* Only an administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM .

* For more information on troubleshooting server errors in scheduled correlation rules, Troubleshoot server errors in scheduled correlation rules.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

####### Navigation

  If you are assigned a role that enables Investigation → Rules privileges, you can manage all user-defined Correlation Rules from Threat Management → Detection Rules → Correlations

###### 7.2.1.3.2. Create a correlation rule

####### Prerequisite

* To enable pivots from issues to a third-party source system, ensure that you know the dataset field name which contains the URL of the source system. Some vendors already provide this URL as part of their API, and you can find it in the third-party product dataset. If there is no URL, you cannot enable this feature.

####### Note

* When creating a Real Time Correlation Rule, you can only generate an issue as the resulting action for the Correlation Rule. All other options are disabled. To ensure your Correlation rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically disables Correlation rules that reach 5000 or more hits over a...

* When you open the New Correlation Rule editor from XQL Search, this XQL Search field is already populated with the XQL query that you defined. An administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM . All other users can only create and view queries built with an existing dataset.

* The XQL features for call, top, and wildcards in datasets (dataset in (<dataset prefix>_*)) are currently not supported in Correlation Rules. If you add them to the XQL definition, you will not be able to Create or Save the Correlation Rule. The XQL features for transaction in datasets (dataset in (<dataset prefix>_*)) are currently not supported in...

* The incident that contains the issues will also be assigned to the selected domain. For more information, see Case and issue domains. If you want to generate a health issue, choose the Health domain. For more information about health issues, see About health issues.

* If a generated issue has severity Medium or above, a case is automatically opened. Low severity issues generated by correlation rules are not grouped into cases.

* There is no validation or auto complete for these parameters and the values can be null or empty. In these scenarios, Cortex XSIAM does not display the null or empty values, but adds the text NULL or EMPTY in the descriptions.

* When more than one XDM field is listed, Cortex XSIAM looks for the field value according to the order of the fields listed.

* When Use the Cortex XSIAM default incident enrichment is not selected and you have not mapped any issue fields, the issue is dispatched into a new incident.

####### Important

* The maximum size of a lookup dataset is 50 MB. If the data exceeds this limit, the add to lookup action fails.

####### Tip

* When creating your correlation rule, you can use predefined values for different fields in the editor, such as Alert Name, Alert Description, and Drill-Down Query. For more information, Field replacement syntax in correlation rules.

####### Navigation

  You can create a new correlation rule from either the Threat Management → Detection Rules → Correlation Rules page or when building a query in XQL Search

###### 7.2.1.3.3. Field replacement syntax in correlation rules

###### 7.2.1.3.4. Manage correlation rules

####### Note

* Execute Rule is not available for real time correlation rules.

###### 7.2.1.3.5. Monitor correlation rules

####### Note

* In the dataset, the Query start time and Query end time indicate the time frame of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

###### 7.2.1.3.6. Troubleshoot server errors in scheduled correlation rules

##### 7.2.1.4. Manage IOC and BIOC rules

###### Note

* For Analytics BIOC rules, you can only disable and enable rules.

* You cannot delete global BIOCs delivered with content updates.

* For BIOC rules that are applied to prevention profiles: If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention on the agent works as usual. If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention...

* When a BIOC rule is disabled automatically by Cortex XSIAM, for example due to the server anti flooding mechanism, prevention on the agent works as before.

###### Navigation

  Threat Management → Detection Rules → BIOC

### 7.3. Analytics

#### 7.3.1. Analytics engine

#### 7.3.2. Analytics sensors

#### 7.3.3. Coverage of MITRE Attack tactics

#### 7.3.4. Review MITRE ATT&CK framework coverage

##### Note

* When a contributing data source type is active, it does not imply that all the rules and detectors associated with the data source type are active. Rule applicability is dependent on the data source's context and configuration. To enable an active status, data source types require the following setup: Endpoint: Installed Cortex XDR agent. Network: A...

#### 7.3.5. Analytics detection time intervals

##### Note

* When establishing a baseline, detectors compute limits beyond which network activity will require an issue. In some cases, detectors do not compute baseline limits; instead they are predetermined by Cortex XSIAM engineers. The engineers determine the values used for predetermined limits using statistical analysis of malicious activity recorded...

#### 7.3.6. Analytics issues and Analytics BIOCs

#### 7.3.7. View and manage Analytics rules

#### 7.3.8. Identity Analytics

##### Navigation

  After configuring your Cloud Identity Engine instance and Cortex XSIAM Analytics, select Settings () → Configurations → Cortex XSIAM - Analytics, and in the Featured in Analytics section, Enable Identity Analytics

#### 7.3.9. Identity Threat Module (ITDR)

#### 7.3.10. AI Detection & Response in Cortex XSIAM (Beta)

##### Prerequisite

* To enable AIDR, you must have one of the following user roles: Instance Admin or Account Admin.

##### Navigation

  Settings → Configurations → Cortex - Analytics

##### 7.3.10.1. Data sources and supported services

##### 7.3.10.2. AI Detection & Response Dashboard

##### 7.3.10.3. Collect prompt logs

###### 7.3.10.3.1. Prompt log collection in AWS

###### 7.3.10.3.2. Enable prompt log collection in Azure

####### 7.3.10.3.2.1. Configure the Azure Event Hub collection in Cortex XSIAM

####### 7.3.10.3.2.2. Set up prompt logging

####### 7.3.10.3.2.3. Log HTTP data

####### 7.3.10.3.2.4. Configure diagnostic settings:

### 7.4. Threat Intel Management

#### License Type

  Requires the TIM add-on

#### 7.4.1. Get started with Threat Intel Management

##### Note

* By default, the Palo Alto Networks Wildfire Reports integration, which is used as part of the sample analysis feature, is installed and configured. The Palo Alto Networks Wildfire v2 integration, for dynamic malware analysis, is also installed, but you must add an integration instance. No API key is required.

* You must have the Cortex XSIAM Threat Intel Management (TIM) Add-on to use this feature.

##### 7.4.1.1. What is Threat Intel Management?

###### Note

* You must have the Cortex XSIAM Threat Intel Management (TIM) Add-on to use this feature.

##### 7.4.1.2. Threat Intel Management use cases

###### Navigation

  Settings → Configurations → Data Collections → Automation & Feed Integrations and in the Category field, select Threat Intel Feeds

##### 7.4.1.3. Roles and responsibilities in Threat Intel Management

##### 7.4.1.4. Indicator concepts

###### Note

* You can store up to 100,000,000 indicators.

##### 7.4.1.5. Indicator lifecycle

###### Note

* To run enhancement scripts and reputation commands, you must configure a relevant enrichment integration, such as VirusTotal, IPinfo v2, etc.

###### Tip

* We recommend defining your policy for handling expired indicators.

#### 7.4.2. Indicator configuration

##### 7.4.2.1. Customize indicator fields and types

###### 7.4.2.1.1. Create an indicator type

####### Note

* If you miss mapping any field, you can create additional new indicator fields and either relate them to all indicator types, or relate them only to the new indicator type (recommended).

####### Navigation

  Settings → Configurations → Object Setup → Indicators → Types

####### 7.4.2.1.1.1. Indicator type profile

######## Note

* Indicator cache expiration rules only apply to standard enrichment (for example, running the enrichIndicators command). If you run a reputation command, such as !ip, the commands executes even if the cache has not expired.

####### 7.4.2.1.1.2. File indicators

######## Note

* A new File indicator only affects new indicators ingested to the Cortex XSIAM platform. Indicators that were already in Cortex XSIAM continue to appear as their respective hash-related indicators.

######## Navigation

  Settings → Configurations → Object Setup → Indicators → Types

####### 7.4.2.1.1.3. Formatting scripts

######## Note

* Formatting scripts must have the indicator-format tag to appear in the list.

* Formatting scripts for out-of-the-box indicator types are system-level, which means that the formatting scripts for these indicator types are not configurable. To create a formatting script for an out-of-the-box indicator type, you need to disable the existing indicator type and create a new (custom) indicator type. If you configured a formatting...

####### 7.4.2.1.1.4. Enhancement scripts

######## Note

* Enhancement scripts are different from reputation commands. A reputation command runs every integration that has that command within it, to enrich the indicator. The reputation command ip , for example, runs every IP integration command in your enabled integrations, to collect data from multiple sources. An enhancement script is manually run after the...

* Enhancement scripts must have the enhancement tag applied to appear in the list.

####### 7.4.2.1.1.5. Reputation scripts

######## Note

* The Reputation script overrides any default settings for the indicator that relates to the verdict.

* Reputation scripts must have the reputation tag applied to appear in the list.

####### 7.4.2.1.1.6. Reputation commands

######## Note

* Running a reputation command directly (such as !ip) might not apply the result to an indicator, nor does it use the enrichment cache. To ensure an indicator is enriched, and to take advantage of caching, use the enrichIndicators command or the Enrich button in the UI. This runs the appropriate reputation command/script based on the indicator type...

####### 7.4.2.1.1.7. Map custom indicator fields

######## Note

* Some integrations have indicator mappers and classifiers, such as AWS. If you want to use an integration mapper or classifier, see Indicator classification and mapping.

######## Navigation

  Settings → Configurations → Object Setup → Indicators → Types

###### 7.4.2.1.2. Create an indicator field

####### Note

* Cortex XSIAM IOC fields are based on the STIX 2.1 specifications. For more information, see Indicator field structure.

* The following HTML tags are not permitted: blockquote, del, dd, div, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, iframe, ins, li, math, noscript, ol, pre, p, script, style, table, ul, address, article, aside, canvas, details, dialog, figcaption, figure, footer, header, hgroup, main, nav, output, progress, section, video. The following CSS tags...

####### Navigation

  Settings → Configurations → Object Setup → Indicators → Fields → New Field

####### 7.4.2.1.2.1. Indicator field structure

####### 7.4.2.1.2.2. Indicator field trigger scripts

######## Note

* Indicator field trigger scripts must have the field-change-triggered-indicator tag to appear in the list.

##### 7.4.2.2. Indicator classification and mapping

###### Note

* When creating a new indicator type, you classify and map the indicator fields in the indicator type settings. For more details, see Map custom indicator fields.

* You can optionally skip importing data. Click the pencil on the right of each indicator type on the right pane to enter the value manually.

* In the Classification & Mapping page, the mapping does not indicate for which indicator types they are configured. When creating a mapper, it is best practice to add to the mapper name and the indicator type the mapper is for. For example, Mail Listener - Phishing. When mapping a list, we recommend you map to a multi-select field. Short text fields do...

##### 7.4.2.3. Indicator extraction

###### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Reputation commands, such as !ip and !domain, can only be used after you configure and enable a reputation integration instance, such as VirusTotal and Whois.

* The inline configuration may delay playbook execution.

* While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks. All indicators are automatically extracted and enriched before a playbook is run. For an on-field change, extraction occurs before the next playbook tasks run.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

###### 7.4.2.3.1. Set the indicator extraction mode for a playbook task

###### 7.4.2.3.2. Disable indicator extraction for scripts or integrations

##### 7.4.2.4. Configure indicator expiration

###### Note

* You need to run CLI commands in the Case or Issue War Room.

* If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its expiration method reverts to that of the indicator type (time-based). Time-based expiration is set according to feed reliability. If the same indicator appears on multiple feeds, the...

##### 7.4.2.5. Configure Threat Intelligence feed integrations

###### Note

* Some feeds only provide information about new indicators and do not specify when indicators are removed. Indicators from these feeds cannot be automatically expired on removal. If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its...

##### 7.4.2.6. Exclude indicators from enrichment

##### 7.4.2.7. Generate issues from indicators using indicator rules for prevention and detection

###### Note

* Indicators should be present in the Threat Intelligence database (Threat Management → Threat Intelligence → Indicators) before creating detection and prevention rules.

* Although you can create IOC rules for detection, indicator rules are designed to leverage threat intelligence indicators like MD5 and SHA256 hashes that are present in your TIM library. These rules directly integrate with and rely on the indicators ingested and managed by TIM. Indicators must be in the TIM database before creating these rules. For more...

* You can't change the Preventable = True, Status = Active and Type = File filters, which comply with the requirements of the supported indicator type for Prevention on the Agent.

* The Indicator Rule shows the number of issues generated by the rule, You can view the issues that were generated using the Indicator rule, by right-clicking the rule and select View related issues.

* You can't change the Detectable = True and Status = Active filters, which comply with the requirements of the supported indicator type for detection.

* The Issue source is Threat Intelligence.

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

##### 7.4.2.8. Export indicators

###### Caution

* You should not run a query on a field that you might change in the playbook flow. For example, you shouldn't have a playbook with query Verdict:Malicious and then change the indicator verdict as a part of the playbook.

#### 7.4.3. Indicator management

##### Note

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

#### 7.4.4. Query indicators with Unit 42 Intel data

##### Note

* You can search or look up indicators. A search, which can include wildcards and complex queries, can return multiple results. Searches are only performed in Cortex XSIAM. Lookups are exact values, are performed in both Cortex XSIAM and Unit 42 Intel data, and can only return one result.

#### 7.4.5. Indicator investigation

##### 7.4.5.1. Indicator verdict

##### 7.4.5.2. Extract and enrich an indicator

###### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Triggering enrichment on a substantial number of indicators can take time (because it's activating all enrichment integrations per indicator) and can result in performance degradation.

* Reputation commands, such as !ip, !domain can only be used when you configure and enable a reputation integration instance, such as VirusTotal and WHOIS.

##### 7.4.5.3. Expire an indicator

###### Note

* You need to run these commands in the Case or Issue War Room.

##### 7.4.5.4. Manage indicator relationships

###### Note

* You can also add an indicator relationship from the Quick View when selecting an indicator from an issue.

##### 7.4.5.5. Delete and exclude indicators

###### Caution

* Ensure you are using the correct syntax when defining the values for your exclusion lists.

##### 7.4.5.6. Investigate files using sample analysis

###### Note

* WildFire provides verdicts and analysis reports without requiring a license key. To send files to WildFire for analysis, see Set up Malware Prevention Profiles.Set up malware prevention profiles

* When searching on the Sample Analysis page for relationships -relationships"", some results may appear without their specific relationships listed, due to internal relationship permissions.

##### 7.4.5.7. Use sessions and submissions in your investigation

###### Note

* When searching on the Sessions & Submissions page for relationships -relationships"", some results may appear without their specific relationships listed, due to internal relationship permissions.

* The Application is matched to the type of application traffic detected in a session. For example, a search for the Application web-browsing returns sessions during which web browsing over HTTP occurred. See Applipedia for an updated list of applications that Palo Alto Networks identifies.

## 8. Inventory management

### 8.1. Asset management

#### 8.1.1. All Assets

##### Note

* Keep the following caveats in my mind when working with the Asset Inventory page: Instance Administrators are able to view all Inventory views without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope SBAC is not currently available for custom roles with View/Edit permissions on the...

* The options available are dependent on your license.

##### 8.1.1.1. Container Images

###### Navigation

  All Assets → Compute → Container Images

##### 8.1.1.2. Kubernetes Cluster

###### Navigation

  Inventory → All Assets → Compute → Kubernetes Cluster for a Kubernetes clusters assets overview

##### 8.1.1.3. Container Instances

###### Navigation

  Asset Inventory → Compute → Container Instances

##### 8.1.1.4. External Surface assets

###### License Type

  Requires the Attack Surface Management (ASM) add-on

###### 8.1.1.4.1. External Surface attribution evidence

#### 8.1.2. Network configuration

##### 8.1.2.1. Configure your network parameters

###### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

* Viewing external IP address ranges requires the Attack Surface Management add-on.

###### Navigation

  In Cortex XSIAM , select Assets → Network Configuration → Internal Domain Suffixes

#### 8.1.3. Asset Groups

##### Note

* When you create or edit an Asset Group, the changes are applied immediately to new assets and to existing assets that have been updated. However, it may take a few hours for the changes to appear on existing assets that have not been updated.

##### Navigation

  Inventory → Assets → Groups → Add Group

#### 8.1.4. Asset Roles

##### Note

* Asset Roles are available only if the Identity Threat Module add-on is enabled.

##### 8.1.4.1. Manage Asset Roles for Endpoints

###### Note

* Endpoint Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added endpoint removes the endpoint from the Included Endpoints list. If this endpoint is detected automatically as having this asset role in the future, it will appear in the Included Endpoints list. Excluding a manually added endpoint ensures that even if in the future the endpoint is detected as having this asset role, this...

##### 8.1.4.2. Manage Asset Roles for Users

###### Note

* User Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added user removes the user from the Included Users list. If this user is detected automatically as having this asset role in the future, it will appear in the Included Users list again. Excluding a manually added user ensures that even if in the future the user is detected as having this asset role, this detection is overridden and...

###### 8.1.4.2.1. Honey user

####### Prerequisite

* The honey user role is available only if the Identity Threat Module add-on is enabled.

#### 8.1.5. Manage Asset Scores

##### Note

* The Hosts tab is available if the Identity Threat Module add-on is enabled.

* As new alerts are associated with incidents, the User and Host Scores are recalculated. You can view the latest User and Host Scores on the Asset Scores page, or track the Score trend on the User Risk View and Host Risk View.

* Some User Associated Insights may not appear as part of the User Associated Incidents due to the insight generation mechanism. For example, when an insight related to one of the assets in an incident is generated a few days after the associated incident, the insight may not be associated with the incident.

#### 8.1.6. Vulnerability Assessment

##### Prerequisite

* The following are prerequisites for Cortex XSIAM to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XSIAM lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex XSIAM...

* The following are prerequisites for Cortex XSIAM to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex XSIAM collects all the information about the operating system and the installed...

##### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex XSIAM Application Inventory.

##### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

##### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

## 9. Modules

### 9.1. Discovery Engine

#### 9.1.1. What is the Discovery Engine?

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM product that has the Cloud Runtime Security or Cloud Posture Management add-ons.

### 9.2. Cortex Cloud AI Security

#### 9.2.1. What is Cortex Cloud AI Security?

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 9.2.2. Supported services in Cortex Cloud AI Security

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 9.2.3. Cortex Cloud AI Security concepts

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 9.2.4. Cortex Cloud AI Security use cases

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 9.2.5. How to perform advanced AI Security investigations using XQL

##### License Type

  Requires the Posture Management add-on or the Runtime Security add-on.

##### Note

* For more information, see Build XQL queries.Build XQL queries

### 9.3. Cortex Cloud Application Security

#### 9.3.1. Application Security Posture Management (ASPM)

##### 9.3.1.1. ASPM use cases

##### 9.3.1.2. ASPM key features

##### 9.3.1.3. ASPM user roles and permissions

###### Navigation

  You can view AppSec Admin permissions in the tenant by navigating to Settings → Configurations → Roles → AppSec Admin

##### 9.3.1.4. ASPM Command Center

###### 9.3.1.4.1. ASPM Command Center workflow

####### Note

* Breakdown by type: Issues are further broken down by type (such as IAC or Secrets).

##### 9.3.1.5. Coverage

###### 9.3.1.5.1. Coverage in the user interface

####### Navigation

  Modules, → Application Security → AppSec Coverage

##### 9.3.1.6. Backlog baseline

###### 9.3.1.6.1. Backlog use cases

###### 9.3.1.6.2. Issue/Finding classification by scanner

####### Note

* In some cases/vendors, this is not accurate as findings are deleted every time new findings are uploaded. In such cases, the feature may not be accurate or supported For SAST, the vendor does not support policy in pull requests

* Scanner updates and new detections: When a security scanner is updated to support new languages, detection rules, or capabilities, any issues discovered by these new features for existing code are classified as part of the backlog.

###### 9.3.1.6.3. Using Backlog

##### 9.3.1.7. Applications

###### 9.3.1.7.1. How to build an application

####### Prerequisite

* Before you begin, ensure you have connected the necessary data sources. Refer to Onboard data sources for more information.

####### Note

* These filters are represented by icons displayed on the Code pane after selecting a VCS.

* To edit application assets, click the Clear All icon before clicking Finish. This clears all application data, allowing you to restart the application building process from the beginning.

###### 9.3.1.7.2. Application management and visibility

###### 9.3.1.7.3. Business application assets

####### 9.3.1.7.3.1. Business application expanded asset details

######## Note

* The topology graph is available only when all application components (code, pipeline, build and deploy), are configured.

##### 9.3.1.8. Repositories as assets

###### 9.3.1.8.1. Explore repository assets

###### 9.3.1.8.2. In-depth repository asset information

###### 9.3.1.8.3. Manage Repository assets

###### 9.3.1.8.4. Export Software Bill of Materials (SBOM)

###### 9.3.1.8.5. Manage issues detected in repositories

####### Note

* You can also find the repository issues in the general issue inventory table, and in the dedicated inventory of issues for each scanner type (see step 4 above for details).

##### 9.3.1.9. Onboard data sources

###### 9.3.1.9.1. Onboard version control systems

####### Note

* Application Security (which includes IaC and Secrets scanning), is an add-on to a license (such as Posture Security) that must be purchased separately.

* Disclaimer: When onboarding with third-party data sources, we outline the required steps for setup, but we do not monitor these external resources, and they may change over time. Always refer to the relevant third-party documentation for the most current integration steps.

####### Tip

* Navigate to Settings → Data Sources (under Data Collections) → + Data Source → enter your VCS data source in the search bar.

####### 9.3.1.9.1.1. AWS CodeCommit

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your AWS CodeCommit instances with the following permissions:       Read more...        codecommit:GitPull: Allows users to pull Git repository changes   codecommit:ListBranches: Grants the ability to list branches within a repository   codecommit:GetBranch: Required to get...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* The Resource Name Prefix and ExternalID fields are pre-populated. You can modify the Resource Name Prefix, but DO NOT change the ExternalID!

* To create an additional AWS CodeCommit instance: Hover over the AWS CodeCommit card in the catalog and click Connect Another.

####### 9.3.1.9.1.2. Azure Repos

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your Azure Repos instances with the following permissions and scopes.      Permission   Description       Project Administrator   This permission is required to subscribe to webhooks. For more information, refer to the Microsoft Integrate with service...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* For information on Application Security access to all organizations associated with your user token, refer to the Azure Third party application access via OAuth documentation.

* To create an additional Azure Repos instance: Hover over the Azure Repos card in the catalog and click Connect Another.

######## Caution

* Do not limit authorization scope.

####### 9.3.1.9.1.3. Bitbucket Cloud

######## Prerequisite

* Before you begin: Authorize the user with the following required permissions and scopes to integrate Application Security with your Bitbucket Cloud instances.  Note For write access, go to Bitbucket > Repository Settings and grant the user write access to the relevant repositories.     Permissions    Repository Administrator: To scan pull requests...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Cloud instance: Hover over the Bitbucket Cloud card in the catalog and click Connect Another.

####### 9.3.1.9.1.4. Bitbucket Data Center

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your Bitbucket Data Center instances with the following permissions:    Member of Project Collection Administrators: Required to subscribe to the build.complete event and download the permissions report for CI/CD scans. As Organization owners are automatically part of this...

######## Note

* By default, the permissions of the access token are set according to your current access level. It is essential to define two levels of permissions, Project and Repository permissions. The Repository permissions inherit from Project permissions, requiring Repository permissions to match or exceed Project permissions Providing read and write permissions...

* For additional security, it is recommended to set an expiry automatically. The expiry date of a token cannot be changed after it is created. You can see the expiry dates for all your tokens on Profile picture → Manage account → Personal access tokens.

* Select Connect Another Instance if an instance has already been configured.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Data Center instance: Hover over the Bitbucket Data Center card in the catalog and click Connect Another.

######## Important

* Always refer to the Bitbucket documentation for information relating to creating a PAT.

####### 9.3.1.9.1.5. GitHub Cloud

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your GitHub SaaS instances with the following permissions:    Read  access to Dependabot alerts, actions, actions variables, administration, deployments, discussions, metadata, packages, repository hooks, secret scanning alerts, secrets, and security events   Read and write...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* To create an additional GitHub SaaS instance: Hover over the GitHub SaaS card in the catalog and click Connect Another.

####### 9.3.1.9.1.6. GitHub Server

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your GitHub Server instances with the following permissions and scopes:    Permissions    Organization owner permissions   Administrator repository permissions: In order to scan pull requests (PRs), the user performing the integration must have administrative privileges for the...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* The domain is the hostname associated with your GitHub Server instance.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitHub Server instance: Hover over the GitHub Server card in the catalog and click Connect Another.

####### 9.3.1.9.1.7. GitLab SaaS

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your GitLab SaaS instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including all groups...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* A repository can only be integrated with a single instance. The first instance that connects with the repository will be the one that the repository is assigned to. This means that if multiple integrations attempt to connect to the same repository, only the first integration to establish the connection will be associated with that repository.

* To create an additional GitLab SaaS instance: Hover over the GitLab SaaS card and click in the catalog and Connect Another.

####### 9.3.1.9.1.8. GitLab self-managed

######## Prerequisite

* Authorize the user integrating Application Security with your GitLab self-managed instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including all groups and...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* The domain is the hostname associated with your GitLab self-managed instance.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitLab self-managed instance: Hover over the GitLab self-managed card in the catalog and click Connect Another.

###### 9.3.1.9.2. Onboard CI/CD systems

####### 9.3.1.9.2.1. Onboard CircleCI for CI/CD pipeline scans

######## Prerequisite

* Before you begin: User requirements:    Permissions: To enable Cortex XSIAM visibility for all CircleCI projects, a version control system (VCS) user with integration permissions must be authorized. This is because CircleCI's user base integrates with the VCS, inheriting its user permissions. For example, if a GitHub user has access to specific...

######## Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for code scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* To add an additional CircleCI instance, navigate to Settings → Data Sources → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

####### 9.3.1.9.2.2. Onboard Jenkins for CI/CD pipeline scans

######## Prerequisite

* Permissions Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

######## Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for code scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* The integration is added on the console but integration is pending, and will only be completed after completing step 5 below. You can view the pending integration on the Jenkins Instances page: Select Data Sources →  Jenkins → View Details. The type of integration is Pipeline Risks

* Always refer to the official Jenkins documentation when installing plugins on Jenkins servers.

* To add an additional Jenkins instance, navigate to Settings → Data Sources → select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps above.

###### 9.3.1.9.3. Integrate CI tools

####### Note

* For CircleCI CI/CD pipeline scans, refer to CI/CD .

* For Jenkins CI/CD pipeline scans, refer to CI/CD .

####### Navigation

  Settings → Data Sources → hover over a CI tool and click View Details

  Delete an instance: Right-click on an instance of the CI tool → Delete instance → Delete

####### 9.3.1.9.3.1. AWS CodeBuild

######## Prerequisite

* Before you begin: Grant Administrator  permissions to the user integrating AWS CodeBuild with Application Security Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional AWS CodeBuild instance, navigate to Settings → Data Sources → select the menu for your connected AWS CodeBuild instance → + New Instance, and repeat the onboarding steps above.

####### 9.3.1.9.3.2. Onboard CircleCI for code scans

######## Prerequisite

* Before you begin: Grant Administrator permissions to the user integrating Application Security with CircleCI Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

######## Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for CI/CD scans, refer to...

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* To add an additional CircleCI instance, navigate to Settings → Data Sources → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

######## Important

* The cortex-secrets naming convention for the context is mandatory to ensure functionality and must not be changed.

####### 9.3.1.9.3.3. Connect Cortex CLI

######## Prerequisite

* Permissions: Grant the user installing the CLI required permissions. For more information refer to OverviewOverview Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress...

######## Note

* You can view the latest version of the selected OS.

* Recommended: Select With upload results permissions before generating the API key. This option grants the key permission to not only access data but also to upload or send data back. In the API Keys page, the role associated with these permissions is CLI. If you choose to upload without results permissions, the associated role is CLI Read Only Warning:...

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

######## Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter 'CLI' in the search bar to locate the Cortex CLI tool.

####### 9.3.1.9.3.4. GitHub Actions

######## Prerequisite

* Before you begin: Grant Administrator  permissions to the user integrating GitHub Actions with Application Security Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional GitHub Actions instance, navigate to Settings → Data Sources → select the menu for your connected GitHub Actions instance → + New Instance, and repeat the onboarding steps above.

####### 9.3.1.9.3.5. Onboard Jenkins for code scans

######## Prerequisite

* Grant Administrator permissions to the user integrating Application Security with Jenkins Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

* For Application Security CI tools, you must store secrets in Jenkins Credentials for use in your Jenkins pipelines using either of these methods:    Plain text storage: Store secrets directly as plain text in Jenkins Credentials. Access them in your pipeline using the credentials function, which retrieves the secret directly as plain text   Credentials...

######## Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for CI/CD scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* This step is only required for new pipelines For private repositories, ensure the necessary credentials are configured in Jenkins Credentials

* This ensures your build runs within a Docker environment. If a node without Docker is used, the build will fail.

* To add an additional Jenkins instance, navigate to Settings → Data Sources →  select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps.

####### 9.3.1.9.3.6. Onboard Terraform Cloud (Run Tasks)

######## Prerequisite

* Before you begin: Procure a Terraform cloud license that is either a trial license or a TF Cloud license at the TEAM & GOVERNANCE level Grant the user or team the following permissions, depending on integration:    Manage Workspaces permissions at the organization level. These permissions are required to attach and manage the run task on workspaces...

######## Note

* * Application Security performs Image Referencer scans for container image vulnerabilities, as full SCA scans are not supported for Terraform Enterprise (Run Tasks).

* Skip this step if you plan on using an existing token.

* Select Connect Another Instance if an instance has already been configured.

* Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Cloud (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected your Terraform Cloud (Run Tasks) instance → + New Instance, and repeat the onboarding steps.

####### 9.3.1.9.3.7. Onboard Terraform Enterprise (Run Tasks)

######## Prerequisite

* Before you begin: Ensure access to a Terraform Enterprise console to enable you to provide a user or team token that authorizes Application Security to access workspaces and helps regulate run configurations Terraform Enterprise version compatibility: Ensure Run Tasks for workspaces on is compatible with version 1.1.9 and above Terraform Enterprise...

######## Note

* * For container image vulnerabilities, Application Security performs 'Image Referencer' scans within Terraform Enterprise (Run Tasks), as full SCA scans are not currently supported.

* Skip this step if you plan on using an existing token.

* Select Connect Another Instance if an instance has already been configured.

* Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Enterprise (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected Terraform Enterprise (Run Tasks) instance → + New Instance, and repeat the onboarding steps above.

###### 9.3.1.9.4. CLI pipeline code snippets

###### 9.3.1.9.5. Ingest third-party data

####### Note

* Only onboarded and scanned repositories can be mapped.

####### 9.3.1.9.5.1. Ingest Veracode SAST data

######## Prerequisite

* Permissions: The following user permissions are required:    Cortex Cloud: Instance Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions   Veracode: At minimum, Reviewer permissions are required Permissions: The following user permissions are required: Cortex...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between Veracode projects and Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped applications are ingested

####### 9.3.1.9.5.2. Ingest SonarQube SAST data

######## Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Generate and copy a SonarQube API token. Ensure to assign Web API scope to the API token. Refer...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between SonarQube Applications and Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

####### 9.3.1.9.5.3. Ingest Semgrep data

######## Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Create a Semgrep API token  Note To create a Semgrep API token, in Semgrep, navigate to Settings...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between Semgrep Projects Applications and Cortex XSIAM code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

####### 9.3.1.9.5.4. Generic 3rd Party AppSec Collector

######## Important

* File uploads are limited to a maximum size of 10 MB.

######## 9.3.1.9.5.4.1. Onboard the 3rd Party AppSec Collector

###### 9.3.1.9.6. Manage data source integrations

####### Navigation

  Settings → Data Sources → use the search bar to locate the required data source

##### 9.3.1.10. Transporter over Broker VM

###### Prerequisite

* Ensure you have the necessary permissions and have already set up your Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex XSIAM resources. The IP addresses for the Transporter are in the Broker VM Resources section of the Enable access to required PANW resources document Open port 4052 (inbound), which...

###### Note

* The broker enables multiple connections, allowing a single Transporter applet to connect to various VCS instances Multiple Transporter applets cannot be created on a single Broker VM. Each Broker VM is limited to a single Transporter applet instance

###### Warning

* The Transporter applet is not supported for FedRAMP customers.

###### 9.3.1.10.1. Setup a Transporter applet on Broker VM

####### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator)

####### Note

* You cannot add a Transporter applet through Clusters.

####### Navigation

  your AppSec Transporter under the App column → Configure → Add Connection (on the redirected AppSec Transporter setup page

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

###### 9.3.1.10.2. Setup a Transporter on your VCS

####### Prerequisite

* Ensure you have user permissions to onboard data sources  Note The dedicated AppSec Admin role includes the required permissions. Ensure you have user permissions to onboard data sources Before you begin you must setup a Transporter applet on your Broker VM. Refer to Setup a Transporter applet on Broker VM for more information

####### Note

* GitLab Enterprise webhook internal IP restriction: GitLab Enterprise's security policies prevent webhook subscriptions to internal IP addresses (such as broker addresses). These subscriptions can only be enabled through specific instance configuration. For more information, refer to https://docs.gitlab.com/security/webhooks/.

####### Navigation

  Settings → Data Sources → + Add Data Source → select your VCS on-premises data source

##### 9.3.1.11. Manage 3rd party findings and generated issues

##### 9.3.1.12. Manage code weaknesses

###### Note

* You can customize policies to define which findings are categorized as issues.

###### Tip

* You can also view SAST CWE issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Code Weaknesses tab under the Repositories asset inventory. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset...

###### Navigation

  To access SAST code violation issues, under Modules, select Application Security → Issues → Code Weaknesses

###### 9.3.1.12.1. Code weaknesses issue inventory

###### 9.3.1.12.2. Expanded code weaknesses issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 9.3.1.12.3. SAST code weakness findings

####### Note

* Findings on the Cortex XSIAM platform are not intended for direct action; but rather represent data collected by the platform. They must be promoted to issues to enable mitigation efforts to secure your codebase.

#### 9.3.2. CI/CD Security

##### 9.3.2.1. CI/CD Security user roles and permissions

##### 9.3.2.2. CI/CD Assets

###### 9.3.2.2.1. CI/CD Instances as assets

####### 9.3.2.2.1.1. Explore CI/CD Instance assets

######## Navigation

  To access CI/CD pipeline instances, under Inventory, select All Assets → Code → Category → CI/CD Instances

####### 9.3.2.2.1.2. In-depth CI/CD pipeline instance asset information

####### 9.3.2.2.1.3. Manage CI/CD pipeline instances

###### 9.3.2.2.2. CI/CD Pipelines as assets

####### 9.3.2.2.2.1. Explore CI/CD Pipeline assets

######## Navigation

  To access CI/CD pipelines assets, under Inventory, select All Assets → Code → CI/CD Pipelines

####### 9.3.2.2.2.2. In-depth CI/CD pipeline asset information

######## Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

####### 9.3.2.2.2.3. Manage CI/CD pipeline assets

###### 9.3.2.2.3. Version Control System (VCS) Organizations as assets

####### 9.3.2.2.3.1. Explore VCS Organization assets

######## Navigation

  To access VCS Organization assets, under Inventory, select All Assets → Code → VCS Organizations

####### 9.3.2.2.3.2. In-depth VCS Organization asset information

######## Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

####### 9.3.2.2.3.3. Manage VCS organization assets

###### 9.3.2.2.4. VCS Collaborators-as-assets

####### 9.3.2.2.4.1. In-depth Collaborator asset information

####### 9.3.2.2.4.2. Manage Collaborator assets

##### 9.3.2.3. Supply Chain tools

###### Note

* Rejected does not mean the tool is not in use. It allows application security practitioners to search for and remove these tools as needed For information about changing the tool status, refer to Overview

###### 9.3.2.3.1. Supply Chain use cases

####### Navigation

  To access Supply Chain Tools, select Modules → Application Security → Supply Chain Tools (under 3rd Party Tools

###### 9.3.2.3.2. Explore Supply Chain tools

###### 9.3.2.3.3. Expanded Supply Chain tool information

####### Note

* AppSec Admin user permissions are required to perform these actions.

##### 9.3.2.4. CI/CD Risks

###### Note

* Application Security CI/CD pipeline scans create a comprehensive inventory of all CI/CD pipelines in your environment. For more information refer to CI/CD Pipelines as assets.

###### 9.3.2.4.1. CI/CD pipeline issues

####### Navigation

  To access CI/CD pipeline risks issues, under Modules, select Application Security → Issues → CI/CD Risks

###### 9.3.2.4.2. Expanded CI/CD risks issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 9.3.2.4.3. VCS and CI/CD pipeline risk findings

##### 9.3.2.5. CI/CD Rules

###### Note

* Out-of-the-box rules cannot be modified Custom CI/CD rules are not supported

###### 9.3.2.5.1. CI/CD rules roles and permissions

###### 9.3.2.5.2. CI/CD rules inventory

####### Navigation

  In the Filter panel, select Category → Scanner → CI/CD Security

###### 9.3.2.5.3. Create custom CI/CD rules

####### Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

###### 9.3.2.5.4. Manage CI/CD rules

##### 9.3.2.6. CI/CD Policies

###### 9.3.2.6.1. CI/CD policies user roles and permissions

###### 9.3.2.6.2. CI/CD policies inventory

###### 9.3.2.6.3. Create custom CI/CD policies

####### Note

* PR Scan and CI Scan triggers are automatically disabled and unchecked. They can only be enabled if other scan types (that is non-CI/CD risk scans such as Secrets) are also selected, and will only run on non-CI/CD risks types of scans

* You can combine multiple conditions to create complex rules for when the policy should apply. Create conditions that apply to a CI/CD policy which detects high severity CI/CD risks on GitHub: Select Add Filter → Finding Type → CI/CD Risks → AND → Provider → [VCS/CI/CD system] → AND → Severity: → High.

* SBAC scope limitations do not apply to Matching Criteria For CI/CD policies, you can filter Matching Criteria by VCS Organization Name, CI/CD Pipeline [Name/ID], CI/CD Instance [Name/ID] or Collaborator [Name/Email/MFA Enabled/Last Observed]

###### 9.3.2.6.4. Manage CI/CD policies

####### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

##### 9.3.2.7. CI/CD Compliance

###### Navigation

  To access Compliance, select Posture Management → Compliance → Reports or Assessment

###### 9.3.2.7.1. Create CI/CD compliance reports

####### Note

* The CI/CD module supports GitHub and GitLab providers.

* For more information about about Asset Groups, refer to Asset Groups.

* CIS GitLab Benchmark, CIS GitHub Benchmark, and the OWASP Top 10 CI/CD Risks standards are supported.

* For more information about assessment profiles, refer to Use an assessment profile to run compliance checks on your assets.Use an assessment profile to run compliance checks on your assets

####### Navigation

  Posture Management → Compliance → Assessment or Reports

#### 9.3.3. Code Security

##### 9.3.3.1. Code Security user roles and permissions

##### 9.3.3.2. Code Security assets

##### 9.3.3.3. Software packages as assets

###### 9.3.3.3.1. In-depth software package asset information

##### 9.3.3.4. Infrastructure-as-Code (IaC) resources as assets

###### 9.3.3.4.1. Explore IaC assets

####### Navigation

  To access IaC assets, under Inventory, select All Assets → Code → IaC Resources

###### 9.3.3.4.2. In-depth IaC resource asset information

##### 9.3.3.5. Code Security scanners

##### 9.3.3.6. Software Composition Analysis (SCA ) scanners

###### 9.3.3.6.1. Supported Software Composition Analysis (SCA) frameworks and languages

###### 9.3.3.6.2. Software Composition Analysis (SCA) CVE vulnerability issues

####### Tip

* You can also view SCA vulnerabilities in dedicated tabs under other sections when available: In Asset inventories, navigate to Inventory → All Assets → Code:    On the Vulnerabilities tab under Repositories. Refer to In-depth repository asset information for more information Under the All Code inventory: Select an asset from the table →...

####### Navigation

  To access CVE vulnerability issues, under Modules, select Application Security → Issues → Vulnerabilities

####### 9.3.3.6.2.1. SCA CVE vulnerabilities inventory

####### 9.3.3.6.2.2. Expanded CVE vulnerabilities issue information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 9.3.3.6.2.3. CVE vulnerabilities findings

######## Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

######## Navigation

  To access CVE findings, under Modules, select Application Security → Issues → Vulnerabilities → click the Findings tab

####### 9.3.3.6.2.4. Manage SCA CVE vulnerability issues

###### 9.3.3.6.3. License miscompliance issues

####### Tip

* You can also view license miscompliance issues in dedicated tabs under other sections when available: In Application asset inventories: navigate to Inventory → All Assets →  Application → select an option from the Application menu → select an item from the inventory → Package Integrity In Asset inventories, navigate to Inventory → All...

####### Navigation

  To access license miscompliance issues, under Modules, select Application Security → Issues → Licenses

####### 9.3.3.6.3.1. License miscompliance issues inventory

####### 9.3.3.6.3.2. Expanded License miscompliance issues information

####### 9.3.3.6.3.3. License miscompliance findings

######## Navigation

  To access license miscompliance findings, under Modules, select Application Security → Issues → Licenses → click the Findings tab

####### 9.3.3.6.3.4. Open-source software license categories

####### 9.3.3.6.3.5. Manage license miscompliance issues

###### 9.3.3.6.4. Package Integrity

####### 9.3.3.6.4.1. Package Integrity issues inventory

######## Navigation

  Modules → Application Security → Package Integrity (under Issues

####### 9.3.3.6.4.2. Expanded Package Integrity issues inventory information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 9.3.3.6.4.3. Package Integrity findings

######## Note

* Findings cannot be mitigated. They must be promoted to issues to enable remediation efforts to secure your software packages.

######## Navigation

  navigate to Modules → Application Security → Package Integrity (under Issues) → click the Findings tab

####### 9.3.3.6.4.4. Manage Package Integrity issues

##### 9.3.3.7. Secrets scanners

###### 9.3.3.7.1. Secrets issues

####### Tip

* You can also view Secrets issues in dedicated tabs under other sections when available: In Code asset inventories: navigate to Inventory → All Assets → Code:    On the Secrets tab under Repositories. Refer to In-depth repository asset informationfor more information   Under the All Code inventory: Select an asset from the table → Secrets In Code...

####### Navigation

  Under Modules, select Application Security → Issues → Secrets

###### 9.3.3.7.2. Secrets issues inventory

###### 9.3.3.7.3. Expanded Secrets issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 9.3.3.7.4. Secrets findings

####### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

####### Navigation

  To access Secrets findings, select Application Security → Issues → Secrets → click the Findings tab

###### 9.3.3.7.5. Manage Secrets issues

##### 9.3.3.8. Infrastructure as Code (IaC) scanners

###### 9.3.3.8.1. Supported frameworks and languages

###### 9.3.3.8.2. IaC misconfiguration issues

####### Tip

* You can also view IaC misconfiguration issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Configuration tab under Repository assets. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from...

####### Navigation

  To access IaC misconfiguration issues, under Modules, select Application Security → Issues → IaC misconfiguration

###### 9.3.3.8.3. IaC misconfiguration issues inventory

###### 9.3.3.8.4. Expanded IaC misconfiguration issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 9.3.3.8.5. IaC misconfiguration findings

####### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

####### Navigation

  To access IaC misconfiguration findings, under Modules, select Application Security → Issues → IaC Misconfigurations → click the Findings tab

###### 9.3.3.8.6. Manage IaC misconfiguration issues

##### 9.3.3.9. Application Security scans management

###### 9.3.3.9.1. How to access Application Security scan management

####### Note

* While scans provide a comprehensive inventory of all issues detected during a scan, dedicated inventories are also maintained for specific scan types for more granular management. For more information, refer to Infrastructure as Code (IaC) scanners, Secrets scanners and Software Composition Analysis (SCA ) scanners.

###### 9.3.3.9.2. Branch periodic scans

####### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

###### 9.3.3.9.3. Pull Request scans

####### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

###### 9.3.3.9.4. CI scans

####### Note

* The inventory table displays scan issues for visibility only; remediation is not available in scan management. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

###### 9.3.3.9.5. Manage repository scan configurations

####### Note

* For Secrets scans you configure these additional settings: Git history scan: scans Git history to detect secrets deleted from files but still present in past commits, notifying you of these exposures. This helps mitigate the risk of compromised credentials that may be found in the repository's history Secret validation: validates detected secrets...

####### Navigation

  Settings → Data Sources → hover over a connected data source from the catalog → click View Details

###### 9.3.3.9.6. Monitor data source instances health

##### 9.3.3.10. Application Security Policies

###### 9.3.3.10.1. User roles and permissions

###### 9.3.3.10.2. Create Application Security policies

####### Note

* Add additional condition attributes for a single finding type by using the OR operator When selecting multiple finding types, only filters common to all types are available

* If you select the Applications asset type, the policy evaluates all repositories for matching applications SBAC scope limitations do not apply to Asset Types

####### 9.3.3.10.2.1. Application Security policy condition attributes

######## Note

* The Severity, AppSec Rule, AppSec Rule Label and Backlog Status attributes are not dependent on the Finding Type attribute For more information about Backlog Status, refer to Backlog baseline

* For CI/CD Risks as the finding type, refer to CI/CD policies user roles and permissions.

###### 9.3.3.10.3. Manage Application Security policies

####### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

##### 9.3.3.11. Application Security Rules

###### Note

* Out-of-the-box rules cannot be modified directly. However, you can create a custom rule by cloning the existing one. This allows you to make changes to the original rule according to your requirements. Refer to Manage Application Security custom rules for more information.

###### 9.3.3.11.1. Roles and permissions

###### 9.3.3.11.2. Rules inventory

####### Navigation

  To filter rules relating to Secrets, select filter icon → Scanner (from the Select field) → Secrets (from the Value field

###### 9.3.3.11.3. Create custom Application Security rules

####### Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

###### 9.3.3.11.4. Manage Application Security custom rules

###### 9.3.3.11.5. Configure YAML file properties

##### 9.3.3.12. Application Security CLI

###### Prerequisite

* For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

###### Note

* For detailed information about the Cortex XSIAM CLI, refer to Cortex CLI.

###### 9.3.3.12.1. Connect Cortex CLI

####### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

####### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Application Security, refer to Cortex CLI usage for Application Security

####### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

###### 9.3.3.12.2. Cortex CLI usage for Application Security

###### 9.3.3.12.3. Cortex CLI Application Security command line reference

####### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

####### Important

* The Cortex CLI Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id <YOUR_AUTH_ID>...

###### 9.3.3.12.4. Cortex CLI common command line reference guide

####### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

##### 9.3.3.13. IDE

###### Note

* Not all remediation options are available for all findings or all type of scan category.

###### 9.3.3.13.1. System requirements

###### 9.3.3.13.2. Visual Studio (VS) Code

####### Prerequisite

* Before you begin: Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

####### Note

* Enforcement rules and CA certificates are not applicable to the open-source project.

####### Navigation

  Install through VS Code IDE: Access the Activity bar → select Extensions → Cortex Cloud → Install

####### 9.3.3.13.2.1. How to use the Cortex Cloud extension in VS Code

######## Note

* Not all remediation options are available for all issues.

* The suppression is scoped to the file.

###### 9.3.3.13.3. JetBrains

####### Prerequisite

* Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install Node.js version 22 and...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

####### Note

* The Cortex AppSec code security plugin supports all JetBrains products.

####### Navigation

  Settings → Plugins → select the Marketplace tab → search for Prisma Cloud → Install → OK

  Settings → Tools → Cortex Cloud

####### 9.3.3.13.3.1. How to use the JetBrains Cortex XSIAM extension

######## Note

* After selecting Fix Available, the number of issues displayed in the issue categories (such as IaC) reflect the number of fixable issues for that type.

* The corresponding file simultaneously opens in the Code editor, highlighting the issue within its exact code context. See below for more information.

* Not all types of remediation are available for all issue categories. For example, fixes are not available for License issues.

* Secrets and Licenses category issues are typically mitigated by following the guidance in the Documentation.

#### 9.3.4. API documentation

### 9.4. Attack Surface Management

#### License Type

  Requires the ASM add-on

#### 9.4.1. Get started with Attack Surface Management

##### License Type

  Requires the ASM add-on.

##### 9.4.1.1. What is Attack Surface Management?

###### 9.4.1.1.1. Attack Surface Management use cases

##### 9.4.1.2. Network mapping

##### 9.4.1.3. Scanning

###### 9.4.1.3.1. Scanning cadences

###### 9.4.1.3.2. Known Assets Monitoring

###### 9.4.1.3.3. Scanning ports and protocols

####### Note

* The following lists are not exhaustive. For current and complete lists, contact your customer success team.

##### 9.4.1.4. GeoIP data collection

#### 9.4.2. Attack Surface Management detections

##### 9.4.2.1. Attack surface rules

###### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

##### 9.4.2.2. Attack Surface Testing

###### Note

* Requires the ASM add-on.

* Attack surface testing scans are typically not CFAA compliant, meaning that they may attempt more extensive fuzzing to confirm or deny the presence of a CVE. Additionally, some attack surface tests are more intrusive than others. Tests are labeled with the level of intrusivity, so you can decide whether to run more intrusive tests.

###### 9.4.2.2.1. Set up Attack Surface Testing

####### Navigation

  Settings → Configurations → Access Management → Roles, and select the role

  Modules → Attack Surface → Policies → Attack Surface Tests

  Settings → Configurations → Attack Surface → Attack Surface Testing

##### 9.4.2.3. Externally inferred CVEs

###### Note

* An externally inferred CVE might impact your service or asset, but additional investigation is required to confirm that the CVE is actually present.

##### 9.4.2.4. Digital Risk Protection

###### Note

* Both of these attack surface rules are based on the attributed domain assets that appear in the asset inventory. If there are no attributed domains in your inventory, Cortex XSIAM will not generate Digital Risk Protection findings and issues.

###### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

#### 9.4.3. Attack surface assets

##### Navigation

  The internet-facing assets that were discovered in a attack surface management (ASM) scan and attributed to your organization are available in the inventory on the Inventory → Assets → All Assets → External Surface pages

  Inventory → Assets → Network Configuration → IP Address Ranges → External IP Address Ranges

##### 9.4.3.1. Upload or remove ASM assets

###### Note

* You must have the Instance Administrator role to upload or remove assets.

###### 9.4.3.1.1. Upload assets

####### Note

* If an asset upload request has an invalid CSV or includes one or more invalid assets, the entire request will fail, and none of the assets will be uploaded. If this happens, Cortex XSIAM will display an error message indicating what caused the error, so you can fix the problem and resubmit if you choose.

####### Navigation

  Settings → Configurations → Asset Management → Asset Uploads/Removals

###### 9.4.3.1.2. Remove assets

####### Note

* If an asset removal request has an incorrectly formatted CSV or includes one or more invalid assets, the entire request will fail, and none of the assets will be removed. If this happens, Cortex XSIAM will display an error message indicating what caused the error, so you can fix the problem and resubmit if you choose.

####### Navigation

  Settings → Configurations → Asset Management → Asset Uploads/Removals

#### 9.4.4. Deploy ASM and Exposure Management enrichment and remediation automation

##### Note

* For details and requirements regarding the enrichment information that can be collected and the specific issues that can be remediated automatically, review the Exposure Management Content Pack information in Marketplace.

* Cortex Exposure Management playbooks only run on issues that were created after the automation rules have been configured.

##### Navigation

  Investigation & Response → Automation → Automation Rules

  Settings → Configurations → Data Collection → Automation & Feed Integrations

#### 9.4.5. ASM enrichment of cloud assets

##### Navigation

  Inventory → Assets → All Assets → External Surface → Services

#### 9.4.6. Emerging Vulnerabilities

##### License Type

  Requires the ASM add-on

##### Note

* You must have a role with Attack Surface Rules permission to access the Emerging Vulnerabilities page. When setting up Roles Based Access Control (RBAC), you can find Attack Surface Rules in the Detection & Threat Intel component.

##### Navigation

  Posture Management → Vulnerability Management → Emerging Vulnerabilities

#### 9.4.7. Global Lookup

##### Navigation

  Modules → Attack Surface → Global Lookup

### 9.5. Cloud Workload Policies and Rules

#### Prerequisite

* Users need View/Edit RBAC permissions (under Policies → Compute Policies) or the Instance Administrator role to view, edit, and modify Cloud Workload Policies.

#### 9.5.1. How policies and rules work together

#### 9.5.2. Cloud Workload Policies

##### 9.5.2.1. Types of Cloud Workload Policies

##### 9.5.2.2. Cloud Workload Policies page

###### Note

* Keep the following caveats in my mind when working with Policies: Instance Administrators are able to view all facets of Policies without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be...

###### 9.5.2.2.1. Widgets panel

####### 9.5.2.2.1.1. Show or hide the widget panel

######## Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 9.5.2.2.2. Filter page results

###### 9.5.2.2.3. Change the layout of the policies table

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 9.5.2.2.4. Policy Details Panel

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.5.2.3. Enable or disable a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.5.2.4. Create a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.5.2.5. Use an existing policy to create a new Cloud Workload policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.5.2.6. Edit a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 9.5.2.7. Delete a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

#### 9.5.3. Cloud Workload Rules

##### 9.5.3.1. Default (pre-defined) Rules

##### 9.5.3.2. Custom (user-defined) Rules

##### 9.5.3.3. Cloud Workload Rules page

###### Note

* Keep the following caveats in my mind when working with Rules: Instance Administrators are able to view all facets of Rules without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be able...

###### 9.5.3.3.1. Filter page results

###### 9.5.3.3.2. Change the layout of the rules table

###### 9.5.3.3.3. Rule details panel

##### 9.5.3.4. Create a new Custom Detection Rule

###### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

###### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

##### 9.5.3.5. Use an existing rule to create a new Custom Detection Rule

###### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

##### 9.5.3.6. Edit a Custom Detection Rule

###### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

##### 9.5.3.7. Delete a Custom Detection Rule

###### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

### 9.6. Cortex Cloud Data Classification

#### 9.6.1. What is Cortex Cloud Data Classification?

#### 9.6.2. How to create and validate a custom data pattern

##### Note

* Once a custom data pattern is saved, it runs on all data in the same way as any out-of-the-box (OOTB) pattern, becoming globally applicable for all modules using Cortex Cloud Data Classification.

* For more information, see How to disable and enable data patterns in Data Classification.

#### 9.6.3. How to disable and enable data patterns in Data Classification

##### Note

* Disabling data patterns can cause changes in your data profile results and stop detection of these data patterns.

* For more information about data patterns in data classification, see What is Cortex Cloud Data Classification?.

##### Navigation

  In Cortex Command Center, click Settings → Configurations → Data Classification → Data Patterns

#### 9.6.4. How to create and validate a custom data profile

##### Note

* If you choose two data locations, only the filters they have in common will be included in the possible filter options.

* For more information, see How to disable and enable data profiles in Cortex Cloud Data Classification.

##### Important

* Deleting a data profile deletes all past data associated with it in all modules using Cortex Cloud Data Classification after a warning notification is displayed.

* Enabling and disabling a data profile removes or re-adds the data profile results to the data objects; that is, files and tables.

#### 9.6.5. How to disable and enable data profiles in Cortex Cloud Data Classification

##### Note

* Existing results on past scans are updated in the Asset and Object inventories within two hours after being disabled or enabled.

* For more information about data profiles in Cortex Cloud Data Classification, see What is Cortex Cloud Data Classification?.

##### Navigation

  In Cortex XSIAM Security Command Center, click Settings → Configurations → Data Classification → Data Profiles

### 9.7. Cortex Cloud Data Security

#### 9.7.1. What is Cortex Cloud Data Security?

##### License Type

  Requires the Cortex Cloud Posture Management  add-on or the Cortex Cloud Runtime Security add-on.

#### 9.7.2. Supported assets in Cortex Cloud Data Security

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* The list above refers to only data classification; however, Cortex Cloud Data Security discovers and monitors all cloud assets and services for usage and misconfigurations.

* For information about configuring data classification asset types, see How to configure the scanning settings for supported services.

#### 9.7.3. Cortex Cloud Data Security concepts

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 9.7.4. Cortex Cloud Data Security use cases

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 9.7.5. Data Inventory

##### License Type

  Requires the Cortex Cloud Posture Management  add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* To clear the filters in the filter panel, click Delete.

##### Navigation

  When you select Inventory → All Assets → Data → All Data, a list of all data assets appears

#### 9.7.6. How to review errors in Cortex Cloud Data Security

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 9.7.7. How to configure the scanning settings for supported services

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* All the asset types are selected by default. When you deselect a data asset type, it is not included when the system runs the next scan operation, reducing the total scan time.

#### 9.7.8. How to perform advanced Data Security investigations using XQL

##### License Type

  Requires the Posture Management add-on or the Runtime Security add-on.

##### Note

* For more information, see Build XQL queries.Build XQL queries

#### 9.7.9. How to onboard Snowflake (Posture)

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Prerequisite

* In order to use Snowflake (Posture), you must be registered with one of these cloud providers: Amazon AWS, Microsoft Azure, or Google Cloud Platform (GCP). Ensure you have the necessary account permissions to onboard. It is recommended to use account admin as the role for the onboarding.

##### Note

* The account identifier can be found using the user information at the bottom left. Hover over the account you wish to onboard and select the copy option at the top right. The account identifier is usually of the format: (organization).[account]

#### 9.7.10. How to onboard Microsoft 365 (Posture)

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Prerequisite

* You have generated a Globally Unique Identifier (GUID), also known as a Universally Unique Identifier (UUID). You will need this ID for the tenant you want to use for the Microsoft 365 (Posture) instance. In order to use Microsoft 365 (Posture), you must be registered with Microsoft Azure.

#### 9.7.11. How to use information protection labels in Cortex Cloud Data Security

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* Only If you have connected a Microsoft 365 instance to Cortex Cloud, the information protection labels appear. See How to onboard Microsoft 365 (Posture).

### 9.8. Cortex Cloud Identity Security

#### 9.8.1. What is Cortex Cloud Identity Security?

##### License Type

  Requires the Cortex Cloud Posture Management  add-on or the Cortex Cloud Runtime Security add-on.

#### 9.8.2. Cortex Cloud Identity Security concepts

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* Access to the Weak/Compromised Password column requires the ITDR add-on.

* Only ITDR assets can have a risk score.

* When a policy is analyzed and categorized as excessive, a relevant finding and highlight is attached to that policy and the various identities being granted excessive permissions.

* Each action must be defined as either being administrative or not. The administrative tag is an additional tag for administrative actions, along with one of the other access level types. For example, the AWS action iam:CreateGroup is categorized as config and has the administrative tag as well.

##### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

#### 9.8.3. Cortex Cloud Identity Security principles

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 9.8.4. Cortex Cloud Identity Security use cases

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 9.8.5. How to manage RBAC and SBAC in Cortex Cloud Identity Security

##### Important

* You can use the Cortex Cloud Identity Security RBAC roles to define access to the various sections and functionalities of Cortex Cloud Identity Security, but these roles do not directly control the specific data a user sees within those sections. Data visibility is further refined and limited by scope-based access control (SBAC) capabilities.

#### 9.8.6. How to achieve the principle of least privilege access

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* In the case of Amazon AWS, Cortex Cloud Identity Security also uses AWS Identity and Access Management (IAM) Access Advisor insights to expand the coverage of supported actions.

##### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

#### 9.8.7. How to enable inactive human identity logs on Azure in Cortex Cloud Identity Security

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* For more information, see Ingest logs from Microsoft Azure Event Hub.

#### 9.8.8. How to perform advanced Identity Security investigations using XQL

##### License Type

  Requires the Posture Management add-on or the Runtime Security add-on.

##### Note

* For more information, see Build XQL queries.Build XQL queries

### 9.9. Cortex Advanced Email Security

#### 9.9.1. Cortex Advanced Email Security module overview

##### Prerequisite

* The following are prerequisites for using the Cortex XSIAM Advanced Email Security module. REQUIREMENT DESCRIPTION Setup and Permissions Ensure Analytics is activated before enabling the Cortex Advanced Email Security module. Licenses and Add-ons Cortex Advanced Email Security add-on.

#### 9.9.2. Cortex Advanced Email Security module architecture and data flow

#### 9.9.3. Getting started with the Cortex Advanced Email Security module

##### Prerequisite

* Before you configure the Cortex Advanced Email Security module, ensure you have the following: Admin-level access to the target email platform API permissions to read mailbox data, manage remediation (if desired), and access user directories Dedicated service account (recommended) for integration purposes (response actions) List of domains and...

#### 9.9.4. Deploy and configure the Email Security module

##### 9.9.4.1. Integrate Microsoft 365 with the Cortex Advanced Email Security Module

###### License Type

  To configure a quick action, you must first create an application in Microsoft O365.

###### Navigation

  After you onboard your domains and configure the quick actions, Cortex XSIAM manage your protected domains in Modules → Email Security → Email Security Configuration

##### 9.9.4.2. Configure the Cortex Advanced Email Security module

###### License Type

  Requires the Email Security module.

###### Note

* You can add email indicators to the Allow List also in Exceptions Configuration → Issue Exclusions. However, if you add multiple indicators in a rule using Issue Exclusions under Exceptions Configuration, you cannot edit the rule in the Email Security Allow List.

###### Navigation

  Modules → Email Security → Email Security Configuration

#### 9.9.5. Cortex Advanced Email Security threat detection and issues

##### Note

* Depending on data collection mode and platform capabilities, not all fields may be populated for every message. API and export documentation provides further clarification on optional vs required fields.

##### 9.9.5.1. Email Security Analytics Rules

###### Navigation

  The Email Security Analytics Rules page is in Modules → Email Security → Email Security Detection Rules

#### 9.9.6. Investigate and respond to email security issues

##### License Type

  Requires the Cortex Advanced Email Security module.

##### Navigation

  Modules → Email Security → Email Security Issues

#### 9.9.7. Automate remediation for the Cortex Advanced Email Security module

#### 9.9.8. Email Command Center

##### License Type

  Requires the Cortex Advanced Email Security module.

### 9.10. Exposure management

#### 9.10.1. Exposure Management in Cortex XSIAM

##### License Type

  Requires the Exposure Management add-on.

#### 9.10.2. Get started with Exposure Management

#### 9.10.3. Exposure Management Command Center

#### 9.10.4. Compensating Controls

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

#### 9.10.5. Cortex Network Scanner

##### 9.10.5.1. Get started with Cortex Network Scanner

###### License Type

  Requires the Exposure Management add-on.

###### Prerequisite

* Review the Cortex Network Scanner deployment recommendations and complete any prerequisites. Set up and configure Broker VM

###### Note

* The current version of the Cortex Network Scanner does not support load distribution and balancing. Vulnerability assessment scans can take time, and currently you can assign only one scanner per scan task. To scan the entire network we recommend splitting your scanning activity into smaller tasks to preserve performance.

* The Cortex Network Scanner applet is not supported for FedRAMP customers.

###### Important

* The Cortex Network Scanner applet is not supported for FedRAMP customers.

###### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  Settings → Configurations → Network Scanners → Network Scanners and find your new scanner in the list

##### 9.10.5.2. Add a network

###### Navigation

  Settings → Configurations → Network Scanning → Networks and click + Add Network

##### 9.10.5.3. Add credentials for authenticated scans

###### Prerequisite

* Before initiating an authenticated scan, complete the following prerequisites on your target hosts: Create dedicated service accounts. We highly recommend creating dedicated service accounts on your target devices specifically for the network scanner. Avoid using existing administrative accounts or personal user accounts. This practice enhances...

###### Note

* You cannot edit saved credentials, but you can delete them and create new ones as needed.

###### Navigation

  Settings → Configurations → Network Scanners → Credential Management

##### 9.10.5.4. Create a scan

###### Tip

* Most use cases can use the default advanced settings.

* ICMP Ping provides the quickest discovery scan and is good for initial discovery and scoping, however in the modern enterprise environment ICMP response can be blocked by the firewall or endpoint security rules. Using additional methods increases the accuracy of the host discovery, although makes the scan take a longer time. The best approach is to use...

##### 9.10.5.5. Manage scans

###### Navigation

  Settings → Configurations → Network Scanners → Scan Management

##### 9.10.5.6. View issues triggered by network scanner findings

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

### 9.11. Vulnerability management

#### License Type

  Requires the ASM or Cortex Cloud Posture Management add-on

#### 9.11.1. Vulnerability management in Cortex XSIAM

##### Note

* Cortex XSIAM vulnerability management provides the ability to identify and assess runtime vulnerabilities in every asset across traditional IT and cloud environments. For vulnerabilities detected in your software development lifecycle through application security scans, refer to the Cortex Cloud Application Securitydocumentation.

##### 9.11.1.1. Cortex XSIAM vulnerability concepts

###### Note

* CVE is an acronym for Common Vulnerabilities and Exposures, which is a list of publicly disclosed security threats. We often use the term "CVE" to refer to a vulnerability that has been a assigned a CVE ID. Cortex XSIAM identifies CVEs and non-CVE vulnerabilities.

##### 9.11.1.2. Vulnerability Management dashboard

#### 9.11.2. Vulnerability policies

##### 9.11.2.1. Create a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

##### 9.11.2.2. Update the Ignored CVEs, Asset Groups, and Assets policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

##### 9.11.2.3. Modify a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

##### 9.11.2.4. Enable or disable a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

#### 9.11.3. Investigate and remediate vulnerabilities

##### 9.11.3.1. View all Vulnerabilities

###### Navigation

  Posture Management → Vulnerability Management → Vulnerabilities

##### 9.11.3.2. View vulnerability issues

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

##### 9.11.3.3. View All Vulnerability Findings

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues and click the All Vulnerability Findings button

##### 9.11.3.4. View vulnerable assets

###### Navigation

  Posture Management → Vulnerability Management → Vulnerable Assets

#### 9.11.4. Vulnerability Intelligence

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

#### 9.11.5. Recast CVSS scores and CVSS severities

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

10. Serverless function security

  10.1. Overview

  10.2. Serverless function posture security

  10.2.1. Onboard cloud providers for serverless functions

##### Note

* When scanning serverless functions wtih layers, those layers need to be from the same cloud account.

* Only functions containing zip files are supported.

##### Important

* Cortex supports GCP functions deployed by Cloud Functions (1st gen) and Cloud Functions API (2nd gen).

  10.2.2. Serverless function posture policies

  10.2.2.1. Manage serverless function policies

##### Note

* You can select multiple types to view all your serverless function rules across your cloud providers.

* Refer to Create serverless function policies for more information on how to define the steps of a policy in the wizard.

  10.2.2.2. Create serverless function policies

##### Note

* You can select multiple options.

* For more information about rules, refer to Manage serverless function rules.

  10.2.3. Serverless function posture rules

  10.2.3.1. Manage serverless function rules

##### Note

* You can select multiple types to view all your serverless function policies across your cloud providers.

* Refer to Create serverless function rules for more information on how to define the steps of a rule in the wizard.

  10.2.3.2. Create serverless function rules

  10.2.3.3. Create an attack path rule for serverless functions

##### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  in as the operator → enter the CVE ID → Search

  > or >= as the operator → Severity level (such as High, Low) → Search

  > or >= as the operator → enter a score → Search

  10.2.3.4. Create a configuration rule for serverless functions

##### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  10.2.3.5. Create a network exposure rule for serverless functions

##### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  10.2.4. Serverless function usage

##### Navigation

  To access serverless function assets, under Inventory, select All Assets → Compute → Serverless Functions

  Posture Management → Vulnerability Management) → Vulnerability Issues

  Add Filters → Asset Category → Serverless Function

  Posture Management → Vulnerability Management) → Vulnerable Assets

  Add Filters → Asset Category → Serverless Functions

  10.3. Serverless function runtime security

  10.3.1. Overview

  10.3.2. Set up serverless function protection

  10.3.3. Serverless runtime issues

##### Note

* Issues triggered within 24 hours, sharing the same name and description, will be aggregated into cases along with issues from the same function per execution.

11. Data management

  11.1. Broker VM

  11.1.1. What is the Broker VM?

  11.1.2. Set up and configure Broker VM

##### Note

* The Broker VM comes with a 512 GB disk. Therefore, deploy the Broker VM with thin provisioning, meaning the hard disk can grow up to 512 GB but will do so only if needed.

* When DHCP is not enabled in your network and there isn't an IP address for your Broker VM, configure the Broker VM with a static IP using the serial console menu.

* When configuring a Local Agent Settings applet with installer and content caching, you need to configure an SSL certificate for the Broker VM as explained in the task below. For more information on specific requirements for the Local Agent Settings applet, see Activate Local Agent Settings. Keep in mind that several Broker VM applets, such as the...

* You can configure another Broker VM as a proxy server for this Broker VM by selecting the HTTP type. When selecting HTTP to route Broker VM communication, you need to add the IP Address and Port number (set when activating the Agent Proxy) for another Broker VM registered in your tenant. This designates the other Broker VM as a proxy for this Broker VM.

* The Palo Alto Networks Broker VM supports only strong cipher SHA256-based certificates. MD5/SHA1-based certificates are not supported.

* If adding a CA certificate to the Broker VM is not possible, ensure that you've added the Broker Service FQDNs to the SSL Decryption Exclusion list on your firewalls. See Enable Access to Cortex XDR.

##### Important

* There can be instances in which the Broker VM requires up to 50% of the incoming bandwidth as outgoing. Such instances can be, network instability between the Broker VM and Cortex XSIAM, or data that is being collected, but not well compressed.

* The internal network for the Broker VM must be unique and reserved. Other devices should not use the same IP as the Broker VM internal network as it can lead to communication issues with the Broker VM.

* If you use SSL decryption in your firewalls and proxies, see the Understanding CA certificate functionality in Broker VM deployments section below. In addition, verify that the proxies used support HTTP/2, gRPC-specific headers, and HTTP/2 trailers, and the inspection policies support gRPC traffic. Any devices that you use with this configuration...

* When configuring more than one network interface, ensure that only one Default Gateway is defined. The rest must be set to 0.0.0.0, which configures them as undefined. In addition, we recommend assigning each network interface to a different subnet, as oppose to configuring two interfaces on the same subnet which can potentially cause unexpected...

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and earlier, Cortex XSIAM will only accept 172.17.0.0/16.

* We strongly recommend disabling SSH connectivity when it's not being used. Therefore, activate SSH connectivity when it's needed and disable it right afterwards. When generating a new SSH key ensure to avoid embedding the domain-style username, by not using any backslashes (\) in the comment field, to ensure the SSH key passes validation.

  11.1.2.1. Broker VM image installations

  11.1.2.1.1. Set up Broker VM on Alibaba Cloud

##### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* For Linux and Windows uploads, you can use Alibaba Cloud's graphical management tool called ossbrowser.

* The Object Storage Service must be created in the same Region as the image of the virtual machine.

##### Navigation

  Hamburger menu → Elastic Compute Service → Instances & Images → Instances

  11.1.2.1.2. Set up Broker VM on Amazon Web Services

##### Prerequisite

* Download a Cortex XSIAM Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. You need to set up an AWS VM Import role (vmimport) before you continue with the steps to convert the image as it is required for the import-image CLI command. You can use a different role, if the...

##### Note

* Creating an AMI image can take up to 60 minutes to complete.

* Assigning security groups can take up to 15 minutes.

##### Important

* A t2.medium (4GB RAM) is the lowest machine type that can be used as an instance type. Usually, the lowest machine type is sufficient with the Local Agent Settings applet. Yet, when enabling more applets, 8 GB is required.

##### Navigation

  Log in to the AWS IAM Console, and in the navigation pane, select Access Management → Users → Add Users

  Obtain a registration token from the Cortex XSIAM Web Console by selecting Settings → Configurations → Data Broker → Broker VMs → Add Broker → Generate Token

  11.1.2.1.3. Set up Broker VM on Google Cloud Platform (GCP)

##### Prerequisite

* Download a Cortex XSIAM Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. To complete the set up, you must have G Cloud installed and have an authenticated user account.

* Before importing a GCP image using the gcloud CLI, ensure that you update the Google Cloud components to version 371.0.0 and above using the following command:

##### Note

* The import tool uses Cloud Build API, which must be enabled in your project. For the import to work, Cloud Build service account must have compute.admin and iam.serviceAccountUser roles. When using the Google Cloud console to import the image, you will be prompted to add these permissions automatically.

  11.1.2.1.4. Set up Broker VM on KVM using Ubuntu

##### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  11.1.2.1.5. Set up Broker VM on Microsoft Azure

##### Prerequisite

* Download a Cortex XSIAM Broker VM VHD (Azure) image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* Extraction can take up to a few hours.

* Upload can take up to a few hours.

* Creating the VM can take up to 15 minutes. The Broker VM Web UI is not accessible during this time.

* For more information on creating a rule in an Azure VM, see Create a Security Rule in the Azure Documentation.

  11.1.2.1.6. Set up Broker VM on Microsoft Hyper-V

##### Prerequisite

* Download a Cortex XSIAM Broker VM VHD image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  11.1.2.1.7. Set up Broker VM on Nutanix Hypervisor

##### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* Saving the image to Nutanix hypervisor can take time as it's a large file.

* Creating the VM can take up to 15 minutes. The Broker VM Web user interface is not accessible during this time.

  11.1.2.1.8. Set up Broker VM on VMware ESXi using vSphere Client

##### Prerequisite

* Ensure you have a virtualization platform installed that is compatible with an OVA image, and have an authenticated user account. Download a Cortex XSIAM Broker VM OVA image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  11.1.2.2. Broker VM data collector applets

  11.1.2.2.1. Activate Apache Kafka Collector

##### Prerequisite

* Apache Kafka version 2.5.1 and above. Kafka cluster set up on premises, from which the data will be ingested. Privileges to manage Broker Service configuration, such as Instance Administrator privileges. Create a user in the Kafka cluster with the necessary permissions and the following authentication details:    Broker Certificate and Private Key for...

##### Note

* For CEF and LEEF logs, Cortex XSIAM takes the vendor and product names from the log itself, regardless of what you configure on this page.

  11.1.2.2.2. Activate CSV Collector

##### Prerequisite

* Set up and configure Broker VM. Ensure that you share the applicable CSV files. Know the complete file path for the Windows directory.

##### Note

* When you implement a wildcard file search, ensure that the CSV files share the same columns and header rows as all other logs that are collected from the CSV files to create a single dataset.

* The CSV Collector checks for new CSV files every 10 minutes.

  11.1.2.2.3. Activate Cortex Network Scanner

##### License Type

  Requires the Exposure Management add-on.

##### Prerequisite

* Review the Cortex Network Scanner deployment recommendations and complete any prerequisites. Set up and configure Broker VM

##### Important

* The Cortex Network Scanner applet is not supported for FedRAMP customers.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  Settings → Configurations → Network Scanners → Network Scanners and find your new scanner in the list

  11.1.2.2.4. Activate Database Collector

##### Prerequisite

* Set up and configure Broker VM

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.2.2.5. Activate Files and Folders Collector

##### Prerequisite

* Set up and configure Broker VM. Know the complete path to the files and folders that you want Cortex XSIAM to monitor. Ensure that the user permissions for the network share include the ability to rename and delete files in the folder that you want to configure collection.

##### Note

* Cortex XSIAM only supports ingestion of files encoded in UTF-8 format.

* When using the Linux file share, including the Linux share with nfs, a Username and Password is not required, so these fields are grayed out in the screen.

* In Batch mode, the Files and Folders Collector supports collecting logs from a network share for a maximum file size of 500 MB.

* When uploading JSON files, Cortex XSIAM only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* When the storing method is Replace, the maximum size for the total data to be imported into a lookup dataset is 30 MB each time the data is fetched. The inventory data ingested using the Files and Folders collector is counted towards license utilization. When you use a JOINT function with a lookup table in a query or correlation rule, make sure you...

* You can't specify a file name that's the same as a system file name. The name of a dataset created from a tsv file must always include the extension. If the original file name is mrkdptusrsnov23.tsv, you can name save the dataset with the name marketing_dept_users_Nov_2023.tsv.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

  11.1.2.2.6. Activate FTP Collector

##### Prerequisite

* Set up and configure Broker VM. Ensure that the user permissions for the FTP, SFTP, or FTPS include the ability to rename and delete files in the folder that you want to configure collection. When setting up an FTPS Collector with a server using a Self-signed certificate, you must upload the certificate first to the Broker VM as a Trusted CA...

##### Note

* When configuring an SFTP connection, Cortex XSIAM expects the private key to be in the RSA format that is included in the -----BEGIN RSA PRIVATE KEY----- tag. Cortex XSIAM does not support providing the private key in the OpenSSH format from the -----BEGIN OPENSSH PRIVATE KEY----- tag. When using ssh-keygen using a Mac, you get the OpenSSH format by...

* When uploading JSON files, Cortex XSIAM only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

  11.1.2.2.7. Activate Local Agent Settings

##### Note

* This is assuming a standard hardware setup with 2vCPU 8 GB memory.

* Broker VMs can act as as a proxy for routing XDR Collector traffic to the Cortex XSIAM tenant. The Broker VM does not cache XDR Collector installers.

* When you install your XDR agents, you need to configure the IP address of the Broker VM and a port number during the installation. You can use the default 8888 port or set a custom port. You are not permitted to configure port numbers between 0-1024 and 63000-65000, or port numbers 4369, 5671, 5672, 5986, 6379, 8000, 9100, 15672, 25672. Additionally,...

##### Important

* A FQDN must be configured for WEC and Agent Installer and Content Caching to function properly.

* You can only enable Agent Installer and Content Caching, when in the Broker VM Configuration, you've uploaded your signed SSL Server Certificate and key and set the FQDN. For more information, see the Agent Installer and Content Caching requirements explained above.

  11.1.2.2.8. Activate NetFlow Collector

##### Prerequisite

* Set up and configure Broker VM

##### Note

* Since multiple network devices can send data to a single NetFlow Collector, we recommend that you configure a maximum of 50 NetFlow Collectors per Broker VM applet, with a maximum aggregated rate of approximately 50K flows per second (FPS) to maintain system performance.

* Since Cortex XSIAM reserves some port numbers, it is best to select a port number that is not in the range of 0-1024 (except for 514), in the range of 63000-65000 or has one of the following values: 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672.

* The options available change, according to the set Source Network value.

  11.1.2.2.9. Activate Network Mapper

##### Prerequisite

* After you have configured and registered your Broker VM, you can choose to activate the Network Mapper application.

##### Note

* Each IP address range can receive multiple scan requests based on it's availability.

* IP address ranges are displayed according to what you defined as your Network Parameters.

  11.1.2.2.10. Activate Pathfinder

##### Prerequisite

* Configure and register a Broker VM. Except for Vanilla Windows 7, Cortex XSIAM supports activating Pathfinder on Windows operating systems with PowerShell version 3 and later. Verify these requirements wherever you want to activate Pathfinder. The Pathfinder configuration must contain at least one IP address range to run. Make sure that your internal...

##### Note

* Pathfinder isn't supported when configuring Broker VMs in high availability (HA) clusters.

##### Important

* The Broker VM Pathfinder applet is now deprecated. In tenants where the applet was implemented, it will remain operational until January 25, 2026. In all other tenants, the applet is unavailable and cannot be used as of July 20, 2025. To ensure complete coverage and protection, we recommend deploying XDR Agents on all endpoints by this date. Migration...

* The Pathfinder applet isn't supported when configuring Broker VMs in high availability (HA) clusters.

  11.1.2.2.11. Activate Registry Scanner

##### License Type

  Requires the Cortex Cloud Posture Management or Cortex Cloud Runtime Security add-on.

##### Prerequisite

* To initialize registry scanning on your Broker VM, you must first add the necessary data connectors. For details, see Connect Docker V2-compliant container registry and Connect JFrog container registry When sizing your Broker VM, consider the following recommendations:    Disk Size: Calculate the required disk space by multiplying the average container...

##### Note

* FedRAMP is currently not supported for this applet. You cannot activate the Registry Scanner directly on a new or existing Broker VM. You can only activate or deactivate existing Registry Scanner applets. To activate or deactivate existing applets, see Step 4 under Verify Registry Scanner connection section.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.2.2.12. Activate Syslog Collector

##### Prerequisite

* Set up and configure Broker VM

##### Note

* Once configured, you cannot change the Port/PROTOCOL. If you don't want to use a data source, ensure to remove the data source from the list as explained in Task 5.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and...

* The server certificate and private key pair is expected in a PEM format. Cortex XSIAM will notify you when your certificates are about to expire.

* Because some port numbers are reserved by Cortex XSIAM , you must choose a port number that is not: In the range of 0-1024 (except for 514) In the range of 63000-65000 Values of 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672

* CORELIGHT is not available for a UDP protocol.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.2.2.13. Activate Transporter

##### License Type

  Requires the Cortex Cloud Posture Management or Cortex Cloud Runtime Security add-on.

##### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator) Set up and configure Broker VMSet up and configure Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex XSIAM resources. The IP addresses...

##### Warning

* The Transporter applet is not supported for FedRAMP customers.

##### Navigation

  Settings → Configurations → Broker VMs (under Data Broker

  the Brokers tab → locate your Broker VM → hover and click + Add under the Apps column → AppSec Transporter

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

  11.1.2.2.14. Activate Windows Event Collector

##### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

##### Note

* You can also activate the Windows Event Collector on Windows Core. For more information, see Activate Windows Event Collector on Windows Core.

* By default, Cortex XSIAM collects Palo Alto Networks predefined Security events that are used by the Cortex XSIAM detectors. Removing the Security collector interferes with the Cortex XSIAM detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

  11.1.2.2.14.1. Activate Windows Event Collector on Windows Core

##### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

##### Note

* By default, Cortex XSIAM collects Palo Alto Networks predefined Security events that are used by the Cortex XSIAM detectors. Removing the Security collector interferes with the Cortex XSIAM detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

  11.1.2.2.14.2. Renew WEC certificates

##### Note

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* You can see more than one ca.wec.paloaltonetworks.com and forwarder.wec.paloaltonetworks.com file from a previous installation in the directory, so select the file with the most extended Expiration Date. You can verify that you are using the correct certificate: To verify the client certificate in the Personal → Certificates folder is related to the...

* Only perform this step under the following conditions: You have completed the WEF certification renewal process for ALL clients in your environment. Otherwise, events from the WEFs that you did not install the new client certificate will not be collected by the WEC. You are approaching the WEC server CA certificate expiration date, which is 2 years...

* If this query does not display results with a timestamp from after the renewal process, it could indicate that the renewal process is not complete, so wait a few minutes before running another query. If you are still having a problem, contact Technical Support.

##### Important

* After you receive a notification for renewing your WEC CA certificate, we recommend that you do not add any new WEF clients until the WEC certification renewal process is complete. Events from these WEF clients that are added afterwards will not be collected by the server until the WEC certificates are renewed.

  11.1.3. Manage Broker VM

##### Note

* For more information on troubleshooting errors and warnings for these broker applets, see Troubleshoot Broker VM applet errors.

* Certain fields are also exposed in the Clusters tab, when a Broker VM node is added to a High Availability (HA) cluster, and each cluster node is expanded to view the Broker VM nodes table. An asterisk (*) is beside every field that is also included in the Broker VM nodes table for each HA cluster.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.3.1. Edit Broker VM Configuration

##### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and lower, Cortex XSIAM accepts only 172.17.0.0/16.

* Make sure you save the password before closing the window. The only way to re-generate a password is to disable ssh and re-enable.

  11.1.3.2. Increase Broker VM storage allocated for data caching

##### Note

* Follow your hypervisor documentation to understand how to add a persistent disk storage to your VM.

* If your disk is not listed and you didn't shutdown your Broker VM in your hypervisor before manually adding a disk to the VM, you'll need to reboot the Broker VM before the disk details are detected by the Broker VM. This can be performed either in the hypervisor or directly in the Broker VMs page.

##### Warning

* This operation is irreversible, and will make the disk become an integral part of the broker, where disconnecting the disk will result in errors and data loss.

  11.1.3.3. Monitor Broker VM using Prometheus

##### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* For more information on Docker, see the Docker website.

  11.1.3.4. Collect Broker VM Logs

##### Note

* The Download Logs (<TIMESTAMP>) is only displayed when you've downloaded your logs previously using Generate New Logs.

  11.1.3.5. Upgrade Broker VM

##### Important

* After a Broker VM upgrade, your broker may require a reboot to finish installing important updates. A notification about this will be sent to your Cortex XSIAM console Notification Center.

  11.1.3.6. Import Broker VM Configuration

##### Important

* This option can only be used on Broker VMs with version 20.0 and later, and is only suitable for importing a configuration of brokers in the same version, or from a broker in an older version to a broker in a newer version.

* If your source Broker VM configuration includes a WEC applet, you'll need to ensure that you update the DNS record of this Broker VM's FQDN to point to the target Broker VM IP address.

  11.1.3.7. Open Live Terminal

##### Note

* You can either restart_routes or reboot the Broker VM for the changes in the /etc/network/routes file to take affect.

  11.1.3.8. Add Broker VM to cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.3.9. Switchover Primary Node in Cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.3.10. Remove from Cluster

##### Note

* If you've enabled a Load Balancer Health-Check on the cluster, you need to exclude this Broker VM from your Load Balancer settings.

  11.1.4. Manage Broker VM data collector applets

##### Note

* For more information on the Broker VM applet connectivity status, see Manage Broker VM.

  11.1.5. Broker VM High Availability Cluster

##### Note

* For Load Balancing, you must install a Load Balancer in your network which will distribute the incoming data between the nodes.

* The Pathfinder applet isn't supported when configuring Broker VMs in HA clusters.

  11.1.5.1. Configure High Availability Cluster

##### Prerequisite

* Be sure you do the following tasks before creating a cluster from an existing Broker VM: Since the Pathfinder applet isn't supported when configuring HA clusters, you must ensure Pathfinder is deactivated on the Broker VM. If the Broker VM is explicitly specified in some Agent Settings profile, which mean Cortex XSIAM agents retrieve release upgrades...

##### Important

* You can only create a new cluster from an existing Broker VM, when the Broker VM version is 19.0 and later, and the STATUS is Connected. The Create a Cluster from this Broker option is only listed if the Broker VM is not already added to a cluster.

* When the Protocol is set to HTTPS, you may need to perform a few follow-up steps to establish a validated secure SSL connection with the Broker VM. If you're using your own Certificate Authority (CA) to sign the certificates, you'll need to place the CA in the client, such as the Load Balancer, and upload the certificates to the Broker VM. If you're...

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.5.2. Manage Broker VM clusters

##### Navigation

  After you've configured a cluster, you can manage all your Broker VM clusters from the Clusters tab on the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs → Clusters

  11.1.5.2.1. View cluster details

##### Note

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

##### Navigation

  The Clusters tab of the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs) enables you

  11.1.5.2.2. Edit cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs, and select the Clusters tab

  11.1.5.2.3. Add applet to cluster

##### Note

* With Cortex XDR Prevent, it's only relevant to configure a HA cluster with a Local Agent Settings applet as this is the only applet supported for this product license. The other applets are collector applets, which are only available in Cortex XDR Pro or Cortex XSIAM.

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

  11.1.5.2.4. Add Broker VM to cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.5.2.5. Remove cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  11.1.6. Broker VM notifications

##### Note

* For more information on upgrading to a new Broker VM image, see Migrating to a New Broker VM Image.

  11.1.7. Monitor Broker VM activity

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  11.1.8. Troubleshoot Broker VM applet errors

##### Note

* For more information on creating correlation rules to trigger collection health issues, see How can I set up correlation rules to trigger collection health issues?.

  11.2. XDR Collectors

##### Note

* Ingestion of log events larger than 5 MB is not supported.

  11.2.1. XDR Collector audit logs

  11.2.2. XDR Collector machine requirements and supported operating systems

  11.2.3. Resources required to enable access to XDR Collectors

##### Note

* Some of the IP addresses required for access are registered in the United States. As a result, some GeoIP databases do not correctly pinpoint the location in which IP addresses are used. All customer data is stored in your deployment region, regardless of the IP address registration and restricts data transmission through any infrastructure to that...

* Throughout this topic, <xsiam-tenant> refers to the chosen subdomain of your Cortex XSIAM tenant and <region> is the region in which your Strata Logging Service is deployed.

  11.2.4. Manage XDR Collectors

  11.2.4.1. XDR Collectors installation resource for Windows and Linux

##### Note

* In some circumstances, such as after an XDR Collectors upgrade, the configured settings in the XML configuration file can be erased. Yet, this won't affect the saved settings in the XDR Collectors database.

  11.2.4.2. Create an XDR Collector installation package

##### Note

* To move existing XDR Collectors between Cortex XSIAM managing servers, you need to first Uninstall the XDR Collector from the collector machine and then for the new XDR Collector create a new installation package.

* Since Cortex XSIAM relies on the installation package ID to approve XDR Collector registration during install, it is not recommended to delete the installation package for any active on-premise collector machines. Hiding the installation package will remove it from the default list of available installation packages, and can be useful to eliminate...

  11.2.4.3. Install the XDR Collector installation package for Windows

  11.2.4.3.1. Install the XDR Collector on Windows using the MSI

##### Note

* When the package is executed using the MSI, an installation log is generated in %TEMP%\MSI<Random characters>.log by default.

* If the XDR Collector does not connect to Cortex XSIAM, verify your internet connection on the collector machine. If the XDR Collector still does not connect, verify that the installation package has not been removed from the Cortex XSIAM tenant.

  11.2.4.3.2. Install the XDR Collector on Windows using Msiexec

  11.2.4.4. Install the XDR Collector installation package for Linux

##### Note

* We recommend that you perform a Linux RPM or Linux DEB installation.

* If the XDR Collector does not connect to Cortex XSIAM, verify your Internet connection on the collector machine. If the XDR Collector still does not connect, verify the installation package has not been removed from the Cortex XSIAM management console.

* The XDR Collector does not support proxy communication in environments where proxy authentication is required.

##### Important

* When performing a XDR Collector installation or upgrade in Linux using a shell installer, the  /tmp folder cannot be marked as noexec. Otherwise, the installation or upgrade fails. As a workaround, before the installation or upgrade, use the following command:

  11.2.4.5. Configure the XDR Collector upgrade scheduler

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → XDR Collectors → Configuration

  11.2.4.6. Set an application proxy for XDR Collectors

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → XDR Collectors → Administration

  11.2.4.7. Set an alias for an XDR Collector machine

##### Navigation

  Settings → Configurations → XDR Collectors → Administration

  11.2.4.8. Upgrade XDR Collectors

##### Note

* The XDR Collector keeps the name of the original installation package after every upgrade.

  11.2.4.9. Uninstall the XDR Collector

##### Navigation

  Settings → Configurations → XDR Collectors → Administration

  Investigation & Response → Response → Action Center

  11.2.5. Define XDR Collector machine groups

##### Note

* XDR Collectors only support IPv4 addresses.

* Disconnecting Directory Sync in your Cortex XSIAM deployment can affect existing collector machine groups and policy rules based on Active Directory properties.

  11.2.6. About Cortex XDR Collector content updates

  11.2.7. XDR Collector profiles

  11.2.7.1. Add an XDR Collector profile for Windows

##### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex XSIAM collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex XSIAM supports logs in single line format or multiline format. For more...

  11.2.7.1.1. Ingest logs from Windows DHCP using Elasticsearch Filebeat

##### Note

* Although this enrichment is available when configuring a Windows DHCP collector for a cloud data collection integration, we recommend configuring Cortex XSIAM to receive Windows DHCP logs with an XDR Collector Windows Filebeat profile, because it is simpler to set up.

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the template provided by Cortex XSIAM to make your customizations. We recommend that you edit the file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating your...

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the example file provided by Cortex XSIAM to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your filebeat.yml file. Validate the syntax of the YML file before you finish creating...

* The tokenizer definition is dependent on the Windows server version that you are using, because the log format differs. For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%...

  11.2.7.1.2. Ingest Windows DNS debug logs using Elasticsearch Filebeat

##### Note

* Detailed logs are significantly larger, because more information is added to the logs.

* To avoid formatting issues in your filebeat.yml file, we recommend that you validate the syntax of the file.

  11.2.7.2. Add an XDR Collector profile for Linux

##### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex XSIAM collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex XSIAM supports logs in single line format or multiline format. For more...

  11.2.8. Apply profiles to collection machine policies

##### Navigation

  Settings → Configurations → XDR Collectors → Policies → +Add Policy

  11.2.9. XDR Collector datasets

  11.3. Data Collection

  11.3.1. Visibility of logs and issues from external sources

##### License Type

  Data collection may require an add-on.

##### Note

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs.

* Logs with sessionid = 0 are dropped.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. IOCs and BIOCs are only generated for these event types: sso and session_start.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. Analytics, IOCs and BIOCs are only generated on the Firewall data. The Zscaler Nanolog Streaming Service (NSS) feed for web logs is only used for Correlation Rules and threat hunting.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. The Zscaler Nanolog Streaming Service (NSS) feed for web logs is only used for Correlation Rules and threat hunting.

  11.3.2. Visibility of Cortex XSIAM audit and authentication logs

##### Note

* Cortex XSIAM can create Cortex XSIAM issues (Analytics, IOC, BIOC, and Correlation Rules) when relevant from logs.

  11.3.3. External data ingestion vendor support

##### License Type

  Data collection may require an add-on.

  11.3.4. Manage instances

  11.3.4.1. Add a new data source or instance

##### Note

* If a data source contains multiple integrations, the integration configured as the default integration will used by the Data Onboarder. The default integration of the content pack is indicated in each content pack's documentation. The other integrations are available for configuration in the Automation and Feed Integrations page after installing the...

* If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant page in the system, for example Correlations, Playbooks, or Scripts. If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant...

  11.3.4.2. How to configure the scanning settings for supported services

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* All the asset types are selected by default. When you deselect a data asset type, it is not included when the system runs the next scan operation, reducing the total scan time.

  11.3.4.3. Manage cloud instances

  11.3.4.4. Update cloud permissions after Cortex release updates

##### Prerequisite

* Ensure that the user account used to modify permissions has the necessary privileges within both the Cortex platform and your cloud environment, for example, AWS or Azure. You received a notification regarding a new version available that requires permission updates, or viewed a Needs Update status in the Data Sources page.

##### Note

* Instances requiring updates will not change their connection status, for example, Connected, Warning, Error, Disabled, due to the pending permission update.

  11.3.4.5. Pending cloud instances

  11.3.4.6. Troubleshoot errors on cloud instances

##### Note

* Errors related to collection of audit logs in the cloud instance are recorded in the collection_auditing dataset. For more information, see Audit logs fields and query examples.

  11.3.4.7. Manage Kubernetes Connector instances

  11.3.5. Palo Alto Networks integrations

##### License Type

  Data collection may require an add-on.

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

  11.3.5.1. About Palo Alto Networks integrations

##### Note

* For Palo Alto Networks Integrations there is an option to turn on or off the collection of URL and File log types. For more information, see Collecting URL and File log types.

* Roll-back of Strata Logging Service integration migration is not supported.

  11.3.5.2. Ingest data from Next-Generation Firewall

##### Prerequisite

* Ensure that you have completed the following on the NGFW or Panorama side: For Panorama only, ensure that the Panorama Cloud Services plugin is installed. Enable log forwarding profiles on firewall rules. On the Cortex XSIAM side, ensure that you have user role permissions for Data Collection > Data Sources. Configuration of data ingestion from...

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* If your firewalls are located in a different region, or bandwidth issues are encountered due to large log size, you can ingest NGFW logs in CEF format, using the Syslog collector. However, the Syslog solution is not as powerful nor as comprehensive as this data collector, and should only be used when this data collector cannot be used. For more...

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version.

* Cortex XSIAM does not validate your firewall credentials, you must ensure the certificates or PSK details have been updated in your firewalls in order for data to stream.

* It might take an hour or longer after connecting the firewall in Cortex XSIAM until you start seeing notifications that the certificate has been approved, and that the logging service license has appeared on the firewall.

* IOC and BIOC issues are applicable on stitched data only, and are not available on raw data.

##### Tip

* You can see an overview of ingestion status for all log types, and a breakdown of each log type and its daily consumption quota on the NGFW Ingestion Dashboard.

  11.3.5.2.1. Ingest Next-Generation Firewall logs using the Syslog collector

##### Note

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version, to ensure that you have configured log forwarding correctly for all the log types that you would like to forward to Cortex XSIAM. The following steps only cover...

* To avoid the possible effects of line formatting, do not copy/paste the message formats directly into the PAN-OS web interface. Instead, paste into a text editor, remove any carriage return or line feed characters, and then copy and paste into the web interface.

* From version 10.0 and later, the log format documented for log types (Traffic, Threat, and URL) exceeds the maximum supported 2048 characters in the Custom Log Format tab on the firewall and Panorama. Select the CEF keys and values to limit the number of characters to 2048, as per your requirements.

  11.3.5.3. Ingest data from Prisma Access

##### Prerequisite

* Configuration of data ingestion from multiple accounts requires Super User permissions in both Cortex XSIAM tenant and Prisma Access accounts.

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* Cortex XSIAM does not validate your Prisma Access account credentials. You must ensure the account has been deployed in order for data to stream.

  11.3.5.4. Ingest logs from Prisma Access Browser

  11.3.5.5. Ingest detection data from Strata Logging Service

##### Note

* IOC and BIOC issues are applicable on stitched data only and are not available on raw data.

  11.3.5.6. Ingest alerts and assets from IoT Security

  11.3.5.7. Collecting URL and File log types

  11.3.5.7.1. Detectors connected to URL and File log types

  11.3.6. External data ingestion

  11.3.6.1. External applications

  11.3.6.2. Ingest network connection logs

  11.3.6.2.1. Ingest network flow logs from Amazon S3

##### Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* To create a new VPC, click Launch VPC Wizard. For more information, see AWS VPC Flow Logs.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex XSIAM.

  11.3.6.2.1.1. Create an assumed role

##### Note

* In AWS this is an optional field to configure, but this must be configured to set up the Amazon S3 Collector in Cortex XSIAM .

* The <s3-arn> and <sqs-arn> placeholders. These will be filled out later depending on which Amazon S3 logs you are configuring, including network flow logs, audit logs, or generic logs.

  11.3.6.2.1.2. Configure data collection from Amazon S3 manually

##### License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

##### Note

* If you already have an Amazon S3 bucket configured with VPC flow logs that you want to use for this configuration, you do not need to perform the prerequisite steps detailed in the first two bullets.

* It is your responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* If you already have an Amazon S3 bucket configured with VPC flow logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

  11.3.6.2.2. Ingest network Route 53 logs from Amazon S3

##### Note

* For more information on configuring data collection from Amazon S3 for Route 53 DNS logs, see the AWS Documentation.

* For more information on creating a Stack, see Creating a stack on the AWS CloudFormation console.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex XSIAM.

  11.3.6.2.3. Ingest logs from Check Point firewalls

##### Note

* Logs with sessionid = 0 are dropped. Destination Port data is available only in the raw logs.

  11.3.6.2.4. Ingest logs from Cisco ASA firewalls and AnyConnect

  11.3.6.2.5. Ingest logs from Corelight Zeek

  11.3.6.2.6. Ingest logs from Fortinet Fortigate firewalls

  11.3.6.2.7. Ingest logs from Microsoft Azure Event Hub

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

##### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

##### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  11.3.6.2.8. Ingest network flow logs from Microsoft Azure Network Watcher

##### Prerequisite

* For NSG:    Ensure that your NSG flow logs in Azure Network Watcher conform to the requirements as outlined in Microsoft documentation. For more information, see Introduction to flow logging for network security groups.   Enable NSG flow logs in the Microsoft Azure Portal. For NSG: Ensure that your NSG flow logs in Azure Network Watcher conform to the...

##### Note

* In addition to your storage account, the template automatically creates another storage account that is required by the function app for internal use only. The internal storage account name is prefixed with cortex and is followed by a unique suffix based on the resource group, storage account, and container names.

  11.3.6.2.9. Ingest logs and data from Okta

  11.3.6.2.10. Ingest logs from Windows DHCP using Elasticsearch Filebeat

##### Note

* To avoid formatting issues in filebeat.yml, we recommend that you edit the text file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating the profile.

* For more information on configuring the filebeat.yml file, see the Elastic Filebeat Documentation.

* To avoid formatting issues in your filebeat.yml, we recommend that you use the download example file to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your file.

* The tokenizer definition is dependent on the Windows server version that you are using as the log format differs. -For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" -For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{mac...

  11.3.6.2.11. Ingest logs from Zscaler Internet Access

  11.3.6.2.12. Ingest logs from Zscaler Private Access

##### Note

* For more information on configuring the parameters on the screen, see the Zscaler Private Access (ZPA) documentation for Configuring a Log Receiver.

* You can only configure a ZPA log receiver to collect one type of log with your Syslog Collector in Cortex XSIAM. To configure more that one log type, you'll need to add another log receiver.

  11.3.6.3. Ingest authentication logs and data

  11.3.6.3.1. Ingest audit logs from AWS Cloud Trail

##### Note

* For more information on configuring data collection from Amazon S3 using AWS CloudTrail, see the AWS CloudTrail Documentation.

* For more information on creating an AWS CloudTrail trail, see Create a trail. If you already have an Amazon S3 bucket configured with AWS CloudTrail audit logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* It is your organization's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* The CloudWatch Logs - optional settings are not supported and should be left disabled.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It your organization's responsibility to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

  11.3.6.3.2. Ingest logs and data from a GCP Pub/Sub

##### Note

* When collecting flow logs, we recommend that you include GKE annotations in your logs, which enable you to view the names of the containers that communicated with each other. GKE annotations are only included in logs if appended manually using the custom metadata configuration in GCP. For more information, see VPC Flow Logs Overview. In addition, to...

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the GCP data collector settings. Yet, when the values are blank in the...

  11.3.6.3.3. Ingest logs and data from Google Workspace

##### Note

* For all types of data collected via the Admin Reports API, except alerts and emails, the log events are collected with a preset lag time as reported by Google Workspace. For more information on these lag times for the different types of data, see Google Workspace Data retention and lag times.

* Spam emails from the compliance email account, and from all other monitored email accounts, are not collected. Any draft emails written in the compliance email account are collected by the Google Workspace data collector, and are then deleted even if the email was never sent.

* For more information on the entire process, see Perform Google Workspace Domain-Wide Delegation of Authority.

* When collecting Google Workspace alerts with other types of data, except emails, you need to configure a service account in Google with the applicable permissions to collect events from the Google Reports API and alerts from the Alert Center API. If you prefer to use different service accounts to collect events and alerts separately, you'll need to...

* For more information on the Admin Reports API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information on the Gmail API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information about the events collected from the various Google Reports, see Google Workspace Reports API Documentation.

  11.3.6.3.4. Ingest logs from Microsoft Azure Event Hub

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

##### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

##### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  11.3.6.3.5. Ingest logs from Microsoft Office 365

##### Note

* Ingesting Microsoft Entra ID (formerly known as Azure AD) authentication and audit events from Microsoft Graph API requires a Microsoft Azure Premium 1 or Premium 2 license. Alternatively, if the directory type is Azure AD B2C, the sign-in reports are accessible through the API without any additional license requirement. To ingest email logs and data...

* When auditing is turned off from the default setting, you need to first turn on auditing for your organization to collect Microsoft Office 365 audit events from the Management Activity API. Log duplication of up to 5% in Microsoft products is considered normal. In some cases, such as login to a portal using MFA, two log entries are recorded by design.

* To address Azure reporting latency, there is a 10-minute latency period for Cortex XSIAM to receive Azure AD logs.

* You can also implement the corresponding Cortex Data Model (XDM) mappings for these Microsoft Graph Security API v2 alerts using Cortex Marketplace via the Microsoft Graph Security content pack.

* For more information, see the Office 365 Management Activity API schema.

* In FedRAMP environments, Azure sign-in logs are not supported, due to vendor technical constraints.

* Use this option when you don't want to grant permissions for Azure AD Authentication and Azure AD Audit.

  11.3.6.3.6. Ingest logs and data from Microsoft 365

##### License Type

  Email data: The subject, body, and attachments are visible only with an Email Security module license.

##### Prerequisite

* A user account with the Microsoft Azure Account Administrator role is required to set up a new Microsoft 365 email collector. The following Microsoft Graph API permissions are required:    Mailbox access (read-write)    Read and write mail in all mailboxes   Read contacts in all mailboxes   Read all user mailbox settings      User information, groups,...

##### Note

* For other logs from Microsoft Office 365, use the Office 365 data collector. For more information, see Ingest logs from Microsoft Office 365.

  11.3.6.3.7. Ingest logs and data from Okta

  11.3.6.3.8. Ingest logs and data from OneLogin

##### Note

* Event data is collected every 30 seconds.

* Inventory data snapshots are collected every 10 minutes.

  11.3.6.3.9. Ingest authentication logs from PingFederate

  11.3.6.3.10. Ingest authentication logs and data from PingOne

##### Navigation

  Reporting → Subscriptions → Add Subscription

  11.3.6.4. Ingest operation and system logs from cloud providers

  11.3.6.4.1. Ingest generic logs from Amazon S3

##### License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

##### Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* You need to set up an Amazon S3 data collector to receive generic logs when collecting logs from BeyondTrust Privilege Management Cloud. For more information, see Ingest logs from BeyondTrust Privilege Management Cloud.

* If you want to ingest raw EDR events from SentinelOne DeepVisibility, use the SentinelOne DeepVisibility log collector. For more information, see Ingest raw EDR events from SentinelOne DeepVisibility.

* It is the customer's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It is the responsibility of your organization to ensure that the user who performs this task of creating the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor...

  11.3.6.4.2. Ingest logs from Amazon CloudWatch

  11.3.6.4.3. Ingest logs and data from a GCP Pub/Sub

##### Note

* When collecting flow logs, we recommend that you include GKE annotations in your logs, which enable you to view the names of the containers that communicated with each other. GKE annotations are only included in logs if appended manually using the custom metadata configuration in GCP. For more information, see VPC Flow Logs Overview. In addition, to...

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the GCP data collector settings. Yet, when the values are blank in the...

  11.3.6.4.4. Ingest logs from Google Kubernetes Engine

##### Note

* Cortex XSIAM supports logs in single line format or multiline format. For more information on handling messages that span multiple lines of text in Elasticsearch Filebeat, see Manage Multiline Messages.

  11.3.6.4.5. Ingest logs from Microsoft Azure Event Hub

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

##### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

##### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  11.3.6.4.6. Ingest logs and data from Okta

  11.3.6.5. Ingest endpoint data

  11.3.6.5.1. Ingest alerts and metadata from CrowdStrike APIs

##### Note

* To enable some of the APIs, you may need to reach out to CrowdStrike support.

* For more information on configuring data collection from CrowdStrike APIs, see the CrowdStrike Documentation.

* Ensure that you save the SECRET value because this is the only time that it is displayed.

  11.3.6.5.2. Ingest raw EDR events from CrowdStrike Falcon Data Replicator

##### Prerequisite

* Ensure that your organization has a license for the CrowdStrike Falcon Data Replicator (FDR). Ensure that CrowdStrike FDR is enabled. CrowdStrike FDR can only be enabled by CrowdStrike Support. If CrowdStrike FDR is not enabled, submit a support ticket through the CrowdStrike support portal. Follow these steps to check if CrowdStrike FDR is...

##### Note

* Due to limitations with the S3 bucket used by CrowdStrike, data can only be collected once, by one system.

* For more information on configuring data collection from CrowdStrike via Falcon Data Replicator, see CrowdStrike documentation.

* Ensure that you copy the Secret, and store it in a safe place. You will not be able to retrieve it later. If you need a new secret, you must reset the feed credentials.

* CrowdStrike Falcon Data Replicator only supports one FDR credential configuration.

* Ensure that you save the SECRET value, because this is the only time that it is displayed. You can go back to this page later to copy the other credentials, but you will not have access to the secret again.

  11.3.6.5.3. Ingest raw EDR events from Microsoft Defender for Endpoint

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection. Create an Azure Event Hub. For more information, see Quickstart: Create an event hub using Azure portal.    Create a resource group (optional if you already have a resource group configured).   Create an Event Hubs namespace.   Create an event hub within the namespace....

##### Note

* The generic Cortex XSIAM Azure Event Hub collector does not offer full functionality for EDR data (such as stitching), and is therefore not suitable for EDR data ingestion.

* If you select all event types and leave Event-Hub name empty, an event hub will be created for each category in the selected namespace. If you are not using a Dedicated Event Hubs ClusterEvent Hub, namespaces have a limit of 10 Event Hubs.

  11.3.6.5.4. Ingest raw EDR events from SentinelOne DeepVisibility

##### Prerequisite

* The SentinelOne DeepVisibility logs that will be collected by your dedicated Amazon S3 bucket must adhere to the following guidelines:    Each log file must use the 1 log per line format as multi-line format is not supported.   The log format must be compressed as gzip or uncompressed.   For best performance, we recommend limiting each file size to up...

##### Note

* It is your responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule on the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If you receive an error when trying to save your changes, check that the permissions are set up correctly, and fix them if necessary.

* It is the responsibility of your organization to ensure that the user who creates the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors.

* For more information, see Managing access keys for IAM users.

  11.3.6.6. Ingest cloud assets

##### Note

* The cloud accounts being onboarded must be owned by the customer performing the onboarding process.

  11.3.6.6.1. Onboard Amazon Web Services

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

##### Prerequisite

* Before you begin, ensure you have: Access to AWS Management Console Required AWS permissions

##### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* When onboarding an AWS organization or organizational unit (OU), Cortex XSIAM creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

* See the prerequisites above for specific permissions required for serverless functions.

* If you select Automated, you must already be logged in to AWS.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

  11.3.6.6.1.1. Manually upload template to AWS

##### Prerequisite

* Before you begin, ensure you have: An AWS account Access to AWS Management Console Permission to create a stack and its resources in AWS CloudFormation

  11.3.6.6.2. Onboard Google Cloud Platform

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

##### Prerequisite

* Before you begin, ensure you have: Access to Google Cloud Console Admin user with required admin GCP permissions Enabled the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled) Enabled the following APIs in the GCP project you are...

##### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

  11.3.6.6.2.1. Manually upload template to GCP

##### Prerequisite

* Before you begin, ensure you have: A GCP account. Permission to create the required resources in Google Cloud Deployment Manager. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool.

##### Note

* The directory you create must be a subdirectory of the home directory.

  11.3.6.6.2.2. Monitor GCP resources inside service perimeters

##### Note

* Each GCP cloud instance is assigned a scope within GCP. If the scope, whether it be organization, folder, or project, includes any projects with a service perimeter, this procedure must be performed for that cloud instance to authorize Cortex XSIAM to scan the resources in the perimeter.

  11.3.6.6.3. Onboard Microsoft Azure

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

##### Prerequisite

* Before you begin, ensure you have: An Azure subscription Admin permissions required to onboard Azure or the built-in Security Administrator role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups.

##### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

  11.3.6.6.3.1. Manually upload template to Microsoft Azure Resource Manager using the CLI

##### Prerequisite

* Ensure the Azure CLI tool is installed and you are authorized to create management group policies.

  11.3.6.6.3.2. Manually upload template for Microsoft Azure subscriptions

##### Prerequisite

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the subscription scope. We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed Terraform on your local machine. You can download Terraform from the official...

* Ensure the Azure CLI tool is installed and you are authorized to create management group policies.

  11.3.6.6.4. Onboard Oracle Cloud Infrastructure

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

##### Prerequisite

* Before you begin, ensure you have: Access to Oracle Cloud Infrastructure console Permissions for all of the following are required:    Creation of identity groups (for more information, refer to Managing Groups)   Policies (for more information, refer to How Policies Work)   Tag namespaces in the root compartment (for more information, refer to Tags...

##### Note

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only; you can only modify the instance from the Data Sources page.

  11.3.6.6.4.1. Manually upload template to OCI

##### Prerequisite

* Before you begin, ensure you have: An Oracle Cloud Infrastructure account and the tenancy OCID. Permission to deploy a custom template and create its resources in OCI. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed...

  11.3.6.6.5. Configure AWS integration instances and monitor integration instance health

##### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  11.3.6.6.6. Manually connect a cloud instance

  11.3.6.6.7. Outposts

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Before you begin, ensure you have: An AWS account Permission to create a stack and its resources in AWS Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the AWS CLI tool and configured your profile with the aws...

* Before you begin, ensure you have: A GCP account Permission to create the required resources in Google Cloud Deployment Manager Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool

* Before you begin, ensure you have: An active Azure subscription. Installed the Azure CLI tool. Permission to deploy a custom template and create its resources in Microsoft Azure ("Owner" or "Contributor" on the designated outpost subscription scope, and Active Directory "Cloud Application Administrator" or "Application Administrator" privileged...

##### Note

* We recommend you use a dedicated account for the outpost, free from other resources. You can only onboard one outpost for each account.

* When creating an outpost for a specific Azure subscription, the outpost account must be in the same Azure organization as the monitored subscriptions.

##### Navigation

  Settings → Data Collection → Outposts

  You can create a new outpost by navigating to Settings → Data Collection → Outposts and clicking New Outpost

  11.3.6.6.8. Container Registry Scanning

  11.3.6.6.8.1. Overview of container registry scanning

  11.3.6.6.8.1.1. Registry Components

  11.3.6.6.8.1.2. How Container Registry Scanning Works

  11.3.6.6.8.2. Configure registry scanning

##### Prerequisite

* Ensure that you have performed the all steps till Additional Security Capabilities as listed in the onboarding wizard for the required CSP: Onboard Amazon Web Services Onboard Google Cloud Platform Onboard Microsoft Azure

  11.3.6.6.8.3. Modify the container registry scanning scope

  11.3.6.6.8.4. Scan re-evaluation process

  11.3.6.6.8.5. Connect Docker V2 compliant container registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

##### Note

* Scanning is supported only for private repositories on Docker Hub.

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* FedRAMP is not supported for this mode.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  11.3.6.6.8.5.1. Manage a Docker V2 connector

  11.3.6.6.8.6. Connect JFrog container registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

##### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  11.3.6.6.8.6.1. Manage a JFrog connector

  11.3.6.6.9. Cloud service provider permissions

  11.3.6.6.9.1. Amazon Web Services provider permissions

  11.3.6.6.9.2. Google Cloud Platform provider permissions

  11.3.6.6.9.3. Microsoft Azure provider permissions

  11.3.6.6.9.4. Oracle Cloud Infrastructure provider permissions

  11.3.6.7. Ingest data for API security

  11.3.6.7.1. Ingest AWS API Gateway

##### Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

##### Important

* Leave '–'filter-pattern empty as displayed above.

  11.3.6.7.2. Ingest Azure APIM

##### License Type

  Requires the Data Collection add-on.

##### Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

##### Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

  11.3.6.7.3. Ingest Apigee Proxy

##### License Type

  Requires the Data Collection add-on.

##### Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

##### Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

  11.3.6.7.4. Ingest Kong

##### License Type

  Requires the Data Collection add-on.

##### Note

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

##### Important

* The size of the buffer must be equal to or larger than the max body size setting in the plugin configuration, on every data plane node.

  11.3.6.8. Ingest data from third-party pipeline solutions

  11.3.6.8.1. Ingest data from Cribl

##### Prerequisite

* Ensure that you have the credentials and IDs for each data source, such as Tenant ID, App ID and Client secret.

* Ensure that you have the copies of the Cortex XSIAM authorization token and API URL obtained in Task 2.

##### Note

* We do not support email data collection via Cribl.

* Only one Cribl data collector instance can be configured in Cortex XSIAM.

  11.3.6.8.1.1. Data source UUIDs

##### Note

* Do not use this generic UUID when your data source is listed in this table.

  11.3.6.9. Additional log ingestion methods

  11.3.6.9.1. Ingest logs from a Syslog receiver

  11.3.6.9.2. Ingest Apache Kafka events as datasets

  11.3.6.9.3. Ingest CSV files as datasets

  11.3.6.9.4. Ingest database data as datasets

  11.3.6.9.5. Ingest logs in a network share as datasets

##### Note

* The Files and Folders Collector applet only starts to collect files that are more than 256 bytes.

  11.3.6.9.6. Ingest FTP files as datasets

  11.3.6.9.7. Ingest NetFlow flow records as datasets

  11.3.6.9.8. Set up an HTTP log collector to receive logs

##### Note

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor...

* Each record cannot exceed 5 MB in size.

  11.3.6.9.9. Ingest logs from BeyondTrust Privilege Management Cloud

##### Note

* For a Log Format set to Beyondtrust Cloud ECS, the following fields are automatically set and not configurable. Vendor: Beyondtrust Product: Privilege Management Compression: Uncompressed

  11.3.6.9.10. Ingest logs and data from Box

##### Prerequisite

* Set up an Enterprise Box plan.  Important To collect Box Shield Alerts, you must purchase Box Shield and it must be enabled on Box enterprise. Set up an Enterprise Box plan. Create a valid Box account that is assigned to a role with sufficient permissions for the data you want to collect. For example, create an account assigned to an Admin role to...

##### Note

* The Fetch Intervals are non-configurable.

* Collecting Box Shield Alerts requires implementing Box Shield,

* There is a current bug with the Groups API from Box. If you don't configure the Box app with the proper permissions for managing groups data, the Groups API from Box won't return an error message to Cortex XSIAM indicating that the API failed to receive the data, and the Groups data will not be collected.

* For any future change that you make to your Box app, ensure that you send the changes for approval to the administrator, who will need to approve them as explained above.

* Inventory data snapshots are collected every 10 minutes.

  11.3.6.9.11. Ingest logs and data from Dropbox

##### Prerequisite

* Set up an Advanced Dropbox plan. Create a Dropbox Business admin account with Security admin permissions, which is required to authorize Cortex XSIAM to access the Dropbox Business account and generate the OAuth 2.0 access token.

##### Note

* The Fetch Interval is non-configurable.

* When the App Key field is empty, the here link in the tooltip is disabled. When an incorrect App Key is entered, clicking the link results in a 404 error.

* Whenever you change the permissions of the Dropbox app, we recommend that you generate a new Access Code for the Dropbox data collector instance so that the permissions match the updates.

* Event data is collected every 60 seconds with a 10 minute lag time.

* Inventory data snapshots are collected every 10 minutes.

  11.3.6.9.12. Ingest logs from Elasticsearch Filebeat

##### Navigation

  You can return to the Settings → Configurations → Data Collection → Data Sources page to monitor the status of your Filebeat configuration

  11.3.6.9.13. Ingest logs from Forcepoint DLP

  11.3.6.9.14. Ingest logs from Proofpoint Targeted Attack Protection

  11.3.6.9.15. Ingest logs and data from Salesforce.com

##### Prerequisite

* Cortex XSIAM:    To manage collection integration in Cortex XSIAM, ensure that you have the privilege to View/Edit Log Collections (for example, Instance Administrator). Cortex XSIAM: To manage collection integration in Cortex XSIAM, ensure that you have the privilege to View/Edit Log Collections (for example, Instance...

##### Note

* For more detailed reference information, see Configure a Connected App for the OAuth 2.0 Client Credentials Flow. Unlike other data collector setups, in this case, the setup includes obtaining an OAuth 2.0 code from Salesforce.com, and this code is only valid for 15 minutes. Therefore, make sure that you enable the data collector within 15 minutes of...

* When these options are cleared, only these data types will be omitted from collection. All other data will be collected as usual.

  11.3.6.9.16. Ingest data from ServiceNow CMDB

  11.3.6.9.17. Ingest report data from Workday

##### Prerequisite

* Create an Integration System User that is designated to access the custom report from Workday for data collection in Cortex XSIAM. Create an Integration System Security Group for the Integration System User created in Step 1 for accessing the report. When setting this group ensure to define the following:    Type of Tenanted Security Group: Select...

##### Note

* Any user with permissions to view issues and cases can view the Workday data.

* For more information on completing any of the prerequisite steps, see the Workday documentation.

* The Business Object changes depending on the Data Source selected.

* Cortex XSIAM uses a structured schema when integrating Workday data. To get the best Analytics results, specify all the fields marked with an asterisk from the recommended schema. workday_user_id* full_name* workday_manager_user_id* manager* worker_type* position_title* department* private_email_address* business_email_address* employment_start_date* em...

  11.3.6.9.18. Ingest external alerts

##### Note

* If you send pre-parsed alerts using the Cortex XSIAM API, additional mapping is not required.

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → Data Collection → External Issue Mapping

  11.3.7. Onboard the Kubernetes Connector

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Note

* For GKE or EKS clusters with the metadata service disabled and for AKS clusters with non-default nodes managed resource group, the cluster resource identifier must be specified.

  11.3.7.1. What's new in Kubernetes Connector?

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

  11.3.8. Automation and feed integrations

##### Note

* Some integrations can be downloaded directly without having to initially download a content pack from Marketplace. For more information, see Define data sources. In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as...

* If the integration was installed from a content pack, you need to duplicate the integration before editing.

* If the integration was installed from a content pack, you need to duplicate the integration before downloading.

* Integration commands are only available when the integration instance is enabled. Some commands depend on a successful connection between Cortex XSIAM and third-party integrations.

##### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

  11.3.8.1. Integration use cases

  11.3.8.2. Add an integration instance

##### Note

* This procedure describes how to add an integration instance from the Automation and Feed Integration page. Some integration instances can also be configured on the Data Sources page. For more information, see Add a new data source or instance.

* In some integrations, a classifier, an issue type, and mapper fields are included.

##### Navigation

  Settings → Configurations → Data Collection → Automation & Feed Integrations and search for the integration

  11.3.8.3. Configure integration permissions

##### Navigation

  Settings → Configurations → Data Collection → Integration Permissions

  11.3.8.4. Fetch issues from an integration instance

##### Note

* In some integrations, the Issue Fetch interval is called Feed Fetch Interval. If the integration instance does not have the Issue Fetch Interval field, you need to add this field by editing the integration settings. If the integration is from a content pack, you need to create a copy of the integration. Any future updates to this integration will not...

* Some content packs include preconfigured correlation rules, but you should review them to see if they suit your use case and duplicate them if required. Go to Threat Management → Detection Rules → Correlations, search for the relevant rule, right-click, and select Preview Rule. For example, the ServiceNow v2 Alerts (automatically generated)...

  11.3.8.4.1. Map fields to issue types

##### Note

* In the Classification & Mapping page, the mapping does not indicate for which issue types they are configured. Therefore, when creating a mapper, it is best practice to add to the mapper name, the issue types the mapper is for. For example, Mail Listener - Phishing.

* When mapping a list, we recommend you map to a multi select field. Short text fields do not support lists. If you do need to map a list to a short text field, add a transformer in the relevant playbook task, to split the data back into a list.

##### Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

  Settings → Configurations → Data Collection → Automation & Feed Integrations

  11.3.8.4.2. Classify events using a classifier for issue types

##### Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

  Settings → Configurations → Data Collection → Automation & Feed Integrations

  11.3.8.5. Troubleshoot Integrations

  11.3.8.6. Forward Requests to Long-Running Integrations

##### Note

* This integration replaces the External Dynamic list integration, which is deprecated. For more information about how to set up the integration, see Manage external dynamic lists.

* When running on the tenant, you can only use long-running integrations provided by Cortex XSIAM, you cannot create custom ones. Custom long-running integrations are supported only on engines at this time. Configuring custom certificates or private API Keys in the long-running integration instance is supported only on engines, not on the Cortex XSIAM...

* For the TAXII Server and TAXII2 Server integrations, the xdr string is automatically replaced by crtx. For the Microsoft Teams integration, you can use the microsoft-teams-create-messaging-endpoint command to get the correct messaging endpoint based on the server URL, the server version, and the instance configurations. For more information, see...

  11.3.9. Verify collector connectivity

##### Note

* For more information on troubleshooting data collector applet errors, see Troubleshoot Broker VM applet connectivity.

* If an issue is triggered, the investigation options in the right-click menu of the Health Issues pages are context-specific. Make sure that you specify the relevant issue category.

  11.3.10. Overview of data ingestion metrics

##### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics. Data Ingestion Monitoring: Go to Configurations → General → Server...

  11.3.10.1. Creating correlation rules to monitor data ingestion health

  11.3.10.2. Measuring data freshness

##### Note

* The max_delay metric is taken from the maximum bucket value with a restricted limit; therefore, metrics show whole numbers. The median and ninetieth_percentile metrics are statistical calculations that give an approximation of the real value; therefore, metrics show decimal numbers. Time slots with a zero log count or zero byte count display records...

  11.3.11. About health issues

##### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics. Data Ingestion Monitoring: Go to Configurations → General → Server...

##### Note

* The Health Issues page displays issues that were triggered after July 2024. To see health issues that were triggered before this date, click Legacy Health Issues.

* Cortex XSIAM enforces the dedup logic to health issues. This logic reduces the likelihood of identical health issues from flooding the issues dataset.

  11.3.11.1. Investigate and resolve health issues

  11.3.11.2. Monitor data ingestion health

##### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable Data Ingestion Monitoring in your Server Settings. For more information, see Set up your environment.

  11.3.11.3. Monitor correlation rules

##### Note

* In the dataset, the Query start time and Query end time indicate the timeframe of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

  11.4. Dataset management

##### License Type

  Managing Roles requires an Account Admin or Instance Administrator role. For more information, see Predefined user roles.

##### Note

* Cold storage, in addition to a cold storage license, requires compute units (CU) to run cold storage queries. For more information on CU, see Manage compute units. For information on the CU add-on license, see Understand the Cortex XSIAM license planUnderstand the Cortex XSIAM license plan.

* Only datasets that are already handled as part of the GB license are supported for this license. In addition, the retention configuration is only available in Cortex XSIAM, as opposed to the public APIs.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default. Datasets include dataset permission enforcements in the Cortex Query Language(XQL), Query Center, and XQL Widgets. For example, to view or access any of the endpoints and host_inventory datasets, you need role-based access control (RBAC)...

* You'll only be able to save the dataset view if the query contains no errors; otherwise, the Save button is disabled.

* For more information on user roles, see Manage user roles.

##### Important

* Cortex XSIAM enforces retention on all log-type datasets excluding Host Inventory, Vulnerability Assessment, Metrics, and Users.

* This column is updated once a day. Therefore, if the dataset was created or updated by the target or lookup flows, it's possible that the Last Updated value is a day behind when the queries or reports were run as it was before this column was updated.

  11.4.1. What are datasets?

##### Note

* For more information on tasks specific to lookup datasets, see Lookup datasets.

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

##### Important

* By default, forensic datasets are not included in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  11.4.2. Lookup datasets

##### Note

* A lookup dataset can only be deleted if there are no other dependencies. For example, if a Correlation Rule is based on a lookup dataset, you wouldn't be able to delete the lookup dataset until you removed the dataset from the XQL query of the Correlation Rule.

  11.4.2.1. Import a lookup dataset

##### Prerequisite

* When uploading a CSV, TSV, or JSON file, ensure that the file meets the following requirements: The maximum size for the total data to be imported into a lookup dataset is 30 MB from the Dataset Management page. Otherwise, the limit is 50 MB using Cortex Query Language (XQL) or APIs. Field names can contain characters from different languages, special...

##### Important

* The name of a dataset created from a TSV file must always include the extension. For example, if the original file name is mrkdptusrsnov23.tsv, you can save the dataset with the name marketing_dept_users_Nov_2023.tsv.

  11.4.2.2. Download JSON file of lookup dataset

##### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  11.4.2.3. Set time to live for lookup datasets

##### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  11.4.3. Monitor datasets and dataset views activity

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  11.5. Archived data

  11.5.1. Import historical data into cold storage

##### License Type

  Importing historical data into cold storage requires a Period-Based Retention - Cold Storage add-on license.

##### Prerequisite

* Importing historical data into cold storage requires a View/Edit RBAC permission for Data Management (under Configurations).

  11.5.2. Building XQL archived data queries

##### Prerequisite

* Archived cold storage, in addition to a Period-Based Retention - Cold Storage add-on license, requires compute units (CU) to run archived cold storage queries. Cortex XSIAM provides a free daily quota of compute units (CU) allocated according to your license size. Queries run without enough quota will fail. To expand your investigation capabilities,...

  11.5.3. Success and failure code responses to your HTTP POST requests

  11.6. Parsing Rules

  11.6.1. What are Parsing Rules?

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

  11.6.2. Parsing Rules editor views

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

  11.6.3. Parsing Rules file structure and syntax

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Cortex XQL Language Reference.

* An inner type of join stage is only supported in CONST, INGEST, and RULE sections and is not supported in a COLLECT section. You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

* The regexcapture function is only supported in Parsing Rules and cannot be used in any other XQL query.

* Every statement in the Parsing Rules file must end with a semicolon (;).

  11.6.3.1. INGEST

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* You can't add tags to parsing rules using the Next-Generation Firewall (NGFW) datasets that are in the format panw_ngfw_<text>_raw, and the Observability dataset called panw_observability_raw.

  11.6.3.2. COLLECT

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

##### Note

* The CSV Collector applet is not affected by the COLLECT rules applied to a Broker VM.

##### Tip

* To reduce the amount of data transmitted to Cortex XSIAM from the broker, use filters to drop logs. Yet, be aware that once the logs are modified using alter or fields stages, the Broker VM will convert the original log into a JSON format, which could increase the data size being sent from the broker to Cortex XSIAM.

  11.6.3.3. CONST

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

##### Note

* The dollar sign ($) must be adjacent to the [CONST] name, without any whitespace in between.

##### Important

* Only quoted or integer terminal values are considered valid for CONST sections.

  11.6.3.4. RULE

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Get started with XQL.

* You can also add tags using only the INGEST section. For more information, see INGEST.

  11.6.3.5. EXTEND

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Get started with XQL.

  11.6.4. Create Parsing Rules

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* You need Cortex XSIAM administrator or Instance Administrator permissions to access the Simulate view and perform these tests.

  11.6.5. Troubleshooting Parsing rules errors

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* Some errors can only be found after the applicable logs are collected in Cortex XSIAM.

  11.6.6. Parsing Rules Raw Dataset

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

  11.7. Data Model Rules

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

  11.7.1. What are Data Model Rules?

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

  11.7.2. Data Model Rules editor views

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

  11.7.3. Data Model Rules file structure and syntax

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

* For more information on XQL syntax, see the XQL Language Reference Guide.

* You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

  11.7.3.1. MODEL

##### Note

* The Settings → Configurations → XQL Configuration → Case Sensitivity (case_sensitive) setting can overwrite this case_sensitive configuration for all fields in the application except for BIOCs, which will remain case insensitive no matter what this setting is set to. For more information on this setting, see XQL Configuration.

* We recommend that you do not configure the same data source in both Marketplace and using a Cortex XSIAM data collector. Yet, if you do, the following will happen: For network data, all relevant logs from the different data sources are stitched to the same network story. For authentication data, all relevant logs from the different data sources are...

  11.7.3.2. RULE

##### Note

* For more information on the XQL syntax, see the XQL Language Reference Guide.

  11.7.3.3. Field structure

##### Note

* For more information on these data model fields, see Cortex XSIAM Data Model Schema.

  11.7.4. How to map authentication story events?

##### Prerequisite

* Familiarize yourself with the Cortex Data model (XDM) schema for field definitions and naming conventions, see Cortex XSIAM Data Model Schema.

##### Important

* This Feature focuses on authentication events related to SSO (Single Sign-On) and SaaS (Software-as-a-Service) application authentications. It does not cover internal authentication mechanisms such as Kerberos, NTLM, or traditional domain logon events generated by on-premise infrastructure.

* To maximize the variety of issues that are retrieved based on the XDM authentication stories, we recommend that the following additional fields are populated: xdm.target.resource_name, xdm.logon.type, xdm.source.user_agent, and xdm.source.host.device_category. Should you decide to change the default XDM mappings, ensure that both the mandatory and...

  11.7.5. Create Data Model Rules

##### Prerequisite

* Data Model Rules editor views Data Model Rules file structure and syntax How to map authentication story events?

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → Data Management → Data Model Rules

  11.7.6. Troubleshooting Data Model Rules

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

* Since this dataset also contains Parsing Rules errors, some of the fields are irrelevant for Data Model Rules and aren't included in the table.

##### Tip

* To ensure you and your colleagues stay informed about Data Model Rules activity, you can also Configure notification forwarding to forward your Data Model Rules audit logs to an email distribution list or Syslog server. For more information about the Data Model Rules audit logs, see Monitor Data Model Rules activity.

  11.7.7. Using data enrichment

##### Note

* For a complete list of auto-enriched fields, see the Cortex Data Model Schema Guide.

##### Important

* When manually mapping ASN fields that are enriched, such as xdm.source.asn.as_number, with other ISP and domain fields that are not enriched, such as xdm.source.asn.isp and xdm.source.asn.domain, it's possible to receive incorrect XDM query results due to the misalignment between the overridden enrichement and system enrichment fields.

  11.7.8. Data Model Rules notifications

  11.7.9. Monitor Data Model Rules activity

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  11.8. Manage Event Forwarding

##### License Type

  This feature requires an Event Forwarding add-on license. Only Administrators have access to this screen.

##### Important

* Since data is aggregated and compressed, it can take up to two hours until the data is available in the forwarding bucket.

##### Navigation

  Under Settings → Configurations → Data Management → Event Forwarding, activate the licenses in the Activation section

  11.8.1. Endpoints Event Forwarding - included/excluded fields by event type

##### License Type

  This feature requires an Event Forwarding add-on license. Only Administrators have access to this screen.

  11.9. Manage compute units

##### Note

* For more information, see Import historical data into cold storage.

* The CU consumption of cold storage queries is based on the number of days in the query time frame. For example, when querying 1 hour of a specific day, the CU of querying this entire day is consumed. When querying 1 hour that extends past 2 days, such as from 23:50 to 00:50 of the following day, the CU of querying these two days is consumed.

  11.9.1. Compute units usage

##### Note

* To enable the add-on, select Settings  → Configurations → Cortex XSIAM License → Addons tile, and select the Compute Unit tile and Enable.

##### Navigation

  Settings → Configurations → Data Management → Compute Unit Usage

12. Marketplace

  12.1. Cortex Marketplace

  12.2. Content packs

##### Note

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

  12.3. Content Pack Support Types

##### Note

* Palo Alto Networks is not liable for and does not warrant or support any content pack produced by a third-party publisher. Palo Alto Networks does not support content packs that do not have official available documentation.

  12.4. Cortex XSIAM content

  12.5. Manage content packs

##### Note

* Optional content packs that are already installed are treated like they are required content packs to preserve content integrity.

* In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as scripts or integrations.

* Third-party product Integrations are developed and tested against a specific product version. For products that are on-prem or cloud-based with specific API versions, the version developed and tested against will be included in the integration's documentation. Newer versions of the product are not always immediately tested, and it is expected that...

##### Caution

* If another content pack is dependent on the content pack you want to delete, it may break the other content pack. You can reinstall the content pack, but you cannot restore detached and customized content.

* If you want to downgrade, any content that depends on the content pack including any customizations may be deleted if it does not exist in the target content pack version.

  12.6. Marketplace FAQs

  12.7. Content changes when upgrading Cortex XSIAM versions

  12.8. Content pack contributions

13. Cortex XSIAM XQL

  13.1. Get started with XQL

  13.1.1. XQL language features

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

##### Navigation

  You submit XQL queries to Cortex XSIAM using the Investigation & Response → Search → Query Builder user interface

  13.1.2. XQL Language Structure

  13.1.2.1. Adding comments in queries

  13.1.3. Supported operators

##### Note

* In some cases, using an IN or NOT IN operator combined with a dataset and filter stage can be a better alternative to using a join stage.

  13.1.4. Datasets and presets

##### Note

* To set up this Cloud Identity Engine (previously called Directory Sync Service (DSS)) dataset, you need to set up a Cloud Identity Engine. Otherwise, you will not have a pan_dss_raw dataset. For more information, see Set up Cloud Identity Engine.

* INFO issues are not included in this dataset. This dataset includes issues from the Security and Health domains. For more information, see Overview of the Issues page.

* The fields contained in this dataset are a subset of the fields in the xdr_data dataset.

* If the vendor and product are not specified in the Winlogbeat profile's configuration file, Cortex XSIAM creates a default dataset called microsoft_windows_raw.

* To ensure GlobalProtect access authentication logs are sent to Cortex XSIAM, verify that your PANW firewall's Log Settings for GlobalProtect has the Cortex Data Lake checkbox selected.

* You must have the Cortex XSIAM Threat Intel Management (TIM) Add-on to use this dataset.

* You can query in XQL for this data and build widgets based on the xdr_data dataset or using the preset device_control. To view in an XQL query these events, the Device Configuration of the endpoint profile must be set to Block. Otherwise, the USB events are not captured. The events are also captured when a group of device types are blocked on the...

##### Important

* This dataset will not be updated after June 2024. Use the health_alerts dataset instead.

  13.1.5. About examples

##### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

  13.1.6. JSON functions

##### Important

* JSON field names are case sensitive, so the key to field pairing must be identical in an XQL query for results to be found. For example, if a field value is "TIMESTAMP" and your query is defined to look for "timestamp", no results will be found.

  13.1.7. How to filter for empty values in the results table

  13.1.8. Understanding string manipulation in XQL

  13.2. Build XQL queries

  13.2.1. About the Query Builder

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

  13.2.2. How to build XQL queries

##### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

##### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  13.2.2.1. Get started with XQL queries

##### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

  13.2.2.2. Useful XQL user interface features

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

  13.2.2.3. XQL Query best practices

  13.2.2.4. Expected results when querying fields

  13.2.2.5. Create XQL query

##### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

  13.2.2.6. Review XQL query results

##### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* In order for Cortex XSIAM to provide a histogram for a field, the field must not contain an array or a JSON object.

  13.2.2.7. Translate to XQL

##### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

  13.2.2.8. Graph query results

##### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

  13.2.3. Query Builder templates

##### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

  13.2.3.1. Get started with Query Builder templates

  13.2.3.2. Considerations for using Query Builder templates

  13.2.3.3. Create a query from a template

##### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

  13.2.3.4. Run a free text query

##### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

  13.2.3.5. Query Builder template examples

##### Navigation

  Investigation & Response → Search → Query Builder

  13.2.4. Edit and run queries in Query Center

##### Navigation

  Investigation & Response → Search → Query Center

  13.2.4.1. Query Center reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  13.2.5. Manage scheduled queries

##### Navigation

  Investigation & Response → Search → Scheduled Queries

  13.2.5.1. Scheduled Queries reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  13.2.6. Manage your personal query library

##### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

  13.2.7. Legacy Query Builder

##### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

  13.2.7.1. Create authentication query

##### Navigation

  Investigation & Response → Search → Query Builder

  13.2.7.2. Create event log query

##### Navigation

  Investigation & Response → Search → Query Builder

  13.2.7.3. Create file query

##### Navigation

  Investigation & Response → Search → Query Builder

  13.2.7.4. Create image load query

##### Navigation

  Investigation & Response → Search → Query Builder

  13.2.7.5. Create network connections query

##### Navigation

  Investigation & Response → Search → Query Builder

  13.2.7.6. Create network query

##### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

  13.2.7.7. Create process query

##### Navigation

  Investigation & Response → Search → Query Builder

  13.2.7.8. Create registry query

##### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

  13.2.7.9. Query across all entities

##### Navigation

  Investigation & Response → Search → Query Builder

  13.3. Stages

  13.4. Functions

14. Graph Search

  14.1. What is Graph Search?

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Note

* Graph Search is a Beta feature and is still subject to changes. To enable the feature in your tenant, contact your Customer Support Team.

  14.2. Get started with Graph Search queries

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Navigation

  Understand your assets and findings data: Graph Search queries are based on the current data that has been collected for assets and findings from the data sources configured and then sent to the Unified Asset Inventory (UAI), which is displayed in the All Assets page (Inventory → Assets → All Assets

  14.3. How to build Graph Search queries?

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Navigation

  You submit Graph Search queries using the Investigation & Response → Search → Query Builder → Graph Search built-in query interface

  14.4. Understand Graph Search query results

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  14.5. Create Graph Search query

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Note

* For more information about the Query Library, see Manage Graph Search Query Library.

##### Tip

* After running the query, you can view the complete query by hovering over the last THAT... in the Graph Search query interface, and the query is displayed in a tooltip. If your query doesn't find any results or you want to change your query for any reason, you can always click anywhere in the Graph Search query interface, where your existing query is...

  14.6. Graph Search examples

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  14.7. Manage Graph Search Query Library

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Navigation

  From Graph Search in the Query Builder Select Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Center

  14.8. Edit and run queries in Query Center

##### Navigation

  Investigation & Response → Search → Query Center

  14.8.1. Query Center reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  14.9. Supported assets and findings

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  14.10. FAQ on Beta Graph Search feature

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

15. Cortex CLI

##### Note

* The CLI Read Only Role is not supported for CWP as the system does not support offline mode.

  15.1. Connect Cortex CLI

##### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

##### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Application Security, refer to Cortex CLI usage for Application Security

##### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

  15.2. Cortex CLI common command line reference guide

##### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

  15.3. Cortex CLI for Cloud Workload Protection

##### Prerequisite

* Ensure you have the required user permissions. Refer to Cortex CLI for more information Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more information Verify that Java version 11 and above is installed: Run java -version in your terminal. If not, refer to Java SE Development Kit 11.0.25 for information about installing Java

* Before you begin, ensure you have sudo privileges to execute the image scan.

##### Note

* The output contains the number of created issues for malware, secrets, and vulnerabilities, organized by severity, based on the current policy configuration.

  15.3.1. Cloud Workload Protection command line reference

  15.4. Cortex CLI for API Security

##### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more information Ensure your application exposes APIs and provides a corresponding OpenAPI Specification file Ensure that you have installed Java v 11 and above

  15.4.1. Cortex CLI API Security command line reference guide

  15.5. Cortex CLI for Application Security

##### Prerequisite

* For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

  15.5.1. Cortex CLI usage for Application Security

  15.5.2. Cortex CLI Application Security command line reference

##### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

##### Important

* The Cortex CLI Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id <YOUR_AUTH_ID>...

  15.5.3. CLI pipeline code snippets

  15.6. Migrate Cortex CLI

##### Prerequisite

* Before you begin, ensure you have the following: Ensure you have an active API key for your Cortex Cloud tenant with associated CLI role permissions. Refer to Manage API keys for more information Install the Cortex CLI. You can find the installation instructions here

16. Multi-Tenant

  16.1. What is Cortex XSIAM multi-tenant?

##### Note

* By default, multi-tenant licenses include one child tenant.

  16.1.1. MSSP multi-tenant

  16.1.2. Enterprise multi-tenant

  16.2. Multi-tenant central licensing management

##### Note

* In MSSP or enterprise multi-tenant, the license specifies the maximum number of child tenants that can be created. Once this limit is reached, no additional tenants can be created, even if there remains allocation for endpoints or GBs.

  16.3. Onboard Cortex multi-tenant

  16.3.1. Onboarding checklist for multi-tenant central licensing deployments

  16.3.1.1. Step 1. Activate Cortex XSIAM (main account)

##### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

  16.3.1.2. Step 2. Create a child tenant

##### Note

* The main account is labeled in Cortex Gateway, but child tenants are not labeled. Cortex enables parent-child pairing between tenants located in different geographical regions. To enable this capability, contact your support team. To create a child tenant, ensure that you have Account Admin permissions.

* After activating a child tenant, you can't change the child tenant's name.

* This is a public FQDN, so be careful with sensitive information such as the company name. After activating a child tenant, you can only change the child tenant subdomain once.

* Ensure that you meet the minimum requirements for child tenant allocation.

* If you reach your limit for child tenants, depending on your license, you may be able to create more tenants. You may be charged for additional tenants. Contact Customer Support if you are approaching your authorized limit.

  16.3.2. Onboarding checklist for multi-tenant customer-owned license deployments

  16.3.2.1. Step 1. Activate Cortex Cortex XSIAM (parent and child tenants)

##### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

  16.3.2.2. Step 2. Define access configurations and role permissions

  16.3.2.3. Step 3. Pair a parent tenant with child tenant

##### Note

* This field is not enabled by default. To enable this, contact your support team.

  16.4. Dynamic license allocation

##### Note

* Changing the tenant's allocations might result in a short downtime of your tenant.

* After activating a child tenant, you can't change the child tenant's name.

* This is a public FQDN, so be careful with sensitive information such as the company name. After activating a child tenant, you can only change the child tenant subdomain once.

* Ensure that you meet the minimum requirements for child tenant allocation.

* If you reach your limit for child tenants, depending on your license, you may be able to create more tenants. You may be charged for additional tenants. Contact Customer Support if you are approaching your authorized limit.

* In a multi-tenant central licensing management environment, you cannot unpair a child tenant from the main account. The only way to remove the connection to the main account is to delete the tenant.

  16.5. Child tenant management

  16.5.1. Manage a child tenant

##### Note

* Once a configuration is created Cortex XSIAM resets the child tenant data and synchronizes the security actions configured in the parent tenant.

  16.5.2. Track your tenant management

##### Note

* This field is not enabled by default. To enable, contact your account administrator.

##### Navigation

  To view child tenant details, in Cortex XSIAM, select Settings → Configurations → Tenant Management

  16.5.3. Investigate child tenant data

  16.5.4. Create and allocate configurations

##### Note

* You can configure Profiles only as Managed or Unmanaged. All profiles you create are automatically cloned to your child tenants.

  16.5.5. Create a security managed action

##### Note

* Profiles you create are automatically cloned to your child tenants.

  16.6. About managed threat hunting

  16.6.1. Set up Managed Threat Hunting

##### Navigation

  Settings → Configurations → Managed Services

  16.6.2. Investigate Managed Threat Hunting reports

##### Note

* The MTH page is available for users with the Managed Threat Hunting license and have the necessary permission to view and triage alerts and incidents in Cortex XSIAM.

17. Reference

  17.1. Cloud service provider permissions

  17.1.1. Amazon Web Services provider permissions

  17.1.2. Google Cloud Platform provider permissions

  17.1.3. Microsoft Azure provider permissions

  17.2. Microsoft Windows security auditing setup

  17.2.1. Enable security auditing event IDs

##### Note

* We recommend you configure security auditing using Group Policy Object (GPO). Using GPO simplifies audit management and ensures that auditing settings are uniformly applied across your network, reducing the risk of misconfigurations on individual machines.

  17.2.1.1. Enable security auditing event IDs with GPO

##### Note

* We recommend that you configure the Group Policy Object (GPO) to apply to all endpoints and not just Domain Controllers. This ensures comprehensive auditing across your entire network.

##### Navigation

  Server Manager → Tools → Group Policy Management

  Computer Configuration → Policies → Windows Settings → Security Settings → Advanced Audit Policy Configuration → Audit Policies

  17.2.1.2. Set up local machine security auditing without GPO

  17.2.1.3. Additional setup for Active Directory Certificate Services (ADCS) events

##### Note

* Enabling auditing for Active Directory Certificate Services (ADCS) restarts (events 4880 and 4881) can significantly slow down the service if you have a large database. To prevent delays: Clean up the database: Remove any unnecessary entries to reduce its size. Skip this audit: If restart speed is critical, consider not enabling auditing for ADCS...

  17.2.1.4. Enable auditing access to AD domain objects - 4662

##### Note

* The Descendant msDS-DelegatedManagedServiceAccount Objects configuration is relevant only for Windows Server 2025.

  17.2.2. Enable additional event logs using Event Viewer

##### Navigation

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → User Profile Service, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → CAPI2, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → DNS Client Events, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → DriverFrameworks-UserMode, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → PowerShell, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → Windows Defender, right click Operational and select Enable Log

  In Event viewer → Application and Services Logs → Microsoft → Windows → TerminalServices-ClientActiveXCore → Microsoft-Windows-TerminalServices-RDPClient, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → Windows Firewall With Advanced Security → Firewall, right click Operational and select Enable Log

  17.2.3. Enable LDAP server events logging (1644)

  17.2.3.1. Enable LDAP server events logging using RegEdit

  17.2.3.2. Enable LDAP server events logging using GPO

##### Navigation

  Computer Configuration → Preferences → Windows Settings → Registry

  17.2.3.3. Validate log collection for LDAP Server events

  17.3. XDM fields for mapping authentication events

##### Note

* For more information on the entire Cortex Data model (XDM) schema, see Cortex XSIAM Data Model Schema.

* Do not map a static string, list, or empty string. You must map this field from the raw log field that best represents the actual source IP used in the authentication attempt. In cases where multiple IP fields are available, such as client_ip, source_ip, and original_client_ip, choose the field that captures the IP address from which the user initially...

* Mapping should be done per event type. The same system could be an IDP in one event and an SP in another.

* For more information on the event outcome constants in the Cortex Data Model, see XDM_CONST.OUTCOME.

* Outcome is based on a conclusive event type reflecting the true end state of the authentication flow.Critical for effectiveness of detection rules. Incorrect derivation can lead to missed detections or false positives.

* These are the most common values, but other logon types also exist. For a complete list, see XDM_CONST.LOGON_TYPE.

* For more information, see XDM_CONST.USER_TYPE.

* For more information, see XDM_CONST.PRIVILEGE_LEVEL.

* For more information, see XDM_CONST.OS_FAMILY.

* While xdm.network.session_id aggregates multiple user actions within a broader session window. xdm.session.context.id is used to correlate events that belong to a single authentication request or transaction.


## Cortex XSIAM Enterprise Plus Documentation


---

## 1. Get started with Cortex XSIAM

### 1.1. What is Cortex XSIAM Enterprise Plus?

#### 1.1.1. Cortex XSIAM architecture

##### Note

* You can host your Cortex Native Data Lake instance in either the United States (US) Region or the European Union (EU) Region.

* You can host your Directory Sync Service instance in either the US Region or EU Region.

### 1.2. Use the interface

#### Note

* Each SAML login session is valid for 8 hours. Some menu items only appear if you have the relevant license.

* CMD fields have a 128-character limit. Shorten longer query strings to 127 characters and add an asterisk (*).

* Deleting a shared view removes it for all users.

### 1.3. What is Cortex Gateway?

### 1.4. Fair Usage policy for Cortex XSIAM

### 1.5. Cortex Cloud, Cortex XDR and Cortex XSIAM license plans

#### 1.5.1. Data retention

#### 1.5.2. Data storage lifecycle

##### Tip

* You can view details about your Cortex XSIAM licenses by selecting Settings → Cortex XSIAM License.

#### 1.5.3. License allocation

##### Note

* It can take up to an hour for Cortex XSIAM to display revived endpoints.

#### 1.5.4. License expiration

#### 1.5.5. Upgrade your tenant

### 1.6. Security Operations Center roles and responsibilities

### 1.7. In-product support case creation

#### Note

* When opening a support case through the Customer Support Portal, you need to manually select Cortex XSIAM as the product. While there may be discrepancies between the categories in this wizard and the Customer Support Portal process, that's because this wizard is designed specifically to focus on options relevant to Cortex XSIAM.

* Selecting an endpoint from the endpoint table and retrieving TSF requires full Retrieve Endpoint Data permissions under Endpoint Administration.

* Console recordings cannot exceed 10 minutes. The current recording time is displayed at the top of the window.

### 1.8. Supported web browsers

## 2. Onboard and configure Cortex XSIAM

### 2.1. Deployment steps

#### 2.1.1. Plan and prepare

#### 2.1.2. Cortex XSIAM onboarding checklist

##### Prerequisite

* Cloud Identity Engine must be set up.

##### Note

* Data collection for Windows endpoints is available with Traps 6.0 and later releases and on endpoints running Windows 7 SP1 and later releases. Data collection on macOS and Linux endpoints are available with Traps 6.1 and later releases.

#### 2.1.3. Activate Cortex XSIAM

##### Prerequisite

* The Cortex XSIAM activation email. A Customer Support Portal (CSP) account. You need to set up your CSP account. For more information, see How to Create Your CSP User Account. When you create a CSP account, you can set up two-factor authentication (2FA) to log into the CSP by using an Email, Okta Verify, or Google Authenticator (non-FedRAMP accounts)....

##### Note

* When you activate, a production tenant is first activated. After activation, you can set up a development tenant (subject to your license).

* Activation can take about an hour and does not require you to remain on the activation page. Cortex XSIAM sends a notification to your email when the process is complete.

* If you want to change your tenant's name, the subdomain, or activate a development tenant (subject to license), on the right-hand side, click the ellipsis. You can only change the subdomain once, and it cannot be undone. After deleting the subdomain, you can reuse it after 7 days.

##### 2.1.3.1. Bring your own keys

###### Prerequisite

* Access to BYOK (Bring Your Own Keys) functionality is restricted to tenants that were initially activated with BYOK.

* To disable your encryption keys and deactivate a tenant, you must have an Account Admin role.

###### Note

* The new keys you import will serve as primary encryption keys for newly generated data.

* At any stage, you can select Continue Later to pause the process. To resume the process, in the Cortex gateway, select Continue Setup next to the tenant, and follow the wizard instructions from the point you left off, as detailed below. If you don't use either of your wrapping keys within three days, they expire and you'll have to restart the process.

* BYOK requires a 32-byte, symmetric, unencoded key in binary format.

###### Caution

* Disabling all encryption keys and deactivating the tenant renders the tenant inaccessible and non-operational. Disabling the keys affects the communication with the agents, may prevent the agents from receiving updates to policies, configurations, and crucial information, and may result in loss of data. To secure your tenant data and to prevent...

##### 2.1.3.2. Cortex XSIAM supported regions

##### 2.1.3.3. Enable access to required PANW resources

###### Note

* <tenant-name> refers to the selected subdomain of your Cortex XSIAM tenant, and <region> is the region in which your tenant is deployed. For more information, see Cortex XSIAM supported regions.

#### 2.1.4. Set up users and roles

##### Note

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* The user who activated the Cortex product is assigned the Account Admin role. You cannot create additional Account Admin roles in the Cortex XSIAM tenant. If you do not want the user to have Account Admin permission, you must remove the Account Admin role in Cortex Gateway.

##### 2.1.4.1. User group management

###### Note

* You can create user groups in the tenant or Cortex Gateway. User groups created in Cortex Gateway cannot be mapped to SAML groups. Only user groups created in the tenant support SAML group mapping and scoring. We recommend creating user groups in the Cortex tenant because: User groups are available for all tenants, and you may want different user...

* If users have been created in the CSP, but you want them to access the tenant through SSO only, skip this field and add only SAML group mapping after SSO is set up, otherwise, users can access the tenant through both the CSP and SSO. If you have not yet created any users, skip this field and add them later. See Set up authentication .

* When using Azure AD for SSO, the SAML group mapping needs to be provided using the group object ID (GUID) and not the group name.

###### Important

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

##### 2.1.4.2. Assign user roles and groups

###### Note

* If an existing user in the Cortex Gateway no longer has a role or a user group assigned, the user is revoked. Any roles, user groups, or egress configurations created by that user are shown as created by Revoked user instead of the user's email address.

###### Important

* Setting Cortex Query Language (XQL) dataset access permissions for a user role can only be performed from Cortex XSIAM Access Management. For more information, see Manage user roles.

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit Users Permissions.

#### 2.1.5. Set up authentication

##### Tip

* You should have at least one user in the Customer Support Portal for backup, in case of any authentication issues with your IdP provider.

##### 2.1.5.1. Authenticate users through the Customer Support Portal

###### Note

* You must be assigned the Super User role in the Customer Support Portal to add users in the Customer Support Portal. The first Super User who logs into Cortex Gateway is automatically assigned the Account Admin role and has access to the tenant. The user who activates the Cortex XSIAM tenant will also be assigned the Account Admin role (if there is no...

* After users are added to the Customer Support Portal and they accept the invitation, you can manage them in Cortex Gateway or the Cortex XSIAM tenant.

##### 2.1.5.2. Authenticate users using SSO

###### Note

* To set up SSO authentication in the tenant, you must be assigned an Instance Administrator or Account Admin role. SAML 2.0 users must log in to Cortex XSIAM using the FQDN (full URL) of the tenant. To allow login directly from the IdP to , you must set the relay state on the IdP to the FQDN of the tenant. If you have multiple tenants, you must set up...

* The first SSO cannot be deleted, it can only be deactivated by toggling SSO Enabled to off. The Domain parameter is predefined for the first SSO. If you add additional SSO providers, you must provide the email Domain in the SSO Integration settings for all providers except the first. Cortex XSIAM uses this domain to determine to which identity provider...

* Cortex XSIAM requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex XSIAM. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a...

##### 2.1.5.3. Set up Okta as the Identity Provider Using SAML 2.0

###### Note

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Navigation

  Settings → Configurations → Access Management → Authentication Settings

  Settings → Configurations → Access Management → User Groups

##### 2.1.5.4. Set up Azure AD as the Identity Provider Using SAML 2.0

###### Note

* The default attributes shown on the main single sign-on page in Azure AD are not the values you need. You must click Edit next to Attributes and Claims to view and copy the actual values.

* The attribute claim name must exactly match the value sent by your IdP. In some cases, this may be the full attribute name/namespace, depending on the configuration of our IdP

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Important

* When copying the Single Sign-On URL value, remove idp/saml and leave the trailing /. For example, if the Single Sign-On URL is https://clientname.panproduct.region.paloaltonetworks.com/idp/saml, just copy https://clientname.panproduct.region.paloaltonetworks.com/.

###### Navigation

  Settings → Configurations → Access Management → User Groups

#### 2.1.6. Pre-installation steps for Cortex XDR agents

##### 2.1.6.1. Define endpoint groups

###### Note

* Disconnecting Cloud Identity Engine in your Cortex XSIAM deployment can affect existing endpoint groups and policy rules based on Active Directory properties.

##### 2.1.6.2. Manage endpoint profiles

##### 2.1.6.3. Endpoint data collection

###### Note

* For specific files only and only if the file was written.

###### Important

* Registry key is collected as a real key name, and not as a symbolic link. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, KEY_LOCAL_MACHINE\System\ControlSet001 will be collected. Instead of HKEY_CURRENT_USER, HKEY_USERS\<SID> will be collected, where SID is a SID of the current user.

##### 2.1.6.4. Configure global agent settings

###### Note

* Disabling this capability takes immediate effect on new hashes, fresh agent installations, and existing security policies. It could take up to a week to take effect on existing agents in your environment pending agent caching.

* If you have any Cortex XSIAM filters, starring policies, exclusion policies, scoring rules, log forwarding queries, or automation rules configured for XSOAR/3rd party SIEM, we advise you to update those to support the changes before activating the feature. For example, change the query to include the previous description that is still available in the...

#### 2.1.7. Install Cortex XDR agents

##### 2.1.7.1. Plan your agent deployment

##### 2.1.7.2. Guidelines for keeping Cortex XDR agents and content updated

###### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups. See how to define endpoint group.

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups.

###### Important

* When planning Cortex XDR agent upgrades and content updates, consult with the appropriate stakeholders and teams and follow the change management strategy in your organization.

###### Caution

* Before enabling Auto-Update for Cortex XDR agents, make sure to consult with all relevant stakeholders in your organization.

##### 2.1.7.3. Create an agent installation package

###### Note

* The profile will be applied if the security policy cannot be retrieved in real-time.

* The Cortex serverless library must be imported after other libraries to activate the hooks that enable auditing.

##### 2.1.7.4. Deploy agent installation packages

#### 2.1.8. Configure and deploy Cortex XSIAM

##### 2.1.8.1. Cortex XSIAM - Analytics

###### Prerequisite

* Before Cortex XSIAM - Analytics can start to analyze your endpoint data, perform the following steps: Configure Cortex XSIAM network parameters to monitor your internal networks. Enable the Analytics Engine. Make sure Cloud Identity Engine is set up. Enable Identity Analytics.

###### 2.1.8.1.1. Configure Cortex XSIAM network parameters

####### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

####### Navigation

  Inventory → Assets → Network Configuration → Internal Domain Suffixes

###### 2.1.8.1.2. Enable the Analytics Engine and Identity Analytics

####### Prerequisite

* Analytics Engine To create a baseline for enabling analytics, Cortex XSIAM requires a minimum of one of the following data sets: EDR or Network logs from at least 30 endpoints over a minimum of 2 weeks Cloud audit logs over a minimum of 5 days Identity Analytics Cortex XSIAM - Analytics must be activated. Cloud Identity Engine must be set up. For more...

####### Navigation

  Settings → Configurations → Cortex XSIAM - Analytics

##### 2.1.8.2. Cortex XSIAM engines

###### 2.1.8.2.1. Engine requirements

####### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

###### 2.1.8.2.2. Install an engine

####### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex XSIAM engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

####### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

####### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

##### 2.1.8.3. Set up Cloud Identity Engine

###### Note

* The Activate risk signal sharing to CIE checkbox is available only after the second step is completed.

###### Navigation

  Settings → Configuration → Integrations → Cloud Identity Engine

#### 2.1.9. Define data sources

##### Note

* Not all content packs are available to download on the Data Sources page. If you require content packs such as Phishing, and Malware, you need to download the pack from Marketplace and configure the integration. The Data Sources page is designed for third-party integrations to help you onboard.

* For some vendors, to receive data from an external source, you must first set up the Syslog Collector applet on a Broker VM within your network. For more information, see Activate Syslog Collector.

##### 2.1.9.1. Cortex XSIAM content

###### 2.1.9.1.1. Cortex Marketplace

###### 2.1.9.1.2. Content packs

####### Note

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

###### 2.1.9.1.3. Install content packs

####### Note

* Currently, not all content packs are supported in the Data Sources page. For example, content packs with several integrations are not yet supported.

* Content packs are also automatically installed when you adopt playbooks and configure tasks.

###### 2.1.9.1.4. Automation and feed integrations

####### Note

* Some integrations can be downloaded directly without having to initially download a content pack from Marketplace. For more information, see Define data sources. In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as...

* If the integration was installed from a content pack, you need to duplicate the integration before editing.

* If the integration was installed from a content pack, you need to duplicate the integration before downloading.

* Integration commands are only available when the integration instance is enabled. Some commands depend on a successful connection between Cortex XSIAM and third-party integrations.

####### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

####### 2.1.9.1.4.1. Manage API keys

######## Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

* You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

####### 2.1.9.1.4.2. Fetch issues from an integration instance

######## Note

* In some integrations, the Issue Fetch interval is called Feed Fetch Interval. If the integration instance does not have the Issue Fetch Interval field, you need to add this field by editing the integration settings. If the integration is from a content pack, you need to create a copy of the integration. Any future updates to this integration will not...

* Some content packs include preconfigured correlation rules, but you should review them to see if they suit your use case and duplicate them if required. Go to Threat Management → Detection Rules → Correlations, search for the relevant rule, right-click, and select Preview Rule. For example, the ServiceNow v2 Alerts (automatically generated)...

####### 2.1.9.1.4.3. Forward Requests to Long-Running Integrations

######## Note

* This integration replaces the External Dynamic list integration, which is deprecated. For more information about how to set up the integration, see Manage external dynamic lists.

* When running on the tenant, you can only use long-running integrations provided by Cortex XSIAM, you cannot create custom ones. Custom long-running integrations are supported only on engines at this time. Configuring custom certificates or private API Keys in the long-running integration instance is supported only on engines, not on the Cortex XSIAM...

* For the TAXII Server and TAXII2 Server integrations, the xdr string is automatically replaced by crtx. For the Microsoft Teams integration, you can use the microsoft-teams-create-messaging-endpoint command to get the correct messaging endpoint based on the server URL, the server version, and the instance configurations. For more information, see...

####### 2.1.9.1.4.4. Manage credentials

######## Navigation

  Settings → Configurations → Integrations → Credentials → New Credential

  Settings → Configurations → Data Collection → Automation & Feed Integrations and select the integration instance

####### 2.1.9.1.4.5. Integration use cases

####### 2.1.9.1.4.6. Troubleshoot Integrations

### 2.2. Post-deployment steps

#### 2.2.1. Perform health checks

##### 2.2.1.1. Monitor agent operational status in Cortex XSIAM

###### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex XSIAM management console for specific reasons for the state.

###### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

#### 2.2.2. Set up your environment

##### 2.2.2.1. Configure server settings

###### License Type

  Requires a Cortex XSIAM or Cortex XDR Pro license

###### Note

* Keyboard shortcuts, timezone, and timestamp format are not set universally and only apply to the user who sets them.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Requires the TIM add-on. By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled.

* Requires an MSSP License and RBAC permissions to Cases & Issues and Investigation & Response → Automation. This setting is available for the parent tenant only.

###### Navigation

  Settings → Configurations → General → Server Settings

##### 2.2.2.2. Configure security settings

###### Navigation

  Settings → Configurations → General → Security Settings

##### 2.2.2.3. Log forwarding

###### 2.2.2.3.1. Forward logs from Cortex XSIAM to external services

####### License Type

  Requires Cortex XDR per Endpoint

####### 2.2.2.3.1.1. Integrate a syslog receiver

######## Note

* Up to TLS 1.3 is supported. Make sure the self-signed CA includes your public key.

####### 2.2.2.3.1.2. Integrate Slack for outbound notifications

######## Note

* You are directed to the Slack browser to install Cortex XSIAM. You can only use this link to install Cortex XSIAM on Slack. Attempting to install from Slack Marketplace will redirect you to Cortex XSIAM documentation.

####### 2.2.2.3.1.3. Configure notification forwarding

######## Prerequisite

* Before you can select a syslog receiver or a Slack channel, you must integrate these external services with Cortex XSIAM. For more information, see: Integrate a syslog receiver Integrate Slack for outbound notifications

######## Note

* To configure notification forwarding for issues by domain, select Log Type = Issues and filter the Issues table by Issue Domain.

* This option will be deprecated in the next release. Configure issues with the filter Issue Domain = Health instead.

* When a notification is sent for each configured format.

####### 2.2.2.3.1.4. Monitor administrative activity

###### 2.2.2.3.2. Log notification formats

####### 2.2.2.3.2.1. Management audit log messages

####### 2.2.2.3.2.2. Issue notification format

####### 2.2.2.3.2.3. Agent Audit log notification format

####### 2.2.2.3.2.4. Management Audit log notification format

####### 2.2.2.3.2.5. Log format for IOC and BIOC issues

####### 2.2.2.3.2.6. Analytics log format

####### 2.2.2.3.2.7. Log formats

######## Note

* The FUTURE_USE tag applies to fields that Cortex XSIAM does not currently implement.

#### 2.2.3. Remote repository management

##### 2.2.3.1. Cortex XSIAM development tenant

###### Important

* Development tenants are not intended for performance checks; they cannot access production data, and they are connected to a limited number of endpoints. As a result, all development tenants have fewer resources than the production tenant, including data ingestion capacity and performance, and compute capabilities. In a development tenant, extreme...

##### 2.2.3.2. Set up a remote repository

###### Navigation

  If the content repository option is disabled for the production or development tenant (under Settings → Configurations → General → Remote Repository Settings, toggle the Content repository slider to off), the tenant becomes standalone and does not push or pull content

  If you are changing your remote repository settings, back up existing content to your local computer by navigating to Settings → Configurations → General → Server Settings → Custom Content and click Export all custom content

###### 2.2.3.2.1. Set up a built-in remote repository

####### Note

* Once enabled, development tenants have a red banner on the top left showing DEV.

* The first tenant that is enabled pushes its content to the remote repository first. For example, these instructions describe enabling the production tenant first, so the remote repository will initially contain production tenant content. You can enable a development tenant first if you want the remote repository to initially contain the content from...

####### Navigation

  Settings → Configurations → General → Remote Repository Settings and toggle the Content repository slider to enable the remote repository

###### 2.2.3.2.2. Set up a Private Remote Repository

####### Note

* Once enabled, the development push tenant has a red banner on the top left showing DEV.

* For repository vendors that use tokens, enter the token type in the username field and the token in the password field. Verify details with your vendor. If your private Git remote repository uses personal access tokens instead of usernames and passwords, enter the token type in the username field and the access token in the password field. For example,...

* You can't add an engine that has been added to a Load-Balancing Group.

* If your private Git remote repository uses personal access tokens instead of usernames and passwords, enter the access token in the password field and leave the username field blank. For repository vendors that use tokens, the token type is entered in the username field and the token is entered in the password field. Verify details with your vendor. If...

* The first tenant that is enabled pushes its content to the remote repository first. For example, these instructions describe enabling the production tenant first, so the remote repository will initially contain production tenant content. You can enable a development tenant first if you want the remote repository to initially contain the content from...

####### Tip

* Due to security concerns, there is a closed allow list of approved URLs for private repositories. If you want to use a URL that is excluded from the allow list, use an engine (engine groups are not supported).

##### 2.2.3.3. Push and pull content

###### Navigation

  Settings → Configurations → Remote Repository Content → User-Defined Content

##### 2.2.3.4. Remote repository troubleshooting

#### 2.2.4. Manage user roles and access management

##### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

##### Note

* For more information on assigning user roles when generating an API key, see Manage API keys.

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* For features where scoping is not applicable, Role-Based Access Control (RBAC) is used and can be configured when managing user roles. For more information, see Manage user roles.

##### 2.2.4.1. Manage user roles

###### Prerequisite

* Managing user roles in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Navigation

  Settings → Configurations → Access Management → Roles

##### 2.2.4.2. Manage user access

###### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.

###### Note

* You can only reduce the permissions of an Account Admin user via Cortex Gateway.

* User permissions for components and datasets are based on the access permissions set in the user role. For more information on editing these user role permissions, see Manage user roles.

###### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit User Permissions.

###### Navigation

  Settings → Configurations → Access Management → Users

###### 2.2.4.2.1. User access reference information

##### 2.2.4.3. Manage user scope

###### Prerequisite

* Configuring user scopes in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles. By default, Enable Scope Based Access Control is...

###### Note

* This configuration can impact the visibility of the related Security domain in the Cases and Issues scope area, but with not affect asset visibility.

* For Cases and Issues domains, a workaround is to create a Dataset View for each required combination of domains, and allow the relevant entity access only to this Dataset View, not to the underlying cases and issues datasets.

* Make sure to assign the required default granular scoping for users. This depends on the structure and divisions within your organization and the particular purpose of each organizational unit to which scoped users belong.

###### Important

* Some areas and features in Cortex XSIAM do not respect SBAC. In these cases, use RBAC permissions to restrict access.

* Before configuring, ensure that you review the Understand scoping section.

#### 2.2.5. Dashboards and reports

## 3. Endpoint security

### 3.1. Endpoint protection

#### 3.1.1. Malware protection

##### Note

* From Cortex XDR agent for Android version 9.0 and later, this module is deprecated.

#### 3.1.2. Exploit protection

#### 3.1.3. File analysis and protection flow

##### Note

* To enhance performance and efficiency, hash verdict requests from the Cortex XDR agent will be routed to the WildFire service with the lowest latency. File uploads for analysis will strictly adhere to the designated Cortex XSIAM and WildFire regions, ensuring data remains within the appropriate geographical boundaries.

#### 3.1.4. Endpoint protection capabilities

#### 3.1.5. Endpoint protection modules

#### 3.1.6. Processes protected by exploit security policy

#### 3.1.7. File Integrity Monitoring (FIM)

##### License Type

  FIM requires the Cortex Cloud Runtime Security add-on.

##### Note

* Google Kubernetes Engine (GKE) is currently not supported

* It is recommended to create a policy that targets only the necessary files and folders.

* Platform cannot be changed once a rule group has been created

* A rule group can contain up to 100 rules.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* It is possible to manage up to 15,000 events per day (24 hours) for each host/container.

##### Navigation

  Creating, modifying and viewing FIM rule groups and rules is be done in the Rule Groups page, located at the Inventory → Endpoints → File Integrity Monitoring menu

  In Inventory → Endpoints → Policy management → Extensions → Profiles, select +Add Profile and then select either Create New or Import from File

#### 3.1.8. WildFire analysis concepts

##### Note

* In cases when the Cortex XSIAM agent gets a failed status from the WF service due to a general error or unsupported file type, and the Local Analysis is set to disabled or not applicable, Cortex XSIAM will not generate an alert on the file.

#### 3.1.9. Guidelines for keeping Cortex XDR agents and content updated

##### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups. See how to define endpoint group.

* These profiles can be configured on one or more endpoints, static/dynamic groups, tags, IP ranges, endpoint names, or other parameters that allow the creation of logical endpoint groups.

##### Important

* When planning Cortex XDR agent upgrades and content updates, consult with the appropriate stakeholders and teams and follow the change management strategy in your organization.

##### Caution

* Before enabling Auto-Update for Cortex XDR agents, make sure to consult with all relevant stakeholders in your organization.

#### 3.1.10. About content updates

##### Note

* Cortex XSIAM delivers the content update to the agent in parts and not as a single file, allowing the agent to retrieve only the updates and additions it needs.

#### 3.1.11. Endpoint data collection

##### Note

* For specific files only and only if the file was written.

##### Important

* Registry key is collected as a real key name, and not as a symbolic link. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, KEY_LOCAL_MACHINE\System\ControlSet001 will be collected. Instead of HKEY_CURRENT_USER, HKEY_USERS\<SID> will be collected, where SID is a SID of the current user.

### 3.2. Install and manage endpoints

#### 3.2.1. Set up endpoint protection

##### 3.2.1.1. Set up endpoint profiles and exception rules

###### Note

* Profiles associated with one or more targets that are beyond the scope of your defined user permissions are locked, and cannot be edited.

###### 3.2.1.1.1. Set up malware prevention profiles

####### Note

* In this profile, the Report options configure the endpoints to report the corresponding suspicious files, actions, processes, or behaviors to Cortex XSIAM, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* As part of the anti-malware security flow, the Cortex XDR agent leverages the operating system's capability to identify revoked certificates for executables, and DLL files that attempt to run on the endpoint by accessing the Windows Certificate Revocation List (CRL). To allow the Cortex XDR agent access the CRL, you must enable internet access over...

* The Quarantine Malicious Executables feature is not available for malware identified on network drives.

* The Quarantine Malicious Script Files feature is not available for malware identified on network drives.

* If on-write actions were configured in earlier versions of Cortex XSIAM, the same configuration has been preserved and applied globally for all file types. On-write file protection may have an impact on the resources required by the Cortex XDR agent.

* On-demand file protection may have an impact on the resources required by the Cortex XDR agent.

* We recommend that you disable scheduled scanning. VDI machine scans are based on the golden image and additional files will be examined upon execution.

* When periodic scanning is enabled in your profile, the Cortex XDR agent initiates an initial scan when it is first installed on the endpoint, regardless of the periodic scanning scheduling time.

* When you are actively evaluating with BAS tools, it is recommended to enable the BAS mode setting only for the duration of your evaluation, and for a limited number of agents.

* BAS tools mode with content older than version 1850 cannot be configured, the agent will be treated as Enabled.

* The Quarantine Malicious Mach-O Files feature is not available for malware identified on network drives.

* This module is supported by Cortex XDR agent 8.1.0 and later releases.

* Enabling on-demand scanning will automatically scan these core system directories: /etc, /tmp, /home, /usr, /bin, /sbin, /lib, /var, /opt, /dev, /root, /boot.

* The Quarantine Malicious ELF Files feature is not available for malware identified on network drives.

* Blocking functionality is different for each security module. For SMS/MMS, Cortex XDR agent will move detected messages containing such URLs from unknown senders to the Junk folder.

* Ensure that the same numbers are not added multiple times with different leading zeros.

* To fully enable the Safari browser security module on the device side, each iOS device user must enable the Safari Safeguard module on the device, and grant it permission to work on all websites. If the iOS device user does not do this, the endpoint's operation status is reported as Partially Protected. The Safari browser security module will only...

* Cortex XDR agent version 8.4 or higher are required for this feature.

####### Warning

* For optimal user experience, we recommend that you set the action mode to either Allow or Run Local Analysis.

###### 3.2.1.1.2. Set up exploit prevention profiles

####### Note

* In this profile, the Report options configure the endpoints to report the corresponding exploit attempts to Cortex XSIAM, without blocking them. The Disabled options configure the endpoints to neither analyze nor report the corresponding malware or behavior.

* New profiles based on imported profiles are added, and do not replace existing ones.

* In exploit prevention profiles, if you change the action mode for processes, you must restart the protected processes for the following security modules to take effect on the process and its forked processes: Brute Force Protection Java Deserialization SO Hijacking

* This step provides a temporary workaround for the following publicly known information-security vulnerabilities and exposures: CVE-2021-24074, CVE-2021-24086 and CVE-2021-24094.

* If you have Windows endpoints in your network that are unpatched and exposed to a known vulnerability, we strongly recommend that you upgrade to the latest Windows Update that has a fix for that vulnerability.

####### Warning

* This workaround applies only to the specific Windows versions listed as exposed to these CVEs, and requires a Cortex XDR agent release 7.1 or later and content 167-51646 or later. This workaround is not recommended for non-persistent, stateless, or linked-clone environments. In some cases, enabling this workaround can affect the network functionality...

###### 3.2.1.1.3. Set up agent settings profiles

####### License Type

  Requires a Cortex XDR Pro per Endpoint license. When you enable this feature, a Cortex XDR Pro per Endpoint license is consumed.

  Requires Host Insights add-on.

  Requires Forensics Add-on.

####### Prerequisite

* User Space Agent mode requires Linux kernel 5.0.0 or higher.

####### Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

* You can enable the option to maintain a persistent notification regarding the disconnection of the endpoint from the network. The settings Persistent Isolation Notification and Blocked Connectivity Notification must be enabled. Until the threat on the endpoint has been removed, the endpoint remains disconnected from the network.

* In Traps 5.0.6 and later releases, when protection is enabled, access will be read-only. In earlier Traps releases, enabling protection disables all access to services, processes, files, and registry values.

* If you choose the Enable option, you must also enable XDR Agent Tampering Protection in the malware profile and set it to Block. Ensure that both profiles are assigned to the same endpoints.

* When you enable Cortex XDR agent registration with the Windows Security Center, Windows automatically shuts down Microsoft Defender on Windows-based workstation endpoints. If you still want to allow Microsoft Defender to run on a workstation endpoint where Cortex XSIAM is installed, you must use the Disable option. However, Palo Alto Networks does not...

* To enable access to these options, scroll down to Network Location Configuration, and set Action Mode to Enabled.

* When using Nmap, the Cortex XDR agent downloads an Nmap driver for the duration of the scan and removes the driver upon completion. If an Nmap scan is in process, Cortex XSIAM identifies the Nmap driver and places any additional scans in a queue.

* If you disable content updates for a newly installed agent, the agent retrieves the content for the first time from Cortex XSIAM, and then disables content updates on the endpoint. When you add a Cortex XDR agent to an endpoint group with a disabled content auto-upgrades policy, the policy is applied to the added agent as well.

* Automatic upgrades are not supported with non-persistent VDI and temporary sessions.

* Limitations in the content download process: When you install the Cortex XDR agent, the agent retrieves the latest content update version available. A freshly installed agent can take between five to ten minutes (depending on your network and content update settings) to retrieve the content for the first time. During this time, your endpoint is not...

* If the Cortex XDR agent is initially unable to communicate without the local store, enforcement is not enabled and the agent will show as partially protected.

* If you choose the Enabled option, you must also set Anti Tampering Protection in the malware security profile to Block, and ensure that both profiles are assigned to the same endpoints.

* Automatic upgrades are not supported for XDR agents running on K8s.

* User Space Agent mode requires Linux kernel 5.0.0 or higher. Endpoints running an older Linux kernel version with this fallback enabled, will not start using User Space Agent mode, and will operate asynchronously.

####### Warning

* If you disable or delay automatic-content updates provided by Palo Alto Networks, it may affect the security level in your organization.

###### 3.2.1.1.4. Set up restrictions prevention profiles

####### License Type

  A Threat Intel Management (TIM) license is required for this feature.

####### Note

* New profiles based on imported profiles are added, and do not replace existing ones.

* Configure custom BIOC prevention rules here: Detection & Threat Intel → Detection Rules → BIOC

* Configure this as follows: Prepare this restriction profile first, make a note of its name for later, and set it to Enabled. Prepare the prevention Indicator Rule (go to Detection & Threat Intel → Indicator Rules, ensuring to select Prevention when creating the rule), and while preparing it, map it to your restriction profile.

* Wildcards are supported.

###### 3.2.1.1.5. Set up exception profiles and rules

####### 3.2.1.1.5.1. Exception configuration

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Settings → Exception Configuration → Legacy Exceptions and click Start Simulation

####### 3.2.1.1.5.2. Issue exclusions

######## Note

* The agent continues to generate excluded issues on the endpoint, but they are not saved or displayed in Cortex XSIAM. Configuration of an issue exclusion does not remove or delete any of the logs that would have triggered the issue notification. You can also set up issue exceptions by creating global endpoint policy exceptions. For more information,...

######## Navigation

  The Settings → Exception Configuration → Issue Exclusions page displays the issue exclusion rules in Cortex XSIAM

######## 3.2.1.1.5.2.1. Add an issue exclusion rule

####### 3.2.1.1.5.3. Add an IOC or BIOC rule exception

######## Note

* Cortex XSIAM only supports exceptions with one attribute. See Add an alert exclusion rule to create advanced exceptions based on your filtered criteria.Add an alert exclusion rule

######## Navigation

  Settings → Exceptions Configuration → IOC/BIOC Suppression Rules

####### 3.2.1.1.5.4. Add a disable prevention rule for endpoints

######## Important

* All applicable prevention actions are skipped for the files and process that match the properties defined in the rule. Consider the consequences of disabling a prevention rule before you add the exception, and monitor it over time. You can only apply a Disable Prevention Rule to endpoints running Cortex XDR agents version 7.9 and later.

######## Navigation

  Settings → Exception Configuration → Disable Prevention Rules

####### 3.2.1.1.5.5. Add a disable injection and prevention rule

######## Important

* Exceptions are limited up to 48 hours by default and configurable up to one week. Consider the consequences of disabling a prevention rule before you add the exception and monitor it over time. You can only apply a Disable Prevention Rule to agents version 7.9 and later.

######## Navigation

  Settings → Exception Configuration → Disable Injection and Prevention

####### 3.2.1.1.5.6. Add a support exception rule for endpoints

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Your migrated rules are displayed on the Settings → Exception Configurations → Support Exception Rules page

  From Settings → Exception Configuration → Support Exception Rules, click + Import from file

####### 3.2.1.1.5.7. Add a legacy exception rule for endpoints

######## Note

* This exception prevents the agent from examining the specified file. Use with caution, as it may unintentionally allow unwanted or malicious behavior to go undetected.

######## Important

* If you don't migrate the legacy exceptions, you can continue to create exceptions through the profiles. Add a new exceptions security profile Add a global endpoint policy exception Set up exploit prevention profiles Set up malware prevention profilesSet up malware prevention profiles Set up restrictions prevention profiles

######## Navigation

  Your migrated rules are displayed on the Settings → Exception Configurations → Legacy Agent Exceptions page

######## 3.2.1.1.5.7.1. Add a new exceptions security profile

######## 3.2.1.1.5.7.2. Add a global endpoint policy exception

##### 3.2.1.2. Define endpoint groups

###### Note

* Disconnecting Cloud Identity Engine in your Cortex XSIAM deployment can affect existing endpoint groups and policy rules based on Active Directory properties.

##### 3.2.1.3. Configure global agent settings

###### Note

* Disabling this capability takes immediate effect on new hashes, fresh agent installations, and existing security policies. It could take up to a week to take effect on existing agents in your environment pending agent caching.

* If you have any Cortex XSIAM filters, starring policies, exclusion policies, scoring rules, log forwarding queries, or automation rules configured for XSOAR/3rd party SIEM, we advise you to update those to support the changes before activating the feature. For example, change the query to include the previous description that is still available in the...

##### 3.2.1.4. Apply profiles to endpoints

###### Note

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

##### 3.2.1.5. Create an agent installation package

###### Note

* The profile will be applied if the security policy cannot be retrieved in real-time.

* The Cortex serverless library must be imported after other libraries to activate the hooks that enable auditing.

###### 3.2.1.5.1. Manage an agent installation package

####### Note

* Since Cortex XSIAM relies on the installation package ID to approve agent registration during the installation, we recommend that you don't delete the installation package of active endpoints. If you install the Cortex XDR agent from a package after you delete it, Cortex XSIAM denies the registration request leaving the agent in an unprotected state....

##### 3.2.1.6. Harden endpoint security

###### Caution

* Hardened endpoint security capabilities are not supported for Android or iOS endpoints.

###### Navigation

  From Inventory → Endpoints → Policy Management → Extensions → Profiles, you can create profiles for the following hardened endpoint security capabilities

  To apply the profiles, from Inventory → Endpoints → Policy Management → Extensions → Policy Rules, you can view all the policy rules per operating system

###### 3.2.1.6.1. Device control

####### Note

* Operating systems report on devices in different ways. Sometimes, the same BLE device will report different services and interfaces, depending on the host's operating system. This may have an effect on the specific BLE services that are blocked for each operating system. Depending on your defined user scope permissions, creating device profiles,...

* For network printer print jobs, ensure that you also configure the Agent Settings profile, Network Location Configuration option. This setting must be set to Enabled, and configured. If you do not enable and configure this setting, all network printer operations will be treated as internal network print jobs. For network printer print jobs, ensure that...

* Currently, the default is set to Use Default (Allow), however, Palo Alto Networks may change the default definition at any time.

* You cannot edit or delete the default profiles pre-defined in Cortex XSIAM.

* You cannot edit or delete the predefined profiles in Cortex XSIAM.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* Permanent exceptions apply across platforms, allowing the devices on all operating systems.

* Disabling Device Control Violation notifications is only supported on endpoints running Cortex XDR agent version 8.6 and above.

####### Navigation

  Endpoints → Policy Management → Settings → Device Management

###### 3.2.1.6.2. Host firewall

####### 3.2.1.6.2.1. Host firewall for Windows

######## Note

* A rule is always part of a rules group. It cannot stand on its own. A rule can belong to one rules group only and cannot be reused in different groups.

* When selecting ICMP protocol, you must enter a the ICMP Type and Code. Without these values the ICMP protocol is ignored by the Windows and macOS Cortex XDR agents.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows. New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until target is specified.

* The data is aggregated and reported periodically every 60 minutes since the first time the host firewall policy was enforced on the endpoint, not every round hour. The table lists enforcement events only for rules set to Report Matching Traffic.

######## Navigation

  From Inventory → Endpoints → Policy Management → Extensions and select + Add Profile or Import from File

####### 3.2.1.6.2.2. Host firewall for macOS

######## Note

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

######## Navigation

  From Inventory → Endpoints → Policy Management → Extensions Profiles → Profiles, select + New Profile or Import from File

  Additionally, to monitor the communication on your macOS endpoint, you can use the following operating system utilities: From the endpoint System Preferences → Security and Privacy → Firewall → Firewall options, you can view the list of blocked and allowed applications in the firewall

###### 3.2.1.6.3. Disk encryption

####### Note

* You must select the same encryption method configured by the Microsoft Windows Group Policy in your organization for the target endpoints. Otherwise, if you select a different encryption method than the one already applied through the Windows Group Policy, Cortex XSIAM displays errors.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

####### Navigation

  You can monitor the Encryption Status of an endpoint in the Inventory → Endpoints → Disk Encryption Visibility table

###### 3.2.1.6.4. Host Inventory

####### Note

* Cortex XSIAM includes only the first 10,000 results per endpoint. Cortex XSIAM lists only users that belong to each group directly, and does not include users who belong to a group within the main group. If a local users group includes a domain user (whose credentials are stored on the Domain Controller server and not on the endpoint), Cortex XSIAM...

####### Navigation

  Inventory → Endpoints → Host Inventory

###### 3.2.1.6.5. Vulnerability Assessment

####### Prerequisite

* The following are prerequisites for Cortex XSIAM to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XSIAM lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex XSIAM...

* The following are prerequisites for Cortex XSIAM to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex XSIAM collects all the information about the operating system and the installed...

####### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex XSIAM Application Inventory.

####### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

####### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

##### 3.2.1.7. Set a Cortex XDR agent Critical Environment version

###### Note

* To ensure the stability of the line, CE versions maintenance release cadence is longer than in the standard line, we recommend that deployment is adjusted accordingly.

###### Navigation

  Settings → Configurations → General → Agent Configurations

  Inventory → Endpoints → All Endpoints

##### 3.2.1.8. Set an application proxy for Cortex XDR agents

###### Navigation

  Inventory → Endpoints → All Endpoints

#### 3.2.2. Manage endpoint protection

##### 3.2.2.1. Move agents between managing servers

###### Prerequisite

* Consider the following before making changes: Endpoint type is not Kubernetes Node. Installation type is not VDI. Ensure you have administrator privileges for Cortex XSIAM in the hub.

###### Note

* Cortex XSIAM does not support moving agents between FedRamp and commercial tenants.

###### Navigation

  Inventory → Endpoints → Agent Installations

  Inventory → Endpoints → All Endpoints

##### 3.2.2.2. Manage endpoint tags

###### Note

* The following explanations use Windows operating system installation parameters and Cytool argument examples.

* Tag names are case sensitive. In Windows and Mac, a tag name can contain spaces. Linux does not support tag names with spaces as command line arguments to the shell installer. Instead, tags can be set in the /etc/panw/cortex.conf configuration file, which supports all Linux installers.

* Tag names are case sensitive and can contain spaces.

* When SBAC is enabled, assigning tags may impact user permissions.

* If you remove the tag and there are assigned users or user groups with scope settings, this can impact user permissions in the system.

##### 3.2.2.3. Set an alias for an endpoint

###### Tip

* If you change your mind in the future, you can select Endpoint Control → Change Endpoint Alias again, and delete the required aliases.

##### 3.2.2.4. Manage endpoint prevention profiles

###### Note

* The filter is stored within the policy definition and assessed during runtime to extract the functions that match the filter criteria.

###### Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

##### 3.2.2.5. Upgrade Cortex XDR agents

###### Note

* The Cortex XDR agent keeps the name of the original installation package after every upgrade.

* Custom dashboards that include upgrade status widgets, and the All Endpoints page display upgrade status. During the upgrade process, the endpoint operating system might request a reboot. However, you do not have to perform the reboot for the Cortex XDR agent upgrade process to complete it successfully. After you upgrade on an endpoint with Cortex...

###### Warning

* You must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check whether the extensions were approved, you can either verify that the...

###### Important

* The following list includes important points to take into account when upgrading the Cortex XDR agent: Review the recommended guidelines for keeping Cortex XDR agents and content updated. Read more here. You cannot upgrade the Cortex XDR agent on VDI endpoints or a Golden Image. You must reinstall (uninstall and install again) the relevant agent...

##### 3.2.2.6. Restart agent

##### 3.2.2.7. Uninstall the Cortex XDR agent

###### Note

* Before upgrading a Cortex XDR agent running on macOS 10.15.4 or later, you must ensure that the System Extensions were approved on the endpoint. Otherwise, if the extensions were not approved, after the upgrade the extensions remain on the endpoint without any option to remove them which could cause the agent to display unexpected behavior. To check...

###### Tip

* If needed, use the filter to filter the list of endpoints by attribute or group name.

###### Navigation

  Inventory → Endpoints → All Endpoints

##### 3.2.2.8. Clear agent database

###### Note

* Clearing the agent database is supported on all platforms with Cortex XDR agent version 7.9 or later, and is available only when using the debugging mode.

* You can only right-click to cancel the clear agent database for actions with a pending status.

##### 3.2.2.9. Delete Cortex XDR agents

###### Note

* To reinstate an endpoint, you have to uninstall and reinstall the agent.

###### Navigation

  Inventory → Endpoints → All Endpoints

##### 3.2.2.10. Manage agent tokens

###### Note

* Agent tokens are only supported for Windows and Mac.

* You can select a one or multiple agents to add a temporary token.

##### 3.2.2.11. Retrieve support file password

###### Navigation

  Retrieve Support File Password from Inventory → Endpoints → All Endpoints

##### 3.2.2.12. Monitor agent operational status

###### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex XSIAM management console for specific reasons for the state.

###### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

###### Navigation

  You can monitor the Cortex XDR agent Operational Status in Inventory → Endpoints → All Endpoints

##### 3.2.2.13. Monitor agent activity

##### 3.2.2.14. Monitor agent upgrade status

###### Navigation

  From Inventory → Endpoints → All Endpoints, you can view the upgrade status of any Cortex XDR agent that you manage

## 4. Monitor dashboards and reports

### 4.1. About dashboards

#### Note

* You cannot edit the predefined dashboards but you can create a new dashboard that is based on a dashboard template. In addition, private dashboards can only be viewed, edited, and deleted by the dashboard creator.

* Dashboards that are based on custom infrastructure cannot be exported. If you import a dashboard template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

#### 4.1.1. Command Center dashboards

##### Note

* Access to the dashboards requires RBAC View permissions for Dashboards & Reports and Command Center Dashboards. The dashboards are available in dark mode only. They are not editable, and you can't create dashboard templates or reports from them. Some of the dashboard's animations are not fully supported by the Safari web browser. We recommend that...

##### 4.1.1.1. Cortex Command Center

###### Note

* The Cortex Command Center requires RBAC View permissions for Dashboards, Command Center Dashboards, and Asset Inventory.

##### 4.1.1.2. XSIAM Command Center

##### 4.1.1.3. Cloud Detection and Response (CDR) Command Center

##### 4.1.1.4. Cloud Security Command Center

###### 4.1.1.4.1. Cloud Security Command Center

####### Note

* The Cloud Security Command Center dashboard is currently only available by default to users with the Instance Administrator and Viewer roles. Custom roles, which include the Cloud Security Command Center View/Edit role permissions, also have access.

####### 4.1.1.4.1.1. Fine-Tune your Investigation

######## 4.1.1.4.1.1.1. Data Sources

######## 4.1.1.4.1.1.2. Assets with Vulnerabilities

######## 4.1.1.4.1.1.3. Security Outcomes

######### 4.1.1.4.1.1.3.1. Security Cases

######### 4.1.1.4.1.1.3.2. Posture Cases

####### 4.1.1.4.1.2. Value Metrics

######## Note

* The Time Saved estimate is based on the total amount of savings derived from the reduction of issues by grouping and addressing them as Posture Cases and Attack Paths. Analyst savings are estimates based on an average Security Analyst's wage coupled with the reduction in time spent addressing Issues on an individual basis.

##### 4.1.1.5. Cloud Security Operations

###### 4.1.1.5.1. Cloud Security Operations

####### Note

* Command Center data may not match the counts on the Issues page and you may observe inconsistencies. This is because dashboard data is a snapshot of issues identified, whereas the Issues page provides the most up to date view of risks across your cloud assets. In addition, the Issues pages does not support all the currently available filters on the...

####### 4.1.1.5.1.1. Dashboard Widgets

######## Note

* The Last updated time indicated on each widget may differ as widget data is gathered at varying intervals.

######## 4.1.1.5.1.1.1. Generate Reports

######## 4.1.1.5.1.1.2. Filter Options

#### 4.1.2. Predefined dashboards

##### License Type

  Requires the ITDR add-on.

#### 4.1.3. Reports

##### 4.1.3.1. Report templates

### 4.2. Build custom dashboards and reports

#### 4.2.1. Build a custom dashboard

##### Note

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

#### 4.2.2. Manage your Widget Library

##### Note

* Any dashboards or reports that include the widget are affected by the changes.

### 4.3. Fine-tune dashboards and reports

#### 4.3.1. Create a custom widget using a script

##### Note

* If you have added arguments to the script, these appear when creating a widget.

* Available options are Pie, Column, Line, and Single Value. To display the result of the script as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### 4.3.1.1. Script-based widget examples

###### Note

* Add the widget tag in the script settings to make the script available for use in script-based widgets. For more information, see Create a script.Create a script

* If your script returns a time duration, configure the widget with the graph type Single Value and enable Show as Time..

#### 4.3.2. Create a text widget

##### Note

* From the dashboard manager, you can right-click an existing dashboard and choose Save as report template. You can also add text-based widgets directly to new or existing report templates, as described below.

#### 4.3.3. Create custom XQL widgets

##### Note

* Cortex Query Language (XQL) queries generated from the Widget Library do not appear in the Query Center. The results are used only for creating the custom widget.

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### Tip

* You can create a generic dashboard for multiple views of the same dataset by defining the dataset in the XQL widget as dataset = <dataset_name>*. The placement of the asterisk (*) in the dataset name ensures that any view containing this prefix text is displayed in the results. The dataset in a query is defined as: If there are multiple datasets that...

##### Navigation

  All of your predefined and custom XQL widgets are available in the Widget Library under Dashboards & Reports → Customize → Widget Library

##### 4.3.3.1. Configure filters and inputs for custom XQL widgets

###### Prerequisite

* Fixed filters are based on parameters that are defined in custom XQL widgets. Before you can configure fixed filters, take the following steps: Create custom XQL widgets with parameters. For more information, see Create custom XQL widgets. Add the widgets to a Custom dashboard. For more information, see Build a custom dashboard.

###### Note

* If you specify more than one field, only the first field value is used.

###### Tip

* After the initial setup, when you access your dashboard the filters and inputs might need further refinement. You can make changes to the configured parameters in the XQL widgets, and update the Filters & Inputs on your dashboard until you are satisfied with the results.

#### 4.3.4. Configure dashboard drilldowns

##### Prerequisite

* To configure drilldowns your dashboard must contain custom XQL widgets. In addition, if you want to configure in-dashboard drilldowns your custom XQL widget must contain one or more parameters. For more information about configuring parameters in custom XQL widgets, see Create custom XQL widgets.

##### Note

* If the selected parameter is configured in other XQL widgets on the dashboard, these widgets are also affected by the drilldown.

##### 4.3.4.1. Variables in drilldowns

### 4.4. Run or schedule reports

#### Note

* Report templates that are based on custom infrastructure cannot be exported. If you import a report template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

* The report name and description will be displayed in the report header and are not editable during customization.

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

#### Navigation

  Dashboards & Reports → Customize → Report Templates

  Dashboards & Reports → Customize → Dashboards Manager

  Under Settings → Configurations → General → Notifications, click + Add Forwarding Configuration

## 5. Investigation and response

### 5.1. Cases and issues

#### 5.1.1. What are cases?

##### 5.1.1.1. Issues

##### 5.1.1.2. Findings and events

#### 5.1.2. Case and issue domains

##### Navigation

  You can see all domains under Configurations → Object Setup → Cases → Domains

#### 5.1.3. Manage your cases

##### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

##### 5.1.3.1. Assign a case

##### 5.1.3.2. Case thresholds

##### 5.1.3.3. Link or unlink issues from a case

##### 5.1.3.4. Resolve a case

###### 5.1.3.4.1. Resolution reasons for cases and issues

####### Note

* The displayed resolution reasons are domain specific. You can see the resolution reasons that are defined for a domain under Configurations → Object Setup → Cases → Domains.

* Cases and issues resolved as True Positive and False Positive help Cortex XSIAM to identify real threats in your environment by comparing future cases and associated issues to the resolved cases. Therefore, the handling and scoring of future cases is affected by these resolutions.

###### 5.1.3.4.2. Create custom case statuses and resolution reasons

####### Note

* Before you create a custom status, please review the built-in options. For more information, see Resolution reasons for cases and issues. We recommend using the built-in statuses and resolution reasons where possible. Custom statuses and resolution reasons might not be supported by all content, and status syncing can take time. In addition, custom...

* After creation, custom statuses and resolution reasons cannot be deleted or modified.

####### Navigation

  Configurations → Object Setup → Cases → Properties

##### 5.1.3.5. Create a case

###### Note

* To create a case manually, you must have View/Edit permission for Cases and Issues selected under Settings → Configurations → Access Management → Roles → Components → Cases & Issues.

* You can assign a case to a single domain only and you cannot change the assigned domain. For more information, see Case and issue domains.

* This option is only relevant for certain domains.

* You can't attach files to manually created cases.

###### Tip

* The issues that you link to a case can be linked to multiple cases, and the issue domains do not need to match the case domain.

##### 5.1.3.6. Issue syncing

###### Prerequisite

* You must set up an integration before you can sync issues. For more information, see Set up an integration for mirroring issues.

###### Note

* Multiple tickets can be linked to an issue with outbound syncing. Issues with inbound syncing can be linked to a single ticket only.

* Using issue fields as variables is not currently supported.

* You can only define a single inbound profile. If you change the inbound sync profile the current profile is overwritten. You can define multiple outbound profiles; one issue can update multiple tickets.

* The inbound syncing flow runs every two minutes, and the outbound syncing flow runs every five minutes. In a bi-directional set-up, if the same field is updated in both tickets, the most recently updated value is used. In the external ticket, the logged history shows updates to the ticket. The user name that is logged with the history reflects the user...

* After an issue is resolved, ticket syncing remains active for up-to seven days. Therefore, you still update, change, or reopen the issue or external ticket and the tickets will continue to sync.

* If you change the selected inbound sync profile, the original sync profile is immediately overwritten.

###### Warning

* If you leave this field blank, all configured instances will be used.

###### Tip

* You can find a sync profile ID under Settings → Configurations → Object Setup → Issues → Sync Profiles. By default the ID field is not displayed in the table. Click the three dot menu and add it to the table layout.

###### Navigation

  Settings → Configurations → Data Sources and click Add Data Source

  Settings → Configurations → Data Collection → Automation & Feed Integrations

###### 5.1.3.6.1. Create a sync profile

####### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

#### 5.1.4. Customize your cases

##### 5.1.4.1. External integrations

##### 5.1.4.2. Prioritize cases with starring and scoring

###### 5.1.4.2.1. Case starring

####### Navigation

  Cases & Issues → Case Configuration → Starred Issues

###### 5.1.4.2.2. Case scoring

####### 5.1.4.2.2.1. Set up case scoring

######## Note

* On the first activation, it can take up to 48 hours for SmartScore to calculate and display the score. Enabling SmartScore subsequently impacts the User Score.

* For scoped users, a small lock icon indicates that you don't have permissions to edit a rule.

##### 5.1.4.3. Customize issue fields and layouts

###### 5.1.4.3.1. Issue fields

####### Warning

* Deleting an issue field or uninstalling a content pack containing an issue field may affect detection and other capabilities based on the deleted field. For example, correlation, layouts, case scoring, starring rules, and playbook triggers.

####### 5.1.4.3.1.1. Issue field types

######## Note

* You cannot set filters, starring rules, playbook triggers, layout rules, or issue exclusions based on the values in custom timestamp fields.

* When grid field is shown in the Issues table, if there are values in the field, they do not display in the table. Instead, the column shows Data Available.

* When an HTML field is shown in the Issues table, if there is a value in the field, it does not display in the Issues table. Instead, the column shows Data Available. The following HTML tags are not permitted: blockquote, del, dd, div, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, iframe, ins, li, math, noscript, ol, pre, p, script, style, table,...

* When a Markdown field is shown in the Issues table, if there is a value in the field, it does not display in the table. Instead, the column shows Data Available.

####### 5.1.4.3.1.2. Create custom issue fields

######## Navigation

  Settings → Configurations → Object Setup → Issues → Fields → New Field

######## 5.1.4.3.1.2.1. Create a grid field

######## 5.1.4.3.1.2.2. Issue field triggered scripts

######## 5.1.4.3.1.2.3. Issue timer fields

######### 5.1.4.3.1.2.3.1. Configure issue timer fields

######### 5.1.4.3.1.2.3.2. Configure a playbook to run timers

######### 5.1.4.3.1.2.3.3. Automate changes to issue fields using timer scripts

######### 5.1.4.3.1.2.3.4. Use issue timer field commands manually in the CLI

###### 5.1.4.3.2. Issue layouts

###### 5.1.4.3.3. Create custom issue layouts

####### Note

* The script that runs when an action button is clicked accepts only mandatory arguments through the pop up window and does not provide an option for any non-mandatory arguments to be filled in when the button is clicked. We recommend using a wrapper script to collect and validate arguments in scenarios where there can be a combination of mandatory and...

####### Tip

* Limit the number of issue fields to 50 in each section. You can create additional sections as needed.

####### 5.1.4.3.3.1. Add a custom widget to an issue layout

######## Navigation

  Investigation & Response → Automation → Scripts and upload the following script: Expand script commonfields: id: ee3b9604-324b-4ab5-8164-15ddf6e428ab version: 49 name: IndicatorWidgetBar script: |- # Constants HIGH = 3 SUSPICIOUS = 2 LOW = 1 NONE = 0 indicators = [] scores = {HIGH: 0, SUSPICIOUS: 0, LOW: 0, NONE: 0} incident_id = demisto

  Investigation & Response → Automation → Scripts and upload the following script

  Settings → Configurations → Object Setup → Issues → Layouts

###### 5.1.4.3.4. Create rules for issue layouts

####### Navigation

  Settings → Configurations → Object Setup → Issues → Layout Rules → New Rule

##### 5.1.4.4. Customize case fields and layouts

###### 5.1.4.4.1. Create case timers and SLAs

####### Prerequisite

* Before you can create a case SLA, you must first create a timer field. A timer field can be associated with a single case SLA.

####### Note

* If you edit this filter after creation, the timer and associated SLA will be removed from any case that no longer qualifies, even if the timer is already running.

####### Navigation

  Settings → Configurations → Object Setup → Cases and open the Fields tab

####### 5.1.4.4.1.1. Update case timer and SLA fields

###### 5.1.4.4.2. Case fields

####### Warning

* Deleting a case field or uninstalling a content pack containing a case field may affect capabilities based on the deleted field, layouts and case scoring.

####### 5.1.4.4.2.1. Case field types

######## Note

* You cannot set filters, starring rules, playbook triggers, layout rules, or issue exclusions based on the values in custom timestamp fields.

* When grid field is shown in the Cases table, if there are values in the field, they do not display in the Cases table. Instead, the column shows Data Available.

* When an HTML field is shown in the Issues table, if there is a value in the field, it does not display in the Cases table. Instead, the column shows Data Available.

* When a Markdown field is shown in the Cases table, if there is a value in the field, it does not display in the Cases table. Instead, the column shows Data Available.

* If you make changes to case fields you can update the context data by running a playbook, script, or command. For more information, see Update case fields. To update dynamic custom case fields, such as SLA and Timer fields, see Update case timer and SLA fields.

####### 5.1.4.4.2.2. Create custom case fields

######## Navigation

  Settings → Configurations → Object Setup → Cases → Fields → New Field

######## 5.1.4.4.2.2.1. Create a grid field for a case

####### 5.1.4.4.2.3. Update case fields

######## Note

* Ensure that you have the required RBAC permission to write scripts.

###### 5.1.4.4.3. Case layouts

####### 5.1.4.4.3.1. Create custom case layouts

######## Note

* The script that runs when an action button is clicked accepts only mandatory arguments through the pop up window and does not provide an option for any non-mandatory arguments to be filled in when the button is clicked. We recommend using a wrapper script to collect and validate arguments in scenarios where there can be a combination of mandatory and...

######## Tip

* Limit the number of case fields to 50 in each section. You can create additional sections as needed.

####### 5.1.4.4.3.2. Create rules for case layouts

######## Note

* Layout rules support SBAC (scoped based access control). The following parameters are considered for editing access. If Scope-Based Access Control (SBAC) is enabled and Endpoint Scoping Mode is set to restrictive mode, you can edit a rule if you are scoped to all tags in the rule. If Scope-Based Access Control (SBAC) is enabled and Endpoint Scoping...

######## Navigation

  Settings → Configurations → Object Setup → Cases → Layout Rules → New Rule

##### 5.1.4.5. Create a case domain

###### Note

* Adding custom domains requires a View/Edit RBAC permission for Case Properties (under Object Setup). Once created, a custom case domain cannot be deleted or renamed.

###### Warning

* Before you add a custom domain, please review the built-in options. For more information, see Case and issue domains. We recommend using the built-in domains where possible. Custom domains might not be supported by all content. In addition, custom domains affect Cortex XSIAM's ability to learn, correctly identify, and score future cases. Smart...

###### Navigation

  Settings → Configurations → Object Setup → Cases → Domains

  Settings → Configurations → Access Management → User Groups

  Settings → Configurations → Access Management → Users

  To enable access to the domain for an API key, got to Settings → Configurations → Integrations → API Keys

##### 5.1.4.6. Create a sync profile

###### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

##### 5.1.4.7. Run indicator extraction in the CLI

###### Note

* Triggering enrichment on a substantial amount of indicators can take time (since it's activating all enrichment integrations per indicator) and can result in performance degradation.

#### 5.1.5. Cortex Copilot

##### Navigation

  To increase usability, you can create a personalized keyboard shortcut: Settings → Configurations → Server Settings → Keyboard Shortcuts and choose the shortcut you want to use

##### 5.1.5.1. Cortex Copilot layout

##### 5.1.5.2. Cortex Copilot capabilities

###### Note

* When you choose an option from the Respond column, Cortex Copilot will always prompt you to approve the action before executing.

* Disabling Cortex Copilot requires users to refresh their page.

### 5.2. Investigate cases

#### 5.2.1. Overview of the Cases page

##### Note

* For MSSP and multi-tenant administrators, if the Unified Case View is enabled, this view consolidates all cases across your distributed environment, allowing you to view and perform actions on child tenants. If the Unified Case view is disabled, this view displays a single tenant at a time with a drop-down list for moving between tenants in read-only...

* When an issue is resolved, it remains linked to a case and appears in this section. Once all of the issues in a case are resolved, the case is automatically closed.

##### Tip

* Set a default tab in the details pane by selecting the pin icon next to a tab. Click on the Notepad, Messenger, and Case Context Data icons to add notes on the case, and see existing notes from other analysts.

##### 5.2.1.1. Saved table views

##### 5.2.1.2. Unified case view

###### License Type

  Requires an MSSP license.

###### Note

* Requires the following RBAC permissions:    Cases & Issues   Investigation & Response → Automation Requires the following RBAC permissions: Cases & Issues Investigation & Response → Automation This view is available for the parent tenant only. To take actions on a child tenant from a parent tenant, you must have the appropriate permissions for both...

* Custom case layouts of child tenants are not visible in the parent tenant.

#### 5.2.2. Review and investigate a case

##### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

* In some cases, the number of issues associated with the techniques will not be aligned with the number of the parent tactic because of missing tags or in case an issue belongs to several techniques.

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

* Cloud related issues are displayed in the User Name grouping. Prisma Cloud Compute issues are displayed in the Host Name grouping.

### 5.3. Investigate issues

#### 5.3.1. Overview of the Issues page

##### Note

* Every 12 hours, the system enforces a cleanup policy to remove the oldest issues once the maximum limit is exceeded. The default issue retention period in Cortex XSIAM is 186 days.

#### 5.3.2. Issue card

##### Note

* This section is context specific and shows data according to the issue context.

##### 5.3.2.1. Use the War Room in an investigation

###### Note

* The case War Room is usually used for communication capabilities, but unlike the issue War Room, it does not include playbook specific entries. The case War Room enables you to investigate an entire case, not just an issue.

* Cortex XSIAM does not index notes and chats.

###### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

* You can use the up/down arrow buttons in the CLI to do a reverse history search for previous commands with the same prefix.

###### Navigation

  Investigation & Response → Automation → Playground

##### 5.3.2.2. Use the Work Plan in an investigation

#### 5.3.3. Triage and investigate issues

##### 5.3.3.1. Copy issues

##### 5.3.3.2. Analyze an issue

##### 5.3.3.3. Run an automation on an issue

###### Note

* In addition to automation, some playbooks contain manual tasks that prompt the analyst for input. This enables you to enhance an automation workflow with analyst input.

* You can also manually select a playbook to run from the Issue Work Plan tab.

##### 5.3.3.4. Create profile exceptions

###### Navigation

  Inventory+Endpoints → Policy Management → Profiles

##### 5.3.3.5. Investigate contributing events

##### 5.3.3.6. Retrieve additional issue details

###### Tip

* If you require assistance from Palo Alto Networks support to investigate the issue, make sure to provide the downloaded ZIP file.

##### 5.3.3.7. Add a file path to a malware profile allow list

###### Navigation

  Inventory+Endpoints → Policy Management → Prevention → Profiles and locate the malware profile you selected

##### 5.3.3.8. Create a featured field

###### Note

* Featured Active Directory values are displayed in the User and Host fields accordingly.

###### Navigation

  Cases & Issues → Case Configuration → Featured Fields and select a type of featured field

##### 5.3.3.9. View generating BIOC or IOC rule

##### 5.3.3.10. Export issue details to a file

##### 5.3.3.11. Exclude an issue

##### 5.3.3.12. Query case and issue data

###### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

##### 5.3.3.13. Update issue fields

###### Note

* You must create a custom status before you can select it.

###### Tip

* You can create custom issue statuses and resolution reasons, and use the setIssueStatus command to set these custom statuses for issues. For example, when a user starts investigating an issue, the issue status is automatically changed from New to Under Investigation. In some cases, it is useful to create an interim status, such as Triage. After you...

##### 5.3.3.14. Close an issue

###### Note

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

#### 5.3.4. What is Causality?

##### Note

* There are no CGOs in the Cloud Causality View, when investigating cloud Cortex XSIAM alerts and Cloud Audit Logs, or SaaS Causality View, when investigating SaaS-related alerts for 501 audit events, such as Office 365 audit logs and normalized logs.

##### 5.3.4.1. Causality view

###### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

##### 5.3.4.2. Network causality view

###### Note

* The network causality view displays only the information it collects from the detectors. It is possible that the CI may not show some of the firewall or agent processes.

###### Tip

* To view statistics for files on VirusTotal, you can pivot from the Initiator MD5 or SHA256 value of the file on the Files tab.

##### 5.3.4.3. Cloud causality view

##### 5.3.4.4. SaaS causality view

##### 5.3.4.5. Timeline

###### Note

* The Timeline view is not available when investigating cloud Cortex XSIAM issues and cloud audit logs or SaaS-related issues for 501 audit events, such as Office 365 audit logs and normalized logs. Only the applicable cloud causality view and SaaS causality view is available for this data.

##### 5.3.4.6. Causality icons key

#### 5.3.5. Cortex Response and Remediation content pack

##### 5.3.5.1. Investigate an issue using Cortex Response and Remediation playbooks

##### 5.3.5.2. Example use cases

### 5.4. Investigate findings

#### 5.4.1. Findings card

##### Note

* The information in this card is context specific, therefore some sections are not available for all findings.

### 5.5. Investigate artifacts and assets

#### 5.5.1. Investigate an IP address

##### Note

* Requires a license key. Select Settings → Configurations → Integrations  → Threat Intelligence.

#### 5.5.2. Investigate an asset

##### Note

* The Asset view is available for hosts with a Cortex XDR agent installed.

#### 5.5.3. Investigate a host

##### License Type

  The Host Risk View requires the Identity Threat Module add-on.

##### Tip

* You can also see a list of all hosts under Inventory → Assets → Asset Scores.

#### 5.5.4. Investigate a file and process hash

##### Note

* Requires a license key. Go to Settings → Configurations → Integrations  → Threat Intelligence.

#### 5.5.5. Investigate a user

##### License Type

  If the Identity Threat module is enabled you can open the User Risk View. This view displays insights and profiling information to help you investigate issues and cases. Viewing anomalies in the context of baseline behavior facilitates risk assessment and shortens the time you require for making verdicts. If the Identity Threat module is not enabled...

##### Note

* Cortex XSIAM normalizes and displays case and issue times in your time zone. If you're in a half-hour time zone, the activity in the Normal Activity and the Actual Activity charts is displayed in the whole-hour time slot preceding it. For example, if you're in a UTC +4.5 time zone, the time displayed for the activity will be UTC +4.5, however, the...

##### Tip

* You can also see a list of all users under Assets → Asset Scores.

### 5.6. Investigate endpoints

#### 5.6.1. Overview of the Action Center

##### Note

* Blocking files on endpoints is enforced by the endpoint malware profile. To block a hash value, ensure the hash value is configured in the Malware security profile. Select Override Report mode to allow the agent to block hashes, even if the Malware Profile is set to Report.

##### Navigation

  Investigation & Response → Response → Action Center

##### 5.6.1.1. Initiate and monitor endpoint actions

###### Navigation

  Investigation & Response → Response → Action Center → New Action

  Investigation & Response → Response → Action Center

##### 5.6.1.2. Action Center reference information

#### 5.6.2. Manage endpoints

##### Note

* For the Include endpoints from auto upgrade action, you cannot enable auto upgrade for Mobile, VDI, and TS installations.

* If an endpoint is excluded, the auto upgrade profile configuration is not available. If you exclude the endpoint from auto upgrade while the auto upgrade action is In progress, the ongoing upgrade will still take place.

* Content Status is calculated every 30 minutes. Therefore, there might be a delay of up to 30 minutes in displaying the data.

* Only supported for Windows and macOS.

* Changes to the agent status can take up to ten minutes to display on Cortex XSIAM .

##### Navigation

  Inventory → Endpoints → All Endpoints

  Settings → Configurations → General → Agent Configurations → Endpoint Administration Cleanup

#### 5.6.3. Retrieve files from an endpoint

##### Note

* You cannot define a path using environment variables on Mac and Linux endpoints.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Disabling File Retrieval does not take effect on file retrieval actions that are in progress.

#### 5.6.4. Retrieve support logs from an endpoint

##### Navigation

  Investigation & Response → Response → Action Center → + New Action

#### 5.6.5. Retrieve support file password

##### Navigation

  Retrieve Support File Password from Inventory → Endpoints → All Endpoints

#### 5.6.6. Scan an endpoint for malware

##### Navigation

  Investigation & Response → Response → Action Center → New Action

### 5.7. Investigate files

#### 5.7.1. Manage file execution

##### Navigation

  Investigation & Response → Response → Action Center → New Action

#### 5.7.2. Manage quarantined files

##### Note

* This will restore all files with the same hash on all of your endpoints.

#### 5.7.3. Review WildFire analysis details

##### Note

* Cortex XSIAM displays the preview of WildFire reports that were generated within the last couple of years. To view a report that was generated more than two years ago, you can download the report.

#### 5.7.4. Import file hash exceptions

##### Navigation

  Investigation & Response → Response → Action Center → New Action

### 5.8. Automations

#### 5.8.1. Automation in Cortex XSIAM

##### Note

* You can build end-to-end automation workflows from within the playbook editor, including creating automation rules, configuring integration instances, and creating and editing tasks. For more information, see Playbooks.

#### 5.8.2. Quick Actions

##### Note

* When investigating an issue, in the Issues table, you can right-click to Run an Automation on one or more issues. For more information, see Run an automation on an issue.Run an automation on an issue

#### 5.8.3. Manage automation exclusion policies

##### Note

* For the IAM User Hard Remediation and User Soft Remediation policies, we recommend including username, email, and ID for each user you want to exclude. Example: username1, user@example.com, userID112.

* You can also right click on a policy from the main Automation Exclusion Center page to disable or enable the policy. If you click on a list name in the Exclude column, that list opens in the Lists page.

#### 5.8.4. Playbooks

##### 5.8.4.1. Playbooks overview

##### 5.8.4.2. Playbook development checklist

##### 5.8.4.3. Plan your playbook

##### 5.8.4.4. Manage playbooks

###### Note

* The library by default shows only playbooks that are not adopted. Click the Show Adopted checkbox to show the adopted playbooks, indicated by an Adopted mark. The library shows the most updated playbook version. Adopting an older version than shown should be done through Marketplace. Adopting a playbook does not make it run. Some content packs include...

##### 5.8.4.5. Build your playbook

###### 5.8.4.5.1. Task 1. Choose from existing playbooks or create your own

####### Tip

* If there are additional relevant playbooks in Marketplace that are not in your Org repository, you can click Explore them now to see them in the Playbook Catalog and choose to adopt.

* To open multiple playbooks at the same time, edit the first playbook and then click New next to the playbook name to create a new tab. You can either create a new playbook, or add an existing one. You can view recently modified or deleted playbooks by clicking version history for all playbooks .

####### Navigation

  the Investigation & Response → Automation → Playbooks page to customize or create a playbook

###### 5.8.4.5.2. Task 2. Configure playbook settings

####### Note

* If the playbook has inputs and outputs, the Playbook Starts task will show back and forth arrows. Clicking them opens the Playbook Settings pane Inputs/Outputs tab.

* This rule will trigger the playbook to run if no other Automation Rule triggers the playbook first. You can view and edit the order the rules run in the Automation Rules page.

* If you do not add any fields, the group will be deleted when you click Save.

###### 5.8.4.5.3. Task 3. Add objects from the Task Library

####### 5.8.4.5.3.1. Add Quick Actions, commands, and scripts

######## Note

* If the Quick Action requires an integration instance and it is not yet configured, you have the option to create an integration instance from within the playbook editor.

* If you want to add a script that is not yet adopted, Cortex XSIAM automatically installs the content pack containing the script. If the script requires an integration instance, you are prompted to configure one.

* If you do not have permission to download the script, contact your administrator for help. You can also filter by "show only configured" to show scripts you can use.

* The output value is dynamic and is derived from the context at the time that the task is processed. As a result, parallel tasks that are based on the same output may return inconsistent results.

####### 5.8.4.5.3.2. Add sub-playbooks

######## Tip

* Balance between the number of iterations and the interval so you do not overload the server.

####### 5.8.4.5.3.3. Add manual tasks and blank tasks

######## 5.8.4.5.3.3.1. Create a standard task

######## 5.8.4.5.3.3.2. Create a conditional task

######## 5.8.4.5.3.3.3. Create a communication task

####### 5.8.4.5.3.4. Create a section header

####### 5.8.4.5.3.5. Configure script error handling in a playbook

######## Note

* Use the GetErrorsFromEntry script (part of the Common Scripts Pack) to check whether the given entry returns an error and returns an error message. For example, when using the script in a playbook, you can fetch the error message from a given task, such as a runtime error. You can then add a step in the playbook flow to send those error messages to the...

* You can set up script error handling only when running a script in a Standard task or a Conditional task. For more information about error handling settings for these tasks, see Create a standard task or Create a conditional task. Built-in, Manual, and Ask Conditional tasks have On Error settings for number of retries and retry interval, but not Error...

###### 5.8.4.5.4. Task 4. Add custom playbook features

###### 5.8.4.5.5. Task 5. Test and debug the playbook

###### 5.8.4.5.6. Task 6. Manage playbook content

##### 5.8.4.6. Customize your playbook

###### 5.8.4.6.1. Configure a sub-playbook loop

####### Note

* Consider the following when adding a loop: The maximum number of loops (default is 100). A high number of loops or a high wait time combined with a large number of issues may affect performance. Periodically check looping conditions to ensure they are still valid for the data set. If you want a sub playbook task to loop over an array passed into its...

####### Tip

* Balance between the number of iterations and the interval so you do not overload the server.

###### 5.8.4.6.2. Filter and transform data

####### Caution

* You can change the context data root to filter, but it is not recommended to select a different root, as it affects the filter results. The drop-down list displays the filter root for backward compatibility.

####### Navigation

  Investigation & Response → Automation → Scripts → New Script

####### 5.8.4.6.2.1. Filter considerations, categories, and built-in filters

######## Note

* Is defined considers false and empty strings and lists to be defined values. If you don't want those to be included as defined, use Is not empty.

* Not defined considers false and empty strings and lists to be defined values. If you don't want those to be included as defined, use Is empty.

####### 5.8.4.6.2.2. Transformer considerations, categories, and built-in transformers

######## Note

* To make regex case non-sensitive, use the (?i) prefix (for example (?i)yourRegexText.

###### 5.8.4.6.3. Extract indicators

####### Note

* This configuration may delay playbook execution (issue creation). While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

###### 5.8.4.6.4. Extend context

###### 5.8.4.6.5. Update issue fields with playbook tasks

####### Note

* The setIssue script includes all available fields; use the scroll bar to see all the fields. The name field has a limit of 600 characters. If there are more than 600 characters, you can shorten the name field to under 600 characters and then include the full information in a long text field such as the description field. There are many fields already...

###### 5.8.4.6.6. Playbook polling

####### Note

* You need to use the GenericPolling playbook as a sub-playbook in a main playbook, such as Detonate File - JoeSecurity. The main playbook should follow this structure: Start Command: The task contains a command that fetches the initial state of the process and saves it to context. This command starts the process that should be polled. For...

##### 5.8.4.7. Test your playbook

###### Note

* The debugger does not support using parentIncidentFields.

* Using an existing issue in the debugger does not affect the original issue or change the original context data.

###### 5.8.4.7.1. Troubleshoot playbook performance

##### 5.8.4.8. Manage playbook content

##### 5.8.4.9. Best practices

###### Note

* If you reattach a detached playbook, any customizations you have made to the playbook will be overwritten when the playbook updates to the current version.

* Retries are not supported for data collection tasks that have errors sending emails (indicated by a server timeout). This is because retries only work on automation execution failures, not on email delivery issues.

#### 5.8.5. Create an automation rule

##### Note

* You can also define the conditions that trigger a specific playbook in the playbook editor. For more information, see Task 2. Configure playbook settings

##### Important

* Automation rules apply to Medium and higher severity issues. They also apply to Low severity Analytic issues and Low severity ABIOC issues that are tagged with Identity or Cloud. Rules are evaluated in order, and only the first rule that matches the trigger conditions is executed.

#### 5.8.6. Context data

##### 5.8.6.1. Issue context data

##### 5.8.6.2. Case context data

##### 5.8.6.3. Search context data

##### 5.8.6.4. Add context data to an issue

##### 5.8.6.5. Add context data to a case

###### Note

* If you run the command in the issue War Room, the data is added to the following places: The case context data. The issue context data under the case tab. If you run the command in the Case War Room, the data is added to the case context data only.

##### 5.8.6.6. Delete context data from a case

##### 5.8.6.7. Use context data in a playbook

###### Note

* Generic polling does not work if a playbook's context data is shared globally. For more information, see Playbook polling.

###### Caution

* Users with Trigger Playbook permissions on a given issue may still be able to modify the parent case via commands and scripts, even without full access to the case.

#### 5.8.7. Lists

##### Note

* The maximum list size is 209,715 characters (approximately 200 KB).

##### 5.8.7.1. Create a list

###### Note

* If you want to edit a list from a content pack, you need to duplicate or detach a list. Detached lists do not receive updated content in subsequent Cortex XSIAM content releases. To retain an updated list, reattach it.

###### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

##### 5.8.7.2. List commands

##### 5.8.7.3. Use cases: JSON lists

###### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

  Investigation & Response → Automation → Playbooks → New Playbook

##### 5.8.7.4. Transform a list into an array

###### Navigation

  Investigation & Response → Automation → Playbooks and create or edit a playbook

#### 5.8.8. Jobs

##### 5.8.8.1. Manage jobs

###### Note

* Only Account Admins and Instance Administrator roles can create jobs and view/edit job runs. If the owner of a job has been removed from Cortex XSIAM, the job will fail to run. In this case, you must change the owner to a current user.

##### 5.8.8.2. Create a time triggered job

###### Note

* To view a human readable description of a cron schedule for an existing job, click  and select Job Schedule from the available columns.

###### Important

* We recommend to avoid triggering a job while a previous run of the job is active by configuring the playbook a job triggers to close the investigation before running a new instance of the job.

##### 5.8.8.3. Create a job triggered by a delta in a feed

###### Note

* A job triggered by a delta in a feed runs only if there is a change in the feed, and does not run on a feed's initial fetch. For the initial fetch, you can run the playbook manually and then set up an event triggered job for subsequent fetches. If you want to trigger a job after a feed completes a fetch operation and the feed does not change...

###### Navigation

  Investigation & Response → Automation → Jobs → New Job

#### 5.8.9. Engines

##### 5.8.9.1. What is an engine?

###### Note

* You cannot share a multiple-engine installation with a single-engine installation.

* When you add an engine to a load-balancing group, you cannot use that engine separately. The engine does not appear in the engines menu when configuring an integration instance, but you can choose the load-balancing group.

##### 5.8.9.2. Engine requirements

###### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

##### 5.8.9.3. Install an engine

###### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex XSIAM engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

###### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

###### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

###### 5.8.9.3.1. Docker

####### Note

* This section is relevant when installing an engine.

* Docker images can be downloaded together with their relevant content packs for offline installation.

####### 5.8.9.3.1.1. Install Docker

######## Note

* For Red Hat's Docker distribution, you need Mirantis Container Runtime (formerly Docker Engine - Enterprise) to run specific Docker-dependent integrations and scripts. For more information, see Install Docker distribution for Red Hat on an engine server. To use the Mirantis Container Runtime (formerly Docker Engine - Enterprise) follow the deployment...

######## 5.8.9.3.1.1.1. Install Docker distribution for Red Hat on an engine server

######## 5.8.9.3.1.1.2. Docker image security

######## 5.8.9.3.1.1.3. Docker FAQs

######## 5.8.9.3.1.1.4. Troubleshoot Docker issues

######## 5.8.9.3.1.1.5. Configure Docker pull rate limit

######## 5.8.9.3.1.1.6. Change the Docker installation folder

####### 5.8.9.3.1.2. Docker hardening guide

######## Note

* The settings below can also be applied to Podman, with the exception of limiting available memory, limiting available CPU, and limiting PIDS.

* If you do not want to apply Docker memory limitations, you should explicitly set the advanced parameter: limit.docker.memory to false.

######## Tip

* We recommend reviewing Docker network hardening below before changing any parameters in the configuration file. To securely run Docker containers, we recommend using the latest Docker version.

###### 5.8.9.3.2. Podman

####### Note

* When upgrading an engine, the engine keeps the previously used container management type (regardless of distribution version).

####### 5.8.9.3.2.1. Change the container storage directory

######## Note

* Alternatively, the runroot setting may be set to some temporary directory that is accessible by the user demisto. If you choose to set the runroot, it must be a directory that is mounted as tmpfs (temporary filesystem), unlike the graphroot.

######## Warning

* Do not use NAS storage or a temporary (tmpfs) directory for the graphroot setting. The graphroot needs to be a local, non-temporary directory for Podman to work. For more information, see https://en.wikipedia.org/wiki/Network-attached_storage.

######## Tip

* We recommend reserving 150 GB for container storage, either in the /home partition or a different storage directory that you have set using the graphroot key.

####### 5.8.9.3.2.2. Install Podman

######## Note

* This procedure is intended for RHEL 8 or later. It may not work for other operating system types. Do not use NAS storage for the $HOME directory. The directory needs to be a local directory for Podman to work.

* If you edit the file with the root user, make sure to set the demisto user as file owner by running chown demisto:demisto /home/demisto/.config/containers/registries.conf

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

####### 5.8.9.3.2.3. Migrate From Docker to Podman

####### 5.8.9.3.2.4. Troubleshoot Podman

######## Note

* This step removes all Podman images, including any custom images you may have created.

* $(id -u demisto) is used to get the demisto user ID, which is part of the directory name. For example, /tmp/podman-run-993 Not all the directories above may be present.

* When you run podman container cleanup --rm -a, you might see a message such as running or paused containers cannot be moved without force. The message can be safely ignored, as it only pertains to current running containers, which are not removed.

* To change to the demisto OS user, run the following command: sudo su - -s /bin/bash demisto

* You must switch to user demisto before running the "system migrate" (running it as root will have no effect).

* The "system migrate" must be done by the user demisto.

######## Important

* The runroot must be located under the tmpfs file system type. This is required to clean Podman's run state on reboot and for performance reasons.

######## Caution

* Unlike the runroot, the graphroot must NOT be located under the tmpfs file system type. Using tmpfs for the graphroot might corrupt container images, causing command executions to fail. It also degrades performance by forcing Podman to needlessly re-pull images.

##### 5.8.9.4. Manage engines

###### Navigation

  You can manage your engines and load-balancing groups by going to Settings → Configurations → Data Broker → Engines

##### 5.8.9.5. Upgrade an engine

###### Note

* The upgrade.conf file is available on the engine after it has been upgraded to Cortex XSIAM 3.1. Any custom variables you add to the file are applied when you upgrade from Cortex XSIAM 3.1 to Cortex XSIAM 3.2 or later.

##### 5.8.9.6. Remove an engine

##### 5.8.9.7. Configure engines

###### Note

* A day is defined as 24 hours and may not exactly correspond to calendar days due to daylight savings, leap seconds, etc.

* In addition, to support engine upgrades from the UI, edit the /usr/local/demisto/upgrade.conf file on the engine to include the SERVER_URLS setting with the new tenant's address. Include only the host, without https:// or any additional path at the end of the host name. For example: SERVER_URLS="api-example.us.paloaltonetworks.com"

* If the engine loses communication for longer than this time, it will disconnect and you need to restart the service.

###### 5.8.9.7.1. Configure the engine to use a web proxy

####### Note

* You need to configure Docker to use a proxy. When using a BlueCoat proxy, ensure you encode the values correctly.

* In an environment with a single engine, go to /usr/local/demisto/upgrade.conf. In an environment with multiple engines, go to /usr/local/demisto/<engine-name>/upgrade.conf, replacing <engine-name> with the name of the engine. Note that the key is in the upgrade.conf file and must be https_proxy, even if your proxy address starts with http://.

###### 5.8.9.7.2. Configure the engine to call the server without using a proxy

####### 5.8.9.7.2.1. Use NGINX as a reverse proxy

######## Note

* For multi-tenant deployments, replace location ~ ^/(websocket|d1ws|d2ws) { with location ~ ^/(acc_\S+/)?(websocket|d1ws|d2ws)

###### 5.8.9.7.3. Configure an engine to use custom certificates

##### 5.8.9.8. Use an engine in an integration

###### Note

* Long-running integrations should not run on load-balancing groups.

##### 5.8.9.9. Run a script using an engine

###### Navigation

  Investigation & Response → Automation → Scripts

##### 5.8.9.10. Troubleshoot engines

###### Note

* Ensure that pop-ups are not blocked by your browser.

* If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom path. --keep - Extracts the installer files into the current working directory (without cleaning at the end). If using installer...

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl status d1_<Engine _name>

* Any changes made to variables in the upgrade_engine.sh file are reset after each upgrade. We recommend instead using the upgrade.conf file to set variables.

* You can ignore the following error: Cannot create folder '/var/lib/demisto'

###### Navigation

  When troubleshooting engines, access the logs from Settings → Configurations → Engines and select the engine from which you want to download the logs

##### 5.8.9.11. Troubleshoot integrations running on engines

###### Note

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

* Docker CE installations typically run Docker, while Docker EE installations typically run dockerroot.

### 5.9. Response actions

#### Caution

* Response actions are not supported for Android endpoints.

#### 5.9.1. Initiate a Live Terminal session

##### Note

* You can run PowerShell 5.0 or a later release on Live Terminal of Windows.

* Network drives are not supported.

* On Windows endpoints, you cannot run GUI-based cmd commands like winver or appwiz.cpl.

* Disabling Live Terminal does not take effect on sessions that are in progress.

##### Tip

* You can fine-tune the Live Terminal session visibility on the endpoint by adjusting the User Interface options in your Agent Settings Profile.

#### 5.9.2. Isolate an endpoint

##### Note

* IP-based file storage protocol traffic will also be blocked. This might affect endpoint functionality if the endpoint uses such mounts.

* If file system operations become unresponsive during isolation, such as being unable to list folder content, unmount the mounted network shares.

##### Tip

* If needed, Filter the list of endpoints.

#### 5.9.3. Pause endpoint protection

##### Note

* Pausing your endpoint protection modules leaves your machines exposed to risks.

##### Navigation

  Investigation & Response → Response → Action Center and locate Action Type Pause Endpoint Protection or Resume Endpoint Protection

#### 5.9.4. Remediate changes from malicious activity

##### Prerequisite

* To initiate remediation suggestions, you must have the following system requirements: An App Administrator, Privileged Responder, or Privileged Security Admin role permissions which include the remediation permissions. EDR data collection enabled. Agent version 7.2 or above on Windows endpoints.

##### Note

* Endpoints that are part of the Case view and do not meet the required criteria are excluded from the remediation analysis.

#### 5.9.5. Run agent scripts on an endpoint

##### Prerequisite

* To run scripts on an endpoint, you must have the following system requirements: Endpoints running the Agent v7.1 and later. Since the agent uses its built-in capabilities and many available Python modules to execute the scripts, no additional setup is required on the endpoint. Role in the hub with the following permissions to run and configure...

##### Note

* *Since all scripts are running under System context, you cannot perform any registry operations on user-specific hives (HKEY_CURRENT_USER of a specific user).

* Always use lowercase for variable names.

* Disabling Script Execution does not take effect on scripts that are in progress.

#### 5.9.6. Search and destroy malicious files

##### Prerequisite

* The following are prerequisites to enable Cortex XSIAM to search and destroy files on your endpoints: Supported platforms:    Windows: Cortex XDR agent version 7.2 or a later. If you plan to enable Search and Destroy on VDI sessions, you must perform the initial scan on the Golden Image.   Mac: Cortex XDR agent version 7.3 or a later release running on...

##### Note

* The Cortex XSIAM agent does not include the following information in the local files inventory: Information about files that existed on the endpoint and were deleted before the Cortex XSIAM agent was installed. Information about files where the file size exceeds the maximum file size for hash calculations that are pre-configured in Cortex XSIAM . If...

#### 5.9.7. Manage external dynamic lists

##### Note

* To configure an EDL, you must have a role that includes EDL permissions, such as Instance Admin or Account Admin. Configuring custom certificates or private API Keys in the EDL integration instance is supported only on engines, not on the Cortex XSIAM server. For EDL integrations on the server, you must set a username and password. For long-running...

* The legacy external dynamic list PAN-OS integration is deprecated. Configure the EDL integration by clicking the Automation & Feed Integration link.

* If the EDL integration runs on the Cortex XSIAM server, you do not need to enter a Listen Port in the instance settings. The system auto-selects an unused port for the EDL integration when the instance is saved. If you enter a value for Listen Port, it will be overwritten by the port auto-selected by the system

##### Important

* The EDL URL must always be prefixed by ext-.

#### 5.9.8. Collect a memory image

##### License Type

  This functionality has the following license requirements: Forensics add-on license.

### 5.10. Forensics

#### License Type

  Requires the Forensics add-on

#### 5.10.1. Forensic investigations

##### 5.10.1.1. Manage an investigation

###### 5.10.1.1.1. Create a new investigation

####### Note

* To set up user permissions, you must have Scope-Based Access Control (SBAC) enabled.

###### 5.10.1.1.2. Edit an investigation

###### 5.10.1.1.3. Close an investigation

####### Note

* When you close an investigation, Palo Alto Networks has a grace period of 24 hours before deleting any collections associated with the investigation. During this timeframe, you have the option to cancel the close investigation action.

###### 5.10.1.1.4. User permissions

####### Note

* Even if a user does not have access to view an investigation via the Forensics Investigations page, they can still query the results of the collections using an XQL query.

##### 5.10.1.2. Data collection

###### 5.10.1.2.1. Hunting

####### 5.10.1.2.1.1. Create a hunt

######## Note

* You can save hunts in an incomplete state and edit them later. After a hunt has run, you cannot edit it. Instead, you can duplicate to create a new hunt with the same configuration in order to edit.

* When search fields are specified, the results of the search are limited based upon those filters. If more than one entry in a search filter field, the search returns entries that match any of the provided entries. For example: A File Search with two specified paths ("C:\Test\*" and "C:\Windows\*") will return results from both the Test folder and the...

####### 5.10.1.2.1.2. Hunt results

######## Note

* The grouping button () shows the number of affected endpoints grouped by executable name. This enables you to perform hunting via frequency analysis (referred to as stacking) and provides a birds eye view of potential malware files that require further analysis.

* The grouping button () shows the number of affected endpoints grouped by file path. This enables you to perform hunting via frequency analysis (referred to as stacking) and provides a birds eye view of potential malware files that require further analysis.

####### 5.10.1.2.1.3. Hunt status

###### 5.10.1.2.2. Triage

####### 5.10.1.2.2.1. Create a triage

####### 5.10.1.2.2.2. Upload an offline triage package

######## Note

* Do not upload memory images captured by the Offline Triage Collector. These images are collected for analysis using third-party tools and are not intended for upload.

####### 5.10.1.2.2.3. Offline triage collection

######## Note

* Security software running on the endpoint (including the Cortex agent) can interfere or block the execution of the offline triage collector. Disable any security software on the endpoint while the collector is running or whitelist the collector in your security software before running the offline triage collector.

####### 5.10.1.2.2.4. Triage results

####### 5.10.1.2.2.5. Triage status

##### 5.10.1.3. Analysis and documentation

###### 5.10.1.3.1. Review alerts

###### 5.10.1.3.2. Investigation timeline

###### 5.10.1.3.3. Key assets & artifacts

##### 5.10.1.4. Export

###### Note

* You can export a collection more than once.

### 5.11. Notebooks

#### Prerequisite

* Cortex XSIAM Notebooks usage requires the following. Cortex XSIAM Enterprise or Cortex XSIAM Premium. Apps and XQL RBAC permissions.    To use Notebooks, you must have the View/Edit permissions in Settings → Configurations → Access Management → Roles → Apps → Jupyter.   To configure Notebooks, you must have the View/Edit permissions...

#### Note

* You can only add one instance of Notebooks. Cortex XSIAM Notebooks has access to approved sites on the internet when embedded in Cortex XSIAM. The Notebooks instance includes restart options.

#### Navigation

  Settings → Configurations → Integrations → Apps

  To edit the Notebooks instance, from Settings → Configurations → Integrations → Apps, hover over the instance and select the edit icon

#### 5.11.1. Manage datasets in Notebooks

##### Note

* If a schema is not provided, the function detects the schema automatically.

* Using this function, you can only delete datasets created using the Notebooks APIs . When you delete a dataset, the rules that use the dataset return an error.

#### 5.11.2. Notebooks scheduler

### 5.12. Build XQL queries

#### 5.12.1. About the Query Builder

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

#### 5.12.2. How to build XQL queries

##### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

##### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

##### 5.12.2.1. Get started with XQL queries

###### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

##### 5.12.2.2. Useful XQL user interface features

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

##### 5.12.2.3. XQL Query best practices

##### 5.12.2.4. Expected results when querying fields

##### 5.12.2.5. Create XQL query

###### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

##### 5.12.2.6. Review XQL query results

###### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* In order for Cortex XSIAM to provide a histogram for a field, the field must not contain an array or a JSON object.

##### 5.12.2.7. Translate to XQL

###### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

##### 5.12.2.8. Graph query results

###### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

#### 5.12.3. Query Builder templates

##### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

##### 5.12.3.1. Get started with Query Builder templates

##### 5.12.3.2. Considerations for using Query Builder templates

##### 5.12.3.3. Create a query from a template

###### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

##### 5.12.3.4. Run a free text query

###### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

##### 5.12.3.5. Query Builder template examples

###### Navigation

  Investigation & Response → Search → Query Builder

#### 5.12.4. Edit and run queries in Query Center

##### Navigation

  Investigation & Response → Search → Query Center

##### 5.12.4.1. Query Center reference information

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 5.12.5. Manage scheduled queries

##### Navigation

  Investigation & Response → Search → Scheduled Queries

##### 5.12.5.1. Scheduled Queries reference information

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 5.12.6. Manage your personal query library

##### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

#### 5.12.7. Legacy Query Builder

##### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

##### 5.12.7.1. Create authentication query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 5.12.7.2. Create event log query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 5.12.7.3. Create file query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 5.12.7.4. Create image load query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 5.12.7.5. Create network connections query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 5.12.7.6. Create network query

###### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

##### 5.12.7.7. Create process query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 5.12.7.8. Create registry query

###### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

##### 5.12.7.9. Query across all entities

###### Navigation

  Investigation & Response → Search → Query Builder

### 5.13. Research a known threat

## 6. Threat management

### 6.1. Enable prompt log collection in Azure

### 6.2. Detection rules

#### 6.2.1. What are detection rules?

##### 6.2.1.1. What's an IOC?

###### Note

* Cortex XSIAM supports a maximum of 4,000,000 IOCs.

###### 6.2.1.1.1. IOC rule details

####### Note

* Field cannot exceed 36 characters.

####### Navigation

  In the Threat Management → Detection Rules → IOC page, you can view all configured or uploaded indicators of compromise (IOCs

###### 6.2.1.1.2. Create an IOC rule

####### Note

* To ensure your IOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically does the following: Disables any IOC rules that reach 5000 or more hits over 24 hours. Creates a rule exception based on the PROCESS SHA256 field for IOC rules that hit more than 100 endpoints over 72 hours. If you have the Threat...

####### Navigation

  In Threat Management → Detection Rules → IOC, select + Add IOC

##### 6.2.1.2. What's a BIOC?

###### 6.2.1.2.1. BIOC rule details

####### Navigation

  Manage your behavioral indicator of compromise (BIOC) rules in Threat Management → Detection Rules → BIOC

###### 6.2.1.2.2. Create a BIOC rule

####### License Type

  Custom prevention rules are supported on Cortex XSIAM agent 7.2 and later versions and enable you to configure and apply user-defined BIOC rules to Restriction profiles deployed on your Windows, Mac, and Linux endpoints.

####### Note

* To ensure your BIOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically does the following: Disables BIOC rules that reach 5000 or more hits over a 24-hour period. Creates a rule exception based on the PROCESS SHA256 field for BIOC rules that hit more than 100 endpoints over a 72 hour period.

* A cloud_audit_log dataset requires a Cortex XDR Pro per GB license. Currently, you cannot create a BIOC rule on customized datasets and only the filter stage, alter stage, and functions without any aggregations are supported for XQL queries that define a BIOC. For BIOC rules, the field values in XQL are evaluated as case insensitive (config...

* To demonstrate the expected behavior of the rule before you save it, Cortex XSIAM tests the BIOC on historical logs. After you save a BIOC rule, it will operate both on historical logs (up to 10,000 hits) and on new data received from your log sensors.

* To demonstrate the expected behavior of the rule before you save it, Cortex XSIAM tests the BIOC on historical logs. After you save a BIOC rule, it will operate on both historical logs (up to 10,000 hits) and new data received from your log sensors.

* You can only import files that were exported from Cortex XSIAM. You can not edit an exported file.

* You can only add to existing profiles you created, Cortex XSIAM Default profiles will not appear as an option.

* Auto-disable will turn off both the BIOC rule detection and the BIOC prevention rule.

###### 6.2.1.2.3. Manage Global BIOC Rules

##### 6.2.1.3. What's a correlation rule?

###### Navigation

  After you configure your correlation rules, you can manage them in Threat Management → Detection Rules → Correlations, and view and analyze the generated issues in Cases and the Issues Table

###### 6.2.1.3.1. Correlation rule details

####### Note

* Only an administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM .

* For more information on troubleshooting server errors in scheduled correlation rules, Troubleshoot server errors in scheduled correlation rules.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

####### Navigation

  If you are assigned a role that enables Investigation → Rules privileges, you can manage all user-defined Correlation Rules from Threat Management → Detection Rules → Correlations

###### 6.2.1.3.2. Create a correlation rule

####### Note

* When creating a Real Time Correlation Rule, you can only generate an issue as the resulting action for the Correlation Rule. All other options are disabled. To ensure your Correlation rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically disables Correlation rules that reach 5000 or more hits over a...

* When you open the New Correlation Rule editor from XQL Search, this XQL Search field is already populated with the XQL query that you defined. An administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM . All other users can only create and view queries built with an existing dataset.

* The XQL features for call, top, and wildcards in datasets (dataset in (<dataset prefix>_*)) are currently not supported in Correlation Rules. If you add them to the XQL definition, you will not be able to Create or Save the Correlation Rule. The XQL features for transaction in datasets (dataset in (<dataset prefix>_*)) are currently not supported in...

* The incident that contains the issues will also be assigned to the selected domain. For more information, see Case and issue domains. If you want to generate a health issue, choose the Health domain. For more information about health issues, see About health issues.

* If a generated issue has severity Medium or above, a case is automatically opened. Low severity issues generated by correlation rules are not grouped into cases.

* There is no validation or auto complete for these parameters and the values can be null or empty. In these scenarios, Cortex XSIAM does not display the null or empty values, but adds the text NULL or EMPTY in the descriptions.

* When more than one XDM field is listed, Cortex XSIAM looks for the field value according to the order of the fields listed.

* When Use the Cortex XSIAM default incident enrichment is not selected and you have not mapped any issue fields, the issue is dispatched into a new incident.

####### Important

* The maximum size of a lookup dataset is 50 MB. If the data exceeds this limit, the add to lookup action fails.

####### Tip

* When creating your correlation rule, you can use predefined values for different fields in the editor, such as Alert Name, Alert Description, and Drill-Down Query. For more information, Field replacement syntax in correlation rules.

####### Navigation

  You can create a new correlation rule from either the Threat Management → Detection Rules → Correlation Rules page or when building a query in XQL Search

###### 6.2.1.3.3. Field replacement syntax in correlation rules

###### 6.2.1.3.4. Manage correlation rules

####### Note

* Execute Rule is not available for real time correlation rules.

###### 6.2.1.3.5. Monitor correlation rules

####### Note

* In the dataset, the Query start time and Query end time indicate the time frame of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

###### 6.2.1.3.6. Troubleshoot server errors in scheduled correlation rules

##### 6.2.1.4. Manage IOC and BIOC rules

###### Note

* For Analytics BIOC rules, you can only disable and enable rules.

* You cannot delete global BIOCs delivered with content updates.

* For BIOC rules that are applied to prevention profiles: If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention on the agent works as usual. If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention...

* When a BIOC rule is disabled automatically by Cortex XSIAM, for example due to the server anti flooding mechanism, prevention on the agent works as before.

###### Navigation

  Threat Management → Detection Rules → BIOC

### 6.3. Analytics

#### 6.3.1. Analytics engine

#### 6.3.2. Analytics sensors

#### 6.3.3. Coverage of MITRE Attack tactics

#### 6.3.4. Review MITRE ATT&CK framework coverage

##### Note

* When a contributing data source type is active, it does not imply that all the rules and detectors associated with the data source type are active. Rule applicability is dependent on the data source's context and configuration. To enable an active status, data source types require the following setup: Endpoint: Installed Cortex XDR agent. Network: A...

#### 6.3.5. Analytics detection time intervals

##### Note

* When establishing a baseline, detectors compute limits beyond which network activity will require an issue. In some cases, detectors do not compute baseline limits; instead they are predetermined by Cortex XSIAM engineers. The engineers determine the values used for predetermined limits using statistical analysis of malicious activity recorded...

#### 6.3.6. Analytics issues and Analytics BIOCs

#### 6.3.7. View and manage Analytics rules

#### 6.3.8. Identity Analytics

##### Navigation

  After configuring your Cloud Identity Engine instance and Cortex XSIAM Analytics, select Settings () → Configurations → Cortex XSIAM - Analytics, and in the Featured in Analytics section, Enable Identity Analytics

#### 6.3.9. Identity Threat Module (ITDR)

#### 6.3.10. AI Detection & Response in Cortex XSIAM (Beta)

##### Prerequisite

* To enable AIDR, you must have one of the following user roles: Instance Admin or Account Admin.

##### Navigation

  Settings → Configurations → Cortex - Analytics

##### 6.3.10.1. Data sources and supported services

##### 6.3.10.2. AI Detection & Response Dashboard

##### 6.3.10.3. Collect prompt logs

###### 6.3.10.3.1. Prompt log collection in AWS

###### 6.3.10.3.2. Enable prompt log collection in Azure

####### 6.3.10.3.2.1. Configure the Azure Event Hub collection in Cortex XSIAM

####### 6.3.10.3.2.2. Set up prompt logging

####### 6.3.10.3.2.3. Log HTTP data

####### 6.3.10.3.2.4. Configure diagnostic settings:

### 6.4. Threat Intel Management

#### 6.4.1. Get started with Threat Intel Management

##### Note

* By default, the Palo Alto Networks Wildfire Reports integration, which is used as part of the sample analysis feature, is installed and configured. The Palo Alto Networks Wildfire v2 integration, for dynamic malware analysis, is also installed, but you must add an integration instance. No API key is required.

##### 6.4.1.1. What is Threat Intel Management?

##### 6.4.1.2. Threat Intel Management use cases

###### Navigation

  Settings → Configurations → Data Collections → Automation & Feed Integrations and in the Category field, select Threat Intel Feeds

##### 6.4.1.3. Roles and responsibilities in Threat Intel Management

##### 6.4.1.4. Indicator concepts

###### Note

* You can store up to 100,000,000 indicators.

##### 6.4.1.5. Indicator lifecycle

###### Note

* To run enhancement scripts and reputation commands, you must configure a relevant enrichment integration, such as VirusTotal, IPinfo v2, etc.

###### Tip

* We recommend defining your policy for handling expired indicators.

#### 6.4.2. Indicator configuration

##### 6.4.2.1. Customize indicator fields and types

###### 6.4.2.1.1. Create an indicator type

####### Note

* If you miss mapping any field, you can create additional new indicator fields and either relate them to all indicator types, or relate them only to the new indicator type (recommended).

####### Navigation

  Settings → Configurations → Object Setup → Indicators → Types

####### 6.4.2.1.1.1. Indicator type profile

######## Note

* Indicator cache expiration rules only apply to standard enrichment (for example, running the enrichIndicators command). If you run a reputation command, such as !ip, the commands executes even if the cache has not expired.

####### 6.4.2.1.1.2. File indicators

######## Note

* A new File indicator only affects new indicators ingested to the Cortex XSIAM platform. Indicators that were already in Cortex XSIAM continue to appear as their respective hash-related indicators.

######## Navigation

  Settings → Configurations → Object Setup → Indicators → Types

####### 6.4.2.1.1.3. Formatting scripts

######## Note

* Formatting scripts must have the indicator-format tag to appear in the list.

* Formatting scripts for out-of-the-box indicator types are system-level, which means that the formatting scripts for these indicator types are not configurable. To create a formatting script for an out-of-the-box indicator type, you need to disable the existing indicator type and create a new (custom) indicator type. If you configured a formatting...

####### 6.4.2.1.1.4. Enhancement scripts

######## Note

* Enhancement scripts are different from reputation commands. A reputation command runs every integration that has that command within it, to enrich the indicator. The reputation command ip , for example, runs every IP integration command in your enabled integrations, to collect data from multiple sources. An enhancement script is manually run after the...

* Enhancement scripts must have the enhancement tag applied to appear in the list.

####### 6.4.2.1.1.5. Reputation scripts

######## Note

* The Reputation script overrides any default settings for the indicator that relates to the verdict.

* Reputation scripts must have the reputation tag applied to appear in the list.

####### 6.4.2.1.1.6. Reputation commands

######## Note

* Running a reputation command directly (such as !ip) might not apply the result to an indicator, nor does it use the enrichment cache. To ensure an indicator is enriched, and to take advantage of caching, use the enrichIndicators command or the Enrich button in the UI. This runs the appropriate reputation command/script based on the indicator type...

####### 6.4.2.1.1.7. Map custom indicator fields

######## Note

* Some integrations have indicator mappers and classifiers, such as AWS. If you want to use an integration mapper or classifier, see Indicator classification and mapping.

######## Navigation

  Settings → Configurations → Object Setup → Indicators → Types

###### 6.4.2.1.2. Create an indicator field

####### Note

* Cortex XSIAM IOC fields are based on the STIX 2.1 specifications. For more information, see Indicator field structure.

* The following HTML tags are not permitted: blockquote, del, dd, div, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, iframe, ins, li, math, noscript, ol, pre, p, script, style, table, ul, address, article, aside, canvas, details, dialog, figcaption, figure, footer, header, hgroup, main, nav, output, progress, section, video. The following CSS tags...

####### Navigation

  Settings → Configurations → Object Setup → Indicators → Fields → New Field

####### 6.4.2.1.2.1. Indicator field structure

####### 6.4.2.1.2.2. Indicator field trigger scripts

######## Note

* Indicator field trigger scripts must have the field-change-triggered-indicator tag to appear in the list.

##### 6.4.2.2. Indicator classification and mapping

###### Note

* When creating a new indicator type, you classify and map the indicator fields in the indicator type settings. For more details, see Map custom indicator fields.

* You can optionally skip importing data. Click the pencil on the right of each indicator type on the right pane to enter the value manually.

* In the Classification & Mapping page, the mapping does not indicate for which indicator types they are configured. When creating a mapper, it is best practice to add to the mapper name and the indicator type the mapper is for. For example, Mail Listener - Phishing. When mapping a list, we recommend you map to a multi-select field. Short text fields do...

##### 6.4.2.3. Indicator extraction

###### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Reputation commands, such as !ip and !domain, can only be used after you configure and enable a reputation integration instance, such as VirusTotal and Whois.

* The inline configuration may delay playbook execution.

* While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks. All indicators are automatically extracted and enriched before a playbook is run. For an on-field change, extraction occurs before the next playbook tasks run.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

###### 6.4.2.3.1. Set the indicator extraction mode for a playbook task

###### 6.4.2.3.2. Disable indicator extraction for scripts or integrations

##### 6.4.2.4. Configure indicator expiration

###### Note

* You need to run CLI commands in the Case or Issue War Room.

* If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its expiration method reverts to that of the indicator type (time-based). Time-based expiration is set according to feed reliability. If the same indicator appears on multiple feeds, the...

##### 6.4.2.5. Configure Threat Intelligence feed integrations

###### Note

* Some feeds only provide information about new indicators and do not specify when indicators are removed. Indicators from these feeds cannot be automatically expired on removal. If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its...

##### 6.4.2.6. Exclude indicators from enrichment

##### 6.4.2.7. Generate issues from indicators using indicator rules for prevention and detection

###### Note

* Indicators should be present in the Threat Intelligence database (Threat Management → Threat Intelligence → Indicators) before creating detection and prevention rules.

* Although you can create IOC rules for detection, indicator rules are designed to leverage threat intelligence indicators like MD5 and SHA256 hashes that are present in your TIM library. These rules directly integrate with and rely on the indicators ingested and managed by TIM. Indicators must be in the TIM database before creating these rules. For more...

* You can't change the Preventable = True, Status = Active and Type = File filters, which comply with the requirements of the supported indicator type for Prevention on the Agent.

* The Indicator Rule shows the number of issues generated by the rule, You can view the issues that were generated using the Indicator rule, by right-clicking the rule and select View related issues.

* You can't change the Detectable = True and Status = Active filters, which comply with the requirements of the supported indicator type for detection.

* The Issue source is Threat Intelligence.

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

##### 6.4.2.8. Export indicators

###### Caution

* You should not run a query on a field that you might change in the playbook flow. For example, you shouldn't have a playbook with query Verdict:Malicious and then change the indicator verdict as a part of the playbook.

#### 6.4.3. Indicator management

##### Note

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

#### 6.4.4. Query indicators with Unit 42 Intel data

##### Note

* You can search or look up indicators. A search, which can include wildcards and complex queries, can return multiple results. Searches are only performed in Cortex XSIAM. Lookups are exact values, are performed in both Cortex XSIAM and Unit 42 Intel data, and can only return one result.

#### 6.4.5. Indicator investigation

##### 6.4.5.1. Indicator verdict

##### 6.4.5.2. Extract and enrich an indicator

###### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Triggering enrichment on a substantial number of indicators can take time (because it's activating all enrichment integrations per indicator) and can result in performance degradation.

* Reputation commands, such as !ip, !domain can only be used when you configure and enable a reputation integration instance, such as VirusTotal and WHOIS.

##### 6.4.5.3. Expire an indicator

###### Note

* You need to run these commands in the Case or Issue War Room.

##### 6.4.5.4. Manage indicator relationships

###### Note

* You can also add an indicator relationship from the Quick View when selecting an indicator from an issue.

##### 6.4.5.5. Delete and exclude indicators

###### Caution

* Ensure you are using the correct syntax when defining the values for your exclusion lists.

##### 6.4.5.6. Investigate files using sample analysis

###### Note

* WildFire provides verdicts and analysis reports without requiring a license key. To send files to WildFire for analysis, see Set up Malware Prevention Profiles.Set up malware prevention profiles

* When searching on the Sample Analysis page for relationships -relationships"", some results may appear without their specific relationships listed, due to internal relationship permissions.

##### 6.4.5.7. Use sessions and submissions in your investigation

###### Note

* When searching on the Sessions & Submissions page for relationships -relationships"", some results may appear without their specific relationships listed, due to internal relationship permissions.

* The Application is matched to the type of application traffic detected in a session. For example, a search for the Application web-browsing returns sessions during which web browsing over HTTP occurred. See Applipedia for an updated list of applications that Palo Alto Networks identifies.

## 7. Inventory management

### 7.1. Asset management

#### 7.1.1. All Assets

##### Note

* Keep the following caveats in my mind when working with the Asset Inventory page: Instance Administrators are able to view all Inventory views without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope SBAC is not currently available for custom roles with View/Edit permissions on the...

* The options available are dependent on your license.

##### 7.1.1.1. Container Images

###### Navigation

  All Assets → Compute → Container Images

##### 7.1.1.2. Kubernetes Cluster

###### Navigation

  Inventory → All Assets → Compute → Kubernetes Cluster for a Kubernetes clusters assets overview

##### 7.1.1.3. Container Instances

###### Navigation

  Asset Inventory → Compute → Container Instances

##### 7.1.1.4. External Surface assets

###### License Type

  Requires the Attack Surface Management (ASM) add-on

###### 7.1.1.4.1. External Surface attribution evidence

#### 7.1.2. Network configuration

##### 7.1.2.1. Configure your network parameters

###### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

* Viewing external IP address ranges requires the Attack Surface Management add-on.

###### Navigation

  In Cortex XSIAM , select Assets → Network Configuration → Internal Domain Suffixes

#### 7.1.3. Asset Groups

##### Note

* When you create or edit an Asset Group, the changes are applied immediately to new assets and to existing assets that have been updated. However, it may take a few hours for the changes to appear on existing assets that have not been updated.

##### Navigation

  Inventory → Assets → Groups → Add Group

#### 7.1.4. Asset Roles

##### Note

* Asset Roles are available only if the Identity Threat Module add-on is enabled.

##### 7.1.4.1. Manage Asset Roles for Endpoints

###### Note

* Endpoint Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added endpoint removes the endpoint from the Included Endpoints list. If this endpoint is detected automatically as having this asset role in the future, it will appear in the Included Endpoints list. Excluding a manually added endpoint ensures that even if in the future the endpoint is detected as having this asset role, this...

##### 7.1.4.2. Manage Asset Roles for Users

###### Note

* User Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added user removes the user from the Included Users list. If this user is detected automatically as having this asset role in the future, it will appear in the Included Users list again. Excluding a manually added user ensures that even if in the future the user is detected as having this asset role, this detection is overridden and...

###### 7.1.4.2.1. Honey user

####### Prerequisite

* The honey user role is available only if the Identity Threat Module add-on is enabled.

#### 7.1.5. Manage Asset Scores

##### Note

* The Hosts tab is available if the Identity Threat Module add-on is enabled.

* As new alerts are associated with incidents, the User and Host Scores are recalculated. You can view the latest User and Host Scores on the Asset Scores page, or track the Score trend on the User Risk View and Host Risk View.

* Some User Associated Insights may not appear as part of the User Associated Incidents due to the insight generation mechanism. For example, when an insight related to one of the assets in an incident is generated a few days after the associated incident, the insight may not be associated with the incident.

#### 7.1.6. Vulnerability Assessment

##### Prerequisite

* The following are prerequisites for Cortex XSIAM to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XSIAM lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex XSIAM...

* The following are prerequisites for Cortex XSIAM to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex XSIAM collects all the information about the operating system and the installed...

##### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex XSIAM Application Inventory.

##### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

##### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

## 8. Attack Surface Management

### License Type

  Requires the ASM add-on

### 8.1. Get started with Attack Surface Management

#### License Type

  Requires the ASM add-on.

#### 8.1.1. What is Attack Surface Management?

##### 8.1.1.1. Attack Surface Management use cases

#### 8.1.2. Network mapping

#### 8.1.3. Scanning

##### 8.1.3.1. Scanning cadences

##### 8.1.3.2. Known Assets Monitoring

##### 8.1.3.3. Scanning ports and protocols

###### Note

* The following lists are not exhaustive. For current and complete lists, contact your customer success team.

#### 8.1.4. GeoIP data collection

### 8.2. Attack Surface Management detections

#### 8.2.1. Attack surface rules

##### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

#### 8.2.2. Attack Surface Testing

##### Note

* Requires the ASM add-on.

* Attack surface testing scans are typically not CFAA compliant, meaning that they may attempt more extensive fuzzing to confirm or deny the presence of a CVE. Additionally, some attack surface tests are more intrusive than others. Tests are labeled with the level of intrusivity, so you can decide whether to run more intrusive tests.

##### 8.2.2.1. Set up Attack Surface Testing

###### Navigation

  Settings → Configurations → Access Management → Roles, and select the role

  Modules → Attack Surface → Policies → Attack Surface Tests

  Settings → Configurations → Attack Surface → Attack Surface Testing

#### 8.2.3. Externally inferred CVEs

##### Note

* An externally inferred CVE might impact your service or asset, but additional investigation is required to confirm that the CVE is actually present.

#### 8.2.4. Digital Risk Protection

##### Note

* Both of these attack surface rules are based on the attributed domain assets that appear in the asset inventory. If there are no attributed domains in your inventory, Cortex XSIAM will not generate Digital Risk Protection findings and issues.

##### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

### 8.3. Attack surface assets

#### Navigation

  The internet-facing assets that were discovered in a attack surface management (ASM) scan and attributed to your organization are available in the inventory on the Inventory → Assets → All Assets → External Surface pages

  Inventory → Assets → Network Configuration → IP Address Ranges → External IP Address Ranges

#### 8.3.1. Upload or remove ASM assets

##### Note

* You must have the Instance Administrator role to upload or remove assets.

##### 8.3.1.1. Upload assets

###### Note

* If an asset upload request has an invalid CSV or includes one or more invalid assets, the entire request will fail, and none of the assets will be uploaded. If this happens, Cortex XSIAM will display an error message indicating what caused the error, so you can fix the problem and resubmit if you choose.

###### Navigation

  Settings → Configurations → Asset Management → Asset Uploads/Removals

##### 8.3.1.2. Remove assets

###### Note

* If an asset removal request has an incorrectly formatted CSV or includes one or more invalid assets, the entire request will fail, and none of the assets will be removed. If this happens, Cortex XSIAM will display an error message indicating what caused the error, so you can fix the problem and resubmit if you choose.

###### Navigation

  Settings → Configurations → Asset Management → Asset Uploads/Removals

### 8.4. Deploy ASM and Exposure Management enrichment and remediation automation

#### Note

* For details and requirements regarding the enrichment information that can be collected and the specific issues that can be remediated automatically, review the Exposure Management Content Pack information in Marketplace.

* Cortex Exposure Management playbooks only run on issues that were created after the automation rules have been configured.

#### Navigation

  Investigation & Response → Automation → Automation Rules

  Settings → Configurations → Data Collection → Automation & Feed Integrations

### 8.5. ASM enrichment of cloud assets

#### Navigation

  Inventory → Assets → All Assets → External Surface → Services

### 8.6. Emerging Vulnerabilities

#### License Type

  Requires the ASM add-on

#### Note

* You must have a role with Attack Surface Rules permission to access the Emerging Vulnerabilities page. When setting up Roles Based Access Control (RBAC), you can find Attack Surface Rules in the Detection & Threat Intel component.

#### Navigation

  Posture Management → Vulnerability Management → Emerging Vulnerabilities

### 8.7. Global Lookup

#### Navigation

  Modules → Attack Surface → Global Lookup

## 9. Data management

### 9.1. Broker VM

#### 9.1.1. What is the Broker VM?

#### 9.1.2. Set up and configure Broker VM

##### Note

* The Broker VM comes with a 512 GB disk. Therefore, deploy the Broker VM with thin provisioning, meaning the hard disk can grow up to 512 GB but will do so only if needed.

* When DHCP is not enabled in your network and there isn't an IP address for your Broker VM, configure the Broker VM with a static IP using the serial console menu.

* When configuring a Local Agent Settings applet with installer and content caching, you need to configure an SSL certificate for the Broker VM as explained in the task below. For more information on specific requirements for the Local Agent Settings applet, see Activate Local Agent Settings. Keep in mind that several Broker VM applets, such as the...

* You can configure another Broker VM as a proxy server for this Broker VM by selecting the HTTP type. When selecting HTTP to route Broker VM communication, you need to add the IP Address and Port number (set when activating the Agent Proxy) for another Broker VM registered in your tenant. This designates the other Broker VM as a proxy for this Broker VM.

* The Palo Alto Networks Broker VM supports only strong cipher SHA256-based certificates. MD5/SHA1-based certificates are not supported.

* If adding a CA certificate to the Broker VM is not possible, ensure that you've added the Broker Service FQDNs to the SSL Decryption Exclusion list on your firewalls. See Enable Access to Cortex XDR.

##### Important

* There can be instances in which the Broker VM requires up to 50% of the incoming bandwidth as outgoing. Such instances can be, network instability between the Broker VM and Cortex XSIAM, or data that is being collected, but not well compressed.

* The internal network for the Broker VM must be unique and reserved. Other devices should not use the same IP as the Broker VM internal network as it can lead to communication issues with the Broker VM.

* If you use SSL decryption in your firewalls and proxies, see the Understanding CA certificate functionality in Broker VM deployments section below. In addition, verify that the proxies used support HTTP/2, gRPC-specific headers, and HTTP/2 trailers, and the inspection policies support gRPC traffic. Any devices that you use with this configuration...

* When configuring more than one network interface, ensure that only one Default Gateway is defined. The rest must be set to 0.0.0.0, which configures them as undefined. In addition, we recommend assigning each network interface to a different subnet, as oppose to configuring two interfaces on the same subnet which can potentially cause unexpected...

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and earlier, Cortex XSIAM will only accept 172.17.0.0/16.

* We strongly recommend disabling SSH connectivity when it's not being used. Therefore, activate SSH connectivity when it's needed and disable it right afterwards. When generating a new SSH key ensure to avoid embedding the domain-style username, by not using any backslashes (\) in the comment field, to ensure the SSH key passes validation.

##### 9.1.2.1. Broker VM image installations

###### 9.1.2.1.1. Set up Broker VM on Alibaba Cloud

####### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

####### Note

* For Linux and Windows uploads, you can use Alibaba Cloud's graphical management tool called ossbrowser.

* The Object Storage Service must be created in the same Region as the image of the virtual machine.

####### Navigation

  Hamburger menu → Elastic Compute Service → Instances & Images → Instances

###### 9.1.2.1.2. Set up Broker VM on Amazon Web Services

####### Prerequisite

* Download a Cortex XSIAM Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. You need to set up an AWS VM Import role (vmimport) before you continue with the steps to convert the image as it is required for the import-image CLI command. You can use a different role, if the...

####### Note

* Creating an AMI image can take up to 60 minutes to complete.

* Assigning security groups can take up to 15 minutes.

####### Important

* A t2.medium (4GB RAM) is the lowest machine type that can be used as an instance type. Usually, the lowest machine type is sufficient with the Local Agent Settings applet. Yet, when enabling more applets, 8 GB is required.

####### Navigation

  Log in to the AWS IAM Console, and in the navigation pane, select Access Management → Users → Add Users

  Obtain a registration token from the Cortex XSIAM Web Console by selecting Settings → Configurations → Data Broker → Broker VMs → Add Broker → Generate Token

###### 9.1.2.1.3. Set up Broker VM on Google Cloud Platform (GCP)

####### Prerequisite

* Download a Cortex XSIAM Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. To complete the set up, you must have G Cloud installed and have an authenticated user account.

* Before importing a GCP image using the gcloud CLI, ensure that you update the Google Cloud components to version 371.0.0 and above using the following command:

####### Note

* The import tool uses Cloud Build API, which must be enabled in your project. For the import to work, Cloud Build service account must have compute.admin and iam.serviceAccountUser roles. When using the Google Cloud console to import the image, you will be prompted to add these permissions automatically.

###### 9.1.2.1.4. Set up Broker VM on KVM using Ubuntu

####### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

###### 9.1.2.1.5. Set up Broker VM on Microsoft Azure

####### Prerequisite

* Download a Cortex XSIAM Broker VM VHD (Azure) image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

####### Note

* Extraction can take up to a few hours.

* Upload can take up to a few hours.

* Creating the VM can take up to 15 minutes. The Broker VM Web UI is not accessible during this time.

* For more information on creating a rule in an Azure VM, see Create a Security Rule in the Azure Documentation.

###### 9.1.2.1.6. Set up Broker VM on Microsoft Hyper-V

####### Prerequisite

* Download a Cortex XSIAM Broker VM VHD image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

###### 9.1.2.1.7. Set up Broker VM on Nutanix Hypervisor

####### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

####### Note

* Saving the image to Nutanix hypervisor can take time as it's a large file.

* Creating the VM can take up to 15 minutes. The Broker VM Web user interface is not accessible during this time.

###### 9.1.2.1.8. Set up Broker VM on VMware ESXi using vSphere Client

####### Prerequisite

* Ensure you have a virtualization platform installed that is compatible with an OVA image, and have an authenticated user account. Download a Cortex XSIAM Broker VM OVA image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### 9.1.2.2. Broker VM data collector applets

###### 9.1.2.2.1. Activate Apache Kafka Collector

####### Prerequisite

* Apache Kafka version 2.5.1 and above. Kafka cluster set up on premises, from which the data will be ingested. Privileges to manage Broker Service configuration, such as Instance Administrator privileges. Create a user in the Kafka cluster with the necessary permissions and the following authentication details:    Broker Certificate and Private Key for...

####### Note

* For CEF and LEEF logs, Cortex XSIAM takes the vendor and product names from the log itself, regardless of what you configure on this page.

###### 9.1.2.2.2. Activate CSV Collector

####### Prerequisite

* Set up and configure Broker VM. Ensure that you share the applicable CSV files. Know the complete file path for the Windows directory.

####### Note

* When you implement a wildcard file search, ensure that the CSV files share the same columns and header rows as all other logs that are collected from the CSV files to create a single dataset.

* The CSV Collector checks for new CSV files every 10 minutes.

###### 9.1.2.2.3. Activate Database Collector

####### Prerequisite

* Set up and configure Broker VM

####### Navigation

  Settings → Configurations → Data Broker → Broker VMs

###### 9.1.2.2.4. Activate Files and Folders Collector

####### Prerequisite

* Set up and configure Broker VM. Know the complete path to the files and folders that you want Cortex XSIAM to monitor. Ensure that the user permissions for the network share include the ability to rename and delete files in the folder that you want to configure collection.

####### Note

* Cortex XSIAM only supports ingestion of files encoded in UTF-8 format.

* When using the Linux file share, including the Linux share with nfs, a Username and Password is not required, so these fields are grayed out in the screen.

* In Batch mode, the Files and Folders Collector supports collecting logs from a network share for a maximum file size of 500 MB.

* When uploading JSON files, Cortex XSIAM only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* When the storing method is Replace, the maximum size for the total data to be imported into a lookup dataset is 30 MB each time the data is fetched. The inventory data ingested using the Files and Folders collector is counted towards license utilization. When you use a JOINT function with a lookup table in a query or correlation rule, make sure you...

* You can't specify a file name that's the same as a system file name. The name of a dataset created from a tsv file must always include the extension. If the original file name is mrkdptusrsnov23.tsv, you can name save the dataset with the name marketing_dept_users_Nov_2023.tsv.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

###### 9.1.2.2.5. Activate FTP Collector

####### Prerequisite

* Set up and configure Broker VM. Ensure that the user permissions for the FTP, SFTP, or FTPS include the ability to rename and delete files in the folder that you want to configure collection. When setting up an FTPS Collector with a server using a Self-signed certificate, you must upload the certificate first to the Broker VM as a Trusted CA...

####### Note

* When configuring an SFTP connection, Cortex XSIAM expects the private key to be in the RSA format that is included in the -----BEGIN RSA PRIVATE KEY----- tag. Cortex XSIAM does not support providing the private key in the OpenSSH format from the -----BEGIN OPENSSH PRIVATE KEY----- tag. When using ssh-keygen using a Mac, you get the OpenSSH format by...

* When uploading JSON files, Cortex XSIAM only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

###### 9.1.2.2.6. Activate Local Agent Settings

####### Note

* This is assuming a standard hardware setup with 2vCPU 8 GB memory.

* Broker VMs can act as as a proxy for routing XDR Collector traffic to the Cortex XSIAM tenant. The Broker VM does not cache XDR Collector installers.

* When you install your XDR agents, you need to configure the IP address of the Broker VM and a port number during the installation. You can use the default 8888 port or set a custom port. You are not permitted to configure port numbers between 0-1024 and 63000-65000, or port numbers 4369, 5671, 5672, 5986, 6379, 8000, 9100, 15672, 25672. Additionally,...

####### Important

* A FQDN must be configured for WEC and Agent Installer and Content Caching to function properly.

* You can only enable Agent Installer and Content Caching, when in the Broker VM Configuration, you've uploaded your signed SSL Server Certificate and key and set the FQDN. For more information, see the Agent Installer and Content Caching requirements explained above.

###### 9.1.2.2.7. Activate NetFlow Collector

####### Prerequisite

* Set up and configure Broker VM

####### Note

* Since multiple network devices can send data to a single NetFlow Collector, we recommend that you configure a maximum of 50 NetFlow Collectors per Broker VM applet, with a maximum aggregated rate of approximately 50K flows per second (FPS) to maintain system performance.

* Since Cortex XSIAM reserves some port numbers, it is best to select a port number that is not in the range of 0-1024 (except for 514), in the range of 63000-65000 or has one of the following values: 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672.

* The options available change, according to the set Source Network value.

###### 9.1.2.2.8. Activate Network Mapper

####### Prerequisite

* After you have configured and registered your Broker VM, you can choose to activate the Network Mapper application.

####### Note

* Each IP address range can receive multiple scan requests based on it's availability.

* IP address ranges are displayed according to what you defined as your Network Parameters.

###### 9.1.2.2.9. Activate Pathfinder

####### Prerequisite

* Configure and register a Broker VM. Except for Vanilla Windows 7, Cortex XSIAM supports activating Pathfinder on Windows operating systems with PowerShell version 3 and later. Verify these requirements wherever you want to activate Pathfinder. The Pathfinder configuration must contain at least one IP address range to run. Make sure that your internal...

####### Note

* Pathfinder isn't supported when configuring Broker VMs in high availability (HA) clusters.

####### Important

* The Broker VM Pathfinder applet is now deprecated. In tenants where the applet was implemented, it will remain operational until January 25, 2026. In all other tenants, the applet is unavailable and cannot be used as of July 20, 2025. To ensure complete coverage and protection, we recommend deploying XDR Agents on all endpoints by this date. Migration...

* The Pathfinder applet isn't supported when configuring Broker VMs in high availability (HA) clusters.

###### 9.1.2.2.10. Activate Syslog Collector

####### Prerequisite

* Set up and configure Broker VM

####### Note

* Once configured, you cannot change the Port/PROTOCOL. If you don't want to use a data source, ensure to remove the data source from the list as explained in Task 5.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and...

* The server certificate and private key pair is expected in a PEM format. Cortex XSIAM will notify you when your certificates are about to expire.

* Because some port numbers are reserved by Cortex XSIAM , you must choose a port number that is not: In the range of 0-1024 (except for 514) In the range of 63000-65000 Values of 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672

* CORELIGHT is not available for a UDP protocol.

####### Navigation

  Settings → Configurations → Data Broker → Broker VMs

###### 9.1.2.2.11. Activate Windows Event Collector

####### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

####### Note

* You can also activate the Windows Event Collector on Windows Core. For more information, see Activate Windows Event Collector on Windows Core.

* By default, Cortex XSIAM collects Palo Alto Networks predefined Security events that are used by the Cortex XSIAM detectors. Removing the Security collector interferes with the Cortex XSIAM detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

####### 9.1.2.2.11.1. Activate Windows Event Collector on Windows Core

######## Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

######## Note

* By default, Cortex XSIAM collects Palo Alto Networks predefined Security events that are used by the Cortex XSIAM detectors. Removing the Security collector interferes with the Cortex XSIAM detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

####### 9.1.2.2.11.2. Renew WEC certificates

######## Note

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* You can see more than one ca.wec.paloaltonetworks.com and forwarder.wec.paloaltonetworks.com file from a previous installation in the directory, so select the file with the most extended Expiration Date. You can verify that you are using the correct certificate: To verify the client certificate in the Personal → Certificates folder is related to the...

* Only perform this step under the following conditions: You have completed the WEF certification renewal process for ALL clients in your environment. Otherwise, events from the WEFs that you did not install the new client certificate will not be collected by the WEC. You are approaching the WEC server CA certificate expiration date, which is 2 years...

* If this query does not display results with a timestamp from after the renewal process, it could indicate that the renewal process is not complete, so wait a few minutes before running another query. If you are still having a problem, contact Technical Support.

######## Important

* After you receive a notification for renewing your WEC CA certificate, we recommend that you do not add any new WEF clients until the WEC certification renewal process is complete. Events from these WEF clients that are added afterwards will not be collected by the server until the WEC certificates are renewed.

#### 9.1.3. Manage Broker VM

##### Note

* For more information on troubleshooting errors and warnings for these broker applets, see Troubleshoot Broker VM applet errors.

* Certain fields are also exposed in the Clusters tab, when a Broker VM node is added to a High Availability (HA) cluster, and each cluster node is expanded to view the Broker VM nodes table. An asterisk (*) is beside every field that is also included in the Broker VM nodes table for each HA cluster.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

##### 9.1.3.1. Edit Broker VM Configuration

###### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and lower, Cortex XSIAM accepts only 172.17.0.0/16.

* Make sure you save the password before closing the window. The only way to re-generate a password is to disable ssh and re-enable.

##### 9.1.3.2. Increase Broker VM storage allocated for data caching

###### Note

* Follow your hypervisor documentation to understand how to add a persistent disk storage to your VM.

* If your disk is not listed and you didn't shutdown your Broker VM in your hypervisor before manually adding a disk to the VM, you'll need to reboot the Broker VM before the disk details are detected by the Broker VM. This can be performed either in the hypervisor or directly in the Broker VMs page.

###### Warning

* This operation is irreversible, and will make the disk become an integral part of the broker, where disconnecting the disk will result in errors and data loss.

##### 9.1.3.3. Monitor Broker VM using Prometheus

###### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* For more information on Docker, see the Docker website.

##### 9.1.3.4. Collect Broker VM Logs

###### Note

* The Download Logs (<TIMESTAMP>) is only displayed when you've downloaded your logs previously using Generate New Logs.

##### 9.1.3.5. Upgrade Broker VM

###### Important

* After a Broker VM upgrade, your broker may require a reboot to finish installing important updates. A notification about this will be sent to your Cortex XSIAM console Notification Center.

##### 9.1.3.6. Import Broker VM Configuration

###### Important

* This option can only be used on Broker VMs with version 20.0 and later, and is only suitable for importing a configuration of brokers in the same version, or from a broker in an older version to a broker in a newer version.

* If your source Broker VM configuration includes a WEC applet, you'll need to ensure that you update the DNS record of this Broker VM's FQDN to point to the target Broker VM IP address.

##### 9.1.3.7. Open Live Terminal

###### Note

* You can either restart_routes or reboot the Broker VM for the changes in the /etc/network/routes file to take affect.

##### 9.1.3.8. Add Broker VM to cluster

###### Navigation

  Settings → Configurations → Data Broker → Broker VMs

##### 9.1.3.9. Switchover Primary Node in Cluster

###### Navigation

  Settings → Configurations → Data Broker → Broker VMs

##### 9.1.3.10. Remove from Cluster

###### Note

* If you've enabled a Load Balancer Health-Check on the cluster, you need to exclude this Broker VM from your Load Balancer settings.

#### 9.1.4. Manage Broker VM data collector applets

##### Note

* For more information on the Broker VM applet connectivity status, see Manage Broker VM.

#### 9.1.5. Broker VM High Availability Cluster

##### Note

* For Load Balancing, you must install a Load Balancer in your network which will distribute the incoming data between the nodes.

* The Pathfinder applet isn't supported when configuring Broker VMs in HA clusters.

##### 9.1.5.1. Configure High Availability Cluster

###### Prerequisite

* Be sure you do the following tasks before creating a cluster from an existing Broker VM: Since the Pathfinder applet isn't supported when configuring HA clusters, you must ensure Pathfinder is deactivated on the Broker VM. If the Broker VM is explicitly specified in some Agent Settings profile, which mean Cortex XSIAM agents retrieve release upgrades...

###### Important

* You can only create a new cluster from an existing Broker VM, when the Broker VM version is 19.0 and later, and the STATUS is Connected. The Create a Cluster from this Broker option is only listed if the Broker VM is not already added to a cluster.

* When the Protocol is set to HTTPS, you may need to perform a few follow-up steps to establish a validated secure SSL connection with the Broker VM. If you're using your own Certificate Authority (CA) to sign the certificates, you'll need to place the CA in the client, such as the Load Balancer, and upload the certificates to the Broker VM. If you're...

###### Navigation

  Settings → Configurations → Data Broker → Broker VMs

##### 9.1.5.2. Manage Broker VM clusters

###### Navigation

  After you've configured a cluster, you can manage all your Broker VM clusters from the Clusters tab on the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs → Clusters

###### 9.1.5.2.1. View cluster details

####### Note

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

####### Navigation

  The Clusters tab of the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs) enables you

###### 9.1.5.2.2. Edit cluster

####### Navigation

  Settings → Configurations → Data Broker → Broker VMs, and select the Clusters tab

###### 9.1.5.2.3. Add applet to cluster

####### Note

* With Cortex XDR Prevent, it's only relevant to configure a HA cluster with a Local Agent Settings applet as this is the only applet supported for this product license. The other applets are collector applets, which are only available in Cortex XDR Pro or Cortex XSIAM.

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

###### 9.1.5.2.4. Add Broker VM to cluster

####### Navigation

  Settings → Configurations → Data Broker → Broker VMs

###### 9.1.5.2.5. Remove cluster

####### Navigation

  Settings → Configurations → Data Broker → Broker VMs

#### 9.1.6. Broker VM notifications

##### Note

* For more information on upgrading to a new Broker VM image, see Migrating to a New Broker VM Image.

#### 9.1.7. Monitor Broker VM activity

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 9.1.8. Troubleshoot Broker VM applet errors

##### Note

* For more information on creating correlation rules to trigger collection health issues, see How can I set up correlation rules to trigger collection health issues?.

### 9.2. XDR Collectors

#### Note

* Ingestion of log events larger than 5 MB is not supported.

#### 9.2.1. XDR Collector audit logs

#### 9.2.2. XDR Collector machine requirements and supported operating systems

#### 9.2.3. Resources required to enable access to XDR Collectors

##### Note

* Some of the IP addresses required for access are registered in the United States. As a result, some GeoIP databases do not correctly pinpoint the location in which IP addresses are used. All customer data is stored in your deployment region, regardless of the IP address registration and restricts data transmission through any infrastructure to that...

* Throughout this topic, <xsiam-tenant> refers to the chosen subdomain of your Cortex XSIAM tenant and <region> is the region in which your Strata Logging Service is deployed.

#### 9.2.4. Manage XDR Collectors

##### 9.2.4.1. XDR Collectors installation resource for Windows and Linux

###### Note

* In some circumstances, such as after an XDR Collectors upgrade, the configured settings in the XML configuration file can be erased. Yet, this won't affect the saved settings in the XDR Collectors database.

##### 9.2.4.2. Create an XDR Collector installation package

###### Note

* To move existing XDR Collectors between Cortex XSIAM managing servers, you need to first Uninstall the XDR Collector from the collector machine and then for the new XDR Collector create a new installation package.

* Since Cortex XSIAM relies on the installation package ID to approve XDR Collector registration during install, it is not recommended to delete the installation package for any active on-premise collector machines. Hiding the installation package will remove it from the default list of available installation packages, and can be useful to eliminate...

##### 9.2.4.3. Install the XDR Collector installation package for Windows

###### 9.2.4.3.1. Install the XDR Collector on Windows using the MSI

####### Note

* When the package is executed using the MSI, an installation log is generated in %TEMP%\MSI<Random characters>.log by default.

* If the XDR Collector does not connect to Cortex XSIAM, verify your internet connection on the collector machine. If the XDR Collector still does not connect, verify that the installation package has not been removed from the Cortex XSIAM tenant.

###### 9.2.4.3.2. Install the XDR Collector on Windows using Msiexec

##### 9.2.4.4. Install the XDR Collector installation package for Linux

###### Note

* We recommend that you perform a Linux RPM or Linux DEB installation.

* If the XDR Collector does not connect to Cortex XSIAM, verify your Internet connection on the collector machine. If the XDR Collector still does not connect, verify the installation package has not been removed from the Cortex XSIAM management console.

* The XDR Collector does not support proxy communication in environments where proxy authentication is required.

###### Important

* When performing a XDR Collector installation or upgrade in Linux using a shell installer, the  /tmp folder cannot be marked as noexec. Otherwise, the installation or upgrade fails. As a workaround, before the installation or upgrade, use the following command:

##### 9.2.4.5. Configure the XDR Collector upgrade scheduler

###### Navigation

  In Cortex XSIAM, select Settings → Configurations → XDR Collectors → Configuration

##### 9.2.4.6. Set an application proxy for XDR Collectors

###### Navigation

  In Cortex XSIAM, select Settings → Configurations → XDR Collectors → Administration

##### 9.2.4.7. Set an alias for an XDR Collector machine

###### Navigation

  Settings → Configurations → XDR Collectors → Administration

##### 9.2.4.8. Upgrade XDR Collectors

###### Note

* The XDR Collector keeps the name of the original installation package after every upgrade.

##### 9.2.4.9. Uninstall the XDR Collector

###### Navigation

  Settings → Configurations → XDR Collectors → Administration

  Investigation & Response → Response → Action Center

#### 9.2.5. Define XDR Collector machine groups

##### Note

* XDR Collectors only support IPv4 addresses.

* Disconnecting Directory Sync in your Cortex XSIAM deployment can affect existing collector machine groups and policy rules based on Active Directory properties.

#### 9.2.6. About Cortex XDR Collector content updates

#### 9.2.7. XDR Collector profiles

##### 9.2.7.1. Add an XDR Collector profile for Windows

###### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex XSIAM collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex XSIAM supports logs in single line format or multiline format. For more...

###### 9.2.7.1.1. Ingest logs from Windows DHCP using Elasticsearch Filebeat

####### Note

* Although this enrichment is available when configuring a Windows DHCP collector for a cloud data collection integration, we recommend configuring Cortex XSIAM to receive Windows DHCP logs with an XDR Collector Windows Filebeat profile, because it is simpler to set up.

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the template provided by Cortex XSIAM to make your customizations. We recommend that you edit the file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating your...

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the example file provided by Cortex XSIAM to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your filebeat.yml file. Validate the syntax of the YML file before you finish creating...

* The tokenizer definition is dependent on the Windows server version that you are using, because the log format differs. For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%...

###### 9.2.7.1.2. Ingest Windows DNS debug logs using Elasticsearch Filebeat

####### Note

* Detailed logs are significantly larger, because more information is added to the logs.

* To avoid formatting issues in your filebeat.yml file, we recommend that you validate the syntax of the file.

##### 9.2.7.2. Add an XDR Collector profile for Linux

###### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex XSIAM collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex XSIAM supports logs in single line format or multiline format. For more...

#### 9.2.8. Apply profiles to collection machine policies

##### Navigation

  Settings → Configurations → XDR Collectors → Policies → +Add Policy

#### 9.2.9. XDR Collector datasets

### 9.3. Data Collection

#### 9.3.1. Visibility of logs and issues from external sources

##### License Type

  Data collection may require an add-on.

##### Note

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs.

* Logs with sessionid = 0 are dropped.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. IOCs and BIOCs are only generated for these event types: sso and session_start.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. Analytics, IOCs and BIOCs are only generated on the Firewall data. The Zscaler Nanolog Streaming Service (NSS) feed for web logs is only used for Correlation Rules and threat hunting.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. The Zscaler Nanolog Streaming Service (NSS) feed for web logs is only used for Correlation Rules and threat hunting.

#### 9.3.2. Visibility of Cortex XSIAM audit and authentication logs

##### Note

* Cortex XSIAM can create Cortex XSIAM issues (Analytics, IOC, BIOC, and Correlation Rules) when relevant from logs.

#### 9.3.3. External data ingestion vendor support

##### License Type

  Data collection may require an add-on.

#### 9.3.4. Manage instances

##### 9.3.4.1. Add a new data source or instance

###### Note

* If a data source contains multiple integrations, the integration configured as the default integration will used by the Data Onboarder. The default integration of the content pack is indicated in each content pack's documentation. The other integrations are available for configuration in the Automation and Feed Integrations page after installing the...

* If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant page in the system, for example Correlations, Playbooks, or Scripts. If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant...

##### 9.3.4.2. How to configure the scanning settings for supported services

###### Note

* All the asset types are selected by default. When you deselect a data asset type, it is not included when the system runs the next scan operation, reducing the total scan time.

##### 9.3.4.3. Manage cloud instances

###### Note

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

##### 9.3.4.4. Update cloud permissions after Cortex release updates

###### Prerequisite

* Ensure that the user account used to modify permissions has the necessary privileges within both the Cortex platform and your cloud environment, for example, AWS or Azure. You received a notification regarding a new version available that requires permission updates, or viewed a Needs Update status in the Data Sources page.

###### Note

* Instances requiring updates will not change their connection status, for example, Connected, Warning, Error, Disabled, due to the pending permission update.

##### 9.3.4.5. Pending cloud instances

##### 9.3.4.6. Troubleshoot errors on cloud instances

###### Note

* Errors related to collection of audit logs in the cloud instance are recorded in the collection_auditing dataset. For more information, see Audit logs fields and query examples.

#### 9.3.5. Palo Alto Networks integrations

##### License Type

  Data collection may require an add-on.

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

##### 9.3.5.1. About Palo Alto Networks integrations

###### Note

* For Palo Alto Networks Integrations there is an option to turn on or off the collection of URL and File log types. For more information, see Collecting URL and File log types.

* Roll-back of Strata Logging Service integration migration is not supported.

##### 9.3.5.2. Ingest data from Next-Generation Firewall

###### Prerequisite

* Ensure that you have completed the following on the NGFW or Panorama side: For Panorama only, ensure that the Panorama Cloud Services plugin is installed. Enable log forwarding profiles on firewall rules. On the Cortex XSIAM side, ensure that you have user role permissions for Data Collection > Data Sources. Configuration of data ingestion from...

###### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* If your firewalls are located in a different region, or bandwidth issues are encountered due to large log size, you can ingest NGFW logs in CEF format, using the Syslog collector. However, the Syslog solution is not as powerful nor as comprehensive as this data collector, and should only be used when this data collector cannot be used. For more...

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version.

* Cortex XSIAM does not validate your firewall credentials, you must ensure the certificates or PSK details have been updated in your firewalls in order for data to stream.

* It might take an hour or longer after connecting the firewall in Cortex XSIAM until you start seeing notifications that the certificate has been approved, and that the logging service license has appeared on the firewall.

* IOC and BIOC issues are applicable on stitched data only, and are not available on raw data.

###### Tip

* You can see an overview of ingestion status for all log types, and a breakdown of each log type and its daily consumption quota on the NGFW Ingestion Dashboard.

###### 9.3.5.2.1. Ingest Next-Generation Firewall logs using the Syslog collector

####### Note

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version, to ensure that you have configured log forwarding correctly for all the log types that you would like to forward to Cortex XSIAM. The following steps only cover...

* To avoid the possible effects of line formatting, do not copy/paste the message formats directly into the PAN-OS web interface. Instead, paste into a text editor, remove any carriage return or line feed characters, and then copy and paste into the web interface.

* From version 10.0 and later, the log format documented for log types (Traffic, Threat, and URL) exceeds the maximum supported 2048 characters in the Custom Log Format tab on the firewall and Panorama. Select the CEF keys and values to limit the number of characters to 2048, as per your requirements.

##### 9.3.5.3. Ingest data from Prisma Access

###### Prerequisite

* Configuration of data ingestion from multiple accounts requires Super User permissions in both Cortex XSIAM tenant and Prisma Access accounts.

###### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* Cortex XSIAM does not validate your Prisma Access account credentials. You must ensure the account has been deployed in order for data to stream.

##### 9.3.5.4. Ingest logs from Prisma Access Browser

##### 9.3.5.5. Ingest detection data from Strata Logging Service

###### Note

* IOC and BIOC issues are applicable on stitched data only and are not available on raw data.

##### 9.3.5.6. Ingest alerts and assets from IoT Security

##### 9.3.5.7. Collecting URL and File log types

###### 9.3.5.7.1. Detectors connected to URL and File log types

#### 9.3.6. External data ingestion

##### 9.3.6.1. External applications

##### 9.3.6.2. Ingest network connection logs

###### 9.3.6.2.1. Ingest network flow logs from Amazon S3

####### Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* To create a new VPC, click Launch VPC Wizard. For more information, see AWS VPC Flow Logs.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex XSIAM.

####### 9.3.6.2.1.1. Create an assumed role

######## Note

* In AWS this is an optional field to configure, but this must be configured to set up the Amazon S3 Collector in Cortex XSIAM .

* The <s3-arn> and <sqs-arn> placeholders. These will be filled out later depending on which Amazon S3 logs you are configuring, including network flow logs, audit logs, or generic logs.

####### 9.3.6.2.1.2. Configure data collection from Amazon S3 manually

######## License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

######## Note

* If you already have an Amazon S3 bucket configured with VPC flow logs that you want to use for this configuration, you do not need to perform the prerequisite steps detailed in the first two bullets.

* It is your responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* If you already have an Amazon S3 bucket configured with VPC flow logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

###### 9.3.6.2.2. Ingest network Route 53 logs from Amazon S3

####### Note

* For more information on configuring data collection from Amazon S3 for Route 53 DNS logs, see the AWS Documentation.

* For more information on creating a Stack, see Creating a stack on the AWS CloudFormation console.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex XSIAM.

###### 9.3.6.2.3. Ingest logs from Check Point firewalls

####### Note

* Logs with sessionid = 0 are dropped. Destination Port data is available only in the raw logs.

###### 9.3.6.2.4. Ingest logs from Cisco ASA firewalls and AnyConnect

###### 9.3.6.2.5. Ingest logs from Corelight Zeek

###### 9.3.6.2.6. Ingest logs from Fortinet Fortigate firewalls

###### 9.3.6.2.7. Ingest logs from Microsoft Azure Event Hub

####### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

####### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

####### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

###### 9.3.6.2.8. Ingest network flow logs from Microsoft Azure Network Watcher

####### Prerequisite

* For NSG:    Ensure that your NSG flow logs in Azure Network Watcher conform to the requirements as outlined in Microsoft documentation. For more information, see Introduction to flow logging for network security groups.   Enable NSG flow logs in the Microsoft Azure Portal. For NSG: Ensure that your NSG flow logs in Azure Network Watcher conform to the...

####### Note

* In addition to your storage account, the template automatically creates another storage account that is required by the function app for internal use only. The internal storage account name is prefixed with cortex and is followed by a unique suffix based on the resource group, storage account, and container names.

###### 9.3.6.2.9. Ingest logs and data from Okta

###### 9.3.6.2.10. Ingest logs from Windows DHCP using Elasticsearch Filebeat

####### Note

* To avoid formatting issues in filebeat.yml, we recommend that you edit the text file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating the profile.

* For more information on configuring the filebeat.yml file, see the Elastic Filebeat Documentation.

* To avoid formatting issues in your filebeat.yml, we recommend that you use the download example file to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your file.

* The tokenizer definition is dependent on the Windows server version that you are using as the log format differs. -For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" -For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{mac...

###### 9.3.6.2.11. Ingest logs from Zscaler Internet Access

###### 9.3.6.2.12. Ingest logs from Zscaler Private Access

####### Note

* For more information on configuring the parameters on the screen, see the Zscaler Private Access (ZPA) documentation for Configuring a Log Receiver.

* You can only configure a ZPA log receiver to collect one type of log with your Syslog Collector in Cortex XSIAM. To configure more that one log type, you'll need to add another log receiver.

##### 9.3.6.3. Ingest authentication logs and data

###### 9.3.6.3.1. Ingest audit logs from AWS Cloud Trail

####### Note

* For more information on configuring data collection from Amazon S3 using AWS CloudTrail, see the AWS CloudTrail Documentation.

* For more information on creating an AWS CloudTrail trail, see Create a trail. If you already have an Amazon S3 bucket configured with AWS CloudTrail audit logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* It is your organization's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* The CloudWatch Logs - optional settings are not supported and should be left disabled.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It your organization's responsibility to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

###### 9.3.6.3.2. Ingest logs and data from a GCP Pub/Sub

####### Note

* When collecting flow logs, we recommend that you include GKE annotations in your logs, which enable you to view the names of the containers that communicated with each other. GKE annotations are only included in logs if appended manually using the custom metadata configuration in GCP. For more information, see VPC Flow Logs Overview. In addition, to...

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the GCP data collector settings. Yet, when the values are blank in the...

###### 9.3.6.3.3. Ingest logs and data from Google Workspace

####### Note

* For all types of data collected via the Admin Reports API, except alerts and emails, the log events are collected with a preset lag time as reported by Google Workspace. For more information on these lag times for the different types of data, see Google Workspace Data retention and lag times.

* Spam emails from the compliance email account, and from all other monitored email accounts, are not collected. Any draft emails written in the compliance email account are collected by the Google Workspace data collector, and are then deleted even if the email was never sent.

* For more information on the entire process, see Perform Google Workspace Domain-Wide Delegation of Authority.

* When collecting Google Workspace alerts with other types of data, except emails, you need to configure a service account in Google with the applicable permissions to collect events from the Google Reports API and alerts from the Alert Center API. If you prefer to use different service accounts to collect events and alerts separately, you'll need to...

* For more information on the Admin Reports API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information on the Gmail API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information about the events collected from the various Google Reports, see Google Workspace Reports API Documentation.

###### 9.3.6.3.4. Ingest logs from Microsoft Azure Event Hub

####### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

####### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

####### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

###### 9.3.6.3.5. Ingest logs from Microsoft Office 365

####### Note

* Ingesting Microsoft Entra ID (formerly known as Azure AD) authentication and audit events from Microsoft Graph API requires a Microsoft Azure Premium 1 or Premium 2 license. Alternatively, if the directory type is Azure AD B2C, the sign-in reports are accessible through the API without any additional license requirement. To ingest email logs and data...

* When auditing is turned off from the default setting, you need to first turn on auditing for your organization to collect Microsoft Office 365 audit events from the Management Activity API. Log duplication of up to 5% in Microsoft products is considered normal. In some cases, such as login to a portal using MFA, two log entries are recorded by design.

* To address Azure reporting latency, there is a 10-minute latency period for Cortex XSIAM to receive Azure AD logs.

* You can also implement the corresponding Cortex Data Model (XDM) mappings for these Microsoft Graph Security API v2 alerts using Cortex Marketplace via the Microsoft Graph Security content pack.

* For more information, see the Office 365 Management Activity API schema.

* In FedRAMP environments, Azure sign-in logs are not supported, due to vendor technical constraints.

* Use this option when you don't want to grant permissions for Azure AD Authentication and Azure AD Audit.

###### 9.3.6.3.6. Ingest logs and data from Microsoft 365

####### License Type

  Email data: The subject, body, and attachments are visible only with an Email Security module license.

####### Prerequisite

* A user account with the Microsoft Azure Account Administrator role is required to set up a new Microsoft 365 email collector. The following Microsoft Graph API permissions are required:    Mailbox access (read-write)    Read and write mail in all mailboxes   Read contacts in all mailboxes   Read all user mailbox settings      User information, groups,...

####### Note

* For other logs from Microsoft Office 365, use the Office 365 data collector. For more information, see Ingest logs from Microsoft Office 365.

###### 9.3.6.3.7. Ingest logs and data from Okta

###### 9.3.6.3.8. Ingest logs and data from OneLogin

####### Note

* Event data is collected every 30 seconds.

* Inventory data snapshots are collected every 10 minutes.

###### 9.3.6.3.9. Ingest authentication logs from PingFederate

###### 9.3.6.3.10. Ingest authentication logs and data from PingOne

####### Navigation

  Reporting → Subscriptions → Add Subscription

##### 9.3.6.4. Ingest operation and system logs from cloud providers

###### 9.3.6.4.1. Ingest generic logs from Amazon S3

####### License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

####### Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* You need to set up an Amazon S3 data collector to receive generic logs when collecting logs from BeyondTrust Privilege Management Cloud. For more information, see Ingest logs from BeyondTrust Privilege Management Cloud.

* If you want to ingest raw EDR events from SentinelOne DeepVisibility, use the SentinelOne DeepVisibility log collector. For more information, see Ingest raw EDR events from SentinelOne DeepVisibility.

* It is the customer's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It is the responsibility of your organization to ensure that the user who performs this task of creating the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor...

###### 9.3.6.4.2. Ingest logs from Amazon CloudWatch

###### 9.3.6.4.3. Ingest logs and data from a GCP Pub/Sub

####### Note

* When collecting flow logs, we recommend that you include GKE annotations in your logs, which enable you to view the names of the containers that communicated with each other. GKE annotations are only included in logs if appended manually using the custom metadata configuration in GCP. For more information, see VPC Flow Logs Overview. In addition, to...

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the GCP data collector settings. Yet, when the values are blank in the...

###### 9.3.6.4.4. Ingest logs from Google Kubernetes Engine

####### Note

* Cortex XSIAM supports logs in single line format or multiline format. For more information on handling messages that span multiple lines of text in Elasticsearch Filebeat, see Manage Multiline Messages.

###### 9.3.6.4.5. Ingest logs from Microsoft Azure Event Hub

####### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

####### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

####### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

###### 9.3.6.4.6. Ingest logs and data from Okta

##### 9.3.6.5. Ingest endpoint data

###### 9.3.6.5.1. Ingest alerts and metadata from CrowdStrike APIs

####### Note

* To enable some of the APIs, you may need to reach out to CrowdStrike support.

* For more information on configuring data collection from CrowdStrike APIs, see the CrowdStrike Documentation.

* Ensure that you save the SECRET value because this is the only time that it is displayed.

###### 9.3.6.5.2. Ingest raw EDR events from CrowdStrike Falcon Data Replicator

####### Prerequisite

* Ensure that your organization has a license for the CrowdStrike Falcon Data Replicator (FDR). Ensure that CrowdStrike FDR is enabled. CrowdStrike FDR can only be enabled by CrowdStrike Support. If CrowdStrike FDR is not enabled, submit a support ticket through the CrowdStrike support portal. Follow these steps to check if CrowdStrike FDR is...

####### Note

* Due to limitations with the S3 bucket used by CrowdStrike, data can only be collected once, by one system.

* For more information on configuring data collection from CrowdStrike via Falcon Data Replicator, see CrowdStrike documentation.

* Ensure that you copy the Secret, and store it in a safe place. You will not be able to retrieve it later. If you need a new secret, you must reset the feed credentials.

* CrowdStrike Falcon Data Replicator only supports one FDR credential configuration.

* Ensure that you save the SECRET value, because this is the only time that it is displayed. You can go back to this page later to copy the other credentials, but you will not have access to the secret again.

###### 9.3.6.5.3. Ingest raw EDR events from Microsoft Defender for Endpoint

####### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection. Create an Azure Event Hub. For more information, see Quickstart: Create an event hub using Azure portal.    Create a resource group (optional if you already have a resource group configured).   Create an Event Hubs namespace.   Create an event hub within the namespace....

####### Note

* The generic Cortex XSIAM Azure Event Hub collector does not offer full functionality for EDR data (such as stitching), and is therefore not suitable for EDR data ingestion.

* If you select all event types and leave Event-Hub name empty, an event hub will be created for each category in the selected namespace. If you are not using a Dedicated Event Hubs ClusterEvent Hub, namespaces have a limit of 10 Event Hubs.

###### 9.3.6.5.4. Ingest raw EDR events from SentinelOne DeepVisibility

####### Prerequisite

* The SentinelOne DeepVisibility logs that will be collected by your dedicated Amazon S3 bucket must adhere to the following guidelines:    Each log file must use the 1 log per line format as multi-line format is not supported.   The log format must be compressed as gzip or uncompressed.   For best performance, we recommend limiting each file size to up...

####### Note

* It is your responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule on the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If you receive an error when trying to save your changes, check that the permissions are set up correctly, and fix them if necessary.

* It is the responsibility of your organization to ensure that the user who creates the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors.

* For more information, see Managing access keys for IAM users.

##### 9.3.6.6. Ingest cloud assets

###### Note

* The cloud accounts being onboarded must be owned by the customer performing the onboarding process.

###### 9.3.6.6.1. Onboard Amazon Web Services

####### License Type

  This feature is included in Cortex XSIAM Enterprise+ with the Data Collection add-on.

####### Prerequisite

* Before you begin, ensure you have: Access to AWS Management Console Required AWS permissions

####### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* When onboarding an AWS organization or organizational unit (OU), Cortex XSIAM creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

* See the prerequisites above for specific permissions required for serverless functions.

* If you select Automated, you must already be logged in to AWS.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

####### 9.3.6.6.1.1. Manually upload template to AWS

######## Prerequisite

* Before you begin, ensure you have: An AWS account Access to AWS Management Console Permission to create a stack and its resources in AWS CloudFormation

###### 9.3.6.6.2. Onboard Google Cloud Platform

####### License Type

  This feature is included in Cortex XSIAM Enterprise+ with the Data Collection add-on.

####### Prerequisite

* Before you begin, ensure you have: Access to Google Cloud Console Admin user with required admin GCP permissions Enabled the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled) Enabled the following APIs in the GCP project you are...

####### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

####### 9.3.6.6.2.1. Manually upload template to GCP

######## Prerequisite

* Before you begin, ensure you have: A GCP account. Permission to create the required resources in Google Cloud Deployment Manager. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool.

######## Note

* The directory you create must be a subdirectory of the home directory.

####### 9.3.6.6.2.2. Monitor GCP resources inside service perimeters

######## Note

* Each GCP cloud instance is assigned a scope within GCP. If the scope, whether it be organization, folder, or project, includes any projects with a service perimeter, this procedure must be performed for that cloud instance to authorize Cortex XSIAM to scan the resources in the perimeter.

###### 9.3.6.6.3. Onboard Microsoft Azure

####### License Type

  This feature is included in Cortex XSIAM Enterprise+ with the Data Collection add-on.

####### Prerequisite

* Before you begin, ensure you have: An Azure subscription Admin permissions required to onboard Azure or the built-in Security Administrator role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups.

####### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

####### 9.3.6.6.3.1. Manually upload template to Microsoft Azure Resource Manager using the CLI

######## Prerequisite

* Ensure the Azure CLI tool is installed and you are authorized to create management group policies.

####### 9.3.6.6.3.2. Manually upload template for Microsoft Azure subscriptions

######## Prerequisite

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the subscription scope. We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed Terraform on your local machine. You can download Terraform from the official...

* Ensure the Azure CLI tool is installed and you are authorized to create management group policies.

###### 9.3.6.6.4. Onboard Oracle Cloud Infrastructure

####### License Type

  This feature is included in Cortex XSIAM Enterprise+ with the Data Collection add-on.

####### Prerequisite

* Before you begin, ensure you have: Access to Oracle Cloud Infrastructure console Permissions for all of the following are required:    Creation of identity groups (for more information, refer to Managing Groups)   Policies (for more information, refer to How Policies Work)   Tag namespaces in the root compartment (for more information, refer to Tags...

####### Note

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only; you can only modify the instance from the Data Sources page.

####### 9.3.6.6.4.1. Manually upload template to OCI

######## Prerequisite

* Before you begin, ensure you have: An Oracle Cloud Infrastructure account and the tenancy OCID. Permission to deploy a custom template and create its resources in OCI. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed...

###### 9.3.6.6.5. What is the Discovery Engine?

####### License Type

  Requires the Requires the Data Collection add-on.

###### 9.3.6.6.6. Configure AWS integration instances and monitor integration instance health

####### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

###### 9.3.6.6.7. Manually connect a cloud instance

###### 9.3.6.6.8. Outposts

####### Prerequisite

* Before you begin, ensure you have: An AWS account Permission to create a stack and its resources in AWS Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the AWS CLI tool and configured your profile with the aws...

* Before you begin, ensure you have: A GCP account Permission to create the required resources in Google Cloud Deployment Manager Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool

* Before you begin, ensure you have: An active Azure subscription. Installed the Azure CLI tool. Permission to deploy a custom template and create its resources in Microsoft Azure ("Owner" or "Contributor" on the designated outpost subscription scope, and Active Directory "Cloud Application Administrator" or "Application Administrator" privileged...

####### Note

* We recommend you use a dedicated account for the outpost, free from other resources. You can only onboard one outpost for each account.

* When creating an outpost for a specific Azure subscription, the outpost account must be in the same Azure organization as the monitored subscriptions.

####### Navigation

  Settings → Data Collection → Outposts

  You can create a new outpost by navigating to Settings → Data Collection → Outposts and clicking New Outpost

###### 9.3.6.6.9. Container Registry Scanning

####### 9.3.6.6.9.1. Overview of container registry scanning

######## 9.3.6.6.9.1.1. Registry Components

######## 9.3.6.6.9.1.2. How Container Registry Scanning Works

####### 9.3.6.6.9.2. Configure registry scanning

######## Prerequisite

* Ensure that you have performed the all steps till Additional Security Capabilities as listed in the onboarding wizard for the required CSP: Onboard Amazon Web Services Onboard Google Cloud Platform Onboard Microsoft Azure

####### 9.3.6.6.9.3. Modify the container registry scanning scope

####### 9.3.6.6.9.4. Scan re-evaluation process

####### 9.3.6.6.9.5. Connect Docker V2 compliant container registry

######## Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

######## Note

* Scanning is supported only for private repositories on Docker Hub.

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* FedRAMP is not supported for this mode.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

######## 9.3.6.6.9.5.1. Manage a Docker V2 connector

####### 9.3.6.6.9.6. Connect JFrog container registry

######## Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

######## Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

######## 9.3.6.6.9.6.1. Manage a JFrog connector

###### 9.3.6.6.10. Cloud service provider permissions

####### 9.3.6.6.10.1. Amazon Web Services provider permissions

####### 9.3.6.6.10.2. Google Cloud Platform provider permissions

####### 9.3.6.6.10.3. Microsoft Azure provider permissions

####### 9.3.6.6.10.4. Oracle Cloud Infrastructure provider permissions

##### 9.3.6.7. Ingest data from third-party pipeline solutions

###### 9.3.6.7.1. Ingest data from Cribl

####### Prerequisite

* Ensure that you have the credentials and IDs for each data source, such as Tenant ID, App ID and Client secret.

* Ensure that you have the copies of the Cortex XSIAM authorization token and API URL obtained in Task 2.

####### Note

* We do not support email data collection via Cribl.

* Only one Cribl data collector instance can be configured in Cortex XSIAM.

####### 9.3.6.7.1.1. Data source UUIDs

######## Note

* Do not use this generic UUID when your data source is listed in this table.

##### 9.3.6.8. Additional log ingestion methods

###### 9.3.6.8.1. Ingest logs from a Syslog receiver

###### 9.3.6.8.2. Ingest Apache Kafka events as datasets

###### 9.3.6.8.3. Ingest CSV files as datasets

###### 9.3.6.8.4. Ingest database data as datasets

###### 9.3.6.8.5. Ingest logs in a network share as datasets

####### Note

* The Files and Folders Collector applet only starts to collect files that are more than 256 bytes.

###### 9.3.6.8.6. Ingest FTP files as datasets

###### 9.3.6.8.7. Ingest NetFlow flow records as datasets

###### 9.3.6.8.8. Set up an HTTP log collector to receive logs

####### Note

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor...

* Each record cannot exceed 5 MB in size.

###### 9.3.6.8.9. Ingest logs from BeyondTrust Privilege Management Cloud

####### Note

* For a Log Format set to Beyondtrust Cloud ECS, the following fields are automatically set and not configurable. Vendor: Beyondtrust Product: Privilege Management Compression: Uncompressed

###### 9.3.6.8.10. Ingest logs and data from Box

####### Prerequisite

* Set up an Enterprise Box plan.  Important To collect Box Shield Alerts, you must purchase Box Shield and it must be enabled on Box enterprise. Set up an Enterprise Box plan. Create a valid Box account that is assigned to a role with sufficient permissions for the data you want to collect. For example, create an account assigned to an Admin role to...

####### Note

* The Fetch Intervals are non-configurable.

* Collecting Box Shield Alerts requires implementing Box Shield,

* There is a current bug with the Groups API from Box. If you don't configure the Box app with the proper permissions for managing groups data, the Groups API from Box won't return an error message to Cortex XSIAM indicating that the API failed to receive the data, and the Groups data will not be collected.

* For any future change that you make to your Box app, ensure that you send the changes for approval to the administrator, who will need to approve them as explained above.

* Inventory data snapshots are collected every 10 minutes.

###### 9.3.6.8.11. Ingest logs and data from Dropbox

####### Prerequisite

* Set up an Advanced Dropbox plan. Create a Dropbox Business admin account with Security admin permissions, which is required to authorize Cortex XSIAM to access the Dropbox Business account and generate the OAuth 2.0 access token.

####### Note

* The Fetch Interval is non-configurable.

* When the App Key field is empty, the here link in the tooltip is disabled. When an incorrect App Key is entered, clicking the link results in a 404 error.

* Whenever you change the permissions of the Dropbox app, we recommend that you generate a new Access Code for the Dropbox data collector instance so that the permissions match the updates.

* Event data is collected every 60 seconds with a 10 minute lag time.

* Inventory data snapshots are collected every 10 minutes.

###### 9.3.6.8.12. Ingest logs from Elasticsearch Filebeat

####### Navigation

  You can return to the Settings → Configurations → Data Collection → Data Sources page to monitor the status of your Filebeat configuration

###### 9.3.6.8.13. Ingest logs from Forcepoint DLP

###### 9.3.6.8.14. Ingest logs from Proofpoint Targeted Attack Protection

###### 9.3.6.8.15. Ingest logs and data from Salesforce.com

####### Prerequisite

* Cortex XSIAM:    To manage collection integration in Cortex XSIAM, ensure that you have the privilege to View/Edit Log Collections (for example, Instance Administrator). Cortex XSIAM: To manage collection integration in Cortex XSIAM, ensure that you have the privilege to View/Edit Log Collections (for example, Instance...

####### Note

* For more detailed reference information, see Configure a Connected App for the OAuth 2.0 Client Credentials Flow. Unlike other data collector setups, in this case, the setup includes obtaining an OAuth 2.0 code from Salesforce.com, and this code is only valid for 15 minutes. Therefore, make sure that you enable the data collector within 15 minutes of...

* When these options are cleared, only these data types will be omitted from collection. All other data will be collected as usual.

###### 9.3.6.8.16. Ingest data from ServiceNow CMDB

###### 9.3.6.8.17. Ingest report data from Workday

####### Prerequisite

* Create an Integration System User that is designated to access the custom report from Workday for data collection in Cortex XSIAM. Create an Integration System Security Group for the Integration System User created in Step 1 for accessing the report. When setting this group ensure to define the following:    Type of Tenanted Security Group: Select...

####### Note

* Any user with permissions to view issues and cases can view the Workday data.

* For more information on completing any of the prerequisite steps, see the Workday documentation.

* The Business Object changes depending on the Data Source selected.

* Cortex XSIAM uses a structured schema when integrating Workday data. To get the best Analytics results, specify all the fields marked with an asterisk from the recommended schema. workday_user_id* full_name* workday_manager_user_id* manager* worker_type* position_title* department* private_email_address* business_email_address* employment_start_date* em...

###### 9.3.6.8.18. Ingest external alerts

####### Note

* If you send pre-parsed alerts using the Cortex XSIAM API, additional mapping is not required.

####### Navigation

  In Cortex XSIAM, select Settings → Configurations → Data Collection → External Issue Mapping

#### 9.3.7. Automation and feed integrations

##### Note

* Some integrations can be downloaded directly without having to initially download a content pack from Marketplace. For more information, see Define data sources. In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as...

* If the integration was installed from a content pack, you need to duplicate the integration before editing.

* If the integration was installed from a content pack, you need to duplicate the integration before downloading.

* Integration commands are only available when the integration instance is enabled. Some commands depend on a successful connection between Cortex XSIAM and third-party integrations.

##### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

##### 9.3.7.1. Integration use cases

##### 9.3.7.2. Add an integration instance

###### Note

* This procedure describes how to add an integration instance from the Automation and Feed Integration page. Some integration instances can also be configured on the Data Sources page. For more information, see Add a new data source or instance.

* In some integrations, a classifier, an issue type, and mapper fields are included.

###### Navigation

  Settings → Configurations → Data Collection → Automation & Feed Integrations and search for the integration

##### 9.3.7.3. Configure integration permissions

###### Navigation

  Settings → Configurations → Data Collection → Integration Permissions

##### 9.3.7.4. Fetch issues from an integration instance

###### Note

* In some integrations, the Issue Fetch interval is called Feed Fetch Interval. If the integration instance does not have the Issue Fetch Interval field, you need to add this field by editing the integration settings. If the integration is from a content pack, you need to create a copy of the integration. Any future updates to this integration will not...

* Some content packs include preconfigured correlation rules, but you should review them to see if they suit your use case and duplicate them if required. Go to Threat Management → Detection Rules → Correlations, search for the relevant rule, right-click, and select Preview Rule. For example, the ServiceNow v2 Alerts (automatically generated)...

###### 9.3.7.4.1. Map fields to issue types

####### Note

* In the Classification & Mapping page, the mapping does not indicate for which issue types they are configured. Therefore, when creating a mapper, it is best practice to add to the mapper name, the issue types the mapper is for. For example, Mail Listener - Phishing.

* When mapping a list, we recommend you map to a multi select field. Short text fields do not support lists. If you do need to map a list to a short text field, add a transformer in the relevant playbook task, to split the data back into a list.

####### Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

  Settings → Configurations → Data Collection → Automation & Feed Integrations

###### 9.3.7.4.2. Classify events using a classifier for issue types

####### Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

  Settings → Configurations → Data Collection → Automation & Feed Integrations

##### 9.3.7.5. Troubleshoot Integrations

##### 9.3.7.6. Forward Requests to Long-Running Integrations

###### Note

* This integration replaces the External Dynamic list integration, which is deprecated. For more information about how to set up the integration, see Manage external dynamic lists.

* When running on the tenant, you can only use long-running integrations provided by Cortex XSIAM, you cannot create custom ones. Custom long-running integrations are supported only on engines at this time. Configuring custom certificates or private API Keys in the long-running integration instance is supported only on engines, not on the Cortex XSIAM...

* For the TAXII Server and TAXII2 Server integrations, the xdr string is automatically replaced by crtx. For the Microsoft Teams integration, you can use the microsoft-teams-create-messaging-endpoint command to get the correct messaging endpoint based on the server URL, the server version, and the instance configurations. For more information, see...

#### 9.3.8. Verify collector connectivity

##### Note

* For more information on troubleshooting data collector applet errors, see Troubleshoot Broker VM applet connectivity.

* If an issue is triggered, the investigation options in the right-click menu of the Health Issues pages are context-specific. Make sure that you specify the relevant issue category.

#### 9.3.9. Overview of data ingestion metrics

##### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics. Data Ingestion Monitoring: Go to Configurations → General → Server...

##### 9.3.9.1. Creating correlation rules to monitor data ingestion health

##### 9.3.9.2. Measuring data freshness

###### Note

* The max_delay metric is taken from the maximum bucket value with a restricted limit; therefore, metrics show whole numbers. The median and ninetieth_percentile metrics are statistical calculations that give an approximation of the real value; therefore, metrics show decimal numbers. Time slots with a zero log count or zero byte count display records...

#### 9.3.10. About health issues

##### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics. Data Ingestion Monitoring: Go to Configurations → General → Server...

##### Note

* The Health Issues page displays issues that were triggered after July 2024. To see health issues that were triggered before this date, click Legacy Health Issues.

* Cortex XSIAM enforces the dedup logic to health issues. This logic reduces the likelihood of identical health issues from flooding the issues dataset.

##### 9.3.10.1. Investigate and resolve health issues

##### 9.3.10.2. Monitor data ingestion health

###### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable Data Ingestion Monitoring in your Server Settings. For more information, see Set up your environment.

##### 9.3.10.3. Monitor correlation rules

###### Note

* In the dataset, the Query start time and Query end time indicate the timeframe of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

### 9.4. Dataset management

#### License Type

  Managing Roles requires an Account Admin or Instance Administrator role. For more information, see Predefined user roles.

#### Note

* Cold storage, in addition to a cold storage license, requires compute units (CU) to run cold storage queries. For more information on CU, see Manage compute units. For information on the CU add-on license, see Understand the Cortex XSIAM license planUnderstand the Cortex XSIAM license plan.

* Only datasets that are already handled as part of the GB license are supported for this license. In addition, the retention configuration is only available in Cortex XSIAM, as opposed to the public APIs.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default. Datasets include dataset permission enforcements in the Cortex Query Language(XQL), Query Center, and XQL Widgets. For example, to view or access any of the endpoints and host_inventory datasets, you need role-based access control (RBAC)...

* You'll only be able to save the dataset view if the query contains no errors; otherwise, the Save button is disabled.

* For more information on user roles, see Manage user roles.

#### Important

* Cortex XSIAM enforces retention on all log-type datasets excluding Host Inventory, Vulnerability Assessment, Metrics, and Users.

* This column is updated once a day. Therefore, if the dataset was created or updated by the target or lookup flows, it's possible that the Last Updated value is a day behind when the queries or reports were run as it was before this column was updated.

#### 9.4.1. What are datasets?

##### Note

* For more information on tasks specific to lookup datasets, see Lookup datasets.

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

##### Important

* By default, forensic datasets are not included in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

#### 9.4.2. Lookup datasets

##### Note

* A lookup dataset can only be deleted if there are no other dependencies. For example, if a Correlation Rule is based on a lookup dataset, you wouldn't be able to delete the lookup dataset until you removed the dataset from the XQL query of the Correlation Rule.

##### 9.4.2.1. Import a lookup dataset

###### Prerequisite

* When uploading a CSV, TSV, or JSON file, ensure that the file meets the following requirements: The maximum size for the total data to be imported into a lookup dataset is 30 MB from the Dataset Management page. Otherwise, the limit is 50 MB using Cortex Query Language (XQL) or APIs. Field names can contain characters from different languages, special...

###### Important

* The name of a dataset created from a TSV file must always include the extension. For example, if the original file name is mrkdptusrsnov23.tsv, you can save the dataset with the name marketing_dept_users_Nov_2023.tsv.

##### 9.4.2.2. Download JSON file of lookup dataset

###### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

##### 9.4.2.3. Set time to live for lookup datasets

###### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

#### 9.4.3. Monitor datasets and dataset views activity

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

### 9.5. Archived data

#### 9.5.1. Import historical data into cold storage

##### License Type

  Importing historical data into cold storage requires a Period-Based Retention - Cold Storage add-on license.

##### Prerequisite

* Importing historical data into cold storage requires a View/Edit RBAC permission for Data Management (under Configurations).

#### 9.5.2. Building XQL archived data queries

##### Prerequisite

* Archived cold storage, in addition to a Period-Based Retention - Cold Storage add-on license, requires compute units (CU) to run archived cold storage queries. Cortex XSIAM provides a free daily quota of compute units (CU) allocated according to your license size. Queries run without enough quota will fail. To expand your investigation capabilities,...

#### 9.5.3. Success and failure code responses to your HTTP POST requests

### 9.6. Parsing Rules

#### 9.6.1. What are Parsing Rules?

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

#### 9.6.2. Parsing Rules editor views

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

#### 9.6.3. Parsing Rules file structure and syntax

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Cortex XQL Language Reference.

* An inner type of join stage is only supported in CONST, INGEST, and RULE sections and is not supported in a COLLECT section. You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

* The regexcapture function is only supported in Parsing Rules and cannot be used in any other XQL query.

* Every statement in the Parsing Rules file must end with a semicolon (;).

##### 9.6.3.1. INGEST

###### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* You can't add tags to parsing rules using the Next-Generation Firewall (NGFW) datasets that are in the format panw_ngfw_<text>_raw, and the Observability dataset called panw_observability_raw.

##### 9.6.3.2. COLLECT

###### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

###### Note

* The CSV Collector applet is not affected by the COLLECT rules applied to a Broker VM.

###### Tip

* To reduce the amount of data transmitted to Cortex XSIAM from the broker, use filters to drop logs. Yet, be aware that once the logs are modified using alter or fields stages, the Broker VM will convert the original log into a JSON format, which could increase the data size being sent from the broker to Cortex XSIAM.

##### 9.6.3.3. CONST

###### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

###### Note

* The dollar sign ($) must be adjacent to the [CONST] name, without any whitespace in between.

###### Important

* Only quoted or integer terminal values are considered valid for CONST sections.

##### 9.6.3.4. RULE

###### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Get started with XQL.

* You can also add tags using only the INGEST section. For more information, see INGEST.

##### 9.6.3.5. EXTEND

###### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Get started with XQL.

#### 9.6.4. Create Parsing Rules

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* You need Cortex XSIAM administrator or Instance Administrator permissions to access the Simulate view and perform these tests.

#### 9.6.5. Troubleshooting Parsing rules errors

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* Some errors can only be found after the applicable logs are collected in Cortex XSIAM.

#### 9.6.6. Parsing Rules Raw Dataset

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

### 9.7. Data Model Rules

#### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

#### 9.7.1. What are Data Model Rules?

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

#### 9.7.2. Data Model Rules editor views

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

#### 9.7.3. Data Model Rules file structure and syntax

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

* For more information on XQL syntax, see the XQL Language Reference Guide.

* You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

##### 9.7.3.1. MODEL

###### Note

* The Settings → Configurations → XQL Configuration → Case Sensitivity (case_sensitive) setting can overwrite this case_sensitive configuration for all fields in the application except for BIOCs, which will remain case insensitive no matter what this setting is set to. For more information on this setting, see XQL Configuration.

* We recommend that you do not configure the same data source in both Marketplace and using a Cortex XSIAM data collector. Yet, if you do, the following will happen: For network data, all relevant logs from the different data sources are stitched to the same network story. For authentication data, all relevant logs from the different data sources are...

##### 9.7.3.2. RULE

###### Note

* For more information on the XQL syntax, see the XQL Language Reference Guide.

##### 9.7.3.3. Field structure

###### Note

* For more information on these data model fields, see Cortex XSIAM Data Model Schema.

#### 9.7.4. How to map authentication story events?

##### Prerequisite

* Familiarize yourself with the Cortex Data model (XDM) schema for field definitions and naming conventions, see Cortex XSIAM Data Model Schema.

##### Important

* This Feature focuses on authentication events related to SSO (Single Sign-On) and SaaS (Software-as-a-Service) application authentications. It does not cover internal authentication mechanisms such as Kerberos, NTLM, or traditional domain logon events generated by on-premise infrastructure.

* To maximize the variety of issues that are retrieved based on the XDM authentication stories, we recommend that the following additional fields are populated: xdm.target.resource_name, xdm.logon.type, xdm.source.user_agent, and xdm.source.host.device_category. Should you decide to change the default XDM mappings, ensure that both the mandatory and...

#### 9.7.5. Create Data Model Rules

##### Prerequisite

* Data Model Rules editor views Data Model Rules file structure and syntax How to map authentication story events?

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → Data Management → Data Model Rules

#### 9.7.6. Troubleshooting Data Model Rules

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

* Since this dataset also contains Parsing Rules errors, some of the fields are irrelevant for Data Model Rules and aren't included in the table.

##### Tip

* To ensure you and your colleagues stay informed about Data Model Rules activity, you can also Configure notification forwarding to forward your Data Model Rules audit logs to an email distribution list or Syslog server. For more information about the Data Model Rules audit logs, see Monitor Data Model Rules activity.

#### 9.7.7. Using data enrichment

##### Note

* For a complete list of auto-enriched fields, see the Cortex Data Model Schema Guide.

##### Important

* When manually mapping ASN fields that are enriched, such as xdm.source.asn.as_number, with other ISP and domain fields that are not enriched, such as xdm.source.asn.isp and xdm.source.asn.domain, it's possible to receive incorrect XDM query results due to the misalignment between the overridden enrichement and system enrichment fields.

#### 9.7.8. Data Model Rules notifications

#### 9.7.9. Monitor Data Model Rules activity

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

### 9.8. Manage Event Forwarding

#### License Type

  This feature requires an Event Forwarding add-on license. Only Administrators have access to this screen.

#### Important

* Since data is aggregated and compressed, it can take up to two hours until the data is available in the forwarding bucket.

#### Navigation

  Under Settings → Configurations → Data Management → Event Forwarding, activate the licenses in the Activation section

#### 9.8.1. Endpoints Event Forwarding - included/excluded fields by event type

##### License Type

  This feature requires an Event Forwarding add-on license. Only Administrators have access to this screen.

### 9.9. Manage compute units

#### Note

* For more information, see Import historical data into cold storage.

* The CU consumption of cold storage queries is based on the number of days in the query time frame. For example, when querying 1 hour of a specific day, the CU of querying this entire day is consumed. When querying 1 hour that extends past 2 days, such as from 23:50 to 00:50 of the following day, the CU of querying these two days is consumed.

#### 9.9.1. Compute units usage

##### Note

* To enable the add-on, select Settings  → Configurations → Cortex XSIAM License → Addons tile, and select the Compute Unit tile and Enable.

##### Navigation

  Settings → Configurations → Data Management → Compute Unit Usage

10. Marketplace

  10.1. Cortex Marketplace

  10.2. Content packs

##### Note

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

  10.3. Content Pack Support Types

##### Note

* Palo Alto Networks is not liable for and does not warrant or support any content pack produced by a third-party publisher. Palo Alto Networks does not support content packs that do not have official available documentation.

  10.4. Cortex XSIAM content

  10.5. Manage content packs

##### Note

* Optional content packs that are already installed are treated like they are required content packs to preserve content integrity.

* In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as scripts or integrations.

* Third-party product Integrations are developed and tested against a specific product version. For products that are on-prem or cloud-based with specific API versions, the version developed and tested against will be included in the integration's documentation. Newer versions of the product are not always immediately tested, and it is expected that...

##### Caution

* If another content pack is dependent on the content pack you want to delete, it may break the other content pack. You can reinstall the content pack, but you cannot restore detached and customized content.

* If you want to downgrade, any content that depends on the content pack including any customizations may be deleted if it does not exist in the target content pack version.

  10.6. Marketplace FAQs

  10.7. Content changes when upgrading Cortex XSIAM versions

  10.8. Content pack contributions

11. Cortex XSIAM XQL

  11.1. Get started with XQL

  11.1.1. XQL language features

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

##### Navigation

  You submit XQL queries to Cortex XSIAM using the Investigation & Response → Search → Query Builder user interface

  11.1.2. XQL Language Structure

  11.1.2.1. Adding comments in queries

  11.1.3. Supported operators

##### Note

* In some cases, using an IN or NOT IN operator combined with a dataset and filter stage can be a better alternative to using a join stage.

  11.1.4. Datasets and presets

##### Note

* To set up this Cloud Identity Engine (previously called Directory Sync Service (DSS)) dataset, you need to set up a Cloud Identity Engine. Otherwise, you will not have a pan_dss_raw dataset. For more information, see Set up Cloud Identity Engine.

* INFO issues are not included in this dataset. This dataset includes issues from the Security and Health domains. For more information, see Overview of the Issues page.

* The fields contained in this dataset are a subset of the fields in the xdr_data dataset.

* If the vendor and product are not specified in the Winlogbeat profile's configuration file, Cortex XSIAM creates a default dataset called microsoft_windows_raw.

* To ensure GlobalProtect access authentication logs are sent to Cortex XSIAM, verify that your PANW firewall's Log Settings for GlobalProtect has the Cortex Data Lake checkbox selected.

* You must have the Cortex XSIAM Threat Intel Management (TIM) Add-on to use this dataset.

* You can query in XQL for this data and build widgets based on the xdr_data dataset or using the preset device_control. To view in an XQL query these events, the Device Configuration of the endpoint profile must be set to Block. Otherwise, the USB events are not captured. The events are also captured when a group of device types are blocked on the...

##### Important

* This dataset will not be updated after June 2024. Use the health_alerts dataset instead.

  11.1.5. About examples

##### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

  11.1.6. JSON functions

##### Important

* JSON field names are case sensitive, so the key to field pairing must be identical in an XQL query for results to be found. For example, if a field value is "TIMESTAMP" and your query is defined to look for "timestamp", no results will be found.

  11.1.7. How to filter for empty values in the results table

  11.1.8. Understanding string manipulation in XQL

  11.2. Build XQL queries

  11.2.1. About the Query Builder

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

  11.2.2. How to build XQL queries

##### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

##### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  11.2.2.1. Get started with XQL queries

##### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

  11.2.2.2. Useful XQL user interface features

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

  11.2.2.3. XQL Query best practices

  11.2.2.4. Expected results when querying fields

  11.2.2.5. Create XQL query

##### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

  11.2.2.6. Review XQL query results

##### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* In order for Cortex XSIAM to provide a histogram for a field, the field must not contain an array or a JSON object.

  11.2.2.7. Translate to XQL

##### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

  11.2.2.8. Graph query results

##### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

  11.2.3. Query Builder templates

##### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

  11.2.3.1. Get started with Query Builder templates

  11.2.3.2. Considerations for using Query Builder templates

  11.2.3.3. Create a query from a template

##### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

  11.2.3.4. Run a free text query

##### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

  11.2.3.5. Query Builder template examples

##### Navigation

  Investigation & Response → Search → Query Builder

  11.2.4. Edit and run queries in Query Center

##### Navigation

  Investigation & Response → Search → Query Center

  11.2.4.1. Query Center reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  11.2.5. Manage scheduled queries

##### Navigation

  Investigation & Response → Search → Scheduled Queries

  11.2.5.1. Scheduled Queries reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  11.2.6. Manage your personal query library

##### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

  11.2.7. Legacy Query Builder

##### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

  11.2.7.1. Create authentication query

##### Navigation

  Investigation & Response → Search → Query Builder

  11.2.7.2. Create event log query

##### Navigation

  Investigation & Response → Search → Query Builder

  11.2.7.3. Create file query

##### Navigation

  Investigation & Response → Search → Query Builder

  11.2.7.4. Create image load query

##### Navigation

  Investigation & Response → Search → Query Builder

  11.2.7.5. Create network connections query

##### Navigation

  Investigation & Response → Search → Query Builder

  11.2.7.6. Create network query

##### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

  11.2.7.7. Create process query

##### Navigation

  Investigation & Response → Search → Query Builder

  11.2.7.8. Create registry query

##### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

  11.2.7.9. Query across all entities

##### Navigation

  Investigation & Response → Search → Query Builder

  11.3. Stages

  11.4. Functions

12. Multi-Tenant

  12.1. What is Cortex XSIAM multi-tenant?

##### Note

* By default, multi-tenant licenses include one child tenant.

  12.1.1. MSSP multi-tenant

  12.1.2. Enterprise multi-tenant

  12.2. Multi-tenant central licensing management

##### Note

* In MSSP or enterprise multi-tenant, the license specifies the maximum number of child tenants that can be created. Once this limit is reached, no additional tenants can be created, even if there remains allocation for endpoints or GBs.

  12.3. Onboard Cortex multi-tenant

  12.3.1. Onboarding checklist for multi-tenant central licensing deployments

  12.3.1.1. Step 1. Activate Cortex XSIAM (main account)

##### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

  12.3.1.2. Step 2. Create a child tenant

##### Note

* The main account is labeled in Cortex Gateway, but child tenants are not labeled. Cortex enables parent-child pairing between tenants located in different geographical regions. To enable this capability, contact your support team. To create a child tenant, ensure that you have Account Admin permissions.

* After activating a child tenant, you can't change the child tenant's name.

* This is a public FQDN, so be careful with sensitive information such as the company name. After activating a child tenant, you can only change the child tenant subdomain once.

* Ensure that you meet the minimum requirements for child tenant allocation.

* If you reach your limit for child tenants, depending on your license, you may be able to create more tenants. You may be charged for additional tenants. Contact Customer Support if you are approaching your authorized limit.

  12.3.2. Onboarding checklist for multi-tenant customer-owned license deployments

  12.3.2.1. Step 1. Activate Cortex Cortex XSIAM (parent and child tenants)

##### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

  12.3.2.2. Step 2. Define access configurations and role permissions

  12.3.2.3. Step 3. Pair a parent tenant with child tenant

##### Note

* This field is not enabled by default. To enable this, contact your support team.

  12.4. Dynamic license allocation

##### Note

* Changing the tenant's allocations might result in a short downtime of your tenant.

* After activating a child tenant, you can't change the child tenant's name.

* This is a public FQDN, so be careful with sensitive information such as the company name. After activating a child tenant, you can only change the child tenant subdomain once.

* Ensure that you meet the minimum requirements for child tenant allocation.

* If you reach your limit for child tenants, depending on your license, you may be able to create more tenants. You may be charged for additional tenants. Contact Customer Support if you are approaching your authorized limit.

* In a multi-tenant central licensing management environment, you cannot unpair a child tenant from the main account. The only way to remove the connection to the main account is to delete the tenant.

  12.5. Child tenant management

  12.5.1. Manage a child tenant

##### Note

* Once a configuration is created Cortex XSIAM resets the child tenant data and synchronizes the security actions configured in the parent tenant.

  12.5.2. Track your tenant management

##### Note

* This field is not enabled by default. To enable, contact your account administrator.

##### Navigation

  To view child tenant details, in Cortex XSIAM, select Settings → Configurations → Tenant Management

  12.5.3. Investigate child tenant data

  12.5.4. Create and allocate configurations

##### Note

* You can configure Profiles only as Managed or Unmanaged. All profiles you create are automatically cloned to your child tenants.

  12.5.5. Create a security managed action

##### Note

* Profiles you create are automatically cloned to your child tenants.

  12.6. About managed threat hunting

  12.6.1. Set up Managed Threat Hunting

##### Navigation

  Settings → Configurations → Managed Services

  12.6.2. Investigate Managed Threat Hunting reports

##### Note

* The MTH page is available for users with the Managed Threat Hunting license and have the necessary permission to view and triage alerts and incidents in Cortex XSIAM.

13. Reference

  13.1. Cloud service provider permissions

  13.1.1. Amazon Web Services provider permissions

  13.1.2. Google Cloud Platform provider permissions

  13.1.3. Microsoft Azure provider permissions

  13.2. Microsoft Windows security auditing setup

  13.2.1. Enable security auditing event IDs

##### Note

* We recommend you configure security auditing using Group Policy Object (GPO). Using GPO simplifies audit management and ensures that auditing settings are uniformly applied across your network, reducing the risk of misconfigurations on individual machines.

  13.2.1.1. Enable security auditing event IDs with GPO

##### Note

* We recommend that you configure the Group Policy Object (GPO) to apply to all endpoints and not just Domain Controllers. This ensures comprehensive auditing across your entire network.

##### Navigation

  Server Manager → Tools → Group Policy Management

  Computer Configuration → Policies → Windows Settings → Security Settings → Advanced Audit Policy Configuration → Audit Policies

  13.2.1.2. Set up local machine security auditing without GPO

  13.2.1.3. Additional setup for Active Directory Certificate Services (ADCS) events

##### Note

* Enabling auditing for Active Directory Certificate Services (ADCS) restarts (events 4880 and 4881) can significantly slow down the service if you have a large database. To prevent delays: Clean up the database: Remove any unnecessary entries to reduce its size. Skip this audit: If restart speed is critical, consider not enabling auditing for ADCS...

  13.2.1.4. Enable auditing access to AD domain objects - 4662

##### Note

* The Descendant msDS-DelegatedManagedServiceAccount Objects configuration is relevant only for Windows Server 2025.

  13.2.2. Enable additional event logs using Event Viewer

##### Navigation

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → User Profile Service, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → CAPI2, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → DNS Client Events, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → DriverFrameworks-UserMode, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → PowerShell, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → Windows Defender, right click Operational and select Enable Log

  In Event viewer → Application and Services Logs → Microsoft → Windows → TerminalServices-ClientActiveXCore → Microsoft-Windows-TerminalServices-RDPClient, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → Windows Firewall With Advanced Security → Firewall, right click Operational and select Enable Log

  13.2.3. Enable LDAP server events logging (1644)

  13.2.3.1. Enable LDAP server events logging using RegEdit

  13.2.3.2. Enable LDAP server events logging using GPO

##### Navigation

  Computer Configuration → Preferences → Windows Settings → Registry

  13.2.3.3. Validate log collection for LDAP Server events

  13.3. XDM fields for mapping authentication events

##### Note

* For more information on the entire Cortex Data model (XDM) schema, see Cortex XSIAM Data Model Schema.

* Do not map a static string, list, or empty string. You must map this field from the raw log field that best represents the actual source IP used in the authentication attempt. In cases where multiple IP fields are available, such as client_ip, source_ip, and original_client_ip, choose the field that captures the IP address from which the user initially...

* Mapping should be done per event type. The same system could be an IDP in one event and an SP in another.

* For more information on the event outcome constants in the Cortex Data Model, see XDM_CONST.OUTCOME.

* Outcome is based on a conclusive event type reflecting the true end state of the authentication flow.Critical for effectiveness of detection rules. Incorrect derivation can lead to missed detections or false positives.

* These are the most common values, but other logon types also exist. For a complete list, see XDM_CONST.LOGON_TYPE.

* For more information, see XDM_CONST.USER_TYPE.

* For more information, see XDM_CONST.PRIVILEGE_LEVEL.

* For more information, see XDM_CONST.OS_FAMILY.

* While xdm.network.session_id aggregates multiple user actions within a broader session window. xdm.session.context.id is used to correlate events that belong to a single authentication request or transaction.


## Cortex XSIAM NG SIEM Documentation


---

## 1. Get started with Cortex XSIAM

### 1.1. Get started with Cortex XSIAM

#### 1.1.1. Cortex XSIAM architecture

##### Note

* You can host your Cortex Native Data Lake instance in either the United States (US) Region or the European Union (EU) Region.

* You can host your Directory Sync Service instance in either the US Region or EU Region.

### 1.2. Fair Usage policy for Cortex XSIAM

### 1.3. Cortex XSIAM product licenses

#### Note

* You can upgrade your license by purchasing add-ons or moving to a different XSIAM license.

#### 1.3.1. Data retention

#### 1.3.2. Data storage lifecycle

##### Tip

* You can view details about your Cortex XSIAM licenses by selecting Settings → Cortex XSIAM License.

#### 1.3.3. License allocation

##### Note

* It can take up to an hour for Cortex XSIAM to display revived endpoints.

#### 1.3.4. License expiration

#### 1.3.5. Upgrade your tenant

### 1.4. Security Operations Center roles and responsibilities

### 1.5. In-product support case creation

#### Note

* When opening a support case through the Customer Support Portal, you need to manually select Cortex XSIAM as the product. While there may be discrepancies between the categories in this wizard and the Customer Support Portal process, that's because this wizard is designed specifically to focus on options relevant to Cortex XSIAM.

* Selecting an endpoint from the endpoint table and retrieving TSF requires full Retrieve Endpoint Data permissions under Endpoint Administration.

* Console recordings cannot exceed 10 minutes. The current recording time is displayed at the top of the window.

### 1.6. Supported web browsers

### 1.7. Use the interface

#### Note

* Each SAML login session is valid for 8 hours. Some menu items only appear if you have the relevant license.

* CMD fields have a 128-character limit. Shorten longer query strings to 127 characters and add an asterisk (*).

* Deleting a shared view removes it for all users.

### 1.8. What is Cortex Gateway?

## 2. Onboard and configure Cortex XSIAM

### 2.1. Deployment steps

#### 2.1.1. Plan and prepare

#### 2.1.2. Cortex XSIAM onboarding checklist

##### Prerequisite

* Cloud Identity Engine must be set up.

#### 2.1.3. Activate Cortex XSIAM

##### Prerequisite

* The Cortex XSIAM activation email. A Customer Support Portal (CSP) account. You need to set up your CSP account. For more information, see How to Create Your CSP User Account. When you create a CSP account, you can set up two-factor authentication (2FA) to log into the CSP by using an Email, Okta Verify, or Google Authenticator (non-FedRAMP accounts)....

##### Note

* When you activate, a production tenant is first activated. After activation, you can set up a development tenant (subject to your license).

* Activation can take about an hour and does not require you to remain on the activation page. Cortex XSIAM sends a notification to your email when the process is complete.

* If you want to change your tenant's name, the subdomain, or activate a development tenant (subject to license), on the right-hand side, click the ellipsis. You can only change the subdomain once, and it cannot be undone. After deleting the subdomain, you can reuse it after 7 days.

##### 2.1.3.1. Bring your own keys

###### Prerequisite

* Access to BYOK (Bring Your Own Keys) functionality is restricted to tenants that were initially activated with BYOK.

* To disable your encryption keys and deactivate a tenant, you must have an Account Admin role.

###### Note

* The new keys you import will serve as primary encryption keys for newly generated data.

* At any stage, you can select Continue Later to pause the process. To resume the process, in the Cortex gateway, select Continue Setup next to the tenant, and follow the wizard instructions from the point you left off, as detailed below. If you don't use either of your wrapping keys within three days, they expire and you'll have to restart the process.

* BYOK requires a 32-byte, symmetric, unencoded key in binary format.

###### Caution

* Disabling all encryption keys and deactivating the tenant renders the tenant inaccessible and non-operational. Disabling the keys affects the communication with the agents, may prevent the agents from receiving updates to policies, configurations, and crucial information, and may result in loss of data. To secure your tenant data and to prevent...

##### 2.1.3.2. Cortex XSIAM supported regions

##### 2.1.3.3. Enable access to required PANW resources

###### Note

* <tenant-name> refers to the selected subdomain of your Cortex XSIAM tenant, and <region> is the region in which your tenant is deployed. For more information, see Cortex XSIAM supported regions.

#### 2.1.4. Assign user roles and groups

##### Note

* If an existing user in the Cortex Gateway no longer has a role or a user group assigned, the user is revoked. Any roles, user groups, or egress configurations created by that user are shown as created by Revoked user instead of the user's email address.

##### Important

* Setting Cortex Query Language (XQL) dataset access permissions for a user role can only be performed from Cortex XSIAM Access Management. For more information, see Manage user roles.

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

##### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit Users Permissions.

#### 2.1.5. Set up authentication

##### Tip

* You should have at least one user in the Customer Support Portal for backup, in case of any authentication issues with your IdP provider.

##### 2.1.5.1. Authenticate users through the Customer Support Portal

###### Note

* You must be assigned the Super User role in the Customer Support Portal to add users in the Customer Support Portal. The first Super User who logs into Cortex Gateway is automatically assigned the Account Admin role and has access to the tenant. The user who activates the Cortex XSIAM tenant will also be assigned the Account Admin role (if there is no...

* After users are added to the Customer Support Portal and they accept the invitation, you can manage them in Cortex Gateway or the Cortex XSIAM tenant.

##### 2.1.5.2. Authenticate users using SSO

###### Note

* To set up SSO authentication in the tenant, you must be assigned an Instance Administrator or Account Admin role. SAML 2.0 users must log in to Cortex XSIAM using the FQDN (full URL) of the tenant. To allow login directly from the IdP to , you must set the relay state on the IdP to the FQDN of the tenant. If you have multiple tenants, you must set up...

* The first SSO cannot be deleted, it can only be deactivated by toggling SSO Enabled to off. The Domain parameter is predefined for the first SSO. If you add additional SSO providers, you must provide the email Domain in the SSO Integration settings for all providers except the first. Cortex XSIAM uses this domain to determine to which identity provider...

* Cortex XSIAM requires the IdP to send the group membership as part of the SAML token. Some IdPs send values in a format that include a comma, which is not compatible with Cortex XSIAM. In that case, you must configure your IdP to send a single value without a comma for each group membership. For example, if your IdP sends the Group DN (a...

##### 2.1.5.3. Set up Okta as the Identity Provider Using SAML 2.0

###### Note

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Navigation

  Settings → Configurations → Access Management → Authentication Settings

  Settings → Configurations → Access Management → User Groups

##### 2.1.5.4. Set up Azure AD as the Identity Provider Using SAML 2.0

###### Note

* The default attributes shown on the main single sign-on page in Azure AD are not the values you need. You must click Edit next to Attributes and Claims to view and copy the actual values.

* The attribute claim name must exactly match the value sent by your IdP. In some cases, this may be the full attribute name/namespace, depending on the configuration of our IdP

* When using SAML 2.0, users are required to authenticate by logging in directly at the tenant URL. They cannot log in via Cortex Gateway.

###### Important

* When copying the Single Sign-On URL value, remove idp/saml and leave the trailing /. For example, if the Single Sign-On URL is https://clientname.panproduct.region.paloaltonetworks.com/idp/saml, just copy https://clientname.panproduct.region.paloaltonetworks.com/.

###### Navigation

  Settings → Configurations → Access Management → User Groups

#### 2.1.6. Configure and deploy Cortex XSIAM

##### 2.1.6.1. Cortex XSIAM - Analytics

###### Prerequisite

* Before Cortex XSIAM - Analytics can start to analyze your endpoint data, perform the following steps: Configure Cortex XSIAM network parameters to monitor your internal networks. Enable the Analytics Engine. Make sure Cloud Identity Engine is set up. Enable Identity Analytics.

###### 2.1.6.1.1. Configure Cortex XSIAM network parameters

####### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

####### Navigation

  Inventory → Assets → Network Configuration → Internal Domain Suffixes

###### 2.1.6.1.2. Enable the Analytics Engine and Identity Analytics

####### Prerequisite

* Analytics Engine To create a baseline for enabling analytics, Cortex XSIAM requires a minimum of one of the following data sets: EDR or Network logs from at least 30 endpoints over a minimum of 2 weeks Cloud audit logs over a minimum of 5 days Identity Analytics Cortex XSIAM - Analytics must be activated. Cloud Identity Engine must be set up. For more...

####### Navigation

  Settings → Configurations → Cortex XSIAM - Analytics

##### 2.1.6.2. Cortex XSIAM engines

###### 2.1.6.2.1. Engine requirements

####### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

###### 2.1.6.2.2. Install an engine

####### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex XSIAM engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

####### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

####### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

##### 2.1.6.3. Set up Cloud Identity Engine

###### Note

* The Activate risk signal sharing to CIE checkbox is available only after the second step is completed.

###### Navigation

  Settings → Configuration → Integrations → Cloud Identity Engine

#### 2.1.7. Define data sources

##### Note

* Not all content packs are available to download on the Data Sources page. If you require content packs such as Phishing, and Malware, you need to download the pack from Marketplace and configure the integration. The Data Sources page is designed for third-party integrations to help you onboard.

* For some vendors, to receive data from an external source, you must first set up the Syslog Collector applet on a Broker VM within your network. For more information, see Activate Syslog Collector.

##### 2.1.7.1. Cortex XSIAM content

###### 2.1.7.1.1. Cortex Marketplace

###### 2.1.7.1.2. Content packs

####### Note

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

###### 2.1.7.1.3. Install content packs

####### Note

* Currently, not all content packs are supported in the Data Sources page. For example, content packs with several integrations are not yet supported.

* Content packs are also automatically installed when you adopt playbooks and configure tasks.

###### 2.1.7.1.4. Automation and feed integrations

####### Note

* Some integrations can be downloaded directly without having to initially download a content pack from Marketplace. For more information, see Define data sources. In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as...

* If the integration was installed from a content pack, you need to duplicate the integration before editing.

* If the integration was installed from a content pack, you need to duplicate the integration before downloading.

* Integration commands are only available when the integration instance is enabled. Some commands depend on a successful connection between Cortex XSIAM and third-party integrations.

####### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

####### 2.1.7.1.4.1. Manage API keys

######## Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

* You will not be able to view the API key again after you complete this step. Ensure that you copy the API key before closing the notification.

####### 2.1.7.1.4.2. Fetch issues from an integration instance

######## Note

* In some integrations, the Issue Fetch interval is called Feed Fetch Interval. If the integration instance does not have the Issue Fetch Interval field, you need to add this field by editing the integration settings. If the integration is from a content pack, you need to create a copy of the integration. Any future updates to this integration will not...

* Some content packs include preconfigured correlation rules, but you should review them to see if they suit your use case and duplicate them if required. Go to Threat Management → Detection Rules → Correlations, search for the relevant rule, right-click, and select Preview Rule. For example, the ServiceNow v2 Alerts (automatically generated)...

####### 2.1.7.1.4.3. Manage credentials

######## Navigation

  Settings → Configurations → Integrations → Credentials → New Credential

  Settings → Configurations → Data Collection → Automation & Feed Integrations and select the integration instance

####### 2.1.7.1.4.4. Forward Requests to Long-Running Integrations

######## Note

* This integration replaces the External Dynamic list integration, which is deprecated. For more information about how to set up the integration, see Manage external dynamic lists.

* When running on the tenant, you can only use long-running integrations provided by Cortex XSIAM, you cannot create custom ones. Custom long-running integrations are supported only on engines at this time. Configuring custom certificates or private API Keys in the long-running integration instance is supported only on engines, not on the Cortex XSIAM...

* For the TAXII Server and TAXII2 Server integrations, the xdr string is automatically replaced by crtx. For the Microsoft Teams integration, you can use the microsoft-teams-create-messaging-endpoint command to get the correct messaging endpoint based on the server URL, the server version, and the instance configurations. For more information, see...

####### 2.1.7.1.4.5. Integration use cases

####### 2.1.7.1.4.6. Troubleshoot Integrations

### 2.2. Post-deployment steps

#### 2.2.1. Perform health checks

##### 2.2.1.1. Monitor agent operational status in Cortex XSIAM

###### Note

* Any of the listed items could lead to a partially protected state. Refer to the Cortex XSIAM management console for specific reasons for the state.

###### Caution

* Status can have the following implications on the endpoint: *(Status): The exploit protection module is not running. **(Status):    XDR data collection is not running   Behavioral threat protection is not running   Anti-malware flow is asynchronous   Local privilege escalation protection is asynchronous **(Status): XDR data collection is not...

#### 2.2.2. Set up your environment

##### 2.2.2.1. Configure server settings

###### License Type

  Requires a Cortex XSIAM or Cortex XDR Pro license

###### Note

* Keyboard shortcuts, timezone, and timestamp format are not set universally and only apply to the user who sets them.

* If the Password Protection (for downloaded files) setting under Settings → Configuration → General → Server Settings is enabled, enter the password 'suspicious' to download the file.

* Requires the TIM add-on. By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled.

* Requires an MSSP License and RBAC permissions to Cases & Issues and Investigation & Response → Automation. This setting is available for the parent tenant only.

###### Navigation

  Settings → Configurations → General → Server Settings

##### 2.2.2.2. Configure security settings

###### Navigation

  Settings → Configurations → General → Security Settings

##### 2.2.2.3. Log forwarding

###### 2.2.2.3.1. Forward logs from Cortex XSIAM to external services

####### License Type

  Requires Cortex XDR per Endpoint

####### 2.2.2.3.1.1. Integrate a syslog receiver

######## Note

* Up to TLS 1.3 is supported. Make sure the self-signed CA includes your public key.

####### 2.2.2.3.1.2. Integrate Slack for outbound notifications

######## Note

* You are directed to the Slack browser to install Cortex XSIAM. You can only use this link to install Cortex XSIAM on Slack. Attempting to install from Slack Marketplace will redirect you to Cortex XSIAM documentation.

####### 2.2.2.3.1.3. Configure notification forwarding

######## Prerequisite

* Before you can select a syslog receiver or a Slack channel, you must integrate these external services with Cortex XSIAM. For more information, see: Integrate a syslog receiver Integrate Slack for outbound notifications

######## Note

* To configure notification forwarding for issues by domain, select Log Type = Issues and filter the Issues table by Issue Domain.

* This option will be deprecated in the next release. Configure issues with the filter Issue Domain = Health instead.

* When a notification is sent for each configured format.

####### 2.2.2.3.1.4. Monitor administrative activity

###### 2.2.2.3.2. Log notification formats

####### 2.2.2.3.2.1. Management audit log messages

####### 2.2.2.3.2.2. Issue notification format

####### 2.2.2.3.2.3. Agent Audit log notification format

####### 2.2.2.3.2.4. Management Audit log notification format

####### 2.2.2.3.2.5. Log format for IOC and BIOC issues

####### 2.2.2.3.2.6. Analytics log format

####### 2.2.2.3.2.7. Log formats

######## Note

* The FUTURE_USE tag applies to fields that Cortex XSIAM does not currently implement.

#### 2.2.3. Remote repository management

##### 2.2.3.1. Cortex XSIAM development tenant

###### Important

* Development tenants are not intended for performance checks; they cannot access production data, and they are connected to a limited number of endpoints. As a result, all development tenants have fewer resources than the production tenant, including data ingestion capacity and performance, and compute capabilities. In a development tenant, extreme...

##### 2.2.3.2. Set up a remote repository

###### Navigation

  If the content repository option is disabled for the production or development tenant (under Settings → Configurations → General → Remote Repository Settings, toggle the Content repository slider to off), the tenant becomes standalone and does not push or pull content

  If you are changing your remote repository settings, back up existing content to your local computer by navigating to Settings → Configurations → General → Server Settings → Custom Content and click Export all custom content

###### 2.2.3.2.1. Set up a built-in remote repository

####### Note

* Once enabled, development tenants have a red banner on the top left showing DEV.

* The first tenant that is enabled pushes its content to the remote repository first. For example, these instructions describe enabling the production tenant first, so the remote repository will initially contain production tenant content. You can enable a development tenant first if you want the remote repository to initially contain the content from...

####### Navigation

  Settings → Configurations → General → Remote Repository Settings and toggle the Content repository slider to enable the remote repository

###### 2.2.3.2.2. Set up a Private Remote Repository

####### Note

* Once enabled, the development push tenant has a red banner on the top left showing DEV.

* For repository vendors that use tokens, enter the token type in the username field and the token in the password field. Verify details with your vendor. If your private Git remote repository uses personal access tokens instead of usernames and passwords, enter the token type in the username field and the access token in the password field. For example,...

* You can't add an engine that has been added to a Load-Balancing Group.

* If your private Git remote repository uses personal access tokens instead of usernames and passwords, enter the access token in the password field and leave the username field blank. For repository vendors that use tokens, the token type is entered in the username field and the token is entered in the password field. Verify details with your vendor. If...

* The first tenant that is enabled pushes its content to the remote repository first. For example, these instructions describe enabling the production tenant first, so the remote repository will initially contain production tenant content. You can enable a development tenant first if you want the remote repository to initially contain the content from...

####### Tip

* Due to security concerns, there is a closed allow list of approved URLs for private repositories. If you want to use a URL that is excluded from the allow list, use an engine (engine groups are not supported).

##### 2.2.3.3. Push and pull content

###### Navigation

  Settings → Configurations → Remote Repository Content → User-Defined Content

##### 2.2.3.4. Remote repository troubleshooting

#### 2.2.4. Manage user roles and access management

##### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.Set up...

##### Note

* For more information on assigning user roles when generating an API key, see Manage API keys.

* Some features are license-dependent. Accordingly, users may not see a specific feature if the feature is not supported by the license type or if they do not have access based on their assigned role or scope.

* For features where scoping is not applicable, Role-Based Access Control (RBAC) is used and can be configured when managing user roles. For more information, see Manage user roles.

##### 2.2.4.1. Manage user roles

###### Prerequisite

* Managing user roles in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.Set up users and roles

###### Navigation

  Settings → Configurations → Access Management → Roles

##### 2.2.4.2. Manage user access

###### Prerequisite

* Managing users, roles, scopes, user groups, authentication settings in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.Set up...

###### Note

* You can only reduce the permissions of an Account Admin user via Cortex Gateway.

* User permissions for components and datasets are based on the access permissions set in the user role. For more information on editing these user role permissions, see Manage user roles.

###### Important

* Before configuring, ensure that you review Understand scoping in the Manage user scope section.

* By default, Enable Scope Based Access Control is disabled in Settings → Configurations → General → Server Settings, and granular scoping is not enforced. Before enabling SBAC, we recommend that an administrator or a user with Access Management permissions first ensures that the users, user groups, and API Keys defined in Cortex XSIAM are granted...

###### Tip

* To apply the same settings to multiple users, select them, and then right-click and select Edit User Permissions.

###### Navigation

  Settings → Configurations → Access Management → Users

###### 2.2.4.2.1. User access reference information

##### 2.2.4.3. Manage user scope

###### Prerequisite

* Configuring user scopes in Cortex XSIAM Access Management requires View/Edit RBAC permissions for Access Management (under Configurations). Account Admin and Instance Administrator roles are granted this permission by default. For more information, see Predefined user roles in Set up users and roles.Set up users and roles By default, Enable Scope Based...

###### Note

* This configuration can impact the visibility of the related Security domain in the Cases and Issues scope area, but with not affect asset visibility.

* For Cases and Issues domains, a workaround is to create a Dataset View for each required combination of domains, and allow the relevant entity access only to this Dataset View, not to the underlying cases and issues datasets.

* Make sure to assign the required default granular scoping for users. This depends on the structure and divisions within your organization and the particular purpose of each organizational unit to which scoped users belong.

###### Important

* Some areas and features in Cortex XSIAM do not respect SBAC. In these cases, use RBAC permissions to restrict access.

* Before configuring, ensure that you review the Understand scoping section.

#### 2.2.5. Dashboards and reports

## 3. Web and API Security (WAAS)

### 3.1. Overview

#### License Type

  Requires the Cortex Cloud Runtime Security add-on.

#### Note

* Verify API security configurations for relevant users and roles.

### 3.2. Personas workflow

### 3.3. Secure your API landscape

#### 3.3.1. API visibility and risk assessment

##### Note

* Data classification findings are only available for enabled profiles.

* Indicates that a JSON Web Token was identified, but it is unknown how to determine its type from the given string. It could be a non-standard JSON Web Token creation algorithm.

#### 3.3.2. Monitor and investigate API threats

#### 3.3.3. Configure API security from end to end

##### 3.3.3.1. Third-party API security integrations

###### 3.3.3.1.1. Ingest AWS API Gateway

####### Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

####### Important

* Leave '–'filter-pattern empty as displayed above.

###### 3.3.3.1.2. Ingest Azure APIM

####### License Type

  Requires the Data Collection add-on.

####### Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

####### Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

###### 3.3.3.1.3. Ingest Apigee Proxy

####### License Type

  Requires the Data Collection add-on.

####### Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

####### Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

###### 3.3.3.1.4. Ingest Kong

####### License Type

  Requires the Data Collection add-on.

####### Note

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

####### Important

* The size of the buffer must be equal to or larger than the max body size setting in the plugin configuration, on every data plane node.

###### 3.3.3.1.5. Ingest-F5

####### License Type

  Requires the Data Collection add-on.

####### Note

* Extract the files from the F5 plugin to a folder before selecting to upload to F5.

* Select panw_apisec_set_ssl_data only if your client SSL profile is enabled.

* The provider for "context_provider" should always be uppercase. Supported providers: AWS, GCP, Azure, On-prem.

##### 3.3.3.2. Agent-based protection

###### Note

* Web and API Security (WAAS) profiles and policies are currently a Beta feature.

###### 3.3.3.2.1. Set up Web and API Security profiles

####### Note

* Web and API Security profiles and policies are currently a Beta feature.

* In this profile, the Report options configure the workload to report the corresponding malicious applications or APIs to Cortex XSIAM, without blocking them. The Disabled options configure the workloads to neither analyze nor report the corresponding malware or behavior.

####### Navigation

  Inventory → Endpoints → Policy Management → Prevention → Profiles

###### 3.3.3.2.2. Apply Web and API Security profiles to workloads

####### Note

* Web and API Security profiles and policies are currently a Beta feature.

* When importing a policy, select whether to enable the associated policy targets. Rules within the imported policy are managed as follows: New rules are added to the top of the list. Default rules override the default rule in the target tenant. Rules without a defined target are disabled until the target is specified.

* The exported file is encoded in Base64 and cannot be edited.

###### 3.3.3.2.3. Manage Web and API Security prevention profiles

####### Navigation

  From Inventory → Endpoints → Policy Management → Prevention → Profiles, locate the profile that you want to remove

  Inventory → Endpoints → Policy Management → Prevention → Profiles

###### 3.3.3.2.4. Add a disable prevention rule for cloud workloads

####### Important

* All applicable prevention actions are skipped for the files and process that match the properties defined in the rule. Consider the consequences of disabling a prevention rule before you add the exception, and monitor it over time.

####### Navigation

  Settings → Exceptions Configuration → Disable Prevention Rules

###### 3.3.3.2.5. Add a support exception rule for cloud workloads

####### Navigation

  From Settings → Exceptions Configuration → Support Exception Rules, click + Import from file

###### 3.3.3.2.6. Add a legacy exception rule for cloud workloads

####### Navigation

  Your rule is created, and can be viewed at the following location: Settings → Exceptions Configuration → Legacy Agent Exceptions

###### 3.3.3.2.7. Additional workload management tasks

####### Navigation

  Several management activities that can be performed on workloads are accessible from Inventory → Endpoints → All Endpoints and from Inventory → Endpoints → Groups

#### 3.3.4. API specification inventory

##### Note

* Even if you have already imported the specification, you can edit the API specification in Cortex XSIAM and add or update the server list.

##### 3.3.4.1. Import API specification

###### Note

* Even if you already imported the file, you can edit the API asset and add or update the server list.

## 4. Monitor dashboards and reports

### 4.1. About dashboards

#### Note

* You cannot edit the predefined dashboards but you can create a new dashboard that is based on a dashboard template. In addition, private dashboards can only be viewed, edited, and deleted by the dashboard creator.

* Dashboards that are based on custom infrastructure cannot be exported. If you import a dashboard template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

#### 4.1.1. Command Center dashboards

##### Note

* Access to the dashboards requires RBAC View permissions for Dashboards & Reports and Command Center Dashboards. The dashboards are available in dark mode only. They are not editable, and you can't create dashboard templates or reports from them. Some of the dashboard's animations are not fully supported by the Safari web browser. We recommend that...

##### 4.1.1.1. XSIAM Command Center

##### 4.1.1.2. Cloud Detection and Response (CDR) Command Center

###### License Type

  Requires the Cortex Cloud Runtime Security add-on or the Cortex Cloud Posture Management add-on.

##### 4.1.1.3. Cloud Security Command Center

###### 4.1.1.3.1. Cloud Security Command Center

####### License Type

  Requires the Cortex Cloud Runtime Security or the Cortex Cloud Posture Management add-on.

####### Note

* The Cloud Security Command Center dashboard is currently only available by default to users with the Instance Administrator and Viewer roles. Custom roles, which include the Cloud Security Command Center View/Edit role permissions, also have access.

####### 4.1.1.3.1.1. Fine-Tune your Investigation

######## 4.1.1.3.1.1.1. Data Sources

######## 4.1.1.3.1.1.2. Assets with Vulnerabilities

######## 4.1.1.3.1.1.3. Security Outcomes

######### 4.1.1.3.1.1.3.1. Security Cases

######### 4.1.1.3.1.1.3.2. Posture Cases

####### 4.1.1.3.1.2. Value Metrics

######## Note

* The Time Saved estimate is based on the total amount of savings derived from the reduction of issues by grouping and addressing them as Posture Cases and Attack Paths. Analyst savings are estimates based on an average Security Analyst's wage coupled with the reduction in time spent addressing Issues on an individual basis.

##### 4.1.1.4. Cloud Security Operations

###### 4.1.1.4.1. Cloud Security Operations

####### License Type

  Requires the Cortex Cloud Runtime Security add-on or the Cortex Cloud Posture Management add-on.

####### Note

* Command Center data may not match the counts on the Issues page and you may observe inconsistencies. This is because dashboard data is a snapshot of issues identified, whereas the Issues page provides the most up to date view of risks across your cloud assets. In addition, the Issues pages does not support all the currently available filters on the...

####### 4.1.1.4.1.1. Dashboard Widgets

######## Note

* The Last updated time indicated on each widget may differ as widget data is gathered at varying intervals.

######## 4.1.1.4.1.1.1. Generate Reports

######## 4.1.1.4.1.1.2. Filter Options

#### 4.1.2. Predefined dashboards

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

  Requires the Posture Management add-on or the Runtime Security add-on.

  Requires the ITDR add-on.

  Requires the TIM add-on.

##### Note

* Users can access all information on the dashboard when their user access is scoped to view All assets or assigned to the Instance Administrator role. Otherwise, users with granular scoping set to No assets or Select asset groups will have limited access to the dashboard. For more information on Scope-Based Access Control (SBAC), see Manage user...

#### 4.1.3. Reports

##### 4.1.3.1. Report templates

### 4.2. Build custom dashboards and reports

#### 4.2.1. Build a custom dashboard

##### Note

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

#### 4.2.2. Manage your Widget Library

##### Note

* Any dashboards or reports that include the widget are affected by the changes.

### 4.3. Fine-tune dashboards and reports

#### 4.3.1. Create a custom widget using a script

##### Note

* If you have added arguments to the script, these appear when creating a widget.

* Available options are Pie, Column, Line, and Single Value. To display the result of the script as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### 4.3.1.1. Script-based widget examples

###### Note

* Add the widget tag in the script settings to make the script available for use in script-based widgets. For more information, see Create a script.Create a script

* If your script returns a time duration, configure the widget with the graph type Single Value and enable Show as Time..

#### 4.3.2. Create a text widget

##### Note

* From the dashboard manager, you can right-click an existing dashboard and choose Save as report template. You can also add text-based widgets directly to new or existing report templates, as described below.

#### 4.3.3. Create custom XQL widgets

##### Note

* Cortex Query Language (XQL) queries generated from the Widget Library do not appear in the Query Center. The results are used only for creating the custom widget.

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

##### Tip

* You can create a generic dashboard for multiple views of the same dataset by defining the dataset in the XQL widget as dataset = <dataset_name>*. The placement of the asterisk (*) in the dataset name ensures that any view containing this prefix text is displayed in the results. The dataset in a query is defined as: If there are multiple datasets that...

##### Navigation

  All of your predefined and custom XQL widgets are available in the Widget Library under Dashboards & Reports → Customize → Widget Library

##### 4.3.3.1. Configure filters and inputs for custom XQL widgets

###### Prerequisite

* Fixed filters are based on parameters that are defined in custom XQL widgets. Before you can configure fixed filters, take the following steps: Create custom XQL widgets with parameters. For more information, see Create custom XQL widgets. Add the widgets to a Custom dashboard. For more information, see Build a custom dashboard.

###### Note

* If you specify more than one field, only the first field value is used.

###### Tip

* After the initial setup, when you access your dashboard the filters and inputs might need further refinement. You can make changes to the configured parameters in the XQL widgets, and update the Filters & Inputs on your dashboard until you are satisfied with the results.

##### 4.3.3.2. Configure dashboard drilldowns

###### Prerequisite

* To configure drilldowns your dashboard must contain custom XQL widgets. In addition, if you want to configure in-dashboard drilldowns your custom XQL widget must contain one or more parameters. For more information about configuring parameters in custom XQL widgets, see Create custom XQL widgets.

###### Note

* If the selected parameter is configured in other XQL widgets on the dashboard, these widgets are also affected by the drilldown.

###### 4.3.3.2.1. Variables in drilldowns

### 4.4. Run or schedule reports

#### Note

* Report templates that are based on custom infrastructure cannot be exported. If you import a report template that already exists in the system, the imported template will overwrite the existing template. If you do not want to overwrite the existing template, duplicate and rename the existing template before importing the new template.

* The report name and description will be displayed in the report header and are not editable during customization.

* For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show results from specific endpoint groups. Select the menu on the top right corner of the widget, select Groups, and select one or more endpoint groups. For agent-related widgets, you can apply an endpoint scope to refine the displayed data to only show...

#### Navigation

  Dashboards & Reports → Customize → Report Templates

  Dashboards & Reports → Customize → Dashboards Manager

  Under Settings → Configurations → General → Notifications, click + Add Forwarding Configuration

## 5. Investigation and response

### 5.1. Cases and issues

#### 5.1.1. What are cases?

##### 5.1.1.1. Issues

##### 5.1.1.2. Findings and events

#### 5.1.2. Case and issue domains

##### Navigation

  You can see all domains under Configurations → Object Setup → Cases → Domains

#### 5.1.3. Manage your cases

##### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

##### 5.1.3.1. Assign a case

##### 5.1.3.2. Case thresholds

##### 5.1.3.3. Link or unlink issues from a case

##### 5.1.3.4. Resolve a case

###### 5.1.3.4.1. Resolution reasons for cases and issues

####### Note

* The displayed resolution reasons are domain specific. You can see the resolution reasons that are defined for a domain under Configurations → Object Setup → Cases → Domains.

* Cases and issues resolved as True Positive and False Positive help Cortex XSIAM to identify real threats in your environment by comparing future cases and associated issues to the resolved cases. Therefore, the handling and scoring of future cases is affected by these resolutions.

###### 5.1.3.4.2. Create custom case statuses and resolution reasons

####### Note

* Before you create a custom status, please review the built-in options. For more information, see Resolution reasons for cases and issues. We recommend using the built-in statuses and resolution reasons where possible. Custom statuses and resolution reasons might not be supported by all content, and status syncing can take time. In addition, custom...

* After creation, custom statuses and resolution reasons cannot be deleted or modified.

####### Navigation

  Configurations → Object Setup → Cases → Properties

##### 5.1.3.5. Create a case

###### Note

* To create a case manually, you must have View/Edit permission for Cases and Issues selected under Settings → Configurations → Access Management → Roles → Components → Cases & Issues.

* You can assign a case to a single domain only and you cannot change the assigned domain. For more information, see Case and issue domains.

* This option is only relevant for certain domains.

* You can't attach files to manually created cases.

###### Tip

* The issues that you link to a case can be linked to multiple cases, and the issue domains do not need to match the case domain.

##### 5.1.3.6. Issue syncing

###### Prerequisite

* You must set up an integration before you can sync issues. For more information, see Set up an integration for mirroring issues.

###### Note

* Multiple tickets can be linked to an issue with outbound syncing. Issues with inbound syncing can be linked to a single ticket only.

* Using issue fields as variables is not currently supported.

* You can only define a single inbound profile. If you change the inbound sync profile the current profile is overwritten. You can define multiple outbound profiles; one issue can update multiple tickets.

* The inbound syncing flow runs every two minutes, and the outbound syncing flow runs every five minutes. In a bi-directional set-up, if the same field is updated in both tickets, the most recently updated value is used. In the external ticket, the logged history shows updates to the ticket. The user name that is logged with the history reflects the user...

* After an issue is resolved, ticket syncing remains active for up-to seven days. Therefore, you still update, change, or reopen the issue or external ticket and the tickets will continue to sync.

* If you change the selected inbound sync profile, the original sync profile is immediately overwritten.

###### Warning

* If you leave this field blank, all configured instances will be used.

###### Tip

* You can find a sync profile ID under Settings → Configurations → Object Setup → Issues → Sync Profiles. By default the ID field is not displayed in the table. Click the three dot menu and add it to the table layout.

###### Navigation

  Settings → Configurations → Data Sources and click Add Data Source

  Settings → Configurations → Data Collection → Automation & Feed Integrations

###### 5.1.3.6.1. Create a sync profile

####### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

#### 5.1.4. Customize your cases

##### 5.1.4.1. External integrations

##### 5.1.4.2. Prioritize cases with starring and scoring

###### 5.1.4.2.1. Case starring

####### Navigation

  Cases & Issues → Case Configuration → Starred Issues

###### 5.1.4.2.2. Case scoring

####### 5.1.4.2.2.1. Set up case scoring

######## Note

* On the first activation, it can take up to 48 hours for SmartScore to calculate and display the score. Enabling SmartScore subsequently impacts the User Score.

* For scoped users, a small lock icon indicates that you don't have permissions to edit a rule.

##### 5.1.4.3. Customize issue fields and layouts

###### 5.1.4.3.1. Issue fields

####### Warning

* Deleting an issue field or uninstalling a content pack containing an issue field may affect detection and other capabilities based on the deleted field. For example, correlation, layouts, case scoring, starring rules, and playbook triggers.

####### 5.1.4.3.1.1. Issue field types

######## Note

* You cannot set filters, starring rules, playbook triggers, layout rules, or issue exclusions based on the values in custom timestamp fields.

* When grid field is shown in the Issues table, if there are values in the field, they do not display in the table. Instead, the column shows Data Available.

* When an HTML field is shown in the Issues table, if there is a value in the field, it does not display in the Issues table. Instead, the column shows Data Available. The following HTML tags are not permitted: blockquote, del, dd, div, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, iframe, ins, li, math, noscript, ol, pre, p, script, style, table,...

* When a Markdown field is shown in the Issues table, if there is a value in the field, it does not display in the table. Instead, the column shows Data Available.

####### 5.1.4.3.1.2. Create custom issue fields

######## Navigation

  Settings → Configurations → Object Setup → Issues → Fields → New Field

######## 5.1.4.3.1.2.1. Create a grid field

######## 5.1.4.3.1.2.2. Issue field triggered scripts

######## 5.1.4.3.1.2.3. Issue timer fields

######### 5.1.4.3.1.2.3.1. Configure issue timer fields

######### 5.1.4.3.1.2.3.2. Configure a playbook to run timers

######### 5.1.4.3.1.2.3.3. Automate changes to issue fields using timer scripts

######### 5.1.4.3.1.2.3.4. Use issue timer field commands manually in the CLI

###### 5.1.4.3.2. Issue layouts

###### 5.1.4.3.3. Create custom issue layouts

####### Note

* The script that runs when an action button is clicked accepts only mandatory arguments through the pop up window and does not provide an option for any non-mandatory arguments to be filled in when the button is clicked. We recommend using a wrapper script to collect and validate arguments in scenarios where there can be a combination of mandatory and...

####### Tip

* Limit the number of issue fields to 50 in each section. You can create additional sections as needed.

####### 5.1.4.3.3.1. Add a custom widget to an issue layout

######## Navigation

  Investigation & Response → Automation → Scripts and upload the following script: Expand script commonfields: id: ee3b9604-324b-4ab5-8164-15ddf6e428ab version: 49 name: IndicatorWidgetBar script: |- # Constants HIGH = 3 SUSPICIOUS = 2 LOW = 1 NONE = 0 indicators = [] scores = {HIGH: 0, SUSPICIOUS: 0, LOW: 0, NONE: 0} incident_id = demisto

  Investigation & Response → Automation → Scripts and upload the following script

  Settings → Configurations → Object Setup → Issues → Layouts

###### 5.1.4.3.4. Create rules for issue layouts

####### Navigation

  Settings → Configurations → Object Setup → Issues → Layout Rules → New Rule

##### 5.1.4.4. Customize case fields and layouts

###### 5.1.4.4.1. Create case timers and SLAs

####### Prerequisite

* Before you can create a case SLA, you must first create a timer field. A timer field can be associated with a single case SLA.

####### Note

* If you edit this filter after creation, the timer and associated SLA will be removed from any case that no longer qualifies, even if the timer is already running.

####### Navigation

  Settings → Configurations → Object Setup → Cases and open the Fields tab

####### 5.1.4.4.1.1. Update case timer and SLA fields

###### 5.1.4.4.2. Case fields

####### Warning

* Deleting a case field or uninstalling a content pack containing a case field may affect capabilities based on the deleted field, layouts and case scoring.

####### 5.1.4.4.2.1. Case field types

######## Note

* You cannot set filters, starring rules, playbook triggers, layout rules, or issue exclusions based on the values in custom timestamp fields.

* When grid field is shown in the Cases table, if there are values in the field, they do not display in the Cases table. Instead, the column shows Data Available.

* When an HTML field is shown in the Issues table, if there is a value in the field, it does not display in the Cases table. Instead, the column shows Data Available.

* When a Markdown field is shown in the Cases table, if there is a value in the field, it does not display in the Cases table. Instead, the column shows Data Available.

* If you make changes to case fields you can update the context data by running a playbook, script, or command. For more information, see Update case fields. To update dynamic custom case fields, such as SLA and Timer fields, see Update case timer and SLA fields.

####### 5.1.4.4.2.2. Create custom case fields

######## Navigation

  Settings → Configurations → Object Setup → Cases → Fields → New Field

######## 5.1.4.4.2.2.1. Create a grid field for a case

####### 5.1.4.4.2.3. Update case fields

######## Note

* Ensure that you have the required RBAC permission to write scripts.

###### 5.1.4.4.3. Case layouts

####### 5.1.4.4.3.1. Create custom case layouts

######## Note

* The script that runs when an action button is clicked accepts only mandatory arguments through the pop up window and does not provide an option for any non-mandatory arguments to be filled in when the button is clicked. We recommend using a wrapper script to collect and validate arguments in scenarios where there can be a combination of mandatory and...

######## Tip

* Limit the number of case fields to 50 in each section. You can create additional sections as needed.

####### 5.1.4.4.3.2. Create rules for case layouts

######## Note

* Layout rules support SBAC (scoped based access control). The following parameters are considered for editing access. If Scope-Based Access Control (SBAC) is enabled and Endpoint Scoping Mode is set to restrictive mode, you can edit a rule if you are scoped to all tags in the rule. If Scope-Based Access Control (SBAC) is enabled and Endpoint Scoping...

######## Navigation

  Settings → Configurations → Object Setup → Cases → Layout Rules → New Rule

##### 5.1.4.5. Create a case domain

###### Note

* Adding custom domains requires a View/Edit RBAC permission for Case Properties (under Object Setup). Once created, a custom case domain cannot be deleted or renamed.

###### Warning

* Before you add a custom domain, please review the built-in options. For more information, see Case and issue domains. We recommend using the built-in domains where possible. Custom domains might not be supported by all content. In addition, custom domains affect Cortex XSIAM's ability to learn, correctly identify, and score future cases. Smart...

###### Navigation

  Settings → Configurations → Object Setup → Cases → Domains

  Settings → Configurations → Access Management → User Groups

  Settings → Configurations → Access Management → Users

  To enable access to the domain for an API key, got to Settings → Configurations → Integrations → API Keys

##### 5.1.4.6. Create a sync profile

###### Note

* If an issue is using bi-directional syncing, you need to provide both an Inbound and an outbound sync profile.

* Blank fields are skipped. You must define exact values. Custom status values are not currently supported. Support is currently limited to a specific set of fields.

##### 5.1.4.7. Run indicator extraction in the CLI

###### Note

* Triggering enrichment on a substantial amount of indicators can take time (since it's activating all enrichment integrations per indicator) and can result in performance degradation.

#### 5.1.5. Cortex Copilot

##### 5.1.5.1. Cortex Copilot

###### 5.1.5.1.1. Key components and concepts

####### Note

* Agents are bound by the same rules and robust permissions as a human user. In addition, you can mark actions that make real-world changes in production systems as sensitive, requiring a quick manual review and confirmation, ensuring peace of mind before critical system changes are made.

###### 5.1.5.1.2. The Cortex Copilot use cases

##### 5.1.5.2. Manage agents in the Agents Hub

###### Note

* To manage agents in the Agents Hub, you must have proper permissions. For more information, see Role-based Access Control (RBAC).Role-based Access Control (RBAC)

* All users have access to all system agents, but plan execution is limited by the permissions of the individual user. A system agent may include actions that the user does not have permission to execute.

###### 5.1.5.2.1. Manage actions

####### Note

* To manage actions in the Cortex Agents Hub, you must have correct permissions. For more information, see Role-based Access Control (RBAC).Role-based Access Control (RBAC)

####### 5.1.5.2.1.1. Content packs with actions

######## Note

* Extract all indicators (such as IPs, domains, URLs, and hashes) from text, files, or entries, based on the tenant's indicator configuration.

* Sends an email to the desired mailbox using one of the configured mail integrations. Common use cases include notifications, ticketing updates, report sharing, and automated alerting workflows. This command is supported by the following integrations: Mail Sender (New) '–' Generic SMTP integration (e.g., Exchange, Postfix, SendGrid) EWS Mail Sender /...

* Sends a notification message to a user, group, or channel from a playbook or automation in Cortex XSIAM. Common use cases include automating notification flows, SOC collaboration, or escalating key events. This command is supported by the following integrations: Microsoft Teams '–' Post messages to Teams channels or users Slack '–' Send messages to...

######## Important

* Ensure all your content packs with actions are updated to the latest version to make the actions available for agents (indicated by a green check mark).

###### 5.1.5.2.2. Register actions

####### Note

* To register actions, ensure you have the correct permissions. For more information, see Role-based Access Control (RBAC).Role-based Access Control (RBAC)

* Mandatory arguments cannot be deselected.

####### Important

* A single content item such as a script can be registered as different actions, with each action using different inputs and outputs from the same script. Only register the same script as a new action if it is required for your use case, as providing an agent with many actions with overlapping abilities can reduce the ability of the agent to choose the...

###### 5.1.5.2.3. Manage agents

####### Note

* To manage agents in the Agents Hub, you must have view/edit permissions. For more information, see Role-based Access Control (RBAC).Role-based Access Control (RBAC)

###### 5.1.5.2.4. Build agents

####### Note

* To build agents in the Copilot Hub, you must have view/edit permissions. For more information, see Role-based Access Control (RBAC).Role-based Access Control (RBAC)

* If you clear the checkbox for a role, all actions associated with that role are also cleared. The exception is if another role is also selected, which is associated with the same actions. If you clear the checkbox for an action, all roles associated with that action are cleared. For example, if you select the Investigator role, and Send Mail and Tavily...

* Only users with view/edit permissions for scripts can register actions.

##### 5.1.5.3. Use the Copilot chat in an investigation

###### Note

* In the Copilot chat window, clicking Switch to previous version opens the original Copilot. The customizable keyboard shortcut  Ctrl+Alt+Shift+X also opens the original Copilot.

* An agent's proposed plans and results may contain inaccuracies or errors. Always review the results carefully to ensure you fully understand the proposed action before proceeding.

###### Tip

* If you need to quickly access various product pages within Cortex XSIAM, type / in the prompt.

##### 5.1.5.4. Use AI to develop scripts

###### Tip

* Use detailed prompts, for example, Get failed logins from last 24 hours and return as a table. Clearly define argument names, types, and default values. Mention if you expect the output in a specific format, such as a table, JSON, or plain text.

##### 5.1.5.5. Monitor and manage AI usage and access

###### 5.1.5.5.1. Cortex Copilot view

####### Note

* Access to the dashboard requires RBAC View permissions for Dashboards & Reports and Command Center Dashboards. Non-admin users who have these permissions can view shared system and custom agents as well as their own agents, listed under Other Agents. They cannot see other users' agents. The dashboards are available in dark mode only. They are not...

###### 5.1.5.5.2. Role-based Access Control (RBAC)

####### Note

* The Instance Administrator can manage agents regardless of whether they are shared.

###### 5.1.5.5.3. Responsible AI

### 5.2. Investigate cases

#### 5.2.1. Overview of the Cases page

##### Note

* For MSSP and multi-tenant administrators, if the Unified Case View is enabled, this view consolidates all cases across your distributed environment, allowing you to view and perform actions on child tenants. If the Unified Case view is disabled, this view displays a single tenant at a time with a drop-down list for moving between tenants in read-only...

* When an issue is resolved, it remains linked to a case and appears in this section. Once all of the issues in a case are resolved, the case is automatically closed.

##### Tip

* Set a default tab in the details pane by selecting the pin icon next to a tab. Click on the Notepad, Messenger, and Case Context Data icons to add notes on the case, and see existing notes from other analysts.

##### 5.2.1.1. Saved table views

##### 5.2.1.2. Unified case view

###### License Type

  Requires an MSSP license.

###### Note

* Requires the following RBAC permissions:    Cases & Issues   Investigation & Response → Automation Requires the following RBAC permissions: Cases & Issues Investigation & Response → Automation This view is available for the parent tenant only. To take actions on a child tenant from a parent tenant, you must have the appropriate permissions for both...

* Custom case layouts of child tenants are not visible in the parent tenant.

#### 5.2.2. Review and investigate a case

##### Note

* If you do not have permissions to access an asset of a case (which is shown as grayed out and locked), check your scoping permissions in Manage Users or Manage User Groups.

* In some cases, the number of issues associated with the techniques will not be aligned with the number of the parent tactic because of missing tags or in case an issue belongs to several techniques.

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

* Cloud related issues are displayed in the User Name grouping. Prisma Cloud Compute issues are displayed in the Host Name grouping.

### 5.3. Investigate issues

#### 5.3.1. Overview of the Issues page

##### Note

* Every 12 hours, the system enforces a cleanup policy to remove the oldest issues once the maximum limit is exceeded. The default issue retention period in Cortex XSIAM is 186 days.

#### 5.3.2. Issue card

##### License Type

  Requires the TIM add-on.

##### Note

* This section is context specific and shows data according to the issue context.

##### 5.3.2.1. Use the War Room in an investigation

###### Note

* The case War Room is usually used for communication capabilities, but unlike the issue War Room, it does not include playbook specific entries. The case War Room enables you to investigate an entire case, not just an issue.

* Cortex XSIAM does not index notes and chats.

###### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

* You can use the up/down arrow buttons in the CLI to do a reverse history search for previous commands with the same prefix.

###### Navigation

  Investigation & Response → Automation → Playground

##### 5.3.2.2. Use the Work Plan in an investigation

#### 5.3.3. Triage and investigate issues

##### 5.3.3.1. Copy issues

##### 5.3.3.2. Run an automation on an issue

###### Note

* In addition to automation, some playbooks contain manual tasks that prompt the analyst for input. This enables you to enhance an automation workflow with analyst input.

* You can also manually select a playbook to run from the Issue Work Plan tab.

##### 5.3.3.3. Investigate contributing events

##### 5.3.3.4. Create a featured field

###### Note

* Featured Active Directory values are displayed in the User and Host fields accordingly.

###### Navigation

  Cases & Issues → Case Configuration → Featured Fields and select a type of featured field

##### 5.3.3.5. View generating BIOC or IOC rule

##### 5.3.3.6. Export issue details to a file

##### 5.3.3.7. Exclude an issue

##### 5.3.3.8. Query case and issue data

###### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

##### 5.3.3.9. Update issue fields

###### Note

* You must create a custom status before you can select it.

###### Tip

* You can create custom issue statuses and resolution reasons, and use the setIssueStatus command to set these custom statuses for issues. For example, when a user starts investigating an issue, the issue status is automatically changed from New to Under Investigation. In some cases, it is useful to create an interim status, such as Triage. After you...

##### 5.3.3.10. Close an issue

###### Note

* When an issue is resolved it remains linked to a case. Once all of the issues in a case are resolved, the case is automatically closed.

#### 5.3.4. Cortex Response and Remediation content pack

##### 5.3.4.1. Investigate an issue using Cortex Response and Remediation playbooks

##### 5.3.4.2. Example use cases

### 5.4. Investigate findings

#### Note

* Depending on your license type, some finding types require the Cortex Cloud Posture Management add-on.

#### 5.4.1. Findings card

##### Note

* The information in this card is context specific, therefore some sections are not available for all findings.

### 5.5. Investigate artifacts and assets

#### 5.5.1. Investigate an IP address

##### Note

* Requires a license key. Select Settings → Configurations → Integrations  → Threat Intelligence.

#### 5.5.2. Investigate an asset

##### Note

* The Asset view is available for hosts with a Cortex XDR agent installed.

#### 5.5.3. Investigate a host

##### License Type

  The Host Risk View requires the Identity Threat Module add-on.

##### Tip

* You can also see a list of all hosts under Inventory → Assets → Asset Scores.

#### 5.5.4. Investigate a file and process hash

##### Note

* Requires a license key. Go to Settings → Configurations → Integrations  → Threat Intelligence.

#### 5.5.5. Investigate a user

##### License Type

  If the Identity Threat module is enabled you can open the User Risk View. This view displays insights and profiling information to help you investigate issues and cases. Viewing anomalies in the context of baseline behavior facilitates risk assessment and shortens the time you require for making verdicts. If the Identity Threat module is not enabled...

##### Note

* Cortex XSIAM normalizes and displays case and issue times in your time zone. If you're in a half-hour time zone, the activity in the Normal Activity and the Actual Activity charts is displayed in the whole-hour time slot preceding it. For example, if you're in a UTC +4.5 time zone, the time displayed for the activity will be UTC +4.5, however, the...

##### Tip

* You can also see a list of all users under Assets → Asset Scores.

### 5.6. Investigate endpoints

#### 5.6.1. Overview of the Action Center

##### Navigation

  Investigation & Response → Response → Action Center

##### 5.6.1.1. Initiate and monitor endpoint actions

###### Navigation

  Investigation & Response → Response → Action Center → New Action

  Investigation & Response → Response → Action Center

##### 5.6.1.2. Action Center reference information

### 5.7. Investigate files

#### 5.7.1. Manage quarantined files

#### 5.7.2. Review WildFire analysis details

##### Note

* Cortex XSIAM displays the preview of WildFire reports that were generated within the last couple of years. To view a report that was generated more than two years ago, you can download the report.

### 5.8. Automations

#### 5.8.1. Automation in Cortex XSIAM

##### Note

* You can build end-to-end automation workflows from within the playbook editor, including creating automation rules, configuring integration instances, and creating and editing tasks. For more information, see Playbooks.

#### 5.8.2. Quick Actions

##### Note

* When investigating an issue, in the Issues table, you can right-click to Run an Automation on one or more issues. For more information, see Manually run a playbook or Quick Action on one or more issues.

#### 5.8.3. Manage automation exclusion policies

##### Note

* For the IAM User Hard Remediation and User Soft Remediation policies, we recommend including username, email, and ID for each user you want to exclude. Example: username1, user@example.com, userID112.

* You can also right click on a policy from the main Automation Exclusion Center page to disable or enable the policy. If you click on a list name in the Exclude column, that list opens in the Lists page.

#### 5.8.4. Playbooks

##### 5.8.4.1. Playbooks overview

##### 5.8.4.2. Playbook development checklist

##### 5.8.4.3. Plan your playbook

##### 5.8.4.4. Manage playbooks

###### Note

* The library by default shows only playbooks that are not adopted. Click the Show Adopted checkbox to show the adopted playbooks, indicated by an Adopted mark. The library shows the most updated playbook version. Adopting an older version than shown should be done through Marketplace. Adopting a playbook does not make it run. Some content packs include...

##### 5.8.4.5. Build your playbook

###### 5.8.4.5.1. Task 1. Choose from existing playbooks or create your own

####### Tip

* If there are additional relevant playbooks in Marketplace that are not in your Org repository, you can click Explore them now to see them in the Playbook Catalog and choose to adopt.

* To open multiple playbooks at the same time, edit the first playbook and then click New next to the playbook name to create a new tab. You can either create a new playbook, or add an existing one. You can view recently modified or deleted playbooks by clicking version history for all playbooks .

####### Navigation

  the Investigation & Response → Automation → Playbooks page to customize or create a playbook

###### 5.8.4.5.2. Task 2. Configure playbook settings

####### Note

* If the playbook has inputs and outputs, the Playbook Starts task will show back and forth arrows. Clicking them opens the Playbook Settings pane Inputs/Outputs tab.

* This rule will trigger the playbook to run if no other Automation Rule triggers the playbook first. You can view and edit the order the rules run in the Automation Rules page.

* If you do not add any fields, the group will be deleted when you click Save.

###### 5.8.4.5.3. Task 3. Add objects from the Task Library

####### 5.8.4.5.3.1. Add Quick Actions, commands, and scripts

######## Note

* If the Quick Action requires an integration instance and it is not yet configured, you have the option to create an integration instance from within the playbook editor.

* If you want to add a script that is not yet adopted, Cortex XSIAM automatically installs the content pack containing the script. If the script requires an integration instance, you are prompted to configure one.

* If you do not have permission to download the script, contact your administrator for help. You can also filter by "show only configured" to show scripts you can use.

* The output value is dynamic and is derived from the context at the time that the task is processed. As a result, parallel tasks that are based on the same output may return inconsistent results.

####### 5.8.4.5.3.2. Add sub-playbooks

######## Tip

* Balance between the number of iterations and the interval so you do not overload the server.

####### 5.8.4.5.3.3. Add manual tasks and blank tasks

######## 5.8.4.5.3.3.1. Create a standard task

######## 5.8.4.5.3.3.2. Create a conditional task

######## 5.8.4.5.3.3.3. Create a communication task

####### 5.8.4.5.3.4. Create a section header

####### 5.8.4.5.3.5. Configure script error handling in a playbook

######## Note

* Use the GetErrorsFromEntry script (part of the Common Scripts Pack) to check whether the given entry returns an error and returns an error message. For example, when using the script in a playbook, you can fetch the error message from a given task, such as a runtime error. You can then add a step in the playbook flow to send those error messages to the...

* You can set up script error handling only when running a script in a Standard task or a Conditional task. For more information about error handling settings for these tasks, see Create a standard task or Create a conditional task. Built-in, Manual, and Ask Conditional tasks have On Error settings for number of retries and retry interval, but not Error...

###### 5.8.4.5.4. Task 4. Add custom playbook features

###### 5.8.4.5.5. Task 5. Test and debug the playbook

###### 5.8.4.5.6. Task 6. Manage playbook content

##### 5.8.4.6. Customize your playbook

###### 5.8.4.6.1. Configure a sub-playbook loop

####### Note

* Consider the following when adding a loop: The maximum number of loops (default is 100). A high number of loops or a high wait time combined with a large number of issues may affect performance. Periodically check looping conditions to ensure they are still valid for the data set. If you want a sub playbook task to loop over an array passed into its...

####### Tip

* Balance between the number of iterations and the interval so you do not overload the server.

###### 5.8.4.6.2. Filter and transform data

####### Caution

* You can change the context data root to filter, but it is not recommended to select a different root, as it affects the filter results. The drop-down list displays the filter root for backward compatibility.

####### Navigation

  Investigation & Response → Automation → Scripts → New Script

####### 5.8.4.6.2.1. Filter considerations, categories, and built-in filters

######## Note

* Is defined considers false and empty strings and lists to be defined values. If you don't want those to be included as defined, use Is not empty.

* Not defined considers false and empty strings and lists to be defined values. If you don't want those to be included as defined, use Is empty.

####### 5.8.4.6.2.2. Transformer considerations, categories, and built-in transformers

######## Note

* To make regex case non-sensitive, use the (?i) prefix (for example (?i)yourRegexText.

###### 5.8.4.6.3. Extract indicators

####### Note

* This configuration may delay playbook execution (issue creation). While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

###### 5.8.4.6.4. Extend context

###### 5.8.4.6.5. Update issue fields with playbook tasks

####### Note

* The setIssue script includes all available fields; use the scroll bar to see all the fields. The name field has a limit of 600 characters. If there are more than 600 characters, you can shorten the name field to under 600 characters and then include the full information in a long text field such as the description field. There are many fields already...

###### 5.8.4.6.6. Playbook polling

####### Note

* You need to use the GenericPolling playbook as a sub-playbook in a main playbook, such as Detonate File - JoeSecurity. The main playbook should follow this structure: Start Command: The task contains a command that fetches the initial state of the process and saves it to context. This command starts the process that should be polled. For...

##### 5.8.4.7. Test your playbook

###### Note

* The debugger does not support using parentIncidentFields.

* Using an existing issue in the debugger does not affect the original issue or change the original context data.

###### 5.8.4.7.1. Troubleshoot playbook performance

##### 5.8.4.8. Manage playbook content

##### 5.8.4.9. Best practices

###### Note

* If you reattach a detached playbook, any customizations you have made to the playbook will be overwritten when the playbook updates to the current version.

* Retries are not supported for data collection tasks that have errors sending emails (indicated by a server timeout). This is because retries only work on automation execution failures, not on email delivery issues.

#### 5.8.5. Create an automation rule

##### Note

* You can also define the conditions that trigger a specific playbook in the playbook editor. For more information, see Task 2. Configure playbook settings

##### Important

* Automation rules apply to Medium and higher severity issues. They also apply to Low severity Analytic issues and Low severity ABIOC issues that are tagged with Identity or Cloud. Rules are evaluated in order, and only the first rule that matches the trigger conditions is executed.

#### 5.8.6. Context data

##### 5.8.6.1. Issue context data

##### 5.8.6.2. Case context data

##### 5.8.6.3. Search context data

##### 5.8.6.4. Add context data to an issue

##### 5.8.6.5. Add context data to a case

###### Note

* If you run the command in the issue War Room, the data is added to the following places: The case context data. The issue context data under the case tab. If you run the command in the Case War Room, the data is added to the case context data only.

##### 5.8.6.6. Delete context data from a case

##### 5.8.6.7. Use context data in a playbook

###### Note

* Generic polling does not work if a playbook's context data is shared globally. For more information, see Playbook polling.

###### Caution

* Users with Trigger Playbook permissions on a given issue may still be able to modify the parent case via commands and scripts, even without full access to the case.

#### 5.8.7. Lists

##### Note

* The maximum list size is 209,715 characters (approximately 200 KB).

##### 5.8.7.1. Create a list

###### Note

* If you want to edit a list from a content pack, you need to duplicate or detach a list. Detached lists do not receive updated content in subsequent Cortex XSIAM content releases. To retain an updated list, reattach it.

###### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

##### 5.8.7.2. List commands

##### 5.8.7.3. Use cases: JSON lists

###### Navigation

  Settings → Configurations → Object Setup → Lists → Add a List

  Investigation & Response → Automation → Playbooks → New Playbook

##### 5.8.7.4. Transform a list into an array

###### Navigation

  Investigation & Response → Automation → Playbooks and create or edit a playbook

#### 5.8.8. Jobs

##### 5.8.8.1. Manage jobs

###### Note

* Only Account Admins and Instance Administrator roles can create jobs and view/edit job runs. If the owner of a job has been removed from Cortex XSIAM, the job will fail to run. In this case, you must change the owner to a current user.

##### 5.8.8.2. Create a time triggered job

###### Note

* To view a human readable description of a cron schedule for an existing job, click  and select Job Schedule from the available columns.

###### Important

* We recommend to avoid triggering a job while a previous run of the job is active by configuring the playbook a job triggers to close the investigation before running a new instance of the job.

##### 5.8.8.3. Create a job triggered by a delta in a feed

###### Note

* A job triggered by a delta in a feed runs only if there is a change in the feed, and does not run on a feed's initial fetch. For the initial fetch, you can run the playbook manually and then set up an event triggered job for subsequent fetches. If you want to trigger a job after a feed completes a fetch operation and the feed does not change...

###### Navigation

  Investigation & Response → Automation → Jobs → New Job

#### 5.8.9. Engines

##### 5.8.9.1. What is an engine?

###### Note

* You cannot share a multiple-engine installation with a single-engine installation.

* When you add an engine to a load-balancing group, you cannot use that engine separately. The engine does not appear in the engines menu when configuring an integration instance, but you can choose the load-balancing group.

##### 5.8.9.2. Engine requirements

###### Note

* The Cron package is required to install engines on a Linux machine.

* CentOS 8.x reached End of Life (EOL) on December 31, 2021, and is no longer supported as an operating system. CentOS 7.x reached End of Life (EOL) on June 30, 2024, and is no longer supported as an operating system.

##### 5.8.9.3. Install an engine

###### Note

* If you are using DEB, RPM, or Zip installation, install Docker or Podman. Natively running Python or PowerShell integrations/scripts on Windows or Linux is not supported on Cortex XSIAM engines.

* When upgrading an engine that was installed using the Shell installation, you can use the Upgrade Engine feature in the Engines page. For Amazon Linux 2 type engines, you need to upgrade these engine types using a zip-type engine and not use the Upgrade Engine feature. If you use the shell installer, Docker/Podman is automatically installed. We...

* Use DEB and RPM installation when the shell installation is not available. You need to manually install Docker or Podman  and any dependencies.

* If you receive a permissions denied error, it is likely that you do not have permission to access the /tmp directory. If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom...

###### Important

* For DEB/RPM engines, Python (including 3.x) and the containerization platform (Docker/Podman) must be installed and configured. For Docker or Podman to work correctly on an engine, IPv4 forwarding must be enabled.

###### Tip

* For Linux systems, we recommend using the shell installer. If using Amazon Linux 2, use the zip installer (see step 4).

###### 5.8.9.3.1. Docker

####### Note

* This section is relevant when installing an engine.

* Docker images can be downloaded together with their relevant content packs for offline installation.

####### 5.8.9.3.1.1. Install Docker

######## Note

* For Red Hat's Docker distribution, you need Mirantis Container Runtime (formerly Docker Engine - Enterprise) to run specific Docker-dependent integrations and scripts. For more information, see Install Docker distribution for Red Hat on an engine server. To use the Mirantis Container Runtime (formerly Docker Engine - Enterprise) follow the deployment...

######## 5.8.9.3.1.1.1. Install Docker distribution for Red Hat on an engine server

######## 5.8.9.3.1.1.2. Docker image security

######## 5.8.9.3.1.1.3. Docker FAQs

######## 5.8.9.3.1.1.4. Troubleshoot Docker issues

######## 5.8.9.3.1.1.5. Configure Docker pull rate limit

######## 5.8.9.3.1.1.6. Change the Docker installation folder

####### 5.8.9.3.1.2. Docker hardening guide

######## Note

* The settings below can also be applied to Podman, with the exception of limiting available memory, limiting available CPU, and limiting PIDS.

* If you do not want to apply Docker memory limitations, you should explicitly set the advanced parameter: limit.docker.memory to false.

######## Tip

* We recommend reviewing Docker network hardening below before changing any parameters in the configuration file. To securely run Docker containers, we recommend using the latest Docker version.

###### 5.8.9.3.2. Podman

####### Note

* When upgrading an engine, the engine keeps the previously used container management type (regardless of distribution version).

####### 5.8.9.3.2.1. Change the container storage directory

######## Note

* Alternatively, the runroot setting may be set to some temporary directory that is accessible by the user demisto. If you choose to set the runroot, it must be a directory that is mounted as tmpfs (temporary filesystem), unlike the graphroot.

######## Warning

* Do not use NAS storage or a temporary (tmpfs) directory for the graphroot setting. The graphroot needs to be a local, non-temporary directory for Podman to work. For more information, see https://en.wikipedia.org/wiki/Network-attached_storage.

######## Tip

* We recommend reserving 150 GB for container storage, either in the /home partition or a different storage directory that you have set using the graphroot key.

####### 5.8.9.3.2.2. Install Podman

######## Note

* This procedure is intended for RHEL 8 or later. It may not work for other operating system types. Do not use NAS storage for the $HOME directory. The directory needs to be a local directory for Podman to work.

* If you edit the file with the root user, make sure to set the demisto user as file owner by running chown demisto:demisto /home/demisto/.config/containers/registries.conf

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

####### 5.8.9.3.2.3. Migrate From Docker to Podman

####### 5.8.9.3.2.4. Troubleshoot Podman

######## Note

* This step removes all Podman images, including any custom images you may have created.

* $(id -u demisto) is used to get the demisto user ID, which is part of the directory name. For example, /tmp/podman-run-993 Not all the directories above may be present.

* When you run podman container cleanup --rm -a, you might see a message such as running or paused containers cannot be moved without force. The message can be safely ignored, as it only pertains to current running containers, which are not removed.

* To change to the demisto OS user, run the following command: sudo su - -s /bin/bash demisto

* You must switch to user demisto before running the "system migrate" (running it as root will have no effect).

* The "system migrate" must be done by the user demisto.

######## Important

* The runroot must be located under the tmpfs file system type. This is required to clean Podman's run state on reboot and for performance reasons.

######## Caution

* Unlike the runroot, the graphroot must NOT be located under the tmpfs file system type. Using tmpfs for the graphroot might corrupt container images, causing command executions to fail. It also degrades performance by forcing Podman to needlessly re-pull images.

##### 5.8.9.4. Manage engines

###### Navigation

  You can manage your engines and load-balancing groups by going to Settings → Configurations → Data Broker → Engines

##### 5.8.9.5. Upgrade an engine

###### Note

* The upgrade.conf file is available on the engine after it has been upgraded to Cortex XSIAM 3.1. Any custom variables you add to the file are applied when you upgrade from Cortex XSIAM 3.1 to Cortex XSIAM 3.2 or later.

##### 5.8.9.6. Remove an engine

##### 5.8.9.7. Configure engines

###### Note

* A day is defined as 24 hours and may not exactly correspond to calendar days due to daylight savings, leap seconds, etc.

* In addition, to support engine upgrades from the UI, edit the /usr/local/demisto/upgrade.conf file on the engine to include the SERVER_URLS setting with the new tenant's address. Include only the host, without https:// or any additional path at the end of the host name. For example: SERVER_URLS="api-example.us.paloaltonetworks.com"

* If the engine loses communication for longer than this time, it will disconnect and you need to restart the service.

###### 5.8.9.7.1. Configure the engine to use a web proxy

####### Note

* You need to configure Docker to use a proxy. When using a BlueCoat proxy, ensure you encode the values correctly.

* In an environment with a single engine, go to /usr/local/demisto/upgrade.conf. In an environment with multiple engines, go to /usr/local/demisto/<engine-name>/upgrade.conf, replacing <engine-name> with the name of the engine. Note that the key is in the upgrade.conf file and must be https_proxy, even if your proxy address starts with http://.

###### 5.8.9.7.2. Configure the engine to call the server without using a proxy

####### 5.8.9.7.2.1. Use NGINX as a reverse proxy

######## Note

* For multi-tenant deployments, replace location ~ ^/(websocket|d1ws|d2ws) { with location ~ ^/(acc_\S+/)?(websocket|d1ws|d2ws)

###### 5.8.9.7.3. Configure an engine to use custom certificates

##### 5.8.9.8. Use an engine in an integration

###### Note

* Long-running integrations should not run on load-balancing groups.

##### 5.8.9.9. Run a script using an engine

###### Navigation

  Investigation & Response → Automation → Scripts

##### 5.8.9.10. Troubleshoot engines

###### Note

* Ensure that pop-ups are not blocked by your browser.

* If the installer fails to start due to a permissions issue, even if running as root, add one of the following two arguments when running the installer: --target <path> - Extracts the installer files into the specified custom path. --keep - Extracts the installer files into the current working directory (without cleaning at the end). If using installer...

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl status d1_<Engine _name>

* Any changes made to variables in the upgrade_engine.sh file are reset after each upgrade. We recommend instead using the upgrade.conf file to set variables.

* You can ignore the following error: Cannot create folder '/var/lib/demisto'

###### Navigation

  When troubleshooting engines, access the logs from Settings → Configurations → Engines and select the engine from which you want to download the logs

##### 5.8.9.11. Troubleshoot integrations running on engines

###### Note

* If the Allow running multiple engines on the same machine option is selected, run the command: sudo systemctl restart d1_<Engine _name>

* Docker CE installations typically run Docker, while Docker EE installations typically run dockerroot.

### 5.9. Response actions

#### Caution

* Response actions are not supported for Android endpoints.

#### 5.9.1. Manage external dynamic lists

##### Note

* To configure an EDL, you must have a role that includes EDL permissions, such as Instance Admin or Account Admin. Configuring custom certificates or private API Keys in the EDL integration instance is supported only on engines, not on the Cortex XSIAM server. For EDL integrations on the server, you must set a username and password. For long-running...

* The legacy external dynamic list PAN-OS integration is deprecated. Configure the EDL integration by clicking the Automation & Feed Integration link.

* If the EDL integration runs on the Cortex XSIAM server, you do not need to enter a Listen Port in the instance settings. The system auto-selects an unused port for the EDL integration when the instance is saved. If you enter a value for Listen Port, it will be overwritten by the port auto-selected by the system

##### Important

* The EDL URL must always be prefixed by ext-.

### 5.10. Forensics

#### License Type

  Requires the Forensics add-on

#### 5.10.1. Forensic investigations

##### 5.10.1.1. Manage an investigation

###### 5.10.1.1.1. Create a new investigation

####### Note

* To set up user permissions, you must have Scope-Based Access Control (SBAC) enabled.

###### 5.10.1.1.2. Edit an investigation

###### 5.10.1.1.3. Close an investigation

####### Note

* When you close an investigation, Palo Alto Networks has a grace period of 24 hours before deleting any collections associated with the investigation. During this timeframe, you have the option to cancel the close investigation action.

###### 5.10.1.1.4. User permissions

####### Note

* Even if a user does not have access to view an investigation via the Forensics Investigations page, they can still query the results of the collections using an XQL query.

##### 5.10.1.2. Data collection

###### 5.10.1.2.1. Hunting

####### 5.10.1.2.1.1. Create a hunt

######## Note

* You can save hunts in an incomplete state and edit them later. After a hunt has run, you cannot edit it. Instead, you can duplicate to create a new hunt with the same configuration in order to edit.

* When search fields are specified, the results of the search are limited based upon those filters. If more than one entry in a search filter field, the search returns entries that match any of the provided entries. For example: A File Search with two specified paths ("C:\Test\*" and "C:\Windows\*") will return results from both the Test folder and the...

####### 5.10.1.2.1.2. Hunt results

######## Note

* The grouping button () shows the number of affected endpoints grouped by executable name. This enables you to perform hunting via frequency analysis (referred to as stacking) and provides a birds eye view of potential malware files that require further analysis.

* The grouping button () shows the number of affected endpoints grouped by file path. This enables you to perform hunting via frequency analysis (referred to as stacking) and provides a birds eye view of potential malware files that require further analysis.

####### 5.10.1.2.1.3. Hunt status

###### 5.10.1.2.2. Triage

####### 5.10.1.2.2.1. Create a triage

####### 5.10.1.2.2.2. Upload an offline triage package

######## Note

* Do not upload memory images captured by the Offline Triage Collector. These images are collected for analysis using third-party tools and are not intended for upload.

####### 5.10.1.2.2.3. Offline triage collection

######## Note

* Security software running on the endpoint (including the Cortex agent) can interfere or block the execution of the offline triage collector. Disable any security software on the endpoint while the collector is running or whitelist the collector in your security software before running the offline triage collector.

####### 5.10.1.2.2.4. Triage results

####### 5.10.1.2.2.5. Triage status

##### 5.10.1.3. Analysis and documentation

###### 5.10.1.3.1. Review alerts

###### 5.10.1.3.2. Investigation timeline

###### 5.10.1.3.3. Key assets & artifacts

##### 5.10.1.4. Export

###### Note

* You can export a collection more than once.

### 5.11. Notebooks

#### Prerequisite

* Cortex XSIAM Notebooks usage requires the following. Cortex XSIAM Enterprise or Cortex XSIAM Premium. Apps and XQL RBAC permissions.    To use Notebooks, you must have the View/Edit permissions in Settings → Configurations → Access Management → Roles → Apps → Jupyter.   To configure Notebooks, you must have the View/Edit permissions...

#### Note

* You can only add one instance of Notebooks. Cortex XSIAM Notebooks has access to approved sites on the internet when embedded in Cortex XSIAM. The Notebooks instance includes restart options.

#### Navigation

  Settings → Configurations → Integrations → Apps

  To edit the Notebooks instance, from Settings → Configurations → Integrations → Apps, hover over the instance and select the edit icon

#### 5.11.1. Manage datasets in Notebooks

##### Note

* If a schema is not provided, the function detects the schema automatically.

* Using this function, you can only delete datasets created using the Notebooks APIs . When you delete a dataset, the rules that use the dataset return an error.

#### 5.11.2. Notebooks scheduler

### 5.12. Build XQL queries

#### 5.12.1. About the Query Builder

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

#### 5.12.2. How to build XQL queries

##### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

##### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

##### 5.12.2.1. Get started with XQL queries

###### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

##### 5.12.2.2. Useful XQL user interface features

###### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

##### 5.12.2.3. XQL Query best practices

##### 5.12.2.4. Expected results when querying fields

##### 5.12.2.5. Create XQL query

###### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

###### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

##### 5.12.2.6. Review XQL query results

###### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* In order for Cortex XSIAM to provide a histogram for a field, the field must not contain an array or a JSON object.

##### 5.12.2.7. Translate to XQL

###### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

##### 5.12.2.8. Graph query results

###### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

#### 5.12.3. Query Builder templates

##### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

##### 5.12.3.1. Get started with Query Builder templates

##### 5.12.3.2. Considerations for using Query Builder templates

##### 5.12.3.3. Create a query from a template

###### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

##### 5.12.3.4. Run a free text query

###### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

##### 5.12.3.5. Query Builder template examples

###### Navigation

  Investigation & Response → Search → Query Builder

#### 5.12.4. Edit and run queries in Query Center

##### Navigation

  Investigation & Response → Search → Query Center

##### 5.12.4.1. Query Center reference information

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 5.12.5. Manage scheduled queries

##### Navigation

  Investigation & Response → Search → Scheduled Queries

##### 5.12.5.1. Scheduled Queries reference information

###### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

#### 5.12.6. Manage your personal query library

##### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

#### 5.12.7. Legacy Query Builder

##### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

##### 5.12.7.1. Create authentication query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 5.12.7.2. Create event log query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 5.12.7.3. Create file query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 5.12.7.4. Create image load query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 5.12.7.5. Create network connections query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 5.12.7.6. Create network query

###### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

##### 5.12.7.7. Create process query

###### Navigation

  Investigation & Response → Search → Query Builder

##### 5.12.7.8. Create registry query

###### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

##### 5.12.7.9. Query across all entities

###### Navigation

  Investigation & Response → Search → Query Builder

## 6. Threat management

### 6.1. Enable prompt log collection in Azure

### 6.2. Detection rules

#### 6.2.1. What are detection rules?

##### 6.2.1.1. What's an IOC?

###### Note

* Cortex XSIAM supports a maximum of 4,000,000 IOCs.

###### 6.2.1.1.1. IOC rule details

####### Note

* Field cannot exceed 36 characters.

####### Navigation

  In the Threat Management → Detection Rules → IOC page, you can view all configured or uploaded indicators of compromise (IOCs

###### 6.2.1.1.2. Create an IOC rule

####### Note

* To ensure your IOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically does the following: Disables any IOC rules that reach 5000 or more hits over 24 hours. Creates a rule exception based on the PROCESS SHA256 field for IOC rules that hit more than 100 endpoints over 72 hours. If you have the Threat...

####### Navigation

  In Threat Management → Detection Rules → IOC, select + Add IOC

##### 6.2.1.2. What's a BIOC?

###### 6.2.1.2.1. BIOC rule details

####### Navigation

  Manage your behavioral indicator of compromise (BIOC) rules in Threat Management → Detection Rules → BIOC

###### 6.2.1.2.2. Create a BIOC rule

####### License Type

  Custom prevention rules are supported on Cortex XSIAM agent 7.2 and later versions and enable you to configure and apply user-defined BIOC rules to Restriction profiles deployed on your Windows, Mac, and Linux endpoints.

####### Note

* To ensure your BIOC rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically does the following: Disables BIOC rules that reach 5000 or more hits over a 24-hour period. Creates a rule exception based on the PROCESS SHA256 field for BIOC rules that hit more than 100 endpoints over a 72 hour period.

* A cloud_audit_log dataset requires a Cortex XDR Pro per GB license. Currently, you cannot create a BIOC rule on customized datasets and only the filter stage, alter stage, and functions without any aggregations are supported for XQL queries that define a BIOC. For BIOC rules, the field values in XQL are evaluated as case insensitive (config...

* To demonstrate the expected behavior of the rule before you save it, Cortex XSIAM tests the BIOC on historical logs. After you save a BIOC rule, it will operate both on historical logs (up to 10,000 hits) and on new data received from your log sensors.

* To demonstrate the expected behavior of the rule before you save it, Cortex XSIAM tests the BIOC on historical logs. After you save a BIOC rule, it will operate on both historical logs (up to 10,000 hits) and new data received from your log sensors.

* You can only import files that were exported from Cortex XSIAM. You can not edit an exported file.

* You can only add to existing profiles you created, Cortex XSIAM Default profiles will not appear as an option.

* Auto-disable will turn off both the BIOC rule detection and the BIOC prevention rule.

###### 6.2.1.2.3. Manage Global BIOC Rules

##### 6.2.1.3. What's a correlation rule?

###### Navigation

  After you configure your correlation rules, you can manage them in Threat Management → Detection Rules → Correlations, and view and analyze the generated issues in Cases and the Issues Table

###### 6.2.1.3.1. Correlation rule details

####### Note

* Only an administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM .

* For more information on troubleshooting server errors in scheduled correlation rules, Troubleshoot server errors in scheduled correlation rules.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

####### Navigation

  If you are assigned a role that enables Investigation → Rules privileges, you can manage all user-defined Correlation Rules from Threat Management → Detection Rules → Correlations

###### 6.2.1.3.2. Create a correlation rule

####### Prerequisite

* To enable pivots from issues to a third-party source system, ensure that you know the dataset field name which contains the URL of the source system. Some vendors already provide this URL as part of their API, and you can find it in the third-party product dataset. If there is no URL, you cannot enable this feature.

####### Note

* When creating a Real Time Correlation Rule, you can only generate an issue as the resulting action for the Correlation Rule. All other options are disabled. To ensure your Correlation rules generate issues efficiently and do not overcrowd your Issues table, Cortex XSIAM automatically disables Correlation rules that reach 5000 or more hits over a...

* When you open the New Correlation Rule editor from XQL Search, this XQL Search field is already populated with the XQL query that you defined. An administrator can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM . All other users can only create and view queries built with an existing dataset.

* The XQL features for call, top, and wildcards in datasets (dataset in (<dataset prefix>_*)) are currently not supported in Correlation Rules. If you add them to the XQL definition, you will not be able to Create or Save the Correlation Rule. The XQL features for transaction in datasets (dataset in (<dataset prefix>_*)) are currently not supported in...

* The incident that contains the issues will also be assigned to the selected domain. For more information, see Case and issue domains. If you want to generate a health issue, choose the Health domain. For more information about health issues, see About health issues.

* If a generated issue has severity Medium or above, a case is automatically opened. Low severity issues generated by correlation rules are not grouped into cases.

* There is no validation or auto complete for these parameters and the values can be null or empty. In these scenarios, Cortex XSIAM does not display the null or empty values, but adds the text NULL or EMPTY in the descriptions.

* When more than one XDM field is listed, Cortex XSIAM looks for the field value according to the order of the fields listed.

* When Use the Cortex XSIAM default incident enrichment is not selected and you have not mapped any issue fields, the issue is dispatched into a new incident.

####### Important

* The maximum size of a lookup dataset is 50 MB. If the data exceeds this limit, the add to lookup action fails.

####### Tip

* When creating your correlation rule, you can use predefined values for different fields in the editor, such as Alert Name, Alert Description, and Drill-Down Query. For more information, Field replacement syntax in correlation rules.

####### Navigation

  You can create a new correlation rule from either the Threat Management → Detection Rules → Correlation Rules page or when building a query in XQL Search

###### 6.2.1.3.3. Field replacement syntax in correlation rules

###### 6.2.1.3.4. Manage correlation rules

####### Note

* Execute Rule is not available for real time correlation rules.

###### 6.2.1.3.5. Monitor correlation rules

####### Note

* In the dataset, the Query start time and Query end time indicate the time frame of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

###### 6.2.1.3.6. Troubleshoot server errors in scheduled correlation rules

##### 6.2.1.4. Manage IOC and BIOC rules

###### Note

* For Analytics BIOC rules, you can only disable and enable rules.

* You cannot delete global BIOCs delivered with content updates.

* For BIOC rules that are applied to prevention profiles: If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention on the agent works as usual. If you disable a rule only on the agent, detection on the server works as usual. If you disable a rule only on the server, prevention...

* When a BIOC rule is disabled automatically by Cortex XSIAM, for example due to the server anti flooding mechanism, prevention on the agent works as before.

###### Navigation

  Threat Management → Detection Rules → BIOC

### 6.3. Analytics

#### 6.3.1. Analytics engine

#### 6.3.2. Analytics sensors

#### 6.3.3. Coverage of MITRE Attack tactics

#### 6.3.4. Review MITRE ATT&CK framework coverage

##### Note

* When a contributing data source type is active, it does not imply that all the rules and detectors associated with the data source type are active. Rule applicability is dependent on the data source's context and configuration. To enable an active status, data source types require the following setup: Endpoint: Installed Cortex XDR agent. Network: A...

#### 6.3.5. Analytics detection time intervals

##### Note

* When establishing a baseline, detectors compute limits beyond which network activity will require an issue. In some cases, detectors do not compute baseline limits; instead they are predetermined by Cortex XSIAM engineers. The engineers determine the values used for predetermined limits using statistical analysis of malicious activity recorded...

#### 6.3.6. Analytics issues and Analytics BIOCs

#### 6.3.7. View and manage Analytics rules

#### 6.3.8. Identity Analytics

##### Navigation

  After configuring your Cloud Identity Engine instance and Cortex XSIAM Analytics, select Settings () → Configurations → Cortex XSIAM - Analytics, and in the Featured in Analytics section, Enable Identity Analytics

#### 6.3.9. Identity Threat Module (ITDR)

#### 6.3.10. AI Detection & Response in Cortex XSIAM (Beta)

##### Prerequisite

* To enable AIDR, you must have one of the following user roles: Instance Admin or Account Admin.

##### Navigation

  Settings → Configurations → Cortex - Analytics

##### 6.3.10.1. Data sources and supported services

##### 6.3.10.2. AI Detection & Response Dashboard

##### 6.3.10.3. Collect prompt logs

###### 6.3.10.3.1. Prompt log collection in AWS

###### 6.3.10.3.2. Enable prompt log collection in Azure

####### 6.3.10.3.2.1. Configure the Azure Event Hub collection in Cortex XSIAM

####### 6.3.10.3.2.2. Set up prompt logging

####### 6.3.10.3.2.3. Log HTTP data

####### 6.3.10.3.2.4. Configure diagnostic settings:

### 6.4. Threat Intel Management

#### License Type

  Requires the TIM add-on

#### 6.4.1. Get started with Threat Intel Management

##### Note

* By default, the Palo Alto Networks Wildfire Reports integration, which is used as part of the sample analysis feature, is installed and configured. The Palo Alto Networks Wildfire v2 integration, for dynamic malware analysis, is also installed, but you must add an integration instance. No API key is required.

* You must have the Cortex XSIAM Threat Intel Management (TIM) Add-on to use this feature.

##### 6.4.1.1. What is Threat Intel Management?

###### Note

* You must have the Cortex XSIAM Threat Intel Management (TIM) Add-on to use this feature.

##### 6.4.1.2. Threat Intel Management use cases

###### Navigation

  Settings → Configurations → Data Collections → Automation & Feed Integrations and in the Category field, select Threat Intel Feeds

##### 6.4.1.3. Roles and responsibilities in Threat Intel Management

##### 6.4.1.4. Indicator concepts

###### Note

* You can store up to 100,000,000 indicators.

##### 6.4.1.5. Indicator lifecycle

###### Note

* To run enhancement scripts and reputation commands, you must configure a relevant enrichment integration, such as VirusTotal, IPinfo v2, etc.

###### Tip

* We recommend defining your policy for handling expired indicators.

#### 6.4.2. Indicator configuration

##### 6.4.2.1. Customize indicator fields and types

###### 6.4.2.1.1. Create an indicator type

####### Note

* If you miss mapping any field, you can create additional new indicator fields and either relate them to all indicator types, or relate them only to the new indicator type (recommended).

####### Navigation

  Settings → Configurations → Object Setup → Indicators → Types

####### 6.4.2.1.1.1. Indicator type profile

######## Note

* Indicator cache expiration rules only apply to standard enrichment (for example, running the enrichIndicators command). If you run a reputation command, such as !ip, the commands executes even if the cache has not expired.

####### 6.4.2.1.1.2. File indicators

######## Note

* A new File indicator only affects new indicators ingested to the Cortex XSIAM platform. Indicators that were already in Cortex XSIAM continue to appear as their respective hash-related indicators.

######## Navigation

  Settings → Configurations → Object Setup → Indicators → Types

####### 6.4.2.1.1.3. Formatting scripts

######## Note

* Formatting scripts must have the indicator-format tag to appear in the list.

* Formatting scripts for out-of-the-box indicator types are system-level, which means that the formatting scripts for these indicator types are not configurable. To create a formatting script for an out-of-the-box indicator type, you need to disable the existing indicator type and create a new (custom) indicator type. If you configured a formatting...

####### 6.4.2.1.1.4. Enhancement scripts

######## Note

* Enhancement scripts are different from reputation commands. A reputation command runs every integration that has that command within it, to enrich the indicator. The reputation command ip , for example, runs every IP integration command in your enabled integrations, to collect data from multiple sources. An enhancement script is manually run after the...

* Enhancement scripts must have the enhancement tag applied to appear in the list.

####### 6.4.2.1.1.5. Reputation scripts

######## Note

* The Reputation script overrides any default settings for the indicator that relates to the verdict.

* Reputation scripts must have the reputation tag applied to appear in the list.

####### 6.4.2.1.1.6. Reputation commands

######## Note

* Running a reputation command directly (such as !ip) might not apply the result to an indicator, nor does it use the enrichment cache. To ensure an indicator is enriched, and to take advantage of caching, use the enrichIndicators command or the Enrich button in the UI. This runs the appropriate reputation command/script based on the indicator type...

####### 6.4.2.1.1.7. Map custom indicator fields

######## Note

* Some integrations have indicator mappers and classifiers, such as AWS. If you want to use an integration mapper or classifier, see Indicator classification and mapping.

######## Navigation

  Settings → Configurations → Object Setup → Indicators → Types

###### 6.4.2.1.2. Create an indicator field

####### Note

* Cortex XSIAM IOC fields are based on the STIX 2.1 specifications. For more information, see Indicator field structure.

* The following HTML tags are not permitted: blockquote, del, dd, div, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, iframe, ins, li, math, noscript, ol, pre, p, script, style, table, ul, address, article, aside, canvas, details, dialog, figcaption, figure, footer, header, hgroup, main, nav, output, progress, section, video. The following CSS tags...

####### Navigation

  Settings → Configurations → Object Setup → Indicators → Fields → New Field

####### 6.4.2.1.2.1. Indicator field structure

####### 6.4.2.1.2.2. Indicator field trigger scripts

######## Note

* Indicator field trigger scripts must have the field-change-triggered-indicator tag to appear in the list.

##### 6.4.2.2. Indicator classification and mapping

###### Note

* When creating a new indicator type, you classify and map the indicator fields in the indicator type settings. For more details, see Map custom indicator fields.

* You can optionally skip importing data. Click the pencil on the right of each indicator type on the right pane to enter the value manually.

* In the Classification & Mapping page, the mapping does not indicate for which indicator types they are configured. When creating a mapper, it is best practice to add to the mapper name and the indicator type the mapper is for. For example, Mail Listener - Phishing. When mapping a list, we recommend you map to a multi-select field. Short text fields do...

##### 6.4.2.3. Indicator extraction

###### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Reputation commands, such as !ip and !domain, can only be used after you configure and enable a reputation integration instance, such as VirusTotal and Whois.

* The inline configuration may delay playbook execution.

* While indicator creation is asynchronous, indicator extraction and enrichment are run synchronously. Data is placed into the issue context and is available via the context for subsequent tasks. All indicators are automatically extracted and enriched before a playbook is run. For an on-field change, extraction occurs before the next playbook tasks run.

* When using out of band, the extracted indicators do not appear in the context. If you want the extracted indicators to appear select inline.

###### 6.4.2.3.1. Set the indicator extraction mode for a playbook task

###### 6.4.2.3.2. Disable indicator extraction for scripts or integrations

##### 6.4.2.4. Configure indicator expiration

###### Note

* You need to run CLI commands in the Case or Issue War Room.

* If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its expiration method reverts to that of the indicator type (time-based). Time-based expiration is set according to feed reliability. If the same indicator appears on multiple feeds, the...

##### 6.4.2.5. Configure Threat Intelligence feed integrations

###### Note

* Some feeds only provide information about new indicators and do not specify when indicators are removed. Indicators from these feeds cannot be automatically expired on removal. If a feed's expiration method is set to When removed from the feed, indicators that are removed from the feed immediately expire. Note that if the feed is disabled, its...

##### 6.4.2.6. Exclude indicators from enrichment

##### 6.4.2.7. Generate issues from indicators using indicator rules for prevention and detection

###### Note

* Indicators should be present in the Threat Intelligence database (Threat Management → Threat Intelligence → Indicators) before creating detection and prevention rules.

* Although you can create IOC rules for detection, indicator rules are designed to leverage threat intelligence indicators like MD5 and SHA256 hashes that are present in your TIM library. These rules directly integrate with and rely on the indicators ingested and managed by TIM. Indicators must be in the TIM database before creating these rules. For more...

* You can't change the Preventable = True, Status = Active and Type = File filters, which comply with the requirements of the supported indicator type for Prevention on the Agent.

* The Indicator Rule shows the number of issues generated by the rule, You can view the issues that were generated using the Indicator rule, by right-clicking the rule and select View related issues.

* You can't change the Detectable = True and Status = Active filters, which comply with the requirements of the supported indicator type for detection.

* The Issue source is Threat Intelligence.

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

##### 6.4.2.8. Export indicators

###### Caution

* You should not run a query on a field that you might change in the playbook flow. For example, you shouldn't have a playbook with query Verdict:Malicious and then change the indicator verdict as a part of the playbook.

#### 6.4.3. Indicator management

##### Note

* If an indicator matches multiple indicator rules, the highest severity rule is used. If all have the same severity, the rules are used by the first created.

#### 6.4.4. Query indicators with Unit 42 Intel data

##### Note

* You can search or look up indicators. A search, which can include wildcards and complex queries, can return multiple results. Searches are only performed in Cortex XSIAM. Lookups are exact values, are performed in both Cortex XSIAM and Unit 42 Intel data, and can only return one result.

#### 6.4.5. Indicator investigation

##### 6.4.5.1. Indicator verdict

##### 6.4.5.2. Extract and enrich an indicator

###### Note

* By default, system-wide automatic indicator extraction and enrichment is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex XSIAM 3.x, system-wide automatic indicator extraction and enrichment is enabled. If you have a Threat Intel Management (TIM) Add-on, you can enable or disable automatic indicator extraction system-wide. Go to...

* Triggering enrichment on a substantial number of indicators can take time (because it's activating all enrichment integrations per indicator) and can result in performance degradation.

* Reputation commands, such as !ip, !domain can only be used when you configure and enable a reputation integration instance, such as VirusTotal and WHOIS.

##### 6.4.5.3. Expire an indicator

###### Note

* You need to run these commands in the Case or Issue War Room.

##### 6.4.5.4. Manage indicator relationships

###### Note

* You can also add an indicator relationship from the Quick View when selecting an indicator from an issue.

##### 6.4.5.5. Delete and exclude indicators

###### Caution

* Ensure you are using the correct syntax when defining the values for your exclusion lists.

##### 6.4.5.6. Investigate files using sample analysis

###### Note

* WildFire provides verdicts and analysis reports without requiring a license key. To send files to WildFire for analysis, see Set up Malware Prevention Profiles.Set up malware prevention profiles

* When searching on the Sample Analysis page for relationships -relationships"", some results may appear without their specific relationships listed, due to internal relationship permissions.

##### 6.4.5.7. Use sessions and submissions in your investigation

###### Note

* When searching on the Sessions & Submissions page for relationships -relationships"", some results may appear without their specific relationships listed, due to internal relationship permissions.

* The Application is matched to the type of application traffic detected in a session. For example, a search for the Application web-browsing returns sessions during which web browsing over HTTP occurred. See Applipedia for an updated list of applications that Palo Alto Networks identifies.

## 7. Inventory management

### 7.1. Asset management

#### 7.1.1. All Assets

##### Note

* Keep the following caveats in my mind when working with the Asset Inventory page: Instance Administrators are able to view all Inventory views without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope SBAC is not currently available for custom roles with View/Edit permissions on the...

* The options available are dependent on your license.

##### 7.1.1.1. Container Images

###### Navigation

  All Assets → Compute → Container Images

##### 7.1.1.2. Kubernetes Cluster

###### Navigation

  Inventory → All Assets → Compute → Kubernetes Cluster for a Kubernetes clusters assets overview

##### 7.1.1.3. Container Instances

###### Navigation

  Asset Inventory → Compute → Container Instances

##### 7.1.1.4. External Surface assets

###### License Type

  Requires the Attack Surface Management (ASM) add-on

###### 7.1.1.4.1. External Surface attribution evidence

#### 7.1.2. Network configuration

##### 7.1.2.1. Configure your network parameters

###### Note

* You can add a range that is fully contained in an existing range, however, you cannot add a new range that partially intersects with another range.

* Viewing external IP address ranges requires the Attack Surface Management add-on.

###### Navigation

  In Cortex XSIAM , select Assets → Network Configuration → Internal Domain Suffixes

#### 7.1.3. Asset Groups

##### Note

* When you create or edit an Asset Group, the changes are applied immediately to new assets and to existing assets that have been updated. However, it may take a few hours for the changes to appear on existing assets that have not been updated.

##### Navigation

  Inventory → Assets → Groups → Add Group

#### 7.1.4. Asset Roles

##### Note

* Asset Roles are available only if the Identity Threat Module add-on is enabled.

##### 7.1.4.1. Manage Asset Roles for Endpoints

###### Note

* Endpoint Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added endpoint removes the endpoint from the Included Endpoints list. If this endpoint is detected automatically as having this asset role in the future, it will appear in the Included Endpoints list. Excluding a manually added endpoint ensures that even if in the future the endpoint is detected as having this asset role, this...

##### 7.1.4.2. Manage Asset Roles for Users

###### Note

* User Role Management is available only if the Identity Threat Module add-on is enabled.

* Deleting a manually added user removes the user from the Included Users list. If this user is detected automatically as having this asset role in the future, it will appear in the Included Users list again. Excluding a manually added user ensures that even if in the future the user is detected as having this asset role, this detection is overridden and...

###### 7.1.4.2.1. Honey user

####### Prerequisite

* The honey user role is available only if the Identity Threat Module add-on is enabled.

#### 7.1.5. Manage Asset Scores

##### Note

* The Hosts tab is available if the Identity Threat Module add-on is enabled.

* As new alerts are associated with incidents, the User and Host Scores are recalculated. You can view the latest User and Host Scores on the Asset Scores page, or track the Score trend on the User Risk View and Host Risk View.

* Some User Associated Insights may not appear as part of the User Associated Incidents due to the insight generation mechanism. For example, when an insight related to one of the assets in an incident is generated a few days after the associated incident, the insight may not be associated with the incident.

#### 7.1.6. Vulnerability Assessment

##### Prerequisite

* The following are prerequisites for Cortex XSIAM to perform a vulnerability assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XSIAM lists only CVEs relating to the operating system, and not CVEs relating to applications provided by other vendors.   Cortex XSIAM...

* The following are prerequisites for Cortex XSIAM to perform an Enhanced Vulnerability Assessment of your endpoints. Requirement Description Licenses and Add-ons Host Insights Add-on. Supported Platforms Windows    Cortex XDR agent 8.3 or a later release.   Cortex XSIAM collects all the information about the operating system and the installed...

##### Note

* The CVE will be removed/reinstated to all views, filters, and widgets after the next vulnerability recalculation.

* Starting with macOS 10.15, Mac built-in system applications are not reported by the Cortex XDR agent and are not part of the Cortex XSIAM Application Inventory.

##### Tip

* You can click each individual CVE to view in-depth details about it on a panel that appears on the right.

* You can click each individual endpoint to view in-depth details about it on a panel that appears on the right.

##### Navigation

  You can access the Vulnerability Assessment panel from Inventory+Endpoints → Host Inventory → Vulnerability Assessment

## 8. Modules

### 8.1. Discovery Engine

#### 8.1.1. What is the Discovery Engine?

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM product that has the Cloud Runtime Security or Cloud Posture Management add-ons.

### 8.2. Cortex Cloud AI Security

#### 8.2.1. What is Cortex Cloud AI Security?

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 8.2.2. Supported services in Cortex Cloud AI Security

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 8.2.3. Cortex Cloud AI Security concepts

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 8.2.4. Cortex Cloud AI Security use cases

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 8.2.5. How to perform advanced AI Security investigations using XQL

##### License Type

  Requires the Posture Management add-on or the Runtime Security add-on.

##### Note

* For more information, see Build XQL queries.Build XQL queries

### 8.3. Cortex Cloud Application Security

#### 8.3.1. Application Security Posture Management (ASPM)

##### 8.3.1.1. ASPM use cases

##### 8.3.1.2. ASPM key features

##### 8.3.1.3. ASPM user roles and permissions

###### Navigation

  You can view AppSec Admin permissions in the tenant by navigating to Settings → Configurations → Roles → AppSec Admin

##### 8.3.1.4. ASPM Command Center

###### 8.3.1.4.1. ASPM Command Center workflow

####### Note

* Breakdown by type: Issues are further broken down by type (such as IAC or Secrets).

##### 8.3.1.5. Coverage

###### 8.3.1.5.1. Coverage in the user interface

####### Navigation

  Modules, → Application Security → AppSec Coverage

##### 8.3.1.6. Backlog baseline

###### 8.3.1.6.1. Backlog use cases

###### 8.3.1.6.2. Issue/Finding classification by scanner

####### Note

* In some cases/vendors, this is not accurate as findings are deleted every time new findings are uploaded. In such cases, the feature may not be accurate or supported For SAST, the vendor does not support policy in pull requests

* Scanner updates and new detections: When a security scanner is updated to support new languages, detection rules, or capabilities, any issues discovered by these new features for existing code are classified as part of the backlog.

###### 8.3.1.6.3. Using Backlog

##### 8.3.1.7. Applications

###### 8.3.1.7.1. How to build an application

####### Prerequisite

* Before you begin, ensure you have connected the necessary data sources. Refer to Onboard data sources for more information.

####### Note

* These filters are represented by icons displayed on the Code pane after selecting a VCS.

* To edit application assets, click the Clear All icon before clicking Finish. This clears all application data, allowing you to restart the application building process from the beginning.

###### 8.3.1.7.2. Application management and visibility

###### 8.3.1.7.3. Business application assets

####### 8.3.1.7.3.1. Business application expanded asset details

######## Note

* The topology graph is available only when all application components (code, pipeline, build and deploy), are configured.

##### 8.3.1.8. Repositories as assets

###### 8.3.1.8.1. Explore repository assets

###### 8.3.1.8.2. In-depth repository asset information

###### 8.3.1.8.3. Manage Repository assets

###### 8.3.1.8.4. Export Software Bill of Materials (SBOM)

###### 8.3.1.8.5. Manage issues detected in repositories

####### Note

* You can also find the repository issues in the general issue inventory table, and in the dedicated inventory of issues for each scanner type (see step 4 above for details).

##### 8.3.1.9. Onboard data sources

###### 8.3.1.9.1. Onboard version control systems

####### Note

* Application Security (which includes IaC and Secrets scanning), is an add-on to a license (such as Posture Security) that must be purchased separately.

* Disclaimer: When onboarding with third-party data sources, we outline the required steps for setup, but we do not monitor these external resources, and they may change over time. Always refer to the relevant third-party documentation for the most current integration steps.

####### Tip

* Navigate to Settings → Data Sources (under Data Collections) → + Data Source → enter your VCS data source in the search bar.

####### 8.3.1.9.1.1. AWS CodeCommit

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your AWS CodeCommit instances with the following permissions:       Read more...        codecommit:GitPull: Allows users to pull Git repository changes   codecommit:ListBranches: Grants the ability to list branches within a repository   codecommit:GetBranch: Required to get...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* The Resource Name Prefix and ExternalID fields are pre-populated. You can modify the Resource Name Prefix, but DO NOT change the ExternalID!

* To create an additional AWS CodeCommit instance: Hover over the AWS CodeCommit card in the catalog and click Connect Another.

####### 8.3.1.9.1.2. Azure Repos

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your Azure Repos instances with the following permissions and scopes.      Permission   Description       Project Administrator   This permission is required to subscribe to webhooks. For more information, refer to the Microsoft Integrate with service...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* For information on Application Security access to all organizations associated with your user token, refer to the Azure Third party application access via OAuth documentation.

* To create an additional Azure Repos instance: Hover over the Azure Repos card in the catalog and click Connect Another.

######## Caution

* Do not limit authorization scope.

####### 8.3.1.9.1.3. Bitbucket Cloud

######## Prerequisite

* Before you begin: Authorize the user with the following required permissions and scopes to integrate Application Security with your Bitbucket Cloud instances.  Note For write access, go to Bitbucket > Repository Settings and grant the user write access to the relevant repositories.     Permissions    Repository Administrator: To scan pull requests...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Cloud instance: Hover over the Bitbucket Cloud card in the catalog and click Connect Another.

####### 8.3.1.9.1.4. Bitbucket Data Center

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your Bitbucket Data Center instances with the following permissions:    Member of Project Collection Administrators: Required to subscribe to the build.complete event and download the permissions report for CI/CD scans. As Organization owners are automatically part of this...

######## Note

* By default, the permissions of the access token are set according to your current access level. It is essential to define two levels of permissions, Project and Repository permissions. The Repository permissions inherit from Project permissions, requiring Repository permissions to match or exceed Project permissions Providing read and write permissions...

* For additional security, it is recommended to set an expiry automatically. The expiry date of a token cannot be changed after it is created. You can see the expiry dates for all your tokens on Profile picture → Manage account → Personal access tokens.

* Select Connect Another Instance if an instance has already been configured.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional Bitbucket Data Center instance: Hover over the Bitbucket Data Center card in the catalog and click Connect Another.

######## Important

* Always refer to the Bitbucket documentation for information relating to creating a PAT.

####### 8.3.1.9.1.5. GitHub Cloud

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your GitHub SaaS instances with the following permissions:    Read  access to Dependabot alerts, actions, actions variables, administration, deployments, discussions, metadata, packages, repository hooks, secret scanning alerts, secrets, and security events   Read and write...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* To create an additional GitHub SaaS instance: Hover over the GitHub SaaS card in the catalog and click Connect Another.

####### 8.3.1.9.1.6. GitHub Server

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your GitHub Server instances with the following permissions and scopes:    Permissions    Organization owner permissions   Administrator repository permissions: In order to scan pull requests (PRs), the user performing the integration must have administrative privileges for the...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* The domain is the hostname associated with your GitHub Server instance.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitHub Server instance: Hover over the GitHub Server card in the catalog and click Connect Another.

####### 8.3.1.9.1.7. GitLab SaaS

######## Prerequisite

* Before you begin: Authorize the user integrating Application Security with your GitLab SaaS instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including all groups...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* A repository can only be integrated with a single instance. The first instance that connects with the repository will be the one that the repository is assigned to. This means that if multiple integrations attempt to connect to the same repository, only the first integration to establish the connection will be associated with that repository.

* To create an additional GitLab SaaS instance: Hover over the GitLab SaaS card and click in the catalog and Connect Another.

####### 8.3.1.9.1.8. GitLab self-managed

######## Prerequisite

* Authorize the user integrating Application Security with your GitLab self-managed instances with the following permissions:    Maintainer permissions. Grants sufficient permissions to configure external integrations, manage repository access, and adjust CI/CD settings   api: Grants full read and write access to the API, including all groups and...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* The domain is the hostname associated with your GitLab self-managed instance.

* For more information about the Transporter, including requirements and setup instructions, refer to Transporter over Broker VM.

* Ensure that you receive the Instance Successfully Created message on this step, indicating successful instance creation.

* To create an additional GitLab self-managed instance: Hover over the GitLab self-managed card in the catalog and click Connect Another.

###### 8.3.1.9.2. Onboard CI/CD systems

####### 8.3.1.9.2.1. Onboard CircleCI for CI/CD pipeline scans

######## Prerequisite

* Before you begin: User requirements:    Permissions: To enable Cortex XSIAM visibility for all CircleCI projects, a version control system (VCS) user with integration permissions must be authorized. This is because CircleCI's user base integrates with the VCS, inheriting its user permissions. For example, if a GitHub user has access to specific...

######## Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for code scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* To add an additional CircleCI instance, navigate to Settings → Data Sources → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

####### 8.3.1.9.2.2. Onboard Jenkins for CI/CD pipeline scans

######## Prerequisite

* Permissions Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

######## Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for code scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* The integration is added on the console but integration is pending, and will only be completed after completing step 5 below. You can view the pending integration on the Jenkins Instances page: Select Data Sources →  Jenkins → View Details. The type of integration is Pipeline Risks

* Always refer to the official Jenkins documentation when installing plugins on Jenkins servers.

* To add an additional Jenkins instance, navigate to Settings → Data Sources → select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps above.

###### 8.3.1.9.3. Integrate CI tools

####### Note

* For CircleCI CI/CD pipeline scans, refer to CI/CD .

* For Jenkins CI/CD pipeline scans, refer to CI/CD .

####### Navigation

  Settings → Data Sources → hover over a CI tool and click View Details

  Delete an instance: Right-click on an instance of the CI tool → Delete instance → Delete

####### 8.3.1.9.3.1. AWS CodeBuild

######## Prerequisite

* Before you begin: Grant Administrator  permissions to the user integrating AWS CodeBuild with Application Security Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional AWS CodeBuild instance, navigate to Settings → Data Sources → select the menu for your connected AWS CodeBuild instance → + New Instance, and repeat the onboarding steps above.

####### 8.3.1.9.3.2. Onboard CircleCI for code scans

######## Prerequisite

* Before you begin: Grant Administrator permissions to the user integrating Application Security with CircleCI Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

######## Note

* CircleCI onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your CircleCi environment, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard CircleCI for CI/CD scans, refer to...

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* To add an additional CircleCI instance, navigate to Settings → Data Sources → select the menu for your connected CircleCI instance → + New Instance, and repeat the onboarding steps above.

######## Important

* The cortex-secrets naming convention for the context is mandatory to ensure functionality and must not be changed.

####### 8.3.1.9.3.3. Connect Cortex CLI

######## Prerequisite

* Permissions: Grant the user installing the CLI required permissions. For more information refer to OverviewOverview Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress...

######## Note

* You can view the latest version of the selected OS.

* Recommended: Select With upload results permissions before generating the API key. This option grants the key permission to not only access data but also to upload or send data back. In the API Keys page, the role associated with these permissions is CLI. If you choose to upload without results permissions, the associated role is CLI Read Only Warning:...

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

######## Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter 'CLI' in the search bar to locate the Cortex CLI tool.

####### 8.3.1.9.3.4. GitHub Actions

######## Prerequisite

* Before you begin: Grant Administrator  permissions to the user integrating GitHub Actions with Application Security Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Do not change the names of the environment variables provided by Cortex XSIAM. They are required for proper integration and functionality.

* The code is only a reference. Replace the placeholder values with your build-specific values.

* To add an additional GitHub Actions instance, navigate to Settings → Data Sources → select the menu for your connected GitHub Actions instance → + New Instance, and repeat the onboarding steps above.

####### 8.3.1.9.3.5. Onboard Jenkins for code scans

######## Prerequisite

* Grant Administrator permissions to the user integrating Application Security with Jenkins Create an egress path to establish the designated route for outbound data transmission from Cortex XSIAM to third party services. For more information about configuring egress paths, refer to Egress configurationsEgress configurations

* For Application Security CI tools, you must store secrets in Jenkins Credentials for use in your Jenkins pipelines using either of these methods:    Plain text storage: Store secrets directly as plain text in Jenkins Credentials. Access them in your pipeline using the credentials function, which retrieves the secret directly as plain text   Credentials...

######## Note

* Jenkins onboarding offers both code and CI/CD scanning. A single integrated instance supports either code or CI scanning, but not both. If you require both code and CI scanning for your Jenkins servers, you must create two separate integrations, selecting the appropriate scanning type for each. To onboard Jenkins for CI/CD scans, refer to Onboard...

* Select Connect Another Instance if an instance has already been configured.

* This step is only required for new pipelines For private repositories, ensure the necessary credentials are configured in Jenkins Credentials

* This ensures your build runs within a Docker environment. If a node without Docker is used, the build will fail.

* To add an additional Jenkins instance, navigate to Settings → Data Sources →  select the menu for your connected Jenkins instance → + New Instance, and repeat the onboarding steps.

####### 8.3.1.9.3.6. Onboard Terraform Cloud (Run Tasks)

######## Prerequisite

* Before you begin: Procure a Terraform cloud license that is either a trial license or a TF Cloud license at the TEAM & GOVERNANCE level Grant the user or team the following permissions, depending on integration:    Manage Workspaces permissions at the organization level. These permissions are required to attach and manage the run task on workspaces...

######## Note

* * Application Security performs Image Referencer scans for container image vulnerabilities, as full SCA scans are not supported for Terraform Enterprise (Run Tasks).

* Skip this step if you plan on using an existing token.

* Select Connect Another Instance if an instance has already been configured.

* Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Cloud (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected your Terraform Cloud (Run Tasks) instance → + New Instance, and repeat the onboarding steps.

####### 8.3.1.9.3.7. Onboard Terraform Enterprise (Run Tasks)

######## Prerequisite

* Before you begin: Ensure access to a Terraform Enterprise console to enable you to provide a user or team token that authorizes Application Security to access workspaces and helps regulate run configurations Terraform Enterprise version compatibility: Ensure Run Tasks for workspaces on is compatible with version 1.1.9 and above Terraform Enterprise...

######## Note

* * For container image vulnerabilities, Application Security performs 'Image Referencer' scans within Terraform Enterprise (Run Tasks), as full SCA scans are not currently supported.

* Skip this step if you plan on using an existing token.

* Select Connect Another Instance if an instance has already been configured.

* Application Security performs a scan of Terraform templates on selected workspaces based on the Run Stage.

* To add an additional Terraform Enterprise (Run Tasks) instance, navigate to Settings → Data Sources → select the menu for your connected Terraform Enterprise (Run Tasks) instance → + New Instance, and repeat the onboarding steps above.

###### 8.3.1.9.4. CLI pipeline code snippets

###### 8.3.1.9.5. Ingest third-party data

####### Note

* Only onboarded and scanned repositories can be mapped.

####### 8.3.1.9.5.1. Ingest Veracode SAST data

######## Prerequisite

* Permissions: The following user permissions are required:    Cortex Cloud: Instance Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions   Veracode: At minimum, Reviewer permissions are required Permissions: The following user permissions are required: Cortex...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between Veracode projects and Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped applications are ingested

####### 8.3.1.9.5.2. Ingest SonarQube SAST data

######## Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Generate and copy a SonarQube API token. Ensure to assign Web API scope to the API token. Refer...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between SonarQube Applications and Application Security code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

* Verify that the Connector Created Successfully message is displayed on the page.

####### 8.3.1.9.5.3. Ingest Semgrep data

######## Prerequisite

* Permissions: Ensure you have System Admin, AppSec Admin or GRBAC permissions. For more information on AppSec Admin permissions, refer to Code Security user roles and permissions Ensure that you have a connected version control system (VCS) and repositories Create a Semgrep API token  Note To create a Semgrep API token, in Semgrep, navigate to Settings...

######## Note

* Select Connect Another Instance if an instance has already been configured.

* Mapping establishes relationships between Semgrep Projects Applications and Cortex XSIAM code repositories, simplifying access management and enabling risk analysis at the repository level, including displaying findings on the tenant Only mapped projects will be ingested

####### 8.3.1.9.5.4. Generic 3rd Party AppSec Collector

######## Important

* File uploads are limited to a maximum size of 10 MB.

######## 8.3.1.9.5.4.1. Onboard the 3rd Party AppSec Collector

###### 8.3.1.9.6. Manage data source integrations

####### Navigation

  Settings → Data Sources → use the search bar to locate the required data source

##### 8.3.1.10. Transporter over Broker VM

###### Prerequisite

* Ensure you have the necessary permissions and have already set up your Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex XSIAM resources. The IP addresses for the Transporter are in the Broker VM Resources section of the Enable access to required PANW resources document Open port 4052 (inbound), which...

###### Note

* The broker enables multiple connections, allowing a single Transporter applet to connect to various VCS instances Multiple Transporter applets cannot be created on a single Broker VM. Each Broker VM is limited to a single Transporter applet instance

###### Warning

* The Transporter applet is not supported for FedRAMP customers.

###### 8.3.1.10.1. Setup a Transporter applet on Broker VM

####### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator)

####### Note

* You cannot add a Transporter applet through Clusters.

####### Navigation

  your AppSec Transporter under the App column → Configure → Add Connection (on the redirected AppSec Transporter setup page

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

###### 8.3.1.10.2. Setup a Transporter on your VCS

####### Prerequisite

* Ensure you have user permissions to onboard data sources  Note The dedicated AppSec Admin role includes the required permissions. Ensure you have user permissions to onboard data sources Before you begin you must setup a Transporter applet on your Broker VM. Refer to Setup a Transporter applet on Broker VM for more information

####### Note

* GitLab Enterprise webhook internal IP restriction: GitLab Enterprise's security policies prevent webhook subscriptions to internal IP addresses (such as broker addresses). These subscriptions can only be enabled through specific instance configuration. For more information, refer to https://docs.gitlab.com/security/webhooks/.

####### Navigation

  Settings → Data Sources → + Add Data Source → select your VCS on-premises data source

##### 8.3.1.11. Manage 3rd party findings and generated issues

##### 8.3.1.12. Manage code weaknesses

###### Note

* You can customize policies to define which findings are categorized as issues.

###### Tip

* You can also view SAST CWE issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Code Weaknesses tab under the Repositories asset inventory. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset...

###### Navigation

  To access SAST code violation issues, under Modules, select Application Security → Issues → Code Weaknesses

###### 8.3.1.12.1. Code weaknesses issue inventory

###### 8.3.1.12.2. Expanded code weaknesses issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 8.3.1.12.3. SAST code weakness findings

####### Note

* Findings on the Cortex XSIAM platform are not intended for direct action; but rather represent data collected by the platform. They must be promoted to issues to enable mitigation efforts to secure your codebase.

#### 8.3.2. CI/CD Security

##### 8.3.2.1. CI/CD Security user roles and permissions

##### 8.3.2.2. CI/CD Assets

###### 8.3.2.2.1. CI/CD Instances as assets

####### 8.3.2.2.1.1. Explore CI/CD Instance assets

######## Navigation

  To access CI/CD pipeline instances, under Inventory, select All Assets → Code → Category → CI/CD Instances

####### 8.3.2.2.1.2. In-depth CI/CD pipeline instance asset information

####### 8.3.2.2.1.3. Manage CI/CD pipeline instances

###### 8.3.2.2.2. CI/CD Pipelines as assets

####### 8.3.2.2.2.1. Explore CI/CD Pipeline assets

######## Navigation

  To access CI/CD pipelines assets, under Inventory, select All Assets → Code → CI/CD Pipelines

####### 8.3.2.2.2.2. In-depth CI/CD pipeline asset information

######## Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

####### 8.3.2.2.2.3. Manage CI/CD pipeline assets

###### 8.3.2.2.3. Version Control System (VCS) Organizations as assets

####### 8.3.2.2.3.1. Explore VCS Organization assets

######## Navigation

  To access VCS Organization assets, under Inventory, select All Assets → Code → VCS Organizations

####### 8.3.2.2.3.2. In-depth VCS Organization asset information

######## Note

* The Highlights section and other asset properties only display attributes when their corresponding indicators are present. For example, if an asset is not deployed, its deployment-related attributes will not show up; similarly, if there are no detected issues, those highlights or properties will not appear.

####### 8.3.2.2.3.3. Manage VCS organization assets

###### 8.3.2.2.4. VCS Collaborators-as-assets

####### 8.3.2.2.4.1. In-depth Collaborator asset information

####### 8.3.2.2.4.2. Manage Collaborator assets

##### 8.3.2.3. Supply Chain tools

###### Note

* Rejected does not mean the tool is not in use. It allows application security practitioners to search for and remove these tools as needed For information about changing the tool status, refer to Overview

###### 8.3.2.3.1. Supply Chain use cases

####### Navigation

  To access Supply Chain Tools, select Modules → Application Security → Supply Chain Tools (under 3rd Party Tools

###### 8.3.2.3.2. Explore Supply Chain tools

###### 8.3.2.3.3. Expanded Supply Chain tool information

####### Note

* AppSec Admin user permissions are required to perform these actions.

##### 8.3.2.4. CI/CD Risks

###### Note

* Application Security CI/CD pipeline scans create a comprehensive inventory of all CI/CD pipelines in your environment. For more information refer to CI/CD Pipelines as assets.

###### 8.3.2.4.1. CI/CD pipeline issues

####### Navigation

  To access CI/CD pipeline risks issues, under Modules, select Application Security → Issues → CI/CD Risks

###### 8.3.2.4.2. Expanded CI/CD risks issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 8.3.2.4.3. VCS and CI/CD pipeline risk findings

##### 8.3.2.5. CI/CD Rules

###### Note

* Out-of-the-box rules cannot be modified Custom CI/CD rules are not supported

###### 8.3.2.5.1. CI/CD rules roles and permissions

###### 8.3.2.5.2. CI/CD rules inventory

####### Navigation

  In the Filter panel, select Category → Scanner → CI/CD Security

###### 8.3.2.5.3. Create custom CI/CD rules

####### Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

###### 8.3.2.5.4. Manage CI/CD rules

##### 8.3.2.6. CI/CD Policies

###### 8.3.2.6.1. CI/CD policies user roles and permissions

###### 8.3.2.6.2. CI/CD policies inventory

###### 8.3.2.6.3. Create custom CI/CD policies

####### Note

* PR Scan and CI Scan triggers are automatically disabled and unchecked. They can only be enabled if other scan types (that is non-CI/CD risk scans such as Secrets) are also selected, and will only run on non-CI/CD risks types of scans

* You can combine multiple conditions to create complex rules for when the policy should apply. Create conditions that apply to a CI/CD policy which detects high severity CI/CD risks on GitHub: Select Add Filter → Finding Type → CI/CD Risks → AND → Provider → [VCS/CI/CD system] → AND → Severity: → High.

* SBAC scope limitations do not apply to Matching Criteria For CI/CD policies, you can filter Matching Criteria by VCS Organization Name, CI/CD Pipeline [Name/ID], CI/CD Instance [Name/ID] or Collaborator [Name/Email/MFA Enabled/Last Observed]

###### 8.3.2.6.4. Manage CI/CD policies

####### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

##### 8.3.2.7. CI/CD Compliance

###### Navigation

  To access Compliance, select Posture Management → Compliance → Reports or Assessment

###### 8.3.2.7.1. Create CI/CD compliance reports

####### Note

* The CI/CD module supports GitHub and GitLab providers.

* For more information about about Asset Groups, refer to Asset Groups.

* CIS GitLab Benchmark, CIS GitHub Benchmark, and the OWASP Top 10 CI/CD Risks standards are supported.

* For more information about assessment profiles, refer to Use an assessment profile to run compliance checks on your assets.Use an assessment profile to run compliance checks on your assets

####### Navigation

  Posture Management → Compliance → Assessment or Reports

#### 8.3.3. Code Security

##### 8.3.3.1. Code Security user roles and permissions

##### 8.3.3.2. Code Security assets

##### 8.3.3.3. Software packages as assets

###### 8.3.3.3.1. In-depth software package asset information

##### 8.3.3.4. Infrastructure-as-Code (IaC) resources as assets

###### 8.3.3.4.1. Explore IaC assets

####### Navigation

  To access IaC assets, under Inventory, select All Assets → Code → IaC Resources

###### 8.3.3.4.2. In-depth IaC resource asset information

##### 8.3.3.5. Code Security scanners

##### 8.3.3.6. Software Composition Analysis (SCA ) scanners

###### 8.3.3.6.1. Supported Software Composition Analysis (SCA) frameworks and languages

###### 8.3.3.6.2. Software Composition Analysis (SCA) CVE vulnerability issues

####### Tip

* You can also view SCA vulnerabilities in dedicated tabs under other sections when available: In Asset inventories, navigate to Inventory → All Assets → Code:    On the Vulnerabilities tab under Repositories. Refer to In-depth repository asset information for more information Under the All Code inventory: Select an asset from the table →...

####### Navigation

  To access CVE vulnerability issues, under Modules, select Application Security → Issues → Vulnerabilities

####### 8.3.3.6.2.1. SCA CVE vulnerabilities inventory

####### 8.3.3.6.2.2. Expanded CVE vulnerabilities issue information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 8.3.3.6.2.3. CVE vulnerabilities findings

######## Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

######## Navigation

  To access CVE findings, under Modules, select Application Security → Issues → Vulnerabilities → click the Findings tab

####### 8.3.3.6.2.4. Manage SCA CVE vulnerability issues

###### 8.3.3.6.3. License miscompliance issues

####### Tip

* You can also view license miscompliance issues in dedicated tabs under other sections when available: In Application asset inventories: navigate to Inventory → All Assets →  Application → select an option from the Application menu → select an item from the inventory → Package Integrity In Asset inventories, navigate to Inventory → All...

####### Navigation

  To access license miscompliance issues, under Modules, select Application Security → Issues → Licenses

####### 8.3.3.6.3.1. License miscompliance issues inventory

####### 8.3.3.6.3.2. Expanded License miscompliance issues information

####### 8.3.3.6.3.3. License miscompliance findings

######## Navigation

  To access license miscompliance findings, under Modules, select Application Security → Issues → Licenses → click the Findings tab

####### 8.3.3.6.3.4. Open-source software license categories

####### 8.3.3.6.3.5. Manage license miscompliance issues

###### 8.3.3.6.4. Package Integrity

####### 8.3.3.6.4.1. Package Integrity issues inventory

######## Navigation

  Modules → Application Security → Package Integrity (under Issues

####### 8.3.3.6.4.2. Expanded Package Integrity issues inventory information

######## Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

####### 8.3.3.6.4.3. Package Integrity findings

######## Note

* Findings cannot be mitigated. They must be promoted to issues to enable remediation efforts to secure your software packages.

######## Navigation

  navigate to Modules → Application Security → Package Integrity (under Issues) → click the Findings tab

####### 8.3.3.6.4.4. Manage Package Integrity issues

##### 8.3.3.7. Secrets scanners

###### 8.3.3.7.1. Secrets issues

####### Tip

* You can also view Secrets issues in dedicated tabs under other sections when available: In Code asset inventories: navigate to Inventory → All Assets → Code:    On the Secrets tab under Repositories. Refer to In-depth repository asset informationfor more information   Under the All Code inventory: Select an asset from the table → Secrets In Code...

####### Navigation

  Under Modules, select Application Security → Issues → Secrets

###### 8.3.3.7.2. Secrets issues inventory

###### 8.3.3.7.3. Expanded Secrets issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 8.3.3.7.4. Secrets findings

####### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

####### Navigation

  To access Secrets findings, select Application Security → Issues → Secrets → click the Findings tab

###### 8.3.3.7.5. Manage Secrets issues

##### 8.3.3.8. Infrastructure as Code (IaC) scanners

###### 8.3.3.8.1. Supported frameworks and languages

###### 8.3.3.8.2. IaC misconfiguration issues

####### Tip

* You can also view IaC misconfiguration issues in dedicated tabs under other sections when available: In code Asset inventories, navigate to Inventory → All Assets → Code:    On the Configuration tab under Repository assets. Refer to In-depth repository asset information for more information   Under the All Code asset inventory: Select an asset from...

####### Navigation

  To access IaC misconfiguration issues, under Modules, select Application Security → Issues → IaC misconfiguration

###### 8.3.3.8.3. IaC misconfiguration issues inventory

###### 8.3.3.8.4. Expanded IaC misconfiguration issue information

####### Note

* Different issue types include different properties; therefore, not all properties are available for every issue.

###### 8.3.3.8.5. IaC misconfiguration findings

####### Note

* Findings are informational and, as such, are not directly mitigable. Remediation is performed on issues derived from findings.

####### Navigation

  To access IaC misconfiguration findings, under Modules, select Application Security → Issues → IaC Misconfigurations → click the Findings tab

###### 8.3.3.8.6. Manage IaC misconfiguration issues

##### 8.3.3.9. Application Security scans management

###### 8.3.3.9.1. How to access Application Security scan management

####### Note

* While scans provide a comprehensive inventory of all issues detected during a scan, dedicated inventories are also maintained for specific scan types for more granular management. For more information, refer to Infrastructure as Code (IaC) scanners, Secrets scanners and Software Composition Analysis (SCA ) scanners.

###### 8.3.3.9.2. Branch periodic scans

####### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

###### 8.3.3.9.3. Pull Request scans

####### Note

* The inventory table displays scan issues for visibility only; remediation is not available here. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

###### 8.3.3.9.4. CI scans

####### Note

* The inventory table displays scan issues for visibility only; remediation is not available in scan management. To resolve issues, navigate to the dedicated issue type inventory, where you can manage and remediate them.

###### 8.3.3.9.5. Manage repository scan configurations

####### Note

* For Secrets scans you configure these additional settings: Git history scan: scans Git history to detect secrets deleted from files but still present in past commits, notifying you of these exposures. This helps mitigate the risk of compromised credentials that may be found in the repository's history Secret validation: validates detected secrets...

####### Navigation

  Settings → Data Sources → hover over a connected data source from the catalog → click View Details

###### 8.3.3.9.6. Monitor data source instances health

##### 8.3.3.10. Application Security Policies

###### 8.3.3.10.1. User roles and permissions

###### 8.3.3.10.2. Create Application Security policies

####### Note

* Add additional condition attributes for a single finding type by using the OR operator When selecting multiple finding types, only filters common to all types are available

* If you select the Applications asset type, the policy evaluates all repositories for matching applications SBAC scope limitations do not apply to Asset Types

####### 8.3.3.10.2.1. Application Security policy condition attributes

######## Note

* The Severity, AppSec Rule, AppSec Rule Label and Backlog Status attributes are not dependent on the Finding Type attribute For more information about Backlog Status, refer to Backlog baseline

* For CI/CD Risks as the finding type, refer to CI/CD policies user roles and permissions.

###### 8.3.3.10.3. Manage Application Security policies

####### Note

* You cannot edit out-of-the-box (OOTB) policies.

* The duplicated policy will include the word "clone" in its name and must be renamed.

##### 8.3.3.11. Application Security Rules

###### Note

* Out-of-the-box rules cannot be modified directly. However, you can create a custom rule by cloning the existing one. This allows you to make changes to the original rule according to your requirements. Refer to Manage Application Security custom rules for more information.

###### 8.3.3.11.1. Roles and permissions

###### 8.3.3.11.2. Rules inventory

####### Navigation

  To filter rules relating to Secrets, select filter icon → Scanner (from the Select field) → Secrets (from the Value field

###### 8.3.3.11.3. Create custom Application Security rules

####### Note

* See Configure YAML file properties below for more details.

* Scanning/testing behavior is not supported.

###### 8.3.3.11.4. Manage Application Security custom rules

###### 8.3.3.11.5. Configure YAML file properties

##### 8.3.3.12. Application Security CLI

###### Prerequisite

* For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

###### Note

* For detailed information about the Cortex XSIAM CLI, refer to Cortex CLI.

###### 8.3.3.12.1. Connect Cortex CLI

####### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

####### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Application Security, refer to Cortex CLI usage for Application Security

####### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

###### 8.3.3.12.2. Cortex CLI usage for Application Security

###### 8.3.3.12.3. Cortex CLI Application Security command line reference

####### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

####### Important

* The Cortex CLI Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id <YOUR_AUTH_ID>...

###### 8.3.3.12.4. Cortex CLI common command line reference guide

####### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

##### 8.3.3.13. IDE

###### Note

* Not all remediation options are available for all findings or all type of scan category.

###### 8.3.3.13.1. System requirements

###### 8.3.3.13.2. Visual Studio (VS) Code

####### Prerequisite

* Before you begin: Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

####### Note

* Enforcement rules and CA certificates are not applicable to the open-source project.

####### Navigation

  Install through VS Code IDE: Access the Activity bar → select Extensions → Cortex Cloud → Install

####### 8.3.3.13.2.1. How to use the Cortex Cloud extension in VS Code

######## Note

* Not all remediation options are available for all issues.

* The suppression is scoped to the file.

###### 8.3.3.13.3. JetBrains

####### Prerequisite

* Permissions: CLI Read only permissions. Refer to Cortex CLI for more information about permissions Environment setup    macOS and Windows: Install Python 3.9.x to 3.12.x   Install Node.js version 22 and above for SCA scans (such as vulnerabilities scans) Environment setup macOS and Windows: Install Python 3.9.x to 3.12.x Install Node.js version 22 and...

* You must insert your API key and API ID values into the Settings before providing the tenant URL.

####### Note

* The Cortex AppSec code security plugin supports all JetBrains products.

####### Navigation

  Settings → Plugins → select the Marketplace tab → search for Prisma Cloud → Install → OK

  Settings → Tools → Cortex Cloud

####### 8.3.3.13.3.1. How to use the JetBrains Cortex XSIAM extension

######## Note

* After selecting Fix Available, the number of issues displayed in the issue categories (such as IaC) reflect the number of fixable issues for that type.

* The corresponding file simultaneously opens in the Code editor, highlighting the issue within its exact code context. See below for more information.

* Not all types of remediation are available for all issue categories. For example, fixes are not available for License issues.

* Secrets and Licenses category issues are typically mitigated by following the guidance in the Documentation.

#### 8.3.4. API documentation

### 8.4. Attack Surface Management

#### License Type

  Requires the ASM add-on

#### 8.4.1. Get started with Attack Surface Management

##### License Type

  Requires the ASM add-on.

##### 8.4.1.1. What is Attack Surface Management?

###### 8.4.1.1.1. Attack Surface Management use cases

##### 8.4.1.2. Network mapping

##### 8.4.1.3. Scanning

###### 8.4.1.3.1. Scanning cadences

###### 8.4.1.3.2. Known Assets Monitoring

###### 8.4.1.3.3. Scanning ports and protocols

####### Note

* The following lists are not exhaustive. For current and complete lists, contact your customer success team.

##### 8.4.1.4. GeoIP data collection

#### 8.4.2. Attack Surface Management detections

##### 8.4.2.1. Attack surface rules

###### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

##### 8.4.2.2. Attack Surface Testing

###### Note

* Requires the ASM add-on.

* Attack surface testing scans are typically not CFAA compliant, meaning that they may attempt more extensive fuzzing to confirm or deny the presence of a CVE. Additionally, some attack surface tests are more intrusive than others. Tests are labeled with the level of intrusivity, so you can decide whether to run more intrusive tests.

###### 8.4.2.2.1. Set up Attack Surface Testing

####### Navigation

  Settings → Configurations → Access Management → Roles, and select the role

  Modules → Attack Surface → Policies → Attack Surface Tests

  Settings → Configurations → Attack Surface → Attack Surface Testing

##### 8.4.2.3. Externally inferred CVEs

###### Note

* An externally inferred CVE might impact your service or asset, but additional investigation is required to confirm that the CVE is actually present.

##### 8.4.2.4. Digital Risk Protection

###### Note

* Both of these attack surface rules are based on the attributed domain assets that appear in the asset inventory. If there are no attributed domains in your inventory, Cortex XSIAM will not generate Digital Risk Protection findings and issues.

###### Navigation

  Modules → Attack Surface → Policies → Attack Surface Rules

#### 8.4.3. Attack surface assets

##### Navigation

  The internet-facing assets that were discovered in a attack surface management (ASM) scan and attributed to your organization are available in the inventory on the Inventory → Assets → All Assets → External Surface pages

  Inventory → Assets → Network Configuration → IP Address Ranges → External IP Address Ranges

##### 8.4.3.1. Upload or remove ASM assets

###### Note

* You must have the Instance Administrator role to upload or remove assets.

###### 8.4.3.1.1. Upload assets

####### Note

* If an asset upload request has an invalid CSV or includes one or more invalid assets, the entire request will fail, and none of the assets will be uploaded. If this happens, Cortex XSIAM will display an error message indicating what caused the error, so you can fix the problem and resubmit if you choose.

####### Navigation

  Settings → Configurations → Asset Management → Asset Uploads/Removals

###### 8.4.3.1.2. Remove assets

####### Note

* If an asset removal request has an incorrectly formatted CSV or includes one or more invalid assets, the entire request will fail, and none of the assets will be removed. If this happens, Cortex XSIAM will display an error message indicating what caused the error, so you can fix the problem and resubmit if you choose.

####### Navigation

  Settings → Configurations → Asset Management → Asset Uploads/Removals

#### 8.4.4. Deploy ASM and Exposure Management enrichment and remediation automation

##### Note

* For details and requirements regarding the enrichment information that can be collected and the specific issues that can be remediated automatically, review the Exposure Management Content Pack information in Marketplace.

* Cortex Exposure Management playbooks only run on issues that were created after the automation rules have been configured.

##### Navigation

  Investigation & Response → Automation → Automation Rules

  Settings → Configurations → Data Collection → Automation & Feed Integrations

#### 8.4.5. ASM enrichment of cloud assets

##### Navigation

  Inventory → Assets → All Assets → External Surface → Services

#### 8.4.6. Emerging Vulnerabilities

##### License Type

  Requires the ASM add-on

##### Note

* You must have a role with Attack Surface Rules permission to access the Emerging Vulnerabilities page. When setting up Roles Based Access Control (RBAC), you can find Attack Surface Rules in the Detection & Threat Intel component.

##### Navigation

  Posture Management → Vulnerability Management → Emerging Vulnerabilities

#### 8.4.7. Global Lookup

##### Navigation

  Modules → Attack Surface → Global Lookup

### 8.5. Cloud Workload Policies and Rules

#### Prerequisite

* Users need View/Edit RBAC permissions (under Policies → Compute Policies) or the Instance Administrator role to view, edit, and modify Cloud Workload Policies.

#### 8.5.1. How policies and rules work together

#### 8.5.2. Cloud Workload Policies

##### 8.5.2.1. Types of Cloud Workload Policies

##### 8.5.2.2. Cloud Workload Policies page

###### Note

* Keep the following caveats in my mind when working with Policies: Instance Administrators are able to view all facets of Policies without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be...

###### 8.5.2.2.1. Widgets panel

####### 8.5.2.2.1.1. Show or hide the widget panel

######## Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 8.5.2.2.2. Filter page results

###### 8.5.2.2.3. Change the layout of the policies table

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

###### 8.5.2.2.4. Policy Details Panel

####### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 8.5.2.3. Enable or disable a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 8.5.2.4. Create a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 8.5.2.5. Use an existing policy to create a new Cloud Workload policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 8.5.2.6. Edit a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

##### 8.5.2.7. Delete a Cloud Workload Policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Cloud Workload

#### 8.5.3. Cloud Workload Rules

##### 8.5.3.1. Default (pre-defined) Rules

##### 8.5.3.2. Custom (user-defined) Rules

##### 8.5.3.3. Cloud Workload Rules page

###### Note

* Keep the following caveats in my mind when working with Rules: Instance Administrators are able to view all facets of Rules without restrictions, even if Scope Based Access Control (SBAC) roles are in effect. Learn more about SBAC.Manage user scope If you've been assigned a custom role with View/Edit permissions limited by SBAC, you may not be able...

###### 8.5.3.3.1. Filter page results

###### 8.5.3.3.2. Change the layout of the rules table

###### 8.5.3.3.3. Rule details panel

##### 8.5.3.4. Create a new Custom Detection Rule

###### Note

* Only users with the following roles can enable or disable Custom Code Execution: Account Admin Instance Administrator Deployment Admin Privileged Security Admin

* Only Custom Detection Rules (not built-in rules) can be assigned to custom controls.

###### Important

* The custom Python scripts are intended to be executed exclusively for compliance checks and validations. To ensure the scripts are used properly and no security risks or unintended changes occur, the system implements the following restrictions and safeguards: Only a predefined set of Python libraries and functions required for compliance checks are...

##### 8.5.3.5. Use an existing rule to create a new Custom Detection Rule

###### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

##### 8.5.3.6. Edit a Custom Detection Rule

###### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

##### 8.5.3.7. Delete a Custom Detection Rule

###### Navigation

  Posture Management → Rules & Policies → Rules → Cloud Workload

### 8.6. Cortex Cloud Data Classification

#### 8.6.1. What is Cortex Cloud Data Classification?

#### 8.6.2. How to create and validate a custom data pattern

##### Note

* Once a custom data pattern is saved, it runs on all data in the same way as any out-of-the-box (OOTB) pattern, becoming globally applicable for all modules using Cortex Cloud Data Classification.

* For more information, see How to disable and enable data patterns in Data Classification.

#### 8.6.3. How to disable and enable data patterns in Data Classification

##### Note

* Disabling data patterns can cause changes in your data profile results and stop detection of these data patterns.

* For more information about data patterns in data classification, see What is Cortex Cloud Data Classification?.

##### Navigation

  In Cortex Command Center, click Settings → Configurations → Data Classification → Data Patterns

#### 8.6.4. How to create and validate a custom data profile

##### Note

* If you choose two data locations, only the filters they have in common will be included in the possible filter options.

* For more information, see How to disable and enable data profiles in Cortex Cloud Data Classification.

##### Important

* Deleting a data profile deletes all past data associated with it in all modules using Cortex Cloud Data Classification after a warning notification is displayed.

* Enabling and disabling a data profile removes or re-adds the data profile results to the data objects; that is, files and tables.

#### 8.6.5. How to disable and enable data profiles in Cortex Cloud Data Classification

##### Note

* Existing results on past scans are updated in the Asset and Object inventories within two hours after being disabled or enabled.

* For more information about data profiles in Cortex Cloud Data Classification, see What is Cortex Cloud Data Classification?.

##### Navigation

  In Cortex XSIAM Security Command Center, click Settings → Configurations → Data Classification → Data Profiles

### 8.7. Cortex Cloud Data Security

#### 8.7.1. What is Cortex Cloud Data Security?

##### License Type

  Requires the Cortex Cloud Posture Management  add-on or the Cortex Cloud Runtime Security add-on.

#### 8.7.2. Supported assets in Cortex Cloud Data Security

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* The list above refers to only data classification; however, Cortex Cloud Data Security discovers and monitors all cloud assets and services for usage and misconfigurations.

* For information about configuring data classification asset types, see How to configure the scanning settings for supported services.

#### 8.7.3. Cortex Cloud Data Security concepts

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 8.7.4. Cortex Cloud Data Security use cases

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 8.7.5. Data Inventory

##### License Type

  Requires the Cortex Cloud Posture Management  add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* To clear the filters in the filter panel, click Delete.

##### Navigation

  When you select Inventory → All Assets → Data → All Data, a list of all data assets appears

#### 8.7.6. How to review errors in Cortex Cloud Data Security

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 8.7.7. How to configure the scanning settings for supported services

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* All the asset types are selected by default. When you deselect a data asset type, it is not included when the system runs the next scan operation, reducing the total scan time.

#### 8.7.8. How to perform advanced Data Security investigations using XQL

##### License Type

  Requires the Posture Management add-on or the Runtime Security add-on.

##### Note

* For more information, see Build XQL queries.Build XQL queries

#### 8.7.9. How to onboard Snowflake (Posture)

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Prerequisite

* In order to use Snowflake (Posture), you must be registered with one of these cloud providers: Amazon AWS, Microsoft Azure, or Google Cloud Platform (GCP). Ensure you have the necessary account permissions to onboard. It is recommended to use account admin as the role for the onboarding.

##### Note

* The account identifier can be found using the user information at the bottom left. Hover over the account you wish to onboard and select the copy option at the top right. The account identifier is usually of the format: (organization).[account]

#### 8.7.10. How to onboard Microsoft 365 (Posture)

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Prerequisite

* You have generated a Globally Unique Identifier (GUID), also known as a Universally Unique Identifier (UUID). You will need this ID for the tenant you want to use for the Microsoft 365 (Posture) instance. In order to use Microsoft 365 (Posture), you must be registered with Microsoft Azure.

#### 8.7.11. How to use information protection labels in Cortex Cloud Data Security

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* Only If you have connected a Microsoft 365 instance to Cortex Cloud, the information protection labels appear. See How to onboard Microsoft 365 (Posture).

### 8.8. Cortex Cloud Identity Security

#### 8.8.1. What is Cortex Cloud Identity Security?

##### License Type

  Requires the Cortex Cloud Posture Management  add-on or the Cortex Cloud Runtime Security add-on.

#### 8.8.2. Cortex Cloud Identity Security concepts

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* Access to the Weak/Compromised Password column requires the ITDR add-on.

* Only ITDR assets can have a risk score.

* When a policy is analyzed and categorized as excessive, a relevant finding and highlight is attached to that policy and the various identities being granted excessive permissions.

* Each action must be defined as either being administrative or not. The administrative tag is an additional tag for administrative actions, along with one of the other access level types. For example, the AWS action iam:CreateGroup is categorized as config and has the administrative tag as well.

##### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

#### 8.8.3. Cortex Cloud Identity Security principles

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 8.8.4. Cortex Cloud Identity Security use cases

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

#### 8.8.5. How to manage RBAC and SBAC in Cortex Cloud Identity Security

##### Important

* You can use the Cortex Cloud Identity Security RBAC roles to define access to the various sections and functionalities of Cortex Cloud Identity Security, but these roles do not directly control the specific data a user sees within those sections. Data visibility is further refined and limited by scope-based access control (SBAC) capabilities.

#### 8.8.6. How to achieve the principle of least privilege access

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* In the case of Amazon AWS, Cortex Cloud Identity Security also uses AWS Identity and Access Management (IAM) Access Advisor insights to expand the coverage of supported actions.

##### Important

* If you turn off the audit logs, even briefly, this temporarily impacts the accuracy of the Last Access data, potentially showing permissions as unused when actually they were active. Full accuracy is restored 90 days after you re-enable the audit logs.

#### 8.8.7. How to enable inactive human identity logs on Azure in Cortex Cloud Identity Security

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* For more information, see Ingest logs from Microsoft Azure Event Hub.

#### 8.8.8. How to perform advanced Identity Security investigations using XQL

##### License Type

  Requires the Posture Management add-on or the Runtime Security add-on.

##### Note

* For more information, see Build XQL queries.Build XQL queries

### 8.9. Cortex Advanced Email Security

#### 8.9.1. Cortex Advanced Email Security module overview

##### Prerequisite

* The following are prerequisites for using the Cortex XSIAM Advanced Email Security module. REQUIREMENT DESCRIPTION Setup and Permissions Ensure Analytics is activated before enabling the Cortex Advanced Email Security module. Licenses and Add-ons Cortex Advanced Email Security add-on.

#### 8.9.2. Cortex Advanced Email Security module architecture and data flow

#### 8.9.3. Getting started with the Cortex Advanced Email Security module

##### Prerequisite

* Before you configure the Cortex Advanced Email Security module, ensure you have the following: Admin-level access to the target email platform API permissions to read mailbox data, manage remediation (if desired), and access user directories Dedicated service account (recommended) for integration purposes (response actions) List of domains and...

#### 8.9.4. Deploy and configure the Email Security module

##### 8.9.4.1. Integrate Microsoft 365 with the Cortex Advanced Email Security Module

###### License Type

  To configure a quick action, you must first create an application in Microsoft O365.

###### Navigation

  After you onboard your domains and configure the quick actions, Cortex XSIAM manage your protected domains in Modules → Email Security → Email Security Configuration

##### 8.9.4.2. Configure the Cortex Advanced Email Security module

###### License Type

  Requires the Email Security module.

###### Note

* You can add email indicators to the Allow List also in Exceptions Configuration → Issue Exclusions. However, if you add multiple indicators in a rule using Issue Exclusions under Exceptions Configuration, you cannot edit the rule in the Email Security Allow List.

###### Navigation

  Modules → Email Security → Email Security Configuration

#### 8.9.5. Cortex Advanced Email Security threat detection and issues

##### Note

* Depending on data collection mode and platform capabilities, not all fields may be populated for every message. API and export documentation provides further clarification on optional vs required fields.

##### 8.9.5.1. Email Security Analytics Rules

###### Navigation

  The Email Security Analytics Rules page is in Modules → Email Security → Email Security Detection Rules

#### 8.9.6. Investigate and respond to email security issues

##### License Type

  Requires the Cortex Advanced Email Security module.

##### Navigation

  Modules → Email Security → Email Security Issues

#### 8.9.7. Automate remediation for the Cortex Advanced Email Security module

#### 8.9.8. Email Command Center

##### License Type

  Requires the Cortex Advanced Email Security module.

### 8.10. Exposure management

#### 8.10.1. Exposure Management in Cortex XSIAM

##### License Type

  Requires the Exposure Management add-on.

#### 8.10.2. Get started with Exposure Management

#### 8.10.3. Exposure Management Command Center

#### 8.10.4. Compensating Controls

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

#### 8.10.5. Cortex Network Scanner

##### 8.10.5.1. Get started with Cortex Network Scanner

###### License Type

  Requires the Exposure Management add-on.

###### Prerequisite

* Review the Cortex Network Scanner deployment recommendations and complete any prerequisites. Set up and configure Broker VM

###### Note

* The current version of the Cortex Network Scanner does not support load distribution and balancing. Vulnerability assessment scans can take time, and currently you can assign only one scanner per scan task. To scan the entire network we recommend splitting your scanning activity into smaller tasks to preserve performance.

* The Cortex Network Scanner applet is not supported for FedRAMP customers.

###### Important

* The Cortex Network Scanner applet is not supported for FedRAMP customers.

###### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  Settings → Configurations → Network Scanners → Network Scanners and find your new scanner in the list

##### 8.10.5.2. Add a network

###### Navigation

  Settings → Configurations → Network Scanning → Networks and click + Add Network

##### 8.10.5.3. Add credentials for authenticated scans

###### Prerequisite

* Before initiating an authenticated scan, complete the following prerequisites on your target hosts: Create dedicated service accounts. We highly recommend creating dedicated service accounts on your target devices specifically for the network scanner. Avoid using existing administrative accounts or personal user accounts. This practice enhances...

###### Note

* You cannot edit saved credentials, but you can delete them and create new ones as needed.

###### Navigation

  Settings → Configurations → Network Scanners → Credential Management

##### 8.10.5.4. Create a scan

###### Tip

* Most use cases can use the default advanced settings.

* ICMP Ping provides the quickest discovery scan and is good for initial discovery and scoping, however in the modern enterprise environment ICMP response can be blocked by the firewall or endpoint security rules. Using additional methods increases the accuracy of the host discovery, although makes the scan take a longer time. The best approach is to use...

##### 8.10.5.5. Manage scans

###### Navigation

  Settings → Configurations → Network Scanners → Scan Management

##### 8.10.5.6. View issues triggered by network scanner findings

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

### 8.11. Vulnerability management

#### License Type

  Requires the ASM or Cortex Cloud Posture Management add-on

#### 8.11.1. Vulnerability management in Cortex XSIAM

##### Note

* Cortex XSIAM vulnerability management provides the ability to identify and assess runtime vulnerabilities in every asset across traditional IT and cloud environments. For vulnerabilities detected in your software development lifecycle through application security scans, refer to the Cortex Cloud Application Securitydocumentation.

##### 8.11.1.1. Cortex XSIAM vulnerability concepts

###### Note

* CVE is an acronym for Common Vulnerabilities and Exposures, which is a list of publicly disclosed security threats. We often use the term "CVE" to refer to a vulnerability that has been a assigned a CVE ID. Cortex XSIAM identifies CVEs and non-CVE vulnerabilities.

##### 8.11.1.2. Vulnerability Management dashboard

#### 8.11.2. Vulnerability policies

##### 8.11.2.1. Create a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

##### 8.11.2.2. Update the Ignored CVEs, Asset Groups, and Assets policy

###### Navigation

  Posture Management → Rules & Policies → Policies → Vulnerability Management

##### 8.11.2.3. Modify a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

##### 8.11.2.4. Enable or disable a vulnerability policy

###### Navigation

  Posture Management → Rules & Policies → Vulnerability Management

#### 8.11.3. Investigate and remediate vulnerabilities

##### 8.11.3.1. View all Vulnerabilities

###### Navigation

  Posture Management → Vulnerability Management → Vulnerabilities

##### 8.11.3.2. View vulnerability issues

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues

##### 8.11.3.3. View All Vulnerability Findings

###### Navigation

  Posture Management → Vulnerability Management → Vulnerability Issues and click the All Vulnerability Findings button

##### 8.11.3.4. View vulnerable assets

###### Navigation

  Posture Management → Vulnerability Management → Vulnerable Assets

#### 8.11.4. Vulnerability Intelligence

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

#### 8.11.5. Recast CVSS scores and CVSS severities

##### Navigation

  Posture Management → Vulnerability Management → Vulnerability Intelligence

## 9. Serverless function security

### 9.1. Overview

### 9.2. Serverless function posture security

#### 9.2.1. Onboard cloud providers for serverless functions

##### Note

* When scanning serverless functions wtih layers, those layers need to be from the same cloud account.

* Only functions containing zip files are supported.

##### Important

* Cortex supports GCP functions deployed by Cloud Functions (1st gen) and Cloud Functions API (2nd gen).

#### 9.2.2. Serverless function posture policies

##### 9.2.2.1. Manage serverless function policies

###### Note

* You can select multiple types to view all your serverless function rules across your cloud providers.

* Refer to Create serverless function policies for more information on how to define the steps of a policy in the wizard.

##### 9.2.2.2. Create serverless function policies

###### Note

* You can select multiple options.

* For more information about rules, refer to Manage serverless function rules.

#### 9.2.3. Serverless function posture rules

##### 9.2.3.1. Manage serverless function rules

###### Note

* You can select multiple types to view all your serverless function policies across your cloud providers.

* Refer to Create serverless function rules for more information on how to define the steps of a rule in the wizard.

##### 9.2.3.2. Create serverless function rules

##### 9.2.3.3. Create an attack path rule for serverless functions

###### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

  in as the operator → enter the CVE ID → Search

  > or >= as the operator → Severity level (such as High, Low) → Search

  > or >= as the operator → enter a score → Search

##### 9.2.3.4. Create a configuration rule for serverless functions

###### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

##### 9.2.3.5. Create a network exposure rule for serverless functions

###### Navigation

  Under Posture Management, select Rules & Policies → Cloud Security (under Rules) → click Create Rule

#### 9.2.4. Serverless function usage

##### Navigation

  To access serverless function assets, under Inventory, select All Assets → Compute → Serverless Functions

  Posture Management → Vulnerability Management) → Vulnerability Issues

  Add Filters → Asset Category → Serverless Function

  Posture Management → Vulnerability Management) → Vulnerable Assets

  Add Filters → Asset Category → Serverless Functions

### 9.3. Serverless function runtime security

#### 9.3.1. Overview

#### 9.3.2. Set up serverless function protection

#### 9.3.3. Serverless runtime issues

##### Note

* Issues triggered within 24 hours, sharing the same name and description, will be aggregated into cases along with issues from the same function per execution.

10. Data management

  10.1. Broker VM

  10.1.1. What is the Broker VM?

  10.1.2. Set up and configure Broker VM

##### License Type

  Collectors require endpoints, or the Cortex Cloud Runtime Security add-on.

##### Note

* The Broker VM comes with a 512 GB disk. Therefore, deploy the Broker VM with thin provisioning, meaning the hard disk can grow up to 512 GB but will do so only if needed.

* When DHCP is not enabled in your network and there isn't an IP address for your Broker VM, configure the Broker VM with a static IP using the serial console menu.

* When configuring a Local Agent Settings applet with installer and content caching, you need to configure an SSL certificate for the Broker VM as explained in the task below. For more information on specific requirements for the Local Agent Settings applet, see Activate Local Agent Settings. Keep in mind that several Broker VM applets, such as the...

* You can configure another Broker VM as a proxy server for this Broker VM by selecting the HTTP type. When selecting HTTP to route Broker VM communication, you need to add the IP Address and Port number (set when activating the Agent Proxy) for another Broker VM registered in your tenant. This designates the other Broker VM as a proxy for this Broker VM.

* The Palo Alto Networks Broker VM supports only strong cipher SHA256-based certificates. MD5/SHA1-based certificates are not supported.

* If adding a CA certificate to the Broker VM is not possible, ensure that you've added the Broker Service FQDNs to the SSL Decryption Exclusion list on your firewalls. See Enable Access to Cortex XDR.

##### Important

* There can be instances in which the Broker VM requires up to 50% of the incoming bandwidth as outgoing. Such instances can be, network instability between the Broker VM and Cortex XSIAM, or data that is being collected, but not well compressed.

* The internal network for the Broker VM must be unique and reserved. Other devices should not use the same IP as the Broker VM internal network as it can lead to communication issues with the Broker VM.

* If you use SSL decryption in your firewalls and proxies, see the Understanding CA certificate functionality in Broker VM deployments section below. In addition, verify that the proxies used support HTTP/2, gRPC-specific headers, and HTTP/2 trailers, and the inspection policies support gRPC traffic. Any devices that you use with this configuration...

* When configuring more than one network interface, ensure that only one Default Gateway is defined. The rest must be set to 0.0.0.0, which configures them as undefined. In addition, we recommend assigning each network interface to a different subnet, as oppose to configuring two interfaces on the same subnet which can potentially cause unexpected...

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and earlier, Cortex XSIAM will only accept 172.17.0.0/16.

* We strongly recommend disabling SSH connectivity when it's not being used. Therefore, activate SSH connectivity when it's needed and disable it right afterwards. When generating a new SSH key ensure to avoid embedding the domain-style username, by not using any backslashes (\) in the comment field, to ensure the SSH key passes validation.

  10.1.2.1. Broker VM image installations

  10.1.2.1.1. Set up Broker VM on Alibaba Cloud

##### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* For Linux and Windows uploads, you can use Alibaba Cloud's graphical management tool called ossbrowser.

* The Object Storage Service must be created in the same Region as the image of the virtual machine.

##### Navigation

  Hamburger menu → Elastic Compute Service → Instances & Images → Instances

  10.1.2.1.2. Set up Broker VM on Amazon Web Services

##### Prerequisite

* Download a Cortex XSIAM Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. You need to set up an AWS VM Import role (vmimport) before you continue with the steps to convert the image as it is required for the import-image CLI command. You can use a different role, if the...

##### Note

* Creating an AMI image can take up to 60 minutes to complete.

* Assigning security groups can take up to 15 minutes.

##### Important

* A t2.medium (4GB RAM) is the lowest machine type that can be used as an instance type. Usually, the lowest machine type is sufficient with the Local Agent Settings applet. Yet, when enabling more applets, 8 GB is required.

##### Navigation

  Log in to the AWS IAM Console, and in the navigation pane, select Access Management → Users → Add Users

  Obtain a registration token from the Cortex XSIAM Web Console by selecting Settings → Configurations → Data Broker → Broker VMs → Add Broker → Generate Token

  10.1.2.1.3. Set up Broker VM on Google Cloud Platform (GCP)

##### Prerequisite

* Download a Cortex XSIAM Broker VM VMDK image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM. To complete the set up, you must have G Cloud installed and have an authenticated user account.

* Before importing a GCP image using the gcloud CLI, ensure that you update the Google Cloud components to version 371.0.0 and above using the following command:

##### Note

* The import tool uses Cloud Build API, which must be enabled in your project. For the import to work, Cloud Build service account must have compute.admin and iam.serviceAccountUser roles. When using the Google Cloud console to import the image, you will be prompted to add these permissions automatically.

  10.1.2.1.4. Set up Broker VM on KVM using Ubuntu

##### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  10.1.2.1.5. Set up Broker VM on Microsoft Azure

##### Prerequisite

* Download a Cortex XSIAM Broker VM VHD (Azure) image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* Extraction can take up to a few hours.

* Upload can take up to a few hours.

* Creating the VM can take up to 15 minutes. The Broker VM Web UI is not accessible during this time.

* For more information on creating a rule in an Azure VM, see Create a Security Rule in the Azure Documentation.

  10.1.2.1.6. Set up Broker VM on Microsoft Hyper-V

##### Prerequisite

* Download a Cortex XSIAM Broker VM VHD image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  10.1.2.1.7. Set up Broker VM on Nutanix Hypervisor

##### Prerequisite

* Download a Cortex XSIAM Broker VM QCOW2 image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

##### Note

* Saving the image to Nutanix hypervisor can take time as it's a large file.

* Creating the VM can take up to 15 minutes. The Broker VM Web user interface is not accessible during this time.

  10.1.2.1.8. Set up Broker VM on VMware ESXi using vSphere Client

##### Prerequisite

* Ensure you have a virtualization platform installed that is compatible with an OVA image, and have an authenticated user account. Download a Cortex XSIAM Broker VM OVA image. For more information, see the virtual machine compatibility requirements in Set up and configure Broker VM.

  10.1.2.2. Broker VM data collector applets

  10.1.2.2.1. Activate Apache Kafka Collector

##### Prerequisite

* Apache Kafka version 2.5.1 and above. Kafka cluster set up on premises, from which the data will be ingested. Privileges to manage Broker Service configuration, such as Instance Administrator privileges. Create a user in the Kafka cluster with the necessary permissions and the following authentication details:    Broker Certificate and Private Key for...

##### Note

* For CEF and LEEF logs, Cortex XSIAM takes the vendor and product names from the log itself, regardless of what you configure on this page.

  10.1.2.2.2. Activate CSV Collector

##### Prerequisite

* Set up and configure Broker VM. Ensure that you share the applicable CSV files. Know the complete file path for the Windows directory.

##### Note

* When you implement a wildcard file search, ensure that the CSV files share the same columns and header rows as all other logs that are collected from the CSV files to create a single dataset.

* The CSV Collector checks for new CSV files every 10 minutes.

  10.1.2.2.3. Activate Cortex Network Scanner

##### License Type

  Requires the Exposure Management add-on.

##### Prerequisite

* Review the Cortex Network Scanner deployment recommendations and complete any prerequisites. Set up and configure Broker VM

##### Important

* The Cortex Network Scanner applet is not supported for FedRAMP customers.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  Settings → Configurations → Network Scanners → Network Scanners and find your new scanner in the list

  10.1.2.2.4. Activate Database Collector

##### Prerequisite

* Set up and configure Broker VM

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  10.1.2.2.5. Activate Files and Folders Collector

##### Prerequisite

* Set up and configure Broker VM. Know the complete path to the files and folders that you want Cortex XSIAM to monitor. Ensure that the user permissions for the network share include the ability to rename and delete files in the folder that you want to configure collection.

##### Note

* Cortex XSIAM only supports ingestion of files encoded in UTF-8 format.

* When using the Linux file share, including the Linux share with nfs, a Username and Password is not required, so these fields are grayed out in the screen.

* In Batch mode, the Files and Folders Collector supports collecting logs from a network share for a maximum file size of 500 MB.

* When uploading JSON files, Cortex XSIAM only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* When the storing method is Replace, the maximum size for the total data to be imported into a lookup dataset is 30 MB each time the data is fetched. The inventory data ingested using the Files and Folders collector is counted towards license utilization. When you use a JOINT function with a lookup table in a query or correlation rule, make sure you...

* You can't specify a file name that's the same as a system file name. The name of a dataset created from a tsv file must always include the extension. If the original file name is mrkdptusrsnov23.tsv, you can name save the dataset with the name marketing_dept_users_Nov_2023.tsv.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

  10.1.2.2.6. Activate FTP Collector

##### Prerequisite

* Set up and configure Broker VM. Ensure that the user permissions for the FTP, SFTP, or FTPS include the ability to rename and delete files in the folder that you want to configure collection. When setting up an FTPS Collector with a server using a Self-signed certificate, you must upload the certificate first to the Broker VM as a Trusted CA...

##### Note

* When configuring an SFTP connection, Cortex XSIAM expects the private key to be in the RSA format that is included in the -----BEGIN RSA PRIVATE KEY----- tag. Cortex XSIAM does not support providing the private key in the OpenSSH format from the -----BEGIN OPENSSH PRIVATE KEY----- tag. When using ssh-keygen using a Mac, you get the OpenSSH format by...

* When uploading JSON files, Cortex XSIAM only parses the first level of nesting and only supports single line JSON format, such that every new line means a separate entry.

* Use this option only in cases where your files contain some sort of "header" lines, such as a general description, an introduction, a disclaimer, or similar, and you want to skip ingesting them. The Lines to Skip are not part of the file format. For example, in CSV files, there is no need to skip lines.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF.

  10.1.2.2.7. Activate Local Agent Settings

##### License Type

  Requires endpoints, or the Cortex Cloud Runtime Security add-on.

##### Note

* This is assuming a standard hardware setup with 2vCPU 8 GB memory.

* Broker VMs can act as as a proxy for routing XDR Collector traffic to the Cortex XSIAM tenant. The Broker VM does not cache XDR Collector installers.

* When you install your XDR agents, you need to configure the IP address of the Broker VM and a port number during the installation. You can use the default 8888 port or set a custom port. You are not permitted to configure port numbers between 0-1024 and 63000-65000, or port numbers 4369, 5671, 5672, 5986, 6379, 8000, 9100, 15672, 25672. Additionally,...

##### Important

* A FQDN must be configured for WEC and Agent Installer and Content Caching to function properly.

* You can only enable Agent Installer and Content Caching, when in the Broker VM Configuration, you've uploaded your signed SSL Server Certificate and key and set the FQDN. For more information, see the Agent Installer and Content Caching requirements explained above.

  10.1.2.2.8. Activate NetFlow Collector

##### Prerequisite

* Set up and configure Broker VM

##### Note

* Since multiple network devices can send data to a single NetFlow Collector, we recommend that you configure a maximum of 50 NetFlow Collectors per Broker VM applet, with a maximum aggregated rate of approximately 50K flows per second (FPS) to maintain system performance.

* Since Cortex XSIAM reserves some port numbers, it is best to select a port number that is not in the range of 0-1024 (except for 514), in the range of 63000-65000 or has one of the following values: 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672.

* The options available change, according to the set Source Network value.

  10.1.2.2.9. Activate Network Mapper

##### License Type

  Requires endpoints, or the Cortex Cloud Runtime Security add-on.

##### Prerequisite

* After you have configured and registered your Broker VM, you can choose to activate the Network Mapper application.

##### Note

* Each IP address range can receive multiple scan requests based on it's availability.

* IP address ranges are displayed according to what you defined as your Network Parameters.

  10.1.2.2.10. Activate Pathfinder

##### License Type

  Requires endpoints, and the Cortex Cloud Runtime Security add-on.

##### Prerequisite

* Configure and register a Broker VM. Except for Vanilla Windows 7, Cortex XSIAM supports activating Pathfinder on Windows operating systems with PowerShell version 3 and later. Verify these requirements wherever you want to activate Pathfinder. The Pathfinder configuration must contain at least one IP address range to run. Make sure that your internal...

##### Note

* Pathfinder isn't supported when configuring Broker VMs in high availability (HA) clusters.

##### Important

* The Broker VM Pathfinder applet is now deprecated. In tenants where the applet was implemented, it will remain operational until January 25, 2026. In all other tenants, the applet is unavailable and cannot be used as of July 20, 2025. To ensure complete coverage and protection, we recommend deploying XDR Agents on all endpoints by this date. Migration...

* The Pathfinder applet isn't supported when configuring Broker VMs in high availability (HA) clusters.

  10.1.2.2.11. Activate Registry Scanner

##### License Type

  Requires the Cortex Cloud Posture Management or Cortex Cloud Runtime Security add-on.

##### Prerequisite

* To initialize registry scanning on your Broker VM, you must first add the necessary data connectors. For details, see Connect Docker V2-compliant container registry and Connect JFrog container registry When sizing your Broker VM, consider the following recommendations:    Disk Size: Calculate the required disk space by multiplying the average container...

##### Note

* FedRAMP is currently not supported for this applet. You cannot activate the Registry Scanner directly on a new or existing Broker VM. You can only activate or deactivate existing Registry Scanner applets. To activate or deactivate existing applets, see Step 4 under Verify Registry Scanner connection section.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  10.1.2.2.12. Activate Syslog Collector

##### Prerequisite

* Set up and configure Broker VM

##### Note

* Once configured, you cannot change the Port/PROTOCOL. If you don't want to use a data source, ensure to remove the data source from the list as explained in Task 5.

* The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and...

* The server certificate and private key pair is expected in a PEM format. Cortex XSIAM will notify you when your certificates are about to expire.

* Because some port numbers are reserved by Cortex XSIAM , you must choose a port number that is not: In the range of 0-1024 (except for 514) In the range of 63000-65000 Values of 4369, 5671, 5672, 5986, 6379, 8000, 8888, 9100, 15672, or 28672

* CORELIGHT is not available for a UDP protocol.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  10.1.2.2.13. Activate Transporter

##### License Type

  Requires the Cortex Cloud Posture Management or Cortex Cloud Runtime Security add-on.

##### Prerequisite

* Permissions: To configure and manage Transporter applet settings, you must have permissions to manage Broker Service configurations (such as an Instance Administrator) Set up and configure Broker VMSet up and configure Broker VM Confirm that your Broker is v 28 or above Whitelist IP addresses to enable access to Cortex XSIAM resources. The IP addresses...

##### Warning

* The Transporter applet is not supported for FedRAMP customers.

##### Navigation

  Settings → Configurations → Broker VMs (under Data Broker

  the Brokers tab → locate your Broker VM → hover and click + Add under the Apps column → AppSec Transporter

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted All existing connections are deleted but their configurations are saved in the database

  the Appsec Transporter under the App column → Deactivate → Confirm when prompted

  10.1.2.2.14. Activate Windows Event Collector

##### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

##### Note

* You can also activate the Windows Event Collector on Windows Core. For more information, see Activate Windows Event Collector on Windows Core.

* By default, Cortex XSIAM collects Palo Alto Networks predefined Security events that are used by the Cortex XSIAM detectors. Removing the Security collector interferes with the Cortex XSIAM detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

  10.1.2.2.14.1. Activate Windows Event Collector on Windows Core

##### Prerequisite

* Set up and configure Broker VM Broker VM version 8.0 and later You have knowledge of Windows Active Directory and Domain Controllers. You must configure different settings related to the FQDN where the instructions differ depending on whether you are configuring a standalone Broker VM or High Availability (HA) cluster.         Standalone broker       A...

##### Note

* By default, Cortex XSIAM collects Palo Alto Networks predefined Security events that are used by the Cortex XSIAM detectors. Removing the Security collector interferes with the Cortex XSIAM detection functionality. Restore to Default to reinstate the Security event collection.

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* This step overrides any local policy settings.

* You must type out the name, do not select the name from the browse button.

* If Windows Firewall is enabled on your event forwarders, you will have to define an outbound rule to enable the WEF to reach port 5986 on the WEC.

  10.1.2.2.14.2. Renew WEC certificates

##### Note

* You must install the WEF certificate on every Windows Server, whether DC or not, for the WEFs that are supposed to forward logs to the Windows Event Collector applet on the Broker VM.

* You can see more than one ca.wec.paloaltonetworks.com and forwarder.wec.paloaltonetworks.com file from a previous installation in the directory, so select the file with the most extended Expiration Date. You can verify that you are using the correct certificate: To verify the client certificate in the Personal → Certificates folder is related to the...

* Only perform this step under the following conditions: You have completed the WEF certification renewal process for ALL clients in your environment. Otherwise, events from the WEFs that you did not install the new client certificate will not be collected by the WEC. You are approaching the WEC server CA certificate expiration date, which is 2 years...

* If this query does not display results with a timestamp from after the renewal process, it could indicate that the renewal process is not complete, so wait a few minutes before running another query. If you are still having a problem, contact Technical Support.

##### Important

* After you receive a notification for renewing your WEC CA certificate, we recommend that you do not add any new WEF clients until the WEC certification renewal process is complete. Events from these WEF clients that are added afterwards will not be collected by the server until the WEC certificates are renewed.

  10.1.3. Manage Broker VM

##### Note

* For more information on troubleshooting errors and warnings for these broker applets, see Troubleshoot Broker VM applet errors.

* Certain fields are also exposed in the Clusters tab, when a Broker VM node is added to a High Availability (HA) cluster, and each cluster node is expanded to view the Broker VM nodes table. An asterisk (*) is beside every field that is also included in the Broker VM nodes table for each HA cluster.

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  10.1.3.1. Edit Broker VM Configuration

##### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* Internal IP must be: Formatted as prefix/mask, for example 192.0.2.1/24. Must be within /8 to /24 range. Cannot be configured to end with a zero. For Broker VM version 9.0 and lower, Cortex XSIAM accepts only 172.17.0.0/16.

* Make sure you save the password before closing the window. The only way to re-generate a password is to disable ssh and re-enable.

  10.1.3.2. Increase Broker VM storage allocated for data caching

##### Note

* Follow your hypervisor documentation to understand how to add a persistent disk storage to your VM.

* If your disk is not listed and you didn't shutdown your Broker VM in your hypervisor before manually adding a disk to the VM, you'll need to reboot the Broker VM before the disk details are detected by the Broker VM. This can be performed either in the hypervisor or directly in the Broker VMs page.

##### Warning

* This operation is irreversible, and will make the disk become an integral part of the broker, where disconnecting the disk will result in errors and data loss.

  10.1.3.3. Monitor Broker VM using Prometheus

##### Note

* For all Broker VM nodes added to a HA cluster, you can also Configure the Broker VM nodes from the Clusters tab.

* For more information on Docker, see the Docker website.

  10.1.3.4. Collect Broker VM Logs

##### Note

* The Download Logs (<TIMESTAMP>) is only displayed when you've downloaded your logs previously using Generate New Logs.

  10.1.3.5. Upgrade Broker VM

##### Important

* After a Broker VM upgrade, your broker may require a reboot to finish installing important updates. A notification about this will be sent to your Cortex XSIAM console Notification Center.

  10.1.3.6. Import Broker VM Configuration

##### Important

* This option can only be used on Broker VMs with version 20.0 and later, and is only suitable for importing a configuration of brokers in the same version, or from a broker in an older version to a broker in a newer version.

* If your source Broker VM configuration includes a WEC applet, you'll need to ensure that you update the DNS record of this Broker VM's FQDN to point to the target Broker VM IP address.

  10.1.3.7. Open Live Terminal

##### Note

* You can either restart_routes or reboot the Broker VM for the changes in the /etc/network/routes file to take affect.

  10.1.3.8. Add Broker VM to cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  10.1.3.9. Switchover Primary Node in Cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  10.1.3.10. Remove from Cluster

##### Note

* If you've enabled a Load Balancer Health-Check on the cluster, you need to exclude this Broker VM from your Load Balancer settings.

  10.1.4. Manage Broker VM data collector applets

##### Note

* For more information on the Broker VM applet connectivity status, see Manage Broker VM.

  10.1.5. Broker VM High Availability Cluster

##### Note

* For Load Balancing, you must install a Load Balancer in your network which will distribute the incoming data between the nodes.

* The Pathfinder applet isn't supported when configuring Broker VMs in HA clusters.

  10.1.5.1. Configure High Availability Cluster

##### Prerequisite

* Be sure you do the following tasks before creating a cluster from an existing Broker VM: Since the Pathfinder applet isn't supported when configuring HA clusters, you must ensure Pathfinder is deactivated on the Broker VM. If the Broker VM is explicitly specified in some Agent Settings profile, which mean Cortex XSIAM agents retrieve release upgrades...

##### Important

* You can only create a new cluster from an existing Broker VM, when the Broker VM version is 19.0 and later, and the STATUS is Connected. The Create a Cluster from this Broker option is only listed if the Broker VM is not already added to a cluster.

* When the Protocol is set to HTTPS, you may need to perform a few follow-up steps to establish a validated secure SSL connection with the Broker VM. If you're using your own Certificate Authority (CA) to sign the certificates, you'll need to place the CA in the client, such as the Load Balancer, and upload the certificates to the Broker VM. If you're...

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  10.1.5.2. Manage Broker VM clusters

##### Navigation

  After you've configured a cluster, you can manage all your Broker VM clusters from the Clusters tab on the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs → Clusters

  10.1.5.2.1. View cluster details

##### Note

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

##### Navigation

  The Clusters tab of the Broker VMs page (Settings → Configurations → Data Broker → Broker VMs) enables you

  10.1.5.2.2. Edit cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs, and select the Clusters tab

  10.1.5.2.3. Add applet to cluster

##### Note

* With Cortex XDR Prevent, it's only relevant to configure a HA cluster with a Local Agent Settings applet as this is the only applet supported for this product license. The other applets are collector applets, which are only available in Cortex XDR Pro or Cortex XSIAM.

* For more information on troubleshooting errors and warnings for these applets, see Troubleshoot Broker VM applet errors.

  10.1.5.2.4. Add Broker VM to cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  10.1.5.2.5. Remove cluster

##### Navigation

  Settings → Configurations → Data Broker → Broker VMs

  10.1.6. Broker VM notifications

##### Note

* For more information on upgrading to a new Broker VM image, see Migrating to a New Broker VM Image.

  10.1.7. Monitor Broker VM activity

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  10.1.8. Troubleshoot Broker VM applet errors

##### Note

* For more information on creating correlation rules to trigger collection health issues, see How can I set up correlation rules to trigger collection health issues?.

  10.2. XDR Collectors

##### Note

* Ingestion of log events larger than 5 MB is not supported.

  10.2.1. XDR Collector audit logs

  10.2.2. XDR Collector machine requirements and supported operating systems

  10.2.3. Resources required to enable access to XDR Collectors

##### Note

* Some of the IP addresses required for access are registered in the United States. As a result, some GeoIP databases do not correctly pinpoint the location in which IP addresses are used. All customer data is stored in your deployment region, regardless of the IP address registration and restricts data transmission through any infrastructure to that...

* Throughout this topic, <xsiam-tenant> refers to the chosen subdomain of your Cortex XSIAM tenant and <region> is the region in which your Strata Logging Service is deployed.

  10.2.4. Manage XDR Collectors

  10.2.4.1. XDR Collectors installation resource for Windows and Linux

##### Note

* In some circumstances, such as after an XDR Collectors upgrade, the configured settings in the XML configuration file can be erased. Yet, this won't affect the saved settings in the XDR Collectors database.

  10.2.4.2. Create an XDR Collector installation package

##### Note

* To move existing XDR Collectors between Cortex XSIAM managing servers, you need to first Uninstall the XDR Collector from the collector machine and then for the new XDR Collector create a new installation package.

* Since Cortex XSIAM relies on the installation package ID to approve XDR Collector registration during install, it is not recommended to delete the installation package for any active on-premise collector machines. Hiding the installation package will remove it from the default list of available installation packages, and can be useful to eliminate...

  10.2.4.3. Install the XDR Collector installation package for Windows

  10.2.4.3.1. Install the XDR Collector on Windows using the MSI

##### Note

* When the package is executed using the MSI, an installation log is generated in %TEMP%\MSI<Random characters>.log by default.

* If the XDR Collector does not connect to Cortex XSIAM, verify your internet connection on the collector machine. If the XDR Collector still does not connect, verify that the installation package has not been removed from the Cortex XSIAM tenant.

  10.2.4.3.2. Install the XDR Collector on Windows using Msiexec

  10.2.4.4. Install the XDR Collector installation package for Linux

##### Note

* We recommend that you perform a Linux RPM or Linux DEB installation.

* If the XDR Collector does not connect to Cortex XSIAM, verify your Internet connection on the collector machine. If the XDR Collector still does not connect, verify the installation package has not been removed from the Cortex XSIAM management console.

* The XDR Collector does not support proxy communication in environments where proxy authentication is required.

##### Important

* When performing a XDR Collector installation or upgrade in Linux using a shell installer, the  /tmp folder cannot be marked as noexec. Otherwise, the installation or upgrade fails. As a workaround, before the installation or upgrade, use the following command:

  10.2.4.5. Configure the XDR Collector upgrade scheduler

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → XDR Collectors → Configuration

  10.2.4.6. Set an application proxy for XDR Collectors

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → XDR Collectors → Administration

  10.2.4.7. Set an alias for an XDR Collector machine

##### Navigation

  Settings → Configurations → XDR Collectors → Administration

  10.2.4.8. Upgrade XDR Collectors

##### Note

* The XDR Collector keeps the name of the original installation package after every upgrade.

  10.2.4.9. Uninstall the XDR Collector

##### Navigation

  Settings → Configurations → XDR Collectors → Administration

  Investigation & Response → Response → Action Center

  10.2.5. Define XDR Collector machine groups

##### Note

* XDR Collectors only support IPv4 addresses.

* Disconnecting Directory Sync in your Cortex XSIAM deployment can affect existing collector machine groups and policy rules based on Active Directory properties.

  10.2.6. About Cortex XDR Collector content updates

  10.2.7. XDR Collector profiles

  10.2.7.1. Add an XDR Collector profile for Windows

##### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex XSIAM collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex XSIAM supports logs in single line format or multiline format. For more...

  10.2.7.1.1. Ingest logs from Windows DHCP using Elasticsearch Filebeat

##### Note

* Although this enrichment is available when configuring a Windows DHCP collector for a cloud data collection integration, we recommend configuring Cortex XSIAM to receive Windows DHCP logs with an XDR Collector Windows Filebeat profile, because it is simpler to set up.

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the template provided by Cortex XSIAM to make your customizations. We recommend that you edit the file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating your...

* Configuration activities include editing the filebeat.yml file. To avoid formatting issues in this file, use the example file provided by Cortex XSIAM to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your filebeat.yml file. Validate the syntax of the YML file before you finish creating...

* The tokenizer definition is dependent on the Windows server version that you are using, because the log format differs. For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%...

  10.2.7.1.2. Ingest Windows DNS debug logs using Elasticsearch Filebeat

##### Note

* Detailed logs are significantly larger, because more information is added to the logs.

* To avoid formatting issues in your filebeat.yml file, we recommend that you validate the syntax of the file.

  10.2.7.2. Add an XDR Collector profile for Linux

##### Note

* Ingestion of log events larger than 5 MB is not supported.

* Fileset validation is enforced. You must enable at least one fileset in the module, because filesets are disabled by default. Cortex XSIAM collects all logs in either an uncompressed JSON or text format. Compressed files, such as the gzip format, are not supported. Cortex XSIAM supports logs in single line format or multiline format. For more...

  10.2.8. Apply profiles to collection machine policies

##### Navigation

  Settings → Configurations → XDR Collectors → Policies → +Add Policy

  10.2.9. XDR Collector datasets

  10.3. Data Collection

  10.3.1. Visibility of logs and issues from external sources

##### License Type

  Data collection may require an add-on.

##### Note

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs.

* Logs with sessionid = 0 are dropped.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. IOCs and BIOCs are only generated for these event types: sso and session_start.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. Analytics, IOCs and BIOCs are only generated on the Firewall data. The Zscaler Nanolog Streaming Service (NSS) feed for web logs is only used for Correlation Rules and threat hunting.

* While Correlation Rules issues are generated on non-normalized and normalized logs, Analytics, IOC and BIOC issues are only generated on normalized logs. The Zscaler Nanolog Streaming Service (NSS) feed for web logs is only used for Correlation Rules and threat hunting.

  10.3.2. Visibility of Cortex XSIAM audit and authentication logs

##### Note

* Cortex XSIAM can create Cortex XSIAM issues (Analytics, IOC, BIOC, and Correlation Rules) when relevant from logs.

  10.3.3. External data ingestion vendor support

##### License Type

  Data collection may require an add-on.

  10.3.4. Manage instances

  10.3.4.1. Add a new data source or instance

##### Note

* If a data source contains multiple integrations, the integration configured as the default integration will used by the Data Onboarder. The default integration of the content pack is indicated in each content pack's documentation. The other integrations are available for configuration in the Automation and Feed Integrations page after installing the...

* If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant page in the system, for example Correlations, Playbooks, or Scripts. If you are adding a new instance to an existing data source, these options are View only. You can adjust the view-only options on the relevant...

  10.3.4.2. How to configure the scanning settings for supported services

##### License Type

  Requires the Cortex Cloud Posture Management add-on or the Cortex Cloud Runtime Security add-on.

##### Note

* All the asset types are selected by default. When you deselect a data asset type, it is not included when the system runs the next scan operation, reducing the total scan time.

  10.3.4.3. Manage cloud instances

  10.3.4.4. Update cloud permissions after Cortex release updates

##### Prerequisite

* Ensure that the user account used to modify permissions has the necessary privileges within both the Cortex platform and your cloud environment, for example, AWS or Azure. You received a notification regarding a new version available that requires permission updates, or viewed a Needs Update status in the Data Sources page.

##### Note

* Instances requiring updates will not change their connection status, for example, Connected, Warning, Error, Disabled, due to the pending permission update.

  10.3.4.5. Pending cloud instances

  10.3.4.6. Troubleshoot errors on cloud instances

##### Note

* Errors related to collection of audit logs in the cloud instance are recorded in the collection_auditing dataset. For more information, see Audit logs fields and query examples.

  10.3.4.7. Manage Kubernetes Connector instances

  10.3.5. Palo Alto Networks integrations

##### License Type

  Data collection may require an add-on.

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

  10.3.5.1. About Palo Alto Networks integrations

##### Note

* For Palo Alto Networks Integrations there is an option to turn on or off the collection of URL and File log types. For more information, see Collecting URL and File log types.

* Roll-back of Strata Logging Service integration migration is not supported.

  10.3.5.2. Ingest data from Next-Generation Firewall

##### Prerequisite

* Ensure that you have completed the following on the NGFW or Panorama side: For Panorama only, ensure that the Panorama Cloud Services plugin is installed. Enable log forwarding profiles on firewall rules. On the Cortex XSIAM side, ensure that you have user role permissions for Data Collection > Data Sources. Configuration of data ingestion from...

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* If your firewalls are located in a different region, or bandwidth issues are encountered due to large log size, you can ingest NGFW logs in CEF format, using the Syslog collector. However, the Syslog solution is not as powerful nor as comprehensive as this data collector, and should only be used when this data collector cannot be used. For more...

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version.

* Cortex XSIAM does not validate your firewall credentials, you must ensure the certificates or PSK details have been updated in your firewalls in order for data to stream.

* It might take an hour or longer after connecting the firewall in Cortex XSIAM until you start seeing notifications that the certificate has been approved, and that the logging service license has appeared on the firewall.

* IOC and BIOC issues are applicable on stitched data only, and are not available on raw data.

##### Tip

* You can see an overview of ingestion status for all log types, and a breakdown of each log type and its daily consumption quota on the NGFW Ingestion Dashboard.

  10.3.5.2.1. Ingest Next-Generation Firewall logs using the Syslog collector

##### Note

* In the following procedure, general information is provided for NGFW and Panorama. For detailed instructions, consult the documentation for your specific devices and Panorama version, to ensure that you have configured log forwarding correctly for all the log types that you would like to forward to Cortex XSIAM. The following steps only cover...

* To avoid the possible effects of line formatting, do not copy/paste the message formats directly into the PAN-OS web interface. Instead, paste into a text editor, remove any carriage return or line feed characters, and then copy and paste into the web interface.

* From version 10.0 and later, the log format documented for log types (Traffic, Threat, and URL) exceeds the maximum supported 2048 characters in the Custom Log Format tab on the firewall and Panorama. Select the CEF keys and values to limit the number of characters to 2048, as per your requirements.

  10.3.5.3. Ingest data from Prisma Access

##### Prerequisite

* Configuration of data ingestion from multiple accounts requires Super User permissions in both Cortex XSIAM tenant and Prisma Access accounts.

##### Note

* Roll-back of Strata Logging Service integration migration is not supported.

* Cortex XSIAM does not validate your Prisma Access account credentials. You must ensure the account has been deployed in order for data to stream.

  10.3.5.4. Ingest logs from Prisma Access Browser

  10.3.5.5. Ingest detection data from Strata Logging Service

##### Note

* IOC and BIOC issues are applicable on stitched data only and are not available on raw data.

  10.3.5.6. Ingest alerts and assets from IoT Security

  10.3.5.7. Collecting URL and File log types

  10.3.5.7.1. Detectors connected to URL and File log types

  10.3.6. External data ingestion

  10.3.6.1. External applications

  10.3.6.2. Ingest network connection logs

  10.3.6.2.1. Ingest network flow logs from Amazon S3

##### Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* To create a new VPC, click Launch VPC Wizard. For more information, see AWS VPC Flow Logs.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex XSIAM.

  10.3.6.2.1.1. Create an assumed role

##### Note

* In AWS this is an optional field to configure, but this must be configured to set up the Amazon S3 Collector in Cortex XSIAM .

* The <s3-arn> and <sqs-arn> placeholders. These will be filled out later depending on which Amazon S3 logs you are configuring, including network flow logs, audit logs, or generic logs.

  10.3.6.2.1.2. Configure data collection from Amazon S3 manually

##### License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

##### Note

* If you already have an Amazon S3 bucket configured with VPC flow logs that you want to use for this configuration, you do not need to perform the prerequisite steps detailed in the first two bullets.

* It is your responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* If you already have an Amazon S3 bucket configured with VPC flow logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

  10.3.6.2.2. Ingest network Route 53 logs from Amazon S3

##### Note

* For more information on configuring data collection from Amazon S3 for Route 53 DNS logs, see the AWS Documentation.

* For more information on creating a Stack, see Creating a stack on the AWS CloudFormation console.

* For the Amazon S3 bucket created using CloudFormation, it is the customer's responsibility to define a retention policy by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* It is the responsibility of the customer's organization to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Access Key to provide access to Cortex XSIAM.

  10.3.6.2.3. Ingest logs from Check Point firewalls

##### Note

* Logs with sessionid = 0 are dropped. Destination Port data is available only in the raw logs.

  10.3.6.2.4. Ingest logs from Cisco ASA firewalls and AnyConnect

  10.3.6.2.5. Ingest logs from Corelight Zeek

  10.3.6.2.6. Ingest logs from Fortinet Fortigate firewalls

  10.3.6.2.7. Ingest logs from Microsoft Azure Event Hub

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

##### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

##### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  10.3.6.2.8. Ingest network flow logs from Microsoft Azure Network Watcher

##### Prerequisite

* For NSG:    Ensure that your NSG flow logs in Azure Network Watcher conform to the requirements as outlined in Microsoft documentation. For more information, see Introduction to flow logging for network security groups.   Enable NSG flow logs in the Microsoft Azure Portal. For NSG: Ensure that your NSG flow logs in Azure Network Watcher conform to the...

##### Note

* In addition to your storage account, the template automatically creates another storage account that is required by the function app for internal use only. The internal storage account name is prefixed with cortex and is followed by a unique suffix based on the resource group, storage account, and container names.

  10.3.6.2.9. Ingest logs and data from Okta

  10.3.6.2.10. Ingest logs from Windows DHCP using Elasticsearch Filebeat

##### Note

* To avoid formatting issues in filebeat.yml, we recommend that you edit the text file inside the user interface, instead of copying it and editing it elsewhere. Validate the syntax of the YML file before you finish creating the profile.

* For more information on configuring the filebeat.yml file, see the Elastic Filebeat Documentation.

* To avoid formatting issues in your filebeat.yml, we recommend that you use the download example file to make your customizations. Do not copy and paste the code syntax examples provided later in this procedure into your file.

* The tokenizer definition is dependent on the Windows server version that you are using as the log format differs. -For platforms earlier than Windows Server 2008, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{macAddress}" -For Windows Server 2008 and 2008 R2, use "%{id},%{date},%{time},%{description},%{ipAddress},%{hostName},%{mac...

  10.3.6.2.11. Ingest logs from Zscaler Internet Access

  10.3.6.2.12. Ingest logs from Zscaler Private Access

##### Note

* For more information on configuring the parameters on the screen, see the Zscaler Private Access (ZPA) documentation for Configuring a Log Receiver.

* You can only configure a ZPA log receiver to collect one type of log with your Syslog Collector in Cortex XSIAM. To configure more that one log type, you'll need to add another log receiver.

  10.3.6.3. Ingest authentication logs and data

  10.3.6.3.1. Ingest audit logs from AWS Cloud Trail

##### Note

* For more information on configuring data collection from Amazon S3 using AWS CloudTrail, see the AWS CloudTrail Documentation.

* For more information on creating an AWS CloudTrail trail, see Create a trail. If you already have an Amazon S3 bucket configured with AWS CloudTrail audit logs, skip this step and go to Configure an Amazon Simple Queue Service (SQS).

* It is your organization's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* The CloudWatch Logs - optional settings are not supported and should be left disabled.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It your organization's responsibility to ensure that the user who performs this task of creating the access key is designated with the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

  10.3.6.3.2. Ingest logs and data from a GCP Pub/Sub

##### Note

* When collecting flow logs, we recommend that you include GKE annotations in your logs, which enable you to view the names of the containers that communicated with each other. GKE annotations are only included in logs if appended manually using the custom metadata configuration in GCP. For more information, see VPC Flow Logs Overview. In addition, to...

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the GCP data collector settings. Yet, when the values are blank in the...

  10.3.6.3.3. Ingest logs and data from Google Workspace

##### Note

* For all types of data collected via the Admin Reports API, except alerts and emails, the log events are collected with a preset lag time as reported by Google Workspace. For more information on these lag times for the different types of data, see Google Workspace Data retention and lag times.

* Spam emails from the compliance email account, and from all other monitored email accounts, are not collected. Any draft emails written in the compliance email account are collected by the Google Workspace data collector, and are then deleted even if the email was never sent.

* For more information on the entire process, see Perform Google Workspace Domain-Wide Delegation of Authority.

* When collecting Google Workspace alerts with other types of data, except emails, you need to configure a service account in Google with the applicable permissions to collect events from the Google Reports API and alerts from the Alert Center API. If you prefer to use different service accounts to collect events and alerts separately, you'll need to...

* For more information on the Admin Reports API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information on the Gmail API scopes, see OAuth 2.0 Scopes for Google APIs.

* For more information about the events collected from the various Google Reports, see Google Workspace Reports API Documentation.

  10.3.6.3.4. Ingest logs from Microsoft Azure Event Hub

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

##### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

##### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  10.3.6.3.5. Ingest logs from Microsoft Office 365

##### Note

* Ingesting Microsoft Entra ID (formerly known as Azure AD) authentication and audit events from Microsoft Graph API requires a Microsoft Azure Premium 1 or Premium 2 license. Alternatively, if the directory type is Azure AD B2C, the sign-in reports are accessible through the API without any additional license requirement. To ingest email logs and data...

* When auditing is turned off from the default setting, you need to first turn on auditing for your organization to collect Microsoft Office 365 audit events from the Management Activity API. Log duplication of up to 5% in Microsoft products is considered normal. In some cases, such as login to a portal using MFA, two log entries are recorded by design.

* To address Azure reporting latency, there is a 10-minute latency period for Cortex XSIAM to receive Azure AD logs.

* You can also implement the corresponding Cortex Data Model (XDM) mappings for these Microsoft Graph Security API v2 alerts using Cortex Marketplace via the Microsoft Graph Security content pack.

* For more information, see the Office 365 Management Activity API schema.

* In FedRAMP environments, Azure sign-in logs are not supported, due to vendor technical constraints.

* Use this option when you don't want to grant permissions for Azure AD Authentication and Azure AD Audit.

  10.3.6.3.6. Ingest logs and data from Microsoft 365

##### License Type

  Email data: The subject, body, and attachments are visible only with an Email Security module license.

##### Prerequisite

* A user account with the Microsoft Azure Account Administrator role is required to set up a new Microsoft 365 email collector. The following Microsoft Graph API permissions are required:    Mailbox access (read-write)    Read and write mail in all mailboxes   Read contacts in all mailboxes   Read all user mailbox settings      User information, groups,...

##### Note

* For other logs from Microsoft Office 365, use the Office 365 data collector. For more information, see Ingest logs from Microsoft Office 365.

  10.3.6.3.7. Ingest logs and data from Okta

  10.3.6.3.8. Ingest logs and data from OneLogin

##### Note

* Event data is collected every 30 seconds.

* Inventory data snapshots are collected every 10 minutes.

  10.3.6.3.9. Ingest authentication logs from PingFederate

  10.3.6.3.10. Ingest authentication logs and data from PingOne

##### Navigation

  Reporting → Subscriptions → Add Subscription

  10.3.6.4. Ingest operation and system logs from cloud providers

  10.3.6.4.1. Ingest generic logs from Amazon S3

##### License Type

  Requires the Cortex Cloud Runtime Security or Data Collection add-on.

##### Note

* For more information on configuring data collection from Amazon S3, see the Amazon S3 Documentation.

* You need to set up an Amazon S3 data collector to receive generic logs when collecting logs from BeyondTrust Privilege Management Cloud. For more information, see Ingest logs from BeyondTrust Privilege Management Cloud.

* If you want to ingest raw EDR events from SentinelOne DeepVisibility, use the SentinelOne DeepVisibility log collector. For more information, see Ingest raw EDR events from SentinelOne DeepVisibility.

* It is the customer's responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule in the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If your receive an error when trying to save your changes, you should ensure that the permissions are set up correctly.

* It is the responsibility of your organization to ensure that the user who performs this task of creating the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors. Skip this step if you are using an Assumed Role for Cortex XSIAM.

* For more information, see Managing access keys for IAM users.

* Skip this step if you are using an Assumed Role for Cortex XSIAM.

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor...

  10.3.6.4.2. Ingest logs from Amazon CloudWatch

  10.3.6.4.3. Ingest logs and data from a GCP Pub/Sub

##### Note

* When collecting flow logs, we recommend that you include GKE annotations in your logs, which enable you to view the names of the containers that communicated with each other. GKE annotations are only included in logs if appended manually using the custom metadata configuration in GCP. For more information, see VPC Flow Logs Overview. In addition, to...

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the GCP data collector settings. Yet, when the values are blank in the...

  10.3.6.4.4. Ingest logs from Google Kubernetes Engine

##### Note

* Cortex XSIAM supports logs in single line format or multiline format. For more information on handling messages that span multiple lines of text in Elasticsearch Filebeat, see Manage Multiline Messages.

  10.3.6.4.5. Ingest logs from Microsoft Azure Event Hub

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection from Azure Event Hub. Before you set up an Azure Event Hub, calculate the quantity of data that you expect to send to Cortex XSIAM, taking into account potential data spikes and potential increases in data ingestion, because partitions cannot be modified after creation....

##### Note

* For more information on Azure Event Hub audit logs, see Overview of Azure platform logs.

* These logs are from the management plane.

* Even though you can collect Azure AD Activity logs and Azure Sign-in logs using the Azure Event Hub data collector, we recommend using the Microsoft Office 365 data collector, because it is easier to configure. In addition, ensure that you do not configure both collectors to collect the same types of logs, because if you do so, you will be creating...

* These logs are from the data plane.

* If you want to ingest raw Microsoft Defender for Endpoint events, use the Microsoft Defender log collector. For more information, see Ingest raw EDR events from Microsoft Defender for Endpoint.

* For every resource that you want to confiure, you'll have to repeat this step, or use Azure policy for a general configuration.

* There are additional log categories displayed. We recommend selecting all the available options.

* When you Normalize and enrich audit logs, the log format is automatically configured. As a result, the Log Format option is removed and is no longer available to configure (default).

* For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor and Product fields in the Azure Event Hub data collector settings. Yet, when the values are...

* When you Normalize and enrich audit logs, the Vendor and Product fields are automatically configured, so these fields are removed as available options (default).

##### Warning

* Misconfiguration of Event Hub resources could cause ingestion delays. In an existing Event Hub integration, do not change the mapping to a different Event Hub. Do not use the same Event Hub for more than two purposes.

  10.3.6.4.6. Ingest logs and data from Okta

  10.3.6.5. Ingest endpoint data

  10.3.6.5.1. Ingest alerts and metadata from CrowdStrike APIs

##### Note

* To enable some of the APIs, you may need to reach out to CrowdStrike support.

* For more information on configuring data collection from CrowdStrike APIs, see the CrowdStrike Documentation.

* Ensure that you save the SECRET value because this is the only time that it is displayed.

  10.3.6.5.2. Ingest raw EDR events from CrowdStrike Falcon Data Replicator

##### Prerequisite

* Ensure that your organization has a license for the CrowdStrike Falcon Data Replicator (FDR). Ensure that CrowdStrike FDR is enabled. CrowdStrike FDR can only be enabled by CrowdStrike Support. If CrowdStrike FDR is not enabled, submit a support ticket through the CrowdStrike support portal. Follow these steps to check if CrowdStrike FDR is...

##### Note

* Due to limitations with the S3 bucket used by CrowdStrike, data can only be collected once, by one system.

* For more information on configuring data collection from CrowdStrike via Falcon Data Replicator, see CrowdStrike documentation.

* Ensure that you copy the Secret, and store it in a safe place. You will not be able to retrieve it later. If you need a new secret, you must reset the feed credentials.

* CrowdStrike Falcon Data Replicator only supports one FDR credential configuration.

* Ensure that you save the SECRET value, because this is the only time that it is displayed. You can go back to this page later to copy the other credentials, but you will not have access to the secret again.

  10.3.6.5.3. Ingest raw EDR events from Microsoft Defender for Endpoint

##### Prerequisite

* Ensure that you do the following tasks before you begin configuring data collection. Create an Azure Event Hub. For more information, see Quickstart: Create an event hub using Azure portal.    Create a resource group (optional if you already have a resource group configured).   Create an Event Hubs namespace.   Create an event hub within the namespace....

##### Note

* The generic Cortex XSIAM Azure Event Hub collector does not offer full functionality for EDR data (such as stitching), and is therefore not suitable for EDR data ingestion.

* If you select all event types and leave Event-Hub name empty, an event hub will be created for each category in the selected namespace. If you are not using a Dedicated Event Hubs ClusterEvent Hub, namespaces have a limit of 10 Event Hubs.

  10.3.6.5.4. Ingest raw EDR events from SentinelOne DeepVisibility

##### Prerequisite

* The SentinelOne DeepVisibility logs that will be collected by your dedicated Amazon S3 bucket must adhere to the following guidelines:    Each log file must use the 1 log per line format as multi-line format is not supported.   The log format must be compressed as gzip or uncompressed.   For best performance, we recommend limiting each file size to up...

##### Note

* It is your responsibility to define a retention policy for your Amazon S3 bucket by creating a Lifecycle rule on the Management tab. We recommend setting the retention policy to at least 7 days to ensure that the data is retrieved under all circumstances.

* Ensure that you create your Amazon S3 bucket and Amazon SQS queue in the same region.

* For more information on granting permissions to publish messages to an SQS queue, see Granting permissions to publish event notification messages to a destination.

* If you receive an error when trying to save your changes, check that the permissions are set up correctly, and fix them if necessary.

* It is the responsibility of your organization to ensure that the user who creates the access key is assigned the relevant permissions. Otherwise, this can cause the process to fail with errors.

* For more information, see Managing access keys for IAM users.

  10.3.6.6. Ingest cloud assets

##### Note

* The cloud accounts being onboarded must be owned by the customer performing the onboarding process.

  10.3.6.6.1. Onboard Amazon Web Services

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

##### Prerequisite

* Before you begin, ensure you have: Access to AWS Management Console Required AWS permissions

##### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* When onboarding an AWS organization or organizational unit (OU), Cortex XSIAM creates IAM resources in every account within that organization or OU. This occurs even if you choose to exclude specific accounts from being scanned. While excluded accounts will not be scanned and will not appear in the asset inventory, the IAM resources may still be...

* See the prerequisites above for specific permissions required for serverless functions.

* If you select Automated, you must already be logged in to AWS.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

  10.3.6.6.1.1. Manually upload template to AWS

##### Prerequisite

* Before you begin, ensure you have: An AWS account Access to AWS Management Console Permission to create a stack and its resources in AWS CloudFormation

  10.3.6.6.2. Onboard Google Cloud Platform

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

##### Prerequisite

* Before you begin, ensure you have: Access to Google Cloud Console Admin user with required admin GCP permissions Enabled the following APIs in the GCP project you are onboarding:    Cloud Resource Manager API   Identity and Access Management (IAM) API   Cloud Pub/Sub API (if audit logs are enabled) Enabled the following APIs in the GCP project you are...

##### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

  10.3.6.6.2.1. Manually upload template to GCP

##### Prerequisite

* Before you begin, ensure you have: A GCP account. Permission to create the required resources in Google Cloud Deployment Manager. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool.

##### Note

* The directory you create must be a subdirectory of the home directory.

  10.3.6.6.2.2. Monitor GCP resources inside service perimeters

##### Note

* Each GCP cloud instance is assigned a scope within GCP. If the scope, whether it be organization, folder, or project, includes any projects with a service perimeter, this procedure must be performed for that cloud instance to authorize Cortex XSIAM to scan the resources in the perimeter.

  10.3.6.6.3. Onboard Microsoft Azure

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

##### Prerequisite

* Before you begin, ensure you have: An Azure subscription Admin permissions required to onboard Azure or the built-in Security Administrator role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups.

##### Note

* Scanning with an outpost may require additional CSP permissions and may incur additional CSP costs.

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

  10.3.6.6.3.1. Manually upload template to Microsoft Azure Resource Manager using the CLI

##### Prerequisite

* Ensure the Azure CLI tool is installed and you are authorized to create management group policies.

  10.3.6.6.3.2. Manually upload template for Microsoft Azure subscriptions

##### Prerequisite

* Before you begin, ensure you have: An Azure subscription. A user with the required permissions for the subscription scope. We recommend you create a dedicated role. Tenant ID and subscription ID. You can view these in Microsoft Azure Portal in Management groups. Installed Terraform on your local machine. You can download Terraform from the official...

* Ensure the Azure CLI tool is installed and you are authorized to create management group policies.

  10.3.6.6.4. Onboard Oracle Cloud Infrastructure

##### License Type

  This feature is included with a Cortex XSIAM Premium license. It is also included with any other Cortex XSIAM license that has the Cloud Runtime Security or Cloud Posture Management add-ons.

##### Prerequisite

* Before you begin, ensure you have: Access to Oracle Cloud Infrastructure console Permissions for all of the following are required:    Creation of identity groups (for more information, refer to Managing Groups)   Policies (for more information, refer to How Policies Work)   Tag namespaces in the root compartment (for more information, refer to Tags...

##### Note

* The template is reusable and can be executed as many times as you want to create new instances with the settings you defined in the wizard. The template is valid for seven days from when it was created.

* You can see the automatically created automation instance in the Automation & Feed Integrations page under the Cloud Services section, and it will have the same name as the cloud integration instance. The instance is read-only; you can only modify the instance from the Data Sources page.

  10.3.6.6.4.1. Manually upload template to OCI

##### Prerequisite

* Before you begin, ensure you have: An Oracle Cloud Infrastructure account and the tenancy OCID. Permission to deploy a custom template and create its resources in OCI. Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed...

  10.3.6.6.5. Configure AWS integration instances and monitor integration instance health

##### Note

* If you have not yet onboarded your cloud integration, see Ingest cloud assets.

* Currently, automation permission errors or missing automation permissions do not affect the Automation health status. You can view any permission errors or missing permissions in the the Permissions health status.

  10.3.6.6.6. Manually connect a cloud instance

  10.3.6.6.7. Outposts

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Before you begin, ensure you have: An AWS account Permission to create a stack and its resources in AWS Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the AWS CLI tool and configured your profile with the aws...

* Before you begin, ensure you have: A GCP account Permission to create the required resources in Google Cloud Deployment Manager Installed Terraform on your local machine. You can download Terraform from the official Terraform website and follow the installation instructions for your operating system. Installed the GCP gcloud CLI tool

* Before you begin, ensure you have: An active Azure subscription. Installed the Azure CLI tool. Permission to deploy a custom template and create its resources in Microsoft Azure ("Owner" or "Contributor" on the designated outpost subscription scope, and Active Directory "Cloud Application Administrator" or "Application Administrator" privileged...

##### Note

* We recommend you use a dedicated account for the outpost, free from other resources. You can only onboard one outpost for each account.

* When creating an outpost for a specific Azure subscription, the outpost account must be in the same Azure organization as the monitored subscriptions.

##### Navigation

  Settings → Data Collection → Outposts

  You can create a new outpost by navigating to Settings → Data Collection → Outposts and clicking New Outpost

  10.3.6.6.8. Container Registry Scanning

  10.3.6.6.8.1. Overview of container registry scanning

  10.3.6.6.8.1.1. Registry Components

  10.3.6.6.8.1.2. How Container Registry Scanning Works

  10.3.6.6.8.2. Configure registry scanning

##### Prerequisite

* Ensure that you have performed the all steps till Additional Security Capabilities as listed in the onboarding wizard for the required CSP: Onboard Amazon Web Services Onboard Google Cloud Platform Onboard Microsoft Azure

  10.3.6.6.8.3. Modify the container registry scanning scope

  10.3.6.6.8.4. Scan re-evaluation process

  10.3.6.6.8.5. Connect Docker V2 compliant container registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant. Outposts

* Ensure one of the following is configured: Set up and configure Broker VM. Configure High Availability Cluster.

##### Note

* Scanning is supported only for private repositories on Docker Hub.

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* FedRAMP is not supported for this mode.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  10.3.6.6.8.5.1. Manage a Docker V2 connector

  10.3.6.6.8.6. Connect JFrog container registry

##### Prerequisite

* Ensure an Outpost is connected to your tenant.

* Set up and configure Broker VM Configure High Availability Cluster

##### Note

* If you choose Azure as the Cloud Provider, you must also select the Tenant Id. The Tenant Id is required to approve Cortex as an enterprise application in your Azure tenant.

* If you choose Azure as the cloud provider, only Outposts associated with the selected tenant ID are displayed.

* The list of Broker VMs displays only VMs that support registry scanning. The list of high-availability Clusters displays only clusters that contain at least one VM supporting registry scanning. The registry scanning status for each VM appears in brackets if it was previously activated for that specific VM.

  10.3.6.6.8.6.1. Manage a JFrog connector

  10.3.6.6.9. Cloud service provider permissions

  10.3.6.6.9.1. Amazon Web Services provider permissions

  10.3.6.6.9.2. Google Cloud Platform provider permissions

  10.3.6.6.9.3. Microsoft Azure provider permissions

  10.3.6.6.9.4. Oracle Cloud Infrastructure provider permissions

  10.3.6.7. Ingest data for API security

  10.3.6.7.1. Ingest AWS API Gateway

##### Note

* You must generate a new key if you did not save.

* If no logs are showing, send some API requests on Postman or CURL.

##### Important

* Leave '–'filter-pattern empty as displayed above.

  10.3.6.7.2. Ingest Azure APIM

##### License Type

  Requires the Data Collection add-on.

##### Note

* Microsoft Azure APIM service must be running before starting to configure the integration.

* From the URL, save the UUID and the resource group - /resource/subscriptions/<UUID>/resourceGroups/<ResourceGroup>. The UUID is the Azure account/subscription ID and the resource group, which is the group where the APIM Service is defined.

* Use the search to navigate to the specific section.

* 131072 bytes = 128 KB. This value determines the size (in bytes) of request and response bodies to send to Cortex. Any bytes beyond this limit are truncated.

* If any other inbound policies should be added, they must be added after these elements.

##### Important

* If you want to add additional data to the <outbound>, add it at the start of the <outbound> code.

  10.3.6.7.3. Ingest Apigee Proxy

##### License Type

  Requires the Data Collection add-on.

##### Note

* The steps include the prerequisites that run the automated script that deploys files and configurations to Apigee. For manual configuration, refer to the section Manual deployment.

* If you have an existing hookand would like to integrate with the shared flow, run the deploy.sh script, and select n' and exit at the prompt to create a new hook. Refer to the section Connect to existing hook.

* Start with the hook in pre-proxy.

* Archive deployments are currently in preview and are subject to change.

##### Important

* This should only be done when there are already existing hooks, and API security shared flows can't be hooked as a standalone. Run the deployment script, but skip step 9 by passing n. This step publishes API security shared flows to the desired Apigee environment without setting them to flow hooks.

  10.3.6.7.4. Ingest Kong

##### License Type

  Requires the Data Collection add-on.

##### Note

* The queue parameters can be updated to change when the plugin mirrors data to Cortex.

* Use commas to separate tags.

##### Important

* The size of the buffer must be equal to or larger than the max body size setting in the plugin configuration, on every data plane node.

  10.3.6.8. Ingest data from third-party pipeline solutions

  10.3.6.8.1. Ingest data from Cribl

##### Prerequisite

* Ensure that you have the credentials and IDs for each data source, such as Tenant ID, App ID and Client secret.

* Ensure that you have the copies of the Cortex XSIAM authorization token and API URL obtained in Task 2.

##### Note

* We do not support email data collection via Cribl.

* Only one Cribl data collector instance can be configured in Cortex XSIAM.

  10.3.6.8.1.1. Data source UUIDs

##### Note

* Do not use this generic UUID when your data source is listed in this table.

  10.3.6.9. Additional log ingestion methods

  10.3.6.9.1. Ingest logs from a Syslog receiver

  10.3.6.9.2. Ingest Apache Kafka events as datasets

  10.3.6.9.3. Ingest CSV files as datasets

  10.3.6.9.4. Ingest database data as datasets

  10.3.6.9.5. Ingest logs in a network share as datasets

##### Note

* The Files and Folders Collector applet only starts to collect files that are more than 256 bytes.

  10.3.6.9.6. Ingest FTP files as datasets

  10.3.6.9.7. Ingest NetFlow flow records as datasets

  10.3.6.9.8. Set up an HTTP log collector to receive logs

##### Note

* -The Vendor and Product defaults to Auto-Detect when the Log Format is set to CEF or LEEF. -For a Log Format set to CEF or LEEF, Cortex XSIAM reads events row by row to look for the Vendor and Product configured in the logs. When the values are populated in the event log row, Cortex XSIAM uses these values even if you specified a value in the Vendor...

* Each record cannot exceed 5 MB in size.

  10.3.6.9.9. Ingest logs from BeyondTrust Privilege Management Cloud

##### Note

* For a Log Format set to Beyondtrust Cloud ECS, the following fields are automatically set and not configurable. Vendor: Beyondtrust Product: Privilege Management Compression: Uncompressed

  10.3.6.9.10. Ingest logs and data from Box

##### Prerequisite

* Set up an Enterprise Box plan.  Important To collect Box Shield Alerts, you must purchase Box Shield and it must be enabled on Box enterprise. Set up an Enterprise Box plan. Create a valid Box account that is assigned to a role with sufficient permissions for the data you want to collect. For example, create an account assigned to an Admin role to...

##### Note

* The Fetch Intervals are non-configurable.

* Collecting Box Shield Alerts requires implementing Box Shield,

* There is a current bug with the Groups API from Box. If you don't configure the Box app with the proper permissions for managing groups data, the Groups API from Box won't return an error message to Cortex XSIAM indicating that the API failed to receive the data, and the Groups data will not be collected.

* For any future change that you make to your Box app, ensure that you send the changes for approval to the administrator, who will need to approve them as explained above.

* Inventory data snapshots are collected every 10 minutes.

  10.3.6.9.11. Ingest logs and data from Dropbox

##### Prerequisite

* Set up an Advanced Dropbox plan. Create a Dropbox Business admin account with Security admin permissions, which is required to authorize Cortex XSIAM to access the Dropbox Business account and generate the OAuth 2.0 access token.

##### Note

* The Fetch Interval is non-configurable.

* When the App Key field is empty, the here link in the tooltip is disabled. When an incorrect App Key is entered, clicking the link results in a 404 error.

* Whenever you change the permissions of the Dropbox app, we recommend that you generate a new Access Code for the Dropbox data collector instance so that the permissions match the updates.

* Event data is collected every 60 seconds with a 10 minute lag time.

* Inventory data snapshots are collected every 10 minutes.

  10.3.6.9.12. Ingest logs from Elasticsearch Filebeat

##### Navigation

  You can return to the Settings → Configurations → Data Collection → Data Sources page to monitor the status of your Filebeat configuration

  10.3.6.9.13. Ingest logs from Forcepoint DLP

  10.3.6.9.14. Ingest logs from Proofpoint Targeted Attack Protection

  10.3.6.9.15. Ingest logs and data from Salesforce.com

##### Prerequisite

* Cortex XSIAM:    To manage collection integration in Cortex XSIAM, ensure that you have the privilege to View/Edit Log Collections (for example, Instance Administrator). Cortex XSIAM: To manage collection integration in Cortex XSIAM, ensure that you have the privilege to View/Edit Log Collections (for example, Instance...

##### Note

* For more detailed reference information, see Configure a Connected App for the OAuth 2.0 Client Credentials Flow. Unlike other data collector setups, in this case, the setup includes obtaining an OAuth 2.0 code from Salesforce.com, and this code is only valid for 15 minutes. Therefore, make sure that you enable the data collector within 15 minutes of...

* When these options are cleared, only these data types will be omitted from collection. All other data will be collected as usual.

  10.3.6.9.16. Ingest data from ServiceNow CMDB

  10.3.6.9.17. Ingest report data from Workday

##### Prerequisite

* Create an Integration System User that is designated to access the custom report from Workday for data collection in Cortex XSIAM. Create an Integration System Security Group for the Integration System User created in Step 1 for accessing the report. When setting this group ensure to define the following:    Type of Tenanted Security Group: Select...

##### Note

* Any user with permissions to view issues and cases can view the Workday data.

* For more information on completing any of the prerequisite steps, see the Workday documentation.

* The Business Object changes depending on the Data Source selected.

* Cortex XSIAM uses a structured schema when integrating Workday data. To get the best Analytics results, specify all the fields marked with an asterisk from the recommended schema. workday_user_id* full_name* workday_manager_user_id* manager* worker_type* position_title* department* private_email_address* business_email_address* employment_start_date* em...

  10.3.6.9.18. Ingest external alerts

##### Note

* If you send pre-parsed alerts using the Cortex XSIAM API, additional mapping is not required.

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → Data Collection → External Issue Mapping

  10.3.7. Onboard the Kubernetes Connector

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Note

* For GKE or EKS clusters with the metadata service disabled and for AKS clusters with non-default nodes managed resource group, the cluster resource identifier must be specified.

  10.3.7.1. What's new in Kubernetes Connector?

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

  10.3.8. Automation and feed integrations

##### Note

* Some integrations can be downloaded directly without having to initially download a content pack from Marketplace. For more information, see Define data sources. In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as...

* If the integration was installed from a content pack, you need to duplicate the integration before editing.

* If the integration was installed from a content pack, you need to duplicate the integration before downloading.

* Integration commands are only available when the integration instance is enabled. Some commands depend on a successful connection between Cortex XSIAM and third-party integrations.

##### Tip

* In the Playground, you can clear the context data, if needed, which deletes everything in the Playground context data, but does not affect the actual issue or case. To clear the context, run !DeleteContext all=yes' from the CLI or click Clear Context Data while viewing the context data.

  10.3.8.1. Integration use cases

  10.3.8.2. Add an integration instance

##### Note

* This procedure describes how to add an integration instance from the Automation and Feed Integration page. Some integration instances can also be configured on the Data Sources page. For more information, see Add a new data source or instance.

* In some integrations, a classifier, an issue type, and mapper fields are included.

##### Navigation

  Settings → Configurations → Data Collection → Automation & Feed Integrations and search for the integration

  10.3.8.3. Configure integration permissions

##### Navigation

  Settings → Configurations → Data Collection → Integration Permissions

  10.3.8.4. Fetch issues from an integration instance

##### Note

* In some integrations, the Issue Fetch interval is called Feed Fetch Interval. If the integration instance does not have the Issue Fetch Interval field, you need to add this field by editing the integration settings. If the integration is from a content pack, you need to create a copy of the integration. Any future updates to this integration will not...

* Some content packs include preconfigured correlation rules, but you should review them to see if they suit your use case and duplicate them if required. Go to Threat Management → Detection Rules → Correlations, search for the relevant rule, right-click, and select Preview Rule. For example, the ServiceNow v2 Alerts (automatically generated)...

  10.3.8.4.1. Map fields to issue types

##### Note

* In the Classification & Mapping page, the mapping does not indicate for which issue types they are configured. Therefore, when creating a mapper, it is best practice to add to the mapper name, the issue types the mapper is for. For example, Mail Listener - Phishing.

* When mapping a list, we recommend you map to a multi select field. Short text fields do not support lists. If you do need to map a list to a short text field, add a transformer in the relevant playbook task, to split the data back into a list.

##### Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

  Settings → Configurations → Data Collection → Automation & Feed Integrations

  10.3.8.4.2. Classify events using a classifier for issue types

##### Navigation

  Settings → Configurations → Object Setup → Issues → Classification & Mapping

  Settings → Configurations → Data Collection → Automation & Feed Integrations

  10.3.8.5. Troubleshoot Integrations

  10.3.8.6. Forward Requests to Long-Running Integrations

##### Note

* This integration replaces the External Dynamic list integration, which is deprecated. For more information about how to set up the integration, see Manage external dynamic lists.

* When running on the tenant, you can only use long-running integrations provided by Cortex XSIAM, you cannot create custom ones. Custom long-running integrations are supported only on engines at this time. Configuring custom certificates or private API Keys in the long-running integration instance is supported only on engines, not on the Cortex XSIAM...

* For the TAXII Server and TAXII2 Server integrations, the xdr string is automatically replaced by crtx. For the Microsoft Teams integration, you can use the microsoft-teams-create-messaging-endpoint command to get the correct messaging endpoint based on the server URL, the server version, and the instance configurations. For more information, see...

  10.3.9. Verify collector connectivity

##### Note

* For more information on troubleshooting data collector applet errors, see Troubleshoot Broker VM applet connectivity.

* If an issue is triggered, the investigation options in the right-click menu of the Health Issues pages are context-specific. Make sure that you specify the relevant issue category.

  10.3.10. Overview of data ingestion metrics

##### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics. Data Ingestion Monitoring: Go to Configurations → General → Server...

  10.3.10.1. Creating correlation rules to monitor data ingestion health

  10.3.10.2. Measuring data freshness

##### Note

* The max_delay metric is taken from the maximum bucket value with a restricted limit; therefore, metrics show whole numbers. The median and ninetieth_percentile metrics are statistical calculations that give an approximation of the real value; therefore, metrics show decimal numbers. Time slots with a zero log count or zero byte count display records...

  10.3.11. About health issues

##### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable the following settings under Configurations: Cortex - Analytics: Go to Configurations → Cortex - Analytics. For more information, see Enable the Analytics Engine and Identity Analytics. Data Ingestion Monitoring: Go to Configurations → General → Server...

##### Note

* The Health Issues page displays issues that were triggered after July 2024. To see health issues that were triggered before this date, click Legacy Health Issues.

* Cortex XSIAM enforces the dedup logic to health issues. This logic reduces the likelihood of identical health issues from flooding the issues dataset.

  10.3.11.1. Investigate and resolve health issues

  10.3.11.2. Monitor data ingestion health

##### Prerequisite

* For Cortex XSIAM to monitor data ingestion health and create health issues, you must enable Data Ingestion Monitoring in your Server Settings. For more information, see Set up your environment.

  10.3.11.3. Monitor correlation rules

##### Note

* In the dataset, the Query start time and Query end time indicate the timeframe of the data that was queried. The actual start and end times of the correlation rule execution are recorded in the _time field for the Initiated and Completed entries.

  10.4. Dataset management

##### License Type

  Managing Roles requires an Account Admin or Instance Administrator role. For more information, see Predefined user roles.

##### Note

* Cold storage, in addition to a cold storage license, requires compute units (CU) to run cold storage queries. For more information on CU, see Manage compute units. For information on the CU add-on license, see Understand the Cortex XSIAM license planUnderstand the Cortex XSIAM license plan.

* Only datasets that are already handled as part of the GB license are supported for this license. In addition, the retention configuration is only available in Cortex XSIAM, as opposed to the public APIs.

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default. Datasets include dataset permission enforcements in the Cortex Query Language(XQL), Query Center, and XQL Widgets. For example, to view or access any of the endpoints and host_inventory datasets, you need role-based access control (RBAC)...

* You'll only be able to save the dataset view if the query contains no errors; otherwise, the Save button is disabled.

* For more information on user roles, see Manage user roles.

##### Important

* Cortex XSIAM enforces retention on all log-type datasets excluding Host Inventory, Vulnerability Assessment, Metrics, and Users.

* This column is updated once a day. Therefore, if the dataset was created or updated by the target or lookup flows, it's possible that the Last Updated value is a day behind when the queries or reports were run as it was before this column was updated.

  10.4.1. What are datasets?

##### Note

* For more information on tasks specific to lookup datasets, see Lookup datasets.

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

##### Important

* By default, forensic datasets are not included in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  10.4.2. Lookup datasets

##### Note

* A lookup dataset can only be deleted if there are no other dependencies. For example, if a Correlation Rule is based on a lookup dataset, you wouldn't be able to delete the lookup dataset until you removed the dataset from the XQL query of the Correlation Rule.

  10.4.2.1. Import a lookup dataset

##### Prerequisite

* When uploading a CSV, TSV, or JSON file, ensure that the file meets the following requirements: The maximum size for the total data to be imported into a lookup dataset is 30 MB from the Dataset Management page. Otherwise, the limit is 50 MB using Cortex Query Language (XQL) or APIs. Field names can contain characters from different languages, special...

##### Important

* The name of a dataset created from a TSV file must always include the extension. For example, if the original file name is mrkdptusrsnov23.tsv, you can save the dataset with the name marketing_dept_users_Nov_2023.tsv.

  10.4.2.2. Download JSON file of lookup dataset

##### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  10.4.2.3. Set time to live for lookup datasets

##### Navigation

  Open the Settings → Configurations → Data Management → Dataset Management page

  10.4.3. Monitor datasets and dataset views activity

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  10.5. Archived data

  10.5.1. Import historical data into cold storage

##### License Type

  Importing historical data into cold storage requires a Period-Based Retention - Cold Storage add-on license.

##### Prerequisite

* Importing historical data into cold storage requires a View/Edit RBAC permission for Data Management (under Configurations).

  10.5.2. Building XQL archived data queries

##### Prerequisite

* Archived cold storage, in addition to a Period-Based Retention - Cold Storage add-on license, requires compute units (CU) to run archived cold storage queries. Cortex XSIAM provides a free daily quota of compute units (CU) allocated according to your license size. Queries run without enough quota will fail. To expand your investigation capabilities,...

  10.5.3. Success and failure code responses to your HTTP POST requests

  10.6. Parsing Rules

  10.6.1. What are Parsing Rules?

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

  10.6.2. Parsing Rules editor views

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

  10.6.3. Parsing Rules file structure and syntax

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Cortex XQL Language Reference.

* An inner type of join stage is only supported in CONST, INGEST, and RULE sections and is not supported in a COLLECT section. You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

* The regexcapture function is only supported in Parsing Rules and cannot be used in any other XQL query.

* Every statement in the Parsing Rules file must end with a semicolon (;).

  10.6.3.1. INGEST

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* You can't add tags to parsing rules using the Next-Generation Firewall (NGFW) datasets that are in the format panw_ngfw_<text>_raw, and the Observability dataset called panw_observability_raw.

  10.6.3.2. COLLECT

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

##### Note

* The CSV Collector applet is not affected by the COLLECT rules applied to a Broker VM.

##### Tip

* To reduce the amount of data transmitted to Cortex XSIAM from the broker, use filters to drop logs. Yet, be aware that once the logs are modified using alter or fields stages, the Broker VM will convert the original log into a JSON format, which could increase the data size being sent from the broker to Cortex XSIAM.

  10.6.3.3. CONST

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

##### Note

* The dollar sign ($) must be adjacent to the [CONST] name, without any whitespace in between.

##### Important

* Only quoted or integer terminal values are considered valid for CONST sections.

  10.6.3.4. RULE

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Get started with XQL.

* You can also add tags using only the INGEST section. For more information, see INGEST.

  10.6.3.5. EXTEND

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* For more information on the XQL syntax, see Get started with XQL.

  10.6.4. Create Parsing Rules

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* You need Cortex XSIAM administrator or Instance Administrator permissions to access the Simulate view and perform these tests.

  10.6.5. Troubleshooting Parsing rules errors

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

* Some errors can only be found after the applicable logs are collected in Cortex XSIAM.

  10.6.6. Parsing Rules Raw Dataset

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Parsing Rules.

  10.7. Data Model Rules

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

  10.7.1. What are Data Model Rules?

##### License Type

  Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

  10.7.2. Data Model Rules editor views

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

  10.7.3. Data Model Rules file structure and syntax

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

* For more information on XQL syntax, see the XQL Language Reference Guide.

* You cannot call a RULE section that exists in Default Rules from the User Defined Rules section.

  10.7.3.1. MODEL

##### Note

* The Settings → Configurations → XQL Configuration → Case Sensitivity (case_sensitive) setting can overwrite this case_sensitive configuration for all fields in the application except for BIOCs, which will remain case insensitive no matter what this setting is set to. For more information on this setting, see XQL Configuration.

* We recommend that you do not configure the same data source in both Marketplace and using a Cortex XSIAM data collector. Yet, if you do, the following will happen: For network data, all relevant logs from the different data sources are stitched to the same network story. For authentication data, all relevant logs from the different data sources are...

  10.7.3.2. RULE

##### Note

* For more information on the XQL syntax, see the XQL Language Reference Guide.

  10.7.3.3. Field structure

##### Note

* For more information on these data model fields, see Cortex XSIAM Data Model Schema.

  10.7.4. How to map authentication story events?

##### Prerequisite

* Familiarize yourself with the Cortex Data model (XDM) schema for field definitions and naming conventions, see Cortex XSIAM Data Model Schema.

##### Important

* This Feature focuses on authentication events related to SSO (Single Sign-On) and SaaS (Software-as-a-Service) application authentications. It does not cover internal authentication mechanisms such as Kerberos, NTLM, or traditional domain logon events generated by on-premise infrastructure.

* To maximize the variety of issues that are retrieved based on the XDM authentication stories, we recommend that the following additional fields are populated: xdm.target.resource_name, xdm.logon.type, xdm.source.user_agent, and xdm.source.host.device_category. Should you decide to change the default XDM mappings, ensure that both the mandatory and...

  10.7.5. Create Data Model Rules

##### Prerequisite

* Data Model Rules editor views Data Model Rules file structure and syntax How to map authentication story events?

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

##### Navigation

  In Cortex XSIAM, select Settings → Configurations → Data Management → Data Model Rules

  10.7.6. Troubleshooting Data Model Rules

##### Note

* Only a user with Cortex Account Administrator or Instance Administrator permissions can access Data Model Rules.

* Since this dataset also contains Parsing Rules errors, some of the fields are irrelevant for Data Model Rules and aren't included in the table.

##### Tip

* To ensure you and your colleagues stay informed about Data Model Rules activity, you can also Configure notification forwarding to forward your Data Model Rules audit logs to an email distribution list or Syslog server. For more information about the Data Model Rules audit logs, see Monitor Data Model Rules activity.

  10.7.7. Using data enrichment

##### Note

* For a complete list of auto-enriched fields, see the Cortex Data Model Schema Guide.

##### Important

* When manually mapping ASN fields that are enriched, such as xdm.source.asn.as_number, with other ISP and domain fields that are not enriched, such as xdm.source.asn.isp and xdm.source.asn.domain, it's possible to receive incorrect XDM query results due to the misalignment between the overridden enrichement and system enrichment fields.

  10.7.8. Data Model Rules notifications

  10.7.9. Monitor Data Model Rules activity

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  10.8. Manage Event Forwarding

##### License Type

  This feature requires an Event Forwarding add-on license. Only Administrators have access to this screen.

##### Important

* Since data is aggregated and compressed, it can take up to two hours until the data is available in the forwarding bucket.

##### Navigation

  Under Settings → Configurations → Data Management → Event Forwarding, activate the licenses in the Activation section

  10.8.1. Endpoints Event Forwarding - included/excluded fields by event type

##### License Type

  This feature requires an Event Forwarding add-on license. Only Administrators have access to this screen.

  10.9. Manage compute units

##### Note

* For more information, see Import historical data into cold storage.

* The CU consumption of cold storage queries is based on the number of days in the query time frame. For example, when querying 1 hour of a specific day, the CU of querying this entire day is consumed. When querying 1 hour that extends past 2 days, such as from 23:50 to 00:50 of the following day, the CU of querying these two days is consumed.

  10.9.1. Compute units usage

##### Note

* To enable the add-on, select Settings  → Configurations → Cortex XSIAM License → Addons tile, and select the Compute Unit tile and Enable.

##### Navigation

  Settings → Configurations → Data Management → Compute Unit Usage

11. Marketplace

  11.1. Cortex Marketplace

  11.2. Content packs

##### Note

* Cortex XSIAM includes a built-in default mail sender. You also have the option of installing a different mail sender content pack, such as Microsoft Exchange Online.

  11.3. Content Pack Support Types

##### Note

* Palo Alto Networks is not liable for and does not warrant or support any content pack produced by a third-party publisher. Palo Alto Networks does not support content packs that do not have official available documentation.

  11.4. Cortex XSIAM content

  11.5. Manage content packs

##### Note

* Optional content packs that are already installed are treated like they are required content packs to preserve content integrity.

* In addition to content packs that you install from Marketplace, related content packs are automatically downloaded when you adopt playbooks or edit tasks that require content items such as scripts or integrations.

* Third-party product Integrations are developed and tested against a specific product version. For products that are on-prem or cloud-based with specific API versions, the version developed and tested against will be included in the integration's documentation. Newer versions of the product are not always immediately tested, and it is expected that...

##### Caution

* If another content pack is dependent on the content pack you want to delete, it may break the other content pack. You can reinstall the content pack, but you cannot restore detached and customized content.

* If you want to downgrade, any content that depends on the content pack including any customizations may be deleted if it does not exist in the target content pack version.

  11.6. Marketplace FAQs

  11.7. Content changes when upgrading Cortex XSIAM versions

  11.8. Content pack contributions

12. Cortex XSIAM XQL

  12.1. Get started with XQL

  12.1.1. XQL language features

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

##### Navigation

  You submit XQL queries to Cortex XSIAM using the Investigation & Response → Search → Query Builder user interface

  12.1.2. XQL Language Structure

  12.1.2.1. Adding comments in queries

  12.1.3. Supported operators

##### Note

* In some cases, using an IN or NOT IN operator combined with a dataset and filter stage can be a better alternative to using a join stage.

  12.1.4. Datasets and presets

##### Note

* To set up this Cloud Identity Engine (previously called Directory Sync Service (DSS)) dataset, you need to set up a Cloud Identity Engine. Otherwise, you will not have a pan_dss_raw dataset. For more information, see Set up Cloud Identity Engine.

* INFO issues are not included in this dataset. This dataset includes issues from the Security and Health domains. For more information, see Overview of the Issues page.

* The fields contained in this dataset are a subset of the fields in the xdr_data dataset.

* If the vendor and product are not specified in the Winlogbeat profile's configuration file, Cortex XSIAM creates a default dataset called microsoft_windows_raw.

* To ensure GlobalProtect access authentication logs are sent to Cortex XSIAM, verify that your PANW firewall's Log Settings for GlobalProtect has the Cortex Data Lake checkbox selected.

* You must have the Cortex XSIAM Threat Intel Management (TIM) Add-on to use this dataset.

* You can query in XQL for this data and build widgets based on the xdr_data dataset or using the preset device_control. To view in an XQL query these events, the Device Configuration of the endpoint profile must be set to Block. Otherwise, the USB events are not captured. The events are also captured when a group of device types are blocked on the...

##### Important

* This dataset will not be updated after June 2024. Use the health_alerts dataset instead.

  12.1.5. About examples

##### Navigation

  Investigation & Response → Search → Query Builder → XQL → Query Library

  12.1.6. JSON functions

##### Important

* JSON field names are case sensitive, so the key to field pairing must be identical in an XQL query for results to be found. For example, if a field value is "TIMESTAMP" and your query is defined to look for "timestamp", no results will be found.

  12.1.7. How to filter for empty values in the results table

  12.1.8. Understanding string manipulation in XQL

  12.2. Build XQL queries

  12.2.1. About the Query Builder

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query, and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion commands and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc key.

* If you prefer to use the Query Builder in Legacy mode, switch the toggle in the header. In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM Data Model, switch to New mode or select XQL Search.

  12.2.2. How to build XQL queries

##### Note

* Users with different dataset permissions can receive different results for the same XQL query. An administrator or a user with a predefined user role can create and view queries built with an unknown dataset that currently does not exist in Cortex XSIAM. All other users can only create and view queries built with an existing dataset. When you have more...

* You can build a query that investigates data in both a cold dataset and a hot dataset in the same query. In addition, as the hot storage dataset format is the default option and represents the fully searchable storage, this format is used throughout this guide for investigation and threat hunting. For more information on hot and cold storage, see...

##### Important

* Forensic datasets are not inlcuded by default in XQL query results, unless the dataset query is explicitly defined to use a forensic dataset.

  12.2.2.1. Get started with XQL queries

##### Tip

* If you are new to creating queries, you can also try our simple search templates, which can help you get started in understanding how queries work. See Query Builder templates.Query Builder templates

  12.2.2.2. Useful XQL user interface features

##### Note

* Schema changes to datasets may not be reflected in the autocomplete suggestions and definitions as you type in real time the XQL query and can appear with a slight delay.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

  12.2.2.3. XQL Query best practices

  12.2.2.4. Expected results when querying fields

  12.2.2.5. Create XQL query

##### Note

* Whenever the time period is changed in the query window, the config timeframe is automatically set to the time period defined, but this won't be visible as part of the query. Only if you manually type in the config timeframe will this be seen in the query. These time picker options are available in XQL queries when using the Query Builder, XQL Widgets,...

* While datamodel dataset=* is supported in the query, we recommend that you specify specific datasets for quicker and more efficient results.

##### Tip

* When creating XQL queries, you can: Use the up and down arrow keys to navigate through the auto-suggestion command suggestions and definitions. Select an auto-suggestion command by pressing either the Enter or Tab key. Press Shift+Enter to add a new line, and easily ignore the auto-suggestion output. Close the auto-suggestion output by pressing the Esc...

* While the query is running, you can navigate away from the page. A notification is sent when the query has finished. You can also Cancel the query or run a new query, where you have the option to Run only new query (cancel previous) or Run both queries.

  12.2.2.6. Review XQL query results

##### Note

* It's also possible to graph the results displayed. For more information, see Graph query results.

* In order for Cortex XSIAM to provide a histogram for a field, the field must not contain an array or a JSON object.

  12.2.2.7. Translate to XQL

##### Important

* This feature is still in a Beta state and you will find that not all Splunk queries can be converted to XQL. This feature will be improved upon in the upcoming releases to support greater Splunk query translations to XQL.

  12.2.2.8. Graph query results

##### Note

* To display the result of as a time duration, choose the graph type Single Value and enable Show as Time. You can then select the Time Unit (millisecond, second, minute, or hour) and the Display format.

  12.2.3. Query Builder templates

##### Tip

* To get started with queries, you can run an empty template query with no values specified. The query results will include all of the fields in the template specific fieldset. Based on the query results, you can run subsequent queries to narrow down your search.

  12.2.3.1. Get started with Query Builder templates

  12.2.3.2. Considerations for using Query Builder templates

  12.2.3.3. Create a query from a template

##### Note

* Field names and aliases are listed without their prefix, for example xdm.SOURCE.USER.USERNAME is listed as SOURCE.USER.USERNAME and XDM_ALIAS.ipv4 is listed as ipv4. Fields that are already included in the query template are shown as grayed out. In the Identity and Network templates, xdm.event.outcome shows as grayed out. In these templates, the ACTION...

* This order might change if you include a filtering field that is listed in the fieldset. In that case, the field is taken out of the fieldset and ordered at the top of the list with the other filtering fields.

  12.2.3.4. Run a free text query

##### Note

* Free-text search is also available in XQL queries. You can use the search stage to query free-text strings in specific datasets, or all of the datasets in your tenant.

* Free text search is limited to the last 90 days of data. Specifying a time frame outside of this limitation will cause the query to fail.

  12.2.3.5. Query Builder template examples

##### Navigation

  Investigation & Response → Search → Query Builder

  12.2.4. Edit and run queries in Query Center

##### Navigation

  Investigation & Response → Search → Query Center

  12.2.4.1. Query Center reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  12.2.5. Manage scheduled queries

##### Navigation

  Investigation & Response → Search → Scheduled Queries

  12.2.5.1. Scheduled Queries reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  12.2.6. Manage your personal query library

##### Navigation

  From the Query Builder Select Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Builder → XQL

  Investigation & Response → Search → Query Center

  12.2.7. Legacy Query Builder

##### Note

* We recommend using the Query Builder in New mode to take advantage of the Query Builder templates and the ability to search the full Cortex Data Model (XDM). In Legacy mode, the Query Builder searches predefined datasets only. To search the full XDM, switch to New mode or select XQL Search.

  12.2.7.1. Create authentication query

##### Navigation

  Investigation & Response → Search → Query Builder

  12.2.7.2. Create event log query

##### Navigation

  Investigation & Response → Search → Query Builder

  12.2.7.3. Create file query

##### Navigation

  Investigation & Response → Search → Query Builder

  12.2.7.4. Create image load query

##### Navigation

  Investigation & Response → Search → Query Builder

  12.2.7.5. Create network connections query

##### Navigation

  Investigation & Response → Search → Query Builder

  12.2.7.6. Create network query

##### Note

* When you run the query, depending on the outcome of the results, the value specified in this field might be displayed in the dst_ip field in the query results. This occurs if an RDP event is recorded whereby a user connected from the source IP to the destination IP.

  12.2.7.7. Create process query

##### Navigation

  Investigation & Response → Search → Query Builder

  12.2.7.8. Create registry query

##### Important

* Ensure the KEY NAME is entered as a real registry key name, and not as a symbolic link. Otherwise, the query will not retrieve results. Instead of HKEY_LOCAL_MACHINE\System\CurrentControlSet, which is a symbolic link, use KEY_LOCAL_MACHINE\System\ControlSet001. Instead of HKEY_CURRENT_USER, use HKEY_USERS\<SID>, where SID is either a SID of the current...

  12.2.7.9. Query across all entities

##### Navigation

  Investigation & Response → Search → Query Builder

  12.3. Stages

  12.4. Functions

13. Graph Search

  13.1. What is Graph Search?

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Note

* Graph Search is a Beta feature and is still subject to changes. To enable the feature in your tenant, contact your Customer Support Team.

  13.2. Get started with Graph Search queries

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Navigation

  Understand your assets and findings data: Graph Search queries are based on the current data that has been collected for assets and findings from the data sources configured and then sent to the Unified Asset Inventory (UAI), which is displayed in the All Assets page (Inventory → Assets → All Assets

  13.3. How to build Graph Search queries?

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Navigation

  You submit Graph Search queries using the Investigation & Response → Search → Query Builder → Graph Search built-in query interface

  13.4. Understand Graph Search query results

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  13.5. Create Graph Search query

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Note

* For more information about the Query Library, see Manage Graph Search Query Library.

##### Tip

* After running the query, you can view the complete query by hovering over the last THAT... in the Graph Search query interface, and the query is displayed in a tooltip. If your query doesn't find any results or you want to change your query for any reason, you can always click anywhere in the Graph Search query interface, where your existing query is...

  13.6. Graph Search examples

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  13.7. Manage Graph Search Query Library

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

##### Navigation

  From Graph Search in the Query Builder Select Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Builder → Graph Search

  Investigation & Response → Search → Query Center

  13.8. Edit and run queries in Query Center

##### Navigation

  Investigation & Response → Search → Query Center

  13.8.1. Query Center reference information

##### Note

* Certain fields are exposed and hidden by default. An asterisk (*) is beside every field that is exposed by default.

  13.9. Supported assets and findings

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

  13.10. FAQ on Beta Graph Search feature

##### License Type

  Requires the Cortex Cloud Posture Management add-on.

##### Prerequisite

* Graph Search requires View/Edit RBAC permissions for Query Center and the Personal Query Library (under Investigation & Response), which are the same permissions required for Cortex Query Language (XQL).

14. Cortex CLI

##### Note

* The CLI Read Only Role is not supported for CWP as the system does not support offline mode.

  14.1. Connect Cortex CLI

##### Prerequisite

* System requirements:    macOS (Intel Core i7, such as Sequoia): To ensure all functionalities work correctly, you must install the vectorscan dependency via Homebrew, using this command: brew install vectorscan   RHEL 8.10 and Red Hat UBI9. The following prerequisites must be met:    Install patchelf   Install zstd      Ubuntu 20 requires the prefetch...

##### Note

* Using an existing API Key (or verifying existing API Key permissions): If you are using an existing API key, verify it has CLI permissions. CLI View/Edit permissions correspond to selecting With upload results permissions, while CLI Read Only or View permissions corresponds to not selecting the With upload results permissions.

* On macOS arm 64 architecture you must unpack the downloaded file to retrieve the executable.

* To add an additional CLI instance, navigate to Settings → Data Sources →  select the menu for your connected CLI instance → + New Instance, and repeat the onboarding steps.

* For more information about CLI usage for CWP, refer to Cortex CLI for Cloud Workload Protection For more information about CLI usage for API Security, refer to Cortex CLI for API Security For more information about CLI usage for Application Security, refer to Cortex CLI usage for Application Security

##### Tip

* You can also locate your CI tool by typing its name (such as Jenkins) into the search bar on the Add Data Source page after selecting + Data Sources.

* You can enter CLI in the search bar to locate the Cortex CLI tool.

  14.2. Cortex CLI common command line reference guide

##### Note

* For soft fails, a failed check matches the defined severity threshold. If multiple soft fail severities are specified, the highest severity acts as the threshold for determining a soft fail. However, a successful scan will always return an exit code of 0, even if block-level findings (which might trigger soft fails based on severity) are present.

  14.3. Cortex CLI for Cloud Workload Protection

##### Prerequisite

* Ensure you have the required user permissions. Refer to Cortex CLI for more information Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more information Verify that Java version 11 and above is installed: Run java -version in your terminal. If not, refer to Java SE Development Kit 11.0.25 for information about installing Java

* Before you begin, ensure you have sudo privileges to execute the image scan.

##### Note

* The output contains the number of created issues for malware, secrets, and vulnerabilities, organized by severity, based on the current policy configuration.

  14.3.1. Cloud Workload Protection command line reference

  14.4. Cortex CLI for API Security

##### Prerequisite

* Ensure you have the required user permissions. Refer to Overview for more informationOverview Onboard and install the Cortex CLI. Refer to Connect Cortex CLI for more information Ensure your application exposes APIs and provides a corresponding OpenAPI Specification file Ensure that you have installed Java v 11 and above

  14.4.1. Cortex CLI API Security command line reference guide

  14.5. Cortex CLI for Application Security

##### Prerequisite

* For the Cortex CLI binary:    Ensure you have Node.js v22 installed on your host machine before running any scans with the Cortex CLI. This is crucial to prevent runtime errors, as the CLI depends on Node.js for executing JavaScript analysis  Note    To check your version of Node.js, run node -v   To download Node.js, refer to the official Node.js...

  14.5.1. Cortex CLI usage for Application Security

  14.5.2. Cortex CLI Application Security command line reference

##### Note

* The repo-id flag must not end with .config, .log or .ini. -config is acceptable. --repo-id foo.config will be blocked --repo-id foo-config will pass

##### Important

* The Cortex CLI Application Security only supports single occurrences of each flag. If the same flag is passed multiple times, only the last provided value will be used. For example, in the following command, only TF CloudFormation will be the scanned framework. ./cortexcli --api-base-url <YOUR_API_URL> --api-key <YOUR_API_KEY> --auth-id <YOUR_AUTH_ID>...

  14.5.3. CLI pipeline code snippets

  14.6. Migrate Cortex CLI

##### Prerequisite

* Before you begin, ensure you have the following: Ensure you have an active API key for your Cortex Cloud tenant with associated CLI role permissions. Refer to Manage API keys for more information Install the Cortex CLI. You can find the installation instructions here

15. Multi-Tenant

  15.1. What is Cortex XSIAM multi-tenant?

##### Note

* By default, multi-tenant licenses include one child tenant.

  15.1.1. MSSP multi-tenant

  15.1.2. Enterprise multi-tenant

  15.2. Multi-tenant central licensing management

##### Note

* In MSSP or enterprise multi-tenant, the license specifies the maximum number of child tenants that can be created. Once this limit is reached, no additional tenants can be created, even if there remains allocation for endpoints or GBs.

  15.3. Onboard Cortex multi-tenant

  15.3.1. Onboarding checklist for multi-tenant central licensing deployments

  15.3.1.1. Step 1. Activate Cortex XSIAM (main account)

##### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

  15.3.1.2. Step 2. Create a child tenant

##### Note

* The main account is labeled in Cortex Gateway, but child tenants are not labeled. Cortex enables parent-child pairing between tenants located in different geographical regions. To enable this capability, contact your support team. To create a child tenant, ensure that you have Account Admin permissions.

* After activating a child tenant, you can't change the child tenant's name.

* This is a public FQDN, so be careful with sensitive information such as the company name. After activating a child tenant, you can only change the child tenant subdomain once.

* Ensure that you meet the minimum requirements for child tenant allocation.

* If you reach your limit for child tenants, depending on your license, you may be able to create more tenants. You may be charged for additional tenants. Contact Customer Support if you are approaching your authorized limit.

  15.3.2. Onboarding checklist for multi-tenant customer-owned license deployments

  15.3.2.1. Step 1. Activate Cortex Cortex XSIAM (parent and child tenants)

##### Prerequisite

* Before you begin, make sure you have the following: Cortex XSIAM activation email. Customer Support Portal Super User role is assigned to your account. Before activating your Cortex XSIAM tenant, you need to set up your Customer Support Portal account. See How to Create Your Customer Support Portal User Account. When you create a Customer Support...

  15.3.2.2. Step 2. Define access configurations and role permissions

  15.3.2.3. Step 3. Pair a parent tenant with child tenant

##### Note

* This field is not enabled by default. To enable this, contact your support team.

  15.4. Dynamic license allocation

##### Note

* Changing the tenant's allocations might result in a short downtime of your tenant.

* After activating a child tenant, you can't change the child tenant's name.

* This is a public FQDN, so be careful with sensitive information such as the company name. After activating a child tenant, you can only change the child tenant subdomain once.

* Ensure that you meet the minimum requirements for child tenant allocation.

* If you reach your limit for child tenants, depending on your license, you may be able to create more tenants. You may be charged for additional tenants. Contact Customer Support if you are approaching your authorized limit.

* In a multi-tenant central licensing management environment, you cannot unpair a child tenant from the main account. The only way to remove the connection to the main account is to delete the tenant.

  15.5. Child tenant management

  15.5.1. Manage a child tenant

##### Note

* Once a configuration is created Cortex XSIAM resets the child tenant data and synchronizes the security actions configured in the parent tenant.

  15.5.2. Track your tenant management

##### Note

* This field is not enabled by default. To enable, contact your account administrator.

##### Navigation

  To view child tenant details, in Cortex XSIAM, select Settings → Configurations → Tenant Management

  15.5.3. Investigate child tenant data

  15.5.4. Create and allocate configurations

##### Note

* You can configure Profiles only as Managed or Unmanaged. All profiles you create are automatically cloned to your child tenants.

  15.5.5. Create a security managed action

##### Note

* Profiles you create are automatically cloned to your child tenants.

  15.6. About managed threat hunting

  15.6.1. Set up Managed Threat Hunting

##### Navigation

  Settings → Configurations → Managed Services

  15.6.2. Investigate Managed Threat Hunting reports

##### Note

* The MTH page is available for users with the Managed Threat Hunting license and have the necessary permission to view and triage alerts and incidents in Cortex XSIAM.

16. Reference

  16.1. Cloud service provider permissions

  16.1.1. Amazon Web Services provider permissions

  16.1.2. Google Cloud Platform provider permissions

  16.1.3. Microsoft Azure provider permissions

  16.2. Microsoft Windows security auditing setup

  16.2.1. Enable security auditing event IDs

##### Note

* We recommend you configure security auditing using Group Policy Object (GPO). Using GPO simplifies audit management and ensures that auditing settings are uniformly applied across your network, reducing the risk of misconfigurations on individual machines.

  16.2.1.1. Enable security auditing event IDs with GPO

##### Note

* We recommend that you configure the Group Policy Object (GPO) to apply to all endpoints and not just Domain Controllers. This ensures comprehensive auditing across your entire network.

##### Navigation

  Server Manager → Tools → Group Policy Management

  Computer Configuration → Policies → Windows Settings → Security Settings → Advanced Audit Policy Configuration → Audit Policies

  16.2.1.2. Set up local machine security auditing without GPO

  16.2.1.3. Additional setup for Active Directory Certificate Services (ADCS) events

##### Note

* Enabling auditing for Active Directory Certificate Services (ADCS) restarts (events 4880 and 4881) can significantly slow down the service if you have a large database. To prevent delays: Clean up the database: Remove any unnecessary entries to reduce its size. Skip this audit: If restart speed is critical, consider not enabling auditing for ADCS...

  16.2.1.4. Enable auditing access to AD domain objects - 4662

##### Note

* The Descendant msDS-DelegatedManagedServiceAccount Objects configuration is relevant only for Windows Server 2025.

  16.2.2. Enable additional event logs using Event Viewer

##### Navigation

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → User Profile Service, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → CAPI2, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → DNS Client Events, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → DriverFrameworks-UserMode, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → PowerShell, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → Windows Defender, right click Operational and select Enable Log

  In Event viewer → Application and Services Logs → Microsoft → Windows → TerminalServices-ClientActiveXCore → Microsoft-Windows-TerminalServices-RDPClient, right click Operational and select Enable Log

  In Event Viewer → Expand Applications and Services Logs → Microsoft → Windows → Windows Firewall With Advanced Security → Firewall, right click Operational and select Enable Log

  16.2.3. Enable LDAP server events logging (1644)

  16.2.3.1. Enable LDAP server events logging using RegEdit

  16.2.3.2. Enable LDAP server events logging using GPO

##### Navigation

  Computer Configuration → Preferences → Windows Settings → Registry

  16.2.3.3. Validate log collection for LDAP Server events

  16.3. XDM fields for mapping authentication events

##### Note

* For more information on the entire Cortex Data model (XDM) schema, see Cortex XSIAM Data Model Schema.

* Do not map a static string, list, or empty string. You must map this field from the raw log field that best represents the actual source IP used in the authentication attempt. In cases where multiple IP fields are available, such as client_ip, source_ip, and original_client_ip, choose the field that captures the IP address from which the user initially...

* Mapping should be done per event type. The same system could be an IDP in one event and an SP in another.

* For more information on the event outcome constants in the Cortex Data Model, see XDM_CONST.OUTCOME.

* Outcome is based on a conclusive event type reflecting the true end state of the authentication flow.Critical for effectiveness of detection rules. Incorrect derivation can lead to missed detections or false positives.

* These are the most common values, but other logon types also exist. For a complete list, see XDM_CONST.LOGON_TYPE.

* For more information, see XDM_CONST.USER_TYPE.

* For more information, see XDM_CONST.PRIVILEGE_LEVEL.

* For more information, see XDM_CONST.OS_FAMILY.

* While xdm.network.session_id aggregates multiple user actions within a broader session window. xdm.session.context.id is used to correlate events that belong to a single authentication request or transaction.
